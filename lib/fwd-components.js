import { nextTick as s6, openBlock as u6, createElementBlock as f6, Fragment as l6, createElementVNode as xD } from "vue";
function c6(r, t) {
  for (var e = 0; e < t.length; e++) {
    const n = t[e];
    if (typeof n != "string" && !Array.isArray(n)) {
      for (const i in n)
        if (i !== "default" && !(i in r)) {
          const a = Object.getOwnPropertyDescriptor(n, i);
          a && Object.defineProperty(r, i, a.get ? a : {
            enumerable: !0,
            get: () => n[i]
          });
        }
    }
  }
  return Object.freeze(Object.defineProperty(r, Symbol.toStringTag, { value: "Module" }));
}
const F1 = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  get Base() {
    return oa;
  },
  get Circle() {
    return iK;
  },
  get Ellipse() {
    return oK;
  },
  get Image() {
    return uK;
  },
  get Line() {
    return lK;
  },
  get Marker() {
    return dK;
  },
  get Path() {
    return Bb;
  },
  get Polygon() {
    return wK;
  },
  get Polyline() {
    return SK;
  },
  get Rect() {
    return AK;
  },
  get Text() {
    return PK;
  }
}, Symbol.toStringTag, { value: "Module" })), z1 = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  get Base() {
    return Wi;
  },
  get Circle() {
    return RK;
  },
  get Dom() {
    return GK;
  },
  get Ellipse() {
    return zK;
  },
  get Image() {
    return jK;
  },
  get Line() {
    return WK;
  },
  get Marker() {
    return XK;
  },
  get Path() {
    return HK;
  },
  get Polygon() {
    return qK;
  },
  get Polyline() {
    return QK;
  },
  get Rect() {
    return tq;
  },
  get Text() {
    return oq;
  }
}, Symbol.toStringTag, { value: "Module" }));
var Yy = function(r, t) {
  return Yy = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(e, n) {
    e.__proto__ = n;
  } || function(e, n) {
    for (var i in n)
      Object.prototype.hasOwnProperty.call(n, i) && (e[i] = n[i]);
  }, Yy(r, t);
};
function Ht(r, t) {
  if (typeof t != "function" && t !== null)
    throw new TypeError("Class extends value " + String(t) + " is not a constructor or null");
  Yy(r, t);
  function e() {
    this.constructor = r;
  }
  r.prototype = t === null ? Object.create(t) : (e.prototype = t.prototype, new e());
}
var U = function() {
  return U = Object.assign || function(t) {
    for (var e, n = 1, i = arguments.length; n < i; n++) {
      e = arguments[n];
      for (var a in e)
        Object.prototype.hasOwnProperty.call(e, a) && (t[a] = e[a]);
    }
    return t;
  }, U.apply(this, arguments);
};
function kn(r, t) {
  var e = {};
  for (var n in r)
    Object.prototype.hasOwnProperty.call(r, n) && t.indexOf(n) < 0 && (e[n] = r[n]);
  if (r != null && typeof Object.getOwnPropertySymbols == "function")
    for (var i = 0, n = Object.getOwnPropertySymbols(r); i < n.length; i++)
      t.indexOf(n[i]) < 0 && Object.prototype.propertyIsEnumerable.call(r, n[i]) && (e[n[i]] = r[n[i]]);
  return e;
}
function h6(r, t, e, n) {
  var i = arguments.length, a = i < 3 ? t : n === null ? n = Object.getOwnPropertyDescriptor(t, e) : n, o;
  if (typeof Reflect == "object" && typeof Reflect.decorate == "function")
    a = Reflect.decorate(r, t, e, n);
  else
    for (var s = r.length - 1; s >= 0; s--)
      (o = r[s]) && (a = (i < 3 ? o(a) : i > 3 ? o(t, e, a) : o(t, e)) || a);
  return i > 3 && a && Object.defineProperty(t, e, a), a;
}
function d6(r, t) {
  return function(e, n) {
    t(e, n, r);
  };
}
function v6(r, t) {
  if (typeof Reflect == "object" && typeof Reflect.metadata == "function")
    return Reflect.metadata(r, t);
}
function Ea(r, t, e, n) {
  function i(a) {
    return a instanceof e ? a : new e(function(o) {
      o(a);
    });
  }
  return new (e || (e = Promise))(function(a, o) {
    function s(l) {
      try {
        f(n.next(l));
      } catch (c) {
        o(c);
      }
    }
    function u(l) {
      try {
        f(n.throw(l));
      } catch (c) {
        o(c);
      }
    }
    function f(l) {
      l.done ? a(l.value) : i(l.value).then(s, u);
    }
    f((n = n.apply(r, t || [])).next());
  });
}
function Sa(r, t) {
  var e = { label: 0, sent: function() {
    if (a[0] & 1)
      throw a[1];
    return a[1];
  }, trys: [], ops: [] }, n, i, a, o;
  return o = { next: s(0), throw: s(1), return: s(2) }, typeof Symbol == "function" && (o[Symbol.iterator] = function() {
    return this;
  }), o;
  function s(f) {
    return function(l) {
      return u([f, l]);
    };
  }
  function u(f) {
    if (n)
      throw new TypeError("Generator is already executing.");
    for (; e; )
      try {
        if (n = 1, i && (a = f[0] & 2 ? i.return : f[0] ? i.throw || ((a = i.return) && a.call(i), 0) : i.next) && !(a = a.call(i, f[1])).done)
          return a;
        switch (i = 0, a && (f = [f[0] & 2, a.value]), f[0]) {
          case 0:
          case 1:
            a = f;
            break;
          case 4:
            return e.label++, { value: f[1], done: !1 };
          case 5:
            e.label++, i = f[1], f = [0];
            continue;
          case 7:
            f = e.ops.pop(), e.trys.pop();
            continue;
          default:
            if (a = e.trys, !(a = a.length > 0 && a[a.length - 1]) && (f[0] === 6 || f[0] === 2)) {
              e = 0;
              continue;
            }
            if (f[0] === 3 && (!a || f[1] > a[0] && f[1] < a[3])) {
              e.label = f[1];
              break;
            }
            if (f[0] === 6 && e.label < a[1]) {
              e.label = a[1], a = f;
              break;
            }
            if (a && e.label < a[2]) {
              e.label = a[2], e.ops.push(f);
              break;
            }
            a[2] && e.ops.pop(), e.trys.pop();
            continue;
        }
        f = t.call(r, e);
      } catch (l) {
        f = [6, l], i = 0;
      } finally {
        n = a = 0;
      }
    if (f[0] & 5)
      throw f[1];
    return { value: f[0] ? f[1] : void 0, done: !0 };
  }
}
var U1 = Object.create ? function(r, t, e, n) {
  n === void 0 && (n = e);
  var i = Object.getOwnPropertyDescriptor(t, e);
  (!i || ("get" in i ? !t.__esModule : i.writable || i.configurable)) && (i = { enumerable: !0, get: function() {
    return t[e];
  } }), Object.defineProperty(r, n, i);
} : function(r, t, e, n) {
  n === void 0 && (n = e), r[n] = t[e];
};
function p6(r, t) {
  for (var e in r)
    e !== "default" && !Object.prototype.hasOwnProperty.call(t, e) && U1(t, r, e);
}
function Hy(r) {
  var t = typeof Symbol == "function" && Symbol.iterator, e = t && r[t], n = 0;
  if (e)
    return e.call(r);
  if (r && typeof r.length == "number")
    return {
      next: function() {
        return r && n >= r.length && (r = void 0), { value: r && r[n++], done: !r };
      }
    };
  throw new TypeError(t ? "Object is not iterable." : "Symbol.iterator is not defined.");
}
function _D(r, t) {
  var e = typeof Symbol == "function" && r[Symbol.iterator];
  if (!e)
    return r;
  var n = e.call(r), i, a = [], o;
  try {
    for (; (t === void 0 || t-- > 0) && !(i = n.next()).done; )
      a.push(i.value);
  } catch (s) {
    o = { error: s };
  } finally {
    try {
      i && !i.done && (e = n.return) && e.call(n);
    } finally {
      if (o)
        throw o.error;
    }
  }
  return a;
}
function g6() {
  for (var r = [], t = 0; t < arguments.length; t++)
    r = r.concat(_D(arguments[t]));
  return r;
}
function j1() {
  for (var r = 0, t = 0, e = arguments.length; t < e; t++)
    r += arguments[t].length;
  for (var n = Array(r), i = 0, t = 0; t < e; t++)
    for (var a = arguments[t], o = 0, s = a.length; o < s; o++, i++)
      n[i] = a[o];
  return n;
}
function Ga(r, t, e) {
  if (e || arguments.length === 2)
    for (var n = 0, i = t.length, a; n < i; n++)
      (a || !(n in t)) && (a || (a = Array.prototype.slice.call(t, 0, n)), a[n] = t[n]);
  return r.concat(a || Array.prototype.slice.call(t));
}
function Mc(r) {
  return this instanceof Mc ? (this.v = r, this) : new Mc(r);
}
function y6(r, t, e) {
  if (!Symbol.asyncIterator)
    throw new TypeError("Symbol.asyncIterator is not defined.");
  var n = e.apply(r, t || []), i, a = [];
  return i = {}, o("next"), o("throw"), o("return"), i[Symbol.asyncIterator] = function() {
    return this;
  }, i;
  function o(h) {
    n[h] && (i[h] = function(d) {
      return new Promise(function(v, p) {
        a.push([h, d, v, p]) > 1 || s(h, d);
      });
    });
  }
  function s(h, d) {
    try {
      u(n[h](d));
    } catch (v) {
      c(a[0][3], v);
    }
  }
  function u(h) {
    h.value instanceof Mc ? Promise.resolve(h.value.v).then(f, l) : c(a[0][2], h);
  }
  function f(h) {
    s("next", h);
  }
  function l(h) {
    s("throw", h);
  }
  function c(h, d) {
    h(d), a.shift(), a.length && s(a[0][0], a[0][1]);
  }
}
function m6(r) {
  var t, e;
  return t = {}, n("next"), n("throw", function(i) {
    throw i;
  }), n("return"), t[Symbol.iterator] = function() {
    return this;
  }, t;
  function n(i, a) {
    t[i] = r[i] ? function(o) {
      return (e = !e) ? { value: Mc(r[i](o)), done: i === "return" } : a ? a(o) : o;
    } : a;
  }
}
function b6(r) {
  if (!Symbol.asyncIterator)
    throw new TypeError("Symbol.asyncIterator is not defined.");
  var t = r[Symbol.asyncIterator], e;
  return t ? t.call(r) : (r = typeof Hy == "function" ? Hy(r) : r[Symbol.iterator](), e = {}, n("next"), n("throw"), n("return"), e[Symbol.asyncIterator] = function() {
    return this;
  }, e);
  function n(a) {
    e[a] = r[a] && function(o) {
      return new Promise(function(s, u) {
        o = r[a](o), i(s, u, o.done, o.value);
      });
    };
  }
  function i(a, o, s, u) {
    Promise.resolve(u).then(function(f) {
      a({ value: f, done: s });
    }, o);
  }
}
function x6(r, t) {
  return Object.defineProperty ? Object.defineProperty(r, "raw", { value: t }) : r.raw = t, r;
}
var _6 = Object.create ? function(r, t) {
  Object.defineProperty(r, "default", { enumerable: !0, value: t });
} : function(r, t) {
  r.default = t;
};
function w6(r) {
  if (r && r.__esModule)
    return r;
  var t = {};
  if (r != null)
    for (var e in r)
      e !== "default" && Object.prototype.hasOwnProperty.call(r, e) && U1(t, r, e);
  return _6(t, r), t;
}
function E6(r) {
  return r && r.__esModule ? r : { default: r };
}
function S6(r, t, e, n) {
  if (e === "a" && !n)
    throw new TypeError("Private accessor was defined without a getter");
  if (typeof t == "function" ? r !== t || !n : !t.has(r))
    throw new TypeError("Cannot read private member from an object whose class did not declare it");
  return e === "m" ? n : e === "a" ? n.call(r) : n ? n.value : t.get(r);
}
function M6(r, t, e, n, i) {
  if (n === "m")
    throw new TypeError("Private method is not writable");
  if (n === "a" && !i)
    throw new TypeError("Private accessor was defined without a setter");
  if (typeof t == "function" ? r !== t || !i : !t.has(r))
    throw new TypeError("Cannot write private member to an object whose class did not declare it");
  return n === "a" ? i.call(r, e) : i ? i.value = e : t.set(r, e), e;
}
function C6(r, t) {
  if (t === null || typeof t != "object" && typeof t != "function")
    throw new TypeError("Cannot use 'in' operator on non-object");
  return typeof r == "function" ? t === r : r.has(t);
}
const T6 = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  __extends: Ht,
  get __assign() {
    return U;
  },
  __rest: kn,
  __decorate: h6,
  __param: d6,
  __metadata: v6,
  __awaiter: Ea,
  __generator: Sa,
  __createBinding: U1,
  __exportStar: p6,
  __values: Hy,
  __read: _D,
  __spread: g6,
  __spreadArrays: j1,
  __spreadArray: Ga,
  __await: Mc,
  __asyncGenerator: y6,
  __asyncDelegator: m6,
  __asyncValues: b6,
  __makeTemplateObject: x6,
  __importStar: w6,
  __importDefault: E6,
  __classPrivateFieldGet: S6,
  __classPrivateFieldSet: M6,
  __classPrivateFieldIn: C6
}, Symbol.toStringTag, { value: "Module" }));
var fi = function(r) {
  return r !== null && typeof r != "function" && isFinite(r.length);
}, Nv = function(r, t) {
  return fi(r) ? r.indexOf(t) > -1 : !1;
}, Ap = function(r, t) {
  if (!fi(r))
    return r;
  for (var e = [], n = 0; n < r.length; n++) {
    var i = r[n];
    t(i, n) && e.push(i);
  }
  return e;
}, A6 = function(r, t) {
  return t === void 0 && (t = []), Ap(r, function(e) {
    return !Nv(t, e);
  });
}, I6 = {}.toString, aa = function(r, t) {
  return I6.call(r) === "[object " + t + "]";
};
const Ur = function(r) {
  return aa(r, "Function");
};
var Tt = function(r) {
  return r == null;
};
const Dt = function(r) {
  return Array.isArray ? Array.isArray(r) : aa(r, "Array");
}, Xn = function(r) {
  var t = typeof r;
  return r !== null && t === "object" || t === "function";
};
function Se(r, t) {
  if (!!r) {
    var e;
    if (Dt(r))
      for (var n = 0, i = r.length; n < i && (e = t(r[n], n), e !== !1); n++)
        ;
    else if (Xn(r)) {
      for (var a in r)
        if (r.hasOwnProperty(a) && (e = t(r[a], a), e === !1))
          break;
    }
  }
}
var wD = Object.keys ? function(r) {
  return Object.keys(r);
} : function(r) {
  var t = [];
  return Se(r, function(e, n) {
    Ur(r) && n === "prototype" || t.push(n);
  }), t;
};
function ED(r, t) {
  var e = wD(t), n = e.length;
  if (Tt(r))
    return !n;
  for (var i = 0; i < n; i += 1) {
    var a = e[i];
    if (t[a] !== r[a] || !(a in r))
      return !1;
  }
  return !0;
}
var Rv = function(r) {
  return typeof r == "object" && r !== null;
}, Rn = function(r) {
  if (!Rv(r) || !aa(r, "Object"))
    return !1;
  if (Object.getPrototypeOf(r) === null)
    return !0;
  for (var t = r; Object.getPrototypeOf(t) !== null; )
    t = Object.getPrototypeOf(t);
  return Object.getPrototypeOf(r) === t;
};
function P6(r, t) {
  if (!Dt(r))
    return null;
  var e;
  if (Ur(t) && (e = t), Rn(t) && (e = function(i) {
    return ED(i, t);
  }), e) {
    for (var n = 0; n < r.length; n += 1)
      if (e(r[n]))
        return r[n];
  }
  return null;
}
function O6(r, t, e) {
  e === void 0 && (e = 0);
  for (var n = e; n < r.length; n++)
    if (t(r[n], n))
      return n;
  return -1;
}
var D6 = function(r, t) {
  for (var e = null, n = 0; n < r.length; n++) {
    var i = r[n], a = i[t];
    if (!Tt(a)) {
      Dt(a) ? e = a[0] : e = a;
      break;
    }
  }
  return e;
}, k6 = function(r) {
  if (!Dt(r))
    return [];
  for (var t = [], e = 0; e < r.length; e++)
    t = t.concat(r[e]);
  return t;
}, SD = function(r, t) {
  if (t === void 0 && (t = []), !Dt(r))
    t.push(r);
  else
    for (var e = 0; e < r.length; e += 1)
      SD(r[e], t);
  return t;
};
const Gi = function(r) {
  if (!!Dt(r))
    return r.reduce(function(t, e) {
      return Math.max(t, e);
    }, r[0]);
}, Fi = function(r) {
  if (!!Dt(r))
    return r.reduce(function(t, e) {
      return Math.min(t, e);
    }, r[0]);
};
var MD = function(r) {
  var t = r.filter(function(o) {
    return !isNaN(o);
  });
  if (!t.length)
    return {
      min: 0,
      max: 0
    };
  if (Dt(r[0])) {
    for (var e = [], n = 0; n < r.length; n++)
      e = e.concat(r[n]);
    t = e;
  }
  var i = Gi(t), a = Fi(t);
  return {
    min: a,
    max: i
  };
}, CD = Array.prototype, L6 = CD.splice, N6 = CD.indexOf, R6 = function(r) {
  for (var t = [], e = 1; e < arguments.length; e++)
    t[e - 1] = arguments[e];
  for (var n = 0; n < t.length; n++)
    for (var i = t[n], a = -1; (a = N6.call(r, i)) > -1; )
      L6.call(r, a, 1);
  return r;
}, B6 = Array.prototype.splice, TD = function(t, e) {
  if (!fi(t))
    return [];
  for (var n = t ? e.length : 0, i = n - 1; n--; ) {
    var a = void 0, o = e[n];
    (n === i || o !== a) && (a = o, B6.call(t, o, 1));
  }
  return t;
}, AD = function(r, t, e) {
  if (!Dt(r) && !Rn(r))
    return r;
  var n = e;
  return Se(r, function(i, a) {
    n = t(n, i, a);
  }), n;
}, G6 = function(r, t) {
  var e = [];
  if (!fi(r))
    return e;
  for (var n = -1, i = [], a = r.length; ++n < a; ) {
    var o = r[n];
    t(o, n, r) && (e.push(o), i.push(n));
  }
  return TD(r, i), e;
};
const Qe = function(r) {
  return aa(r, "String");
};
function F6(r, t) {
  var e;
  if (Ur(t))
    e = function(i, a) {
      return t(i) - t(a);
    };
  else {
    var n = [];
    Qe(t) ? n.push(t) : Dt(t) && (n = t), e = function(i, a) {
      for (var o = 0; o < n.length; o += 1) {
        var s = n[o];
        if (i[s] > a[s])
          return 1;
        if (i[s] < a[s])
          return -1;
      }
      return 0;
    };
  }
  return r.sort(e), r;
}
function Cc(r, t) {
  t === void 0 && (t = /* @__PURE__ */ new Map());
  var e = [];
  if (Array.isArray(r))
    for (var n = 0, i = r.length; n < i; n++) {
      var a = r[n];
      t.has(a) || (e.push(a), t.set(a, !0));
    }
  return e;
}
var z6 = function() {
  for (var r = [], t = 0; t < arguments.length; t++)
    r[t] = arguments[t];
  return Cc([].concat.apply([], r));
};
const U6 = function(r, t) {
  for (var e = [], n = {}, i = 0; i < r.length; i++) {
    var a = r[i], o = a[t];
    if (!Tt(o)) {
      Dt(o) || (o = [o]);
      for (var s = 0; s < o.length; s++) {
        var u = o[s];
        n[u] || (e.push(u), n[u] = !0);
      }
    }
  }
  return e;
};
function Fa(r) {
  if (fi(r))
    return r[0];
}
function zi(r) {
  if (fi(r)) {
    var t = r;
    return t[t.length - 1];
  }
}
function j6(r, t) {
  return Dt(r) || Qe(r) ? r[0] === t : !1;
}
function $6(r, t) {
  return Dt(r) || Qe(r) ? r[r.length - 1] === t : !1;
}
var W6 = function(r, t) {
  for (var e = 0; e < r.length; e++)
    if (!t(r[e], e))
      return !1;
  return !0;
}, V6 = function(r, t) {
  for (var e = 0; e < r.length; e++)
    if (t(r[e], e))
      return !0;
  return !1;
}, X6 = Object.prototype.hasOwnProperty;
function Bv(r, t) {
  if (!t || !Dt(r))
    return {};
  for (var e = {}, n = Ur(t) ? t : function(s) {
    return s[t];
  }, i, a = 0; a < r.length; a++) {
    var o = r[a];
    i = n(o), X6.call(e, i) ? e[i].push(o) : e[i] = [o];
  }
  return e;
}
function ID(r, t) {
  if (!t)
    return {
      0: r
    };
  if (!Ur(t)) {
    var e = Dt(t) ? t : t.replace(/\s+/g, "").split("*");
    t = function(n) {
      for (var i = "_", a = 0, o = e.length; a < o; a++)
        i += n[e[a]] && n[e[a]].toString();
      return i;
    };
  }
  return Bv(r, t);
}
const Y6 = function(r, t) {
  if (!t)
    return [r];
  var e = ID(r, t), n = [];
  for (var i in e)
    n.push(e[i]);
  return n;
};
function H6(r, t) {
  return r["_wrap_" + t];
}
function If(r, t) {
  if (r["_wrap_" + t])
    return r["_wrap_" + t];
  var e = function(n) {
    r[t](n);
  };
  return r["_wrap_" + t] = e, e;
}
var tE = {};
function K6(r) {
  var t = tE[r];
  if (!t) {
    for (var e = r.toString(16), n = e.length; n < 6; n++)
      e = "0" + e;
    t = "#" + e, tE[r] = t;
  }
  return t;
}
function q6(r) {
  var t = 0, e = 0, n = 0, i = 0;
  return Dt(r) ? r.length === 1 ? t = e = n = i = r[0] : r.length === 2 ? (t = n = r[0], e = i = r[1]) : r.length === 3 ? (t = r[0], e = i = r[1], n = r[2]) : (t = r[0], e = r[1], n = r[2], i = r[3]) : t = e = n = i = r, {
    r1: t,
    r2: e,
    r3: n,
    r4: i
  };
}
var Z6 = function(r, t, e) {
  return r < t ? t : r > e ? e : r;
}, fv = function(r, t) {
  var e = t.toString(), n = e.indexOf(".");
  if (n === -1)
    return Math.round(r);
  var i = e.substr(n + 1).length;
  return i > 20 && (i = 20), parseFloat(r.toFixed(i));
}, At = function(r) {
  return aa(r, "Number");
}, Q6 = function(r) {
  return At(r) && r % 1 !== 0;
}, J6 = function(r) {
  return At(r) && r % 2 === 0;
}, ez = Number.isInteger ? Number.isInteger : function(r) {
  return At(r) && r % 1 === 0;
}, tz = function(r) {
  return At(r) && r < 0;
}, rz = 1e-5;
function PD(r, t, e) {
  return e === void 0 && (e = rz), Math.abs(r - t) < e;
}
var nz = function(r) {
  return At(r) && r % 2 !== 0;
}, iz = function(r) {
  return At(r) && r > 0;
};
const az = function(r, t) {
  if (!!Dt(r)) {
    for (var e, n = -1 / 0, i = 0; i < r.length; i++) {
      var a = r[i], o = Ur(t) ? t(a) : a[t];
      o > n && (e = a, n = o);
    }
    return e;
  }
}, oz = function(r, t) {
  if (!!Dt(r)) {
    for (var e, n = 1 / 0, i = 0; i < r.length; i++) {
      var a = r[i], o = Ur(t) ? t(a) : a[t];
      o < n && (e = a, n = o);
    }
    return e;
  }
};
var Ip = function(r, t) {
  return (r % t + t) % t;
}, sz = 180 / Math.PI, uz = function(r) {
  return sz * r;
};
const fz = parseInt;
var lz = Math.PI / 180, Pp = function(r) {
  return lz * r;
};
const rE = function(r, t) {
  return r.hasOwnProperty(t);
};
var $1 = Object.values ? function(r) {
  return Object.values(r);
} : function(r) {
  var t = [];
  return Se(r, function(e, n) {
    Ur(r) && n === "prototype" || t.push(e);
  }), t;
};
const cz = function(r, t) {
  return Nv($1(r), t);
}, el = function(r) {
  return Tt(r) ? "" : r.toString();
};
var hz = function(r) {
  return el(r).toLowerCase();
}, dz = function(r) {
  var t = el(r);
  return t.charAt(0).toLowerCase() + t.substring(1);
};
function vz(r, t) {
  return !r || !t ? r : r.replace(/\\?\{([^{}]+)\}/g, function(e, n) {
    return e.charAt(0) === "\\" ? e.slice(1) : t[n] === void 0 ? "" : t[n];
  });
}
var pz = function(r) {
  return el(r).toUpperCase();
}, Bf = function(r) {
  var t = el(r);
  return t.charAt(0).toUpperCase() + t.substring(1);
}, gz = {}.toString, OD = function(r) {
  return gz.call(r).replace(/^\[object /, "").replace(/]$/, "");
}, yz = function(r) {
  return aa(r, "Arguments");
}, W1 = function(r) {
  return aa(r, "Boolean");
}, V1 = function(r) {
  return aa(r, "Date");
}, mz = function(r) {
  return aa(r, "Error");
};
function bz(r) {
  return At(r) && isFinite(r);
}
var xz = function(r) {
  return r === null;
}, _z = Object.prototype, DD = function(r) {
  var t = r && r.constructor, e = typeof t == "function" && t.prototype || _z;
  return r === e;
}, wz = function(r) {
  return aa(r, "RegExp");
}, Ez = function(r) {
  return r === void 0;
}, Sz = function(r) {
  return r instanceof Element || r instanceof HTMLDocument;
};
function kD(r) {
  var t = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.msRequestAnimationFrame || function(e) {
    return setTimeout(e, 16);
  };
  return t(r);
}
function LD(r) {
  var t = window.cancelAnimationFrame || window.webkitCancelAnimationFrame || window.mozCancelAnimationFrame || window.msCancelAnimationFrame || clearTimeout;
  t(r);
}
function T0(r, t) {
  for (var e in t)
    t.hasOwnProperty(e) && e !== "constructor" && t[e] !== void 0 && (r[e] = t[e]);
}
function kt(r, t, e, n) {
  return t && T0(r, t), e && T0(r, e), n && T0(r, n), r;
}
var Mz = function() {
  for (var r = [], t = 0; t < arguments.length; t++)
    r[t] = arguments[t];
  for (var e = r[0], n = 1; n < r.length; n++) {
    var i = r[n];
    Ur(i) && (i = i.prototype), kt(e.prototype, i);
  }
}, vr = function(r) {
  if (typeof r != "object" || r === null)
    return r;
  var t;
  if (Dt(r)) {
    t = [];
    for (var e = 0, n = r.length; e < n; e++)
      typeof r[e] == "object" && r[e] != null ? t[e] = vr(r[e]) : t[e] = r[e];
  } else {
    t = {};
    for (var i in r)
      typeof r[i] == "object" && r[i] != null ? t[i] = vr(r[i]) : t[i] = r[i];
  }
  return t;
};
function Jc(r, t, e) {
  var n;
  return function() {
    var i = this, a = arguments, o = function() {
      n = null, e || r.apply(i, a);
    }, s = e && !n;
    clearTimeout(n), n = setTimeout(o, t), s && r.apply(i, a);
  };
}
const ND = function(r, t) {
  if (!Ur(r))
    throw new TypeError("Expected a function");
  var e = function() {
    for (var n = [], i = 0; i < arguments.length; i++)
      n[i] = arguments[i];
    var a = t ? t.apply(this, n) : n[0], o = e.cache;
    if (o.has(a))
      return o.get(a);
    var s = r.apply(this, n);
    return o.set(a, s), s;
  };
  return e.cache = /* @__PURE__ */ new Map(), e;
};
var Cz = 5;
function RD(r, t, e, n) {
  e = e || 0, n = n || Cz;
  for (var i in t)
    if (t.hasOwnProperty(i)) {
      var a = t[i];
      a !== null && Rn(a) ? (Rn(r[i]) || (r[i] = {}), e < n ? RD(r[i], a, e + 1, n) : r[i] = t[i]) : Dt(a) ? (r[i] = [], r[i] = r[i].concat(a)) : a !== void 0 && (r[i] = a);
    }
}
var kr = function(r) {
  for (var t = [], e = 1; e < arguments.length; e++)
    t[e - 1] = arguments[e];
  for (var n = 0; n < t.length; n += 1)
    RD(r, t[n]);
  return r;
}, Tz = function(r, t, e, n) {
  Ur(t) || (e = t, t = r, r = function() {
  });
  var i = Object.create ? function(o, s) {
    return Object.create(o, {
      constructor: {
        value: s
      }
    });
  } : function(o, s) {
    function u() {
    }
    u.prototype = o;
    var f = new u();
    return f.constructor = s, f;
  }, a = i(t.prototype, r);
  return r.prototype = kt(a, r.prototype), r.superclass = i(t.prototype, t), kt(a, e), kt(r, n), r;
}, X1 = function(r, t) {
  if (!fi(r))
    return -1;
  var e = Array.prototype.indexOf;
  if (e)
    return e.call(r, t);
  for (var n = -1, i = 0; i < r.length; i++)
    if (r[i] === t) {
      n = i;
      break;
    }
  return n;
}, Az = Object.prototype.hasOwnProperty;
function BD(r) {
  if (Tt(r))
    return !0;
  if (fi(r))
    return !r.length;
  var t = OD(r);
  if (t === "Map" || t === "Set")
    return !r.size;
  if (DD(r))
    return !Object.keys(r).length;
  for (var e in r)
    if (Az.call(r, e))
      return !1;
  return !0;
}
var ls = function(r, t) {
  if (r === t)
    return !0;
  if (!r || !t || Qe(r) || Qe(t))
    return !1;
  if (fi(r) || fi(t)) {
    if (r.length !== t.length)
      return !1;
    for (var e = !0, n = 0; n < r.length && (e = ls(r[n], t[n]), !!e); n++)
      ;
    return e;
  }
  if (Rv(r) || Rv(t)) {
    var i = Object.keys(r), a = Object.keys(t);
    if (i.length !== a.length)
      return !1;
    for (var e = !0, n = 0; n < i.length && (e = ls(r[i[n]], t[i[n]]), !!e); n++)
      ;
    return e;
  }
  return !1;
};
const Iz = function(r, t, e) {
  return Ur(e) ? !!e(r, t) : ls(r, t);
};
var vu = function(r, t) {
  if (!fi(r))
    return r;
  for (var e = [], n = 0; n < r.length; n++) {
    var i = r[n];
    e.push(t(i, n));
  }
  return e;
}, Pz = function(r) {
  return r;
};
const Oz = function(r, t) {
  t === void 0 && (t = Pz);
  var e = {};
  return Xn(r) && !Tt(r) && Object.keys(r).forEach(function(n) {
    e[n] = t(r[n], n);
  }), e;
}, co = function(r, t, e) {
  for (var n = 0, i = Qe(t) ? t.split(".") : t; r && n < i.length; )
    r = r[i[n++]];
  return r === void 0 || n < i.length ? e : r;
}, Dz = function(r, t, e) {
  var n = r, i = Qe(t) ? t.split(".") : t;
  return i.forEach(function(a, o) {
    o < i.length - 1 ? (Xn(n[a]) || (n[a] = At(i[o + 1]) ? [] : {}), n = n[a]) : n[a] = e;
  }), r;
};
var kz = Object.prototype.hasOwnProperty;
const Lz = function(r, t) {
  if (r === null || !Rn(r))
    return {};
  var e = {};
  return Se(t, function(n) {
    kz.call(r, n) && (e[n] = r[n]);
  }), e;
}, Nz = function(r, t) {
  return AD(r, function(e, n, i) {
    return t.includes(i) || (e[i] = n), e;
  }, {});
}, Y1 = function(r, t, e) {
  var n, i, a, o, s = 0;
  e || (e = {});
  var u = function() {
    s = e.leading === !1 ? 0 : Date.now(), n = null, o = r.apply(i, a), n || (i = a = null);
  }, f = function() {
    var l = Date.now();
    !s && e.leading === !1 && (s = l);
    var c = t - (l - s);
    return i = this, a = arguments, c <= 0 || c > t ? (n && (clearTimeout(n), n = null), s = l, o = r.apply(i, a), n || (i = a = null)) : !n && e.trailing !== !1 && (n = setTimeout(u, c)), o;
  };
  return f.cancel = function() {
    clearTimeout(n), s = 0, n = i = a = null;
  }, f;
}, GD = function(r) {
  return fi(r) ? Array.prototype.slice.call(r) : [];
};
var id = {};
const ja = function(r) {
  return r = r || "g", id[r] ? id[r] += 1 : id[r] = 1, r + id[r];
}, ec = function() {
}, Rz = function(r) {
  return r;
};
function Op(r) {
  return Tt(r) ? 0 : fi(r) ? r.length : Object.keys(r).length;
}
var ad;
const tc = ND(function(r, t) {
  t === void 0 && (t = {});
  var e = t.fontSize, n = t.fontFamily, i = t.fontWeight, a = t.fontStyle, o = t.fontVariant;
  return ad || (ad = document.createElement("canvas").getContext("2d")), ad.font = [a, o, i, e + "px", n].join(" "), ad.measureText(Qe(r) ? r : "").width;
}, function(r, t) {
  return t === void 0 && (t = {}), j1([r], $1(t)).join("");
}), Bz = function(r, t, e, n) {
  n === void 0 && (n = "...");
  var i = 16, a = tc(n, e), o = Qe(r) ? r : el(r), s = t, u = [], f, l;
  if (tc(r, e) <= t)
    return r;
  for (; f = o.substr(0, i), l = tc(f, e), !(l + a > s && l > s); )
    if (u.push(f), s -= l, o = o.substr(i), !o)
      return u.join("");
  for (; f = o.substr(0, 1), l = tc(f, e), !(l + a > s); )
    if (u.push(f), s -= l, o = o.substr(1), !o)
      return u.join("");
  return "" + u.join("") + n;
};
var Gz = function() {
  function r() {
    this.map = {};
  }
  return r.prototype.has = function(t) {
    return this.map[t] !== void 0;
  }, r.prototype.get = function(t, e) {
    var n = this.map[t];
    return n === void 0 ? e : n;
  }, r.prototype.set = function(t, e) {
    this.map[t] = e;
  }, r.prototype.clear = function() {
    this.map = {};
  }, r.prototype.delete = function(t) {
    delete this.map[t];
  }, r.prototype.size = function() {
    return Object.keys(this.map).length;
  }, r;
}();
const Fz = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  contains: Nv,
  includes: Nv,
  difference: A6,
  find: P6,
  findIndex: O6,
  firstValue: D6,
  flatten: k6,
  flattenDeep: SD,
  getRange: MD,
  pull: R6,
  pullAt: TD,
  reduce: AD,
  remove: G6,
  sortBy: F6,
  union: z6,
  uniq: Cc,
  valuesOfKey: U6,
  head: Fa,
  last: zi,
  startsWith: j6,
  endsWith: $6,
  filter: Ap,
  every: W6,
  some: V6,
  group: Y6,
  groupBy: Bv,
  groupToMap: ID,
  getWrapBehavior: H6,
  wrapBehavior: If,
  number2color: K6,
  parseRadius: q6,
  clamp: Z6,
  fixedBase: fv,
  isDecimal: Q6,
  isEven: J6,
  isInteger: ez,
  isNegative: tz,
  isNumberEqual: PD,
  isOdd: nz,
  isPositive: iz,
  max: Gi,
  maxBy: az,
  min: Fi,
  minBy: oz,
  mod: Ip,
  toDegree: uz,
  toInteger: fz,
  toRadian: Pp,
  forIn: Se,
  has: rE,
  hasKey: rE,
  hasValue: cz,
  keys: wD,
  isMatch: ED,
  values: $1,
  lowerCase: hz,
  lowerFirst: dz,
  substitute: vz,
  upperCase: pz,
  upperFirst: Bf,
  getType: OD,
  isArguments: yz,
  isArray: Dt,
  isArrayLike: fi,
  isBoolean: W1,
  isDate: V1,
  isError: mz,
  isFunction: Ur,
  isFinite: bz,
  isNil: Tt,
  isNull: xz,
  isNumber: At,
  isObject: Xn,
  isObjectLike: Rv,
  isPlainObject: Rn,
  isPrototype: DD,
  isRegExp: wz,
  isString: Qe,
  isType: aa,
  isUndefined: Ez,
  isElement: Sz,
  requestAnimationFrame: kD,
  clearAnimationFrame: LD,
  augment: Mz,
  clone: vr,
  debounce: Jc,
  memoize: ND,
  deepMix: kr,
  each: Se,
  extend: Tz,
  indexOf: X1,
  isEmpty: BD,
  isEqual: ls,
  isEqualWith: Iz,
  map: vu,
  mapValues: Oz,
  mix: kt,
  assign: kt,
  get: co,
  set: Dz,
  pick: Lz,
  omit: Nz,
  throttle: Y1,
  toArray: GD,
  toString: el,
  uniqueId: ja,
  noop: ec,
  identity: Rz,
  size: Op,
  measureTextWidth: tc,
  getEllipsisText: Bz,
  Cache: Gz
}, Symbol.toStringTag, { value: "Module" })), zz = {
  getDefaultCfg: function() {
    return {};
  },
  getEvents: function() {
    return {};
  },
  updateCfg: function(t) {
    return Object.assign(this, t), !0;
  },
  shouldBegin: function() {
    return !0;
  },
  shouldUpdate: function() {
    return !0;
  },
  shouldEnd: function() {
    return !0;
  },
  bind: function(t) {
    var e = this, n = this.events;
    this.graph = t, (this.type === "drag-canvas" || this.type === "brush-select" || this.type === "lasso-select") && t.get("canvas").set("draggable", !0), Se(n, function(i, a) {
      t.on(a, i);
    }), document.addEventListener("visibilitychange", function() {
      e.keydown = !1;
    });
  },
  unbind: function(t) {
    var e = this.events, n = t.get("canvas").get("draggable");
    (this.type === "drag-canvas" || this.type === "brush-select" || this.type === "lasso-select") && t.get("canvas").set("draggable", !1), Se(e, function(i, a) {
      t.off(a, i);
    }), t.get("canvas").set("draggable", n);
  },
  get: function(t) {
    return this[t];
  },
  set: function(t, e) {
    return this[t] = e, this;
  }
};
var H1 = function() {
  function r() {
  }
  return r.registerBehavior = function(t, e) {
    if (!e)
      throw new Error("please specify handler for this behavior: ".concat(t));
    var n = vr(zz);
    Object.assign(n, e);
    var i = function(o) {
      var s = this;
      Object.assign(this, this.getDefaultCfg(), o);
      var u = this.getEvents();
      this.events = null;
      var f = {};
      u && (Se(u, function(l, c) {
        f[c] = If(s, l);
      }), this.events = f);
    };
    i.prototype = n, r.types[t] = i;
  }, r.hasBehavior = function(t) {
    return !!r.types[t];
  }, r.getBehavior = function(t) {
    return r.types[t];
  }, r.types = {}, r;
}(), Uz = "*", FD = function() {
  function r() {
    this._events = {};
  }
  return r.prototype.on = function(t, e, n) {
    return this._events[t] || (this._events[t] = []), this._events[t].push({
      callback: e,
      once: !!n
    }), this;
  }, r.prototype.once = function(t, e) {
    return this.on(t, e, !0);
  }, r.prototype.emit = function(t) {
    for (var e = this, n = [], i = 1; i < arguments.length; i++)
      n[i - 1] = arguments[i];
    var a = this._events[t] || [], o = this._events[Uz] || [], s = function(u) {
      for (var f = u.length, l = 0; l < f; l++)
        if (!!u[l]) {
          var c = u[l], h = c.callback, d = c.once;
          d && (u.splice(l, 1), u.length === 0 && delete e._events[t], f--, l--), h.apply(e, n);
        }
    };
    s(a), s(o);
  }, r.prototype.off = function(t, e) {
    if (!t)
      this._events = {};
    else if (!e)
      delete this._events[t];
    else {
      for (var n = this._events[t] || [], i = n.length, a = 0; a < i; a++)
        n[a].callback === e && (n.splice(a, 1), i--, a--);
      n.length === 0 && delete this._events[t];
    }
    return this;
  }, r.prototype.getEvents = function() {
    return this._events;
  }, r;
}(), Bt = 1e-6, cr = typeof Float32Array < "u" ? Float32Array : Array, ta = Math.random;
function jz(r) {
  cr = r;
}
var $z = Math.PI / 180;
function Wz(r) {
  return r * $z;
}
function Vz(r, t) {
  return Math.abs(r - t) <= Bt * Math.max(1, Math.abs(r), Math.abs(t));
}
Math.hypot || (Math.hypot = function() {
  for (var r = 0, t = arguments.length; t--; )
    r += arguments[t] * arguments[t];
  return Math.sqrt(r);
});
const Xz = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  EPSILON: Bt,
  get ARRAY_TYPE() {
    return cr;
  },
  RANDOM: ta,
  setMatrixArrayType: jz,
  toRadian: Wz,
  equals: Vz
}, Symbol.toStringTag, { value: "Module" }));
function Yz() {
  var r = new cr(4);
  return cr != Float32Array && (r[1] = 0, r[2] = 0), r[0] = 1, r[3] = 1, r;
}
function Hz(r) {
  var t = new cr(4);
  return t[0] = r[0], t[1] = r[1], t[2] = r[2], t[3] = r[3], t;
}
function Kz(r, t) {
  return r[0] = t[0], r[1] = t[1], r[2] = t[2], r[3] = t[3], r;
}
function qz(r) {
  return r[0] = 1, r[1] = 0, r[2] = 0, r[3] = 1, r;
}
function Zz(r, t, e, n) {
  var i = new cr(4);
  return i[0] = r, i[1] = t, i[2] = e, i[3] = n, i;
}
function Qz(r, t, e, n, i) {
  return r[0] = t, r[1] = e, r[2] = n, r[3] = i, r;
}
function Jz(r, t) {
  if (r === t) {
    var e = t[1];
    r[1] = t[2], r[2] = e;
  } else
    r[0] = t[0], r[1] = t[2], r[2] = t[1], r[3] = t[3];
  return r;
}
function eU(r, t) {
  var e = t[0], n = t[1], i = t[2], a = t[3], o = e * a - i * n;
  return o ? (o = 1 / o, r[0] = a * o, r[1] = -n * o, r[2] = -i * o, r[3] = e * o, r) : null;
}
function tU(r, t) {
  var e = t[0];
  return r[0] = t[3], r[1] = -t[1], r[2] = -t[2], r[3] = e, r;
}
function rU(r) {
  return r[0] * r[3] - r[2] * r[1];
}
function zD(r, t, e) {
  var n = t[0], i = t[1], a = t[2], o = t[3], s = e[0], u = e[1], f = e[2], l = e[3];
  return r[0] = n * s + a * u, r[1] = i * s + o * u, r[2] = n * f + a * l, r[3] = i * f + o * l, r;
}
function nU(r, t, e) {
  var n = t[0], i = t[1], a = t[2], o = t[3], s = Math.sin(e), u = Math.cos(e);
  return r[0] = n * u + a * s, r[1] = i * u + o * s, r[2] = n * -s + a * u, r[3] = i * -s + o * u, r;
}
function iU(r, t, e) {
  var n = t[0], i = t[1], a = t[2], o = t[3], s = e[0], u = e[1];
  return r[0] = n * s, r[1] = i * s, r[2] = a * u, r[3] = o * u, r;
}
function aU(r, t) {
  var e = Math.sin(t), n = Math.cos(t);
  return r[0] = n, r[1] = e, r[2] = -e, r[3] = n, r;
}
function oU(r, t) {
  return r[0] = t[0], r[1] = 0, r[2] = 0, r[3] = t[1], r;
}
function sU(r) {
  return "mat2(" + r[0] + ", " + r[1] + ", " + r[2] + ", " + r[3] + ")";
}
function uU(r) {
  return Math.hypot(r[0], r[1], r[2], r[3]);
}
function fU(r, t, e, n) {
  return r[2] = n[2] / n[0], e[0] = n[0], e[1] = n[1], e[3] = n[3] - r[2] * e[1], [r, t, e];
}
function lU(r, t, e) {
  return r[0] = t[0] + e[0], r[1] = t[1] + e[1], r[2] = t[2] + e[2], r[3] = t[3] + e[3], r;
}
function UD(r, t, e) {
  return r[0] = t[0] - e[0], r[1] = t[1] - e[1], r[2] = t[2] - e[2], r[3] = t[3] - e[3], r;
}
function cU(r, t) {
  return r[0] === t[0] && r[1] === t[1] && r[2] === t[2] && r[3] === t[3];
}
function hU(r, t) {
  var e = r[0], n = r[1], i = r[2], a = r[3], o = t[0], s = t[1], u = t[2], f = t[3];
  return Math.abs(e - o) <= Bt * Math.max(1, Math.abs(e), Math.abs(o)) && Math.abs(n - s) <= Bt * Math.max(1, Math.abs(n), Math.abs(s)) && Math.abs(i - u) <= Bt * Math.max(1, Math.abs(i), Math.abs(u)) && Math.abs(a - f) <= Bt * Math.max(1, Math.abs(a), Math.abs(f));
}
function dU(r, t, e) {
  return r[0] = t[0] * e, r[1] = t[1] * e, r[2] = t[2] * e, r[3] = t[3] * e, r;
}
function vU(r, t, e, n) {
  return r[0] = t[0] + e[0] * n, r[1] = t[1] + e[1] * n, r[2] = t[2] + e[2] * n, r[3] = t[3] + e[3] * n, r;
}
var pU = zD, gU = UD;
const yU = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  create: Yz,
  clone: Hz,
  copy: Kz,
  identity: qz,
  fromValues: Zz,
  set: Qz,
  transpose: Jz,
  invert: eU,
  adjoint: tU,
  determinant: rU,
  multiply: zD,
  rotate: nU,
  scale: iU,
  fromRotation: aU,
  fromScaling: oU,
  str: sU,
  frob: uU,
  LDU: fU,
  add: lU,
  subtract: UD,
  exactEquals: cU,
  equals: hU,
  multiplyScalar: dU,
  multiplyScalarAndAdd: vU,
  mul: pU,
  sub: gU
}, Symbol.toStringTag, { value: "Module" }));
function mU() {
  var r = new cr(6);
  return cr != Float32Array && (r[1] = 0, r[2] = 0, r[4] = 0, r[5] = 0), r[0] = 1, r[3] = 1, r;
}
function bU(r) {
  var t = new cr(6);
  return t[0] = r[0], t[1] = r[1], t[2] = r[2], t[3] = r[3], t[4] = r[4], t[5] = r[5], t;
}
function xU(r, t) {
  return r[0] = t[0], r[1] = t[1], r[2] = t[2], r[3] = t[3], r[4] = t[4], r[5] = t[5], r;
}
function _U(r) {
  return r[0] = 1, r[1] = 0, r[2] = 0, r[3] = 1, r[4] = 0, r[5] = 0, r;
}
function wU(r, t, e, n, i, a) {
  var o = new cr(6);
  return o[0] = r, o[1] = t, o[2] = e, o[3] = n, o[4] = i, o[5] = a, o;
}
function EU(r, t, e, n, i, a, o) {
  return r[0] = t, r[1] = e, r[2] = n, r[3] = i, r[4] = a, r[5] = o, r;
}
function SU(r, t) {
  var e = t[0], n = t[1], i = t[2], a = t[3], o = t[4], s = t[5], u = e * a - n * i;
  return u ? (u = 1 / u, r[0] = a * u, r[1] = -n * u, r[2] = -i * u, r[3] = e * u, r[4] = (i * s - a * o) * u, r[5] = (n * o - e * s) * u, r) : null;
}
function MU(r) {
  return r[0] * r[3] - r[1] * r[2];
}
function jD(r, t, e) {
  var n = t[0], i = t[1], a = t[2], o = t[3], s = t[4], u = t[5], f = e[0], l = e[1], c = e[2], h = e[3], d = e[4], v = e[5];
  return r[0] = n * f + a * l, r[1] = i * f + o * l, r[2] = n * c + a * h, r[3] = i * c + o * h, r[4] = n * d + a * v + s, r[5] = i * d + o * v + u, r;
}
function CU(r, t, e) {
  var n = t[0], i = t[1], a = t[2], o = t[3], s = t[4], u = t[5], f = Math.sin(e), l = Math.cos(e);
  return r[0] = n * l + a * f, r[1] = i * l + o * f, r[2] = n * -f + a * l, r[3] = i * -f + o * l, r[4] = s, r[5] = u, r;
}
function TU(r, t, e) {
  var n = t[0], i = t[1], a = t[2], o = t[3], s = t[4], u = t[5], f = e[0], l = e[1];
  return r[0] = n * f, r[1] = i * f, r[2] = a * l, r[3] = o * l, r[4] = s, r[5] = u, r;
}
function AU(r, t, e) {
  var n = t[0], i = t[1], a = t[2], o = t[3], s = t[4], u = t[5], f = e[0], l = e[1];
  return r[0] = n, r[1] = i, r[2] = a, r[3] = o, r[4] = n * f + a * l + s, r[5] = i * f + o * l + u, r;
}
function IU(r, t) {
  var e = Math.sin(t), n = Math.cos(t);
  return r[0] = n, r[1] = e, r[2] = -e, r[3] = n, r[4] = 0, r[5] = 0, r;
}
function PU(r, t) {
  return r[0] = t[0], r[1] = 0, r[2] = 0, r[3] = t[1], r[4] = 0, r[5] = 0, r;
}
function OU(r, t) {
  return r[0] = 1, r[1] = 0, r[2] = 0, r[3] = 1, r[4] = t[0], r[5] = t[1], r;
}
function DU(r) {
  return "mat2d(" + r[0] + ", " + r[1] + ", " + r[2] + ", " + r[3] + ", " + r[4] + ", " + r[5] + ")";
}
function kU(r) {
  return Math.hypot(r[0], r[1], r[2], r[3], r[4], r[5], 1);
}
function LU(r, t, e) {
  return r[0] = t[0] + e[0], r[1] = t[1] + e[1], r[2] = t[2] + e[2], r[3] = t[3] + e[3], r[4] = t[4] + e[4], r[5] = t[5] + e[5], r;
}
function $D(r, t, e) {
  return r[0] = t[0] - e[0], r[1] = t[1] - e[1], r[2] = t[2] - e[2], r[3] = t[3] - e[3], r[4] = t[4] - e[4], r[5] = t[5] - e[5], r;
}
function NU(r, t, e) {
  return r[0] = t[0] * e, r[1] = t[1] * e, r[2] = t[2] * e, r[3] = t[3] * e, r[4] = t[4] * e, r[5] = t[5] * e, r;
}
function RU(r, t, e, n) {
  return r[0] = t[0] + e[0] * n, r[1] = t[1] + e[1] * n, r[2] = t[2] + e[2] * n, r[3] = t[3] + e[3] * n, r[4] = t[4] + e[4] * n, r[5] = t[5] + e[5] * n, r;
}
function BU(r, t) {
  return r[0] === t[0] && r[1] === t[1] && r[2] === t[2] && r[3] === t[3] && r[4] === t[4] && r[5] === t[5];
}
function GU(r, t) {
  var e = r[0], n = r[1], i = r[2], a = r[3], o = r[4], s = r[5], u = t[0], f = t[1], l = t[2], c = t[3], h = t[4], d = t[5];
  return Math.abs(e - u) <= Bt * Math.max(1, Math.abs(e), Math.abs(u)) && Math.abs(n - f) <= Bt * Math.max(1, Math.abs(n), Math.abs(f)) && Math.abs(i - l) <= Bt * Math.max(1, Math.abs(i), Math.abs(l)) && Math.abs(a - c) <= Bt * Math.max(1, Math.abs(a), Math.abs(c)) && Math.abs(o - h) <= Bt * Math.max(1, Math.abs(o), Math.abs(h)) && Math.abs(s - d) <= Bt * Math.max(1, Math.abs(s), Math.abs(d));
}
var FU = jD, zU = $D;
const UU = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  create: mU,
  clone: bU,
  copy: xU,
  identity: _U,
  fromValues: wU,
  set: EU,
  invert: SU,
  determinant: MU,
  multiply: jD,
  rotate: CU,
  scale: TU,
  translate: AU,
  fromRotation: IU,
  fromScaling: PU,
  fromTranslation: OU,
  str: DU,
  frob: kU,
  add: LU,
  subtract: $D,
  multiplyScalar: NU,
  multiplyScalarAndAdd: RU,
  exactEquals: BU,
  equals: GU,
  mul: FU,
  sub: zU
}, Symbol.toStringTag, { value: "Module" }));
function tl() {
  var r = new cr(9);
  return cr != Float32Array && (r[1] = 0, r[2] = 0, r[3] = 0, r[5] = 0, r[6] = 0, r[7] = 0), r[0] = 1, r[4] = 1, r[8] = 1, r;
}
function WD(r, t) {
  return r[0] = t[0], r[1] = t[1], r[2] = t[2], r[3] = t[4], r[4] = t[5], r[5] = t[6], r[6] = t[8], r[7] = t[9], r[8] = t[10], r;
}
function jU(r) {
  var t = new cr(9);
  return t[0] = r[0], t[1] = r[1], t[2] = r[2], t[3] = r[3], t[4] = r[4], t[5] = r[5], t[6] = r[6], t[7] = r[7], t[8] = r[8], t;
}
function $U(r, t) {
  return r[0] = t[0], r[1] = t[1], r[2] = t[2], r[3] = t[3], r[4] = t[4], r[5] = t[5], r[6] = t[6], r[7] = t[7], r[8] = t[8], r;
}
function WU(r, t, e, n, i, a, o, s, u) {
  var f = new cr(9);
  return f[0] = r, f[1] = t, f[2] = e, f[3] = n, f[4] = i, f[5] = a, f[6] = o, f[7] = s, f[8] = u, f;
}
function VU(r, t, e, n, i, a, o, s, u, f) {
  return r[0] = t, r[1] = e, r[2] = n, r[3] = i, r[4] = a, r[5] = o, r[6] = s, r[7] = u, r[8] = f, r;
}
function XU(r) {
  return r[0] = 1, r[1] = 0, r[2] = 0, r[3] = 0, r[4] = 1, r[5] = 0, r[6] = 0, r[7] = 0, r[8] = 1, r;
}
function YU(r, t) {
  if (r === t) {
    var e = t[1], n = t[2], i = t[5];
    r[1] = t[3], r[2] = t[6], r[3] = e, r[5] = t[7], r[6] = n, r[7] = i;
  } else
    r[0] = t[0], r[1] = t[3], r[2] = t[6], r[3] = t[1], r[4] = t[4], r[5] = t[7], r[6] = t[2], r[7] = t[5], r[8] = t[8];
  return r;
}
function K1(r, t) {
  var e = t[0], n = t[1], i = t[2], a = t[3], o = t[4], s = t[5], u = t[6], f = t[7], l = t[8], c = l * o - s * f, h = -l * a + s * u, d = f * a - o * u, v = e * c + n * h + i * d;
  return v ? (v = 1 / v, r[0] = c * v, r[1] = (-l * n + i * f) * v, r[2] = (s * n - i * o) * v, r[3] = h * v, r[4] = (l * e - i * u) * v, r[5] = (-s * e + i * a) * v, r[6] = d * v, r[7] = (-f * e + n * u) * v, r[8] = (o * e - n * a) * v, r) : null;
}
function HU(r, t) {
  var e = t[0], n = t[1], i = t[2], a = t[3], o = t[4], s = t[5], u = t[6], f = t[7], l = t[8];
  return r[0] = o * l - s * f, r[1] = i * f - n * l, r[2] = n * s - i * o, r[3] = s * u - a * l, r[4] = e * l - i * u, r[5] = i * a - e * s, r[6] = a * f - o * u, r[7] = n * u - e * f, r[8] = e * o - n * a, r;
}
function KU(r) {
  var t = r[0], e = r[1], n = r[2], i = r[3], a = r[4], o = r[5], s = r[6], u = r[7], f = r[8];
  return t * (f * a - o * u) + e * (-f * i + o * s) + n * (u * i - a * s);
}
function rl(r, t, e) {
  var n = t[0], i = t[1], a = t[2], o = t[3], s = t[4], u = t[5], f = t[6], l = t[7], c = t[8], h = e[0], d = e[1], v = e[2], p = e[3], g = e[4], y = e[5], b = e[6], m = e[7], x = e[8];
  return r[0] = h * n + d * o + v * f, r[1] = h * i + d * s + v * l, r[2] = h * a + d * u + v * c, r[3] = p * n + g * o + y * f, r[4] = p * i + g * s + y * l, r[5] = p * a + g * u + y * c, r[6] = b * n + m * o + x * f, r[7] = b * i + m * s + x * l, r[8] = b * a + m * u + x * c, r;
}
function qU(r, t, e) {
  var n = t[0], i = t[1], a = t[2], o = t[3], s = t[4], u = t[5], f = t[6], l = t[7], c = t[8], h = e[0], d = e[1];
  return r[0] = n, r[1] = i, r[2] = a, r[3] = o, r[4] = s, r[5] = u, r[6] = h * n + d * o + f, r[7] = h * i + d * s + l, r[8] = h * a + d * u + c, r;
}
function ZU(r, t, e) {
  var n = t[0], i = t[1], a = t[2], o = t[3], s = t[4], u = t[5], f = t[6], l = t[7], c = t[8], h = Math.sin(e), d = Math.cos(e);
  return r[0] = d * n + h * o, r[1] = d * i + h * s, r[2] = d * a + h * u, r[3] = d * o - h * n, r[4] = d * s - h * i, r[5] = d * u - h * a, r[6] = f, r[7] = l, r[8] = c, r;
}
function QU(r, t, e) {
  var n = e[0], i = e[1];
  return r[0] = n * t[0], r[1] = n * t[1], r[2] = n * t[2], r[3] = i * t[3], r[4] = i * t[4], r[5] = i * t[5], r[6] = t[6], r[7] = t[7], r[8] = t[8], r;
}
function VD(r, t) {
  return r[0] = 1, r[1] = 0, r[2] = 0, r[3] = 0, r[4] = 1, r[5] = 0, r[6] = t[0], r[7] = t[1], r[8] = 1, r;
}
function XD(r, t) {
  var e = Math.sin(t), n = Math.cos(t);
  return r[0] = n, r[1] = e, r[2] = 0, r[3] = -e, r[4] = n, r[5] = 0, r[6] = 0, r[7] = 0, r[8] = 1, r;
}
function YD(r, t) {
  return r[0] = t[0], r[1] = 0, r[2] = 0, r[3] = 0, r[4] = t[1], r[5] = 0, r[6] = 0, r[7] = 0, r[8] = 1, r;
}
function JU(r, t) {
  return r[0] = t[0], r[1] = t[1], r[2] = 0, r[3] = t[2], r[4] = t[3], r[5] = 0, r[6] = t[4], r[7] = t[5], r[8] = 1, r;
}
function ej(r, t) {
  var e = t[0], n = t[1], i = t[2], a = t[3], o = e + e, s = n + n, u = i + i, f = e * o, l = n * o, c = n * s, h = i * o, d = i * s, v = i * u, p = a * o, g = a * s, y = a * u;
  return r[0] = 1 - c - v, r[3] = l - y, r[6] = h + g, r[1] = l + y, r[4] = 1 - f - v, r[7] = d - p, r[2] = h - g, r[5] = d + p, r[8] = 1 - f - c, r;
}
function HD(r, t) {
  var e = t[0], n = t[1], i = t[2], a = t[3], o = t[4], s = t[5], u = t[6], f = t[7], l = t[8], c = t[9], h = t[10], d = t[11], v = t[12], p = t[13], g = t[14], y = t[15], b = e * s - n * o, m = e * u - i * o, x = e * f - a * o, _ = n * u - i * s, w = n * f - a * s, E = i * f - a * u, M = l * p - c * v, C = l * g - h * v, S = l * y - d * v, A = c * g - h * p, T = c * y - d * p, P = h * y - d * g, k = b * P - m * T + x * A + _ * S - w * C + E * M;
  return k ? (k = 1 / k, r[0] = (s * P - u * T + f * A) * k, r[1] = (u * S - o * P - f * C) * k, r[2] = (o * T - s * S + f * M) * k, r[3] = (i * T - n * P - a * A) * k, r[4] = (e * P - i * S + a * C) * k, r[5] = (n * S - e * T - a * M) * k, r[6] = (p * E - g * w + y * _) * k, r[7] = (g * x - v * E - y * m) * k, r[8] = (v * w - p * x + y * b) * k, r) : null;
}
function tj(r, t, e) {
  return r[0] = 2 / t, r[1] = 0, r[2] = 0, r[3] = 0, r[4] = -2 / e, r[5] = 0, r[6] = -1, r[7] = 1, r[8] = 1, r;
}
function rj(r) {
  return "mat3(" + r[0] + ", " + r[1] + ", " + r[2] + ", " + r[3] + ", " + r[4] + ", " + r[5] + ", " + r[6] + ", " + r[7] + ", " + r[8] + ")";
}
function nj(r) {
  return Math.hypot(r[0], r[1], r[2], r[3], r[4], r[5], r[6], r[7], r[8]);
}
function ij(r, t, e) {
  return r[0] = t[0] + e[0], r[1] = t[1] + e[1], r[2] = t[2] + e[2], r[3] = t[3] + e[3], r[4] = t[4] + e[4], r[5] = t[5] + e[5], r[6] = t[6] + e[6], r[7] = t[7] + e[7], r[8] = t[8] + e[8], r;
}
function KD(r, t, e) {
  return r[0] = t[0] - e[0], r[1] = t[1] - e[1], r[2] = t[2] - e[2], r[3] = t[3] - e[3], r[4] = t[4] - e[4], r[5] = t[5] - e[5], r[6] = t[6] - e[6], r[7] = t[7] - e[7], r[8] = t[8] - e[8], r;
}
function aj(r, t, e) {
  return r[0] = t[0] * e, r[1] = t[1] * e, r[2] = t[2] * e, r[3] = t[3] * e, r[4] = t[4] * e, r[5] = t[5] * e, r[6] = t[6] * e, r[7] = t[7] * e, r[8] = t[8] * e, r;
}
function oj(r, t, e, n) {
  return r[0] = t[0] + e[0] * n, r[1] = t[1] + e[1] * n, r[2] = t[2] + e[2] * n, r[3] = t[3] + e[3] * n, r[4] = t[4] + e[4] * n, r[5] = t[5] + e[5] * n, r[6] = t[6] + e[6] * n, r[7] = t[7] + e[7] * n, r[8] = t[8] + e[8] * n, r;
}
function sj(r, t) {
  return r[0] === t[0] && r[1] === t[1] && r[2] === t[2] && r[3] === t[3] && r[4] === t[4] && r[5] === t[5] && r[6] === t[6] && r[7] === t[7] && r[8] === t[8];
}
function uj(r, t) {
  var e = r[0], n = r[1], i = r[2], a = r[3], o = r[4], s = r[5], u = r[6], f = r[7], l = r[8], c = t[0], h = t[1], d = t[2], v = t[3], p = t[4], g = t[5], y = t[6], b = t[7], m = t[8];
  return Math.abs(e - c) <= Bt * Math.max(1, Math.abs(e), Math.abs(c)) && Math.abs(n - h) <= Bt * Math.max(1, Math.abs(n), Math.abs(h)) && Math.abs(i - d) <= Bt * Math.max(1, Math.abs(i), Math.abs(d)) && Math.abs(a - v) <= Bt * Math.max(1, Math.abs(a), Math.abs(v)) && Math.abs(o - p) <= Bt * Math.max(1, Math.abs(o), Math.abs(p)) && Math.abs(s - g) <= Bt * Math.max(1, Math.abs(s), Math.abs(g)) && Math.abs(u - y) <= Bt * Math.max(1, Math.abs(u), Math.abs(y)) && Math.abs(f - b) <= Bt * Math.max(1, Math.abs(f), Math.abs(b)) && Math.abs(l - m) <= Bt * Math.max(1, Math.abs(l), Math.abs(m));
}
var fj = rl, lj = KD;
const qD = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  create: tl,
  fromMat4: WD,
  clone: jU,
  copy: $U,
  fromValues: WU,
  set: VU,
  identity: XU,
  transpose: YU,
  invert: K1,
  adjoint: HU,
  determinant: KU,
  multiply: rl,
  translate: qU,
  rotate: ZU,
  scale: QU,
  fromTranslation: VD,
  fromRotation: XD,
  fromScaling: YD,
  fromMat2d: JU,
  fromQuat: ej,
  normalFromMat4: HD,
  projection: tj,
  str: rj,
  frob: nj,
  add: ij,
  subtract: KD,
  multiplyScalar: aj,
  multiplyScalarAndAdd: oj,
  exactEquals: sj,
  equals: uj,
  mul: fj,
  sub: lj
}, Symbol.toStringTag, { value: "Module" }));
function Jn() {
  var r = new cr(16);
  return cr != Float32Array && (r[1] = 0, r[2] = 0, r[3] = 0, r[4] = 0, r[6] = 0, r[7] = 0, r[8] = 0, r[9] = 0, r[11] = 0, r[12] = 0, r[13] = 0, r[14] = 0), r[0] = 1, r[5] = 1, r[10] = 1, r[15] = 1, r;
}
function ZD(r) {
  var t = new cr(16);
  return t[0] = r[0], t[1] = r[1], t[2] = r[2], t[3] = r[3], t[4] = r[4], t[5] = r[5], t[6] = r[6], t[7] = r[7], t[8] = r[8], t[9] = r[9], t[10] = r[10], t[11] = r[11], t[12] = r[12], t[13] = r[13], t[14] = r[14], t[15] = r[15], t;
}
function Gv(r, t) {
  return r[0] = t[0], r[1] = t[1], r[2] = t[2], r[3] = t[3], r[4] = t[4], r[5] = t[5], r[6] = t[6], r[7] = t[7], r[8] = t[8], r[9] = t[9], r[10] = t[10], r[11] = t[11], r[12] = t[12], r[13] = t[13], r[14] = t[14], r[15] = t[15], r;
}
function cj(r, t, e, n, i, a, o, s, u, f, l, c, h, d, v, p) {
  var g = new cr(16);
  return g[0] = r, g[1] = t, g[2] = e, g[3] = n, g[4] = i, g[5] = a, g[6] = o, g[7] = s, g[8] = u, g[9] = f, g[10] = l, g[11] = c, g[12] = h, g[13] = d, g[14] = v, g[15] = p, g;
}
function hj(r, t, e, n, i, a, o, s, u, f, l, c, h, d, v, p, g) {
  return r[0] = t, r[1] = e, r[2] = n, r[3] = i, r[4] = a, r[5] = o, r[6] = s, r[7] = u, r[8] = f, r[9] = l, r[10] = c, r[11] = h, r[12] = d, r[13] = v, r[14] = p, r[15] = g, r;
}
function q1(r) {
  return r[0] = 1, r[1] = 0, r[2] = 0, r[3] = 0, r[4] = 0, r[5] = 1, r[6] = 0, r[7] = 0, r[8] = 0, r[9] = 0, r[10] = 1, r[11] = 0, r[12] = 0, r[13] = 0, r[14] = 0, r[15] = 1, r;
}
function dj(r, t) {
  if (r === t) {
    var e = t[1], n = t[2], i = t[3], a = t[6], o = t[7], s = t[11];
    r[1] = t[4], r[2] = t[8], r[3] = t[12], r[4] = e, r[6] = t[9], r[7] = t[13], r[8] = n, r[9] = a, r[11] = t[14], r[12] = i, r[13] = o, r[14] = s;
  } else
    r[0] = t[0], r[1] = t[4], r[2] = t[8], r[3] = t[12], r[4] = t[1], r[5] = t[5], r[6] = t[9], r[7] = t[13], r[8] = t[2], r[9] = t[6], r[10] = t[10], r[11] = t[14], r[12] = t[3], r[13] = t[7], r[14] = t[11], r[15] = t[15];
  return r;
}
function Tc(r, t) {
  var e = t[0], n = t[1], i = t[2], a = t[3], o = t[4], s = t[5], u = t[6], f = t[7], l = t[8], c = t[9], h = t[10], d = t[11], v = t[12], p = t[13], g = t[14], y = t[15], b = e * s - n * o, m = e * u - i * o, x = e * f - a * o, _ = n * u - i * s, w = n * f - a * s, E = i * f - a * u, M = l * p - c * v, C = l * g - h * v, S = l * y - d * v, A = c * g - h * p, T = c * y - d * p, P = h * y - d * g, k = b * P - m * T + x * A + _ * S - w * C + E * M;
  return k ? (k = 1 / k, r[0] = (s * P - u * T + f * A) * k, r[1] = (i * T - n * P - a * A) * k, r[2] = (p * E - g * w + y * _) * k, r[3] = (h * w - c * E - d * _) * k, r[4] = (u * S - o * P - f * C) * k, r[5] = (e * P - i * S + a * C) * k, r[6] = (g * x - v * E - y * m) * k, r[7] = (l * E - h * x + d * m) * k, r[8] = (o * T - s * S + f * M) * k, r[9] = (n * S - e * T - a * M) * k, r[10] = (v * w - p * x + y * b) * k, r[11] = (c * x - l * w - d * b) * k, r[12] = (s * C - o * A - u * M) * k, r[13] = (e * A - n * C + i * M) * k, r[14] = (p * m - v * _ - g * b) * k, r[15] = (l * _ - c * m + h * b) * k, r) : null;
}
function vj(r, t) {
  var e = t[0], n = t[1], i = t[2], a = t[3], o = t[4], s = t[5], u = t[6], f = t[7], l = t[8], c = t[9], h = t[10], d = t[11], v = t[12], p = t[13], g = t[14], y = t[15];
  return r[0] = s * (h * y - d * g) - c * (u * y - f * g) + p * (u * d - f * h), r[1] = -(n * (h * y - d * g) - c * (i * y - a * g) + p * (i * d - a * h)), r[2] = n * (u * y - f * g) - s * (i * y - a * g) + p * (i * f - a * u), r[3] = -(n * (u * d - f * h) - s * (i * d - a * h) + c * (i * f - a * u)), r[4] = -(o * (h * y - d * g) - l * (u * y - f * g) + v * (u * d - f * h)), r[5] = e * (h * y - d * g) - l * (i * y - a * g) + v * (i * d - a * h), r[6] = -(e * (u * y - f * g) - o * (i * y - a * g) + v * (i * f - a * u)), r[7] = e * (u * d - f * h) - o * (i * d - a * h) + l * (i * f - a * u), r[8] = o * (c * y - d * p) - l * (s * y - f * p) + v * (s * d - f * c), r[9] = -(e * (c * y - d * p) - l * (n * y - a * p) + v * (n * d - a * c)), r[10] = e * (s * y - f * p) - o * (n * y - a * p) + v * (n * f - a * s), r[11] = -(e * (s * d - f * c) - o * (n * d - a * c) + l * (n * f - a * s)), r[12] = -(o * (c * g - h * p) - l * (s * g - u * p) + v * (s * h - u * c)), r[13] = e * (c * g - h * p) - l * (n * g - i * p) + v * (n * h - i * c), r[14] = -(e * (s * g - u * p) - o * (n * g - i * p) + v * (n * u - i * s)), r[15] = e * (s * h - u * c) - o * (n * h - i * c) + l * (n * u - i * s), r;
}
function pj(r) {
  var t = r[0], e = r[1], n = r[2], i = r[3], a = r[4], o = r[5], s = r[6], u = r[7], f = r[8], l = r[9], c = r[10], h = r[11], d = r[12], v = r[13], p = r[14], g = r[15], y = t * o - e * a, b = t * s - n * a, m = t * u - i * a, x = e * s - n * o, _ = e * u - i * o, w = n * u - i * s, E = f * v - l * d, M = f * p - c * d, C = f * g - h * d, S = l * p - c * v, A = l * g - h * v, T = c * g - h * p;
  return y * T - b * A + m * S + x * C - _ * M + w * E;
}
function wo(r, t, e) {
  var n = t[0], i = t[1], a = t[2], o = t[3], s = t[4], u = t[5], f = t[6], l = t[7], c = t[8], h = t[9], d = t[10], v = t[11], p = t[12], g = t[13], y = t[14], b = t[15], m = e[0], x = e[1], _ = e[2], w = e[3];
  return r[0] = m * n + x * s + _ * c + w * p, r[1] = m * i + x * u + _ * h + w * g, r[2] = m * a + x * f + _ * d + w * y, r[3] = m * o + x * l + _ * v + w * b, m = e[4], x = e[5], _ = e[6], w = e[7], r[4] = m * n + x * s + _ * c + w * p, r[5] = m * i + x * u + _ * h + w * g, r[6] = m * a + x * f + _ * d + w * y, r[7] = m * o + x * l + _ * v + w * b, m = e[8], x = e[9], _ = e[10], w = e[11], r[8] = m * n + x * s + _ * c + w * p, r[9] = m * i + x * u + _ * h + w * g, r[10] = m * a + x * f + _ * d + w * y, r[11] = m * o + x * l + _ * v + w * b, m = e[12], x = e[13], _ = e[14], w = e[15], r[12] = m * n + x * s + _ * c + w * p, r[13] = m * i + x * u + _ * h + w * g, r[14] = m * a + x * f + _ * d + w * y, r[15] = m * o + x * l + _ * v + w * b, r;
}
function pf(r, t, e) {
  var n = e[0], i = e[1], a = e[2], o, s, u, f, l, c, h, d, v, p, g, y;
  return t === r ? (r[12] = t[0] * n + t[4] * i + t[8] * a + t[12], r[13] = t[1] * n + t[5] * i + t[9] * a + t[13], r[14] = t[2] * n + t[6] * i + t[10] * a + t[14], r[15] = t[3] * n + t[7] * i + t[11] * a + t[15]) : (o = t[0], s = t[1], u = t[2], f = t[3], l = t[4], c = t[5], h = t[6], d = t[7], v = t[8], p = t[9], g = t[10], y = t[11], r[0] = o, r[1] = s, r[2] = u, r[3] = f, r[4] = l, r[5] = c, r[6] = h, r[7] = d, r[8] = v, r[9] = p, r[10] = g, r[11] = y, r[12] = o * n + l * i + v * a + t[12], r[13] = s * n + c * i + p * a + t[13], r[14] = u * n + h * i + g * a + t[14], r[15] = f * n + d * i + y * a + t[15]), r;
}
function gj(r, t, e) {
  var n = e[0], i = e[1], a = e[2];
  return r[0] = t[0] * n, r[1] = t[1] * n, r[2] = t[2] * n, r[3] = t[3] * n, r[4] = t[4] * i, r[5] = t[5] * i, r[6] = t[6] * i, r[7] = t[7] * i, r[8] = t[8] * a, r[9] = t[9] * a, r[10] = t[10] * a, r[11] = t[11] * a, r[12] = t[12], r[13] = t[13], r[14] = t[14], r[15] = t[15], r;
}
function yj(r, t, e, n) {
  var i = n[0], a = n[1], o = n[2], s = Math.hypot(i, a, o), u, f, l, c, h, d, v, p, g, y, b, m, x, _, w, E, M, C, S, A, T, P, k, L;
  return s < Bt ? null : (s = 1 / s, i *= s, a *= s, o *= s, u = Math.sin(e), f = Math.cos(e), l = 1 - f, c = t[0], h = t[1], d = t[2], v = t[3], p = t[4], g = t[5], y = t[6], b = t[7], m = t[8], x = t[9], _ = t[10], w = t[11], E = i * i * l + f, M = a * i * l + o * u, C = o * i * l - a * u, S = i * a * l - o * u, A = a * a * l + f, T = o * a * l + i * u, P = i * o * l + a * u, k = a * o * l - i * u, L = o * o * l + f, r[0] = c * E + p * M + m * C, r[1] = h * E + g * M + x * C, r[2] = d * E + y * M + _ * C, r[3] = v * E + b * M + w * C, r[4] = c * S + p * A + m * T, r[5] = h * S + g * A + x * T, r[6] = d * S + y * A + _ * T, r[7] = v * S + b * A + w * T, r[8] = c * P + p * k + m * L, r[9] = h * P + g * k + x * L, r[10] = d * P + y * k + _ * L, r[11] = v * P + b * k + w * L, t !== r && (r[12] = t[12], r[13] = t[13], r[14] = t[14], r[15] = t[15]), r);
}
function QD(r, t, e) {
  var n = Math.sin(e), i = Math.cos(e), a = t[4], o = t[5], s = t[6], u = t[7], f = t[8], l = t[9], c = t[10], h = t[11];
  return t !== r && (r[0] = t[0], r[1] = t[1], r[2] = t[2], r[3] = t[3], r[12] = t[12], r[13] = t[13], r[14] = t[14], r[15] = t[15]), r[4] = a * i + f * n, r[5] = o * i + l * n, r[6] = s * i + c * n, r[7] = u * i + h * n, r[8] = f * i - a * n, r[9] = l * i - o * n, r[10] = c * i - s * n, r[11] = h * i - u * n, r;
}
function JD(r, t, e) {
  var n = Math.sin(e), i = Math.cos(e), a = t[0], o = t[1], s = t[2], u = t[3], f = t[8], l = t[9], c = t[10], h = t[11];
  return t !== r && (r[4] = t[4], r[5] = t[5], r[6] = t[6], r[7] = t[7], r[12] = t[12], r[13] = t[13], r[14] = t[14], r[15] = t[15]), r[0] = a * i - f * n, r[1] = o * i - l * n, r[2] = s * i - c * n, r[3] = u * i - h * n, r[8] = a * n + f * i, r[9] = o * n + l * i, r[10] = s * n + c * i, r[11] = u * n + h * i, r;
}
function mj(r, t, e) {
  var n = Math.sin(e), i = Math.cos(e), a = t[0], o = t[1], s = t[2], u = t[3], f = t[4], l = t[5], c = t[6], h = t[7];
  return t !== r && (r[8] = t[8], r[9] = t[9], r[10] = t[10], r[11] = t[11], r[12] = t[12], r[13] = t[13], r[14] = t[14], r[15] = t[15]), r[0] = a * i + f * n, r[1] = o * i + l * n, r[2] = s * i + c * n, r[3] = u * i + h * n, r[4] = f * i - a * n, r[5] = l * i - o * n, r[6] = c * i - s * n, r[7] = h * i - u * n, r;
}
function bj(r, t) {
  return r[0] = 1, r[1] = 0, r[2] = 0, r[3] = 0, r[4] = 0, r[5] = 1, r[6] = 0, r[7] = 0, r[8] = 0, r[9] = 0, r[10] = 1, r[11] = 0, r[12] = t[0], r[13] = t[1], r[14] = t[2], r[15] = 1, r;
}
function xj(r, t) {
  return r[0] = t[0], r[1] = 0, r[2] = 0, r[3] = 0, r[4] = 0, r[5] = t[1], r[6] = 0, r[7] = 0, r[8] = 0, r[9] = 0, r[10] = t[2], r[11] = 0, r[12] = 0, r[13] = 0, r[14] = 0, r[15] = 1, r;
}
function _j(r, t, e) {
  var n = e[0], i = e[1], a = e[2], o = Math.hypot(n, i, a), s, u, f;
  return o < Bt ? null : (o = 1 / o, n *= o, i *= o, a *= o, s = Math.sin(t), u = Math.cos(t), f = 1 - u, r[0] = n * n * f + u, r[1] = i * n * f + a * s, r[2] = a * n * f - i * s, r[3] = 0, r[4] = n * i * f - a * s, r[5] = i * i * f + u, r[6] = a * i * f + n * s, r[7] = 0, r[8] = n * a * f + i * s, r[9] = i * a * f - n * s, r[10] = a * a * f + u, r[11] = 0, r[12] = 0, r[13] = 0, r[14] = 0, r[15] = 1, r);
}
function wj(r, t) {
  var e = Math.sin(t), n = Math.cos(t);
  return r[0] = 1, r[1] = 0, r[2] = 0, r[3] = 0, r[4] = 0, r[5] = n, r[6] = e, r[7] = 0, r[8] = 0, r[9] = -e, r[10] = n, r[11] = 0, r[12] = 0, r[13] = 0, r[14] = 0, r[15] = 1, r;
}
function Ej(r, t) {
  var e = Math.sin(t), n = Math.cos(t);
  return r[0] = n, r[1] = 0, r[2] = -e, r[3] = 0, r[4] = 0, r[5] = 1, r[6] = 0, r[7] = 0, r[8] = e, r[9] = 0, r[10] = n, r[11] = 0, r[12] = 0, r[13] = 0, r[14] = 0, r[15] = 1, r;
}
function Sj(r, t) {
  var e = Math.sin(t), n = Math.cos(t);
  return r[0] = n, r[1] = e, r[2] = 0, r[3] = 0, r[4] = -e, r[5] = n, r[6] = 0, r[7] = 0, r[8] = 0, r[9] = 0, r[10] = 1, r[11] = 0, r[12] = 0, r[13] = 0, r[14] = 0, r[15] = 1, r;
}
function ek(r, t, e) {
  var n = t[0], i = t[1], a = t[2], o = t[3], s = n + n, u = i + i, f = a + a, l = n * s, c = n * u, h = n * f, d = i * u, v = i * f, p = a * f, g = o * s, y = o * u, b = o * f;
  return r[0] = 1 - (d + p), r[1] = c + b, r[2] = h - y, r[3] = 0, r[4] = c - b, r[5] = 1 - (l + p), r[6] = v + g, r[7] = 0, r[8] = h + y, r[9] = v - g, r[10] = 1 - (l + d), r[11] = 0, r[12] = e[0], r[13] = e[1], r[14] = e[2], r[15] = 1, r;
}
function Mj(r, t) {
  var e = new cr(3), n = -t[0], i = -t[1], a = -t[2], o = t[3], s = t[4], u = t[5], f = t[6], l = t[7], c = n * n + i * i + a * a + o * o;
  return c > 0 ? (e[0] = (s * o + l * n + u * a - f * i) * 2 / c, e[1] = (u * o + l * i + f * n - s * a) * 2 / c, e[2] = (f * o + l * a + s * i - u * n) * 2 / c) : (e[0] = (s * o + l * n + u * a - f * i) * 2, e[1] = (u * o + l * i + f * n - s * a) * 2, e[2] = (f * o + l * a + s * i - u * n) * 2), ek(r, t, e), r;
}
function eu(r, t) {
  return r[0] = t[12], r[1] = t[13], r[2] = t[14], r;
}
function tu(r, t) {
  var e = t[0], n = t[1], i = t[2], a = t[4], o = t[5], s = t[6], u = t[8], f = t[9], l = t[10];
  return r[0] = Math.hypot(e, n, i), r[1] = Math.hypot(a, o, s), r[2] = Math.hypot(u, f, l), r;
}
function ru(r, t) {
  var e = new cr(3);
  tu(e, t);
  var n = 1 / e[0], i = 1 / e[1], a = 1 / e[2], o = t[0] * n, s = t[1] * i, u = t[2] * a, f = t[4] * n, l = t[5] * i, c = t[6] * a, h = t[8] * n, d = t[9] * i, v = t[10] * a, p = o + l + v, g = 0;
  return p > 0 ? (g = Math.sqrt(p + 1) * 2, r[3] = 0.25 * g, r[0] = (c - d) / g, r[1] = (h - u) / g, r[2] = (s - f) / g) : o > l && o > v ? (g = Math.sqrt(1 + o - l - v) * 2, r[3] = (c - d) / g, r[0] = 0.25 * g, r[1] = (s + f) / g, r[2] = (h + u) / g) : l > v ? (g = Math.sqrt(1 + l - o - v) * 2, r[3] = (h - u) / g, r[0] = (s + f) / g, r[1] = 0.25 * g, r[2] = (c + d) / g) : (g = Math.sqrt(1 + v - o - l) * 2, r[3] = (s - f) / g, r[0] = (h + u) / g, r[1] = (c + d) / g, r[2] = 0.25 * g), r;
}
function tk(r, t, e, n) {
  var i = t[0], a = t[1], o = t[2], s = t[3], u = i + i, f = a + a, l = o + o, c = i * u, h = i * f, d = i * l, v = a * f, p = a * l, g = o * l, y = s * u, b = s * f, m = s * l, x = n[0], _ = n[1], w = n[2];
  return r[0] = (1 - (v + g)) * x, r[1] = (h + m) * x, r[2] = (d - b) * x, r[3] = 0, r[4] = (h - m) * _, r[5] = (1 - (c + g)) * _, r[6] = (p + y) * _, r[7] = 0, r[8] = (d + b) * w, r[9] = (p - y) * w, r[10] = (1 - (c + v)) * w, r[11] = 0, r[12] = e[0], r[13] = e[1], r[14] = e[2], r[15] = 1, r;
}
function Cj(r, t, e, n, i) {
  var a = t[0], o = t[1], s = t[2], u = t[3], f = a + a, l = o + o, c = s + s, h = a * f, d = a * l, v = a * c, p = o * l, g = o * c, y = s * c, b = u * f, m = u * l, x = u * c, _ = n[0], w = n[1], E = n[2], M = i[0], C = i[1], S = i[2], A = (1 - (p + y)) * _, T = (d + x) * _, P = (v - m) * _, k = (d - x) * w, L = (1 - (h + y)) * w, O = (g + b) * w, D = (v + m) * E, G = (g - b) * E, R = (1 - (h + p)) * E;
  return r[0] = A, r[1] = T, r[2] = P, r[3] = 0, r[4] = k, r[5] = L, r[6] = O, r[7] = 0, r[8] = D, r[9] = G, r[10] = R, r[11] = 0, r[12] = e[0] + M - (A * M + k * C + D * S), r[13] = e[1] + C - (T * M + L * C + G * S), r[14] = e[2] + S - (P * M + O * C + R * S), r[15] = 1, r;
}
function Ky(r, t) {
  var e = t[0], n = t[1], i = t[2], a = t[3], o = e + e, s = n + n, u = i + i, f = e * o, l = n * o, c = n * s, h = i * o, d = i * s, v = i * u, p = a * o, g = a * s, y = a * u;
  return r[0] = 1 - c - v, r[1] = l + y, r[2] = h - g, r[3] = 0, r[4] = l - y, r[5] = 1 - f - v, r[6] = d + p, r[7] = 0, r[8] = h + g, r[9] = d - p, r[10] = 1 - f - c, r[11] = 0, r[12] = 0, r[13] = 0, r[14] = 0, r[15] = 1, r;
}
function Tj(r, t, e, n, i, a, o) {
  var s = 1 / (e - t), u = 1 / (i - n), f = 1 / (a - o);
  return r[0] = a * 2 * s, r[1] = 0, r[2] = 0, r[3] = 0, r[4] = 0, r[5] = a * 2 * u, r[6] = 0, r[7] = 0, r[8] = (e + t) * s, r[9] = (i + n) * u, r[10] = (o + a) * f, r[11] = -1, r[12] = 0, r[13] = 0, r[14] = o * a * 2 * f, r[15] = 0, r;
}
function rk(r, t, e, n, i) {
  var a = 1 / Math.tan(t / 2), o;
  return r[0] = a / e, r[1] = 0, r[2] = 0, r[3] = 0, r[4] = 0, r[5] = a, r[6] = 0, r[7] = 0, r[8] = 0, r[9] = 0, r[11] = -1, r[12] = 0, r[13] = 0, r[15] = 0, i != null && i !== 1 / 0 ? (o = 1 / (n - i), r[10] = (i + n) * o, r[14] = 2 * i * n * o) : (r[10] = -1, r[14] = -2 * n), r;
}
var nk = rk;
function Aj(r, t, e, n, i) {
  var a = 1 / Math.tan(t / 2), o;
  return r[0] = a / e, r[1] = 0, r[2] = 0, r[3] = 0, r[4] = 0, r[5] = a, r[6] = 0, r[7] = 0, r[8] = 0, r[9] = 0, r[11] = -1, r[12] = 0, r[13] = 0, r[15] = 0, i != null && i !== 1 / 0 ? (o = 1 / (n - i), r[10] = i * o, r[14] = i * n * o) : (r[10] = -1, r[14] = -n), r;
}
function Ij(r, t, e, n) {
  var i = Math.tan(t.upDegrees * Math.PI / 180), a = Math.tan(t.downDegrees * Math.PI / 180), o = Math.tan(t.leftDegrees * Math.PI / 180), s = Math.tan(t.rightDegrees * Math.PI / 180), u = 2 / (o + s), f = 2 / (i + a);
  return r[0] = u, r[1] = 0, r[2] = 0, r[3] = 0, r[4] = 0, r[5] = f, r[6] = 0, r[7] = 0, r[8] = -((o - s) * u * 0.5), r[9] = (i - a) * f * 0.5, r[10] = n / (e - n), r[11] = -1, r[12] = 0, r[13] = 0, r[14] = n * e / (e - n), r[15] = 0, r;
}
function ik(r, t, e, n, i, a, o) {
  var s = 1 / (t - e), u = 1 / (n - i), f = 1 / (a - o);
  return r[0] = -2 * s, r[1] = 0, r[2] = 0, r[3] = 0, r[4] = 0, r[5] = -2 * u, r[6] = 0, r[7] = 0, r[8] = 0, r[9] = 0, r[10] = 2 * f, r[11] = 0, r[12] = (t + e) * s, r[13] = (i + n) * u, r[14] = (o + a) * f, r[15] = 1, r;
}
var ak = ik;
function Pj(r, t, e, n, i, a, o) {
  var s = 1 / (t - e), u = 1 / (n - i), f = 1 / (a - o);
  return r[0] = -2 * s, r[1] = 0, r[2] = 0, r[3] = 0, r[4] = 0, r[5] = -2 * u, r[6] = 0, r[7] = 0, r[8] = 0, r[9] = 0, r[10] = f, r[11] = 0, r[12] = (t + e) * s, r[13] = (i + n) * u, r[14] = a * f, r[15] = 1, r;
}
function ok(r, t, e, n) {
  var i, a, o, s, u, f, l, c, h, d, v = t[0], p = t[1], g = t[2], y = n[0], b = n[1], m = n[2], x = e[0], _ = e[1], w = e[2];
  return Math.abs(v - x) < Bt && Math.abs(p - _) < Bt && Math.abs(g - w) < Bt ? q1(r) : (l = v - x, c = p - _, h = g - w, d = 1 / Math.hypot(l, c, h), l *= d, c *= d, h *= d, i = b * h - m * c, a = m * l - y * h, o = y * c - b * l, d = Math.hypot(i, a, o), d ? (d = 1 / d, i *= d, a *= d, o *= d) : (i = 0, a = 0, o = 0), s = c * o - h * a, u = h * i - l * o, f = l * a - c * i, d = Math.hypot(s, u, f), d ? (d = 1 / d, s *= d, u *= d, f *= d) : (s = 0, u = 0, f = 0), r[0] = i, r[1] = s, r[2] = l, r[3] = 0, r[4] = a, r[5] = u, r[6] = c, r[7] = 0, r[8] = o, r[9] = f, r[10] = h, r[11] = 0, r[12] = -(i * v + a * p + o * g), r[13] = -(s * v + u * p + f * g), r[14] = -(l * v + c * p + h * g), r[15] = 1, r);
}
function Oj(r, t, e, n) {
  var i = t[0], a = t[1], o = t[2], s = n[0], u = n[1], f = n[2], l = i - e[0], c = a - e[1], h = o - e[2], d = l * l + c * c + h * h;
  d > 0 && (d = 1 / Math.sqrt(d), l *= d, c *= d, h *= d);
  var v = u * h - f * c, p = f * l - s * h, g = s * c - u * l;
  return d = v * v + p * p + g * g, d > 0 && (d = 1 / Math.sqrt(d), v *= d, p *= d, g *= d), r[0] = v, r[1] = p, r[2] = g, r[3] = 0, r[4] = c * g - h * p, r[5] = h * v - l * g, r[6] = l * p - c * v, r[7] = 0, r[8] = l, r[9] = c, r[10] = h, r[11] = 0, r[12] = i, r[13] = a, r[14] = o, r[15] = 1, r;
}
function Dj(r) {
  return "mat4(" + r[0] + ", " + r[1] + ", " + r[2] + ", " + r[3] + ", " + r[4] + ", " + r[5] + ", " + r[6] + ", " + r[7] + ", " + r[8] + ", " + r[9] + ", " + r[10] + ", " + r[11] + ", " + r[12] + ", " + r[13] + ", " + r[14] + ", " + r[15] + ")";
}
function kj(r) {
  return Math.hypot(r[0], r[1], r[2], r[3], r[4], r[5], r[6], r[7], r[8], r[9], r[10], r[11], r[12], r[13], r[14], r[15]);
}
function Lj(r, t, e) {
  return r[0] = t[0] + e[0], r[1] = t[1] + e[1], r[2] = t[2] + e[2], r[3] = t[3] + e[3], r[4] = t[4] + e[4], r[5] = t[5] + e[5], r[6] = t[6] + e[6], r[7] = t[7] + e[7], r[8] = t[8] + e[8], r[9] = t[9] + e[9], r[10] = t[10] + e[10], r[11] = t[11] + e[11], r[12] = t[12] + e[12], r[13] = t[13] + e[13], r[14] = t[14] + e[14], r[15] = t[15] + e[15], r;
}
function sk(r, t, e) {
  return r[0] = t[0] - e[0], r[1] = t[1] - e[1], r[2] = t[2] - e[2], r[3] = t[3] - e[3], r[4] = t[4] - e[4], r[5] = t[5] - e[5], r[6] = t[6] - e[6], r[7] = t[7] - e[7], r[8] = t[8] - e[8], r[9] = t[9] - e[9], r[10] = t[10] - e[10], r[11] = t[11] - e[11], r[12] = t[12] - e[12], r[13] = t[13] - e[13], r[14] = t[14] - e[14], r[15] = t[15] - e[15], r;
}
function Nj(r, t, e) {
  return r[0] = t[0] * e, r[1] = t[1] * e, r[2] = t[2] * e, r[3] = t[3] * e, r[4] = t[4] * e, r[5] = t[5] * e, r[6] = t[6] * e, r[7] = t[7] * e, r[8] = t[8] * e, r[9] = t[9] * e, r[10] = t[10] * e, r[11] = t[11] * e, r[12] = t[12] * e, r[13] = t[13] * e, r[14] = t[14] * e, r[15] = t[15] * e, r;
}
function Rj(r, t, e, n) {
  return r[0] = t[0] + e[0] * n, r[1] = t[1] + e[1] * n, r[2] = t[2] + e[2] * n, r[3] = t[3] + e[3] * n, r[4] = t[4] + e[4] * n, r[5] = t[5] + e[5] * n, r[6] = t[6] + e[6] * n, r[7] = t[7] + e[7] * n, r[8] = t[8] + e[8] * n, r[9] = t[9] + e[9] * n, r[10] = t[10] + e[10] * n, r[11] = t[11] + e[11] * n, r[12] = t[12] + e[12] * n, r[13] = t[13] + e[13] * n, r[14] = t[14] + e[14] * n, r[15] = t[15] + e[15] * n, r;
}
function Bj(r, t) {
  return r[0] === t[0] && r[1] === t[1] && r[2] === t[2] && r[3] === t[3] && r[4] === t[4] && r[5] === t[5] && r[6] === t[6] && r[7] === t[7] && r[8] === t[8] && r[9] === t[9] && r[10] === t[10] && r[11] === t[11] && r[12] === t[12] && r[13] === t[13] && r[14] === t[14] && r[15] === t[15];
}
function Gj(r, t) {
  var e = r[0], n = r[1], i = r[2], a = r[3], o = r[4], s = r[5], u = r[6], f = r[7], l = r[8], c = r[9], h = r[10], d = r[11], v = r[12], p = r[13], g = r[14], y = r[15], b = t[0], m = t[1], x = t[2], _ = t[3], w = t[4], E = t[5], M = t[6], C = t[7], S = t[8], A = t[9], T = t[10], P = t[11], k = t[12], L = t[13], O = t[14], D = t[15];
  return Math.abs(e - b) <= Bt * Math.max(1, Math.abs(e), Math.abs(b)) && Math.abs(n - m) <= Bt * Math.max(1, Math.abs(n), Math.abs(m)) && Math.abs(i - x) <= Bt * Math.max(1, Math.abs(i), Math.abs(x)) && Math.abs(a - _) <= Bt * Math.max(1, Math.abs(a), Math.abs(_)) && Math.abs(o - w) <= Bt * Math.max(1, Math.abs(o), Math.abs(w)) && Math.abs(s - E) <= Bt * Math.max(1, Math.abs(s), Math.abs(E)) && Math.abs(u - M) <= Bt * Math.max(1, Math.abs(u), Math.abs(M)) && Math.abs(f - C) <= Bt * Math.max(1, Math.abs(f), Math.abs(C)) && Math.abs(l - S) <= Bt * Math.max(1, Math.abs(l), Math.abs(S)) && Math.abs(c - A) <= Bt * Math.max(1, Math.abs(c), Math.abs(A)) && Math.abs(h - T) <= Bt * Math.max(1, Math.abs(h), Math.abs(T)) && Math.abs(d - P) <= Bt * Math.max(1, Math.abs(d), Math.abs(P)) && Math.abs(v - k) <= Bt * Math.max(1, Math.abs(v), Math.abs(k)) && Math.abs(p - L) <= Bt * Math.max(1, Math.abs(p), Math.abs(L)) && Math.abs(g - O) <= Bt * Math.max(1, Math.abs(g), Math.abs(O)) && Math.abs(y - D) <= Bt * Math.max(1, Math.abs(y), Math.abs(D));
}
var Fj = wo, zj = sk;
const Uj = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  create: Jn,
  clone: ZD,
  copy: Gv,
  fromValues: cj,
  set: hj,
  identity: q1,
  transpose: dj,
  invert: Tc,
  adjoint: vj,
  determinant: pj,
  multiply: wo,
  translate: pf,
  scale: gj,
  rotate: yj,
  rotateX: QD,
  rotateY: JD,
  rotateZ: mj,
  fromTranslation: bj,
  fromScaling: xj,
  fromRotation: _j,
  fromXRotation: wj,
  fromYRotation: Ej,
  fromZRotation: Sj,
  fromRotationTranslation: ek,
  fromQuat2: Mj,
  getTranslation: eu,
  getScaling: tu,
  getRotation: ru,
  fromRotationTranslationScale: tk,
  fromRotationTranslationScaleOrigin: Cj,
  fromQuat: Ky,
  frustum: Tj,
  perspectiveNO: rk,
  perspective: nk,
  perspectiveZO: Aj,
  perspectiveFromFieldOfView: Ij,
  orthoNO: ik,
  ortho: ak,
  orthoZO: Pj,
  lookAt: ok,
  targetTo: Oj,
  str: Dj,
  frob: kj,
  add: Lj,
  subtract: sk,
  multiplyScalar: Nj,
  multiplyScalarAndAdd: Rj,
  exactEquals: Bj,
  equals: Gj,
  mul: Fj,
  sub: zj
}, Symbol.toStringTag, { value: "Module" }));
function Tr() {
  var r = new cr(3);
  return cr != Float32Array && (r[0] = 0, r[1] = 0, r[2] = 0), r;
}
function Ma(r) {
  var t = new cr(3);
  return t[0] = r[0], t[1] = r[1], t[2] = r[2], t;
}
function cc(r) {
  var t = r[0], e = r[1], n = r[2];
  return Math.hypot(t, e, n);
}
function rr(r, t, e) {
  var n = new cr(3);
  return n[0] = r, n[1] = t, n[2] = e, n;
}
function Ln(r, t) {
  return r[0] = t[0], r[1] = t[1], r[2] = t[2], r;
}
function Hs(r, t, e, n) {
  return r[0] = t, r[1] = e, r[2] = n, r;
}
function Ia(r, t, e) {
  return r[0] = t[0] + e[0], r[1] = t[1] + e[1], r[2] = t[2] + e[2], r;
}
function Fv(r, t, e) {
  return r[0] = t[0] - e[0], r[1] = t[1] - e[1], r[2] = t[2] - e[2], r;
}
function Z1(r, t, e) {
  return r[0] = t[0] * e[0], r[1] = t[1] * e[1], r[2] = t[2] * e[2], r;
}
function uk(r, t, e) {
  return r[0] = t[0] / e[0], r[1] = t[1] / e[1], r[2] = t[2] / e[2], r;
}
function jj(r, t) {
  return r[0] = Math.ceil(t[0]), r[1] = Math.ceil(t[1]), r[2] = Math.ceil(t[2]), r;
}
function $j(r, t) {
  return r[0] = Math.floor(t[0]), r[1] = Math.floor(t[1]), r[2] = Math.floor(t[2]), r;
}
function Wj(r, t, e) {
  return r[0] = Math.min(t[0], e[0]), r[1] = Math.min(t[1], e[1]), r[2] = Math.min(t[2], e[2]), r;
}
function Vj(r, t, e) {
  return r[0] = Math.max(t[0], e[0]), r[1] = Math.max(t[1], e[1]), r[2] = Math.max(t[2], e[2]), r;
}
function Xj(r, t) {
  return r[0] = Math.round(t[0]), r[1] = Math.round(t[1]), r[2] = Math.round(t[2]), r;
}
function Gf(r, t, e) {
  return r[0] = t[0] * e, r[1] = t[1] * e, r[2] = t[2] * e, r;
}
function Yj(r, t, e, n) {
  return r[0] = t[0] + e[0] * n, r[1] = t[1] + e[1] * n, r[2] = t[2] + e[2] * n, r;
}
function fk(r, t) {
  var e = t[0] - r[0], n = t[1] - r[1], i = t[2] - r[2];
  return Math.hypot(e, n, i);
}
function lk(r, t) {
  var e = t[0] - r[0], n = t[1] - r[1], i = t[2] - r[2];
  return e * e + n * n + i * i;
}
function ck(r) {
  var t = r[0], e = r[1], n = r[2];
  return t * t + e * e + n * n;
}
function Hj(r, t) {
  return r[0] = -t[0], r[1] = -t[1], r[2] = -t[2], r;
}
function Kj(r, t) {
  return r[0] = 1 / t[0], r[1] = 1 / t[1], r[2] = 1 / t[2], r;
}
function Pf(r, t) {
  var e = t[0], n = t[1], i = t[2], a = e * e + n * n + i * i;
  return a > 0 && (a = 1 / Math.sqrt(a)), r[0] = t[0] * a, r[1] = t[1] * a, r[2] = t[2] * a, r;
}
function Ff(r, t) {
  return r[0] * t[0] + r[1] * t[1] + r[2] * t[2];
}
function lv(r, t, e) {
  var n = t[0], i = t[1], a = t[2], o = e[0], s = e[1], u = e[2];
  return r[0] = i * u - a * s, r[1] = a * o - n * u, r[2] = n * s - i * o, r;
}
function cs(r, t, e, n) {
  var i = t[0], a = t[1], o = t[2];
  return r[0] = i + n * (e[0] - i), r[1] = a + n * (e[1] - a), r[2] = o + n * (e[2] - o), r;
}
function qj(r, t, e, n, i, a) {
  var o = a * a, s = o * (2 * a - 3) + 1, u = o * (a - 2) + a, f = o * (a - 1), l = o * (3 - 2 * a);
  return r[0] = t[0] * s + e[0] * u + n[0] * f + i[0] * l, r[1] = t[1] * s + e[1] * u + n[1] * f + i[1] * l, r[2] = t[2] * s + e[2] * u + n[2] * f + i[2] * l, r;
}
function Zj(r, t, e, n, i, a) {
  var o = 1 - a, s = o * o, u = a * a, f = s * o, l = 3 * a * s, c = 3 * u * o, h = u * a;
  return r[0] = t[0] * f + e[0] * l + n[0] * c + i[0] * h, r[1] = t[1] * f + e[1] * l + n[1] * c + i[1] * h, r[2] = t[2] * f + e[2] * l + n[2] * c + i[2] * h, r;
}
function Qj(r, t) {
  t = t || 1;
  var e = ta() * 2 * Math.PI, n = ta() * 2 - 1, i = Math.sqrt(1 - n * n) * t;
  return r[0] = Math.cos(e) * i, r[1] = Math.sin(e) * i, r[2] = n * t, r;
}
function Dp(r, t, e) {
  var n = t[0], i = t[1], a = t[2], o = e[3] * n + e[7] * i + e[11] * a + e[15];
  return o = o || 1, r[0] = (e[0] * n + e[4] * i + e[8] * a + e[12]) / o, r[1] = (e[1] * n + e[5] * i + e[9] * a + e[13]) / o, r[2] = (e[2] * n + e[6] * i + e[10] * a + e[14]) / o, r;
}
function Mu(r, t, e) {
  var n = t[0], i = t[1], a = t[2];
  return r[0] = n * e[0] + i * e[3] + a * e[6], r[1] = n * e[1] + i * e[4] + a * e[7], r[2] = n * e[2] + i * e[5] + a * e[8], r;
}
function hk(r, t, e) {
  var n = e[0], i = e[1], a = e[2], o = e[3], s = t[0], u = t[1], f = t[2], l = i * f - a * u, c = a * s - n * f, h = n * u - i * s, d = i * h - a * c, v = a * l - n * h, p = n * c - i * l, g = o * 2;
  return l *= g, c *= g, h *= g, d *= 2, v *= 2, p *= 2, r[0] = s + l + d, r[1] = u + c + v, r[2] = f + h + p, r;
}
function Jj(r, t, e, n) {
  var i = [], a = [];
  return i[0] = t[0] - e[0], i[1] = t[1] - e[1], i[2] = t[2] - e[2], a[0] = i[0], a[1] = i[1] * Math.cos(n) - i[2] * Math.sin(n), a[2] = i[1] * Math.sin(n) + i[2] * Math.cos(n), r[0] = a[0] + e[0], r[1] = a[1] + e[1], r[2] = a[2] + e[2], r;
}
function e$(r, t, e, n) {
  var i = [], a = [];
  return i[0] = t[0] - e[0], i[1] = t[1] - e[1], i[2] = t[2] - e[2], a[0] = i[2] * Math.sin(n) + i[0] * Math.cos(n), a[1] = i[1], a[2] = i[2] * Math.cos(n) - i[0] * Math.sin(n), r[0] = a[0] + e[0], r[1] = a[1] + e[1], r[2] = a[2] + e[2], r;
}
function t$(r, t, e, n) {
  var i = [], a = [];
  return i[0] = t[0] - e[0], i[1] = t[1] - e[1], i[2] = t[2] - e[2], a[0] = i[0] * Math.cos(n) - i[1] * Math.sin(n), a[1] = i[0] * Math.sin(n) + i[1] * Math.cos(n), a[2] = i[2], r[0] = a[0] + e[0], r[1] = a[1] + e[1], r[2] = a[2] + e[2], r;
}
function r$(r, t) {
  var e = r[0], n = r[1], i = r[2], a = t[0], o = t[1], s = t[2], u = Math.sqrt(e * e + n * n + i * i), f = Math.sqrt(a * a + o * o + s * s), l = u * f, c = l && Ff(r, t) / l;
  return Math.acos(Math.min(Math.max(c, -1), 1));
}
function n$(r) {
  return r[0] = 0, r[1] = 0, r[2] = 0, r;
}
function i$(r) {
  return "vec3(" + r[0] + ", " + r[1] + ", " + r[2] + ")";
}
function a$(r, t) {
  return r[0] === t[0] && r[1] === t[1] && r[2] === t[2];
}
function o$(r, t) {
  var e = r[0], n = r[1], i = r[2], a = t[0], o = t[1], s = t[2];
  return Math.abs(e - a) <= Bt * Math.max(1, Math.abs(e), Math.abs(a)) && Math.abs(n - o) <= Bt * Math.max(1, Math.abs(n), Math.abs(o)) && Math.abs(i - s) <= Bt * Math.max(1, Math.abs(i), Math.abs(s));
}
var zv = Fv, s$ = Z1, u$ = uk, qy = fk, f$ = lk, Q1 = cc, l$ = ck, c$ = function() {
  var r = Tr();
  return function(t, e, n, i, a, o) {
    var s, u;
    for (e || (e = 3), n || (n = 0), i ? u = Math.min(i * e + n, t.length) : u = t.length, s = n; s < u; s += e)
      r[0] = t[s], r[1] = t[s + 1], r[2] = t[s + 2], a(r, r, o), t[s] = r[0], t[s + 1] = r[1], t[s + 2] = r[2];
    return t;
  };
}();
const h$ = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  create: Tr,
  clone: Ma,
  length: cc,
  fromValues: rr,
  copy: Ln,
  set: Hs,
  add: Ia,
  subtract: Fv,
  multiply: Z1,
  divide: uk,
  ceil: jj,
  floor: $j,
  min: Wj,
  max: Vj,
  round: Xj,
  scale: Gf,
  scaleAndAdd: Yj,
  distance: fk,
  squaredDistance: lk,
  squaredLength: ck,
  negate: Hj,
  inverse: Kj,
  normalize: Pf,
  dot: Ff,
  cross: lv,
  lerp: cs,
  hermite: qj,
  bezier: Zj,
  random: Qj,
  transformMat4: Dp,
  transformMat3: Mu,
  transformQuat: hk,
  rotateX: Jj,
  rotateY: e$,
  rotateZ: t$,
  angle: r$,
  zero: n$,
  str: i$,
  exactEquals: a$,
  equals: o$,
  sub: zv,
  mul: s$,
  div: u$,
  dist: qy,
  sqrDist: f$,
  len: Q1,
  sqrLen: l$,
  forEach: c$
}, Symbol.toStringTag, { value: "Module" }));
function Ef() {
  var r = new cr(4);
  return cr != Float32Array && (r[0] = 0, r[1] = 0, r[2] = 0, r[3] = 0), r;
}
function dk(r) {
  var t = new cr(4);
  return t[0] = r[0], t[1] = r[1], t[2] = r[2], t[3] = r[3], t;
}
function J1(r, t, e, n) {
  var i = new cr(4);
  return i[0] = r, i[1] = t, i[2] = e, i[3] = n, i;
}
function vk(r, t) {
  return r[0] = t[0], r[1] = t[1], r[2] = t[2], r[3] = t[3], r;
}
function pk(r, t, e, n, i) {
  return r[0] = t, r[1] = e, r[2] = n, r[3] = i, r;
}
function gk(r, t, e) {
  return r[0] = t[0] + e[0], r[1] = t[1] + e[1], r[2] = t[2] + e[2], r[3] = t[3] + e[3], r;
}
function yk(r, t, e) {
  return r[0] = t[0] - e[0], r[1] = t[1] - e[1], r[2] = t[2] - e[2], r[3] = t[3] - e[3], r;
}
function mk(r, t, e) {
  return r[0] = t[0] * e[0], r[1] = t[1] * e[1], r[2] = t[2] * e[2], r[3] = t[3] * e[3], r;
}
function bk(r, t, e) {
  return r[0] = t[0] / e[0], r[1] = t[1] / e[1], r[2] = t[2] / e[2], r[3] = t[3] / e[3], r;
}
function d$(r, t) {
  return r[0] = Math.ceil(t[0]), r[1] = Math.ceil(t[1]), r[2] = Math.ceil(t[2]), r[3] = Math.ceil(t[3]), r;
}
function v$(r, t) {
  return r[0] = Math.floor(t[0]), r[1] = Math.floor(t[1]), r[2] = Math.floor(t[2]), r[3] = Math.floor(t[3]), r;
}
function p$(r, t, e) {
  return r[0] = Math.min(t[0], e[0]), r[1] = Math.min(t[1], e[1]), r[2] = Math.min(t[2], e[2]), r[3] = Math.min(t[3], e[3]), r;
}
function g$(r, t, e) {
  return r[0] = Math.max(t[0], e[0]), r[1] = Math.max(t[1], e[1]), r[2] = Math.max(t[2], e[2]), r[3] = Math.max(t[3], e[3]), r;
}
function y$(r, t) {
  return r[0] = Math.round(t[0]), r[1] = Math.round(t[1]), r[2] = Math.round(t[2]), r[3] = Math.round(t[3]), r;
}
function xk(r, t, e) {
  return r[0] = t[0] * e, r[1] = t[1] * e, r[2] = t[2] * e, r[3] = t[3] * e, r;
}
function m$(r, t, e, n) {
  return r[0] = t[0] + e[0] * n, r[1] = t[1] + e[1] * n, r[2] = t[2] + e[2] * n, r[3] = t[3] + e[3] * n, r;
}
function _k(r, t) {
  var e = t[0] - r[0], n = t[1] - r[1], i = t[2] - r[2], a = t[3] - r[3];
  return Math.hypot(e, n, i, a);
}
function wk(r, t) {
  var e = t[0] - r[0], n = t[1] - r[1], i = t[2] - r[2], a = t[3] - r[3];
  return e * e + n * n + i * i + a * a;
}
function eb(r) {
  var t = r[0], e = r[1], n = r[2], i = r[3];
  return Math.hypot(t, e, n, i);
}
function tb(r) {
  var t = r[0], e = r[1], n = r[2], i = r[3];
  return t * t + e * e + n * n + i * i;
}
function b$(r, t) {
  return r[0] = -t[0], r[1] = -t[1], r[2] = -t[2], r[3] = -t[3], r;
}
function x$(r, t) {
  return r[0] = 1 / t[0], r[1] = 1 / t[1], r[2] = 1 / t[2], r[3] = 1 / t[3], r;
}
function Ek(r, t) {
  var e = t[0], n = t[1], i = t[2], a = t[3], o = e * e + n * n + i * i + a * a;
  return o > 0 && (o = 1 / Math.sqrt(o)), r[0] = e * o, r[1] = n * o, r[2] = i * o, r[3] = a * o, r;
}
function Sk(r, t) {
  return r[0] * t[0] + r[1] * t[1] + r[2] * t[2] + r[3] * t[3];
}
function _$(r, t, e, n) {
  var i = e[0] * n[1] - e[1] * n[0], a = e[0] * n[2] - e[2] * n[0], o = e[0] * n[3] - e[3] * n[0], s = e[1] * n[2] - e[2] * n[1], u = e[1] * n[3] - e[3] * n[1], f = e[2] * n[3] - e[3] * n[2], l = t[0], c = t[1], h = t[2], d = t[3];
  return r[0] = c * f - h * u + d * s, r[1] = -(l * f) + h * o - d * a, r[2] = l * u - c * o + d * i, r[3] = -(l * s) + c * a - h * i, r;
}
function Mk(r, t, e, n) {
  var i = t[0], a = t[1], o = t[2], s = t[3];
  return r[0] = i + n * (e[0] - i), r[1] = a + n * (e[1] - a), r[2] = o + n * (e[2] - o), r[3] = s + n * (e[3] - s), r;
}
function w$(r, t) {
  t = t || 1;
  var e, n, i, a, o, s;
  do
    e = ta() * 2 - 1, n = ta() * 2 - 1, o = e * e + n * n;
  while (o >= 1);
  do
    i = ta() * 2 - 1, a = ta() * 2 - 1, s = i * i + a * a;
  while (s >= 1);
  var u = Math.sqrt((1 - o) / s);
  return r[0] = t * e, r[1] = t * n, r[2] = t * i * u, r[3] = t * a * u, r;
}
function Sf(r, t, e) {
  var n = t[0], i = t[1], a = t[2], o = t[3];
  return r[0] = e[0] * n + e[4] * i + e[8] * a + e[12] * o, r[1] = e[1] * n + e[5] * i + e[9] * a + e[13] * o, r[2] = e[2] * n + e[6] * i + e[10] * a + e[14] * o, r[3] = e[3] * n + e[7] * i + e[11] * a + e[15] * o, r;
}
function E$(r, t, e) {
  var n = t[0], i = t[1], a = t[2], o = e[0], s = e[1], u = e[2], f = e[3], l = f * n + s * a - u * i, c = f * i + u * n - o * a, h = f * a + o * i - s * n, d = -o * n - s * i - u * a;
  return r[0] = l * f + d * -o + c * -u - h * -s, r[1] = c * f + d * -s + h * -o - l * -u, r[2] = h * f + d * -u + l * -s - c * -o, r[3] = t[3], r;
}
function S$(r) {
  return r[0] = 0, r[1] = 0, r[2] = 0, r[3] = 0, r;
}
function M$(r) {
  return "vec4(" + r[0] + ", " + r[1] + ", " + r[2] + ", " + r[3] + ")";
}
function Ck(r, t) {
  return r[0] === t[0] && r[1] === t[1] && r[2] === t[2] && r[3] === t[3];
}
function Tk(r, t) {
  var e = r[0], n = r[1], i = r[2], a = r[3], o = t[0], s = t[1], u = t[2], f = t[3];
  return Math.abs(e - o) <= Bt * Math.max(1, Math.abs(e), Math.abs(o)) && Math.abs(n - s) <= Bt * Math.max(1, Math.abs(n), Math.abs(s)) && Math.abs(i - u) <= Bt * Math.max(1, Math.abs(i), Math.abs(u)) && Math.abs(a - f) <= Bt * Math.max(1, Math.abs(a), Math.abs(f));
}
var C$ = yk, T$ = mk, A$ = bk, I$ = _k, P$ = wk, O$ = eb, D$ = tb, k$ = function() {
  var r = Ef();
  return function(t, e, n, i, a, o) {
    var s, u;
    for (e || (e = 4), n || (n = 0), i ? u = Math.min(i * e + n, t.length) : u = t.length, s = n; s < u; s += e)
      r[0] = t[s], r[1] = t[s + 1], r[2] = t[s + 2], r[3] = t[s + 3], a(r, r, o), t[s] = r[0], t[s + 1] = r[1], t[s + 2] = r[2], t[s + 3] = r[3];
    return t;
  };
}();
const L$ = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  create: Ef,
  clone: dk,
  fromValues: J1,
  copy: vk,
  set: pk,
  add: gk,
  subtract: yk,
  multiply: mk,
  divide: bk,
  ceil: d$,
  floor: v$,
  min: p$,
  max: g$,
  round: y$,
  scale: xk,
  scaleAndAdd: m$,
  distance: _k,
  squaredDistance: wk,
  length: eb,
  squaredLength: tb,
  negate: b$,
  inverse: x$,
  normalize: Ek,
  dot: Sk,
  cross: _$,
  lerp: Mk,
  random: w$,
  transformMat4: Sf,
  transformQuat: E$,
  zero: S$,
  str: M$,
  exactEquals: Ck,
  equals: Tk,
  sub: C$,
  mul: T$,
  div: A$,
  dist: I$,
  sqrDist: P$,
  len: O$,
  sqrLen: D$,
  forEach: k$
}, Symbol.toStringTag, { value: "Module" }));
function hn() {
  var r = new cr(4);
  return cr != Float32Array && (r[0] = 0, r[1] = 0, r[2] = 0), r[3] = 1, r;
}
function N$(r) {
  return r[0] = 0, r[1] = 0, r[2] = 0, r[3] = 1, r;
}
function Zo(r, t, e) {
  e = e * 0.5;
  var n = Math.sin(e);
  return r[0] = n * t[0], r[1] = n * t[1], r[2] = n * t[2], r[3] = Math.cos(e), r;
}
function R$(r, t) {
  var e = Math.acos(t[3]) * 2, n = Math.sin(e / 2);
  return n > Bt ? (r[0] = t[0] / n, r[1] = t[1] / n, r[2] = t[2] / n) : (r[0] = 1, r[1] = 0, r[2] = 0), e;
}
function B$(r, t) {
  var e = rb(r, t);
  return Math.acos(2 * e * e - 1);
}
function mi(r, t, e) {
  var n = t[0], i = t[1], a = t[2], o = t[3], s = e[0], u = e[1], f = e[2], l = e[3];
  return r[0] = n * l + o * s + i * f - a * u, r[1] = i * l + o * u + a * s - n * f, r[2] = a * l + o * f + n * u - i * s, r[3] = o * l - n * s - i * u - a * f, r;
}
function Ak(r, t, e) {
  e *= 0.5;
  var n = t[0], i = t[1], a = t[2], o = t[3], s = Math.sin(e), u = Math.cos(e);
  return r[0] = n * u + o * s, r[1] = i * u + a * s, r[2] = a * u - i * s, r[3] = o * u - n * s, r;
}
function Ik(r, t, e) {
  e *= 0.5;
  var n = t[0], i = t[1], a = t[2], o = t[3], s = Math.sin(e), u = Math.cos(e);
  return r[0] = n * u - a * s, r[1] = i * u + o * s, r[2] = a * u + n * s, r[3] = o * u - i * s, r;
}
function Pk(r, t, e) {
  e *= 0.5;
  var n = t[0], i = t[1], a = t[2], o = t[3], s = Math.sin(e), u = Math.cos(e);
  return r[0] = n * u + i * s, r[1] = i * u - n * s, r[2] = a * u + o * s, r[3] = o * u - a * s, r;
}
function G$(r, t) {
  var e = t[0], n = t[1], i = t[2];
  return r[0] = e, r[1] = n, r[2] = i, r[3] = Math.sqrt(Math.abs(1 - e * e - n * n - i * i)), r;
}
function Ok(r, t) {
  var e = t[0], n = t[1], i = t[2], a = t[3], o = Math.sqrt(e * e + n * n + i * i), s = Math.exp(a), u = o > 0 ? s * Math.sin(o) / o : 0;
  return r[0] = e * u, r[1] = n * u, r[2] = i * u, r[3] = s * Math.cos(o), r;
}
function Dk(r, t) {
  var e = t[0], n = t[1], i = t[2], a = t[3], o = Math.sqrt(e * e + n * n + i * i), s = o > 0 ? Math.atan2(o, a) / o : 0;
  return r[0] = e * s, r[1] = n * s, r[2] = i * s, r[3] = 0.5 * Math.log(e * e + n * n + i * i + a * a), r;
}
function F$(r, t, e) {
  return Dk(r, t), Nk(r, r, e), Ok(r, r), r;
}
function hc(r, t, e, n) {
  var i = t[0], a = t[1], o = t[2], s = t[3], u = e[0], f = e[1], l = e[2], c = e[3], h, d, v, p, g;
  return d = i * u + a * f + o * l + s * c, d < 0 && (d = -d, u = -u, f = -f, l = -l, c = -c), 1 - d > Bt ? (h = Math.acos(d), v = Math.sin(h), p = Math.sin((1 - n) * h) / v, g = Math.sin(n * h) / v) : (p = 1 - n, g = n), r[0] = p * i + g * u, r[1] = p * a + g * f, r[2] = p * o + g * l, r[3] = p * s + g * c, r;
}
function z$(r) {
  var t = ta(), e = ta(), n = ta(), i = Math.sqrt(1 - t), a = Math.sqrt(t);
  return r[0] = i * Math.sin(2 * Math.PI * e), r[1] = i * Math.cos(2 * Math.PI * e), r[2] = a * Math.sin(2 * Math.PI * n), r[3] = a * Math.cos(2 * Math.PI * n), r;
}
function Zy(r, t) {
  var e = t[0], n = t[1], i = t[2], a = t[3], o = e * e + n * n + i * i + a * a, s = o ? 1 / o : 0;
  return r[0] = -e * s, r[1] = -n * s, r[2] = -i * s, r[3] = a * s, r;
}
function U$(r, t) {
  return r[0] = -t[0], r[1] = -t[1], r[2] = -t[2], r[3] = t[3], r;
}
function kk(r, t) {
  var e = t[0] + t[4] + t[8], n;
  if (e > 0)
    n = Math.sqrt(e + 1), r[3] = 0.5 * n, n = 0.5 / n, r[0] = (t[5] - t[7]) * n, r[1] = (t[6] - t[2]) * n, r[2] = (t[1] - t[3]) * n;
  else {
    var i = 0;
    t[4] > t[0] && (i = 1), t[8] > t[i * 3 + i] && (i = 2);
    var a = (i + 1) % 3, o = (i + 2) % 3;
    n = Math.sqrt(t[i * 3 + i] - t[a * 3 + a] - t[o * 3 + o] + 1), r[i] = 0.5 * n, n = 0.5 / n, r[3] = (t[a * 3 + o] - t[o * 3 + a]) * n, r[a] = (t[a * 3 + i] + t[i * 3 + a]) * n, r[o] = (t[o * 3 + i] + t[i * 3 + o]) * n;
  }
  return r;
}
function cv(r, t, e, n) {
  var i = 0.5 * Math.PI / 180;
  t *= i, e *= i, n *= i;
  var a = Math.sin(t), o = Math.cos(t), s = Math.sin(e), u = Math.cos(e), f = Math.sin(n), l = Math.cos(n);
  return r[0] = a * u * l - o * s * f, r[1] = o * s * l + a * u * f, r[2] = o * u * f - a * s * l, r[3] = o * u * l + a * s * f, r;
}
function j$(r) {
  return "quat(" + r[0] + ", " + r[1] + ", " + r[2] + ", " + r[3] + ")";
}
var $$ = dk, hv = J1, rs = vk, W$ = pk, V$ = gk, Lk = mi, Nk = xk, rb = Sk, X$ = Mk, nb = eb, Y$ = nb, ib = tb, H$ = ib, iu = Ek, K$ = Ck, q$ = Tk, Z$ = function() {
  var r = Tr(), t = rr(1, 0, 0), e = rr(0, 1, 0);
  return function(n, i, a) {
    var o = Ff(i, a);
    return o < -0.999999 ? (lv(r, t, i), Q1(r) < 1e-6 && lv(r, e, i), Pf(r, r), Zo(n, r, Math.PI), n) : o > 0.999999 ? (n[0] = 0, n[1] = 0, n[2] = 0, n[3] = 1, n) : (lv(r, i, a), n[0] = r[0], n[1] = r[1], n[2] = r[2], n[3] = 1 + o, iu(n, n));
  };
}(), Q$ = function() {
  var r = hn(), t = hn();
  return function(e, n, i, a, o, s) {
    return hc(r, n, o, s), hc(t, i, a, s), hc(e, r, t, 2 * s * (1 - s)), e;
  };
}(), J$ = function() {
  var r = tl();
  return function(t, e, n, i) {
    return r[0] = n[0], r[3] = n[1], r[6] = n[2], r[1] = i[0], r[4] = i[1], r[7] = i[2], r[2] = -e[0], r[5] = -e[1], r[8] = -e[2], iu(t, kk(t, r));
  };
}();
const e8 = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  create: hn,
  identity: N$,
  setAxisAngle: Zo,
  getAxisAngle: R$,
  getAngle: B$,
  multiply: mi,
  rotateX: Ak,
  rotateY: Ik,
  rotateZ: Pk,
  calculateW: G$,
  exp: Ok,
  ln: Dk,
  pow: F$,
  slerp: hc,
  random: z$,
  invert: Zy,
  conjugate: U$,
  fromMat3: kk,
  fromEuler: cv,
  str: j$,
  clone: $$,
  fromValues: hv,
  copy: rs,
  set: W$,
  add: V$,
  mul: Lk,
  scale: Nk,
  dot: rb,
  lerp: X$,
  length: nb,
  len: Y$,
  squaredLength: ib,
  sqrLen: H$,
  normalize: iu,
  exactEquals: K$,
  equals: q$,
  rotationTo: Z$,
  sqlerp: Q$,
  setAxes: J$
}, Symbol.toStringTag, { value: "Module" }));
function t8() {
  var r = new cr(8);
  return cr != Float32Array && (r[0] = 0, r[1] = 0, r[2] = 0, r[4] = 0, r[5] = 0, r[6] = 0, r[7] = 0), r[3] = 1, r;
}
function r8(r) {
  var t = new cr(8);
  return t[0] = r[0], t[1] = r[1], t[2] = r[2], t[3] = r[3], t[4] = r[4], t[5] = r[5], t[6] = r[6], t[7] = r[7], t;
}
function n8(r, t, e, n, i, a, o, s) {
  var u = new cr(8);
  return u[0] = r, u[1] = t, u[2] = e, u[3] = n, u[4] = i, u[5] = a, u[6] = o, u[7] = s, u;
}
function i8(r, t, e, n, i, a, o) {
  var s = new cr(8);
  s[0] = r, s[1] = t, s[2] = e, s[3] = n;
  var u = i * 0.5, f = a * 0.5, l = o * 0.5;
  return s[4] = u * n + f * e - l * t, s[5] = f * n + l * r - u * e, s[6] = l * n + u * t - f * r, s[7] = -u * r - f * t - l * e, s;
}
function Rk(r, t, e) {
  var n = e[0] * 0.5, i = e[1] * 0.5, a = e[2] * 0.5, o = t[0], s = t[1], u = t[2], f = t[3];
  return r[0] = o, r[1] = s, r[2] = u, r[3] = f, r[4] = n * f + i * u - a * s, r[5] = i * f + a * o - n * u, r[6] = a * f + n * s - i * o, r[7] = -n * o - i * s - a * u, r;
}
function a8(r, t) {
  return r[0] = 0, r[1] = 0, r[2] = 0, r[3] = 1, r[4] = t[0] * 0.5, r[5] = t[1] * 0.5, r[6] = t[2] * 0.5, r[7] = 0, r;
}
function o8(r, t) {
  return r[0] = t[0], r[1] = t[1], r[2] = t[2], r[3] = t[3], r[4] = 0, r[5] = 0, r[6] = 0, r[7] = 0, r;
}
function s8(r, t) {
  var e = hn();
  ru(e, t);
  var n = new cr(3);
  return eu(n, t), Rk(r, e, n), r;
}
function Bk(r, t) {
  return r[0] = t[0], r[1] = t[1], r[2] = t[2], r[3] = t[3], r[4] = t[4], r[5] = t[5], r[6] = t[6], r[7] = t[7], r;
}
function u8(r) {
  return r[0] = 0, r[1] = 0, r[2] = 0, r[3] = 1, r[4] = 0, r[5] = 0, r[6] = 0, r[7] = 0, r;
}
function f8(r, t, e, n, i, a, o, s, u) {
  return r[0] = t, r[1] = e, r[2] = n, r[3] = i, r[4] = a, r[5] = o, r[6] = s, r[7] = u, r;
}
var l8 = rs;
function c8(r, t) {
  return r[0] = t[4], r[1] = t[5], r[2] = t[6], r[3] = t[7], r;
}
var h8 = rs;
function d8(r, t) {
  return r[4] = t[0], r[5] = t[1], r[6] = t[2], r[7] = t[3], r;
}
function v8(r, t) {
  var e = t[4], n = t[5], i = t[6], a = t[7], o = -t[0], s = -t[1], u = -t[2], f = t[3];
  return r[0] = (e * f + a * o + n * u - i * s) * 2, r[1] = (n * f + a * s + i * o - e * u) * 2, r[2] = (i * f + a * u + e * s - n * o) * 2, r;
}
function p8(r, t, e) {
  var n = t[0], i = t[1], a = t[2], o = t[3], s = e[0] * 0.5, u = e[1] * 0.5, f = e[2] * 0.5, l = t[4], c = t[5], h = t[6], d = t[7];
  return r[0] = n, r[1] = i, r[2] = a, r[3] = o, r[4] = o * s + i * f - a * u + l, r[5] = o * u + a * s - n * f + c, r[6] = o * f + n * u - i * s + h, r[7] = -n * s - i * u - a * f + d, r;
}
function g8(r, t, e) {
  var n = -t[0], i = -t[1], a = -t[2], o = t[3], s = t[4], u = t[5], f = t[6], l = t[7], c = s * o + l * n + u * a - f * i, h = u * o + l * i + f * n - s * a, d = f * o + l * a + s * i - u * n, v = l * o - s * n - u * i - f * a;
  return Ak(r, t, e), n = r[0], i = r[1], a = r[2], o = r[3], r[4] = c * o + v * n + h * a - d * i, r[5] = h * o + v * i + d * n - c * a, r[6] = d * o + v * a + c * i - h * n, r[7] = v * o - c * n - h * i - d * a, r;
}
function y8(r, t, e) {
  var n = -t[0], i = -t[1], a = -t[2], o = t[3], s = t[4], u = t[5], f = t[6], l = t[7], c = s * o + l * n + u * a - f * i, h = u * o + l * i + f * n - s * a, d = f * o + l * a + s * i - u * n, v = l * o - s * n - u * i - f * a;
  return Ik(r, t, e), n = r[0], i = r[1], a = r[2], o = r[3], r[4] = c * o + v * n + h * a - d * i, r[5] = h * o + v * i + d * n - c * a, r[6] = d * o + v * a + c * i - h * n, r[7] = v * o - c * n - h * i - d * a, r;
}
function m8(r, t, e) {
  var n = -t[0], i = -t[1], a = -t[2], o = t[3], s = t[4], u = t[5], f = t[6], l = t[7], c = s * o + l * n + u * a - f * i, h = u * o + l * i + f * n - s * a, d = f * o + l * a + s * i - u * n, v = l * o - s * n - u * i - f * a;
  return Pk(r, t, e), n = r[0], i = r[1], a = r[2], o = r[3], r[4] = c * o + v * n + h * a - d * i, r[5] = h * o + v * i + d * n - c * a, r[6] = d * o + v * a + c * i - h * n, r[7] = v * o - c * n - h * i - d * a, r;
}
function b8(r, t, e) {
  var n = e[0], i = e[1], a = e[2], o = e[3], s = t[0], u = t[1], f = t[2], l = t[3];
  return r[0] = s * o + l * n + u * a - f * i, r[1] = u * o + l * i + f * n - s * a, r[2] = f * o + l * a + s * i - u * n, r[3] = l * o - s * n - u * i - f * a, s = t[4], u = t[5], f = t[6], l = t[7], r[4] = s * o + l * n + u * a - f * i, r[5] = u * o + l * i + f * n - s * a, r[6] = f * o + l * a + s * i - u * n, r[7] = l * o - s * n - u * i - f * a, r;
}
function x8(r, t, e) {
  var n = t[0], i = t[1], a = t[2], o = t[3], s = e[0], u = e[1], f = e[2], l = e[3];
  return r[0] = n * l + o * s + i * f - a * u, r[1] = i * l + o * u + a * s - n * f, r[2] = a * l + o * f + n * u - i * s, r[3] = o * l - n * s - i * u - a * f, s = e[4], u = e[5], f = e[6], l = e[7], r[4] = n * l + o * s + i * f - a * u, r[5] = i * l + o * u + a * s - n * f, r[6] = a * l + o * f + n * u - i * s, r[7] = o * l - n * s - i * u - a * f, r;
}
function _8(r, t, e, n) {
  if (Math.abs(n) < Bt)
    return Bk(r, t);
  var i = Math.hypot(e[0], e[1], e[2]);
  n = n * 0.5;
  var a = Math.sin(n), o = a * e[0] / i, s = a * e[1] / i, u = a * e[2] / i, f = Math.cos(n), l = t[0], c = t[1], h = t[2], d = t[3];
  r[0] = l * f + d * o + c * u - h * s, r[1] = c * f + d * s + h * o - l * u, r[2] = h * f + d * u + l * s - c * o, r[3] = d * f - l * o - c * s - h * u;
  var v = t[4], p = t[5], g = t[6], y = t[7];
  return r[4] = v * f + y * o + p * u - g * s, r[5] = p * f + y * s + g * o - v * u, r[6] = g * f + y * u + v * s - p * o, r[7] = y * f - v * o - p * s - g * u, r;
}
function w8(r, t, e) {
  return r[0] = t[0] + e[0], r[1] = t[1] + e[1], r[2] = t[2] + e[2], r[3] = t[3] + e[3], r[4] = t[4] + e[4], r[5] = t[5] + e[5], r[6] = t[6] + e[6], r[7] = t[7] + e[7], r;
}
function Gk(r, t, e) {
  var n = t[0], i = t[1], a = t[2], o = t[3], s = e[4], u = e[5], f = e[6], l = e[7], c = t[4], h = t[5], d = t[6], v = t[7], p = e[0], g = e[1], y = e[2], b = e[3];
  return r[0] = n * b + o * p + i * y - a * g, r[1] = i * b + o * g + a * p - n * y, r[2] = a * b + o * y + n * g - i * p, r[3] = o * b - n * p - i * g - a * y, r[4] = n * l + o * s + i * f - a * u + c * b + v * p + h * y - d * g, r[5] = i * l + o * u + a * s - n * f + h * b + v * g + d * p - c * y, r[6] = a * l + o * f + n * u - i * s + d * b + v * y + c * g - h * p, r[7] = o * l - n * s - i * u - a * f + v * b - c * p - h * g - d * y, r;
}
var E8 = Gk;
function S8(r, t, e) {
  return r[0] = t[0] * e, r[1] = t[1] * e, r[2] = t[2] * e, r[3] = t[3] * e, r[4] = t[4] * e, r[5] = t[5] * e, r[6] = t[6] * e, r[7] = t[7] * e, r;
}
var Fk = rb;
function M8(r, t, e, n) {
  var i = 1 - n;
  return Fk(t, e) < 0 && (n = -n), r[0] = t[0] * i + e[0] * n, r[1] = t[1] * i + e[1] * n, r[2] = t[2] * i + e[2] * n, r[3] = t[3] * i + e[3] * n, r[4] = t[4] * i + e[4] * n, r[5] = t[5] * i + e[5] * n, r[6] = t[6] * i + e[6] * n, r[7] = t[7] * i + e[7] * n, r;
}
function C8(r, t) {
  var e = kp(t);
  return r[0] = -t[0] / e, r[1] = -t[1] / e, r[2] = -t[2] / e, r[3] = t[3] / e, r[4] = -t[4] / e, r[5] = -t[5] / e, r[6] = -t[6] / e, r[7] = t[7] / e, r;
}
function T8(r, t) {
  return r[0] = -t[0], r[1] = -t[1], r[2] = -t[2], r[3] = t[3], r[4] = -t[4], r[5] = -t[5], r[6] = -t[6], r[7] = t[7], r;
}
var zk = nb, A8 = zk, kp = ib, I8 = kp;
function P8(r, t) {
  var e = kp(t);
  if (e > 0) {
    e = Math.sqrt(e);
    var n = t[0] / e, i = t[1] / e, a = t[2] / e, o = t[3] / e, s = t[4], u = t[5], f = t[6], l = t[7], c = n * s + i * u + a * f + o * l;
    r[0] = n, r[1] = i, r[2] = a, r[3] = o, r[4] = (s - n * c) / e, r[5] = (u - i * c) / e, r[6] = (f - a * c) / e, r[7] = (l - o * c) / e;
  }
  return r;
}
function O8(r) {
  return "quat2(" + r[0] + ", " + r[1] + ", " + r[2] + ", " + r[3] + ", " + r[4] + ", " + r[5] + ", " + r[6] + ", " + r[7] + ")";
}
function D8(r, t) {
  return r[0] === t[0] && r[1] === t[1] && r[2] === t[2] && r[3] === t[3] && r[4] === t[4] && r[5] === t[5] && r[6] === t[6] && r[7] === t[7];
}
function k8(r, t) {
  var e = r[0], n = r[1], i = r[2], a = r[3], o = r[4], s = r[5], u = r[6], f = r[7], l = t[0], c = t[1], h = t[2], d = t[3], v = t[4], p = t[5], g = t[6], y = t[7];
  return Math.abs(e - l) <= Bt * Math.max(1, Math.abs(e), Math.abs(l)) && Math.abs(n - c) <= Bt * Math.max(1, Math.abs(n), Math.abs(c)) && Math.abs(i - h) <= Bt * Math.max(1, Math.abs(i), Math.abs(h)) && Math.abs(a - d) <= Bt * Math.max(1, Math.abs(a), Math.abs(d)) && Math.abs(o - v) <= Bt * Math.max(1, Math.abs(o), Math.abs(v)) && Math.abs(s - p) <= Bt * Math.max(1, Math.abs(s), Math.abs(p)) && Math.abs(u - g) <= Bt * Math.max(1, Math.abs(u), Math.abs(g)) && Math.abs(f - y) <= Bt * Math.max(1, Math.abs(f), Math.abs(y));
}
const L8 = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  create: t8,
  clone: r8,
  fromValues: n8,
  fromRotationTranslationValues: i8,
  fromRotationTranslation: Rk,
  fromTranslation: a8,
  fromRotation: o8,
  fromMat4: s8,
  copy: Bk,
  identity: u8,
  set: f8,
  getReal: l8,
  getDual: c8,
  setReal: h8,
  setDual: d8,
  getTranslation: v8,
  translate: p8,
  rotateX: g8,
  rotateY: y8,
  rotateZ: m8,
  rotateByQuatAppend: b8,
  rotateByQuatPrepend: x8,
  rotateAroundAxis: _8,
  add: w8,
  multiply: Gk,
  mul: E8,
  scale: S8,
  dot: Fk,
  lerp: M8,
  invert: C8,
  conjugate: T8,
  length: zk,
  len: A8,
  squaredLength: kp,
  sqrLen: I8,
  normalize: P8,
  str: O8,
  exactEquals: D8,
  equals: k8
}, Symbol.toStringTag, { value: "Module" }));
function Uk() {
  var r = new cr(2);
  return cr != Float32Array && (r[0] = 0, r[1] = 0), r;
}
function N8(r) {
  var t = new cr(2);
  return t[0] = r[0], t[1] = r[1], t;
}
function R8(r, t) {
  var e = new cr(2);
  return e[0] = r, e[1] = t, e;
}
function B8(r, t) {
  return r[0] = t[0], r[1] = t[1], r;
}
function G8(r, t, e) {
  return r[0] = t, r[1] = e, r;
}
function Dn(r, t, e) {
  return r[0] = t[0] + e[0], r[1] = t[1] + e[1], r;
}
function jk(r, t, e) {
  return r[0] = t[0] - e[0], r[1] = t[1] - e[1], r;
}
function $k(r, t, e) {
  return r[0] = t[0] * e[0], r[1] = t[1] * e[1], r;
}
function Wk(r, t, e) {
  return r[0] = t[0] / e[0], r[1] = t[1] / e[1], r;
}
function F8(r, t) {
  return r[0] = Math.ceil(t[0]), r[1] = Math.ceil(t[1]), r;
}
function z8(r, t) {
  return r[0] = Math.floor(t[0]), r[1] = Math.floor(t[1]), r;
}
function Ho(r, t, e) {
  return r[0] = Math.min(t[0], e[0]), r[1] = Math.min(t[1], e[1]), r;
}
function Ko(r, t, e) {
  return r[0] = Math.max(t[0], e[0]), r[1] = Math.max(t[1], e[1]), r;
}
function U8(r, t) {
  return r[0] = Math.round(t[0]), r[1] = Math.round(t[1]), r;
}
function Vn(r, t, e) {
  return r[0] = t[0] * e, r[1] = t[1] * e, r;
}
function j8(r, t, e, n) {
  return r[0] = t[0] + e[0] * n, r[1] = t[1] + e[1] * n, r;
}
function Uv(r, t) {
  var e = t[0] - r[0], n = t[1] - r[1];
  return Math.hypot(e, n);
}
function Vk(r, t) {
  var e = t[0] - r[0], n = t[1] - r[1];
  return e * e + n * n;
}
function Xk(r) {
  var t = r[0], e = r[1];
  return Math.hypot(t, e);
}
function Yk(r) {
  var t = r[0], e = r[1];
  return t * t + e * e;
}
function $8(r, t) {
  return r[0] = -t[0], r[1] = -t[1], r;
}
function W8(r, t) {
  return r[0] = 1 / t[0], r[1] = 1 / t[1], r;
}
function us(r, t) {
  var e = t[0], n = t[1], i = e * e + n * n;
  return i > 0 && (i = 1 / Math.sqrt(i)), r[0] = t[0] * i, r[1] = t[1] * i, r;
}
function ab(r, t) {
  return r[0] * t[0] + r[1] * t[1];
}
function V8(r, t, e) {
  var n = t[0] * e[1] - t[1] * e[0];
  return r[0] = r[1] = 0, r[2] = n, r;
}
function X8(r, t, e, n) {
  var i = t[0], a = t[1];
  return r[0] = i + n * (e[0] - i), r[1] = a + n * (e[1] - a), r;
}
function Y8(r, t) {
  t = t || 1;
  var e = ta() * 2 * Math.PI;
  return r[0] = Math.cos(e) * t, r[1] = Math.sin(e) * t, r;
}
function H8(r, t, e) {
  var n = t[0], i = t[1];
  return r[0] = e[0] * n + e[2] * i, r[1] = e[1] * n + e[3] * i, r;
}
function K8(r, t, e) {
  var n = t[0], i = t[1];
  return r[0] = e[0] * n + e[2] * i + e[4], r[1] = e[1] * n + e[3] * i + e[5], r;
}
function q8(r, t, e) {
  var n = t[0], i = t[1];
  return r[0] = e[0] * n + e[3] * i + e[6], r[1] = e[1] * n + e[4] * i + e[7], r;
}
function Z8(r, t, e) {
  var n = t[0], i = t[1];
  return r[0] = e[0] * n + e[4] * i + e[12], r[1] = e[1] * n + e[5] * i + e[13], r;
}
function Q8(r, t, e, n) {
  var i = t[0] - e[0], a = t[1] - e[1], o = Math.sin(n), s = Math.cos(n);
  return r[0] = i * s - a * o + e[0], r[1] = i * o + a * s + e[1], r;
}
function J8(r, t) {
  var e = r[0], n = r[1], i = t[0], a = t[1], o = Math.sqrt(e * e + n * n) * Math.sqrt(i * i + a * a), s = o && (e * i + n * a) / o;
  return Math.acos(Math.min(Math.max(s, -1), 1));
}
function eW(r) {
  return r[0] = 0, r[1] = 0, r;
}
function tW(r) {
  return "vec2(" + r[0] + ", " + r[1] + ")";
}
function ob(r, t) {
  return r[0] === t[0] && r[1] === t[1];
}
function rW(r, t) {
  var e = r[0], n = r[1], i = t[0], a = t[1];
  return Math.abs(e - i) <= Bt * Math.max(1, Math.abs(e), Math.abs(i)) && Math.abs(n - a) <= Bt * Math.max(1, Math.abs(n), Math.abs(a));
}
var nW = Xk, dv = jk, iW = $k, aW = Wk, oW = Uv, sW = Vk, uW = Yk, fW = function() {
  var r = Uk();
  return function(t, e, n, i, a, o) {
    var s, u;
    for (e || (e = 2), n || (n = 0), i ? u = Math.min(i * e + n, t.length) : u = t.length, s = n; s < u; s += e)
      r[0] = t[s], r[1] = t[s + 1], a(r, r, o), t[s] = r[0], t[s + 1] = r[1];
    return t;
  };
}();
const lW = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  create: Uk,
  clone: N8,
  fromValues: R8,
  copy: B8,
  set: G8,
  add: Dn,
  subtract: jk,
  multiply: $k,
  divide: Wk,
  ceil: F8,
  floor: z8,
  min: Ho,
  max: Ko,
  round: U8,
  scale: Vn,
  scaleAndAdd: j8,
  distance: Uv,
  squaredDistance: Vk,
  length: Xk,
  squaredLength: Yk,
  negate: $8,
  inverse: W8,
  normalize: us,
  dot: ab,
  cross: V8,
  lerp: X8,
  random: Y8,
  transformMat2: H8,
  transformMat2d: K8,
  transformMat3: q8,
  transformMat4: Z8,
  rotate: Q8,
  angle: J8,
  zero: eW,
  str: tW,
  exactEquals: ob,
  equals: rW,
  len: nW,
  sub: dv,
  mul: iW,
  div: aW,
  dist: oW,
  sqrDist: sW,
  sqrLen: uW,
  forEach: fW
}, Symbol.toStringTag, { value: "Module" })), cW = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  glMatrix: Xz,
  mat2: yU,
  mat2d: UU,
  mat3: qD,
  mat4: Uj,
  quat: e8,
  quat2: L8,
  vec2: lW,
  vec3: h$,
  vec4: L$
}, Symbol.toStringTag, { value: "Module" }));
function hW(r, t, e) {
  var n = [0, 0, 0, 0, 0, 0, 0, 0, 0];
  return VD(n, e), rl(r, n, t);
}
function dW(r, t, e) {
  var n = [0, 0, 0, 0, 0, 0, 0, 0, 0];
  return XD(n, e), rl(r, n, t);
}
function vW(r, t, e) {
  var n = [0, 0, 0, 0, 0, 0, 0, 0, 0];
  return YD(n, e), rl(r, n, t);
}
function pW(r, t, e) {
  return rl(r, e, t);
}
function $i(r, t) {
  for (var e = r ? [].concat(r) : [1, 0, 0, 0, 1, 0, 0, 0, 1], n = 0, i = t.length; n < i; n++) {
    var a = t[n];
    switch (a[0]) {
      case "t":
        hW(e, e, [a[1], a[2]]);
        break;
      case "s":
        vW(e, e, [a[1], a[2]]);
        break;
      case "r":
        dW(e, e, a[1]);
        break;
      case "m":
        pW(e, e, a[1]);
        break;
    }
  }
  return e;
}
var pu = function(t, e) {
  var n = t.nodes, i = t.edges, a = [], o = {};
  if (!n)
    throw new Error("invalid nodes data!");
  return n && n.forEach(function(s, u) {
    o[s.id] = u;
    var f = [];
    a.push(f);
  }), i && i.forEach(function(s) {
    var u = s.source, f = s.target, l = o[u], c = o[f];
    !l && l !== 0 || !c && c !== 0 || (a[l][c] = 1, e || (a[c][l] = 1));
  }), a;
}, gW = function(t, e) {
  return t === e;
}, nE = function() {
  function r(t, e) {
    e === void 0 && (e = null), this.value = t, this.next = e;
  }
  return r.prototype.toString = function(t) {
    return t ? t(this.value) : "".concat(this.value);
  }, r;
}(), Hk = function() {
  function r(t) {
    t === void 0 && (t = gW), this.head = null, this.tail = null, this.compare = t;
  }
  return r.prototype.prepend = function(t) {
    var e = new nE(t, this.head);
    return this.head = e, this.tail || (this.tail = e), this;
  }, r.prototype.append = function(t) {
    var e = new nE(t);
    return this.head ? (this.tail.next = e, this.tail = e, this) : (this.head = e, this.tail = e, this);
  }, r.prototype.delete = function(t) {
    if (!this.head)
      return null;
    for (var e = null; this.head && this.compare(this.head.value, t); )
      e = this.head, this.head = this.head.next;
    var n = this.head;
    if (n !== null)
      for (; n.next; )
        this.compare(n.next.value, t) ? (e = n.next, n.next = n.next.next) : n = n.next;
    return this.compare(this.tail.value, t) && (this.tail = n), e;
  }, r.prototype.find = function(t) {
    var e = t.value, n = e === void 0 ? void 0 : e, i = t.callback, a = i === void 0 ? void 0 : i;
    if (!this.head)
      return null;
    for (var o = this.head; o; ) {
      if (a && a(o.value) || n !== void 0 && this.compare(o.value, n))
        return o;
      o = o.next;
    }
    return null;
  }, r.prototype.deleteTail = function() {
    var t = this.tail;
    if (this.head === this.tail)
      return this.head = null, this.tail = null, t;
    for (var e = this.head; e.next; )
      e.next.next ? e = e.next : e.next = null;
    return this.tail = e, t;
  }, r.prototype.deleteHead = function() {
    if (!this.head)
      return null;
    var t = this.head;
    return this.head.next ? this.head = this.head.next : (this.head = null, this.tail = null), t;
  }, r.prototype.fromArray = function(t) {
    var e = this;
    return t.forEach(function(n) {
      return e.append(n);
    }), this;
  }, r.prototype.toArray = function() {
    for (var t = [], e = this.head; e; )
      t.push(e), e = e.next;
    return t;
  }, r.prototype.reverse = function() {
    for (var t = this.head, e = null, n = null; t; )
      n = t.next, t.next = e, e = t, t = n;
    this.tail = this.head, this.head = e;
  }, r.prototype.toString = function(t) {
    return t === void 0 && (t = void 0), this.toArray().map(function(e) {
      return e.toString(t);
    }).toString();
  }, r;
}(), yW = function() {
  function r() {
    this.linkedList = new Hk();
  }
  return r.prototype.isEmpty = function() {
    return !this.linkedList.head;
  }, r.prototype.peek = function() {
    return this.linkedList.head ? this.linkedList.head.value : null;
  }, r.prototype.enqueue = function(t) {
    this.linkedList.append(t);
  }, r.prototype.dequeue = function() {
    var t = this.linkedList.deleteHead();
    return t ? t.value : null;
  }, r.prototype.toString = function(t) {
    return this.linkedList.toString(t);
  }, r;
}(), _i = function(t, e, n) {
  e === void 0 && (e = []);
  var i = e.filter(function(u) {
    return u.source === t || u.target === t;
  });
  if (n === "target") {
    var a = function(f) {
      return f.source === t;
    };
    return i.filter(a).map(function(u) {
      return u.target;
    });
  }
  if (n === "source") {
    var o = function(f) {
      return f.target === t;
    };
    return i.filter(o).map(function(u) {
      return u.source;
    });
  }
  var s = function(f) {
    return f.source === t ? f.target : f.source;
  };
  return i.map(s);
}, mW = function(t, e) {
  return e.filter(function(n) {
    return n.source === t;
  });
}, vv = function(t, e) {
  return e.filter(function(n) {
    return n.source === t || n.target === t;
  });
}, Kk = function(t) {
  t === void 0 && (t = 0);
  var e = "".concat(Math.random()).split(".")[1].substr(0, 5), n = "".concat(Math.random()).split(".")[1].substr(0, 5);
  return "".concat(t, "-").concat(e).concat(n);
};
function bW(r) {
  r === void 0 && (r = {});
  var t = r, e = function() {
  }, n = function() {
    var i = {};
    return function(a) {
      var o = a.next, s = o;
      return i[s] ? !1 : (i[s] = !0, !0);
    };
  }();
  return t.allowTraversal = r.allowTraversal || n, t.enter = r.enter || e, t.leave = r.leave || e, t;
}
var qk = function(t, e, n, i) {
  i === void 0 && (i = !0);
  var a = bW(n), o = new yW(), s = t.edges, u = s === void 0 ? [] : s;
  o.enqueue(e);
  for (var f = "", l = function() {
    var h = o.dequeue();
    a.enter({
      current: h,
      previous: f
    }), _i(h, u, i ? "target" : void 0).forEach(function(d) {
      a.allowTraversal({
        previous: f,
        current: h,
        next: d
      }) && o.enqueue(d);
    }), a.leave({
      current: h,
      previous: f
    }), f = h;
  }; !o.isEmpty(); )
    l();
}, xW = function(t) {
  for (var e = t.nodes, n = e === void 0 ? [] : e, i = t.edges, a = i === void 0 ? [] : i, o = [], s = {}, u = [], f = function d(v) {
    u.push(v), s[v.id] = !0;
    for (var p = _i(v.id, a), g = function(m) {
      var x = p[m];
      if (!s[x]) {
        var _ = n.filter(function(w) {
          return w.id === x;
        });
        _.length > 0 && d(_[0]);
      }
    }, y = 0; y < p.length; ++y)
      g(y);
  }, l = 0; l < n.length; l++) {
    var c = n[l];
    if (!s[c.id]) {
      f(c);
      for (var h = []; u.length > 0; )
        h.push(u.pop());
      o.push(h);
    }
  }
  return o;
}, Zk = function(t) {
  for (var e = t.nodes, n = e === void 0 ? [] : e, i = t.edges, a = i === void 0 ? [] : i, o = [], s = {}, u = {}, f = {}, l = [], c = 0, h = function g(y) {
    u[y.id] = c, f[y.id] = c, c += 1, o.push(y), s[y.id] = !0;
    for (var b = _i(y.id, a, "target").filter(function(E) {
      return n.map(function(M) {
        return M.id;
      }).indexOf(E) > -1;
    }), m = function(M) {
      var C = b[M];
      if (!u[C] && u[C] !== 0) {
        var S = n.filter(function(A) {
          return A.id === C;
        });
        S.length > 0 && g(S[0]), f[y.id] = Math.min(f[y.id], f[C]);
      } else
        s[C] && (f[y.id] = Math.min(f[y.id], u[C]));
    }, x = 0; x < b.length; x++)
      m(x);
    if (f[y.id] === u[y.id]) {
      for (var _ = []; o.length > 0; ) {
        var w = o.pop();
        if (s[w.id] = !1, _.push(w), w === y)
          break;
      }
      _.length > 0 && l.push(_);
    }
  }, d = 0, v = n; d < v.length; d++) {
    var p = v[d];
    !u[p.id] && u[p.id] !== 0 && h(p);
  }
  return l;
};
function sb(r, t) {
  return t ? Zk(r) : xW(r);
}
var Mo = function(t) {
  var e = {}, n = t.nodes, i = n === void 0 ? [] : n, a = t.edges, o = a === void 0 ? [] : a;
  return i.forEach(function(s) {
    e[s.id] = {
      degree: 0,
      inDegree: 0,
      outDegree: 0
    };
  }), o.forEach(function(s) {
    e[s.source].degree++, e[s.source].outDegree++, e[s.target].degree++, e[s.target].inDegree++;
  }), e;
}, Qk = function(t, e) {
  var n = Mo(t);
  return n[e] ? Mo(t)[e].inDegree : 0;
}, Jk = function(t, e) {
  var n = Mo(t);
  return n[e] ? Mo(t)[e].outDegree : 0;
};
function _W(r) {
  r === void 0 && (r = {});
  var t = r, e = function() {
  }, n = function() {
    var i = {};
    return function(a) {
      var o = a.next;
      return i[o] ? !1 : (i[o] = !0, !0);
    };
  }();
  return t.allowTraversal = r.allowTraversal || n, t.enter = r.enter || e, t.leave = r.leave || e, t;
}
function eL(r, t, e, n) {
  n.enter({
    current: t,
    previous: e
  });
  var i = r.edges, a = i === void 0 ? [] : i;
  _i(t, a, "target").forEach(function(o) {
    n.allowTraversal({
      previous: e,
      current: t,
      next: o
    }) && eL(r, o, t, n);
  }), n.leave({
    current: t,
    previous: e
  });
}
function ub(r, t, e) {
  eL(r, t, "", _W(e));
}
var fb = function(t) {
  var e = null, n = t.nodes, i = n === void 0 ? [] : n, a = {}, o = {}, s = {}, u = {};
  i.forEach(function(c) {
    o[c.id] = c;
  });
  for (var f = {
    enter: function(h) {
      var d = h.current, v = h.previous;
      if (s[d]) {
        e = {};
        for (var p = d, g = v; g !== d; )
          e[p] = g, p = g, g = a[g];
        e[p] = g;
      } else
        s[d] = d, delete o[d], a[d] = v;
    },
    leave: function(h) {
      var d = h.current;
      u[d] = d, delete s[d];
    },
    allowTraversal: function(h) {
      var d = h.next;
      return e ? !1 : !u[d];
    }
  }; Object.keys(o).length; ) {
    var l = Object.keys(o)[0];
    ub(t, l, f);
  }
  return e;
}, lb = function(t, e, n) {
  var i, a;
  n === void 0 && (n = !0);
  for (var o = [], s = sb(t, !1), u = 0, f = s; u < f.length; u++) {
    var l = f[u];
    if (!!l.length)
      for (var c = l[0], h = c.id, d = [c], v = (i = {}, i[h] = c, i), p = (a = {}, a[h] = /* @__PURE__ */ new Set(), a); d.length > 0; )
        for (var g = d.pop(), y = g.id, b = _i(y, t.edges), m = function(w) {
          var E, M = b[w], C = t.nodes.find(function(L) {
            return L.id === M;
          });
          if (M === y)
            o.push((E = {}, E[M] = g, E));
          else if (!(M in p))
            v[M] = g, d.push(C), p[M] = /* @__PURE__ */ new Set([g]);
          else if (!p[y].has(C)) {
            for (var S = !0, A = [C, g], T = v[y]; p[M].size && !p[M].has(T) && (A.push(T), T !== v[T.id]); )
              T = v[T.id];
            if (A.push(T), e && n ? (S = !1, A.findIndex(function(L) {
              return e.indexOf(L.id) > -1;
            }) > -1 && (S = !0)) : e && !n && A.findIndex(function(L) {
              return e.indexOf(L.id) > -1;
            }) > -1 && (S = !1), S) {
              for (var P = {}, k = 1; k < A.length; k += 1)
                P[A[k - 1].id] = A[k];
              A.length && (P[A[A.length - 1].id] = A[0]), o.push(P);
            }
            p[M].add(g);
          }
        }, x = 0; x < b.length; x += 1)
          m(x);
  }
  return o;
}, cb = function(t, e, n) {
  n === void 0 && (n = !0);
  for (var i = [], a = /* @__PURE__ */ new Set(), o = [], s = [], u = {}, f = {}, l = function(T) {
    for (var P = [T]; P.length > 0; ) {
      var k = P.pop();
      a.has(k) && (a.delete(k), o[k.id].forEach(function(L) {
        P.push(L);
      }), o[k.id].clear());
    }
  }, c = function A(T, P, k) {
    var L = !1;
    if (e && n === !1 && e.indexOf(T.id) > -1)
      return L;
    i.push(T), a.add(T);
    for (var O = k[T.id], D = 0; D < O.length; D += 1) {
      var G = u[O[D]];
      if (G === P) {
        for (var R = {}, F = 1; F < i.length; F += 1)
          R[i[F - 1].id] = i[F];
        i.length && (R[i[i.length - 1].id] = i[0]), s.push(R), L = !0;
      } else
        a.has(G) || A(G, P, k) && (L = !0);
    }
    if (L)
      l(T);
    else
      for (var D = 0; D < O.length; D += 1) {
        var G = u[O[D]];
        o[G.id].has(T) || o[G.id].add(T);
      }
    return i.pop(), L;
  }, h = t.nodes, d = h === void 0 ? [] : h, v = 0; v < d.length; v += 1) {
    var p = d[v], g = p.id;
    f[g] = v, u[v] = p;
  }
  if (e && n)
    for (var y = function(T) {
      var P = e[T];
      f[d[T].id] = f[P], f[P] = 0, u[0] = d.find(function(k) {
        return k.id === P;
      }), u[f[d[T].id]] = d[T];
    }, v = 0; v < e.length; v++)
      y(v);
  for (var b = function(T) {
    for (var P, k, L = 1 / 0, O = 0; O < T.length; O += 1)
      for (var D = T[O], G = 0; G < D.length; G++) {
        var R = f[D[G].id];
        R < L && (L = R, k = O);
      }
    for (var F = T[k], q = [], O = 0; O < F.length; O += 1) {
      var ne = F[O];
      q[ne.id] = [];
      for (var oe = 0, ie = _i(ne.id, t.edges, "target").filter(function(le) {
        return F.map(function(Me) {
          return Me.id;
        }).indexOf(le) > -1;
      }); oe < ie.length; oe++) {
        var Ee = ie[oe];
        Ee === ne.id && !(n === !1 && e.indexOf(ne.id) > -1) ? s.push((P = {}, P[ne.id] = ne, P)) : q[ne.id].push(f[Ee]);
      }
    }
    return {
      component: F,
      adjList: q,
      minIdx: L
    };
  }, m = 0; m < d.length; ) {
    var x = d.filter(function(A) {
      return f[A.id] >= m;
    }), _ = Zk({
      nodes: x,
      edges: t.edges
    }).filter(function(A) {
      return A.length > 1;
    });
    if (_.length === 0)
      break;
    var w = b(_), E = w.minIdx, M = w.adjList, C = w.component;
    if (C.length > 1) {
      C.forEach(function(A) {
        o[A.id] = /* @__PURE__ */ new Set();
      });
      var S = u[E];
      if (e && n && e.indexOf(S.id) === -1)
        return s;
      c(S, S, M), m = E + 1;
    } else
      break;
  }
  return s;
}, tL = function(t, e, n, i) {
  return i === void 0 && (i = !0), e ? cb(t, n, i) : lb(t, n, i);
}, wW = function(t, e, n) {
  for (var i = 1 / 0, a, o = 0; o < e.length; o++) {
    var s = e[o].id;
    !n[s] && t[s] <= i && (i = t[s], a = e[o]);
  }
  return a;
}, Ac = function(t, e, n, i) {
  var a = t.nodes, o = a === void 0 ? [] : a, s = t.edges, u = s === void 0 ? [] : s, f = {}, l = {}, c = {};
  o.forEach(function(b, m) {
    var x = b.id;
    l[x] = 1 / 0, x === e && (l[x] = 0);
  });
  for (var h = o.length, d = function(m) {
    var x = wW(l, o, f), _ = x.id;
    if (f[_] = !0, l[_] === 1 / 0)
      return "continue";
    var w = [];
    n ? w = mW(_, u) : w = vv(_, u), w.forEach(function(E) {
      var M = E.target, C = E.source, S = M === _ ? C : M, A = i && E[i] ? E[i] : 1;
      l[S] > l[x.id] + A ? (l[S] = l[x.id] + A, c[S] = [x.id]) : l[S] === l[x.id] + A && c[S].push(x.id);
    });
  }, v = 0; v < h; v++)
    d();
  c[e] = [e];
  var p = {};
  for (var g in l)
    l[g] !== 1 / 0 && rL(e, g, c, p);
  var y = {};
  for (var g in p)
    y[g] = p[g][0];
  return {
    length: l,
    path: y,
    allPath: p
  };
};
function rL(r, t, e, n) {
  if (r === t)
    return [r];
  if (n[t])
    return n[t];
  for (var i = [], a = 0, o = e[t]; a < o.length; a++) {
    var s = o[a], u = rL(r, s, e, n);
    if (!u)
      return;
    for (var f = 0, l = u; f < l.length; f++) {
      var c = l[f];
      Dt(c) ? i.push(Ga(Ga([], c, !0), [t], !1)) : i.push([c, t]);
    }
  }
  return n[t] = i, n[t];
}
var nL = function(t, e, n, i, a) {
  var o = Ac(t, e, i, a), s = o.length, u = o.path, f = o.allPath;
  return {
    length: s[n],
    path: u[n],
    allPath: f[n]
  };
}, iL = function(t, e, n, i) {
  var a;
  if (e === n)
    return [[e]];
  var o = t.edges, s = o === void 0 ? [] : o, u = [e], f = (a = {}, a[e] = !0, a), l = [], c = [], h = i ? _i(e, s, "target") : _i(e, s);
  for (l.push(h); u.length > 0 && l.length > 0; ) {
    var d = l[l.length - 1];
    if (d.length) {
      var v = d.shift();
      v && (u.push(v), f[v] = !0, h = i ? _i(v, s, "target") : _i(v, s), l.push(h.filter(function(y) {
        return !f[y];
      })));
    } else {
      var p = u.pop();
      f[p] = !1, l.pop();
      continue;
    }
    if (u[u.length - 1] === n) {
      var g = u.map(function(b) {
        return b;
      });
      c.push(g);
      var p = u.pop();
      f[p] = !1, l.pop();
    }
  }
  return c;
}, Ic = function(t, e) {
  for (var n = pu(t, e), i = [], a = n.length, o = 0; o < a; o += 1) {
    i[o] = [];
    for (var s = 0; s < a; s += 1)
      o === s ? i[o][s] = 0 : n[o][s] === 0 || !n[o][s] ? i[o][s] = 1 / 0 : i[o][s] = n[o][s];
  }
  for (var u = 0; u < a; u += 1)
    for (var o = 0; o < a; o += 1)
      for (var s = 0; s < a; s += 1)
        i[o][s] > i[o][u] + i[u][s] && (i[o][s] = i[o][u] + i[u][s]);
  return i;
}, aL = function(t, e, n, i) {
  e === void 0 && (e = !1), n === void 0 && (n = "weight"), i === void 0 && (i = 1e3);
  var a = t.nodes, o = a === void 0 ? [] : a, s = t.edges, u = s === void 0 ? [] : s, f = {}, l = {};
  o.forEach(function(m, x) {
    var _ = Kk();
    m.clusterId = _, f[_] = {
      id: _,
      nodes: [m]
    }, l[m.id] = {
      node: m,
      idx: x
    };
  });
  var c = pu(t, e), h = {};
  c.forEach(function(m, x) {
    var _ = o[x].id;
    h[_] = {}, m.forEach(function(w, E) {
      if (!!w) {
        var M = o[E].id;
        h[_][M] = w;
      }
    });
  });
  for (var d = 0, v = function() {
    var x = !1;
    if (o.forEach(function(_) {
      var w = {};
      Object.keys(h[_.id]).forEach(function(k) {
        var L = h[_.id][k], O = l[k].node, D = O.clusterId;
        w[D] || (w[D] = 0), w[D] += L;
      });
      var E = -1 / 0, M = [];
      if (Object.keys(w).forEach(function(k) {
        E < w[k] ? (E = w[k], M = [k]) : E === w[k] && M.push(k);
      }), !(M.length === 1 && M[0] === _.clusterId)) {
        var C = M.indexOf(_.clusterId);
        if (C >= 0 && M.splice(C, 1), M && M.length) {
          x = !0;
          var S = f[_.clusterId], A = S.nodes.indexOf(_);
          S.nodes.splice(A, 1);
          var T = Math.floor(Math.random() * M.length), P = f[M[T]];
          P.nodes.push(_), _.clusterId = P.id;
        }
      }
    }), !x)
      return "break";
    d++;
  }; d < i; ) {
    var p = v();
    if (p === "break")
      break;
  }
  Object.keys(f).forEach(function(m) {
    var x = f[m];
    (!x.nodes || !x.nodes.length) && delete f[m];
  });
  var g = [], y = {};
  u.forEach(function(m) {
    var x = m.source, _ = m.target, w = m[n] || 1, E = l[x].node.clusterId, M = l[_].node.clusterId, C = "".concat(E, "---").concat(M);
    if (y[C])
      y[C].weight += w, y[C].count++;
    else {
      var S = {
        source: E,
        target: M,
        weight: w,
        count: 1
      };
      y[C] = S, g.push(S);
    }
  });
  var b = [];
  return Object.keys(f).forEach(function(m) {
    b.push(f[m]);
  }), {
    clusters: b,
    clusterEdges: g
  };
}, Bi = function() {
  function r(t) {
    this.arr = t;
  }
  return r.prototype.getArr = function() {
    return this.arr || [];
  }, r.prototype.add = function(t) {
    var e, n = t.arr;
    if (!(!((e = this.arr) === null || e === void 0) && e.length))
      return new r(n);
    if (!(n != null && n.length))
      return new r(this.arr);
    if (this.arr.length === n.length) {
      var i = [];
      for (var a in this.arr)
        i[a] = this.arr[a] + n[a];
      return new r(i);
    }
  }, r.prototype.subtract = function(t) {
    var e, n = t.arr;
    if (!(!((e = this.arr) === null || e === void 0) && e.length))
      return new r(n);
    if (!(n != null && n.length))
      return new r(this.arr);
    if (this.arr.length === n.length) {
      var i = [];
      for (var a in this.arr)
        i[a] = this.arr[a] - n[a];
      return new r(i);
    }
  }, r.prototype.avg = function(t) {
    var e = [];
    if (t !== 0)
      for (var n in this.arr)
        e[n] = this.arr[n] / t;
    return new r(e);
  }, r.prototype.negate = function() {
    var t = [];
    for (var e in this.arr)
      t[e] = -this.arr[e];
    return new r(t);
  }, r.prototype.squareEuclideanDistance = function(t) {
    var e, n = t.arr;
    if (!(!((e = this.arr) === null || e === void 0) && e.length) || !(n != null && n.length))
      return 0;
    if (this.arr.length === n.length) {
      var i = 0;
      for (var a in this.arr)
        i += Math.pow(this.arr[a] - t.arr[a], 2);
      return i;
    }
  }, r.prototype.euclideanDistance = function(t) {
    var e, n = t.arr;
    if (!(!((e = this.arr) === null || e === void 0) && e.length) || !(n != null && n.length))
      return 0;
    if (this.arr.length === n.length) {
      var i = 0;
      for (var a in this.arr)
        i += Math.pow(this.arr[a] - t.arr[a], 2);
      return Math.sqrt(i);
    } else
      console.error("The two vectors are unequal in length.");
  }, r.prototype.normalize = function() {
    var t = [], e = vr(this.arr);
    e.sort(function(o, s) {
      return o - s;
    });
    var n = e[e.length - 1], i = e[0];
    for (var a in this.arr)
      t[a] = (this.arr[a] - i) / (n - i);
    return new r(t);
  }, r.prototype.norm2 = function() {
    var t;
    if (!(!((t = this.arr) === null || t === void 0) && t.length))
      return 0;
    var e = 0;
    for (var n in this.arr)
      e += Math.pow(this.arr[n], 2);
    return Math.sqrt(e);
  }, r.prototype.dot = function(t) {
    var e, n = t.arr;
    if (!(!((e = this.arr) === null || e === void 0) && e.length) || !(n != null && n.length))
      return 0;
    if (this.arr.length === n.length) {
      var i = 0;
      for (var a in this.arr)
        i += this.arr[a] * t.arr[a];
      return i;
    } else
      console.error("The two vectors are unequal in length.");
  }, r.prototype.equal = function(t) {
    var e, n = t.arr;
    if (((e = this.arr) === null || e === void 0 ? void 0 : e.length) !== (n == null ? void 0 : n.length))
      return !1;
    for (var i in this.arr)
      if (this.arr[i] !== n[i])
        return !1;
    return !0;
  }, r;
}(), hb = function(t, e) {
  e === void 0 && (e = void 0);
  var n = [];
  return t.forEach(function(i) {
    e === void 0 && n.push(i), i[e] !== void 0 && n.push(i[e]);
  }), n;
}, ea;
(function(r) {
  r.EuclideanDistance = "euclideanDistance";
})(ea || (ea = {}));
var EW = function(t, e, n) {
  var i = [];
  e != null && e.length ? i = e : (t.forEach(function(o) {
    i = i.concat(Object.keys(o));
  }), i = Cc(i));
  var a = {};
  return i.forEach(function(o) {
    var s = [];
    t.forEach(function(u) {
      u[o] !== void 0 && u[o] !== "" && s.push(u[o]);
    }), s.length && !(n != null && n.includes(o)) && (a[o] = Cc(s));
  }), a;
}, db = function(t, e, n) {
  var i = EW(t, e, n), a = [];
  if (!Object.keys(i).length)
    return a;
  var o = Object.values(i), s = o.every(function(u) {
    return u.every(function(f) {
      return typeof f == "number";
    });
  });
  return t.forEach(function(u, f) {
    var l = [];
    Object.keys(i).forEach(function(c) {
      var h = u[c], d = i[c], v = d.findIndex(function(y) {
        return h === y;
      }), p = [];
      if (s)
        p.push(h);
      else
        for (var g = 0; g < d.length; g++)
          g === v ? p.push(1) : p.push(0);
      l = l.concat(p);
    }), a[f] = l;
  }), a;
}, iE = function(t, e, n, i) {
  n === void 0 && (n = ea.EuclideanDistance);
  var a = 0;
  switch (n) {
    case ea.EuclideanDistance:
      a = new Bi(t).euclideanDistance(new Bi(e));
      break;
  }
  return a;
}, aE = function(t, e, n, i) {
  for (var a = e.length, o = 2 * i, s = 0, u = 0; u < a; u++)
    for (var f = t[u].clusterId, l = 0; l < a; l++) {
      var c = t[l].clusterId;
      if (f === c) {
        var h = e[u][l] || 0, d = n[u] || 0, v = n[l] || 0;
        s += h - d * v / o;
      }
    }
  return s *= 1 / o, s;
}, A0 = function(t, e) {
  t === void 0 && (t = []);
  for (var n = t.length, i = new Bi([]), a = 0; a < n; a++)
    i = i.add(new Bi(e[a]));
  var o = i.avg(n);
  o.normalize();
  for (var s = 0, a = 0; a < n; a++) {
    var u = new Bi(e[a]), f = u.squareEuclideanDistance(o);
    s += f;
  }
  var l = [];
  t.forEach(function() {
    l.push([]);
  });
  for (var a = 0; a < n; a++) {
    var u = new Bi(e[a]);
    t[a].clusterInertial = 0;
    for (var c = 0; c < n; c++) {
      if (a === c) {
        l[a][c] = 0;
        continue;
      }
      var h = new Bi(e[c]);
      l[a][c] = u.squareEuclideanDistance(h), t[a].clusterInertial += l[a][c];
    }
  }
  for (var d = 0, v = 2 * n * s, a = 0; a < n; a++)
    for (var p = t[a].clusterId, c = 0; c < n; c++) {
      var g = t[c].clusterId;
      if (!(a === c || p !== g)) {
        var y = t[a].clusterInertial * t[c].clusterInertial / Math.pow(v, 2) - l[a][c] / v;
        d += y;
      }
    }
  return Number(d.toFixed(4));
}, vb = function(t, e, n, i, a, o, s, u, f) {
  e === void 0 && (e = !1), n === void 0 && (n = "weight"), i === void 0 && (i = 1e-4), a === void 0 && (a = !1), o === void 0 && (o = void 0), s === void 0 && (s = []), u === void 0 && (u = ["id"]), f === void 0 && (f = 1);
  var l = t.nodes, c = l === void 0 ? [] : l, h = t.edges, d = h === void 0 ? [] : h, v = [];
  if (a) {
    c.forEach(function(R, F) {
      R.properties = R.properties || {}, R.originIndex = F;
    });
    var p = [];
    c.every(function(R) {
      return R.hasOwnProperty("nodeType");
    }) && (p = Array.from(new Set(c.map(function(R) {
      return R.nodeType;
    }))), c.forEach(function(R) {
      R.properties.nodeType = p.findIndex(function(F) {
        return F === R.nodeType;
      });
    }));
    var g = hb(c, o);
    v = db(g, s, u);
  }
  var y = 1, b = {}, m = {};
  c.forEach(function(R, F) {
    var q = String(y++);
    R.clusterId = q, b[q] = {
      id: q,
      nodes: [R]
    }, m[R.id] = {
      node: R,
      idx: F
    };
  });
  var x = pu(t, e), _ = [], w = {}, E = 0;
  x.forEach(function(R, F) {
    var q = 0, ne = c[F].id;
    w[ne] = {}, R.forEach(function(oe, ie) {
      if (!!oe) {
        q += oe;
        var Ee = c[ie].id;
        w[ne][Ee] = oe, E += oe;
      }
    }), _.push(q);
  }), E /= 2;
  for (var M = 1 / 0, C = 1 / 0, S = 0, A = [], T = {}; ; ) {
    a && c.every(function(R) {
      return R.hasOwnProperty("properties");
    }) ? M = aE(c, x, _, E) + A0(c, v) * f : M = aE(c, x, _, E), S === 0 && (C = M, A = c, T = b);
    var P = M > 0 && M > C && M - C < i;
    if (M > C && (A = c.map(function(R) {
      return {
        node: R,
        clusterId: R.clusterId
      };
    }), T = vr(b), C = M), P || S > 100)
      break;
    S++, Object.keys(b).forEach(function(R) {
      var F = 0;
      d.forEach(function(q) {
        var ne = q.source, oe = q.target, ie = m[ne].node.clusterId, Ee = m[oe].node.clusterId;
        (ie === R && Ee !== R || Ee === R && ie !== R) && (F = F + (q[n] || 1));
      }), b[R].sumTot = F;
    }), c.forEach(function(R, F) {
      var q = b[R.clusterId], ne = 0, oe, ie = _[F] / (2 * E), Ee = 0, Xe = q.nodes;
      Xe.forEach(function(X) {
        var De = m[X.id].idx;
        Ee += x[F][De] || 0;
      });
      var le = Ee - q.sumTot * ie, Me = Xe.filter(function(X) {
        return X.id !== R.id;
      });
      Me.forEach(function(X, De) {
        v[X.originIndex];
      });
      var $e = A0(Me, v) * f, et = w[R.id];
      if (Object.keys(et).forEach(function(X) {
        var De = m[X].node, Ke = De.clusterId;
        if (Ke !== R.clusterId) {
          var Fe = b[Ke], _t = Fe.nodes;
          if (!(!_t || !_t.length)) {
            var Kt = 0;
            _t.forEach(function(pe) {
              var se = m[pe.id].idx;
              Kt += x[F][se] || 0;
            });
            var Ye = Kt - Fe.sumTot * ie, vt = _t.concat([R]);
            vt.forEach(function(pe, se) {
              v[pe.originIndex];
            });
            var N = A0(vt, v) * f, Z = Ye - le;
            a && (Z = Ye + N - (le + $e)), Z > ne && (ne = Z, oe = Fe);
          }
        }
      }), ne > 0) {
        oe.nodes.push(R);
        var ft = R.clusterId;
        R.clusterId = oe.id;
        var pt = q.nodes.indexOf(R);
        q.nodes.splice(pt, 1);
        var $ = 0, te = 0;
        d.forEach(function(X) {
          var De = X.source, Ke = X.target, Fe = m[De].node.clusterId, _t = m[Ke].node.clusterId;
          (Fe === oe.id && _t !== oe.id || _t === oe.id && Fe !== oe.id) && ($ = $ + (X[n] || 1)), (Fe === ft && _t !== ft || _t === ft && Fe !== ft) && (te = te + (X[n] || 1));
        }), oe.sumTot = $, q.sumTot = te;
      }
    });
  }
  var k = {}, L = 0;
  Object.keys(T).forEach(function(R) {
    var F = T[R];
    if (!F.nodes || !F.nodes.length) {
      delete T[R];
      return;
    }
    var q = String(L + 1);
    q !== R && (F.id = q, F.nodes = F.nodes.map(function(ne) {
      return {
        id: ne.id,
        clusterId: q
      };
    }), T[q] = F, k[R] = q, delete T[R], L++);
  }), A.forEach(function(R) {
    var F = R.node, q = R.clusterId;
    !F || (F.clusterId = q, F.clusterId && k[F.clusterId] && (F.clusterId = k[F.clusterId]));
  });
  var O = [], D = {};
  d.forEach(function(R) {
    var F = R.source, q = R.target, ne = R[n] || 1, oe = m[F].node.clusterId, ie = m[q].node.clusterId;
    if (!(!oe || !ie)) {
      var Ee = "".concat(oe, "---").concat(ie);
      if (D[Ee])
        D[Ee].weight += ne, D[Ee].count++;
      else {
        var Xe = {
          source: oe,
          target: ie,
          weight: ne,
          count: 1
        };
        D[Ee] = Xe, O.push(Xe);
      }
    }
  });
  var G = [];
  return Object.keys(T).forEach(function(R) {
    G.push(T[R]);
  }), {
    clusters: G,
    clusterEdges: O
  };
}, oL = function(t, e, n, i, a, o, s, u) {
  return e === void 0 && (e = !1), n === void 0 && (n = "weight"), i === void 0 && (i = 1e-4), a === void 0 && (a = void 0), o === void 0 && (o = []), s === void 0 && (s = ["id"]), u === void 0 && (u = 1), vb(t, e, n, i, !0, a, o, s, u);
}, sL = function(t, e) {
  var n;
  e === void 0 && (e = 1);
  for (var i = vr(t), a = i.nodes, o = a === void 0 ? [] : a, s = i.edges, u = s === void 0 ? [] : s, f = function() {
    var h = Mo({
      nodes: o,
      edges: u
    }), d = Object.keys(h);
    d.sort(function(g, y) {
      var b, m;
      return ((b = h[g]) === null || b === void 0 ? void 0 : b.degree) - ((m = h[y]) === null || m === void 0 ? void 0 : m.degree);
    });
    var v = d[0];
    if (!o.length || ((n = h[v]) === null || n === void 0 ? void 0 : n.degree) >= e)
      return "break";
    var p = o.findIndex(function(g) {
      return g.id === v;
    });
    o.splice(p, 1), u = u.filter(function(g) {
      return !(g.source === v || g.target === v);
    });
  }; ; ) {
    var l = f();
    if (l === "break")
      break;
  }
  return {
    nodes: o,
    edges: u
  };
}, oE = function(t, e, n) {
  var i = [];
  switch (t) {
    case ea.EuclideanDistance:
      i = e[n];
      break;
    default:
      i = [];
      break;
  }
  return i;
}, uL = function(t, e, n, i, a, o) {
  e === void 0 && (e = 3), n === void 0 && (n = void 0), i === void 0 && (i = []), a === void 0 && (a = ["id"]), o === void 0 && (o = ea.EuclideanDistance);
  var s = t.nodes, u = s === void 0 ? [] : s, f = t.edges, l = f === void 0 ? [] : f, c = {
    clusters: [{
      id: "0",
      nodes: u
    }],
    clusterEdges: []
  };
  if (o === ea.EuclideanDistance && !u.every(function(q) {
    return q.hasOwnProperty(n);
  }))
    return c;
  var h = [], d = [];
  if (o === ea.EuclideanDistance && (h = hb(u, n), d = db(h, i, a)), !d.length)
    return c;
  for (var v = Cc(d.map(function(q) {
    return q.join("");
  })), p = Math.min(e, u.length, v.length), g = 0; g < u.length; g++)
    u[g].originIndex = g;
  for (var y = [], b = [], m = [], g = 0; g < p; g++)
    if (g === 0) {
      var x = Math.floor(Math.random() * u.length);
      switch (o) {
        case ea.EuclideanDistance:
          y[g] = d[x];
          break;
        default:
          y[g] = [];
          break;
      }
      b.push(x), m[g] = [u[x]], u[x].clusterId = String(g);
    } else {
      for (var _ = -1 / 0, w = 0, E = function(oe) {
        if (!b.includes(oe)) {
          for (var ie = 0, Ee = 0; Ee < y.length; Ee++) {
            var Xe = 0;
            switch (o) {
              case ea.EuclideanDistance:
                Xe = iE(d[u[oe].originIndex], y[Ee], o);
                break;
            }
            ie += Xe;
          }
          var le = ie / y.length;
          le > _ && !y.find(function(Me) {
            return ls(Me, oE(o, d, u[oe].originIndex));
          }) && (_ = le, w = oe);
        }
      }, M = 0; M < u.length; M++)
        E(M);
      y[g] = oE(o, d, w), b.push(w), m[g] = [u[w]], u[w].clusterId = String(g);
    }
  for (var C = 0; ; ) {
    for (var g = 0; g < u.length; g++) {
      var S = 0, A = 1 / 0;
      if (!(C === 0 && b.includes(g))) {
        for (var T = 0; T < y.length; T++) {
          var P = 0;
          switch (o) {
            case ea.EuclideanDistance:
              P = iE(d[g], y[T], o);
              break;
          }
          P < A && (A = P, S = T);
        }
        if (u[g].clusterId !== void 0)
          for (var k = m[Number(u[g].clusterId)].length - 1; k >= 0; k--)
            m[Number(u[g].clusterId)][k].id === u[g].id && m[Number(u[g].clusterId)].splice(k, 1);
        u[g].clusterId = String(S), m[S].push(u[g]);
      }
    }
    for (var L = !1, g = 0; g < m.length; g++) {
      for (var O = m[g], D = new Bi([]), T = 0; T < O.length; T++)
        D = D.add(new Bi(d[O[T].originIndex]));
      var G = D.avg(O.length);
      G.equal(new Bi(y[g])) || (L = !0, y[g] = G.getArr());
    }
    if (C++, u.every(function(q) {
      return q.clusterId !== void 0;
    }) && L || C >= 1e3)
      break;
  }
  var R = [], F = {};
  return l.forEach(function(q) {
    var ne, oe, ie = q.source, Ee = q.target, Xe = (ne = u.find(function(et) {
      return et.id === ie;
    })) === null || ne === void 0 ? void 0 : ne.clusterId, le = (oe = u.find(function(et) {
      return et.id === Ee;
    })) === null || oe === void 0 ? void 0 : oe.clusterId, Me = "".concat(Xe, "---").concat(le);
    if (F[Me])
      F[Me].count++;
    else {
      var $e = {
        source: Xe,
        target: le,
        count: 1
      };
      F[Me] = $e, R.push($e);
    }
  }), {
    clusters: m,
    clusterEdges: R
  };
}, pb = function(t, e) {
  var n = new Bi(e), i = n.norm2(), a = new Bi(t), o = a.norm2(), s = n.dot(a), u = i * o, f = u ? s / u : 0;
  return f;
}, fL = function(t, e, n, i, a) {
  t === void 0 && (t = []), n === void 0 && (n = void 0), i === void 0 && (i = []), a === void 0 && (a = []);
  var o = vr(t.filter(function(h) {
    return h.id !== e.id;
  })), s = t.findIndex(function(h) {
    return h.id === e.id;
  }), u = hb(t, n), f = db(u, i, a), l = f[s], c = [];
  return o.forEach(function(h, d) {
    if (h.id !== e.id) {
      var v = f[d], p = pb(v, l);
      c.push(p), h.cosineSimilarity = p;
    }
  }), o.sort(function(h, d) {
    return d.cosineSimilarity - h.cosineSimilarity;
  }), {
    allCosineSimilarity: c,
    similarNodes: o
  };
}, SW = function() {
  function r(t) {
    this.count = t.length, this.parent = {};
    for (var e = 0, n = t; e < n.length; e++) {
      var i = n[e];
      this.parent[i] = i;
    }
  }
  return r.prototype.find = function(t) {
    for (; this.parent[t] !== t; )
      t = this.parent[t];
    return t;
  }, r.prototype.union = function(t, e) {
    var n = this.find(t), i = this.find(e);
    n !== i && (n < i ? (this.parent[e] !== e && this.union(this.parent[e], t), this.parent[e] = this.parent[t]) : (this.parent[t] !== t && this.union(this.parent[t], e), this.parent[t] = this.parent[e]));
  }, r.prototype.connected = function(t, e) {
    return this.find(t) === this.find(e);
  }, r;
}(), MW = function(t, e) {
  return t - e;
}, CW = function() {
  function r(t) {
    t === void 0 && (t = MW), this.compareFn = t, this.list = [];
  }
  return r.prototype.getLeft = function(t) {
    return 2 * t + 1;
  }, r.prototype.getRight = function(t) {
    return 2 * t + 2;
  }, r.prototype.getParent = function(t) {
    return t === 0 ? null : Math.floor((t - 1) / 2);
  }, r.prototype.isEmpty = function() {
    return this.list.length <= 0;
  }, r.prototype.top = function() {
    return this.isEmpty() ? void 0 : this.list[0];
  }, r.prototype.delMin = function() {
    var t = this.top(), e = this.list.pop();
    return this.list.length > 0 && (this.list[0] = e, this.moveDown(0)), t;
  }, r.prototype.insert = function(t) {
    if (t !== null) {
      this.list.push(t);
      var e = this.list.length - 1;
      return this.moveUp(e), !0;
    }
    return !1;
  }, r.prototype.moveUp = function(t) {
    for (var e = this.getParent(t); t && t > 0 && this.compareFn(this.list[e], this.list[t]) > 0; ) {
      var n = this.list[e];
      this.list[e] = this.list[t], this.list[t] = n, t = e, e = this.getParent(t);
    }
  }, r.prototype.moveDown = function(t) {
    var e, n = t, i = this.getLeft(t), a = this.getRight(t), o = this.list.length;
    i !== null && i < o && this.compareFn(this.list[n], this.list[i]) > 0 ? n = i : a !== null && a < o && this.compareFn(this.list[n], this.list[a]) > 0 && (n = a), t !== n && (e = [this.list[n], this.list[t]], this.list[t] = e[0], this.list[n] = e[1], this.moveDown(n));
  }, r;
}(), TW = function(t, e) {
  var n = [], i = t.nodes, a = i === void 0 ? [] : i, o = t.edges, s = o === void 0 ? [] : o;
  if (a.length === 0)
    return n;
  var u = a[0], f = /* @__PURE__ */ new Set();
  f.add(u);
  var l = function(g, y) {
    return e ? g.weight - y.weight : 0;
  }, c = new CW(l);
  for (vv(u.id, s).forEach(function(p) {
    c.insert(p);
  }); !c.isEmpty(); ) {
    var h = c.delMin(), d = h.source, v = h.target;
    f.has(d) && f.has(v) || (n.push(h), f.has(d) || (f.add(d), vv(d, s).forEach(function(p) {
      c.insert(p);
    })), f.has(v) || (f.add(v), vv(v, s).forEach(function(p) {
      c.insert(p);
    })));
  }
  return n;
}, sE = function(t, e) {
  var n = [], i = t.nodes, a = i === void 0 ? [] : i, o = t.edges, s = o === void 0 ? [] : o;
  if (a.length === 0)
    return n;
  var u = s.map(function(d) {
    return d;
  });
  e && u.sort(function(d, v) {
    return d.weight - v.weight;
  });
  for (var f = new SW(a.map(function(d) {
    return d.id;
  })); u.length > 0; ) {
    var l = u.shift(), c = l.source, h = l.target;
    f.connected(c, h) || (n.push(l), f.union(c, h));
  }
  return n;
}, lL = function(t, e, n) {
  var i = {
    prim: TW,
    kruskal: sE
  };
  return n ? i[n](t, e) : sE(t, e);
}, cL = function(t, e, n) {
  typeof e != "number" && (e = 1e-6), typeof n != "number" && (n = 0.85);
  for (var i = 1, a = 0, o = 1e3, s = t.nodes, u = s === void 0 ? [] : s, f = t.edges, l = f === void 0 ? [] : f, c = u.length, h, d = {}, v = {}, p = 0; p < c; ++p) {
    var g = u[p], y = g.id;
    d[y] = 1 / c, v[y] = 1 / c;
  }
  for (var b = Mo(t); o > 0 && i > e; ) {
    a = 0;
    for (var p = 0; p < c; ++p) {
      var g = u[p], y = g.id;
      if (h = 0, b[g.id].inDegree === 0)
        d[y] = 0;
      else {
        for (var m = _i(y, l, "source"), x = 0; x < m.length; ++x) {
          var _ = m[x], w = b[_].outDegree;
          w > 0 && (h += v[_] / w);
        }
        d[y] = n * h, a += d[y];
      }
    }
    a = (1 - a) / c, i = 0;
    for (var p = 0; p < c; ++p) {
      var g = u[p], y = g.id;
      h = d[y] + a, i += Math.abs(h - v[y]), v[y] = h;
    }
    o -= 1;
  }
  return v;
}, AW = -1, jv = -1, hL = "-1", Pa = "-1", dL = -1, uE = function() {
  function r(t, e, n, i) {
    t === void 0 && (t = AW), e === void 0 && (e = jv), n === void 0 && (n = jv), i === void 0 && (i = hL), this.id = t, this.from = e, this.to = n, this.label = i;
  }
  return r;
}(), IW = function() {
  function r(t, e) {
    t === void 0 && (t = jv), e === void 0 && (e = Pa), this.id = t, this.label = e, this.edges = [], this.edgeMap = {};
  }
  return r.prototype.addEdge = function(t) {
    this.edges.push(t), this.edgeMap[t.id] = t;
  }, r;
}(), vL = function() {
  function r(t, e, n) {
    t === void 0 && (t = jv), e === void 0 && (e = !0), n === void 0 && (n = !1), this.id = t, this.edgeIdAutoIncrease = e, this.edges = [], this.nodes = [], this.nodeMap = {}, this.edgeMap = {}, this.nodeLabelMap = {}, this.edgeLabelMap = {}, this.counter = 0, this.directed = n;
  }
  return r.prototype.getNodeNum = function() {
    return this.nodes.length;
  }, r.prototype.addNode = function(t, e) {
    if (!this.nodeMap[t]) {
      var n = new IW(t, e);
      this.nodes.push(n), this.nodeMap[t] = n, this.nodeLabelMap[e] || (this.nodeLabelMap[e] = []), this.nodeLabelMap[e].push(t);
    }
  }, r.prototype.addEdge = function(t, e, n, i) {
    if ((this.edgeIdAutoIncrease || t === void 0) && (t = this.counter++), !(this.nodeMap[e] && this.nodeMap[n] && this.nodeMap[n].edgeMap[t])) {
      var a = new uE(t, e, n, i);
      if (this.edges.push(a), this.edgeMap[t] = a, this.nodeMap[e].addEdge(a), this.edgeLabelMap[i] || (this.edgeLabelMap[i] = []), this.edgeLabelMap[i].push(a), !this.directed) {
        var o = new uE(t, n, e, i);
        this.nodeMap[n].addEdge(o), this.edgeLabelMap[i].push(o);
      }
    }
  }, r;
}(), Ks = function() {
  function r(t, e, n, i, a) {
    this.fromNode = t, this.toNode = e, this.nodeEdgeNodeLabel = {
      nodeLabel1: n || Pa,
      edgeLabel: i || hL,
      nodeLabel2: a || Pa
    };
  }
  return r.prototype.equalTo = function(t) {
    return this.fromNode === t.formNode && this.toNode === t.toNode && this.nodeEdgeNodeLabel === t.nodeEdgeNodeLabel;
  }, r.prototype.notEqualTo = function(t) {
    return !this.equalTo(t);
  }, r;
}(), fE = function() {
  function r() {
    this.rmpath = [], this.dfsEdgeList = [];
  }
  return r.prototype.equalTo = function(t) {
    var e = this.dfsEdgeList.length, n = t.length;
    if (e !== n)
      return !1;
    for (var i = 0; i < e; i++)
      if (this.dfsEdgeList[i] !== t[i])
        return !1;
    return !0;
  }, r.prototype.notEqualTo = function(t) {
    return !this.equalTo(t);
  }, r.prototype.pushBack = function(t, e, n, i, a) {
    return this.dfsEdgeList.push(new Ks(t, e, n, i, a)), this.dfsEdgeList;
  }, r.prototype.toGraph = function(t, e) {
    t === void 0 && (t = dL), e === void 0 && (e = !1);
    var n = new vL(t, !0, e);
    return this.dfsEdgeList.forEach(function(i) {
      var a = i.fromNode, o = i.toNode, s = i.nodeEdgeNodeLabel, u = s.nodeLabel1, f = s.edgeLabel, l = s.nodeLabel2;
      u !== Pa && n.addNode(a, u), l !== Pa && n.addNode(o, l), u !== Pa && l !== u && n.addEdge(void 0, a, o, f);
    }), n;
  }, r.prototype.buildRmpath = function() {
    this.rmpath = [];
    for (var t = void 0, e = this.dfsEdgeList.length, n = e - 1; n >= 0; n--) {
      var i = this.dfsEdgeList[n], a = i.fromNode, o = i.toNode;
      a < o && (t === void 0 || o === t) && (this.rmpath.push(n), t = a);
    }
    return this.rmpath;
  }, r.prototype.getNodeNum = function() {
    var t = {};
    return this.dfsEdgeList.forEach(function(e) {
      t[e.fromNode] || (t[e.fromNode] = !0), t[e.toNode] || (t[e.toNode] = !0);
    }), Object.keys(t).length;
  }, r;
}(), od = function() {
  function r(t) {
    if (this.his = {}, this.nodesUsed = {}, this.edgesUsed = {}, this.edges = [], !!t) {
      for (; t; ) {
        var e = t.edge;
        this.edges.push(e), this.nodesUsed[e.from] = 1, this.nodesUsed[e.to] = 1, this.edgesUsed[e.id] = 1, t = t.preNode;
      }
      this.edges = this.edges.reverse();
    }
  }
  return r.prototype.hasNode = function(t) {
    return this.nodesUsed[t.id] === 1;
  }, r.prototype.hasEdge = function(t) {
    return this.edgesUsed[t.id] === 1;
  }, r;
}(), PW = function() {
  function r(t) {
    var e = t.graphs, n = t.minSupport, i = n === void 0 ? 2 : n, a = t.minNodeNum, o = a === void 0 ? 1 : a, s = t.maxNodeNum, u = s === void 0 ? 4 : s, f = t.top, l = f === void 0 ? 10 : f, c = t.directed, h = c === void 0 ? !1 : c, d = t.verbose, v = d === void 0 ? !1 : d;
    this.graphs = e, this.dfsCode = new fE(), this.support = 0, this.frequentSize1Subgraphs = [], this.frequentSubgraphs = [], this.minSupport = i, this.top = l, this.directed = h, this.counter = 0, this.maxNodeNum = u, this.minNodeNum = o, this.verbose = v, this.maxNodeNum < this.minNodeNum && (this.maxNodeNum = this.minNodeNum), this.reportDF = [];
  }
  return r.prototype.findForwardRootEdges = function(t, e) {
    var n = this, i = [], a = t.nodeMap;
    return e.edges.forEach(function(o) {
      (n.directed || e.label <= a[o.to].label) && i.push(o);
    }), i;
  }, r.prototype.findBackwardEdge = function(t, e, n, i) {
    if (!this.directed && e === n)
      return null;
    for (var a = t.nodeMap, o = a[n.to], s = o.edges, u = s.length, f = 0; f < u; f++) {
      var l = s[f];
      if (!(i.hasEdge(l) || l.to !== e.from)) {
        if (this.directed) {
          if (a[e.from].label < a[n.to].label || a[e.from].label === a[n.to].label && e.label <= l.label)
            return l;
        } else if (e.label < l.label || e.label === l.label && a[e.to].label <= a[n.to].label)
          return l;
      }
    }
    return null;
  }, r.prototype.findForwardPureEdges = function(t, e, n, i) {
    for (var a = [], o = e.to, s = t.nodeMap[o].edges, u = s.length, f = 0; f < u; f++) {
      var l = s[f], c = t.nodeMap[l.to];
      n <= c.label && !i.hasNode(c) && a.push(l);
    }
    return a;
  }, r.prototype.findForwardRmpathEdges = function(t, e, n, i) {
    for (var a = [], o = t.nodeMap, s = o[e.to].label, u = o[e.from], f = u.edges, l = f.length, c = 0; c < l; c++) {
      var h = f[c], d = o[h.to].label;
      e.to === h.to || n > d || i.hasNode(o[h.to]) || (e.label < h.label || e.label === h.label && s <= d) && a.push(h);
    }
    return a;
  }, r.prototype.getSupport = function(t) {
    var e = {};
    return t.forEach(function(n) {
      e[n.graphId] || (e[n.graphId] = !0);
    }), Object.keys(e).length;
  }, r.prototype.findMinLabel = function(t) {
    var e = void 0;
    return Object.keys(t).forEach(function(n) {
      var i = t[n], a = i.nodeLabel1, o = i.edgeLabel, s = i.nodeLabel2;
      if (!e) {
        e = {
          nodeLabel1: a,
          edgeLabel: o,
          nodeLabel2: s
        };
        return;
      }
      (a < e.nodeLabel1 || a === e.nodeLabel1 && o < e.edgeLabel || a === e.nodeLabel1 && o === e.edgeLabel && s < e.nodeLabel2) && (e = {
        nodeLabel1: a,
        edgeLabel: o,
        nodeLabel2: s
      });
    }), e;
  }, r.prototype.isMin = function() {
    var t = this, e = this.dfsCode;
    if (this.verbose && console.log("isMin checking", e), e.dfsEdgeList.length === 1)
      return !0;
    var n = this.directed, i = e.toGraph(dL, n), a = i.nodeMap, o = new fE(), s = {};
    i.nodes.forEach(function(c) {
      var h = t.findForwardRootEdges(i, c);
      h.forEach(function(d) {
        var v = a[d.to], p = "".concat(c.label, "-").concat(d.label, "-").concat(v.label);
        s[p] || (s[p] = {
          projected: [],
          nodeLabel1: c.label,
          edgeLabel: d.label,
          nodeLabel2: v.label
        });
        var g = {
          graphId: i.id,
          edge: d,
          preNode: null
        };
        s[p].projected.push(g);
      });
    });
    var u = this.findMinLabel(s);
    if (!!u) {
      o.dfsEdgeList.push(new Ks(0, 1, u.nodeLabel1, u.edgeLabel, u.nodeLabel2));
      var f = function c(h) {
        for (var d = o.buildRmpath(), v = o.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1, p = o.dfsEdgeList[d[0]].toNode, g = {}, y = !1, b = 0, m = n ? -1 : 0, x = function(D) {
          if (y)
            return "break";
          h.forEach(function(G) {
            var R = new od(G), F = t.findBackwardEdge(i, R.edges[d[D]], R.edges[d[0]], R);
            F && (g[F.label] || (g[F.label] = {
              projected: [],
              edgeLabel: F.label
            }), g[F.label].projected.push({
              graphId: i.id,
              edge: g,
              preNode: G
            }), b = o.dfsEdgeList[d[D]].fromNode, y = !0);
          });
        }, _ = d.length - 1; _ > m; _--) {
          var w = x(_);
          if (w === "break")
            break;
        }
        if (y) {
          var E = t.findMinLabel(g);
          o.dfsEdgeList.push(new Ks(p, b, Pa, E.edgeLabel, Pa));
          var M = o.dfsEdgeList.length - 1;
          return t.dfsCode.dfsEdgeList[M] !== o.dfsEdgeList[M] ? !1 : c(g[E.edgeLabel].projected);
        }
        var C = {};
        y = !1;
        var S = 0;
        h.forEach(function(O) {
          var D = new od(O), G = t.findForwardPureEdges(i, D.edges[d[0]], v, D);
          G.length > 0 && (y = !0, S = p, G.forEach(function(R) {
            var F = "".concat(R.label, "-").concat(a[R.to].label);
            C[F] || (C[F] = {
              projected: [],
              edgeLabel: R.label,
              nodeLabel2: a[R.to].label
            }), C[F].projected.push({
              graphId: i.id,
              edge: R,
              preNode: O
            });
          }));
        });
        for (var A = d.length, T = function(D) {
          if (y)
            return "break";
          var G = d[D];
          h.forEach(function(R) {
            var F = new od(R), q = t.findForwardRmpathEdges(i, F.edges[G], v, F);
            q.length > 0 && (y = !0, S = o.dfsEdgeList[G].fromNode, q.forEach(function(ne) {
              var oe = "".concat(ne.label, "-").concat(a[ne.to].label);
              C[oe] || (C[oe] = {
                projected: [],
                edgeLabel: ne.label,
                nodeLabel2: a[ne.to].label
              }), C[oe].projected.push({
                graphId: i.id,
                edge: ne,
                preNode: R
              });
            }));
          });
        }, _ = 0; _ < A; _++) {
          var P = T(_);
          if (P === "break")
            break;
        }
        if (!y)
          return !0;
        var k = t.findMinLabel(C);
        o.dfsEdgeList.push(new Ks(S, p + 1, Pa, k.edgeLabel, k.nodeLabel2));
        var L = o.dfsEdgeList.length - 1;
        return e.dfsEdgeList[L] !== o.dfsEdgeList[L] ? !1 : c(C["".concat(k.edgeLabel, "-").concat(k.nodeLabel2)].projected);
      }, l = "".concat(u.nodeLabel1, "-").concat(u.edgeLabel, "-").concat(u.nodeLabel2);
      return f(s[l].projected);
    }
  }, r.prototype.report = function() {
    if (!(this.dfsCode.getNodeNum() < this.minNodeNum)) {
      this.counter++;
      var t = this.dfsCode.toGraph(this.counter, this.directed);
      this.frequentSubgraphs.push(vr(t));
    }
  }, r.prototype.subGraphMining = function(t) {
    var e = this, n = this.getSupport(t);
    if (!(n < this.minSupport) && !!this.isMin()) {
      this.report();
      var i = this.dfsCode.getNodeNum(), a = this.dfsCode.buildRmpath(), o = this.dfsCode.dfsEdgeList[a[0]].toNode, s = this.dfsCode.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1, u = {}, f = {};
      t.forEach(function(l) {
        for (var c = e.graphs[l.graphId], h = c.nodeMap, d = new od(l), v = a.length - 1; v >= 0; v--) {
          var p = e.findBackwardEdge(c, d.edges[a[v]], d.edges[a[0]], d);
          if (p) {
            var g = "".concat(e.dfsCode.dfsEdgeList[a[v]].fromNode, "-").concat(p.label);
            f[g] || (f[g] = {
              projected: [],
              toNodeId: e.dfsCode.dfsEdgeList[a[v]].fromNode,
              edgeLabel: p.label
            }), f[g].projected.push({
              graphId: l.graphId,
              edge: p,
              preNode: l
            });
          }
        }
        if (!(i >= e.maxNodeNum)) {
          var y = e.findForwardPureEdges(c, d.edges[a[0]], s, d);
          y.forEach(function(m) {
            var x = "".concat(o, "-").concat(m.label, "-").concat(h[m.to].label);
            u[x] || (u[x] = {
              projected: [],
              fromNodeId: o,
              edgeLabel: m.label,
              nodeLabel2: h[m.to].label
            }), u[x].projected.push({
              graphId: l.graphId,
              edge: m,
              preNode: l
            });
          });
          for (var b = function(x) {
            var _ = e.findForwardRmpathEdges(c, d.edges[a[x]], s, d);
            _.forEach(function(w) {
              var E = "".concat(e.dfsCode.dfsEdgeList[a[x]].fromNode, "-").concat(w.label, "-").concat(h[w.to].label);
              u[E] || (u[E] = {
                projected: [],
                fromNodeId: e.dfsCode.dfsEdgeList[a[x]].fromNode,
                edgeLabel: w.label,
                nodeLabel2: h[w.to].label
              }), u[E].projected.push({
                graphId: l.graphId,
                edge: w,
                preNode: l
              });
            });
          }, v = 0; v < a.length; v++)
            b(v);
        }
      }), Object.keys(f).forEach(function(l) {
        var c = f[l], h = c.toNodeId, d = c.edgeLabel;
        e.dfsCode.dfsEdgeList.push(new Ks(o, h, "-1", d, "-1")), e.subGraphMining(f[l].projected), e.dfsCode.dfsEdgeList.pop();
      }), Object.keys(u).forEach(function(l) {
        var c = u[l], h = c.fromNodeId, d = c.edgeLabel, v = c.nodeLabel2;
        e.dfsCode.dfsEdgeList.push(new Ks(h, o + 1, Pa, d, v)), e.subGraphMining(u[l].projected), e.dfsCode.dfsEdgeList.pop();
      });
    }
  }, r.prototype.generate1EdgeFrequentSubGraphs = function() {
    var t = this.graphs, e = this.directed, n = this.minSupport, i = this.frequentSize1Subgraphs, a = {}, o = {}, s = {};
    return Object.keys(t).forEach(function(u) {
      var f = t[u], l = f.nodeMap;
      f.nodes.forEach(function(c, h) {
        var d = c.label, v = "".concat(u, "-").concat(d);
        if (!s[v]) {
          var p = a[d] || 0;
          p++, a[d] = p;
        }
        s[v] = {
          graphKey: u,
          label: d
        }, c.edges.forEach(function(g) {
          var y = d, b = l[g.to].label;
          if (!e && y > b) {
            var m = b;
            b = y, y = m;
          }
          var x = g.label, _ = "".concat(y, "-").concat(x, "-").concat(b);
          if (!o[_]) {
            var w = o[_] || 0;
            w++, o[_] = w;
          }
        });
      });
    }), Object.keys(a).forEach(function(u) {
      var f = a[u];
      if (!(f < n)) {
        var l = {
          nodes: [],
          edges: []
        };
        l.nodes.push({
          id: "0",
          label: u
        }), i.push(l);
      }
    }), i;
  }, r.prototype.run = function() {
    var t = this;
    if (this.frequentSize1Subgraphs = this.generate1EdgeFrequentSubGraphs(), !(this.maxNodeNum < 2)) {
      var e = this.graphs;
      this.directed;
      var n = {};
      Object.keys(e).forEach(function(i) {
        var a = e[i], o = a.nodeMap;
        a.nodes.forEach(function(s) {
          var u = t.findForwardRootEdges(a, s);
          u.forEach(function(f) {
            var l = o[f.to], c = "".concat(s.label, "-").concat(f.label, "-").concat(l.label);
            n[c] || (n[c] = {
              projected: [],
              nodeLabel1: s.label,
              edgeLabel: f.label,
              nodeLabel2: l.label
            });
            var h = {
              graphId: i,
              edge: f,
              preNode: null
            };
            n[c].projected.push(h);
          });
        });
      }), Object.keys(n).forEach(function(i) {
        var a = n[i], o = a.projected, s = a.nodeLabel1, u = a.edgeLabel, f = a.nodeLabel2;
        t.dfsCode.dfsEdgeList.push(new Ks(0, 1, s, u, f)), t.subGraphMining(o), t.dfsCode.dfsEdgeList.pop();
      });
    }
  }, r;
}(), OW = function(t, e, n, i) {
  var a = {};
  return Object.keys(t).forEach(function(o, s) {
    var u = t[o], f = new vL(s, !0, e), l = {};
    u.nodes.forEach(function(c, h) {
      f.addNode(h, c[n]), l[c.id] = h;
    }), u.edges.forEach(function(c, h) {
      var d = l[c.source], v = l[c.target];
      f.addEdge(-1, d, v, c[i]);
    }), f && f.getNodeNum() && (a[f.id] = f);
  }), a;
}, DW = function(t, e, n) {
  var i = [];
  return t.forEach(function(a) {
    var o = {
      nodes: [],
      edges: []
    };
    a.nodes.forEach(function(s) {
      var u;
      o.nodes.push((u = {
        id: "".concat(s.id)
      }, u[e] = s.label, u));
    }), a.edges.forEach(function(s) {
      var u;
      o.edges.push((u = {
        source: "".concat(s.from),
        target: "".concat(s.to)
      }, u[n] = s.label, u));
    }), i.push(o);
  }), i;
}, lE = "cluster", kW = function(t) {
  var e = t.graphs, n = t.directed, i = n === void 0 ? !1 : n, a = t.nodeLabelProp, o = a === void 0 ? lE : a, s = t.edgeLabelProp, u = s === void 0 ? lE : s, f = OW(e, i, o, u), l = t.minSupport, c = t.maxNodeNum, h = t.minNodeNum, d = t.verbose, v = t.top, p = {
    graphs: f,
    minSupport: l,
    maxNodeNum: c,
    minNodeNum: h,
    top: v,
    verbose: d,
    directed: i
  }, g = new PW(p);
  g.run();
  var y = DW(g.frequentSubgraphs, o, u);
  return y;
}, cE = function(t, e, n, i) {
  n === void 0 && (n = "cluster"), i === void 0 && (i = 2);
  var a = [], o = t.nodes;
  return e.forEach(function(s, u) {
    a.push(pL(o, s, u, n, i));
  }), a;
}, pL = function(t, e, n, i, a) {
  var o = [n], s = [], u = {};
  return e.forEach(function(f, l) {
    if (f <= a && n !== l) {
      o.push(l), s.push(t[l]);
      var c = t[l][i];
      u[c] ? (u[c].count++, u[c].dists.push(f)) : u[c] = {
        count: 1,
        dists: [f]
      };
    }
  }), Object.keys(u).forEach(function(f) {
    u[f].dists = u[f].dists.sort(function(l, c) {
      return l - c;
    });
  }), {
    nodeIdx: n,
    nodeId: t[n].id,
    nodeIdxs: o,
    neighbors: s,
    neighborNum: o.length - 1,
    nodeLabelCountMap: u
  };
}, LW = function(t, e, n, i, a) {
  var o = Math.ceil(n / e), s = {}, u = 0;
  return i.forEach(function(f, l) {
    for (var c = 0, h = 0, d = f.nodeIdxs, v = f.neighborNum - 1; c < o; ) {
      for (var p = d[1 + Math.floor(Math.random() * v)], g = 0; (s["".concat(l, "-").concat(p)] || s["".concat(p, "-").concat(l)]) && (p = Math.floor(Math.random() * e), g++, !(g > 2 * e)); )
        ;
      if (g < 2 * e && (s["".concat(l, "-").concat(p)] = {
        start: l,
        end: p,
        distance: a[l][p]
      }, c++, u++, u >= n))
        return s;
      if (h++, h > 2 * e)
        break;
    }
    if (c < o) {
      var y = o - c;
      o = (o + y) / (e - l - 1);
    }
  }), s;
}, pv = function(t, e, n, i) {
  var a = n.nodes;
  return i || (i = {}), Object.keys(t).forEach(function(o) {
    var s, u;
    if (!(i && i[o])) {
      i[o] = {
        nodes: [],
        edges: []
      };
      var f = t[o], l = (s = e[f.start]) === null || s === void 0 ? void 0 : s.nodeIdxs, c = (u = e[f.end]) === null || u === void 0 ? void 0 : u.nodeIdxs;
      if (!(!l || !c)) {
        var h = new Set(c), d = l.filter(function(b) {
          return h.has(b);
        });
        if (!(!d || !d.length)) {
          for (var v = {}, p = d.length, g = 0; g < p; g++) {
            var y = a[d[g]];
            i[o].nodes.push(y), v[y.id] = !0;
          }
          n.edges.forEach(function(b) {
            v[b.source] && v[b.target] && i[o].edges.push(b);
          });
        }
      }
    }
  }), i;
}, gv = function(t, e, n, i) {
  var a, o, s = {};
  t.nodes.forEach(function(f) {
    s[f.id] = f;
  });
  var u = 0;
  return !(!((a = e == null ? void 0 : e.edges) === null || a === void 0) && a.length) || ((o = e == null ? void 0 : e.nodes) === null || o === void 0 ? void 0 : o.length) < 2 ? 0 : (t.edges.forEach(function(f) {
    var l = s[f.source][n], c = s[f.target][n], h = e == null ? void 0 : e.nodes[0][n], d = e == null ? void 0 : e.nodes[1][n], v = e == null ? void 0 : e.edges[0][i];
    f[i] === v && (l === h && c === d || l === d && c === h) && u++;
  }), u);
}, NW = function(t, e, n) {
  for (var i = 1 / 0, a = 0, o = function(f) {
    var l = t[f], c = Object.keys(l).sort(function(b, m) {
      return l[b] - l[m];
    }), h = 10, d = [];
    c.forEach(function(b, m) {
      d[m % h] || (d[m % h] = {
        graphs: [],
        totalCount: 0,
        aveCount: 0
      }), d[m % h].graphs.push(b), d[m % h].totalCount += l[b];
    });
    var v = 0, p = [];
    d.forEach(function(b) {
      var m = b.totalCount / b.graphs.length;
      b.aveCount = m, p.push(m);
      var x = 0, _ = b.length;
      b.graphs.forEach(function(w, E) {
        var M = l[w];
        b.graphs.forEach(function(C, S) {
          E !== S && (x += Math.abs(M - l[C]));
        });
      }), x /= _ * (_ - 1) / 2, v += x;
    }), v /= d.length;
    var g = 0;
    p.forEach(function(b, m) {
      p.forEach(function(x, _) {
        m !== _ && (g += Math.abs(b - x));
      }), g /= p.length * (p.length - 1) / 2;
    });
    var y = g - v;
    i < y && (i = y, a = f);
  }, s = 0; s < e; s++)
    o(s);
  return {
    structure: n[a],
    structureCountMap: t[a]
  };
}, hE = function(t, e) {
  var n = {}, i = {};
  return t.forEach(function(a, o) {
    n[a.id] = {
      idx: o,
      node: a,
      degree: 0,
      inDegree: 0,
      outDegree: 0
    };
    var s = a[e];
    i[s] || (i[s] = []), i[s].push(a);
  }), {
    nodeMap: n,
    nodeLabelMap: i
  };
}, dE = function(t, e, n) {
  var i = {}, a = {};
  return t.forEach(function(o, s) {
    i["".concat(Kk)] = {
      idx: s,
      edge: o
    };
    var u = o[e];
    a[u] || (a[u] = []), a[u].push(o);
    var f = n[o.source];
    f && (f.degree++, f.outDegree++);
    var l = n[o.target];
    l && (l.degree++, l.inDegree++);
  }), {
    edgeMap: i,
    edgeLabelMap: a
  };
}, vE = function(t, e, n) {
  var i = e.length, a = {};
  return e.forEach(function(o, s) {
    for (var u = n ? 0 : s + 1, f = t[s].id, l = u; l < i; l++)
      if (s !== l) {
        var c = t[l].id, h = o[l];
        a["".concat(f, "-").concat(c)] = h, n || (a["".concat(c, "-").concat(f)] = h);
      }
  }), a;
}, RW = function(t, e, n, i, a, o, s, u, f, l, c) {
  var h, d = "".concat(e.id, "-").concat(n.id);
  if (l && l[d])
    return l[d];
  var v = c ? c[d] : void 0;
  if (!v) {
    var p = (h = {}, h[d] = {
      start: i[e.id].idx,
      end: i[n.id].idx,
      distance: a
    }, h);
    c = pv(p, o, t, c), v = c[d];
  }
  return gv(v, s, u, f);
}, pE = function(t, e, n, i) {
  var a, o, s, u = (a = t[e]) === null || a === void 0 ? void 0 : a.degree, f = (o = t[e]) === null || o === void 0 ? void 0 : o.inDegree, l = (s = t[e]) === null || s === void 0 ? void 0 : s.outDegree;
  return t[e] === void 0 && (u = 1 / 0, f = 1 / 0, l = 1 / 0, i[e].forEach(function(c) {
    var h = n[c.id].degree;
    u > h && (u = h);
    var d = n[c.id].inDegree;
    f > d && (f = d);
    var v = n[c.id].outDegree;
    l > v && (l = v);
  }), t[e] = {
    degree: u,
    inDegree: f,
    outDegree: l
  }), {
    minPatternNodeLabelDegree: u,
    minPatternNodeLabelInDegree: f,
    minPatternNodeLabelOutDegree: l
  };
}, gL = function(t, e, n, i, a, o, s) {
  var u;
  if (n === void 0 && (n = !1), o === void 0 && (o = "cluster"), s === void 0 && (s = "cluster"), !(!t || !t.nodes)) {
    var f = t.nodes.length;
    if (!!f) {
      var l = Ic(t, n), c = Ic(e, n), h = vE(t.nodes, l, n), d = vE(e.nodes, c, n), v = hE(t.nodes, o), p = v.nodeMap, g = v.nodeLabelMap, y = hE(e.nodes, o), b = y.nodeMap, m = y.nodeLabelMap;
      dE(t.edges, s, p);
      var x = dE(e.edges, s, b).edgeLabelMap, _ = [];
      c == null || c.forEach(function(Ye) {
        _ = _.concat(Ye);
      }), a || (a = Math.max.apply(Math, Ga(Ga([], _, !1), [2], !1))), i || (i = a);
      var w = cE(t, l, o, i), E = cE(e, c, o, i), M = Math.min(100, f * (f - 1) / 2), C = LW(i, f, M, w, l), S = pv(C, w, t), A = 10, T = 1, P = 1, k = 4, L = {
        graphs: S,
        nodeLabelProp: o,
        edgeLabelProp: s,
        minSupport: T,
        minNodeNum: P,
        maxNodeNum: k,
        directed: n
      }, O = kW(L).slice(0, A), D = O.length, G = [];
      O.forEach(function(Ye, vt) {
        G[vt] = {}, Object.keys(S).forEach(function(N) {
          var Z = S[N], pe = gv(Z, Ye, o, s);
          G[vt][N] = pe;
        });
      });
      var R = NW(G, D, O), F = R.structure, q = R.structureCountMap, ne = e.nodes[0], oe = [], ie = (u = e.nodes[0]) === null || u === void 0 ? void 0 : u[o], Ee = -1 / 0;
      e.nodes.forEach(function(Ye) {
        var vt = Ye[o], N = g[vt];
        (N == null ? void 0 : N.length) > Ee && (Ee = N.length, oe = N, ie = vt, ne = Ye);
      });
      var Xe = {}, le = {}, Me = {}, $e = {}, et = {}, ft = {};
      Object.keys(m).forEach(function(Ye, vt) {
        et[Ye] = [], n && (ft[Ye] = []);
        var N = m[Ye], Z = {};
        N.forEach(function(at) {
          var je = d["".concat(ne.id, "-").concat(at.id)];
          if (je && et[Ye].push(je), Z["".concat(ne.id, "-").concat(at.id)] = {
            start: 0,
            end: b[at.id].idx,
            distance: je
          }, n) {
            var lt = d["".concat(at.id, "-").concat(ne.id)];
            lt && ft[Ye].push(lt);
          }
        }), et[Ye] = et[Ye].sort(function(at, je) {
          return at - je;
        }), n && (ft[Ye] = ft[Ye].sort(function(at, je) {
          return at - je;
        })), le = pv(Z, E, e, le);
        var pe = [];
        if (Object.keys(Z).forEach(function(at) {
          if (Me[at]) {
            pe.push(Me[at]);
            return;
          }
          var je = le[at];
          Me[at] = gv(je, F, o, s), pe.push(Me[at]);
        }), pe = pe.sort(function(at, je) {
          return je - at;
        }), $e["".concat(ne.id, "-").concat(Ye)] = pe, Ye !== ie)
          for (var se = (oe == null ? void 0 : oe.length) || 0, Ce = function(je) {
            var lt = oe[je], ct = w[p[lt.id].idx], Ot = ct.nodeLabelCountMap[Ye], mt = m[Ye].length;
            if (!Ot || Ot.count < mt)
              return oe.splice(je, 1), "continue";
            for (var pr = !1, _r = 0; _r < mt; _r++)
              if (Ot.dists[_r] > et[Ye][_r]) {
                pr = !0;
                break;
              }
            if (pr)
              return oe.splice(je, 1), "continue";
            var jr = {};
            ct.neighbors.forEach(function(hr) {
              var Vr = h["".concat(lt.id, "-").concat(hr.id)];
              jr["".concat(lt.id, "-").concat(hr.id)] = {
                start: p[lt.id].idx,
                end: p[hr.id].idx,
                distance: Vr
              };
            }), S = pv(jr, w, t, S);
            var Cr = [];
            Object.keys(jr).forEach(function(hr) {
              if (q[hr]) {
                Cr.push(q[hr]);
                return;
              }
              var Vr = S[hr];
              q[hr] = gv(Vr, F, o, s), Cr.push(q[hr]);
            }), Cr = Cr.sort(function(hr, Vr) {
              return Vr - hr;
            });
            for (var mn = !1, _r = 0; _r < mt; _r++)
              if (Cr[_r] < pe[_r]) {
                mn = !0;
                break;
              }
            if (mn)
              return oe.splice(je, 1), "continue";
          }, ke = se - 1; ke >= 0; ke--)
            Ce(ke);
      });
      var pt = [];
      oe == null || oe.forEach(function(Ye) {
        for (var vt = p[Ye.id].idx, N = pL(t.nodes, l[vt], vt, o, a), Z = N.neighbors, pe = Z.length, se = !1, Ce = pe - 1; Ce >= 0; Ce--) {
          if (Z.length + 1 < e.nodes.length) {
            se = !0;
            return;
          }
          var ke = Z[Ce], at = ke[o];
          if (!m[at] || !m[at].length) {
            Z.splice(Ce, 1);
            continue;
          }
          if (!et[at] || !et[at].length) {
            Z.splice(Ce, 1);
            continue;
          }
          var je = "".concat(Ye.id, "-").concat(ke.id), lt = h[je], ct = et[at].length - 1, Ot = et[at][ct];
          if (lt > Ot) {
            Z.splice(Ce, 1);
            continue;
          }
          if (n) {
            var mt = "".concat(ke.id, "-").concat(Ye.id), pr = h[mt];
            ct = ft[at].length - 1;
            var _r = ft[at][ct];
            if (pr > _r) {
              Z.splice(Ce, 1);
              continue;
            }
          }
          var jr = q[je] ? q[je] : RW(t, Ye, ke, p, lt, w, F, o, s, q, S), Cr = "".concat(ne.id, "-").concat(at), mn = $e[Cr][$e[Cr].length - 1];
          if (jr < mn) {
            Z.splice(Ce, 1);
            continue;
          }
          var hr = pE(Xe, at, b, m), Vr = hr.minPatternNodeLabelDegree;
          if (hr.minPatternNodeLabelInDegree, hr.minPatternNodeLabelOutDegree, p[ke.id].degree < Vr) {
            Z.splice(Ce, 1);
            continue;
          }
        }
        se || pt.push({
          nodes: [Ye].concat(Z)
        });
      });
      var $ = Ac(e, ne.id, !1).length, te = {};
      n ? (Object.keys($).forEach(function(Ye) {
        var vt = b[Ye].node[o];
        te[vt] ? te[vt].push($[Ye]) : te[vt] = [$[Ye]];
      }), Object.keys(te).forEach(function(Ye) {
        te[Ye].sort(function(vt, N) {
          return vt - N;
        });
      })) : te = et;
      for (var X = pt.length, De = function(vt) {
        var N = pt[vt], Z = N.nodes[0], pe = {}, se = {};
        N.nodes.forEach(function($t, Ar) {
          se[$t.id] = {
            idx: Ar,
            node: $t,
            degree: 0,
            inDegree: 0,
            outDegree: 0
          };
          var Lt = $t[o];
          pe[Lt] ? pe[Lt]++ : pe[Lt] = 1;
        });
        var Ce = [], ke = {};
        t.edges.forEach(function($t) {
          se[$t.source] && se[$t.target] && (Ce.push($t), ke[$t[s]] ? ke[$t[s]]++ : ke[$t[s]] = 1, se[$t.source].degree++, se[$t.target].degree++, se[$t.source].outDegree++, se[$t.target].inDegree++);
        });
        for (var at = Object.keys(x).length, je = !1, lt = 0; lt < at; lt++) {
          var ct = Object.keys(x)[lt];
          if (!ke[ct] || ke[ct] < x[ct].length) {
            je = !0;
            break;
          }
        }
        if (je)
          return pt.splice(vt, 1), "continue";
        var Ot = Ce.length;
        if (Ot < e.edges.length)
          return pt.splice(vt, 1), "break";
        for (var mt = !1, pr = function(Ar) {
          var Lt = Ce[Ar], Rr = Lt[s], bn = x[Rr];
          if (!bn || !bn.length)
            return ke[Rr]--, bn && ke[Rr] < bn.length ? (mt = !0, "break") : (Ce.splice(Ar, 1), se[Lt.source].degree--, se[Lt.target].degree--, se[Lt.source].outDegree--, se[Lt.target].inDegree--, "continue");
          var Ka = se[Lt.source].node[o], la = se[Lt.target].node[o], Xi = !1;
          if (bn.forEach(function(qa) {
            var Za = b[qa.source].node, Qa = b[qa.target].node;
            Za[o] === Ka && Qa[o] === la && (Xi = !0), !n && Za[o] === la && Qa[o] === Ka && (Xi = !0);
          }), !Xi)
            return ke[Rr]--, bn && ke[Rr] < bn.length ? (mt = !0, "break") : (Ce.splice(Ar, 1), se[Lt.source].degree--, se[Lt.target].degree--, se[Lt.source].outDegree--, se[Lt.target].inDegree--, "continue");
        }, lt = Ot - 1; lt >= 0; lt--) {
          var _r = pr(lt);
          if (_r === "break")
            break;
        }
        if (mt)
          return pt.splice(vt, 1), "continue";
        N.edges = Ce;
        var jr = Ac(N, N.nodes[0].id, !1).length;
        if (Object.keys(jr).reverse().forEach(function($t) {
          if (!($t === N.nodes[0].id || mt)) {
            if (jr[$t] === 1 / 0) {
              var Ar = se[$t].node[o];
              if (pe[Ar]--, pe[Ar] < m[Ar].length) {
                mt = !0;
                return;
              }
              var Lt = N.nodes.indexOf(se[$t].node);
              N.nodes.splice(Lt, 1), se[$t] = void 0;
              return;
            }
            var Rr = p[$t].node[o];
            if (!te[Rr] || !te[Rr].length || jr[$t] > te[Rr][te[Rr].length - 1]) {
              var Ar = se[$t].node[o];
              if (pe[Ar]--, pe[Ar] < m[Ar].length) {
                mt = !0;
                return;
              }
              var Lt = N.nodes.indexOf(se[$t].node);
              N.nodes.splice(Lt, 1), se[$t] = void 0;
            }
          }
        }), mt)
          return pt.splice(vt, 1), "continue";
        for (var Cr = !0, mn = 0; Cr && !mt; ) {
          Cr = !1;
          var hr = n ? se[Z.id].degree < b[ne.id].degree || se[Z.id].inDegree < b[ne.id].inDegree || se[Z.id].outDegree < b[ne.id].outDegree : se[Z.id].degree < b[ne.id].degree;
          if (hr) {
            mt = !0;
            break;
          }
          if (pe[Z[o]] < m[Z[o]].length) {
            mt = !0;
            break;
          }
          for (var Vr = N.nodes.length, di = Vr - 1; di >= 0; di--) {
            var Zr = N.nodes[di], fa = se[Zr.id].degree, Es = se[Zr.id].inDegree, Ss = se[Zr.id].outDegree, dn = Zr[o], Vi = pE(Xe, dn, b, m), Ha = Vi.minPatternNodeLabelDegree, Ms = Vi.minPatternNodeLabelInDegree, Cs = Vi.minPatternNodeLabelOutDegree, Ts = n ? fa < Ha || Es < Ms || Ss < Cs : fa < Ha;
            if (Ts) {
              if (pe[Zr[o]]--, pe[Zr[o]] < m[Zr[o]].length) {
                mt = !0;
                break;
              }
              N.nodes.splice(di, 1), se[Zr.id] = void 0, Cr = !0;
            }
          }
          if (mt || !Cr && mn !== 0)
            break;
          Ot = Ce.length;
          for (var vi = Ot - 1; vi >= 0; vi--) {
            var Xr = Ce[vi];
            if (!se[Xr.source] || !se[Xr.target]) {
              Ce.splice(vi, 1);
              var pi = Xr[s];
              if (ke[pi]--, se[Xr.source] && (se[Xr.source].degree--, se[Xr.source].outDegree--), se[Xr.target] && (se[Xr.target].degree--, se[Xr.target].inDegree--), x[pi] && ke[pi] < x[pi].length) {
                mt = !0;
                break;
              }
              Cr = !0;
            }
          }
          mn++;
        }
        if (mt || mt || N.nodes.length < e.nodes.length || Ce.length < e.edges.length)
          return pt.splice(vt, 1), "continue";
      }, Ke = X - 1; Ke >= 0; Ke--) {
        var Fe = De(Ke);
        if (Fe === "break")
          break;
      }
      for (var _t = pt.length, Kt = function(vt) {
        var N = pt[vt], Z = {};
        N.edges.forEach(function(Ce) {
          var ke = "".concat(Ce.source, "-").concat(Ce.target, "-").concat(Ce.label);
          Z[ke] ? Z[ke]++ : Z[ke] = 1;
        });
        for (var pe = function(ke) {
          var at = pt[ke], je = {};
          at.edges.forEach(function(ct) {
            var Ot = "".concat(ct.source, "-").concat(ct.target, "-").concat(ct.label);
            je[Ot] ? je[Ot]++ : je[Ot] = 1;
          });
          var lt = !0;
          Object.keys(je).length !== Object.keys(Z).length ? lt = !1 : Object.keys(Z).forEach(function(ct) {
            je[ct] !== Z[ct] && (lt = !1);
          }), lt && pt.splice(ke, 1);
        }, se = _t - 1; se > vt; se--)
          pe(se);
        _t = pt.length;
      }, Ke = 0; Ke <= _t - 1; Ke++)
        Kt(Ke);
      return pt;
    }
  }
}, Mf = function() {
  function r(t) {
    t === void 0 && (t = 10), this.linkedList = new Hk(), this.maxStep = t;
  }
  return Object.defineProperty(r.prototype, "length", {
    get: function() {
      return this.linkedList.toArray().length;
    },
    enumerable: !1,
    configurable: !0
  }), r.prototype.isEmpty = function() {
    return !this.linkedList.head;
  }, r.prototype.isMaxStack = function() {
    return this.toArray().length >= this.maxStep;
  }, r.prototype.peek = function() {
    return this.isEmpty() ? null : this.linkedList.head.value;
  }, r.prototype.push = function(t) {
    this.linkedList.prepend(t), this.length > this.maxStep && this.linkedList.deleteTail();
  }, r.prototype.pop = function() {
    var t = this.linkedList.deleteHead();
    return t ? t.value : null;
  }, r.prototype.toArray = function() {
    return this.linkedList.toArray().map(function(t) {
      return t.value;
    });
  }, r.prototype.clear = function() {
    for (; !this.isEmpty(); )
      this.pop();
  }, r;
}(), yL = fb;
const BW = {
  getAdjMatrix: pu,
  breadthFirstSearch: qk,
  connectedComponent: sb,
  getDegree: Mo,
  getInDegree: Qk,
  getOutDegree: Jk,
  detectCycle: fb,
  detectDirectedCycle: yL,
  detectAllCycles: tL,
  detectAllDirectedCycle: cb,
  detectAllUndirectedCycle: lb,
  depthFirstSearch: ub,
  dijkstra: Ac,
  findAllPath: iL,
  findShortestPath: nL,
  floydWarshall: Ic,
  labelPropagation: aL,
  louvain: vb,
  iLouvain: oL,
  kCore: sL,
  kMeans: uL,
  cosineSimilarity: pb,
  nodesCosineSimilarity: fL,
  minimumSpanningTree: lL,
  pageRank: cL,
  getNeighbors: _i,
  Stack: Mf,
  GADDI: gL
}, GW = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  getAdjMatrix: pu,
  breadthFirstSearch: qk,
  connectedComponent: sb,
  getDegree: Mo,
  getInDegree: Qk,
  getOutDegree: Jk,
  detectCycle: fb,
  detectDirectedCycle: yL,
  detectAllCycles: tL,
  detectAllDirectedCycle: cb,
  detectAllUndirectedCycle: lb,
  depthFirstSearch: ub,
  dijkstra: Ac,
  findAllPath: iL,
  findShortestPath: nL,
  floydWarshall: Ic,
  labelPropagation: aL,
  louvain: vb,
  iLouvain: oL,
  kCore: sL,
  kMeans: uL,
  cosineSimilarity: pb,
  nodesCosineSimilarity: fL,
  minimumSpanningTree: lL,
  pageRank: cL,
  getNeighbors: _i,
  Stack: Mf,
  GADDI: gL,
  default: BW
}, Symbol.toStringTag, { value: "Module" }));
var $v = $i, FW = function(t) {
  return function(e, n) {
    return e[t] - n[t];
  };
}, gE = function(t, e, n) {
  return t >= e && t <= n;
}, Lp = function(t, e, n, i) {
  var a = 1e-4, o = {
    x: n.x - t.x,
    y: n.y - t.y
  }, s = {
    x: e.x - t.x,
    y: e.y - t.y
  }, u = {
    x: i.x - n.x,
    y: i.y - n.y
  }, f = s.x * u.y - s.y * u.x, l = f * f, c = 1 / f, h = s.x * s.x + s.y * s.y, d = u.x * u.x + u.y * u.y;
  if (l > a * h * d) {
    var v = (o.x * u.y - o.y * u.x) * c, p = (o.x * s.y - o.y * s.x) * c;
    return !gE(v, 0, 1) || !gE(p, 0, 1) ? null : {
      x: t.x + v * s.x,
      y: t.y + v * s.y
    };
  }
  return null;
}, mL = function(t, e) {
  var n = t.x, i = t.y, a = t.width, o = t.height, s = n + a / 2, u = i + o / 2, f = [], l = {
    x: s,
    y: u
  };
  f.push({
    x: n,
    y: i
  }), f.push({
    x: n + a,
    y: i
  }), f.push({
    x: n + a,
    y: i + o
  }), f.push({
    x: n,
    y: i + o
  }), f.push({
    x: n,
    y: i
  });
  for (var c = null, h = 1; h < f.length && (c = Lp(f[h - 1], f[h], l, e), !c); h++)
    ;
  return c;
}, bL = function(t, e) {
  var n = t.x, i = t.y, a = t.r, o = e.x, s = e.y, u = o - n, f = s - i;
  if (u * u + f * f < a * a)
    return null;
  var l = Math.atan(f / u);
  return {
    x: n + Math.abs(a * Math.cos(l)) * Math.sign(u),
    y: i + Math.abs(a * Math.sin(l)) * Math.sign(f)
  };
}, xL = function(t, e) {
  var n = t.rx, i = t.ry, a = t.x, o = t.y, s = e.x - a, u = e.y - o, f = Math.atan2(u / i, s / n);
  return f < 0 && (f += 2 * Math.PI), {
    x: a + n * Math.cos(f),
    y: o + i * Math.sin(f)
  };
}, Wv = function(t, e, n) {
  n === void 0 && (n = 1);
  var i = [t.x, t.y, n];
  return (!e || isNaN(e[0])) && (e = [1, 0, 0, 0, 1, 0, 0, 0, 1]), Mu(i, i, e), {
    x: i[0],
    y: i[1]
  };
}, _L = function(t, e, n) {
  n === void 0 && (n = 1), (!e || isNaN(e[0])) && (e = [1, 0, 0, 0, 1, 0, 0, 0, 1]);
  var i = K1([1, 0, 0, 0, 1, 0, 0, 0, 1], e);
  i || (i = [1, 0, 0, 0, 1, 0, 0, 0, 1]);
  var a = [t.x, t.y, n];
  return Mu(a, a, i), {
    x: a[0],
    y: a[1]
  };
}, Qy = function(t, e, n) {
  var i = t.x - e.x, a = t.y - e.y, o = t.x - n.x, s = t.y - n.y, u = (t.x * t.x - e.x * e.x - e.y * e.y + t.y * t.y) / 2, f = (t.x * t.x - n.x * n.x - n.y * n.y + t.y * t.y) / 2, l = a * o - i * s;
  return {
    x: -(s * u - a * f) / l,
    y: -(i * f - o * u) / l
  };
}, Vv = function(t, e) {
  var n = t.x - e.x, i = t.y - e.y;
  return Math.sqrt(n * n + i * i);
}, zW = function(t, e) {
  var n = [];
  return t.forEach(function(i) {
    var a = [];
    i.forEach(function(o) {
      a.push(o * e);
    }), n.push(a);
  }), n;
}, UW = function(t) {
  for (var e = [], n = t.length, i = 0; i < n; i += 1) {
    e[i] = [];
    for (var a = 0; a < n; a += 1)
      i === a ? e[i][a] = 0 : t[i][a] === 0 || !t[i][a] ? e[i][a] = 1 / 0 : e[i][a] = t[i][a];
  }
  for (var o = 0; o < n; o += 1)
    for (var i = 0; i < n; i += 1)
      for (var a = 0; a < n; a += 1)
        e[i][a] > e[i][o] + e[o][a] && (e[i][a] = e[i][o] + e[o][a]);
  return e;
}, jW = function(t, e) {
  var n = t.nodes, i = t.edges, a = [], o = {};
  if (!n)
    throw new Error("invalid nodes data!");
  return n && n.forEach(function(s, u) {
    o[s.id] = u;
    var f = [];
    a.push(f);
  }), i && i.forEach(function(s) {
    var u = s.source, f = s.target, l = o[u], c = o[f];
    a[l][c] = 1, e || (a[c][l] = 1);
  }), a;
}, wL = function(t, e) {
  t.translate(e.x, e.y);
}, Jy = function(t, e, n, i) {
  i === void 0 && (i = {
    duration: 500
  });
  var a = t.getMatrix();
  a || (a = [1, 0, 0, 0, 1, 0, 0, 0, 1]);
  var o = t.getCanvasBBox(), s = e.x - o.minX, u = e.y - o.minY;
  if (n) {
    var f = s * a[0], l = u * a[4], c = 0, h = 0, d = 0, v = 0;
    t.animate(function(g) {
      return d = f * g, v = l * g, a = $v(a, [["t", d - c, v - h]]), c = d, h = v, {
        matrix: a
      };
    }, i);
  } else {
    var p = $v(a, [["t", s, u]]);
    t.setMatrix(p);
  }
}, $W = function(t, e) {
  var n = t.getMatrix();
  n || (n = [1, 0, 0, 0, 1, 0, 0, 0, 1]);
  var i = e;
  Dt(e) || (i = [e, e]), Dt(e) && e.length === 1 && (i = [e[0], e[0]]), n = $v(n, [["s", i[0], i[1]]]), t.setMatrix(n);
}, WW = function(t, e) {
  var n = t.getMatrix();
  n || (n = [1, 0, 0, 0, 1, 0, 0, 0, 1]), n = $v(n, [["r", e]]), t.setMatrix(n);
}, VW = function(t, e, n) {
  for (var i = [], a = 0; a < t; a++)
    i[a] = 0;
  return n.forEach(function(o) {
    o.source && (i[e[o.source]] += 1), o.target && (i[e[o.target]] += 1);
  }), i;
};
function XW(r, t, e) {
  return (e[0] - r[0]) * (t[1] - r[1]) === (t[0] - r[0]) * (e[1] - r[1]) && Math.min(r[0], t[0]) <= e[0] && e[0] <= Math.max(r[0], t[0]) && Math.min(r[1], t[1]) <= e[1] && e[1] <= Math.max(r[1], t[1]);
}
var Pc = function(t, e, n) {
  var i = !1, a = t.length, o = 1e-6;
  function s(c) {
    return Math.abs(c) < o ? 0 : c < 0 ? -1 : 1;
  }
  if (a <= 2)
    return !1;
  for (var u = 0; u < a; u++) {
    var f = t[u], l = t[(u + 1) % a];
    if (XW(f, l, [e, n]))
      return !0;
    s(f[1] - n) > 0 != s(l[1] - n) > 0 && s(e - (n - f[1]) * (f[0] - l[0]) / (f[1] - l[1]) - f[0]) < 0 && (i = !i);
  }
  return i;
}, EL = function(t, e) {
  return !(e.minX > t.maxX || e.maxX < t.minX || e.minY > t.maxY || e.maxY < t.minY);
}, YW = function(t, e) {
  var n = !1;
  return Se(t, function(i) {
    if (Lp(i.from, i.to, e.from, e.to))
      return n = !0, !1;
  }), n;
}, SL = function(t, e) {
  var n = function(h) {
    var d = h.map(function(p) {
      return p[0];
    }), v = h.map(function(p) {
      return p[1];
    });
    return {
      minX: Math.min.apply(null, d),
      maxX: Math.max.apply(null, d),
      minY: Math.min.apply(null, v),
      maxY: Math.max.apply(null, v)
    };
  }, i = function(h) {
    for (var d = [], v = h.length, p = 0; p < v - 1; p++) {
      var g = h[p], y = h[p + 1];
      d.push({
        from: {
          x: g[0],
          y: g[1]
        },
        to: {
          x: y[0],
          y: y[1]
        }
      });
    }
    if (d.length > 1) {
      var b = h[0], m = h[v - 1];
      d.push({
        from: {
          x: m[0],
          y: m[1]
        },
        to: {
          x: b[0],
          y: b[1]
        }
      });
    }
    return d;
  };
  if (t.length < 2 || e.length < 2)
    return !1;
  var a = n(t), o = n(e);
  if (!EL(a, o))
    return !1;
  var s = !1;
  if (Se(e, function(c) {
    if (Pc(t, c[0], c[1]))
      return s = !0, !1;
  }), s || (Se(t, function(c) {
    if (Pc(e, c[0], c[1]))
      return s = !0, !1;
  }), s))
    return !0;
  var u = i(t), f = i(e), l = !1;
  return Se(f, function(c) {
    if (YW(u, c))
      return l = !0, !1;
  }), l;
}, gu = function() {
  function r(t, e, n, i) {
    this.x1 = t, this.y1 = e, this.x2 = n, this.y2 = i;
  }
  return r.prototype.getBBox = function() {
    var t = Math.min(this.x1, this.x2), e = Math.min(this.y1, this.y2), n = Math.max(this.x1, this.x2), i = Math.max(this.y1, this.y2), a = {
      x: t,
      y: e,
      minX: t,
      minY: e,
      maxX: n,
      maxY: i,
      width: n - t,
      height: i - e
    };
    return a;
  }, r;
}(), gb = function(t, e) {
  var n = {
    top: [t.minX, t.minY, t.maxX, t.minY],
    left: [t.minX, t.minY, t.minX, t.maxY],
    bottom: [t.minX, t.maxY, t.maxX, t.maxY],
    right: [t.maxX, t.minY, t.maxX, t.maxY]
  };
  return n[e];
}, HW = function(t, e) {
  var n = (e.x2 - e.x1) * (t.y1 - e.y1) - (e.y2 - e.y1) * (t.x1 - e.x1), i = (t.x2 - t.x1) * (t.y1 - e.y1) - (t.y2 - t.y1) * (t.x1 - e.x1), a = (e.y2 - e.y1) * (t.x2 - t.x1) - (e.x2 - e.x1) * (t.y2 - t.y1);
  if (a) {
    var o = n / a, s = i / a;
    if (o >= 0 && o <= 1 && s >= 0 && s <= 1)
      return o;
  }
  return Number.POSITIVE_INFINITY;
}, ML = function(t, e) {
  for (var n = ["top", "left", "bottom", "right"], i = t.getBBox(), a = 0, o = [], s = 0; s < 4; s++) {
    var u = gb(i, n[s]), f = u[0], l = u[1], c = u[2], h = u[3];
    o[s] = Lp({
      x: e.x1,
      y: e.y1
    }, {
      x: e.x2,
      y: e.y2
    }, {
      x: f,
      y: l
    }, {
      x: c,
      y: h
    }), o[s] && (a += 1);
  }
  return [o, a];
}, yb = function(t, e) {
  for (var n = ["top", "left", "bottom", "right"], i = t.getBBox(), a = Number.POSITIVE_INFINITY, o = 0, s = 0; s < 4; s++) {
    var u = gb(i, n[s]), f = u[0], l = u[1], c = u[2], h = u[3], d = HW(e, new gu(f, l, c, h));
    d = Math.abs(d - 0.5), d >= 0 && d <= 1 && (o += 1, a = d < a ? d : a);
  }
  return o === 0 ? -1 : a;
}, CL = function(t) {
  var e = 0, n = 0;
  if (t.length > 0) {
    for (var i = 0, a = t; i < a.length; i++) {
      var o = a[i];
      e += o.x, n += o.y;
    }
    e /= t.length, n /= t.length;
  }
  return {
    x: e,
    y: n
  };
}, Xv = function(t, e) {
  return Math.pow(t.x - e.x, 2) + Math.pow(t.y - e.y, 2);
}, TL = function(t, e) {
  var n = e.x1, i = e.y1, a = e.x2 - n, o = e.y2 - i, s = t.x - n, u = t.y - i, f = s * a + u * o, l;
  f <= 0 ? l = 0 : (s = a - s, u = o - u, f = s * a + u * o, f <= 0 ? l = 0 : l = f * f / (a * a + o * o));
  var c = s * s + u * u - l;
  return c < 0 && (c = 0), c;
}, em = function(t, e, n) {
  return n === void 0 && (n = 1e-3), Math.pow(t.x - e.x, 2) + Math.pow(t.y - e.y, 2) < Math.pow(n, 2);
}, AL = function(t, e) {
  var n = t.x < e.x, i = t.x > e.x + e.width, a = t.y > e.y + e.height, o = t.y < e.y, s = n || i || a || o;
  if (!s)
    return 0;
  if (a && !n && !i)
    return Math.pow(e.y + e.height - t.y, 2);
  if (o && !n && !i)
    return Math.pow(t.y - e.y, 2);
  if (n && !a && !o)
    return Math.pow(e.x - t.x, 2);
  if (i && !a && !o)
    return Math.pow(e.x + e.width - t.x, 2);
  var u = Math.min(Math.abs(e.x - t.x), Math.abs(e.x + e.width - t.x)), f = Math.min(Math.abs(e.y - t.y), Math.abs(e.y + e.height - t.y));
  return u * u + f * f;
}, KW = function(t, e) {
  var n = t[0], i = t[1], a = t[2], o = t[3], s = e.x, u = e.y, f = [a - n, o - i];
  if (ob(f, [0, 0]))
    return NaN;
  var l = [-f[1], f[0]];
  us(l, l);
  var c = [s - n, u - i];
  return Math.abs(ab(c, l));
}, mb = function(t, e, n) {
  return t + (e - t) * n;
}, tm = function(t, e, n) {
  for (var i = Math.min(t.length, e.length), a = new Array(i), o = 0; o < i; o++)
    a[o] = mb(t[o], e[o], n);
  return a;
};
const qW = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  compare: FW,
  getLineIntersect: Lp,
  getRectIntersectByPoint: mL,
  getCircleIntersectByPoint: bL,
  getEllipseIntersectByPoint: xL,
  applyMatrix: Wv,
  invertMatrix: _L,
  getCircleCenterByPoints: Qy,
  distance: Vv,
  scaleMatrix: zW,
  floydWarshall: UW,
  getAdjMatrix: jW,
  translate: wL,
  move: Jy,
  scale: $W,
  rotate: WW,
  getDegree: VW,
  isPointInPolygon: Pc,
  intersectBBox: EL,
  isPolygonsIntersect: SL,
  Line: gu,
  getBBoxBoundLine: gb,
  itemIntersectByLine: ML,
  fractionToLine: yb,
  getPointsCenter: CL,
  squareDist: Xv,
  pointLineSquareDist: TL,
  isPointsOverlap: em,
  pointRectSquareDist: AL,
  pointLineDistance: KW,
  lerp: mb,
  lerpArray: tm
}, Symbol.toStringTag, { value: "Module" }));
var Uo = "rgb(95, 149, 255)", ZW = "rgb(255, 255, 255)", yE = "rgb(0, 0, 0)", I0 = "rgb(247, 250, 255)", IL = "rgb(239, 244, 255)", sd = "rgb(253, 253, 253)", mE = "rgb(250, 250, 250)", ud = "rgb(224, 224, 224)", bE = "rgb(234, 234, 234)", QW = "rgb(245, 245, 245)", JW = "rgb(191, 213, 255)", xE = "#4572d9", e9 = "rgb(223, 234, 255)", mr = {
  mainStroke: Uo,
  mainFill: IL,
  activeStroke: Uo,
  activeFill: I0,
  inactiveStroke: JW,
  inactiveFill: I0,
  selectedStroke: Uo,
  selectedFill: ZW,
  highlightStroke: xE,
  highlightFill: e9,
  disableStroke: ud,
  disableFill: mE,
  edgeMainStroke: ud,
  edgeActiveStroke: Uo,
  edgeInactiveStroke: bE,
  edgeSelectedStroke: Uo,
  edgeHighlightStroke: Uo,
  edgeDisableStroke: QW,
  comboMainStroke: ud,
  comboMainFill: sd,
  comboActiveStroke: Uo,
  comboActiveFill: I0,
  comboInactiveStroke: ud,
  comboInactiveFill: sd,
  comboSelectedStroke: Uo,
  comboSelectedFill: sd,
  comboHighlightStroke: xE,
  comboHighlightFill: sd,
  comboDisableStroke: bE,
  comboDisableFill: mE
};
const Et = {
  version: "0.7.10",
  rootContainerClassName: "root-container",
  nodeContainerClassName: "node-container",
  edgeContainerClassName: "edge-container",
  comboContainerClassName: "combo-container",
  delegateContainerClassName: "delegate-container",
  defaultLoopPosition: "top",
  nodeLabel: {
    style: {
      fill: "#000",
      fontSize: 12,
      textAlign: "center",
      textBaseline: "middle"
    },
    offset: 4
  },
  defaultNode: {
    type: "circle",
    style: {
      lineWidth: 1,
      stroke: mr.mainStroke,
      fill: IL
    },
    size: 20,
    color: mr.mainStroke,
    linkPoints: {
      size: 8,
      lineWidth: 1,
      fill: mr.activeFill,
      stroke: mr.activeStroke
    }
  },
  nodeStateStyles: {
    active: {
      fill: mr.activeFill,
      stroke: mr.activeStroke,
      lineWidth: 2,
      shadowColor: mr.mainStroke,
      shadowBlur: 10
    },
    selected: {
      fill: mr.selectedFill,
      stroke: mr.selectedStroke,
      lineWidth: 4,
      shadowColor: mr.selectedStroke,
      shadowBlur: 10,
      "text-shape": {
        fontWeight: 500
      }
    },
    highlight: {
      fill: mr.highlightFill,
      stroke: mr.highlightStroke,
      lineWidth: 2,
      "text-shape": {
        fontWeight: 500
      }
    },
    inactive: {
      fill: mr.inactiveFill,
      stroke: mr.inactiveStroke,
      lineWidth: 1
    },
    disable: {
      fill: mr.disableFill,
      stroke: mr.disableStroke,
      lineWidth: 1
    }
  },
  edgeLabel: {
    style: {
      fill: yE,
      textAlign: "center",
      textBaseline: "middle",
      fontSize: 12
    }
  },
  defaultEdge: {
    type: "line",
    size: 1,
    style: {
      stroke: mr.edgeMainStroke,
      lineAppendWidth: 2
    },
    color: mr.edgeMainStroke
  },
  edgeStateStyles: {
    active: {
      stroke: mr.edgeActiveStroke,
      lineWidth: 1
    },
    selected: {
      stroke: mr.edgeSelectedStroke,
      lineWidth: 2,
      shadowColor: mr.edgeSelectedStroke,
      shadowBlur: 10,
      "text-shape": {
        fontWeight: 500
      }
    },
    highlight: {
      stroke: mr.edgeHighlightStroke,
      lineWidth: 2,
      "text-shape": {
        fontWeight: 500
      }
    },
    inactive: {
      stroke: mr.edgeInactiveStroke,
      lineWidth: 1
    },
    disable: {
      stroke: mr.edgeDisableStroke,
      lineWidth: 1
    }
  },
  comboLabel: {
    style: {
      fill: yE,
      textBaseline: "middle",
      fontSize: 12
    },
    refY: 10,
    refX: 10
  },
  defaultCombo: {
    type: "circle",
    style: {
      fill: mr.comboMainFill,
      lineWidth: 1,
      stroke: mr.comboMainStroke,
      r: 5,
      width: 20,
      height: 10
    },
    size: [20, 5],
    color: mr.comboMainStroke,
    padding: [25, 20, 15, 20]
  },
  comboStateStyles: {
    active: {
      stroke: mr.comboActiveStroke,
      lineWidth: 1,
      fill: mr.comboActiveFill
    },
    selected: {
      stroke: mr.comboSelectedStroke,
      lineWidth: 2,
      fill: mr.comboSelectedFill,
      shadowColor: mr.comboSelectedStroke,
      shadowBlur: 10,
      "text-shape": {
        fontWeight: 500
      }
    },
    highlight: {
      stroke: mr.comboHighlightStroke,
      lineWidth: 2,
      fill: mr.comboHighlightFill,
      "text-shape": {
        fontWeight: 500
      }
    },
    inactive: {
      stroke: mr.comboInactiveStroke,
      fill: mr.comboInactiveFill,
      lineWidth: 1
    },
    disable: {
      stroke: mr.comboDisableStroke,
      fill: mr.comboDisableFill,
      lineWidth: 1
    }
  },
  delegateStyle: {
    fill: "#F3F9FF",
    fillOpacity: 0.5,
    stroke: "#1890FF",
    strokeOpacity: 0.9,
    lineDash: [5, 5]
  },
  windowFontFamily: typeof window < "u" && window.getComputedStyle && document.body && window.getComputedStyle(document.body, null).getPropertyValue("font-family") || "Arial, sans-serif"
}, t9 = {
  " ": 0.3329986572265625,
  a: 0.5589996337890625,
  A: 0.6569992065429687,
  b: 0.58599853515625,
  B: 0.6769989013671875,
  c: 0.5469985961914062,
  C: 0.7279998779296875,
  d: 0.58599853515625,
  D: 0.705999755859375,
  e: 0.554998779296875,
  E: 0.63699951171875,
  f: 0.37299957275390627,
  F: 0.5769989013671875,
  g: 0.5909988403320312,
  G: 0.7479995727539063,
  h: 0.555999755859375,
  H: 0.7199996948242188,
  i: 0.255999755859375,
  I: 0.23699951171875,
  j: 0.26699981689453123,
  J: 0.5169998168945312,
  k: 0.5289993286132812,
  K: 0.6899993896484375,
  l: 0.23499908447265624,
  L: 0.5879989624023437,
  m: 0.854998779296875,
  M: 0.8819992065429687,
  n: 0.5589996337890625,
  N: 0.7189987182617188,
  o: 0.58599853515625,
  O: 0.7669998168945312,
  p: 0.58599853515625,
  P: 0.6419998168945312,
  q: 0.58599853515625,
  Q: 0.7669998168945312,
  r: 0.3649993896484375,
  R: 0.6759994506835938,
  s: 0.504998779296875,
  S: 0.6319992065429687,
  t: 0.354998779296875,
  T: 0.6189987182617187,
  u: 0.5599990844726562,
  U: 0.7139999389648437,
  v: 0.48199920654296874,
  V: 0.6389999389648438,
  w: 0.754998779296875,
  W: 0.929998779296875,
  x: 0.5089996337890625,
  X: 0.63699951171875,
  y: 0.4959991455078125,
  Y: 0.66199951171875,
  z: 0.48699951171875,
  Z: 0.6239990234375,
  0: 0.6,
  1: 0.40099945068359377,
  2: 0.6,
  3: 0.6,
  4: 0.6,
  5: 0.6,
  6: 0.6,
  7: 0.5469985961914062,
  8: 0.6,
  9: 0.6,
  "[": 0.3329986572265625,
  "]": 0.3329986572265625,
  ",": 0.26399993896484375,
  ".": 0.26399993896484375,
  ";": 0.26399993896484375,
  ":": 0.26399993896484375,
  "{": 0.3329986572265625,
  "}": 0.3329986572265625,
  "\\": 0.5,
  "|": 0.19499969482421875,
  "=": 0.604998779296875,
  "+": 0.604998779296875,
  "-": 0.604998779296875,
  _: 0.5,
  "`": 0.3329986572265625,
  " ~": 0.8329986572265625,
  "!": 0.3329986572265625,
  "@": 0.8579986572265625,
  "#": 0.6,
  $: 0.6,
  "%": 0.9699996948242188,
  "^": 0.517999267578125,
  "&": 0.7259994506835937,
  "*": 0.505999755859375,
  "(": 0.3329986572265625,
  ")": 0.3329986572265625,
  "<": 0.604998779296875,
  ">": 0.604998779296875,
  "/": 0.5,
  "?": 0.53699951171875
};
var _a = Math.PI, rm = Math.sin, nm = Math.cos, Pn = rm(_a / 8), On = nm(_a / 8), Yv = function(t, e) {
  var n = t.getBBox(), i = {
    x: n.minX,
    y: n.minY
  }, a = {
    x: n.maxX,
    y: n.maxY
  };
  if (e) {
    var o = e.getMatrix();
    o || (o = [1, 0, 0, 0, 1, 0, 0, 0, 1]), i = Wv(i, o), a = Wv(a, o);
  }
  var s = i.x, u = i.y, f = a.x, l = a.y;
  return {
    x: s,
    y: u,
    minX: s,
    minY: u,
    maxX: f,
    maxY: l,
    width: f - s,
    height: l - u
  };
}, PL = function(t) {
  var e = t.sourceNode || t.targetNode, n = e.get("group"), i = n.getMatrix();
  i || (i = [1, 0, 0, 0, 1, 0, 0, 0, 1]);
  var a = e.getKeyShape(), o = a.getBBox(), s = t.loopCfg || {}, u = s.dist || Math.max(o.width, o.height) * 2, f = s.position || Et.defaultLoopPosition, l = [i[6], i[7]], c = [t.startPoint.x, t.startPoint.y], h = [t.endPoint.x, t.endPoint.y], d = o.height / 2, v = o.width / 2, p = d, g = d, y = p * Pn, b = p * On, m = g * Pn, x = g * On, _ = a.get("type"), w = Math.min(d / 2, v / 2), E = Math.min(d, v), M = s != null && s.pointPadding ? Math.min(E, s == null ? void 0 : s.pointPadding) : w;
  if (c[0] === h[0] && c[1] === h[1]) {
    switch (f) {
      case "top":
        _ === "circle" ? (c = [l[0] - y, l[1] - b], h = [l[0] + m, l[1] - x]) : (c = [l[0] - M, l[1] - d], h = [l[0] + M, l[1] - d]);
        break;
      case "top-right":
        p = d, g = v, _ === "circle" ? (y = p * Pn, b = p * On, m = g * Pn, x = g * On, c = [l[0] + y, l[1] - b], h = [l[0] + x, l[1] - m]) : (c = [l[0] + v - M, l[1] - d], h = [l[0] + v, l[1] - d + M]);
        break;
      case "right":
        p = v, g = v, _ === "circle" ? (y = p * Pn, b = p * On, m = g * Pn, x = g * On, c = [l[0] + b, l[1] - y], h = [l[0] + x, l[1] + m]) : (c = [l[0] + v, l[1] - M], h = [l[0] + v, l[1] + M]);
        break;
      case "bottom-right":
        p = v, g = d, _ === "circle" ? (y = p * Pn, b = p * On, m = g * Pn, x = g * On, c = [l[0] + b, l[1] + y], h = [l[0] + m, l[1] + x]) : (c = [l[0] + v, l[1] + d - M], h = [l[0] + v - M, l[1] + d]);
        break;
      case "bottom":
        p = d, g = d, _ === "circle" ? (y = p * Pn, b = p * On, m = g * Pn, x = g * On, c = [l[0] + y, l[1] + b], h = [l[0] - m, l[1] + x]) : (c = [l[0] - M, l[1] + d], h = [l[0] + M, l[1] + d]);
        break;
      case "bottom-left":
        p = d, g = v, _ === "circle" ? (y = p * Pn, b = p * On, m = g * Pn, x = g * On, c = [l[0] - y, l[1] + b], h = [l[0] - x, l[1] + m]) : (c = [l[0] - v, l[1] + d - M], h = [l[0] - v + M, l[1] + d]);
        break;
      case "left":
        p = v, g = v, _ === "circle" ? (y = p * Pn, b = p * On, m = g * Pn, x = g * On, c = [l[0] - b, l[1] + y], h = [l[0] - x, l[1] - m]) : (c = [l[0] - v, l[1] - M], h = [l[0] - v, l[1] + M]);
        break;
      case "top-left":
        p = v, g = d, _ === "circle" ? (y = p * Pn, b = p * On, m = g * Pn, x = g * On, c = [l[0] - b, l[1] - y], h = [l[0] - m, l[1] - x]) : (c = [l[0] - v + M, l[1] - d], h = [l[0] - v, l[1] - d + M]);
        break;
      default:
        p = v, g = v, y = p * Pn, b = p * On, m = g * Pn, x = g * On, c = [l[0] - y, l[1] - b], h = [l[0] + m, l[1] - x];
    }
    if (s.clockwise === !1) {
      var C = [c[0], c[1]];
      c = [h[0], h[1]], h = [C[0], C[1]];
    }
  }
  var S = [c[0] - l[0], c[1] - l[1]], A = (p + u) / p, T = (g + u) / g;
  s.clockwise === !1 && (A = (g + u) / g, T = (p + u) / p);
  var P = Vn([0, 0], S, A), k = [l[0] + P[0], l[1] + P[1]], L = [h[0] - l[0], h[1] - l[1]], O = Vn([0, 0], L, T), D = [l[0] + O[0], l[1] + O[1]];
  return t.startPoint = {
    x: c[0],
    y: c[1]
  }, t.endPoint = {
    x: h[0],
    y: h[1]
  }, t.controlPoints = [{
    x: k[0],
    y: k[1]
  }, {
    x: D[0],
    y: D[1]
  }], t;
}, OL = function(t, e, n, i, a) {
  var o = 1e-4, s = [], u = t == null ? void 0 : t.getPoint(e);
  if (!u)
    return {
      x: 0,
      y: 0,
      angle: 0
    };
  if (e < o)
    s = t.getStartTangent().reverse();
  else if (e > 1 - o)
    s = t.getEndTangent();
  else {
    var f = t == null ? void 0 : t.getPoint(e + o);
    s.push([u.x, u.y]), s.push([f.x, f.y]);
  }
  var l = Math.atan2(s[1][1] - s[0][1], s[1][0] - s[0][0]);
  if (l < 0 && (l += _a * 2), n && (u.x += nm(l) * n, u.y += rm(l) * n), i) {
    var c = l - _a / 2;
    l > 1 / 2 * _a && l < 3 * 1 / 2 * _a && (c -= _a), u.x += nm(c) * i, u.y += rm(c) * i;
  }
  var h = {
    x: u.x,
    y: u.y,
    angle: l
  };
  return a ? (l > 0.5 * _a && l < 1.5 * _a && (l -= _a), U({
    rotate: l
  }, h)) : h;
}, DL = function r(t, e) {
  if (e(t) === !1)
    return !1;
  if (t && t.children) {
    for (var n = t.children.length - 1; n >= 0; n--)
      if (!r(t.children[n], e))
        return !1;
  }
  return !0;
}, r9 = function r(t, e) {
  if (t && t.children) {
    for (var n = t.children.length - 1; n >= 0; n--)
      if (!r(t.children[n], e))
        return;
  }
  return e(t) !== !1;
}, oi = function(t, e) {
  typeof e == "function" && DL(t, e);
}, wa = function(t, e) {
  typeof e == "function" && r9(t, e);
}, kL = function(t, e) {
  return e * (t9[t] || 1);
}, LL = function(t, e) {
  var n = 0, i = new RegExp("[\u4E00-\u9FA5]+");
  return t.split("").forEach(function(a) {
    i.test(a) ? n += e : n += kL(a, e);
  }), [n, e];
}, NL = function(t, e) {
  return typeof e != "number" || e <= 0 || e >= t.length ? t : t.substring(0, e) + "...";
}, im = function(t, e) {
  var n = [], i = {}, a = {};
  t.forEach(function(u) {
    a[u.id] = u;
  }), t.forEach(function(u, f) {
    var l = vr(u);
    l.itemType = "combo", l.children = void 0, l.parentId === l.id ? (console.warn("The parentId for combo ".concat(l.id, " can not be the same as the combo's id")), delete l.parentId) : l.parentId && !a[l.parentId] && (console.warn("The parent combo for combo ".concat(l.id, " does not exist!")), delete l.parentId);
    var c = i[l.id];
    if (c) {
      if (l.children = c.children, i[l.id] = l, c = l, !c.parentId) {
        n.push(c);
        return;
      }
      var h = i[c.parentId];
      if (h)
        h.children ? h.children.push(l) : h.children = [l];
      else {
        var d = {
          id: c.parentId,
          children: [c]
        };
        i[c.parentId] = d, i[l.id] = l;
      }
      return;
    }
    if (Qe(u.parentId)) {
      var v = i[u.parentId];
      if (v)
        v.children ? v.children.push(l) : v.children = [l], i[l.id] = l;
      else {
        var p = {
          id: u.parentId,
          children: [l]
        };
        i[p.id] = p, i[l.id] = l;
      }
    } else
      n.push(l), i[l.id] = l;
  });
  var o = {};
  (e || []).forEach(function(u) {
    o[u.id] = u;
    var f = i[u.comboId];
    if (f) {
      var l = {
        id: u.id,
        comboId: u.comboId
      };
      f.children ? f.children.push(l) : f.children = [l], l.itemType = "node", i[u.id] = l;
    }
  });
  var s = 0;
  return n.forEach(function(u) {
    u.depth = s + 10, DL(u, function(f) {
      var l, c = i[f.id].itemType;
      c === "node" ? l = i[f.comboId] : l = i[f.parentId], l && c === "node" ? f.depth = s + 1 : f.depth = s + 10, s < f.depth && (s = f.depth);
      var h = o[f.id];
      return h && (h.depth = f.depth), !0;
    });
  }), n;
}, am = function(t, e, n) {
  var i, a = t, o, s = {
    root: {
      children: t
    }
  }, u = !1, f = "root";
  (t || []).forEach(function(v) {
    if (!u) {
      if (v.id === e) {
        o = v, v.itemType === "combo" ? o.parentId = n : o.comboId = n, u = !0;
        return;
      }
      oi(v, function(p) {
        var g;
        return s[p.id] = {
          children: (p == null ? void 0 : p.children) || []
        }, a = (g = s[p.parentId || p.comboId || "root"]) === null || g === void 0 ? void 0 : g.children, p && (p.removed || e === p.id) && a ? (f = p.parentId || p.comboId || "root", o = p, p.itemType === "combo" ? o.parentId = n : o.comboId = n, u = !0, !1) : !0;
      });
    }
  }), a = (i = s[f]) === null || i === void 0 ? void 0 : i.children;
  var l = a ? a.indexOf(o) : -1;
  if (l > -1 && a.splice(l, 1), u || (o = {
    id: e,
    itemType: "node",
    comboId: n
  }, s[e] = {
    children: void 0
  }), e) {
    var c = !1;
    if (n) {
      var h = 0;
      (t || []).forEach(function(v) {
        c || oi(v, function(p) {
          return n === p.id ? (c = !0, p.children ? p.children.push(o) : p.children = [o], h = p.depth, o.itemType === "node" ? o.depth = h + 2 : o.depth = h + 1, !1) : !0;
        });
      });
    } else
      (!n || !c) && o.itemType !== "node" && t.push(o);
    var d = o.depth;
    oi(o, function(v) {
      return v.itemType === "node" ? d += 2 : d += 1, v.depth = d, !0;
    });
  }
  return t;
}, yv = function(t, e, n) {
  var i = {
    minX: 1 / 0,
    minY: 1 / 0,
    maxX: -1 / 0,
    maxY: -1 / 0,
    x: void 0,
    y: void 0,
    width: void 0,
    height: void 0,
    centerX: void 0,
    centerY: void 0
  };
  if (!t || t.length === 0) {
    var a = n == null ? void 0 : n.getModel(), o = a || {}, s = o.x, u = o.y;
    return {
      minX: s,
      minY: u,
      maxX: s,
      maxY: u,
      x: s,
      y: u,
      width: void 0,
      height: void 0
    };
  }
  return t.forEach(function(f) {
    var l = e.findById(f.id);
    if (!(!l || !l.isVisible())) {
      l.set("bboxCanvasCache", void 0);
      var c = l.getCanvasBBox();
      c.x && i.minX > c.minX && (i.minX = c.minX), c.y && i.minY > c.minY && (i.minY = c.minY), c.x && i.maxX < c.maxX && (i.maxX = c.maxX), c.y && i.maxY < c.maxY && (i.maxY = c.maxY);
    }
  }), i.x = (i.minX + i.maxX) / 2, i.y = (i.minY + i.maxY) / 2, i.width = i.maxX - i.minX, i.height = i.maxY - i.minY, i.centerX = (i.minX + i.maxX) / 2, i.centerY = (i.minY + i.maxY) / 2, Object.keys(i).forEach(function(f) {
    (i[f] === 1 / 0 || i[f] === -1 / 0) && (i[f] = void 0);
  }), i;
}, n9 = function(t) {
  var e = At(t.x) || At(t.y) || t.type || t.anchorPoints || t.size;
  return t.style && (e = e || At(t.style.r) || At(t.style.width) || At(t.style.height) || At(t.style.rx) || At(t.style.ry)), e;
}, mv = function(t) {
  var e = {};
  return Object.keys(t).forEach(function(n) {
    var i = t[n];
    if (Xn(i) && !Dt(i)) {
      var a = {};
      Object.keys(i).forEach(function(o) {
        var s = i[o];
        o === "img" && !Qe(s) || (a[o] = vr(s));
      }), e[n] = a;
    } else
      e[n] = vr(i);
  }), e;
}, Oc = function(t) {
  var e = t.animateCfg, n = t.callback, i;
  if (!e)
    i = {
      duration: 500,
      callback: n
    };
  else if (i = vr(e), e.callback) {
    var a = e.callback;
    i.callback = function() {
      n(), a();
    };
  } else
    i.callback = n;
  return i;
};
const i9 = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  getBBox: Yv,
  getLoopCfgs: PL,
  getLabelPosition: OL,
  traverseTree: oi,
  traverseTreeUp: wa,
  getLetterWidth: kL,
  getTextSize: LL,
  truncateLabelByLength: NL,
  plainCombosToTrees: im,
  reconstructTree: am,
  getComboBBox: yv,
  shouldRefreshEdge: n9,
  cloneBesidesImg: mv,
  getAnimateCfgWithCallback: Oc
}, Symbol.toStringTag, { value: "Module" }));
var _E = function(t) {
  if (!t)
    return console.error("G6 Error Tips: the data must be defined"), !1;
  var e = t.nodes, n = t.edges, i = t.combos, a = i === void 0 ? [] : i;
  if (!e && !n) {
    var o = !0;
    return oi(t, function(h) {
      return Qe(h.id) ? !0 : (o = !1, !1);
    }), o;
  }
  var s = (e || []).find(function(h) {
    return !Qe(h.id);
  });
  if (s)
    return console.warn("G6 Warning Tips: missing 'id' property, or %c".concat(s.id, "%c is not a string."), "font-size: 20px; color: red;", ""), !1;
  var u = (e || []).map(function(h) {
    return h.id;
  }), f = a == null ? void 0 : a.map(function(h) {
    return h.id;
  }), l = Ga(Ga([], u, !0), f, !0), c = (n || []).find(function(h) {
    return !l.includes(h.source) || !l.includes(h.target);
  });
  return c ? (console.warn("G6 Warning Tips: The source %c".concat(c.source, "%c or the target %c").concat(c.target, "%c of the edge do not exist in the nodes or combos."), "font-size: 20px; color: red;", "", "font-size: 20px; color: red;", ""), !1) : !0;
}, a9 = function(t, e) {
  if (t === "node" || t === "combo") {
    if (e.id && !Qe(e.id))
      return console.warn("G6 Warning Tips: missing 'id' property, or the 'id' %c".concat(e.id, "%c is not a string."), "font-size: 20px; color: red;", ""), !1;
  } else if (t === "edge" && (!e.source || !e.target))
    return console.warn("G6 Warning Tips: missing 'source' or 'target' for the edge."), !1;
  return !0;
}, o9 = function() {
  function r(t) {
    this.graph = t, this.destroyed = !1, this.modes = t.get("modes") || {
      default: []
    }, this.formatModes(), this.mode = t.get("defaultMode") || "default", this.currentBehaves = [], this.setMode(this.mode);
  }
  return r.prototype.formatModes = function() {
    var t = this.modes;
    Se(t, function(e) {
      Se(e, function(n, i) {
        Qe(n) && (e[i] = {
          type: n
        });
      });
    });
  }, r.prototype.setBehaviors = function(t) {
    var e = this.graph, n = this.modes[t], i = [], a;
    Se(n || [], function(o) {
      var s = H1.getBehavior(o.type || o);
      !s || (a = new s(o), a && (a.bind(e), i.push(a)));
    }), this.currentBehaves = i;
  }, r.mergeBehaviors = function(t, e) {
    return Se(e, function(n) {
      t.indexOf(n) < 0 && (Qe(n) && (n = {
        type: n
      }), t.push(n));
    }), t;
  }, r.filterBehaviors = function(t, e) {
    var n = [];
    return t.forEach(function(i) {
      var a = "";
      Qe(i) ? a = i : a = i.type, e.indexOf(a) < 0 && n.push(i);
    }), n;
  }, r.prototype.setMode = function(t) {
    var e = this, n = e.modes, i = e.graph, a = t, o = n[a];
    !o || (i.emit("beforemodechange", {
      mode: t
    }), Se(this.currentBehaves, function(s) {
      s.delegate && s.delegate.remove(), s.unbind(i);
    }), this.setBehaviors(a), i.emit("aftermodechange", {
      mode: t
    }), this.mode = t);
  }, r.prototype.getMode = function() {
    return this.mode;
  }, r.prototype.manipulateBehaviors = function(t, e, n) {
    var i = this, a;
    if (Dt(t) ? a = t : a = [t], Dt(e))
      return Se(e, function(s) {
        i.modes[s] ? n ? i.modes[s] = r.mergeBehaviors(i.modes[s] || [], a) : i.modes[s] = r.filterBehaviors(i.modes[s] || [], a) : n && (i.modes[s] = a);
      }), this;
    var o = e;
    return e || (o = this.mode), this.modes[o] || n && (this.modes[o] = a), n ? this.modes[o] = r.mergeBehaviors(this.modes[o] || [], a) : this.modes[o] = r.filterBehaviors(this.modes[o] || [], a), this.formatModes(), this.setMode(this.mode), this;
  }, r.prototype.updateBehavior = function(t, e, n) {
    Qe(t) && (t = {
      type: t
    });
    var i = [];
    if (!n || n === this.mode || n === "default") {
      if (i = this.currentBehaves, !i || !i.length)
        return console.warn("Update behavior failed! There is no behaviors in this mode on the graph."), this;
      for (var a = i.length, o = 0; o < a; o++) {
        var s = i[o];
        if (s.type === t.type)
          return s.updateCfg(e), this;
        o === a - 1 && console.warn("Update behavior failed! There is no such behavior in the mode");
      }
    } else {
      if (i = this.modes[n], !i || !i.length)
        return console.warn("Update behavior failed! There is no behaviors in this mode on the graph."), this;
      for (var u = i.length, o = 0; o < u; o++) {
        var s = i[o];
        if (s.type === t.type || s === t.type)
          return s === t.type && (s = {
            type: s
          }), Object.assign(s, e), i[o] = s, this;
        o === u - 1 && console.warn("Update behavior failed! There is no such behavior in the mode");
      }
    }
    return this;
  }, r.prototype.destroy = function() {
    this.graph = null, this.modes = null, this.currentBehaves = null, this.destroyed = !0;
  }, r;
}(), dc = `	
\v\f\r \xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029`, s9 = new RegExp("([a-z])[" + dc + ",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?[" + dc + "]*,?[" + dc + "]*)+)", "ig"), u9 = new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)[" + dc + "]*,?[" + dc + "]*", "ig"), Cf = function(r) {
  if (!r)
    return null;
  if (Dt(r))
    return r;
  var t = {
    a: 7,
    c: 6,
    o: 2,
    h: 1,
    l: 2,
    m: 2,
    r: 4,
    q: 4,
    s: 4,
    t: 2,
    v: 1,
    u: 3,
    z: 0
  }, e = [];
  return String(r).replace(s9, function(n, i, a) {
    var o = [], s = i.toLowerCase();
    if (a.replace(u9, function(u, f) {
      f && o.push(+f);
    }), s === "m" && o.length > 2 && (e.push([i].concat(o.splice(0, 2))), s = "l", i = i === "m" ? "l" : "L"), s === "o" && o.length === 1 && e.push([i, o[0]]), s === "r")
      e.push([i].concat(o));
    else
      for (; o.length >= t[s] && (e.push([i].concat(o.splice(0, t[s]))), !!t[s]); )
        ;
    return r;
  }), e;
}, om = function(r, t) {
  for (var e = [], n = 0, i = r.length; i - 2 * !t > n; n += 2) {
    var a = [
      {
        x: +r[n - 2],
        y: +r[n - 1]
      },
      {
        x: +r[n],
        y: +r[n + 1]
      },
      {
        x: +r[n + 2],
        y: +r[n + 3]
      },
      {
        x: +r[n + 4],
        y: +r[n + 5]
      }
    ];
    t ? n ? i - 4 === n ? a[3] = {
      x: +r[0],
      y: +r[1]
    } : i - 2 === n && (a[2] = {
      x: +r[0],
      y: +r[1]
    }, a[3] = {
      x: +r[2],
      y: +r[3]
    }) : a[0] = {
      x: +r[i - 2],
      y: +r[i - 1]
    } : i - 4 === n ? a[3] = a[2] : n || (a[0] = {
      x: +r[n],
      y: +r[n + 1]
    }), e.push([
      "C",
      (-a[0].x + 6 * a[1].x + a[2].x) / 6,
      (-a[0].y + 6 * a[1].y + a[2].y) / 6,
      (a[1].x + 6 * a[2].x - a[3].x) / 6,
      (a[1].y + 6 * a[2].y - a[3].y) / 6,
      a[2].x,
      a[2].y
    ]);
  }
  return e;
}, fd = function(r, t, e, n, i) {
  var a = [];
  if (i === null && n === null && (n = e), r = +r, t = +t, e = +e, n = +n, i !== null) {
    var o = Math.PI / 180, s = r + e * Math.cos(-n * o), u = r + e * Math.cos(-i * o), f = t + e * Math.sin(-n * o), l = t + e * Math.sin(-i * o);
    a = [
      ["M", s, f],
      ["A", e, e, 0, +(i - n > 180), 0, u, l]
    ];
  } else
    a = [["M", r, t], ["m", 0, -n], ["a", e, n, 0, 1, 1, 0, 2 * n], ["a", e, n, 0, 1, 1, 0, -2 * n], ["z"]];
  return a;
}, sm = function(r) {
  if (r = Cf(r), !r || !r.length)
    return [["M", 0, 0]];
  var t = [], e = 0, n = 0, i = 0, a = 0, o = 0, s, u;
  r[0][0] === "M" && (e = +r[0][1], n = +r[0][2], i = e, a = n, o++, t[0] = ["M", e, n]);
  for (var f = r.length === 3 && r[0][0] === "M" && r[1][0].toUpperCase() === "R" && r[2][0].toUpperCase() === "Z", l = void 0, c = void 0, h = o, d = r.length; h < d; h++) {
    if (t.push(l = []), c = r[h], s = c[0], s !== s.toUpperCase())
      switch (l[0] = s.toUpperCase(), l[0]) {
        case "A":
          l[1] = c[1], l[2] = c[2], l[3] = c[3], l[4] = c[4], l[5] = c[5], l[6] = +c[6] + e, l[7] = +c[7] + n;
          break;
        case "V":
          l[1] = +c[1] + n;
          break;
        case "H":
          l[1] = +c[1] + e;
          break;
        case "R":
          u = [e, n].concat(c.slice(1));
          for (var v = 2, p = u.length; v < p; v++)
            u[v] = +u[v] + e, u[++v] = +u[v] + n;
          t.pop(), t = t.concat(om(u, f));
          break;
        case "O":
          t.pop(), u = fd(e, n, c[1], c[2]), u.push(u[0]), t = t.concat(u);
          break;
        case "U":
          t.pop(), t = t.concat(fd(e, n, c[1], c[2], c[3])), l = ["U"].concat(t[t.length - 1].slice(-2));
          break;
        case "M":
          i = +c[1] + e, a = +c[2] + n;
          break;
        default:
          for (var v = 1, p = c.length; v < p; v++)
            l[v] = +c[v] + (v % 2 ? e : n);
      }
    else if (s === "R")
      u = [e, n].concat(c.slice(1)), t.pop(), t = t.concat(om(u, f)), l = ["R"].concat(c.slice(-2));
    else if (s === "O")
      t.pop(), u = fd(e, n, c[1], c[2]), u.push(u[0]), t = t.concat(u);
    else if (s === "U")
      t.pop(), t = t.concat(fd(e, n, c[1], c[2], c[3])), l = ["U"].concat(t[t.length - 1].slice(-2));
    else
      for (var g = 0, y = c.length; g < y; g++)
        l[g] = c[g];
    if (s = s.toUpperCase(), s !== "O")
      switch (l[0]) {
        case "Z":
          e = +i, n = +a;
          break;
        case "H":
          e = l[1];
          break;
        case "V":
          n = l[1];
          break;
        case "M":
          i = l[l.length - 2], a = l[l.length - 1];
          break;
        default:
          e = l[l.length - 2], n = l[l.length - 1];
      }
  }
  return t;
}, ld = function(r, t, e, n) {
  return [r, t, e, n, e, n];
}, wE = function(r, t, e, n, i, a) {
  var o = 0.3333333333333333, s = 2 / 3;
  return [o * r + s * e, o * t + s * n, o * i + s * e, o * a + s * n, i, a];
}, RL = function(r, t, e, n, i, a, o, s, u, f) {
  e === n && (e += 1);
  var l = Math.PI * 120 / 180, c = Math.PI / 180 * (+i || 0), h = [], d, v, p, g, y, b = function(le, Me, $e) {
    var et = le * Math.cos($e) - Me * Math.sin($e), ft = le * Math.sin($e) + Me * Math.cos($e);
    return {
      x: et,
      y: ft
    };
  };
  if (f)
    v = f[0], p = f[1], g = f[2], y = f[3];
  else {
    d = b(r, t, -c), r = d.x, t = d.y, d = b(s, u, -c), s = d.x, u = d.y, r === s && t === u && (s += 1, u += 1);
    var m = (r - s) / 2, x = (t - u) / 2, _ = m * m / (e * e) + x * x / (n * n);
    _ > 1 && (_ = Math.sqrt(_), e = _ * e, n = _ * n);
    var w = e * e, E = n * n, M = (a === o ? -1 : 1) * Math.sqrt(Math.abs((w * E - w * x * x - E * m * m) / (w * x * x + E * m * m)));
    g = M * e * x / n + (r + s) / 2, y = M * -n * m / e + (t + u) / 2, v = Math.asin(((t - y) / n).toFixed(9)), p = Math.asin(((u - y) / n).toFixed(9)), v = r < g ? Math.PI - v : v, p = s < g ? Math.PI - p : p, v < 0 && (v = Math.PI * 2 + v), p < 0 && (p = Math.PI * 2 + p), o && v > p && (v = v - Math.PI * 2), !o && p > v && (p = p - Math.PI * 2);
  }
  var C = p - v;
  if (Math.abs(C) > l) {
    var S = p, A = s, T = u;
    p = v + l * (o && p > v ? 1 : -1), s = g + e * Math.cos(p), u = y + n * Math.sin(p), h = RL(s, u, e, n, i, 0, o, A, T, [p, S, g, y]);
  }
  C = p - v;
  var P = Math.cos(v), k = Math.sin(v), L = Math.cos(p), O = Math.sin(p), D = Math.tan(C / 4), G = 4 / 3 * e * D, R = 4 / 3 * n * D, F = [r, t], q = [r + G * k, t - R * P], ne = [s + G * O, u - R * L], oe = [s, u];
  if (q[0] = 2 * F[0] - q[0], q[1] = 2 * F[1] - q[1], f)
    return [q, ne, oe].concat(h);
  h = [q, ne, oe].concat(h).join().split(",");
  for (var ie = [], Ee = 0, Xe = h.length; Ee < Xe; Ee++)
    ie[Ee] = Ee % 2 ? b(h[Ee - 1], h[Ee], c).y : b(h[Ee], h[Ee + 1], c).x;
  return ie;
}, um = function(r, t) {
  var e = sm(r), n = t && sm(t), i = {
    x: 0,
    y: 0,
    bx: 0,
    by: 0,
    X: 0,
    Y: 0,
    qx: null,
    qy: null
  }, a = {
    x: 0,
    y: 0,
    bx: 0,
    by: 0,
    X: 0,
    Y: 0,
    qx: null,
    qy: null
  }, o = [], s = [], u = "", f = "", l, c = function(m, x, _) {
    var w, E;
    if (!m)
      return ["C", x.x, x.y, x.x, x.y, x.x, x.y];
    switch (!(m[0] in {
      T: 1,
      Q: 1
    }) && (x.qx = x.qy = null), m[0]) {
      case "M":
        x.X = m[1], x.Y = m[2];
        break;
      case "A":
        m = ["C"].concat(RL.apply(0, [x.x, x.y].concat(m.slice(1))));
        break;
      case "S":
        _ === "C" || _ === "S" ? (w = x.x * 2 - x.bx, E = x.y * 2 - x.by) : (w = x.x, E = x.y), m = ["C", w, E].concat(m.slice(1));
        break;
      case "T":
        _ === "Q" || _ === "T" ? (x.qx = x.x * 2 - x.qx, x.qy = x.y * 2 - x.qy) : (x.qx = x.x, x.qy = x.y), m = ["C"].concat(wE(x.x, x.y, x.qx, x.qy, m[1], m[2]));
        break;
      case "Q":
        x.qx = m[1], x.qy = m[2], m = ["C"].concat(wE(x.x, x.y, m[1], m[2], m[3], m[4]));
        break;
      case "L":
        m = ["C"].concat(ld(x.x, x.y, m[1], m[2]));
        break;
      case "H":
        m = ["C"].concat(ld(x.x, x.y, m[1], x.y));
        break;
      case "V":
        m = ["C"].concat(ld(x.x, x.y, x.x, m[1]));
        break;
      case "Z":
        m = ["C"].concat(ld(x.x, x.y, x.X, x.Y));
        break;
    }
    return m;
  }, h = function(m, x) {
    if (m[x].length > 7) {
      m[x].shift();
      for (var _ = m[x]; _.length; )
        o[x] = "A", n && (s[x] = "A"), m.splice(x++, 0, ["C"].concat(_.splice(0, 6)));
      m.splice(x, 1), l = Math.max(e.length, n && n.length || 0);
    }
  }, d = function(m, x, _, w, E) {
    m && x && m[E][0] === "M" && x[E][0] !== "M" && (x.splice(E, 0, ["M", w.x, w.y]), _.bx = 0, _.by = 0, _.x = m[E][1], _.y = m[E][2], l = Math.max(e.length, n && n.length || 0));
  };
  l = Math.max(e.length, n && n.length || 0);
  for (var v = 0; v < l; v++) {
    e[v] && (u = e[v][0]), u !== "C" && (o[v] = u, v && (f = o[v - 1])), e[v] = c(e[v], i, f), o[v] !== "A" && u === "C" && (o[v] = "C"), h(e, v), n && (n[v] && (u = n[v][0]), u !== "C" && (s[v] = u, v && (f = s[v - 1])), n[v] = c(n[v], a, f), s[v] !== "A" && u === "C" && (s[v] = "C"), h(n, v)), d(e, n, i, a, v), d(n, e, a, i, v);
    var p = e[v], g = n && n[v], y = p.length, b = n && g.length;
    i.x = p[y - 2], i.y = p[y - 1], i.bx = parseFloat(p[y - 4]) || i.x, i.by = parseFloat(p[y - 3]) || i.y, a.bx = n && (parseFloat(g[b - 4]) || a.x), a.by = n && (parseFloat(g[b - 3]) || a.y), a.x = n && g[b - 2], a.y = n && g[b - 1];
  }
  return n ? [e, n] : e;
}, f9 = /,?([a-z]),?/gi, BL = function(r) {
  return r.join(",").replace(f9, "$1");
}, EE = function(r, t, e, n, i) {
  var a = -3 * t + 9 * e - 9 * n + 3 * i, o = r * a + 6 * t - 12 * e + 6 * n;
  return r * o - 3 * t + 3 * e;
}, SE = function(r, t, e, n, i, a, o, s, u) {
  u === null && (u = 1), u = u > 1 ? 1 : u < 0 ? 0 : u;
  for (var f = u / 2, l = 12, c = [
    -0.1252,
    0.1252,
    -0.3678,
    0.3678,
    -0.5873,
    0.5873,
    -0.7699,
    0.7699,
    -0.9041,
    0.9041,
    -0.9816,
    0.9816
  ], h = [0.2491, 0.2491, 0.2335, 0.2335, 0.2032, 0.2032, 0.1601, 0.1601, 0.1069, 0.1069, 0.0472, 0.0472], d = 0, v = 0; v < l; v++) {
    var p = f * c[v] + f, g = EE(p, r, e, i, o), y = EE(p, t, n, a, s), b = g * g + y * y;
    d += h[v] * Math.sqrt(b);
  }
  return f * d;
}, l9 = function(r, t, e, n, i, a, o, s) {
  for (var u = [], f = [[], []], l, c, h, d, v = 0; v < 2; ++v) {
    if (v === 0 ? (c = 6 * r - 12 * e + 6 * i, l = -3 * r + 9 * e - 9 * i + 3 * o, h = 3 * e - 3 * r) : (c = 6 * t - 12 * n + 6 * a, l = -3 * t + 9 * n - 9 * a + 3 * s, h = 3 * n - 3 * t), Math.abs(l) < 1e-12) {
      if (Math.abs(c) < 1e-12)
        continue;
      d = -h / c, d > 0 && d < 1 && u.push(d);
      continue;
    }
    var p = c * c - 4 * h * l, g = Math.sqrt(p);
    if (!(p < 0)) {
      var y = (-c + g) / (2 * l);
      y > 0 && y < 1 && u.push(y);
      var b = (-c - g) / (2 * l);
      b > 0 && b < 1 && u.push(b);
    }
  }
  for (var m = u.length, x = m, _; m--; )
    d = u[m], _ = 1 - d, f[0][m] = _ * _ * _ * r + 3 * _ * _ * d * e + 3 * _ * d * d * i + d * d * d * o, f[1][m] = _ * _ * _ * t + 3 * _ * _ * d * n + 3 * _ * d * d * a + d * d * d * s;
  return f[0][x] = r, f[1][x] = t, f[0][x + 1] = o, f[1][x + 1] = s, f[0].length = f[1].length = x + 2, {
    min: {
      x: Math.min.apply(0, f[0]),
      y: Math.min.apply(0, f[1])
    },
    max: {
      x: Math.max.apply(0, f[0]),
      y: Math.max.apply(0, f[1])
    }
  };
}, c9 = function(r, t, e, n, i, a, o, s) {
  if (!(Math.max(r, e) < Math.min(i, o) || Math.min(r, e) > Math.max(i, o) || Math.max(t, n) < Math.min(a, s) || Math.min(t, n) > Math.max(a, s))) {
    var u = (r * n - t * e) * (i - o) - (r - e) * (i * s - a * o), f = (r * n - t * e) * (a - s) - (t - n) * (i * s - a * o), l = (r - e) * (a - s) - (t - n) * (i - o);
    if (!!l) {
      var c = u / l, h = f / l, d = +c.toFixed(2), v = +h.toFixed(2);
      if (!(d < +Math.min(r, e).toFixed(2) || d > +Math.max(r, e).toFixed(2) || d < +Math.min(i, o).toFixed(2) || d > +Math.max(i, o).toFixed(2) || v < +Math.min(t, n).toFixed(2) || v > +Math.max(t, n).toFixed(2) || v < +Math.min(a, s).toFixed(2) || v > +Math.max(a, s).toFixed(2)))
        return {
          x: c,
          y: h
        };
    }
  }
}, jo = function(r, t, e) {
  return t >= r.x && t <= r.x + r.width && e >= r.y && e <= r.y + r.height;
}, GL = function(r, t, e, n, i) {
  if (i)
    return [
      ["M", +r + +i, t],
      ["l", e - i * 2, 0],
      ["a", i, i, 0, 0, 1, i, i],
      ["l", 0, n - i * 2],
      ["a", i, i, 0, 0, 1, -i, i],
      ["l", i * 2 - e, 0],
      ["a", i, i, 0, 0, 1, -i, -i],
      ["l", 0, i * 2 - n],
      ["a", i, i, 0, 0, 1, i, -i],
      ["z"]
    ];
  var a = [["M", r, t], ["l", e, 0], ["l", 0, n], ["l", -e, 0], ["z"]];
  return a.parsePathArray = BL, a;
}, fm = function(r, t, e, n) {
  return r === null && (r = t = e = n = 0), t === null && (t = r.y, e = r.width, n = r.height, r = r.x), {
    x: r,
    y: t,
    width: e,
    w: e,
    height: n,
    h: n,
    x2: r + e,
    y2: t + n,
    cx: r + e / 2,
    cy: t + n / 2,
    r1: Math.min(e, n) / 2,
    r2: Math.max(e, n) / 2,
    r0: Math.sqrt(e * e + n * n) / 2,
    path: GL(r, t, e, n),
    vb: [r, t, e, n].join(" ")
  };
}, h9 = function(r, t) {
  return r = fm(r), t = fm(t), jo(t, r.x, r.y) || jo(t, r.x2, r.y) || jo(t, r.x, r.y2) || jo(t, r.x2, r.y2) || jo(r, t.x, t.y) || jo(r, t.x2, t.y) || jo(r, t.x, t.y2) || jo(r, t.x2, t.y2) || (r.x < t.x2 && r.x > t.x || t.x < r.x2 && t.x > r.x) && (r.y < t.y2 && r.y > t.y || t.y < r.y2 && t.y > r.y);
}, ME = function(r, t, e, n, i, a, o, s) {
  Dt(r) || (r = [r, t, e, n, i, a, o, s]);
  var u = l9.apply(null, r);
  return fm(u.min.x, u.min.y, u.max.x - u.min.x, u.max.y - u.min.y);
}, CE = function(r, t, e, n, i, a, o, s, u) {
  var f = 1 - u, l = Math.pow(f, 3), c = Math.pow(f, 2), h = u * u, d = h * u, v = l * r + c * 3 * u * e + f * 3 * u * u * i + d * o, p = l * t + c * 3 * u * n + f * 3 * u * u * a + d * s, g = r + 2 * u * (e - r) + h * (i - 2 * e + r), y = t + 2 * u * (n - t) + h * (a - 2 * n + t), b = e + 2 * u * (i - e) + h * (o - 2 * i + e), m = n + 2 * u * (a - n) + h * (s - 2 * a + n), x = f * r + u * e, _ = f * t + u * n, w = f * i + u * o, E = f * a + u * s, M = 90 - Math.atan2(g - b, y - m) * 180 / Math.PI;
  return {
    x: v,
    y: p,
    m: {
      x: g,
      y
    },
    n: {
      x: b,
      y: m
    },
    start: {
      x,
      y: _
    },
    end: {
      x: w,
      y: E
    },
    alpha: M
  };
}, d9 = function(r, t, e) {
  var n = ME(r), i = ME(t);
  if (!h9(n, i))
    return e ? 0 : [];
  for (var a = SE.apply(0, r), o = SE.apply(0, t), s = ~~(a / 8), u = ~~(o / 8), f = [], l = [], c = {}, h = e ? 0 : [], d = 0; d < s + 1; d++) {
    var v = CE.apply(0, r.concat(d / s));
    f.push({
      x: v.x,
      y: v.y,
      t: d / s
    });
  }
  for (var d = 0; d < u + 1; d++) {
    var v = CE.apply(0, t.concat(d / u));
    l.push({
      x: v.x,
      y: v.y,
      t: d / u
    });
  }
  for (var d = 0; d < s; d++)
    for (var p = 0; p < u; p++) {
      var g = f[d], y = f[d + 1], b = l[p], m = l[p + 1], x = Math.abs(y.x - g.x) < 1e-3 ? "y" : "x", _ = Math.abs(m.x - b.x) < 1e-3 ? "y" : "x", w = c9(g.x, g.y, y.x, y.y, b.x, b.y, m.x, m.y);
      if (w) {
        if (c[w.x.toFixed(4)] === w.y.toFixed(4))
          continue;
        c[w.x.toFixed(4)] = w.y.toFixed(4);
        var E = g.t + Math.abs((w[x] - g[x]) / (y[x] - g[x])) * (y.t - g.t), M = b.t + Math.abs((w[_] - b[_]) / (m[_] - b[_])) * (m.t - b.t);
        E >= 0 && E <= 1 && M >= 0 && M <= 1 && (e ? h += 1 : h.push({
          x: w.x,
          y: w.y,
          t1: E,
          t2: M
        }));
      }
    }
  return h;
}, v9 = function(r, t, e) {
  r = um(r), t = um(t);
  for (var n, i, a, o, s, u, f, l, c, h, d = e ? 0 : [], v = 0, p = r.length; v < p; v++) {
    var g = r[v];
    if (g[0] === "M")
      n = s = g[1], i = u = g[2];
    else {
      g[0] === "C" ? (c = [n, i].concat(g.slice(1)), n = c[6], i = c[7]) : (c = [n, i, n, i, s, u, s, u], n = s, i = u);
      for (var y = 0, b = t.length; y < b; y++) {
        var m = t[y];
        if (m[0] === "M")
          a = f = m[1], o = l = m[2];
        else {
          m[0] === "C" ? (h = [a, o].concat(m.slice(1)), a = h[6], o = h[7]) : (h = [a, o, a, o, f, l, f, l], a = f, o = l);
          var x = d9(c, h, e);
          if (e)
            d += x;
          else {
            for (var _ = 0, w = x.length; _ < w; _++)
              x[_].segment1 = v, x[_].segment2 = y, x[_].bez1 = c, x[_].bez2 = h;
            d = d.concat(x);
          }
        }
      }
    }
  }
  return d;
}, p9 = function(r, t) {
  return v9(r, t);
};
function g9(r, t) {
  var e = [], n = [];
  function i(a, o) {
    if (a.length === 1)
      e.push(a[0]), n.push(a[0]);
    else {
      for (var s = [], u = 0; u < a.length - 1; u++)
        u === 0 && e.push(a[0]), u === a.length - 2 && n.push(a[u + 1]), s[u] = [
          (1 - o) * a[u][0] + o * a[u + 1][0],
          (1 - o) * a[u][1] + o * a[u + 1][1]
        ];
      i(s, o);
    }
  }
  return r.length && i(r, t), { left: e, right: n.reverse() };
}
function y9(r, t, e) {
  var n = [[r[1], r[2]]];
  e = e || 2;
  var i = [];
  t[0] === "A" ? (n.push(t[6]), n.push(t[7])) : t[0] === "C" ? (n.push([t[1], t[2]]), n.push([t[3], t[4]]), n.push([t[5], t[6]])) : t[0] === "S" || t[0] === "Q" ? (n.push([t[1], t[2]]), n.push([t[3], t[4]])) : n.push([t[1], t[2]]);
  for (var a = n, o = 1 / e, s = 0; s < e - 1; s++) {
    var u = o / (1 - o * s), f = g9(a, u);
    i.push(f.left), a = f.right;
  }
  i.push(a);
  var l = i.map(function(c) {
    var h = [];
    return c.length === 4 && (h.push("C"), h = h.concat(c[2])), c.length >= 3 && (c.length === 3 && h.push("Q"), h = h.concat(c[1])), c.length === 2 && h.push("L"), h = h.concat(c[c.length - 1]), h;
  });
  return l;
}
var m9 = function(r, t, e) {
  if (e === 1)
    return [[].concat(r)];
  var n = [];
  if (t[0] === "L" || t[0] === "C" || t[0] === "Q")
    n = n.concat(y9(r, t, e));
  else {
    var i = [].concat(r);
    i[0] === "M" && (i[0] = "L");
    for (var a = 0; a <= e - 1; a++)
      n.push(i);
  }
  return n;
}, b9 = function(r, t) {
  if (r.length === 1)
    return r;
  var e = r.length - 1, n = t.length - 1, i = e / n, a = [];
  if (r.length === 1 && r[0][0] === "M") {
    for (var o = 0; o < n - e; o++)
      r.push(r[0]);
    return r;
  }
  for (var o = 0; o < n; o++) {
    var s = Math.floor(i * o);
    a[s] = (a[s] || 0) + 1;
  }
  var u = a.reduce(function(f, l, c) {
    return c === e ? f.concat(r[e]) : f.concat(m9(r[c], r[c + 1], l));
  }, []);
  return u.unshift(r[0]), (t[n] === "Z" || t[n] === "z") && u.push("Z"), u;
}, x9 = function(r, t) {
  if (r.length !== t.length)
    return !1;
  var e = !0;
  return Se(r, function(n, i) {
    if (n !== t[i])
      return e = !1, !1;
  }), e;
};
function _9(r, t, e) {
  var n = null, i = e;
  return t < i && (i = t, n = "add"), r < i && (i = r, n = "del"), {
    type: n,
    min: i
  };
}
var w9 = function(r, t) {
  var e = r.length, n = t.length, i, a, o = 0;
  if (e === 0 || n === 0)
    return null;
  for (var s = [], u = 0; u <= e; u++)
    s[u] = [], s[u][0] = { min: u };
  for (var f = 0; f <= n; f++)
    s[0][f] = { min: f };
  for (var u = 1; u <= e; u++) {
    i = r[u - 1];
    for (var f = 1; f <= n; f++) {
      a = t[f - 1], x9(i, a) ? o = 0 : o = 1;
      var l = s[u - 1][f].min + 1, c = s[u][f - 1].min + 1, h = s[u - 1][f - 1].min + o;
      s[u][f] = _9(l, c, h);
    }
  }
  return s;
}, FL = function(r, t) {
  var e = w9(r, t), n = r.length, i = t.length, a = [], o = 1, s = 1;
  if (e[n][i].min !== n) {
    for (var u = 1; u <= n; u++) {
      var f = e[u][u].min;
      s = u;
      for (var l = o; l <= i; l++)
        e[u][l].min < f && (f = e[u][l].min, s = l);
      o = s, e[u][o].type && a.push({ index: u - 1, type: e[u][o].type });
    }
    for (var u = a.length - 1; u >= 0; u--)
      o = a[u].index, a[u].type === "add" ? r.splice(o, 0, [].concat(r[o])) : r.splice(o, 1);
  }
  n = r.length;
  var c = i - n;
  if (n < i)
    for (var u = 0; u < c; u++)
      r[n - 1][0] === "z" || r[n - 1][0] === "Z" ? r.splice(n - 2, 0, r[n - 2]) : r.push(r[n - 1]), n += 1;
  return r;
};
function P0(r, t, e) {
  for (var n = [].concat(r), i, a = 1 / (e + 1), o = zL(t)[0], s = 1; s <= e; s++)
    a *= s, i = Math.floor(r.length * a), i === 0 ? n.unshift([o[0] * a + r[i][0] * (1 - a), o[1] * a + r[i][1] * (1 - a)]) : n.splice(i, 0, [
      o[0] * a + r[i][0] * (1 - a),
      o[1] * a + r[i][1] * (1 - a)
    ]);
  return n;
}
function zL(r) {
  var t = [];
  switch (r[0]) {
    case "M":
      t.push([r[1], r[2]]);
      break;
    case "L":
      t.push([r[1], r[2]]);
      break;
    case "A":
      t.push([r[6], r[7]]);
      break;
    case "Q":
      t.push([r[3], r[4]]), t.push([r[1], r[2]]);
      break;
    case "T":
      t.push([r[1], r[2]]);
      break;
    case "C":
      t.push([r[5], r[6]]), t.push([r[1], r[2]]), t.push([r[3], r[4]]);
      break;
    case "S":
      t.push([r[3], r[4]]), t.push([r[1], r[2]]);
      break;
    case "H":
      t.push([r[1], r[1]]);
      break;
    case "V":
      t.push([r[1], r[1]]);
      break;
  }
  return t;
}
var lm = function(r, t) {
  if (r.length <= 1)
    return r;
  for (var e, n = 0; n < t.length; n++)
    if (r[n][0] !== t[n][0])
      switch (e = zL(r[n]), t[n][0]) {
        case "M":
          r[n] = ["M"].concat(e[0]);
          break;
        case "L":
          r[n] = ["L"].concat(e[0]);
          break;
        case "A":
          r[n] = [].concat(t[n]), r[n][6] = e[0][0], r[n][7] = e[0][1];
          break;
        case "Q":
          if (e.length < 2)
            if (n > 0)
              e = P0(e, r[n - 1], 1);
            else {
              r[n] = t[n];
              break;
            }
          r[n] = ["Q"].concat(e.reduce(function(i, a) {
            return i.concat(a);
          }, []));
          break;
        case "T":
          r[n] = ["T"].concat(e[0]);
          break;
        case "C":
          if (e.length < 3)
            if (n > 0)
              e = P0(e, r[n - 1], 2);
            else {
              r[n] = t[n];
              break;
            }
          r[n] = ["C"].concat(e.reduce(function(i, a) {
            return i.concat(a);
          }, []));
          break;
        case "S":
          if (e.length < 2)
            if (n > 0)
              e = P0(e, r[n - 1], 1);
            else {
              r[n] = t[n];
              break;
            }
          r[n] = ["S"].concat(e.reduce(function(i, a) {
            return i.concat(a);
          }, []));
          break;
        default:
          r[n] = t[n];
      }
  return r;
};
const E9 = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  catmullRomToBezier: om,
  fillPath: b9,
  fillPathByDiff: FL,
  formatPath: lm,
  intersection: p9,
  parsePathArray: BL,
  parsePathString: Cf,
  pathToAbsolute: sm,
  pathToCurve: um,
  rectPath: GL
}, Symbol.toStringTag, { value: "Module" }));
var UL = function() {
  function r(t, e) {
    this.bubbles = !0, this.target = null, this.currentTarget = null, this.delegateTarget = null, this.delegateObject = null, this.defaultPrevented = !1, this.propagationStopped = !1, this.shape = null, this.fromShape = null, this.toShape = null, this.propagationPath = [], this.type = t, this.name = t, this.originalEvent = e, this.timeStamp = e.timeStamp;
  }
  return r.prototype.preventDefault = function() {
    this.defaultPrevented = !0, this.originalEvent.preventDefault && this.originalEvent.preventDefault();
  }, r.prototype.stopPropagation = function() {
    this.propagationStopped = !0;
  }, r.prototype.toString = function() {
    var t = this.type;
    return "[Event (type=" + t + ")]";
  }, r.prototype.save = function() {
  }, r.prototype.restore = function() {
  }, r;
}();
function jL(r, t) {
  var e = r.indexOf(t);
  e !== -1 && r.splice(e, 1);
}
var TE = typeof window < "u" && typeof window.document < "u";
function $L(r, t) {
  if (r.isCanvas())
    return !0;
  for (var e = t.getParent(), n = !1; e; ) {
    if (e === r) {
      n = !0;
      break;
    }
    e = e.getParent();
  }
  return n;
}
function cm(r) {
  return r.cfg.visible && r.cfg.capture;
}
var S9 = function(r) {
  Ht(t, r);
  function t(e) {
    var n = r.call(this) || this;
    n.destroyed = !1;
    var i = n.getDefaultCfg();
    return n.cfg = kt(i, e), n;
  }
  return t.prototype.getDefaultCfg = function() {
    return {};
  }, t.prototype.get = function(e) {
    return this.cfg[e];
  }, t.prototype.set = function(e, n) {
    this.cfg[e] = n;
  }, t.prototype.destroy = function() {
    this.cfg = {
      destroyed: !0
    }, this.off(), this.destroyed = !0;
  }, t;
}(FD), AE = globalThis && globalThis.__spreadArray || function(r, t, e) {
  if (e || arguments.length === 2)
    for (var n = 0, i = t.length, a; n < i; n++)
      (a || !(n in t)) && (a || (a = Array.prototype.slice.call(t, 0, n)), a[n] = t[n]);
  return r.concat(a || Array.prototype.slice.call(t));
}, M9 = function() {
  function r(t, e, n) {
    this.name = t, this.version = e, this.os = n, this.type = "browser";
  }
  return r;
}(), C9 = function() {
  function r(t) {
    this.version = t, this.type = "node", this.name = "node", this.os = process.platform;
  }
  return r;
}(), T9 = function() {
  function r(t, e, n, i) {
    this.name = t, this.version = e, this.os = n, this.bot = i, this.type = "bot-device";
  }
  return r;
}(), A9 = function() {
  function r() {
    this.type = "bot", this.bot = !0, this.name = "bot", this.version = null, this.os = null;
  }
  return r;
}(), I9 = function() {
  function r() {
    this.type = "react-native", this.name = "react-native", this.version = null, this.os = null;
  }
  return r;
}(), P9 = /alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/, O9 = /(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/, IE = 3, D9 = [
  ["aol", /AOLShield\/([0-9\._]+)/],
  ["edge", /Edge\/([0-9\._]+)/],
  ["edge-ios", /EdgiOS\/([0-9\._]+)/],
  ["yandexbrowser", /YaBrowser\/([0-9\._]+)/],
  ["kakaotalk", /KAKAOTALK\s([0-9\.]+)/],
  ["samsung", /SamsungBrowser\/([0-9\.]+)/],
  ["silk", /\bSilk\/([0-9._-]+)\b/],
  ["miui", /MiuiBrowser\/([0-9\.]+)$/],
  ["beaker", /BeakerBrowser\/([0-9\.]+)/],
  ["edge-chromium", /EdgA?\/([0-9\.]+)/],
  [
    "chromium-webview",
    /(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/
  ],
  ["chrome", /(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],
  ["phantomjs", /PhantomJS\/([0-9\.]+)(:?\s|$)/],
  ["crios", /CriOS\/([0-9\.]+)(:?\s|$)/],
  ["firefox", /Firefox\/([0-9\.]+)(?:\s|$)/],
  ["fxios", /FxiOS\/([0-9\.]+)/],
  ["opera-mini", /Opera Mini.*Version\/([0-9\.]+)/],
  ["opera", /Opera\/([0-9\.]+)(?:\s|$)/],
  ["opera", /OPR\/([0-9\.]+)(:?\s|$)/],
  ["pie", /^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],
  ["pie", /^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],
  ["netfront", /^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],
  ["ie", /Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],
  ["ie", /MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],
  ["ie", /MSIE\s(7\.0)/],
  ["bb10", /BB10;\sTouch.*Version\/([0-9\.]+)/],
  ["android", /Android\s([0-9\.]+)/],
  ["ios", /Version\/([0-9\._]+).*Mobile.*Safari.*/],
  ["safari", /Version\/([0-9\._]+).*Safari/],
  ["facebook", /FB[AS]V\/([0-9\.]+)/],
  ["instagram", /Instagram\s([0-9\.]+)/],
  ["ios-webview", /AppleWebKit\/([0-9\.]+).*Mobile/],
  ["ios-webview", /AppleWebKit\/([0-9\.]+).*Gecko\)$/],
  ["curl", /^curl\/([0-9\.]+)$/],
  ["searchbot", P9]
], PE = [
  ["iOS", /iP(hone|od|ad)/],
  ["Android OS", /Android/],
  ["BlackBerry OS", /BlackBerry|BB10/],
  ["Windows Mobile", /IEMobile/],
  ["Amazon OS", /Kindle/],
  ["Windows 3.11", /Win16/],
  ["Windows 95", /(Windows 95)|(Win95)|(Windows_95)/],
  ["Windows 98", /(Windows 98)|(Win98)/],
  ["Windows 2000", /(Windows NT 5.0)|(Windows 2000)/],
  ["Windows XP", /(Windows NT 5.1)|(Windows XP)/],
  ["Windows Server 2003", /(Windows NT 5.2)/],
  ["Windows Vista", /(Windows NT 6.0)/],
  ["Windows 7", /(Windows NT 6.1)/],
  ["Windows 8", /(Windows NT 6.2)/],
  ["Windows 8.1", /(Windows NT 6.3)/],
  ["Windows 10", /(Windows NT 10.0)/],
  ["Windows ME", /Windows ME/],
  ["Windows CE", /Windows CE|WinCE|Microsoft Pocket Internet Explorer/],
  ["Open BSD", /OpenBSD/],
  ["Sun OS", /SunOS/],
  ["Chrome OS", /CrOS/],
  ["Linux", /(Linux)|(X11)/],
  ["Mac OS", /(Mac_PowerPC)|(Macintosh)/],
  ["QNX", /QNX/],
  ["BeOS", /BeOS/],
  ["OS/2", /OS\/2/]
];
function WL(r) {
  return r ? OE(r) : typeof document > "u" && typeof navigator < "u" && navigator.product === "ReactNative" ? new I9() : typeof navigator < "u" ? OE(navigator.userAgent) : N9();
}
function k9(r) {
  return r !== "" && D9.reduce(function(t, e) {
    var n = e[0], i = e[1];
    if (t)
      return t;
    var a = i.exec(r);
    return !!a && [n, a];
  }, !1);
}
function OE(r) {
  var t = k9(r);
  if (!t)
    return null;
  var e = t[0], n = t[1];
  if (e === "searchbot")
    return new A9();
  var i = n[1] && n[1].split(".").join("_").split("_").slice(0, 3);
  i ? i.length < IE && (i = AE(AE([], i, !0), R9(IE - i.length), !0)) : i = [];
  var a = i.join("."), o = L9(r), s = O9.exec(r);
  return s && s[1] ? new T9(e, a, o, s[1]) : new M9(e, a, o);
}
function L9(r) {
  for (var t = 0, e = PE.length; t < e; t++) {
    var n = PE[t], i = n[0], a = n[1], o = a.exec(r);
    if (o)
      return i;
  }
  return null;
}
function N9() {
  var r = typeof process < "u" && process.version;
  return r ? new C9(process.version.slice(1)) : null;
}
function R9(r) {
  for (var t = [], e = 0; e < r; e++)
    t.push("0");
  return t;
}
function DE(r, t) {
  var e = [], n = r[0], i = r[1], a = r[2], o = r[3], s = r[4], u = r[5], f = r[6], l = r[7], c = r[8], h = t[0], d = t[1], v = t[2], p = t[3], g = t[4], y = t[5], b = t[6], m = t[7], x = t[8];
  return e[0] = h * n + d * o + v * f, e[1] = h * i + d * s + v * l, e[2] = h * a + d * u + v * c, e[3] = p * n + g * o + y * f, e[4] = p * i + g * s + y * l, e[5] = p * a + g * u + y * c, e[6] = b * n + m * o + x * f, e[7] = b * i + m * s + x * l, e[8] = b * a + m * u + x * c, e;
}
function au(r, t) {
  var e = [], n = t[0], i = t[1];
  return e[0] = r[0] * n + r[3] * i + r[6], e[1] = r[1] * n + r[4] * i + r[7], e;
}
function VL(r) {
  var t = [], e = r[0], n = r[1], i = r[2], a = r[3], o = r[4], s = r[5], u = r[6], f = r[7], l = r[8], c = l * o - s * f, h = -l * a + s * u, d = f * a - o * u, v = e * c + n * h + i * d;
  return v ? (v = 1 / v, t[0] = c * v, t[1] = (-l * n + i * f) * v, t[2] = (s * n - i * o) * v, t[3] = h * v, t[4] = (l * e - i * u) * v, t[5] = (-s * e + i * a) * v, t[6] = d * v, t[7] = (-f * e + n * u) * v, t[8] = (o * e - n * a) * v, t) : null;
}
var Ml = $i, O0 = "matrix", B9 = ["zIndex", "capture", "visible", "type"], G9 = ["repeat"], F9 = ":", z9 = "*";
function U9(r) {
  for (var t = [], e = 0; e < r.length; e++)
    Dt(r[e]) ? t.push([].concat(r[e])) : t.push(r[e]);
  return t;
}
function j9(r, t) {
  var e = {}, n = t.attrs;
  for (var i in r)
    e[i] = n[i];
  return e;
}
function $9(r, t) {
  var e = {}, n = t.attr();
  return Se(r, function(i, a) {
    G9.indexOf(a) === -1 && !ls(n[a], i) && (e[a] = i);
  }), e;
}
function W9(r, t) {
  if (t.onFrame)
    return r;
  var e = t.startTime, n = t.delay, i = t.duration, a = Object.prototype.hasOwnProperty;
  return Se(r, function(o) {
    e + n < o.startTime + o.delay + o.duration && i > o.delay && Se(t.toAttrs, function(s, u) {
      a.call(o.toAttrs, u) && (delete o.toAttrs[u], delete o.fromAttrs[u]);
    });
  }), r;
}
var XL = function(r) {
  Ht(t, r);
  function t(e) {
    var n = r.call(this, e) || this;
    n.attrs = {};
    var i = n.getDefaultAttrs();
    return kt(i, e.attrs), n.attrs = i, n.initAttrs(i), n.initAnimate(), n;
  }
  return t.prototype.getDefaultCfg = function() {
    return {
      visible: !0,
      capture: !0,
      zIndex: 0
    };
  }, t.prototype.getDefaultAttrs = function() {
    return {
      matrix: this.getDefaultMatrix(),
      opacity: 1
    };
  }, t.prototype.onCanvasChange = function(e) {
  }, t.prototype.initAttrs = function(e) {
  }, t.prototype.initAnimate = function() {
    this.set("animable", !0), this.set("animating", !1);
  }, t.prototype.isGroup = function() {
    return !1;
  }, t.prototype.getParent = function() {
    return this.get("parent");
  }, t.prototype.getCanvas = function() {
    return this.get("canvas");
  }, t.prototype.attr = function() {
    for (var e, n = [], i = 0; i < arguments.length; i++)
      n[i] = arguments[i];
    var a = n[0], o = n[1];
    if (!a)
      return this.attrs;
    if (Xn(a)) {
      for (var s in a)
        this.setAttr(s, a[s]);
      return this.afterAttrsChange(a), this;
    }
    return n.length === 2 ? (this.setAttr(a, o), this.afterAttrsChange((e = {}, e[a] = o, e)), this) : this.attrs[a];
  }, t.prototype.isClipped = function(e, n) {
    var i = this.getClip();
    return i && !i.isHit(e, n);
  }, t.prototype.setAttr = function(e, n) {
    var i = this.attrs[e];
    i !== n && (this.attrs[e] = n, this.onAttrChange(e, n, i));
  }, t.prototype.onAttrChange = function(e, n, i) {
    e === "matrix" && this.set("totalMatrix", null);
  }, t.prototype.afterAttrsChange = function(e) {
    if (this.cfg.isClipShape) {
      var n = this.cfg.applyTo;
      n && n.onCanvasChange("clip");
    } else
      this.onCanvasChange("attr");
  }, t.prototype.show = function() {
    return this.set("visible", !0), this.onCanvasChange("show"), this;
  }, t.prototype.hide = function() {
    return this.set("visible", !1), this.onCanvasChange("hide"), this;
  }, t.prototype.setZIndex = function(e) {
    this.set("zIndex", e);
    var n = this.getParent();
    return n && n.sort(), this;
  }, t.prototype.toFront = function() {
    var e = this.getParent();
    if (!!e) {
      var n = e.getChildren();
      this.get("el");
      var i = n.indexOf(this);
      n.splice(i, 1), n.push(this), this.onCanvasChange("zIndex");
    }
  }, t.prototype.toBack = function() {
    var e = this.getParent();
    if (!!e) {
      var n = e.getChildren();
      this.get("el");
      var i = n.indexOf(this);
      n.splice(i, 1), n.unshift(this), this.onCanvasChange("zIndex");
    }
  }, t.prototype.remove = function(e) {
    e === void 0 && (e = !0);
    var n = this.getParent();
    n ? (jL(n.getChildren(), this), n.get("clearing") || this.onCanvasChange("remove")) : this.onCanvasChange("remove"), e && this.destroy();
  }, t.prototype.resetMatrix = function() {
    this.attr(O0, this.getDefaultMatrix()), this.onCanvasChange("matrix");
  }, t.prototype.getMatrix = function() {
    return this.attr(O0);
  }, t.prototype.setMatrix = function(e) {
    this.attr(O0, e), this.onCanvasChange("matrix");
  }, t.prototype.getTotalMatrix = function() {
    var e = this.cfg.totalMatrix;
    if (!e) {
      var n = this.attr("matrix"), i = this.cfg.parentMatrix;
      i && n ? e = DE(i, n) : e = n || i, this.set("totalMatrix", e);
    }
    return e;
  }, t.prototype.applyMatrix = function(e) {
    var n = this.attr("matrix"), i = null;
    e && n ? i = DE(e, n) : i = n || e, this.set("totalMatrix", i), this.set("parentMatrix", e);
  }, t.prototype.getDefaultMatrix = function() {
    return null;
  }, t.prototype.applyToMatrix = function(e) {
    var n = this.attr("matrix");
    return n ? au(n, e) : e;
  }, t.prototype.invertFromMatrix = function(e) {
    var n = this.attr("matrix");
    if (n) {
      var i = VL(n);
      if (i)
        return au(i, e);
    }
    return e;
  }, t.prototype.setClip = function(e) {
    var n = this.getCanvas(), i = null;
    if (e) {
      var a = this.getShapeBase(), o = Bf(e.type), s = a[o];
      s && (i = new s({
        type: e.type,
        isClipShape: !0,
        applyTo: this,
        attrs: e.attrs,
        canvas: n
      }));
    }
    return this.set("clipShape", i), this.onCanvasChange("clip"), i;
  }, t.prototype.getClip = function() {
    var e = this.cfg.clipShape;
    return e || null;
  }, t.prototype.clone = function() {
    var e = this, n = this.attrs, i = {};
    Se(n, function(s, u) {
      Dt(n[u]) ? i[u] = U9(n[u]) : i[u] = n[u];
    });
    var a = this.constructor, o = new a({ attrs: i });
    return Se(B9, function(s) {
      o.set(s, e.get(s));
    }), o;
  }, t.prototype.destroy = function() {
    var e = this.destroyed;
    e || (this.attrs = {}, r.prototype.destroy.call(this));
  }, t.prototype.isAnimatePaused = function() {
    return this.get("_pause").isPaused;
  }, t.prototype.animate = function() {
    for (var e = [], n = 0; n < arguments.length; n++)
      e[n] = arguments[n];
    if (!(!this.get("timeline") && !this.get("canvas"))) {
      this.set("animating", !0);
      var i = this.get("timeline");
      i || (i = this.get("canvas").get("timeline"), this.set("timeline", i));
      var a = this.get("animations") || [];
      i.timer || i.initTimer();
      var o = e[0], s = e[1], u = e[2], f = u === void 0 ? "easeLinear" : u, l = e[3], c = l === void 0 ? ec : l, h = e[4], d = h === void 0 ? 0 : h, v, p, g, y, b;
      Ur(o) ? (v = o, o = {}) : Xn(o) && o.onFrame && (v = o.onFrame, p = o.repeat), Xn(s) ? (b = s, s = b.duration, f = b.easing || "easeLinear", d = b.delay || 0, p = b.repeat || p || !1, c = b.callback || ec, g = b.pauseCallback || ec, y = b.resumeCallback || ec) : (At(c) && (d = c, c = null), Ur(f) ? (c = f, f = "easeLinear") : f = f || "easeLinear");
      var m = $9(o, this), x = {
        fromAttrs: j9(m, this),
        toAttrs: m,
        duration: s,
        easing: f,
        repeat: p,
        callback: c,
        pauseCallback: g,
        resumeCallback: y,
        delay: d,
        startTime: i.getTime(),
        id: ja(),
        onFrame: v,
        pathFormatted: !1
      };
      a.length > 0 ? a = W9(a, x) : i.addAnimator(this), a.push(x), this.set("animations", a), this.set("_pause", { isPaused: !1 });
    }
  }, t.prototype.stopAnimate = function(e) {
    var n = this;
    e === void 0 && (e = !0);
    var i = this.get("animations");
    Se(i, function(a) {
      e && (a.onFrame ? n.attr(a.onFrame(1)) : n.attr(a.toAttrs)), a.callback && a.callback();
    }), this.set("animating", !1), this.set("animations", []);
  }, t.prototype.pauseAnimate = function() {
    var e = this.get("timeline"), n = this.get("animations"), i = e.getTime();
    return Se(n, function(a) {
      a._paused = !0, a._pauseTime = i, a.pauseCallback && a.pauseCallback();
    }), this.set("_pause", {
      isPaused: !0,
      pauseTime: i
    }), this;
  }, t.prototype.resumeAnimate = function() {
    var e = this.get("timeline"), n = e.getTime(), i = this.get("animations"), a = this.get("_pause").pauseTime;
    return Se(i, function(o) {
      o.startTime = o.startTime + (n - a), o._paused = !1, o._pauseTime = null, o.resumeCallback && o.resumeCallback();
    }), this.set("_pause", {
      isPaused: !1
    }), this.set("animations", i), this;
  }, t.prototype.emitDelegation = function(e, n) {
    var i = this, a = n.propagationPath;
    this.getEvents();
    var o;
    e === "mouseenter" ? o = n.fromShape : e === "mouseleave" && (o = n.toShape);
    for (var s = function(c) {
      var h = a[c], d = h.get("name");
      if (d) {
        if ((h.isGroup() || h.isCanvas && h.isCanvas()) && o && $L(h, o))
          return "break";
        Dt(d) ? Se(d, function(v) {
          i.emitDelegateEvent(h, v, n);
        }) : u.emitDelegateEvent(h, d, n);
      }
    }, u = this, f = 0; f < a.length; f++) {
      var l = s(f);
      if (l === "break")
        break;
    }
  }, t.prototype.emitDelegateEvent = function(e, n, i) {
    var a = this.getEvents(), o = n + F9 + i.type;
    (a[o] || a[z9]) && (i.name = o, i.currentTarget = e, i.delegateTarget = this, i.delegateObject = e.get("delegateObject"), this.emit(o, i));
  }, t.prototype.translate = function(e, n) {
    e === void 0 && (e = 0), n === void 0 && (n = 0);
    var i = this.getMatrix(), a = Ml(i, [["t", e, n]]);
    return this.setMatrix(a), this;
  }, t.prototype.move = function(e, n) {
    var i = this.attr("x") || 0, a = this.attr("y") || 0;
    return this.translate(e - i, n - a), this;
  }, t.prototype.moveTo = function(e, n) {
    return this.move(e, n);
  }, t.prototype.scale = function(e, n) {
    var i = this.getMatrix(), a = Ml(i, [["s", e, n || e]]);
    return this.setMatrix(a), this;
  }, t.prototype.rotate = function(e) {
    var n = this.getMatrix(), i = Ml(n, [["r", e]]);
    return this.setMatrix(i), this;
  }, t.prototype.rotateAtStart = function(e) {
    var n = this.attr(), i = n.x, a = n.y, o = this.getMatrix(), s = Ml(o, [
      ["t", -i, -a],
      ["r", e],
      ["t", i, a]
    ]);
    return this.setMatrix(s), this;
  }, t.prototype.rotateAtPoint = function(e, n, i) {
    var a = this.getMatrix(), o = Ml(a, [
      ["t", -e, -n],
      ["r", i],
      ["t", e, n]
    ]);
    return this.setMatrix(o), this;
  }, t;
}(S9), kE = {}, hm = "_INDEX";
function YL(r, t) {
  if (r.set("canvas", t), r.isGroup()) {
    var e = r.get("children");
    e.length && e.forEach(function(n) {
      YL(n, t);
    });
  }
}
function HL(r, t) {
  if (r.set("timeline", t), r.isGroup()) {
    var e = r.get("children");
    e.length && e.forEach(function(n) {
      HL(n, t);
    });
  }
}
function V9(r, t, e) {
  e === void 0 && (e = !0), e ? t.destroy() : (t.set("parent", null), t.set("canvas", null)), jL(r.getChildren(), t);
}
function X9(r) {
  return function(t, e) {
    var n = r(t, e);
    return n === 0 ? t[hm] - e[hm] : n;
  };
}
var KL = function(r) {
  Ht(t, r);
  function t() {
    return r !== null && r.apply(this, arguments) || this;
  }
  return t.prototype.isCanvas = function() {
    return !1;
  }, t.prototype.getBBox = function() {
    var e = 1 / 0, n = -1 / 0, i = 1 / 0, a = -1 / 0, o = [], s = [], u = this.getChildren().filter(function(l) {
      return l.get("visible") && (!l.isGroup() || l.isGroup() && l.getChildren().length > 0);
    });
    u.length > 0 ? (Se(u, function(l) {
      var c = l.getBBox();
      o.push(c.minX, c.maxX), s.push(c.minY, c.maxY);
    }), e = Fi(o), n = Gi(o), i = Fi(s), a = Gi(s)) : (e = 0, n = 0, i = 0, a = 0);
    var f = {
      x: e,
      y: i,
      minX: e,
      minY: i,
      maxX: n,
      maxY: a,
      width: n - e,
      height: a - i
    };
    return f;
  }, t.prototype.getCanvasBBox = function() {
    var e = 1 / 0, n = -1 / 0, i = 1 / 0, a = -1 / 0, o = [], s = [], u = this.getChildren().filter(function(l) {
      return l.get("visible") && (!l.isGroup() || l.isGroup() && l.getChildren().length > 0);
    });
    u.length > 0 ? (Se(u, function(l) {
      var c = l.getCanvasBBox();
      o.push(c.minX, c.maxX), s.push(c.minY, c.maxY);
    }), e = Fi(o), n = Gi(o), i = Fi(s), a = Gi(s)) : (e = 0, n = 0, i = 0, a = 0);
    var f = {
      x: e,
      y: i,
      minX: e,
      minY: i,
      maxX: n,
      maxY: a,
      width: n - e,
      height: a - i
    };
    return f;
  }, t.prototype.getDefaultCfg = function() {
    var e = r.prototype.getDefaultCfg.call(this);
    return e.children = [], e;
  }, t.prototype.onAttrChange = function(e, n, i) {
    if (r.prototype.onAttrChange.call(this, e, n, i), e === "matrix") {
      var a = this.getTotalMatrix();
      this._applyChildrenMarix(a);
    }
  }, t.prototype.applyMatrix = function(e) {
    var n = this.getTotalMatrix();
    r.prototype.applyMatrix.call(this, e);
    var i = this.getTotalMatrix();
    i !== n && this._applyChildrenMarix(i);
  }, t.prototype._applyChildrenMarix = function(e) {
    var n = this.getChildren();
    Se(n, function(i) {
      i.applyMatrix(e);
    });
  }, t.prototype.addShape = function() {
    for (var e = [], n = 0; n < arguments.length; n++)
      e[n] = arguments[n];
    var i = e[0], a = e[1];
    Xn(i) ? a = i : a.type = i;
    var o = kE[a.type];
    o || (o = Bf(a.type), kE[a.type] = o);
    var s = this.getShapeBase(), u = new s[o](a);
    return this.add(u), u;
  }, t.prototype.addGroup = function() {
    for (var e = [], n = 0; n < arguments.length; n++)
      e[n] = arguments[n];
    var i = e[0], a = e[1], o;
    if (Ur(i))
      a ? o = new i(a) : o = new i({
        parent: this
      });
    else {
      var s = i || {}, u = this.getGroupBase();
      o = new u(s);
    }
    return this.add(o), o;
  }, t.prototype.getCanvas = function() {
    var e;
    return this.isCanvas() ? e = this : e = this.get("canvas"), e;
  }, t.prototype.getShape = function(e, n, i) {
    if (!cm(this))
      return null;
    var a = this.getChildren(), o;
    if (this.isCanvas())
      o = this._findShape(a, e, n, i);
    else {
      var s = [e, n, 1];
      s = this.invertFromMatrix(s), this.isClipped(s[0], s[1]) || (o = this._findShape(a, s[0], s[1], i));
    }
    return o;
  }, t.prototype._findShape = function(e, n, i, a) {
    for (var o = null, s = e.length - 1; s >= 0; s--) {
      var u = e[s];
      if (cm(u) && (u.isGroup() ? o = u.getShape(n, i, a) : u.isHit(n, i) && (o = u)), o)
        break;
    }
    return o;
  }, t.prototype.add = function(e) {
    var n = this.getCanvas(), i = this.getChildren(), a = this.get("timeline"), o = e.getParent();
    o && V9(o, e, !1), e.set("parent", this), n && YL(e, n), a && HL(e, a), i.push(e), e.onCanvasChange("add"), this._applyElementMatrix(e);
  }, t.prototype._applyElementMatrix = function(e) {
    var n = this.getTotalMatrix();
    n && e.applyMatrix(n);
  }, t.prototype.getChildren = function() {
    return this.get("children");
  }, t.prototype.sort = function() {
    var e = this.getChildren();
    Se(e, function(n, i) {
      return n[hm] = i, n;
    }), e.sort(X9(function(n, i) {
      return n.get("zIndex") - i.get("zIndex");
    })), this.onCanvasChange("sort");
  }, t.prototype.clear = function() {
    if (this.set("clearing", !0), !this.destroyed) {
      for (var e = this.getChildren(), n = e.length - 1; n >= 0; n--)
        e[n].destroy();
      this.set("children", []), this.onCanvasChange("clear"), this.set("clearing", !1);
    }
  }, t.prototype.destroy = function() {
    this.get("destroyed") || (this.clear(), r.prototype.destroy.call(this));
  }, t.prototype.getFirst = function() {
    return this.getChildByIndex(0);
  }, t.prototype.getLast = function() {
    var e = this.getChildren();
    return this.getChildByIndex(e.length - 1);
  }, t.prototype.getChildByIndex = function(e) {
    var n = this.getChildren();
    return n[e];
  }, t.prototype.getCount = function() {
    var e = this.getChildren();
    return e.length;
  }, t.prototype.contain = function(e) {
    var n = this.getChildren();
    return n.indexOf(e) > -1;
  }, t.prototype.removeChild = function(e, n) {
    n === void 0 && (n = !0), this.contain(e) && e.remove(n);
  }, t.prototype.findAll = function(e) {
    var n = [], i = this.getChildren();
    return Se(i, function(a) {
      e(a) && n.push(a), a.isGroup() && (n = n.concat(a.findAll(e)));
    }), n;
  }, t.prototype.find = function(e) {
    var n = null, i = this.getChildren();
    return Se(i, function(a) {
      if (e(a) ? n = a : a.isGroup() && (n = a.find(e)), n)
        return !1;
    }), n;
  }, t.prototype.findById = function(e) {
    return this.find(function(n) {
      return n.get("id") === e;
    });
  }, t.prototype.findByClassName = function(e) {
    return this.find(function(n) {
      return n.get("className") === e;
    });
  }, t.prototype.findAllByName = function(e) {
    return this.findAll(function(n) {
      return n.get("name") === e;
    });
  }, t;
}(XL), zf = 0, rc = 0, Cl = 0, qL = 1e3, Hv, nc, Kv = 0, yu = 0, Np = 0, Dc = typeof performance == "object" && performance.now ? performance : Date, ZL = typeof window == "object" && window.requestAnimationFrame ? window.requestAnimationFrame.bind(window) : function(r) {
  setTimeout(r, 17);
};
function QL() {
  return yu || (ZL(Y9), yu = Dc.now() + Np);
}
function Y9() {
  yu = 0;
}
function dm() {
  this._call = this._time = this._next = null;
}
dm.prototype = JL.prototype = {
  constructor: dm,
  restart: function(r, t, e) {
    if (typeof r != "function")
      throw new TypeError("callback is not a function");
    e = (e == null ? QL() : +e) + (t == null ? 0 : +t), !this._next && nc !== this && (nc ? nc._next = this : Hv = this, nc = this), this._call = r, this._time = e, vm();
  },
  stop: function() {
    this._call && (this._call = null, this._time = 1 / 0, vm());
  }
};
function JL(r, t, e) {
  var n = new dm();
  return n.restart(r, t, e), n;
}
function H9() {
  QL(), ++zf;
  for (var r = Hv, t; r; )
    (t = yu - r._time) >= 0 && r._call.call(null, t), r = r._next;
  --zf;
}
function LE() {
  yu = (Kv = Dc.now()) + Np, zf = rc = 0;
  try {
    H9();
  } finally {
    zf = 0, q9(), yu = 0;
  }
}
function K9() {
  var r = Dc.now(), t = r - Kv;
  t > qL && (Np -= t, Kv = r);
}
function q9() {
  for (var r, t = Hv, e, n = 1 / 0; t; )
    t._call ? (n > t._time && (n = t._time), r = t, t = t._next) : (e = t._next, t._next = null, t = r ? r._next = e : Hv = e);
  nc = r, vm(n);
}
function vm(r) {
  if (!zf) {
    rc && (rc = clearTimeout(rc));
    var t = r - yu;
    t > 24 ? (r < 1 / 0 && (rc = setTimeout(LE, r - Dc.now() - Np)), Cl && (Cl = clearInterval(Cl))) : (Cl || (Kv = Dc.now(), Cl = setInterval(K9, qL)), zf = 1, ZL(LE));
  }
}
function bb(r, t, e) {
  r.prototype = t.prototype = e, e.constructor = r;
}
function eN(r, t) {
  var e = Object.create(r.prototype);
  for (var n in t)
    e[n] = t[n];
  return e;
}
function eh() {
}
var kc = 0.7, qv = 1 / kc, Of = "\\s*([+-]?\\d+)\\s*", Lc = "\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*", za = "\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*", Z9 = /^#([0-9a-f]{3,8})$/, Q9 = new RegExp("^rgb\\(" + [Of, Of, Of] + "\\)$"), J9 = new RegExp("^rgb\\(" + [za, za, za] + "\\)$"), e7 = new RegExp("^rgba\\(" + [Of, Of, Of, Lc] + "\\)$"), t7 = new RegExp("^rgba\\(" + [za, za, za, Lc] + "\\)$"), r7 = new RegExp("^hsl\\(" + [Lc, za, za] + "\\)$"), n7 = new RegExp("^hsla\\(" + [Lc, za, za, Lc] + "\\)$"), NE = {
  aliceblue: 15792383,
  antiquewhite: 16444375,
  aqua: 65535,
  aquamarine: 8388564,
  azure: 15794175,
  beige: 16119260,
  bisque: 16770244,
  black: 0,
  blanchedalmond: 16772045,
  blue: 255,
  blueviolet: 9055202,
  brown: 10824234,
  burlywood: 14596231,
  cadetblue: 6266528,
  chartreuse: 8388352,
  chocolate: 13789470,
  coral: 16744272,
  cornflowerblue: 6591981,
  cornsilk: 16775388,
  crimson: 14423100,
  cyan: 65535,
  darkblue: 139,
  darkcyan: 35723,
  darkgoldenrod: 12092939,
  darkgray: 11119017,
  darkgreen: 25600,
  darkgrey: 11119017,
  darkkhaki: 12433259,
  darkmagenta: 9109643,
  darkolivegreen: 5597999,
  darkorange: 16747520,
  darkorchid: 10040012,
  darkred: 9109504,
  darksalmon: 15308410,
  darkseagreen: 9419919,
  darkslateblue: 4734347,
  darkslategray: 3100495,
  darkslategrey: 3100495,
  darkturquoise: 52945,
  darkviolet: 9699539,
  deeppink: 16716947,
  deepskyblue: 49151,
  dimgray: 6908265,
  dimgrey: 6908265,
  dodgerblue: 2003199,
  firebrick: 11674146,
  floralwhite: 16775920,
  forestgreen: 2263842,
  fuchsia: 16711935,
  gainsboro: 14474460,
  ghostwhite: 16316671,
  gold: 16766720,
  goldenrod: 14329120,
  gray: 8421504,
  green: 32768,
  greenyellow: 11403055,
  grey: 8421504,
  honeydew: 15794160,
  hotpink: 16738740,
  indianred: 13458524,
  indigo: 4915330,
  ivory: 16777200,
  khaki: 15787660,
  lavender: 15132410,
  lavenderblush: 16773365,
  lawngreen: 8190976,
  lemonchiffon: 16775885,
  lightblue: 11393254,
  lightcoral: 15761536,
  lightcyan: 14745599,
  lightgoldenrodyellow: 16448210,
  lightgray: 13882323,
  lightgreen: 9498256,
  lightgrey: 13882323,
  lightpink: 16758465,
  lightsalmon: 16752762,
  lightseagreen: 2142890,
  lightskyblue: 8900346,
  lightslategray: 7833753,
  lightslategrey: 7833753,
  lightsteelblue: 11584734,
  lightyellow: 16777184,
  lime: 65280,
  limegreen: 3329330,
  linen: 16445670,
  magenta: 16711935,
  maroon: 8388608,
  mediumaquamarine: 6737322,
  mediumblue: 205,
  mediumorchid: 12211667,
  mediumpurple: 9662683,
  mediumseagreen: 3978097,
  mediumslateblue: 8087790,
  mediumspringgreen: 64154,
  mediumturquoise: 4772300,
  mediumvioletred: 13047173,
  midnightblue: 1644912,
  mintcream: 16121850,
  mistyrose: 16770273,
  moccasin: 16770229,
  navajowhite: 16768685,
  navy: 128,
  oldlace: 16643558,
  olive: 8421376,
  olivedrab: 7048739,
  orange: 16753920,
  orangered: 16729344,
  orchid: 14315734,
  palegoldenrod: 15657130,
  palegreen: 10025880,
  paleturquoise: 11529966,
  palevioletred: 14381203,
  papayawhip: 16773077,
  peachpuff: 16767673,
  peru: 13468991,
  pink: 16761035,
  plum: 14524637,
  powderblue: 11591910,
  purple: 8388736,
  rebeccapurple: 6697881,
  red: 16711680,
  rosybrown: 12357519,
  royalblue: 4286945,
  saddlebrown: 9127187,
  salmon: 16416882,
  sandybrown: 16032864,
  seagreen: 3050327,
  seashell: 16774638,
  sienna: 10506797,
  silver: 12632256,
  skyblue: 8900331,
  slateblue: 6970061,
  slategray: 7372944,
  slategrey: 7372944,
  snow: 16775930,
  springgreen: 65407,
  steelblue: 4620980,
  tan: 13808780,
  teal: 32896,
  thistle: 14204888,
  tomato: 16737095,
  turquoise: 4251856,
  violet: 15631086,
  wheat: 16113331,
  white: 16777215,
  whitesmoke: 16119285,
  yellow: 16776960,
  yellowgreen: 10145074
};
bb(eh, Nc, {
  copy: function(r) {
    return Object.assign(new this.constructor(), this, r);
  },
  displayable: function() {
    return this.rgb().displayable();
  },
  hex: RE,
  formatHex: RE,
  formatHsl: i7,
  formatRgb: BE,
  toString: BE
});
function RE() {
  return this.rgb().formatHex();
}
function i7() {
  return tN(this).formatHsl();
}
function BE() {
  return this.rgb().formatRgb();
}
function Nc(r) {
  var t, e;
  return r = (r + "").trim().toLowerCase(), (t = Z9.exec(r)) ? (e = t[1].length, t = parseInt(t[1], 16), e === 6 ? GE(t) : e === 3 ? new wi(t >> 8 & 15 | t >> 4 & 240, t >> 4 & 15 | t & 240, (t & 15) << 4 | t & 15, 1) : e === 8 ? cd(t >> 24 & 255, t >> 16 & 255, t >> 8 & 255, (t & 255) / 255) : e === 4 ? cd(t >> 12 & 15 | t >> 8 & 240, t >> 8 & 15 | t >> 4 & 240, t >> 4 & 15 | t & 240, ((t & 15) << 4 | t & 15) / 255) : null) : (t = Q9.exec(r)) ? new wi(t[1], t[2], t[3], 1) : (t = J9.exec(r)) ? new wi(t[1] * 255 / 100, t[2] * 255 / 100, t[3] * 255 / 100, 1) : (t = e7.exec(r)) ? cd(t[1], t[2], t[3], t[4]) : (t = t7.exec(r)) ? cd(t[1] * 255 / 100, t[2] * 255 / 100, t[3] * 255 / 100, t[4]) : (t = r7.exec(r)) ? UE(t[1], t[2] / 100, t[3] / 100, 1) : (t = n7.exec(r)) ? UE(t[1], t[2] / 100, t[3] / 100, t[4]) : NE.hasOwnProperty(r) ? GE(NE[r]) : r === "transparent" ? new wi(NaN, NaN, NaN, 0) : null;
}
function GE(r) {
  return new wi(r >> 16 & 255, r >> 8 & 255, r & 255, 1);
}
function cd(r, t, e, n) {
  return n <= 0 && (r = t = e = NaN), new wi(r, t, e, n);
}
function a7(r) {
  return r instanceof eh || (r = Nc(r)), r ? (r = r.rgb(), new wi(r.r, r.g, r.b, r.opacity)) : new wi();
}
function pm(r, t, e, n) {
  return arguments.length === 1 ? a7(r) : new wi(r, t, e, n == null ? 1 : n);
}
function wi(r, t, e, n) {
  this.r = +r, this.g = +t, this.b = +e, this.opacity = +n;
}
bb(wi, pm, eN(eh, {
  brighter: function(r) {
    return r = r == null ? qv : Math.pow(qv, r), new wi(this.r * r, this.g * r, this.b * r, this.opacity);
  },
  darker: function(r) {
    return r = r == null ? kc : Math.pow(kc, r), new wi(this.r * r, this.g * r, this.b * r, this.opacity);
  },
  rgb: function() {
    return this;
  },
  displayable: function() {
    return -0.5 <= this.r && this.r < 255.5 && -0.5 <= this.g && this.g < 255.5 && -0.5 <= this.b && this.b < 255.5 && 0 <= this.opacity && this.opacity <= 1;
  },
  hex: FE,
  formatHex: FE,
  formatRgb: zE,
  toString: zE
}));
function FE() {
  return "#" + D0(this.r) + D0(this.g) + D0(this.b);
}
function zE() {
  var r = this.opacity;
  return r = isNaN(r) ? 1 : Math.max(0, Math.min(1, r)), (r === 1 ? "rgb(" : "rgba(") + Math.max(0, Math.min(255, Math.round(this.r) || 0)) + ", " + Math.max(0, Math.min(255, Math.round(this.g) || 0)) + ", " + Math.max(0, Math.min(255, Math.round(this.b) || 0)) + (r === 1 ? ")" : ", " + r + ")");
}
function D0(r) {
  return r = Math.max(0, Math.min(255, Math.round(r) || 0)), (r < 16 ? "0" : "") + r.toString(16);
}
function UE(r, t, e, n) {
  return n <= 0 ? r = t = e = NaN : e <= 0 || e >= 1 ? r = t = NaN : t <= 0 && (r = NaN), new Ta(r, t, e, n);
}
function tN(r) {
  if (r instanceof Ta)
    return new Ta(r.h, r.s, r.l, r.opacity);
  if (r instanceof eh || (r = Nc(r)), !r)
    return new Ta();
  if (r instanceof Ta)
    return r;
  r = r.rgb();
  var t = r.r / 255, e = r.g / 255, n = r.b / 255, i = Math.min(t, e, n), a = Math.max(t, e, n), o = NaN, s = a - i, u = (a + i) / 2;
  return s ? (t === a ? o = (e - n) / s + (e < n) * 6 : e === a ? o = (n - t) / s + 2 : o = (t - e) / s + 4, s /= u < 0.5 ? a + i : 2 - a - i, o *= 60) : s = u > 0 && u < 1 ? 0 : o, new Ta(o, s, u, r.opacity);
}
function o7(r, t, e, n) {
  return arguments.length === 1 ? tN(r) : new Ta(r, t, e, n == null ? 1 : n);
}
function Ta(r, t, e, n) {
  this.h = +r, this.s = +t, this.l = +e, this.opacity = +n;
}
bb(Ta, o7, eN(eh, {
  brighter: function(r) {
    return r = r == null ? qv : Math.pow(qv, r), new Ta(this.h, this.s, this.l * r, this.opacity);
  },
  darker: function(r) {
    return r = r == null ? kc : Math.pow(kc, r), new Ta(this.h, this.s, this.l * r, this.opacity);
  },
  rgb: function() {
    var r = this.h % 360 + (this.h < 0) * 360, t = isNaN(r) || isNaN(this.s) ? 0 : this.s, e = this.l, n = e + (e < 0.5 ? e : 1 - e) * t, i = 2 * e - n;
    return new wi(
      k0(r >= 240 ? r - 240 : r + 120, i, n),
      k0(r, i, n),
      k0(r < 120 ? r + 240 : r - 120, i, n),
      this.opacity
    );
  },
  displayable: function() {
    return (0 <= this.s && this.s <= 1 || isNaN(this.s)) && 0 <= this.l && this.l <= 1 && 0 <= this.opacity && this.opacity <= 1;
  },
  formatHsl: function() {
    var r = this.opacity;
    return r = isNaN(r) ? 1 : Math.max(0, Math.min(1, r)), (r === 1 ? "hsl(" : "hsla(") + (this.h || 0) + ", " + (this.s || 0) * 100 + "%, " + (this.l || 0) * 100 + "%" + (r === 1 ? ")" : ", " + r + ")");
  }
}));
function k0(r, t, e) {
  return (r < 60 ? t + (e - t) * r / 60 : r < 180 ? e : r < 240 ? t + (e - t) * (240 - r) / 60 : t) * 255;
}
function xb(r) {
  return function() {
    return r;
  };
}
function s7(r, t) {
  return function(e) {
    return r + e * t;
  };
}
function u7(r, t, e) {
  return r = Math.pow(r, e), t = Math.pow(t, e) - r, e = 1 / e, function(n) {
    return Math.pow(r + n * t, e);
  };
}
function f7(r) {
  return (r = +r) == 1 ? rN : function(t, e) {
    return e - t ? u7(t, e, r) : xb(isNaN(t) ? e : t);
  };
}
function rN(r, t) {
  var e = t - r;
  return e ? s7(r, e) : xb(isNaN(r) ? t : r);
}
const jE = function r(t) {
  var e = f7(t);
  function n(i, a) {
    var o = e((i = pm(i)).r, (a = pm(a)).r), s = e(i.g, a.g), u = e(i.b, a.b), f = rN(i.opacity, a.opacity);
    return function(l) {
      return i.r = o(l), i.g = s(l), i.b = u(l), i.opacity = f(l), i + "";
    };
  }
  return n.gamma = r, n;
}(1);
function nN(r, t) {
  t || (t = []);
  var e = r ? Math.min(t.length, r.length) : 0, n = t.slice(), i;
  return function(a) {
    for (i = 0; i < e; ++i)
      n[i] = r[i] * (1 - a) + t[i] * a;
    return n;
  };
}
function iN(r) {
  return ArrayBuffer.isView(r) && !(r instanceof DataView);
}
function l7(r, t) {
  return (iN(t) ? nN : aN)(r, t);
}
function aN(r, t) {
  var e = t ? t.length : 0, n = r ? Math.min(e, r.length) : 0, i = new Array(n), a = new Array(e), o;
  for (o = 0; o < n; ++o)
    i[o] = Zv(r[o], t[o]);
  for (; o < e; ++o)
    a[o] = t[o];
  return function(s) {
    for (o = 0; o < n; ++o)
      a[o] = i[o](s);
    return a;
  };
}
function c7(r, t) {
  var e = new Date();
  return r = +r, t = +t, function(n) {
    return e.setTime(r * (1 - n) + t * n), e;
  };
}
function gm(r, t) {
  return r = +r, t = +t, function(e) {
    return r * (1 - e) + t * e;
  };
}
function h7(r, t) {
  var e = {}, n = {}, i;
  (r === null || typeof r != "object") && (r = {}), (t === null || typeof t != "object") && (t = {});
  for (i in t)
    i in r ? e[i] = Zv(r[i], t[i]) : n[i] = t[i];
  return function(a) {
    for (i in e)
      n[i] = e[i](a);
    return n;
  };
}
var ym = /[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g, L0 = new RegExp(ym.source, "g");
function d7(r) {
  return function() {
    return r;
  };
}
function v7(r) {
  return function(t) {
    return r(t) + "";
  };
}
function p7(r, t) {
  var e = ym.lastIndex = L0.lastIndex = 0, n, i, a, o = -1, s = [], u = [];
  for (r = r + "", t = t + ""; (n = ym.exec(r)) && (i = L0.exec(t)); )
    (a = i.index) > e && (a = t.slice(e, a), s[o] ? s[o] += a : s[++o] = a), (n = n[0]) === (i = i[0]) ? s[o] ? s[o] += i : s[++o] = i : (s[++o] = null, u.push({ i: o, x: gm(n, i) })), e = L0.lastIndex;
  return e < t.length && (a = t.slice(e), s[o] ? s[o] += a : s[++o] = a), s.length < 2 ? u[0] ? v7(u[0].x) : d7(t) : (t = u.length, function(f) {
    for (var l = 0, c; l < t; ++l)
      s[(c = u[l]).i] = c.x(f);
    return s.join("");
  });
}
function Zv(r, t) {
  var e = typeof t, n;
  return t == null || e === "boolean" ? xb(t) : (e === "number" ? gm : e === "string" ? (n = Nc(t)) ? (t = n, jE) : p7 : t instanceof Nc ? jE : t instanceof Date ? c7 : iN(t) ? nN : Array.isArray(t) ? aN : typeof t.valueOf != "function" && typeof t.toString != "function" || isNaN(t) ? h7 : gm)(r, t);
}
function g7(r) {
  return +r;
}
function y7(r) {
  return r * r;
}
function m7(r) {
  return r * (2 - r);
}
function $E(r) {
  return ((r *= 2) <= 1 ? r * r : --r * (2 - r) + 1) / 2;
}
function b7(r) {
  return r * r * r;
}
function x7(r) {
  return --r * r * r + 1;
}
function WE(r) {
  return ((r *= 2) <= 1 ? r * r * r : (r -= 2) * r * r + 2) / 2;
}
var _b = 3, _7 = function r(t) {
  t = +t;
  function e(n) {
    return Math.pow(n, t);
  }
  return e.exponent = r, e;
}(_b), w7 = function r(t) {
  t = +t;
  function e(n) {
    return 1 - Math.pow(1 - n, t);
  }
  return e.exponent = r, e;
}(_b), VE = function r(t) {
  t = +t;
  function e(n) {
    return ((n *= 2) <= 1 ? Math.pow(n, t) : 2 - Math.pow(2 - n, t)) / 2;
  }
  return e.exponent = r, e;
}(_b), oN = Math.PI, sN = oN / 2;
function E7(r) {
  return +r == 1 ? 1 : 1 - Math.cos(r * sN);
}
function S7(r) {
  return Math.sin(r * sN);
}
function XE(r) {
  return (1 - Math.cos(oN * r)) / 2;
}
function hs(r) {
  return (Math.pow(2, -10 * r) - 9765625e-10) * 1.0009775171065494;
}
function M7(r) {
  return hs(1 - +r);
}
function C7(r) {
  return 1 - hs(r);
}
function YE(r) {
  return ((r *= 2) <= 1 ? hs(1 - r) : 2 - hs(r - 1)) / 2;
}
function T7(r) {
  return 1 - Math.sqrt(1 - r * r);
}
function A7(r) {
  return Math.sqrt(1 - --r * r);
}
function HE(r) {
  return ((r *= 2) <= 1 ? 1 - Math.sqrt(1 - r * r) : Math.sqrt(1 - (r -= 2) * r) + 1) / 2;
}
var mm = 4 / 11, I7 = 6 / 11, P7 = 8 / 11, O7 = 3 / 4, D7 = 9 / 11, k7 = 10 / 11, L7 = 15 / 16, N7 = 21 / 22, R7 = 63 / 64, hd = 1 / mm / mm;
function B7(r) {
  return 1 - Rc(1 - r);
}
function Rc(r) {
  return (r = +r) < mm ? hd * r * r : r < P7 ? hd * (r -= I7) * r + O7 : r < k7 ? hd * (r -= D7) * r + L7 : hd * (r -= N7) * r + R7;
}
function G7(r) {
  return ((r *= 2) <= 1 ? 1 - Rc(1 - r) : Rc(r - 1) + 1) / 2;
}
var wb = 1.70158, F7 = function r(t) {
  t = +t;
  function e(n) {
    return (n = +n) * n * (t * (n - 1) + n);
  }
  return e.overshoot = r, e;
}(wb), z7 = function r(t) {
  t = +t;
  function e(n) {
    return --n * n * ((n + 1) * t + n) + 1;
  }
  return e.overshoot = r, e;
}(wb), KE = function r(t) {
  t = +t;
  function e(n) {
    return ((n *= 2) < 1 ? n * n * ((t + 1) * n - t) : (n -= 2) * n * ((t + 1) * n + t) + 2) / 2;
  }
  return e.overshoot = r, e;
}(wb), Uf = 2 * Math.PI, Eb = 1, Sb = 0.3, U7 = function r(t, e) {
  var n = Math.asin(1 / (t = Math.max(1, t))) * (e /= Uf);
  function i(a) {
    return t * hs(- --a) * Math.sin((n - a) / e);
  }
  return i.amplitude = function(a) {
    return r(a, e * Uf);
  }, i.period = function(a) {
    return r(t, a);
  }, i;
}(Eb, Sb), qE = function r(t, e) {
  var n = Math.asin(1 / (t = Math.max(1, t))) * (e /= Uf);
  function i(a) {
    return 1 - t * hs(a = +a) * Math.sin((a + n) / e);
  }
  return i.amplitude = function(a) {
    return r(a, e * Uf);
  }, i.period = function(a) {
    return r(t, a);
  }, i;
}(Eb, Sb), j7 = function r(t, e) {
  var n = Math.asin(1 / (t = Math.max(1, t))) * (e /= Uf);
  function i(a) {
    return ((a = a * 2 - 1) < 0 ? t * hs(-a) * Math.sin((n - a) / e) : 2 - t * hs(a) * Math.sin((n + a) / e)) / 2;
  }
  return i.amplitude = function(a) {
    return r(a, e * Uf);
  }, i.period = function(a) {
    return r(t, a);
  }, i;
}(Eb, Sb);
const $7 = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  easeLinear: g7,
  easeQuad: $E,
  easeQuadIn: y7,
  easeQuadOut: m7,
  easeQuadInOut: $E,
  easeCubic: WE,
  easeCubicIn: b7,
  easeCubicOut: x7,
  easeCubicInOut: WE,
  easePoly: VE,
  easePolyIn: _7,
  easePolyOut: w7,
  easePolyInOut: VE,
  easeSin: XE,
  easeSinIn: E7,
  easeSinOut: S7,
  easeSinInOut: XE,
  easeExp: YE,
  easeExpIn: M7,
  easeExpOut: C7,
  easeExpInOut: YE,
  easeCircle: HE,
  easeCircleIn: T7,
  easeCircleOut: A7,
  easeCircleInOut: HE,
  easeBounce: Rc,
  easeBounceIn: B7,
  easeBounceOut: Rc,
  easeBounceInOut: G7,
  easeBack: KE,
  easeBackIn: F7,
  easeBackOut: z7,
  easeBackInOut: KE,
  easeElastic: qE,
  easeElasticIn: U7,
  easeElasticOut: qE,
  easeElasticInOut: j7
}, Symbol.toStringTag, { value: "Module" }));
var W7 = {};
function V7(r) {
  return W7[r.toLowerCase()] || $7[r];
}
var X7 = function(r) {
  return ["fill", "stroke", "fillStyle", "strokeStyle"].includes(r);
}, Y7 = function(r) {
  return /^[r,R,L,l]{1}[\s]*\(/.test(r);
}, ZE = [1, 0, 0, 0, 1, 0, 0, 0, 1];
function H7(r, t, e) {
  var n = {}, i = t.fromAttrs, a = t.toAttrs;
  if (!r.destroyed) {
    var o;
    for (var s in a)
      if (!ls(i[s], a[s]))
        if (s === "path") {
          var u = a[s], f = i[s];
          u.length > f.length ? (u = Cf(a[s]), f = Cf(i[s]), f = FL(f, u), f = lm(f, u), t.fromAttrs.path = f, t.toAttrs.path = u) : t.pathFormatted || (u = Cf(a[s]), f = Cf(i[s]), f = lm(f, u), t.fromAttrs.path = f, t.toAttrs.path = u, t.pathFormatted = !0), n[s] = [];
          for (var l = 0; l < u.length; l++) {
            for (var c = u[l], h = f[l], d = [], v = 0; v < c.length; v++)
              At(c[v]) && h && At(h[v]) ? (o = Zv(h[v], c[v]), d.push(o(e))) : d.push(c[v]);
            n[s].push(d);
          }
        } else if (s === "matrix") {
          var p = l7(i[s] || ZE, a[s] || ZE), g = p(e);
          n[s] = g;
        } else
          X7(s) && Y7(a[s]) ? n[s] = a[s] : Ur(a[s]) || (o = Zv(i[s], a[s]), n[s] = o(e));
    r.attr(n);
  }
}
function K7(r, t, e) {
  var n = t.startTime, i = t.delay;
  if (e < n + i || t._paused)
    return !1;
  var a, o = t.duration, s = t.easing, u = V7(s);
  if (e = e - n - t.delay, t.repeat)
    a = e % o / o, a = u(a);
  else if (a = e / o, a < 1)
    a = u(a);
  else
    return t.onFrame ? r.attr(t.onFrame(1)) : r.attr(t.toAttrs), !0;
  if (t.onFrame) {
    var f = t.onFrame(a);
    r.attr(f);
  } else
    H7(r, t, a);
  return !1;
}
var q7 = function() {
  function r(t) {
    this.animators = [], this.current = 0, this.timer = null, this.canvas = t;
  }
  return r.prototype.initTimer = function() {
    var t = this, e = !1, n, i, a;
    this.timer = JL(function(o) {
      if (t.current = o, t.animators.length > 0) {
        for (var s = t.animators.length - 1; s >= 0; s--) {
          if (n = t.animators[s], n.destroyed) {
            t.removeAnimator(s);
            continue;
          }
          if (!n.isAnimatePaused()) {
            i = n.get("animations");
            for (var u = i.length - 1; u >= 0; u--)
              a = i[u], e = K7(n, a, o), e && (i.splice(u, 1), e = !1, a.callback && a.callback());
          }
          i.length === 0 && t.removeAnimator(s);
        }
        var f = t.canvas.get("autoDraw");
        f || t.canvas.draw();
      }
    });
  }, r.prototype.addAnimator = function(t) {
    this.animators.push(t);
  }, r.prototype.removeAnimator = function(t) {
    this.animators.splice(t, 1);
  }, r.prototype.isAnimating = function() {
    return !!this.animators.length;
  }, r.prototype.stop = function() {
    this.timer && this.timer.stop();
  }, r.prototype.stopAllAnimations = function(t) {
    t === void 0 && (t = !0), this.animators.forEach(function(e) {
      e.stopAnimate(t);
    }), this.animators = [], this.canvas.draw();
  }, r.prototype.getTime = function() {
    return this.current;
  }, r;
}(), Z7 = 40, QE = 0, JE = [
  "mousedown",
  "mouseup",
  "dblclick",
  "mouseout",
  "mouseover",
  "mousemove",
  "mouseleave",
  "mouseenter",
  "touchstart",
  "touchmove",
  "touchend",
  "dragenter",
  "dragover",
  "dragleave",
  "drop",
  "contextmenu",
  "mousewheel"
];
function e2(r, t, e) {
  e.name = t, e.target = r, e.currentTarget = r, e.delegateTarget = r, r.emit(t, e);
}
function Q7(r, t, e) {
  if (e.bubbles) {
    var n = void 0, i = !1;
    if (t === "mouseenter" ? (n = e.fromShape, i = !0) : t === "mouseleave" && (i = !0, n = e.toShape), r.isCanvas() && i)
      return;
    if (n && $L(r, n)) {
      e.bubbles = !1;
      return;
    }
    e.name = t, e.currentTarget = r, e.delegateTarget = r, r.emit(t, e);
  }
}
var J7 = function() {
  function r(t) {
    var e = this;
    this.draggingShape = null, this.dragging = !1, this.currentShape = null, this.mousedownShape = null, this.mousedownPoint = null, this._eventCallback = function(n) {
      var i = n.type;
      e._triggerEvent(i, n);
    }, this._onDocumentMove = function(n) {
      var i = e.canvas, a = i.get("el");
      if (a !== n.target && (e.dragging || e.currentShape)) {
        var o = e._getPointInfo(n);
        e.dragging && e._emitEvent("drag", n, o, e.draggingShape);
      }
    }, this._onDocumentMouseUp = function(n) {
      var i = e.canvas, a = i.get("el");
      if (a !== n.target && e.dragging) {
        var o = e._getPointInfo(n);
        e.draggingShape && e._emitEvent("drop", n, o, null), e._emitEvent("dragend", n, o, e.draggingShape), e._afterDrag(e.draggingShape, o, n);
      }
    }, this.canvas = t.canvas;
  }
  return r.prototype.init = function() {
    this._bindEvents();
  }, r.prototype._bindEvents = function() {
    var t = this, e = this.canvas.get("el");
    Se(JE, function(n) {
      e.addEventListener(n, t._eventCallback);
    }), document && (document.addEventListener("mousemove", this._onDocumentMove), document.addEventListener("mouseup", this._onDocumentMouseUp));
  }, r.prototype._clearEvents = function() {
    var t = this, e = this.canvas.get("el");
    Se(JE, function(n) {
      e.removeEventListener(n, t._eventCallback);
    }), document && (document.removeEventListener("mousemove", this._onDocumentMove), document.removeEventListener("mouseup", this._onDocumentMouseUp));
  }, r.prototype._getEventObj = function(t, e, n, i, a, o) {
    var s = new UL(t, e);
    return s.fromShape = a, s.toShape = o, s.x = n.x, s.y = n.y, s.clientX = n.clientX, s.clientY = n.clientY, s.propagationPath.push(i), s;
  }, r.prototype._getShape = function(t, e) {
    return this.canvas.getShape(t.x, t.y, e);
  }, r.prototype._getPointInfo = function(t) {
    var e = this.canvas, n = e.getClientByEvent(t), i = e.getPointByEvent(t);
    return {
      x: i.x,
      y: i.y,
      clientX: n.x,
      clientY: n.y
    };
  }, r.prototype._triggerEvent = function(t, e) {
    var n = this._getPointInfo(e), i = this._getShape(n, e), a = this["_on" + t], o = !1;
    if (a)
      a.call(this, n, i, e);
    else {
      var s = this.currentShape;
      t === "mouseenter" || t === "dragenter" || t === "mouseover" ? (this._emitEvent(t, e, n, null, null, i), i && this._emitEvent(t, e, n, i, null, i), t === "mouseenter" && this.draggingShape && this._emitEvent("dragenter", e, n, null)) : t === "mouseleave" || t === "dragleave" || t === "mouseout" ? (o = !0, s && this._emitEvent(t, e, n, s, s, null), this._emitEvent(t, e, n, null, s, null), t === "mouseleave" && this.draggingShape && this._emitEvent("dragleave", e, n, null)) : this._emitEvent(t, e, n, i, null, null);
    }
    if (o || (this.currentShape = i), i && !i.get("destroyed")) {
      var u = this.canvas, f = u.get("el");
      f.style.cursor = i.attr("cursor") || u.get("cursor");
    }
  }, r.prototype._onmousedown = function(t, e, n) {
    n.button === QE && (this.mousedownShape = e, this.mousedownPoint = t, this.mousedownTimeStamp = n.timeStamp), this._emitEvent("mousedown", n, t, e, null, null);
  }, r.prototype._emitMouseoverEvents = function(t, e, n, i) {
    var a = this.canvas.get("el");
    n !== i && (n && (this._emitEvent("mouseout", t, e, n, n, i), this._emitEvent("mouseleave", t, e, n, n, i), (!i || i.get("destroyed")) && (a.style.cursor = this.canvas.get("cursor"))), i && (this._emitEvent("mouseover", t, e, i, n, i), this._emitEvent("mouseenter", t, e, i, n, i)));
  }, r.prototype._emitDragoverEvents = function(t, e, n, i, a) {
    i ? (i !== n && (n && this._emitEvent("dragleave", t, e, n, n, i), this._emitEvent("dragenter", t, e, i, n, i)), a || this._emitEvent("dragover", t, e, i)) : n && this._emitEvent("dragleave", t, e, n, n, i), a && this._emitEvent("dragover", t, e, i);
  }, r.prototype._afterDrag = function(t, e, n) {
    t && (t.set("capture", !0), this.draggingShape = null), this.dragging = !1;
    var i = this._getShape(e, n);
    i !== t && this._emitMouseoverEvents(n, e, t, i), this.currentShape = i;
  }, r.prototype._onmouseup = function(t, e, n) {
    if (n.button === QE) {
      var i = this.draggingShape;
      this.dragging ? (i && this._emitEvent("drop", n, t, e), this._emitEvent("dragend", n, t, i), this._afterDrag(i, t, n)) : (this._emitEvent("mouseup", n, t, e), e === this.mousedownShape && this._emitEvent("click", n, t, e), this.mousedownShape = null, this.mousedownPoint = null);
    }
  }, r.prototype._ondragover = function(t, e, n) {
    n.preventDefault();
    var i = this.currentShape;
    this._emitDragoverEvents(n, t, i, e, !0);
  }, r.prototype._onmousemove = function(t, e, n) {
    var i = this.canvas, a = this.currentShape, o = this.draggingShape;
    if (this.dragging)
      o && this._emitDragoverEvents(n, t, a, e, !1), this._emitEvent("drag", n, t, o);
    else {
      var s = this.mousedownPoint;
      if (s) {
        var u = this.mousedownShape, f = n.timeStamp, l = f - this.mousedownTimeStamp, c = s.clientX - t.clientX, h = s.clientY - t.clientY, d = c * c + h * h;
        l > 120 || d > Z7 ? u && u.get("draggable") ? (o = this.mousedownShape, o.set("capture", !1), this.draggingShape = o, this.dragging = !0, this._emitEvent("dragstart", n, t, o), this.mousedownShape = null, this.mousedownPoint = null) : !u && i.get("draggable") ? (this.dragging = !0, this._emitEvent("dragstart", n, t, null), this.mousedownShape = null, this.mousedownPoint = null) : (this._emitMouseoverEvents(n, t, a, e), this._emitEvent("mousemove", n, t, e)) : (this._emitMouseoverEvents(n, t, a, e), this._emitEvent("mousemove", n, t, e));
      } else
        this._emitMouseoverEvents(n, t, a, e), this._emitEvent("mousemove", n, t, e);
    }
  }, r.prototype._emitEvent = function(t, e, n, i, a, o) {
    var s = this._getEventObj(t, e, n, i, a, o);
    if (i) {
      s.shape = i, e2(i, t, s);
      for (var u = i.getParent(); u; )
        u.emitDelegation(t, s), s.propagationStopped || Q7(u, t, s), s.propagationPath.push(u), u = u.getParent();
    } else {
      var f = this.canvas;
      e2(f, t, s);
    }
  }, r.prototype.destroy = function() {
    this._clearEvents(), this.canvas = null, this.currentShape = null, this.draggingShape = null, this.mousedownPoint = null, this.mousedownShape = null, this.mousedownTimeStamp = null;
  }, r;
}(), t2 = "px", r2 = WL(), eV = r2 && r2.name === "firefox", uN = function(r) {
  Ht(t, r);
  function t(e) {
    var n = r.call(this, e) || this;
    return n.initContainer(), n.initDom(), n.initEvents(), n.initTimeline(), n;
  }
  return t.prototype.getDefaultCfg = function() {
    var e = r.prototype.getDefaultCfg.call(this);
    return e.cursor = "default", e.supportCSSTransform = !1, e;
  }, t.prototype.initContainer = function() {
    var e = this.get("container");
    Qe(e) && (e = document.getElementById(e), this.set("container", e));
  }, t.prototype.initDom = function() {
    var e = this.createDom();
    this.set("el", e);
    var n = this.get("container");
    n.appendChild(e), this.setDOMSize(this.get("width"), this.get("height"));
  }, t.prototype.initEvents = function() {
    var e = new J7({
      canvas: this
    });
    e.init(), this.set("eventController", e);
  }, t.prototype.initTimeline = function() {
    var e = new q7(this);
    this.set("timeline", e);
  }, t.prototype.setDOMSize = function(e, n) {
    var i = this.get("el");
    TE && (i.style.width = e + t2, i.style.height = n + t2);
  }, t.prototype.changeSize = function(e, n) {
    this.setDOMSize(e, n), this.set("width", e), this.set("height", n), this.onCanvasChange("changeSize");
  }, t.prototype.getRenderer = function() {
    return this.get("renderer");
  }, t.prototype.getCursor = function() {
    return this.get("cursor");
  }, t.prototype.setCursor = function(e) {
    this.set("cursor", e);
    var n = this.get("el");
    TE && n && (n.style.cursor = e);
  }, t.prototype.getPointByEvent = function(e) {
    var n = this.get("supportCSSTransform");
    if (n) {
      if (eV && !Tt(e.layerX) && e.layerX !== e.offsetX)
        return {
          x: e.layerX,
          y: e.layerY
        };
      if (!Tt(e.offsetX))
        return {
          x: e.offsetX,
          y: e.offsetY
        };
    }
    var i = this.getClientByEvent(e), a = i.x, o = i.y;
    return this.getPointByClient(a, o);
  }, t.prototype.getClientByEvent = function(e) {
    var n = e;
    return e.touches && (e.type === "touchend" ? n = e.changedTouches[0] : n = e.touches[0]), {
      x: n.clientX,
      y: n.clientY
    };
  }, t.prototype.getPointByClient = function(e, n) {
    var i = this.get("el"), a = i.getBoundingClientRect();
    return {
      x: e - a.left,
      y: n - a.top
    };
  }, t.prototype.getClientByPoint = function(e, n) {
    var i = this.get("el"), a = i.getBoundingClientRect();
    return {
      x: e + a.left,
      y: n + a.top
    };
  }, t.prototype.draw = function() {
  }, t.prototype.removeDom = function() {
    var e = this.get("el");
    e.parentNode.removeChild(e);
  }, t.prototype.clearEvents = function() {
    var e = this.get("eventController");
    e.destroy();
  }, t.prototype.isCanvas = function() {
    return !0;
  }, t.prototype.getParent = function() {
    return null;
  }, t.prototype.destroy = function() {
    var e = this.get("timeline");
    this.get("destroyed") || (this.clear(), e && e.stop(), this.clearEvents(), this.removeDom(), r.prototype.destroy.call(this));
  }, t;
}(KL), fN = function(r) {
  Ht(t, r);
  function t() {
    return r !== null && r.apply(this, arguments) || this;
  }
  return t.prototype.isGroup = function() {
    return !0;
  }, t.prototype.isEntityGroup = function() {
    return !1;
  }, t.prototype.clone = function() {
    for (var e = r.prototype.clone.call(this), n = this.getChildren(), i = 0; i < n.length; i++) {
      var a = n[i];
      e.add(a.clone());
    }
    return e;
  }, t;
}(KL), lN = function(r) {
  Ht(t, r);
  function t(e) {
    return r.call(this, e) || this;
  }
  return t.prototype._isInBBox = function(e, n) {
    var i = this.getBBox();
    return i.minX <= e && i.maxX >= e && i.minY <= n && i.maxY >= n;
  }, t.prototype.afterAttrsChange = function(e) {
    r.prototype.afterAttrsChange.call(this, e), this.clearCacheBBox();
  }, t.prototype.getBBox = function() {
    var e = this.cfg.bbox;
    return e || (e = this.calculateBBox(), this.set("bbox", e)), e;
  }, t.prototype.getCanvasBBox = function() {
    var e = this.cfg.canvasBBox;
    return e || (e = this.calculateCanvasBBox(), this.set("canvasBBox", e)), e;
  }, t.prototype.applyMatrix = function(e) {
    r.prototype.applyMatrix.call(this, e), this.set("canvasBBox", null);
  }, t.prototype.calculateCanvasBBox = function() {
    var e = this.getBBox(), n = this.getTotalMatrix(), i = e.minX, a = e.minY, o = e.maxX, s = e.maxY;
    if (n) {
      var u = au(n, [e.minX, e.minY]), f = au(n, [e.maxX, e.minY]), l = au(n, [e.minX, e.maxY]), c = au(n, [e.maxX, e.maxY]);
      i = Math.min(u[0], f[0], l[0], c[0]), o = Math.max(u[0], f[0], l[0], c[0]), a = Math.min(u[1], f[1], l[1], c[1]), s = Math.max(u[1], f[1], l[1], c[1]);
    }
    var h = this.attrs;
    if (h.shadowColor) {
      var d = h.shadowBlur, v = d === void 0 ? 0 : d, p = h.shadowOffsetX, g = p === void 0 ? 0 : p, y = h.shadowOffsetY, b = y === void 0 ? 0 : y, m = i - v + g, x = o + v + g, _ = a - v + b, w = s + v + b;
      i = Math.min(i, m), o = Math.max(o, x), a = Math.min(a, _), s = Math.max(s, w);
    }
    return {
      x: i,
      y: a,
      minX: i,
      minY: a,
      maxX: o,
      maxY: s,
      width: o - i,
      height: s - a
    };
  }, t.prototype.clearCacheBBox = function() {
    this.set("bbox", null), this.set("canvasBBox", null);
  }, t.prototype.isClipShape = function() {
    return this.get("isClipShape");
  }, t.prototype.isInShape = function(e, n) {
    return !1;
  }, t.prototype.isOnlyHitBox = function() {
    return !1;
  }, t.prototype.isHit = function(e, n) {
    var i = this.get("startArrowShape"), a = this.get("endArrowShape"), o = [e, n, 1];
    o = this.invertFromMatrix(o);
    var s = o[0], u = o[1], f = this._isInBBox(s, u);
    return this.isOnlyHitBox() ? f : !!(f && !this.isClipped(s, u) && (this.isInShape(s, u) || i && i.isHit(s, u) || a && a.isHit(s, u)));
  }, t;
}(XL), cN = /* @__PURE__ */ new Map();
function Wa(r, t) {
  cN.set(r, t);
}
function hN(r) {
  return cN.get(r);
}
function dN(r) {
  var t = r.attr(), e = t.x, n = t.y, i = t.width, a = t.height;
  return {
    x: e,
    y: n,
    width: i,
    height: a
  };
}
function vN(r) {
  var t = r.attr(), e = t.x, n = t.y, i = t.r;
  return {
    x: e - i,
    y: n - i,
    width: i * 2,
    height: i * 2
  };
}
function n2(r) {
  return Math.min.apply(null, r);
}
function i2(r) {
  return Math.max.apply(null, r);
}
function Yn(r, t, e, n) {
  var i = r - e, a = t - n;
  return Math.sqrt(i * i + a * a);
}
function bv(r, t) {
  return Math.abs(r - t) < 1e-3;
}
function nl(r, t) {
  var e = n2(r), n = n2(t), i = i2(r), a = i2(t);
  return {
    x: e,
    y: n,
    width: i - e,
    height: a - n
  };
}
function Rp(r) {
  return (r + Math.PI * 2) % (Math.PI * 2);
}
const Bn = {
  box: function(r, t, e, n) {
    return nl([r, e], [t, n]);
  },
  length: function(r, t, e, n) {
    return Yn(r, t, e, n);
  },
  pointAt: function(r, t, e, n, i) {
    return {
      x: (1 - i) * r + i * e,
      y: (1 - i) * t + i * n
    };
  },
  pointDistance: function(r, t, e, n, i, a) {
    var o = (e - r) * (i - r) + (n - t) * (a - t);
    if (o < 0)
      return Yn(r, t, i, a);
    var s = (e - r) * (e - r) + (n - t) * (n - t);
    return o > s ? Yn(e, n, i, a) : this.pointToLine(r, t, e, n, i, a);
  },
  pointToLine: function(r, t, e, n, i, a) {
    var o = [e - r, n - t];
    if (ob(o, [0, 0]))
      return Math.sqrt((i - r) * (i - r) + (a - t) * (a - t));
    var s = [-o[1], o[0]];
    us(s, s);
    var u = [i - r, a - t];
    return Math.abs(ab(u, s));
  },
  tangentAngle: function(r, t, e, n) {
    return Math.atan2(n - t, e - r);
  }
};
var tV = 1e-4;
function pN(r, t, e, n, i, a) {
  var o, s = 1 / 0, u = [e, n], f = 20;
  a && a > 200 && (f = a / 10);
  for (var l = 1 / f, c = l / 10, h = 0; h <= f; h++) {
    var d = h * l, v = [i.apply(null, r.concat([d])), i.apply(null, t.concat([d]))], p = Yn(u[0], u[1], v[0], v[1]);
    p < s && (o = d, s = p);
  }
  if (o === 0)
    return {
      x: r[0],
      y: t[0]
    };
  if (o === 1) {
    var g = r.length;
    return {
      x: r[g - 1],
      y: t[g - 1]
    };
  }
  s = 1 / 0;
  for (var h = 0; h < 32 && !(c < tV); h++) {
    var y = o - c, b = o + c, v = [i.apply(null, r.concat([y])), i.apply(null, t.concat([y]))], p = Yn(u[0], u[1], v[0], v[1]);
    if (y >= 0 && p < s)
      o = y, s = p;
    else {
      var m = [i.apply(null, r.concat([b])), i.apply(null, t.concat([b]))], x = Yn(u[0], u[1], m[0], m[1]);
      b <= 1 && x < s ? (o = b, s = x) : c *= 0.5;
    }
  }
  return {
    x: i.apply(null, r.concat([o])),
    y: i.apply(null, t.concat([o]))
  };
}
function rV(r, t) {
  for (var e = 0, n = r.length, i = 0; i < n; i++) {
    var a = r[i], o = t[i], s = r[(i + 1) % n], u = t[(i + 1) % n];
    e += Yn(a, o, s, u);
  }
  return e / 2;
}
function Qo(r, t, e, n) {
  var i = 1 - n;
  return i * i * r + 2 * n * i * t + n * n * e;
}
function a2(r, t, e) {
  var n = r + e - 2 * t;
  if (bv(n, 0))
    return [0.5];
  var i = (r - t) / n;
  return i <= 1 && i >= 0 ? [i] : [];
}
function o2(r, t, e, n) {
  return 2 * (1 - n) * (t - r) + 2 * n * (e - t);
}
function gN(r, t, e, n, i, a, o) {
  var s = Qo(r, e, i, o), u = Qo(t, n, a, o), f = Bn.pointAt(r, t, e, n, o), l = Bn.pointAt(e, n, i, a, o);
  return [
    [r, t, f.x, f.y, s, u],
    [s, u, l.x, l.y, i, a]
  ];
}
function bm(r, t, e, n, i, a, o) {
  if (o === 0)
    return (Yn(r, t, e, n) + Yn(e, n, i, a) + Yn(r, t, i, a)) / 2;
  var s = gN(r, t, e, n, i, a, 0.5), u = s[0], f = s[1];
  return u.push(o - 1), f.push(o - 1), bm.apply(null, u) + bm.apply(null, f);
}
const yN = {
  box: function(r, t, e, n, i, a) {
    var o = a2(r, e, i)[0], s = a2(t, n, a)[0], u = [r, i], f = [t, a];
    return o !== void 0 && u.push(Qo(r, e, i, o)), s !== void 0 && f.push(Qo(t, n, a, s)), nl(u, f);
  },
  length: function(r, t, e, n, i, a) {
    return bm(r, t, e, n, i, a, 3);
  },
  nearestPoint: function(r, t, e, n, i, a, o, s) {
    return pN([r, e, i], [t, n, a], o, s, Qo);
  },
  pointDistance: function(r, t, e, n, i, a, o, s) {
    var u = this.nearestPoint(r, t, e, n, i, a, o, s);
    return Yn(u.x, u.y, o, s);
  },
  interpolationAt: Qo,
  pointAt: function(r, t, e, n, i, a, o) {
    return {
      x: Qo(r, e, i, o),
      y: Qo(t, n, a, o)
    };
  },
  divide: function(r, t, e, n, i, a, o) {
    return gN(r, t, e, n, i, a, o);
  },
  tangentAngle: function(r, t, e, n, i, a, o) {
    var s = o2(r, e, i, o), u = o2(t, n, a, o), f = Math.atan2(u, s);
    return Rp(f);
  }
};
function Jo(r, t, e, n, i) {
  var a = 1 - i;
  return a * a * a * r + 3 * t * i * a * a + 3 * e * i * i * a + n * i * i * i;
}
function s2(r, t, e, n, i) {
  var a = 1 - i;
  return 3 * (a * a * (t - r) + 2 * a * i * (e - t) + i * i * (n - e));
}
function N0(r, t, e, n) {
  var i = -3 * r + 9 * t - 9 * e + 3 * n, a = 6 * r - 12 * t + 6 * e, o = 3 * t - 3 * r, s = [], u, f, l;
  if (bv(i, 0))
    bv(a, 0) || (u = -o / a, u >= 0 && u <= 1 && s.push(u));
  else {
    var c = a * a - 4 * i * o;
    bv(c, 0) ? s.push(-a / (2 * i)) : c > 0 && (l = Math.sqrt(c), u = (-a + l) / (2 * i), f = (-a - l) / (2 * i), u >= 0 && u <= 1 && s.push(u), f >= 0 && f <= 1 && s.push(f));
  }
  return s;
}
function mN(r, t, e, n, i, a, o, s, u) {
  var f = Jo(r, e, i, o, u), l = Jo(t, n, a, s, u), c = Bn.pointAt(r, t, e, n, u), h = Bn.pointAt(e, n, i, a, u), d = Bn.pointAt(i, a, o, s, u), v = Bn.pointAt(c.x, c.y, h.x, h.y, u), p = Bn.pointAt(h.x, h.y, d.x, d.y, u);
  return [
    [r, t, c.x, c.y, v.x, v.y, f, l],
    [f, l, p.x, p.y, d.x, d.y, o, s]
  ];
}
function xm(r, t, e, n, i, a, o, s, u) {
  if (u === 0)
    return rV([r, e, i, o], [t, n, a, s]);
  var f = mN(r, t, e, n, i, a, o, s, 0.5), l = f[0], c = f[1];
  return l.push(u - 1), c.push(u - 1), xm.apply(null, l) + xm.apply(null, c);
}
const vc = {
  extrema: N0,
  box: function(r, t, e, n, i, a, o, s) {
    for (var u = [r, o], f = [t, s], l = N0(r, e, i, o), c = N0(t, n, a, s), h = 0; h < l.length; h++)
      u.push(Jo(r, e, i, o, l[h]));
    for (var h = 0; h < c.length; h++)
      f.push(Jo(t, n, a, s, c[h]));
    return nl(u, f);
  },
  length: function(r, t, e, n, i, a, o, s) {
    return xm(r, t, e, n, i, a, o, s, 3);
  },
  nearestPoint: function(r, t, e, n, i, a, o, s, u, f, l) {
    return pN([r, e, i, o], [t, n, a, s], u, f, Jo, l);
  },
  pointDistance: function(r, t, e, n, i, a, o, s, u, f, l) {
    var c = this.nearestPoint(r, t, e, n, i, a, o, s, u, f, l);
    return Yn(c.x, c.y, u, f);
  },
  interpolationAt: Jo,
  pointAt: function(r, t, e, n, i, a, o, s, u) {
    return {
      x: Jo(r, e, i, o, u),
      y: Jo(t, n, a, s, u)
    };
  },
  divide: function(r, t, e, n, i, a, o, s, u) {
    return mN(r, t, e, n, i, a, o, s, u);
  },
  tangentAngle: function(r, t, e, n, i, a, o, s, u) {
    var f = s2(r, e, i, o, u), l = s2(t, n, a, s, u);
    return Rp(Math.atan2(l, f));
  }
};
function u2(r, t) {
  var e = Math.abs(r);
  return t > 0 ? e : e * -1;
}
const nV = {
  box: function(r, t, e, n) {
    return {
      x: r - e,
      y: t - n,
      width: e * 2,
      height: n * 2
    };
  },
  length: function(r, t, e, n) {
    return Math.PI * (3 * (e + n) - Math.sqrt((3 * e + n) * (e + 3 * n)));
  },
  nearestPoint: function(r, t, e, n, i, a) {
    var o = e, s = n;
    if (o === 0 || s === 0)
      return {
        x: r,
        y: t
      };
    for (var u = i - r, f = a - t, l = Math.abs(u), c = Math.abs(f), h = o * o, d = s * s, v = Math.PI / 4, p, g, y = 0; y < 4; y++) {
      p = o * Math.cos(v), g = s * Math.sin(v);
      var b = (h - d) * Math.pow(Math.cos(v), 3) / o, m = (d - h) * Math.pow(Math.sin(v), 3) / s, x = p - b, _ = g - m, w = l - b, E = c - m, M = Math.hypot(_, x), C = Math.hypot(E, w), S = M * Math.asin((x * E - _ * w) / (M * C)), A = S / Math.sqrt(h + d - p * p - g * g);
      v += A, v = Math.min(Math.PI / 2, Math.max(0, v));
    }
    return {
      x: r + u2(p, u),
      y: t + u2(g, f)
    };
  },
  pointDistance: function(r, t, e, n, i, a) {
    var o = this.nearestPoint(r, t, e, n, i, a);
    return Yn(o.x, o.y, i, a);
  },
  pointAt: function(r, t, e, n, i) {
    var a = 2 * Math.PI * i;
    return {
      x: r + e * Math.cos(a),
      y: t + n * Math.sin(a)
    };
  },
  tangentAngle: function(r, t, e, n, i) {
    var a = 2 * Math.PI * i, o = Math.atan2(n * Math.cos(a), -e * Math.sin(a));
    return Rp(o);
  }
};
function iV(r, t, e, n, i, a, o, s) {
  return -1 * e * Math.cos(i) * Math.sin(s) - n * Math.sin(i) * Math.cos(s);
}
function aV(r, t, e, n, i, a, o, s) {
  return -1 * e * Math.sin(i) * Math.sin(s) + n * Math.cos(i) * Math.cos(s);
}
function oV(r, t, e) {
  return Math.atan(-t / r * Math.tan(e));
}
function sV(r, t, e) {
  return Math.atan(t / (r * Math.tan(e)));
}
function f2(r, t, e, n, i, a) {
  return e * Math.cos(i) * Math.cos(a) - n * Math.sin(i) * Math.sin(a) + r;
}
function l2(r, t, e, n, i, a) {
  return e * Math.sin(i) * Math.cos(a) + n * Math.cos(i) * Math.sin(a) + t;
}
function uV(r, t, e, n) {
  var i = Math.atan2(n * r, e * t);
  return (i + Math.PI * 2) % (Math.PI * 2);
}
function c2(r, t, e) {
  return {
    x: r * Math.cos(e),
    y: t * Math.sin(e)
  };
}
function h2(r, t, e) {
  var n = Math.cos(e), i = Math.sin(e);
  return [r * n - t * i, r * i + t * n];
}
const fV = {
  box: function(r, t, e, n, i, a, o) {
    for (var s = oV(e, n, i), u = 1 / 0, f = -1 / 0, l = [a, o], c = -Math.PI * 2; c <= Math.PI * 2; c += Math.PI) {
      var h = s + c;
      a < o ? a < h && h < o && l.push(h) : o < h && h < a && l.push(h);
    }
    for (var c = 0; c < l.length; c++) {
      var d = f2(r, t, e, n, i, l[c]);
      d < u && (u = d), d > f && (f = d);
    }
    for (var v = sV(e, n, i), p = 1 / 0, g = -1 / 0, y = [a, o], c = -Math.PI * 2; c <= Math.PI * 2; c += Math.PI) {
      var b = v + c;
      a < o ? a < b && b < o && y.push(b) : o < b && b < a && y.push(b);
    }
    for (var c = 0; c < y.length; c++) {
      var m = l2(r, t, e, n, i, y[c]);
      m < p && (p = m), m > g && (g = m);
    }
    return {
      x: u,
      y: p,
      width: f - u,
      height: g - p
    };
  },
  length: function(r, t, e, n, i, a, o) {
  },
  nearestPoint: function(r, t, e, n, i, a, o, s, u) {
    var f = h2(s - r, u - t, -i), l = f[0], c = f[1], h = nV.nearestPoint(0, 0, e, n, l, c), d = uV(e, n, h.x, h.y);
    d < a ? h = c2(e, n, a) : d > o && (h = c2(e, n, o));
    var v = h2(h.x, h.y, i);
    return {
      x: v[0] + r,
      y: v[1] + t
    };
  },
  pointDistance: function(r, t, e, n, i, a, o, s, u) {
    var f = this.nearestPoint(r, t, e, n, s, u);
    return Yn(f.x, f.y, s, u);
  },
  pointAt: function(r, t, e, n, i, a, o, s) {
    var u = (o - a) * s + a;
    return {
      x: f2(r, t, e, n, i, u),
      y: l2(r, t, e, n, i, u)
    };
  },
  tangentAngle: function(r, t, e, n, i, a, o, s) {
    var u = (o - a) * s + a, f = iV(r, t, e, n, i, a, o, u), l = aV(r, t, e, n, i, a, o, u);
    return Rp(Math.atan2(l, f));
  }
};
function bN(r) {
  for (var t = 0, e = [], n = 0; n < r.length - 1; n++) {
    var i = r[n], a = r[n + 1], o = Yn(i[0], i[1], a[0], a[1]), s = {
      from: i,
      to: a,
      length: o
    };
    e.push(s), t += o;
  }
  return { segments: e, totalLength: t };
}
function lV(r) {
  if (r.length < 2)
    return 0;
  for (var t = 0, e = 0; e < r.length - 1; e++) {
    var n = r[e], i = r[e + 1];
    t += Yn(n[0], n[1], i[0], i[1]);
  }
  return t;
}
function cV(r, t) {
  if (t > 1 || t < 0 || r.length < 2)
    return null;
  var e = bN(r), n = e.segments, i = e.totalLength;
  if (i === 0)
    return {
      x: r[0][0],
      y: r[0][1]
    };
  for (var a = 0, o = null, s = 0; s < n.length; s++) {
    var u = n[s], f = u.from, l = u.to, c = u.length / i;
    if (t >= a && t <= a + c) {
      var h = (t - a) / c;
      o = Bn.pointAt(f[0], f[1], l[0], l[1], h);
      break;
    }
    a += c;
  }
  return o;
}
function hV(r, t) {
  if (t > 1 || t < 0 || r.length < 2)
    return 0;
  for (var e = bN(r), n = e.segments, i = e.totalLength, a = 0, o = 0, s = 0; s < n.length; s++) {
    var u = n[s], f = u.from, l = u.to, c = u.length / i;
    if (t >= a && t <= a + c) {
      o = Math.atan2(l[1] - f[1], l[0] - f[0]);
      break;
    }
    a += c;
  }
  return o;
}
function dV(r, t, e) {
  for (var n = 1 / 0, i = 0; i < r.length - 1; i++) {
    var a = r[i], o = r[i + 1], s = Bn.pointDistance(a[0], a[1], o[0], o[1], t, e);
    s < n && (n = s);
  }
  return n;
}
const xN = {
  box: function(r) {
    for (var t = [], e = [], n = 0; n < r.length; n++) {
      var i = r[n];
      t.push(i[0]), e.push(i[1]);
    }
    return nl(t, e);
  },
  length: function(r) {
    return lV(r);
  },
  pointAt: function(r, t) {
    return cV(r, t);
  },
  pointDistance: function(r, t, e) {
    return dV(r, t, e);
  },
  tangentAngle: function(r, t) {
    return hV(r, t);
  }
};
function d2(r, t) {
  return !r || !t ? r || t : {
    minX: Math.min(r.minX, t.minX),
    minY: Math.min(r.minY, t.minY),
    maxX: Math.max(r.maxX, t.maxX),
    maxY: Math.max(r.maxY, t.maxY)
  };
}
function Mb(r, t) {
  var e = r.get("startArrowShape"), n = r.get("endArrowShape"), i = null, a = null;
  return e && (i = e.getCanvasBBox(), t = d2(t, i)), n && (a = n.getCanvasBBox(), t = d2(t, a)), t;
}
function vV(r) {
  for (var t = r.attr(), e = t.points, n = [], i = [], a = 0; a < e.length; a++) {
    var o = e[a];
    n.push(o[0]), i.push(o[1]);
  }
  var s = nl(n, i), u = s.x, f = s.y, l = s.width, c = s.height, h = {
    minX: u,
    minY: f,
    maxX: u + l,
    maxY: f + c
  };
  return h = Mb(r, h), {
    x: h.minX,
    y: h.minY,
    width: h.maxX - h.minX,
    height: h.maxY - h.minY
  };
}
function pV(r) {
  for (var t = r.attr(), e = t.points, n = [], i = [], a = 0; a < e.length; a++) {
    var o = e[a];
    n.push(o[0]), i.push(o[1]);
  }
  return nl(n, i);
}
var R0 = null;
function _N() {
  if (!R0) {
    var r = document.createElement("canvas");
    r.width = 1, r.height = 1, R0 = r.getContext("2d");
  }
  return R0;
}
function wN(r, t, e) {
  var n = 1;
  if (Qe(r) && (n = r.split(`
`).length), n > 1) {
    var i = gV(t, e);
    return t * n + i * (n - 1);
  }
  return t;
}
function gV(r, t) {
  return t ? t - r : r * 0.14;
}
function yV(r, t) {
  var e = _N(), n = 0;
  if (Tt(r) || r === "")
    return n;
  if (e.save(), e.font = t, Qe(r) && r.includes(`
`)) {
    var i = r.split(`
`);
    Se(i, function(a) {
      var o = e.measureText(a).width;
      n < o && (n = o);
    });
  } else
    n = e.measureText(r).width;
  return e.restore(), n;
}
function EN(r) {
  var t = r.fontSize, e = r.fontFamily, n = r.fontWeight, i = r.fontStyle, a = r.fontVariant;
  return [i, a, n, t + "px", e].join(" ").trim();
}
function mV(r) {
  var t = r.attr(), e = t.x, n = t.y, i = t.text, a = t.fontSize, o = t.lineHeight, s = t.font;
  s || (s = EN(t));
  var u = yV(i, s), f;
  if (!u)
    f = {
      x: e,
      y: n,
      width: 0,
      height: 0
    };
  else {
    var l = t.textAlign, c = t.textBaseline, h = wN(i, a, o), d = {
      x: e,
      y: n - h
    };
    l && (l === "end" || l === "right" ? d.x -= u : l === "center" && (d.x -= u / 2)), c && (c === "top" ? d.y += h : c === "middle" && (d.y += h / 2)), f = {
      x: d.x,
      y: d.y,
      width: u,
      height: h
    };
  }
  return f;
}
var bV = /[MLHVQTCSAZ]([^MLHVQTCSAZ]*)/ig, xV = /[^\s\,]+/ig;
function _V(r) {
  var t = r || [];
  if (Dt(t))
    return t;
  if (Qe(t))
    return t = t.match(bV), Se(t, function(e, n) {
      if (e = e.match(xV), e[0].length > 1) {
        var i = e[0].charAt(0);
        e.splice(1, 0, e[0].substr(1)), e[0] = i;
      }
      Se(e, function(a, o) {
        isNaN(a) || (e[o] = +a);
      }), t[n] = e;
    }), t;
}
function wV(r, t, e, n) {
  var i = [], a = !!n, o, s, u, f, l, c, h;
  if (a) {
    u = n[0], f = n[1];
    for (var d = 0, v = r.length; d < v; d += 1) {
      var p = r[d];
      u = Ho([0, 0], u, p), f = Ko([0, 0], f, p);
    }
  }
  for (var d = 0, g = r.length; d < g; d += 1) {
    var p = r[d];
    if (d === 0 && !e)
      h = p;
    else if (d === g - 1 && !e)
      c = p, i.push(h), i.push(c);
    else {
      var y = [d ? d - 1 : g - 1, d - 1][e ? 0 : 1];
      o = r[y], s = r[e ? (d + 1) % g : d + 1];
      var b = [0, 0];
      b = dv(b, s, o), b = Vn(b, b, t);
      var m = Uv(p, o), x = Uv(p, s), _ = m + x;
      _ !== 0 && (m /= _, x /= _);
      var w = Vn([0, 0], b, -m), E = Vn([0, 0], b, x);
      c = Dn([0, 0], p, w), l = Dn([0, 0], p, E), l = Ho([0, 0], l, Ko([0, 0], s, p)), l = Ko([0, 0], l, Ho([0, 0], s, p)), w = dv([0, 0], l, p), w = Vn([0, 0], w, -m / x), c = Dn([0, 0], p, w), c = Ho([0, 0], c, Ko([0, 0], o, p)), c = Ko([0, 0], c, Ho([0, 0], o, p)), E = dv([0, 0], p, c), E = Vn([0, 0], E, x / m), l = Dn([0, 0], p, E), a && (c = Ko([0, 0], c, u), c = Ho([0, 0], c, f), l = Ko([0, 0], l, u), l = Ho([0, 0], l, f)), i.push(h), i.push(c), h = l;
    }
  }
  return e && i.push(i.shift()), i;
}
function SN(r, t, e) {
  t === void 0 && (t = !1), e === void 0 && (e = [
    [0, 0],
    [1, 1]
  ]);
  for (var n = !!t, i = [], a = 0, o = r.length; a < o; a += 2)
    i.push([r[a], r[a + 1]]);
  for (var s = wV(i, 0.4, n, e), u = i.length, f = [], l, c, h, a = 0; a < u - 1; a += 1)
    l = s[a * 2], c = s[a * 2 + 1], h = i[a + 1], f.push(["C", l[0], l[1], c[0], c[1], h[0], h[1]]);
  return n && (l = s[u], c = s[u + 1], h = i[0], f.push(["C", l[0], l[1], c[0], c[1], h[0], h[1]])), f;
}
var pc = `	
\v\f\r \xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029`, EV = new RegExp("([a-z])[" + pc + ",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?[" + pc + "]*,?[" + pc + "]*)+)", "ig"), SV = new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)[" + pc + "]*,?[" + pc + "]*", "ig");
function _m(r) {
  if (!r)
    return null;
  if (Dt(r))
    return r;
  var t = {
    a: 7,
    c: 6,
    o: 2,
    h: 1,
    l: 2,
    m: 2,
    r: 4,
    q: 4,
    s: 4,
    t: 2,
    v: 1,
    u: 3,
    z: 0
  }, e = [];
  return String(r).replace(EV, function(n, i, a) {
    var o = [], s = i.toLowerCase();
    if (a.replace(SV, function(u, f) {
      f && o.push(+f);
    }), s === "m" && o.length > 2 && (e.push([i].concat(o.splice(0, 2))), s = "l", i = i === "m" ? "l" : "L"), s === "o" && o.length === 1 && e.push([i, o[0]]), s === "r")
      e.push([i].concat(o));
    else
      for (; o.length >= t[s] && (e.push([i].concat(o.splice(0, t[s]))), !!t[s]); )
        ;
    return "";
  }), e;
}
var MV = /[a-z]/;
function v2(r, t) {
  return [
    t[0] + (t[0] - r[0]),
    t[1] + (t[1] - r[1])
  ];
}
function MN(r) {
  var t = _m(r);
  if (!t || !t.length)
    return [
      ["M", 0, 0]
    ];
  for (var e = !1, n = 0; n < t.length; n++) {
    var i = t[n][0];
    if (MV.test(i) || ["V", "H", "T", "S"].indexOf(i) >= 0) {
      e = !0;
      break;
    }
  }
  if (!e)
    return t;
  var a = [], o = 0, s = 0, u = 0, f = 0, l = 0, c = t[0];
  (c[0] === "M" || c[0] === "m") && (o = +c[1], s = +c[2], u = o, f = s, l++, a[0] = ["M", o, s]);
  for (var n = l, h = t.length; n < h; n++) {
    var d = t[n], v = a[n - 1], p = [], i = d[0], g = i.toUpperCase();
    if (i !== g)
      switch (p[0] = g, g) {
        case "A":
          p[1] = d[1], p[2] = d[2], p[3] = d[3], p[4] = d[4], p[5] = d[5], p[6] = +d[6] + o, p[7] = +d[7] + s;
          break;
        case "V":
          p[1] = +d[1] + s;
          break;
        case "H":
          p[1] = +d[1] + o;
          break;
        case "M":
          u = +d[1] + o, f = +d[2] + s, p[1] = u, p[2] = f;
          break;
        default:
          for (var y = 1, b = d.length; y < b; y++)
            p[y] = +d[y] + (y % 2 ? o : s);
      }
    else
      p = t[n];
    switch (g) {
      case "Z":
        o = +u, s = +f;
        break;
      case "H":
        o = p[1], p = ["L", o, s];
        break;
      case "V":
        s = p[1], p = ["L", o, s];
        break;
      case "T":
        o = p[1], s = p[2];
        var m = v2([v[1], v[2]], [v[3], v[4]]);
        p = ["Q", m[0], m[1], o, s];
        break;
      case "S":
        o = p[p.length - 2], s = p[p.length - 1];
        var x = v.length, _ = v2([v[x - 4], v[x - 3]], [v[x - 2], v[x - 1]]);
        p = ["C", _[0], _[1], p[1], p[2], o, s];
        break;
      case "M":
        u = p[p.length - 2], f = p[p.length - 1];
        break;
      default:
        o = p[p.length - 2], s = p[p.length - 1];
    }
    a.push(p);
  }
  return a;
}
function dd(r) {
  return Math.sqrt(r[0] * r[0] + r[1] * r[1]);
}
function wm(r, t) {
  return dd(r) * dd(t) ? (r[0] * t[0] + r[1] * t[1]) / (dd(r) * dd(t)) : 1;
}
function p2(r, t) {
  return (r[0] * t[1] < r[1] * t[0] ? -1 : 1) * Math.acos(wm(r, t));
}
function Em(r, t) {
  return r[0] === t[0] && r[1] === t[1];
}
function CV(r, t) {
  var e = t[1], n = t[2], i = Ip(Pp(t[3]), Math.PI * 2), a = t[4], o = t[5], s = r[0], u = r[1], f = t[6], l = t[7], c = Math.cos(i) * (s - f) / 2 + Math.sin(i) * (u - l) / 2, h = -1 * Math.sin(i) * (s - f) / 2 + Math.cos(i) * (u - l) / 2, d = c * c / (e * e) + h * h / (n * n);
  d > 1 && (e *= Math.sqrt(d), n *= Math.sqrt(d));
  var v = e * e * (h * h) + n * n * (c * c), p = v ? Math.sqrt((e * e * (n * n) - v) / v) : 1;
  a === o && (p *= -1), isNaN(p) && (p = 0);
  var g = n ? p * e * h / n : 0, y = e ? p * -n * c / e : 0, b = (s + f) / 2 + Math.cos(i) * g - Math.sin(i) * y, m = (u + l) / 2 + Math.sin(i) * g + Math.cos(i) * y, x = [(c - g) / e, (h - y) / n], _ = [(-1 * c - g) / e, (-1 * h - y) / n], w = p2([1, 0], x), E = p2(x, _);
  return wm(x, _) <= -1 && (E = Math.PI), wm(x, _) >= 1 && (E = 0), o === 0 && E > 0 && (E = E - 2 * Math.PI), o === 1 && E < 0 && (E = E + 2 * Math.PI), {
    cx: b,
    cy: m,
    rx: Em(r, [f, l]) ? 0 : e,
    ry: Em(r, [f, l]) ? 0 : n,
    startAngle: w,
    endAngle: w + E,
    xRotation: i,
    arcFlag: a,
    sweepFlag: o
  };
}
function g2(r, t) {
  return [t[0] + (t[0] - r[0]), t[1] + (t[1] - r[1])];
}
function CN(r) {
  r = _V(r);
  for (var t = [], e = null, n = null, i = null, a = 0, o = r.length, s = 0; s < o; s++) {
    var u = r[s];
    n = r[s + 1];
    var f = u[0], l = {
      command: f,
      prePoint: e,
      params: u,
      startTangent: null,
      endTangent: null
    };
    switch (f) {
      case "M":
        i = [u[1], u[2]], a = s;
        break;
      case "A":
        var c = CV(e, u);
        l.arcParams = c;
        break;
    }
    if (f === "Z")
      e = i, n = r[a + 1];
    else {
      var h = u.length;
      e = [u[h - 2], u[h - 1]];
    }
    n && n[0] === "Z" && (n = r[a], t[a] && (t[a].prePoint = e)), l.currentPoint = e, t[a] && Em(e, t[a].currentPoint) && (t[a].prePoint = l.prePoint);
    var d = n ? [n[n.length - 2], n[n.length - 1]] : null;
    l.nextPoint = d;
    var v = l.prePoint;
    if (["L", "H", "V"].includes(f))
      l.startTangent = [v[0] - e[0], v[1] - e[1]], l.endTangent = [e[0] - v[0], e[1] - v[1]];
    else if (f === "Q") {
      var p = [u[1], u[2]];
      l.startTangent = [v[0] - p[0], v[1] - p[1]], l.endTangent = [e[0] - p[0], e[1] - p[1]];
    } else if (f === "T") {
      var g = t[s - 1], p = g2(g.currentPoint, v);
      g.command === "Q" ? (l.command = "Q", l.startTangent = [v[0] - p[0], v[1] - p[1]], l.endTangent = [e[0] - p[0], e[1] - p[1]]) : (l.command = "TL", l.startTangent = [v[0] - e[0], v[1] - e[1]], l.endTangent = [e[0] - v[0], e[1] - v[1]]);
    } else if (f === "C") {
      var y = [u[1], u[2]], b = [u[3], u[4]];
      l.startTangent = [v[0] - y[0], v[1] - y[1]], l.endTangent = [e[0] - b[0], e[1] - b[1]], l.startTangent[0] === 0 && l.startTangent[1] === 0 && (l.startTangent = [y[0] - b[0], y[1] - b[1]]), l.endTangent[0] === 0 && l.endTangent[1] === 0 && (l.endTangent = [b[0] - y[0], b[1] - y[1]]);
    } else if (f === "S") {
      var g = t[s - 1], y = g2(g.currentPoint, v), b = [u[1], u[2]];
      g.command === "C" ? (l.command = "C", l.startTangent = [v[0] - y[0], v[1] - y[1]], l.endTangent = [e[0] - b[0], e[1] - b[1]]) : (l.command = "SQ", l.startTangent = [v[0] - b[0], v[1] - b[1]], l.endTangent = [e[0] - b[0], e[1] - b[1]]);
    } else if (f === "A") {
      var m = 1e-3, x = l.arcParams || {}, _ = x.cx, w = _ === void 0 ? 0 : _, E = x.cy, M = E === void 0 ? 0 : E, C = x.rx, S = C === void 0 ? 0 : C, A = x.ry, T = A === void 0 ? 0 : A, P = x.sweepFlag, k = P === void 0 ? 0 : P, L = x.startAngle, O = L === void 0 ? 0 : L, D = x.endAngle, G = D === void 0 ? 0 : D;
      k === 0 && (m *= -1);
      var R = S * Math.cos(O - m) + w, F = T * Math.sin(O - m) + M;
      l.startTangent = [R - i[0], F - i[1]];
      var q = S * Math.cos(O + G + m) + w, ne = T * Math.sin(O + G - m) + M;
      l.endTangent = [v[0] - q, v[1] - ne];
    }
    t.push(l);
  }
  return t;
}
function TV(r, t) {
  for (var e = [], n = [], i = [], a = 0; a < r.length; a++) {
    var o = r[a], s = o.currentPoint, u = o.params, f = o.prePoint, l = void 0;
    switch (o.command) {
      case "Q":
        l = yN.box(f[0], f[1], u[1], u[2], u[3], u[4]);
        break;
      case "C":
        l = vc.box(f[0], f[1], u[1], u[2], u[3], u[4], u[5], u[6]);
        break;
      case "A":
        var c = o.arcParams;
        l = fV.box(c.cx, c.cy, c.rx, c.ry, c.xRotation, c.startAngle, c.endAngle);
        break;
      default:
        e.push(s[0]), n.push(s[1]);
        break;
    }
    l && (o.box = l, e.push(l.x, l.x + l.width), n.push(l.y, l.y + l.height)), t && (o.command === "L" || o.command === "M") && o.prePoint && o.nextPoint && i.push(o);
  }
  e = e.filter(function(y) {
    return !Number.isNaN(y) && y !== 1 / 0 && y !== -1 / 0;
  }), n = n.filter(function(y) {
    return !Number.isNaN(y) && y !== 1 / 0 && y !== -1 / 0;
  });
  var h = Fi(e), d = Fi(n), v = Gi(e), p = Gi(n);
  if (i.length === 0)
    return {
      x: h,
      y: d,
      width: v - h,
      height: p - d
    };
  for (var a = 0; a < i.length; a++) {
    var o = i[a], s = o.currentPoint, g = void 0;
    s[0] === h ? (g = vd(o, t), h = h - g.xExtra) : s[0] === v && (g = vd(o, t), v = v + g.xExtra), s[1] === d ? (g = vd(o, t), d = d - g.yExtra) : s[1] === p && (g = vd(o, t), p = p + g.yExtra);
  }
  return {
    x: h,
    y: d,
    width: v - h,
    height: p - d
  };
}
function vd(r, t) {
  var e = r.prePoint, n = r.currentPoint, i = r.nextPoint, a = Math.pow(n[0] - e[0], 2) + Math.pow(n[1] - e[1], 2), o = Math.pow(n[0] - i[0], 2) + Math.pow(n[1] - i[1], 2), s = Math.pow(e[0] - i[0], 2) + Math.pow(e[1] - i[1], 2), u = Math.acos((a + o - s) / (2 * Math.sqrt(a) * Math.sqrt(o)));
  if (!u || Math.sin(u) === 0 || PD(u, 0))
    return {
      xExtra: 0,
      yExtra: 0
    };
  var f = Math.abs(Math.atan2(i[1] - n[1], i[0] - n[0])), l = Math.abs(Math.atan2(i[0] - n[0], i[1] - n[1]));
  f = f > Math.PI / 2 ? Math.PI - f : f, l = l > Math.PI / 2 ? Math.PI - l : l;
  var c = {
    xExtra: Math.cos(u / 2 - f) * (t / 2 * (1 / Math.sin(u / 2))) - t / 2 || 0,
    yExtra: Math.cos(l - u / 2) * (t / 2 * (1 / Math.sin(u / 2))) - t / 2 || 0
  };
  return c;
}
function AV(r) {
  var t = r.attr(), e = t.path, n = t.stroke, i = n ? t.lineWidth : 0, a = r.get("segments") || CN(e), o = TV(a, i), s = o.x, u = o.y, f = o.width, l = o.height, c = {
    minX: s,
    minY: u,
    maxX: s + f,
    maxY: u + l
  };
  return c = Mb(r, c), {
    x: c.minX,
    y: c.minY,
    width: c.maxX - c.minX,
    height: c.maxY - c.minY
  };
}
function IV(r) {
  var t = r.attr(), e = t.x1, n = t.y1, i = t.x2, a = t.y2, o = Math.min(e, i), s = Math.max(e, i), u = Math.min(n, a), f = Math.max(n, a), l = {
    minX: o,
    maxX: s,
    minY: u,
    maxY: f
  };
  return l = Mb(r, l), {
    x: l.minX,
    y: l.minY,
    width: l.maxX - l.minX,
    height: l.maxY - l.minY
  };
}
function PV(r) {
  var t = r.attr(), e = t.x, n = t.y, i = t.rx, a = t.ry;
  return {
    x: e - i,
    y: n - a,
    width: i * 2,
    height: a * 2
  };
}
Wa("rect", dN);
Wa("image", dN);
Wa("circle", vN);
Wa("marker", vN);
Wa("polyline", vV);
Wa("polygon", pV);
Wa("text", mV);
Wa("path", AV);
Wa("line", IV);
Wa("ellipse", PV);
var OV = function(r) {
  Ht(t, r);
  function t(e, n) {
    var i = r.call(this, e, n) || this;
    return i.item = n.item, i.canvasX = n.canvasX, i.canvasY = n.canvasY, i.wheelDelta = n.wheelDelta, i.detail = n.detail, i;
  }
  return t;
}(UL), Sm = function(t) {
  return "".concat(t, "-").concat(Math.random()).concat(Date.now());
}, Cb = function(t) {
  if (Dt(t))
    switch (t.length) {
      case 4:
        return t;
      case 3:
        return t.push(t[1]), t;
      case 2:
        return t.concat(t);
      case 1:
        return [t[0], t[0], t[0], t[0]];
      default:
        return [0, 0, 0, 0];
    }
  if (At(t))
    return [t, t, t, t];
  if (Qe(t)) {
    var e = parseInt(t, 10);
    return [e, e, e, e];
  }
  return [0, 0, 0, 0];
}, DV = function(t) {
  var e = new OV(t.type, t);
  return e.clientX = t.clientX, e.clientY = t.clientY, e.x = t.x, e.y = t.y, e.target = t.target, e.currentTarget = t.currentTarget, e.bubbles = !0, e.item = t.item, e;
}, kV = function(t) {
  if (!t)
    return !1;
  for (var e = 9, n = [1, 0, 0, 0, 1, 0, 0, 0, 1], i = 0; i < e; i++)
    if (t[i] !== n[i])
      return !0;
  return !1;
}, Aa = function(t) {
  return Number.isNaN(Number(t));
}, TN = function(t) {
  for (var e = 1 / 0, n = -1 / 0, i = 1 / 0, a = -1 / 0, o = 0; o < t.length; o++) {
    var s = t[o], u = s.getBBox(), f = u.minX, l = u.minY, c = u.maxX, h = u.maxY;
    f < e && (e = f), l < i && (i = l), c > n && (n = c), h > a && (a = h);
  }
  var d = Math.floor(e), v = Math.floor(i), p = Math.ceil(n) - Math.floor(e), g = Math.ceil(a) - Math.floor(i);
  return {
    x: d,
    y: v,
    width: p,
    height: g,
    minX: e,
    minY: i,
    maxX: n,
    maxY: a
  };
}, LV = function(t, e, n, i, a) {
  e === void 0 && (e = 15), n === void 0 && (n = "quadratic"), i === void 0 && (i = void 0), a === void 0 && (a = void 0);
  for (var o = t.length, s = e * 2, u = ["top", "top-right", "right", "bottom-right", "bottom", "bottom-left", "left", "top-left"], f = {}, l = [], c = {}, h = 0; h < o; h++) {
    var d = t[h], v = d.source, p = d.target, g = "".concat(v, "-").concat(p);
    if (!l[h]) {
      f[g] || (f[g] = []), l[h] = !0, f[g].push(d);
      for (var y = 0; y < o; y++)
        if (h !== y) {
          var b = t[y], m = b.source, x = b.target;
          l[y] || (v === x && p === m ? (f[g].push(b), l[y] = !0, c["".concat(m, "|").concat(x, "|").concat(f[g].length - 1)] = !0) : v === m && p === x && (f[g].push(b), l[y] = !0));
        }
    }
  }
  for (var _ in f)
    for (var w = f[_], E = w.length, M = 0; M < E; M++) {
      var C = w[M];
      if (C.source === C.target) {
        a && (C.type = a), C.loopCfg = {
          position: u[M % 8],
          dist: Math.floor(M / 8) * 20 + 50
        };
        continue;
      }
      if (E === 1 && i && C.source !== C.target) {
        C.type = i;
        continue;
      }
      C.type = n;
      var S = (M % 2 === 0 ? 1 : -1) * (c["".concat(C.source, "|").concat(C.target, "|").concat(M)] ? -1 : 1);
      E % 2 === 1 ? C.curveOffset = S * Math.ceil(M / 2) * s : C.curveOffset = S * (Math.floor(M / 2) * s + e);
    }
  return t;
};
const NV = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  uniqueId: Sm,
  formatPadding: Cb,
  cloneEvent: DV,
  isViewportChanged: kV,
  isNaN: Aa,
  calculationItemsBBox: TN,
  processParallelEdges: LV
}, Symbol.toStringTag, { value: "Module" }));
var Oe = typeof globalThis < "u" ? globalThis : typeof window < "u" ? window : typeof global < "u" ? global : typeof self < "u" ? self : {};
function AN(r) {
  return r && r.__esModule && Object.prototype.hasOwnProperty.call(r, "default") ? r.default : r;
}
function Ao(r) {
  var t = r.default;
  if (typeof t == "function") {
    var e = function() {
      return t.apply(this, arguments);
    };
    e.prototype = t.prototype;
  } else
    e = {};
  return Object.defineProperty(e, "__esModule", { value: !0 }), Object.keys(r).forEach(function(n) {
    var i = Object.getOwnPropertyDescriptor(r, n);
    Object.defineProperty(e, n, i.get ? i : {
      enumerable: !0,
      get: function() {
        return r[n];
      }
    });
  }), e;
}
var xs = {};
const RV = /* @__PURE__ */ Ao(cW);
Object.defineProperty(xs, "__esModule", { value: !0 });
var ds = RV;
function IN(r, t, e) {
  var n = [0, 0, 0, 0, 0, 0, 0, 0, 0];
  return ds.mat3.fromTranslation(n, e), ds.mat3.multiply(r, n, t);
}
xs.leftTranslate = IN;
function PN(r, t, e) {
  var n = [0, 0, 0, 0, 0, 0, 0, 0, 0];
  return ds.mat3.fromRotation(n, e), ds.mat3.multiply(r, n, t);
}
xs.leftRotate = PN;
function ON(r, t, e) {
  var n = [0, 0, 0, 0, 0, 0, 0, 0, 0];
  return ds.mat3.fromScaling(n, e), ds.mat3.multiply(r, n, t);
}
xs.leftScale = ON;
function BV(r, t, e) {
  return ds.mat3.multiply(r, e, t);
}
function GV(r, t) {
  for (var e = r ? [].concat(r) : [1, 0, 0, 0, 1, 0, 0, 0, 1], n = 0, i = t.length; n < i; n++) {
    var a = t[n];
    switch (a[0]) {
      case "t":
        IN(e, e, [a[1], a[2]]);
        break;
      case "s":
        ON(e, e, [a[1], a[2]]);
        break;
      case "r":
        PN(e, e, a[1]);
        break;
      case "m":
        BV(e, e, a[1]);
        break;
    }
  }
  return e;
}
var y2 = xs.transform = GV;
function DN(r, t) {
  return r[0] * t[1] - t[0] * r[1];
}
xs.direction = DN;
function FV(r, t, e) {
  var n = ds.vec2.angle(r, t), i = DN(r, t) >= 0;
  return e ? i ? Math.PI * 2 - n : n : i ? n : Math.PI * 2 - n;
}
xs.angleTo = FV;
function zV(r, t, e) {
  return e ? (r[0] = t[1], r[1] = -1 * t[0]) : (r[0] = -1 * t[1], r[1] = t[0]), r;
}
xs.vertical = zV;
var UV = function() {
  function r(t) {
    this.destroyed = !1, this.graph = t, this.destroyed = !1;
  }
  return r.prototype.getViewCenter = function() {
    var t = this.getFormatPadding(), e = this.graph, n = this.graph.get("width"), i = e.get("height");
    return {
      x: (n - t[1] - t[3]) / 2 + t[3],
      y: (i - t[0] - t[2]) / 2 + t[0]
    };
  }, r.prototype.fitCenter = function(t, e) {
    var n = this.graph, i = n.get("group");
    i.resetMatrix();
    var a = i.getCanvasBBox();
    if (!(a.width === 0 || a.height === 0)) {
      var o = this.getViewCenter(), s = {
        x: a.x + a.width / 2,
        y: a.y + a.height / 2
      };
      n.translate(o.x - s.x, o.y - s.y, t, e);
    }
  }, r.prototype.animatedFitView = function(t, e, n, i, a, o, s, u) {
    var f = this.graph;
    n = n || {
      duration: 500,
      easing: "easeCubic"
    };
    var l = [1, 0, 0, 0, 1, 0, 0, 0, 1], c = i.x + a.x - o.x - i.minX, h = i.y + a.y - o.y - i.minY;
    if (!(Aa(c) || Aa(h))) {
      var d = y2(l, [["t", c, h]]);
      if (!u) {
        var v = Oc({
          animateCfg: n,
          callback: function() {
            f.emit("viewportchange", {
              action: "translate",
              matrix: d
            });
          }
        });
        t.animate(function(x) {
          return {
            matrix: tm(e, d, x)
          };
        }, v);
        return;
      }
      var p = f.get("minZoom"), g = f.get("maxZoom"), y = s;
      p && s < p ? (y = p, console.warn("fitview failed, ratio out of range, ratio: %f", s, "graph minzoom has been used instead")) : g && s > g && (y = g, console.warn("fitview failed, ratio out of range, ratio: %f", s, "graph maxzoom has been used instead"));
      var b = y2(d, [["t", -a.x, -a.y], ["s", y, y], ["t", a.x, a.y]]), m = Oc({
        animateCfg: n,
        callback: function() {
          t.setMatrix(b), f.emit("viewportchange", {
            action: "translate",
            matrix: d
          }), f.emit("viewportchange", {
            action: "zoom",
            matrix: b
          });
        }
      });
      t.stopAnimate(), t.setMatrix(e), t.animate(function(x) {
        return {
          matrix: tm(e, b, x)
        };
      }, m);
    }
  }, r.prototype.fitView = function(t, e) {
    var n = this.graph, i = this.getFormatPadding(), a = n.get("width"), o = n.get("height"), s = n.get("group"), u = s.getMatrix() || [1, 0, 0, 0, 1, 0, 0, 0, 1];
    s.resetMatrix();
    var f = s.getCanvasBBox();
    if (!(f.width === 0 || f.height === 0)) {
      var l = this.getViewCenter(), c = {
        x: f.x + f.width / 2,
        y: f.y + f.height / 2
      }, h = (a - i[1] - i[3]) / f.width, d = (o - i[0] - i[2]) / f.height, v = h;
      if (h > d && (v = d), t)
        this.animatedFitView(s, u, e, f, l, c, v, !0);
      else {
        var p = l.x - c.x, g = l.y - c.y;
        if (Aa(p) || Aa(g))
          return;
        n.translate(p, g), n.zoom(v, l) || console.warn("zoom failed, ratio out of range, ratio: %f", v);
      }
    }
  }, r.prototype.fitViewByRules = function(t, e, n) {
    var i = t.onlyOutOfViewPort, a = i === void 0 ? !1 : i, o = t.direction, s = o === void 0 ? "both" : o, u = t.ratioRule, f = u === void 0 ? "min" : u, l = this.graph, c = this.getFormatPadding(), h = l.get("width"), d = l.get("height"), v = l.get("group"), p = v.getMatrix() || [1, 0, 0, 0, 1, 0, 0, 0, 1];
    v.resetMatrix();
    var g = v.getCanvasBBox();
    if (!(g.width === 0 || g.height === 0)) {
      var y = this.getViewCenter(), b = {
        x: g.x + g.width / 2,
        y: g.y + g.height / 2
      }, m = (h - c[1] - c[3]) / g.width, x = (d - c[0] - c[2]) / g.height, _;
      if (s === "x" ? _ = m : s === "y" ? _ = x : _ = f === "max" ? Math.max(m, x) : Math.min(m, x), a && (_ = _ < 1 ? _ : 1), e)
        this.animatedFitView(v, p, n, g, y, b, _, !0);
      else {
        var w = l.getZoom(), E = w * _, M = l.get("minZoom");
        E < M && (E = M, console.warn("fitview failed, ratio out of range, ratio: %f", _, "graph minzoom has been used instead")), l.translate(y.x - b.x, y.y - b.y), l.zoomTo(E, y);
      }
    }
  }, r.prototype.getFormatPadding = function() {
    var t = this.graph.get("fitViewPadding");
    return Cb(t);
  }, r.prototype.focusPoint = function(t, e, n) {
    var i = this, a = this.getViewCenter(), o = this.getPointByCanvas(a.x, a.y), s = this.graph.get("group").getMatrix();
    if (s || (s = [1, 0, 0, 0, 1, 0, 0, 0, 1]), e) {
      var u = (o.x - t.x) * s[0], f = (o.y - t.y) * s[4], l = 0, c = 0, h = 0, d = 0;
      this.graph.get("canvas").animate(function(v) {
        h = u * v, d = f * v, i.graph.translate(h - l, d - c), l = h, c = d;
      }, U({}, n));
    } else
      this.graph.translate((o.x - t.x) * s[0], (o.y - t.y) * s[4]);
  }, r.prototype.getPointByCanvas = function(t, e) {
    var n = this.graph.get("group").getMatrix();
    n || (n = [1, 0, 0, 0, 1, 0, 0, 0, 1]);
    var i = _L({
      x: t,
      y: e
    }, n);
    return i;
  }, r.prototype.getPointByClient = function(t, e) {
    var n = this.graph.get("canvas"), i = n.getPointByClient(t, e);
    return this.getPointByCanvas(i.x, i.y);
  }, r.prototype.getClientByPoint = function(t, e) {
    var n = this.graph.get("canvas"), i = this.getCanvasByPoint(t, e), a = n.getClientByPoint(i.x, i.y);
    return {
      x: a.x,
      y: a.y
    };
  }, r.prototype.getCanvasByPoint = function(t, e) {
    var n = this.graph.get("group").getMatrix();
    return n || (n = [1, 0, 0, 0, 1, 0, 0, 0, 1]), Wv({
      x: t,
      y: e
    }, n);
  }, r.prototype.focus = function(t, e, n) {
    if (Qe(t) && (t = this.graph.findById(t)), t) {
      var i = 0, a = 0;
      if (t.getType && t.getType() === "edge") {
        var o = t.getSource().get("group").getMatrix(), s = t.getTarget().get("group").getMatrix();
        o && s ? (i = (o[6] + s[6]) / 2, a = (o[7] + s[7]) / 2) : (o || s) && (i = o ? o[6] : s[6], a = o ? o[7] : s[7]);
      } else {
        var u = t.get("group"), f = u.getMatrix();
        f || (f = [1, 0, 0, 0, 1, 0, 0, 0, 1]), i = f[6], a = f[7];
      }
      this.focusPoint({
        x: i,
        y: a
      }, e, n);
    }
  }, r.prototype.focusItems = function(t, e, n, i) {
    if (!!t.length) {
      var a = this.graph, o = this.getFormatPadding(), s = a.get("width"), u = a.get("height"), f = a.get("group"), l = f.getMatrix() || [1, 0, 0, 0, 1, 0, 0, 0, 1];
      f.resetMatrix();
      for (var c = {
        x: 0,
        y: 0,
        minX: Number.MAX_SAFE_INTEGER,
        minY: Number.MAX_SAFE_INTEGER,
        maxX: Number.MIN_SAFE_INTEGER,
        maxY: Number.MIN_SAFE_INTEGER,
        width: 0,
        height: 0
      }, h = 0, d = t; h < d.length; h++) {
        var v = d[h], p = v.getBBox();
        p.minX < c.minX && (c.minX = p.minX), p.minY < c.minY && (c.minY = p.minY), p.maxX > c.maxX && (c.maxX = p.maxX), p.maxY > c.maxY && (c.maxY = p.maxY);
      }
      if (c.x = c.minX, c.y = c.minY, c.width = c.maxX - c.minX, c.height = c.maxY - c.minY, !(c.width === 0 || c.height === 0)) {
        var g = this.getViewCenter(), y = {
          x: c.x + c.width / 2,
          y: c.y + c.height / 2
        }, b = (s - o[1] - o[3]) / c.width, m = (u - o[0] - o[2]) / c.height, x = b;
        b > m && (x = m), n ? this.animatedFitView(f, l, i, c, g, y, x, e) : (a.translate(g.x - y.x, g.y - y.y), e && !a.zoom(x, g) && console.warn("zoom failed, ratio out of range, ratio: %f", x));
      }
    }
  }, r.prototype.changeSize = function(t, e) {
    var n = this.graph;
    if (!At(t) || !At(e))
      throw Error("invalid canvas width & height, please make sure width & height type is number");
    n.set({
      width: t,
      height: e
    });
    var i = n.get("canvas");
    i.changeSize(t, e);
    var a = n.get("plugins");
    a.forEach(function(o) {
      o.get("gridContainer") && o.positionInit();
    });
  }, r.prototype.destroy = function() {
    this.graph = null, this.destroyed = !1;
  }, r;
}();
function Mm(r) {
  return Mm = typeof Symbol == "function" && typeof Symbol.iterator == "symbol" ? function(t) {
    return typeof t;
  } : function(t) {
    return t && typeof Symbol == "function" && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t;
  }, Mm(r);
}
function m2(r) {
  if (typeof r != "string")
    return r;
  var t = function(E) {
    if (typeof E != "string")
      return E;
    try {
      return JSON.parse(E.trim());
    } catch {
      return E.trim();
    }
  }, e = t(r);
  if (typeof e != "string")
    return e;
  for (var n = function(E) {
    return E[E.length - 1];
  }, i = r.trim(), a = [], o = [], s = function() {
    for (var E = [], M = 0; M < arguments.length; M++)
      E[M] = arguments[M];
    return E.some(function(C) {
      return n(o) === C;
    });
  }, u = function() {
    return n(a);
  }, f = null, l = 0, c = ""; l < i.length; ) {
    var h = i[l], d = s('"', "'");
    if (!d && !h.trim()) {
      l += 1;
      continue;
    }
    var v = i[l - 1] === "\\", p = s("}"), g = s("]"), y = s(","), b = u();
    if (d)
      if (n(o) === h && !v) {
        o.pop();
        var m = t(c);
        b.push(m), f = m, c = "";
      } else
        c += h;
    else if (g && h === ",")
      c && (b.push(t(c)), c = "");
    else if (p && h === ":")
      o.push(","), c && (b.push(c), c = "");
    else if (y && h === ",")
      c && (b.push(t(c)), c = ""), o.pop();
    else if (h === "}" && (p || y)) {
      c && (b.push(t(c)), c = ""), y && o.pop();
      for (var x = {}, _ = 1; _ < b.length; _ += 2)
        x[b[_ - 1]] = b[_];
      a.pop(), a.length && n(a).push(x), o.pop(), f = x;
    } else
      h === "]" && g ? (c && (b.push(t(c)), c = ""), a.pop(), a.length && n(a).push(b), o.pop(), f = b) : h === "{" ? (a.push([]), o.push("}")) : h === "[" ? (a.push([]), o.push("]")) : h === '"' ? o.push('"') : h === "'" ? o.push("'") : c += h;
    l += 1;
  }
  return f || c;
}
var jV = function(t) {
  return t.split("-").reduce(function(e, n) {
    return e + n.charAt(0).toUpperCase() + n.slice(1);
  });
}, $V = function(t) {
  return function(e) {
    for (var n = t.length, i = [], a = 0, o = ""; a < n; )
      if (t[a] === "{" && t[a + 1] === "{")
        i.push(o), o = "", a += 2;
      else if (t[a] === "}" && t[a + 1] === "}") {
        if (i.length) {
          var s = i.pop();
          o = co(e, o, s.endsWith("=") ? '"{'.concat(o, '}"') : o), i.push(s + o);
        }
        a += 2, o = "";
      } else
        o += t[a], a += 1;
    return i.push(o), i.map(function(u, f) {
      return i[f - 1] && i[f - 1].endsWith("=") ? '"{'.concat(u, '}"') : u;
    }).join("");
  };
};
function kN(r, t) {
  var e = {}, n = r.getAttributeNames && r.getAttributeNames() || [], i = r.children && Array.from(r.children).map(function(s) {
    return kN(s, t);
  }), a = {}, o = r.tagName ? r.tagName.toLowerCase() : "group";
  return o === "text" && (e.text = r.innerText), a.type = o, o === "img" && (a.type = "image"), Array.from(n).forEach(function(s) {
    var u = jV(s), f = r.getAttribute(s);
    try {
      if (u === "style" || u === "attrs") {
        var l = m2(f);
        e = U(U({}, e), l);
      } else
        a[u] = m2(f);
    } catch (c) {
      if (u === "style")
        throw c;
      a[u] = f;
    }
  }), a.attrs = e, t && t.style && a.name && Mm(t.style[a.name]) === "object" && (a.attrs = U(U({}, a.attrs), t.style[a.name])), t && t.style && a.keyshape && (a.attrs = U(U({}, a.attrs), t.style)), i.length && (a.children = i), a;
}
function WV(r, t, e) {
  var n = r.attrs, i = n === void 0 ? {} : n, a = {
    x: t.x || 0,
    y: t.y || 0,
    width: e.width || 0,
    height: e.height || 0
  }, o, s;
  switch (r.type) {
    case "maker":
    case "circle":
      i.r && (s = 2 * i.r, o = 2 * i.r);
      break;
    case "text":
      i.text && (s = LL(i.text, i.fontSize || 12)[0], o = 16, a.y += o, a.height = o, a.width = s, r.attrs = U({
        fontSize: 12,
        fill: "#000"
      }, i));
      break;
    default:
      i.width && (s = i.width), i.height && (o = i.height);
  }
  return o >= 0 && (a.height = o), s >= 0 && (a.width = s), i.marginTop && (a.y += i.marginTop), i.marginLeft && (a.x += i.marginLeft), a;
}
function LN(r, t) {
  var e;
  t === void 0 && (t = {
    x: 0,
    y: 0
  });
  var n = U({
    x: 0,
    y: 0,
    width: 0,
    height: 0
  }, t);
  if (!((e = r.children) === null || e === void 0) && e.length) {
    var i = r.attrs, a = i === void 0 ? {} : i, o = a.marginTop, s = U({}, t);
    o && (s.y += o);
    for (var u = 0; u < r.children.length; u++) {
      r.children[u].attrs.key = "".concat(a.key || "root", " -").concat(u, " ");
      var f = LN(r.children[u], s);
      if (f.bbox) {
        var l = f.bbox;
        f.attrs.next === "inline" ? s.x += f.bbox.width : s.y += f.bbox.height, l.width + l.x > n.width && (n.width = l.width + l.x), l.height + l.y > n.height && (n.height = l.height + l.y);
      }
    }
  }
  return r.bbox = WV(r, t, n), r.attrs = U(U({}, r.attrs), r.bbox), r;
}
function NN(r, t) {
  var e, n, i, a, o = (r || {}).type, s = ((t == null ? void 0 : t.attrs) || {}).key;
  if (s && r && (r.attrs.key = s), !r && t)
    return {
      action: "delete",
      val: t,
      type: o,
      key: s
    };
  if (r && !t)
    return {
      action: "add",
      val: r,
      type: o
    };
  if (!r && !t)
    return {
      action: "same",
      type: o
    };
  var u = [];
  if (((e = r.children) === null || e === void 0 ? void 0 : e.length) > 0 || ((n = t.children) === null || n === void 0 ? void 0 : n.length) > 0)
    for (var f = Math.max((i = r.children) === null || i === void 0 ? void 0 : i.length, (a = t.children) === null || a === void 0 ? void 0 : a.length), l = t.children || [], c = r.children || [], h = 0; h < f; h += 1)
      u.push(NN(c[h], l[h]));
  var d = Object.keys(t.attrs), v = Object.keys(r.attrs);
  return t.type !== r.type ? {
    action: "restructure",
    nowTarget: r,
    formerTarget: t,
    key: s,
    children: u
  } : d.filter(function(p) {
    return p !== "children";
  }).some(function(p) {
    return r.attrs[p] !== t.attrs[p] || !v.includes(p);
  }) ? {
    action: "change",
    val: r,
    children: u,
    type: o,
    key: s
  } : {
    action: "same",
    children: u,
    type: o,
    key: s
  };
}
function b2(r) {
  var t = {}, e = function(i) {
    var a = typeof r == "function" ? r(i) : r, o = $V(a)(i), s = document.createElement("div");
    s.innerHTML = o;
    var u = s.children[0], f = LN(kN(u, i));
    return s.remove(), f;
  };
  return {
    draw: function(i, a) {
      var o = e(i), s = a, u = function f(l) {
        var c = l.attrs, h = c === void 0 ? {} : c, d = l.bbox, v = l.type, p = l.children, g = kn(l, ["attrs", "bbox", "type", "children"]);
        if (l.type !== "group") {
          var y = a.addShape(l.type, U({
            attrs: h,
            origin: {
              bbox: d,
              type: v,
              children: p
            }
          }, g));
          l.keyshape && (s = y);
        }
        l.children && l.children.forEach(function(b) {
          return f(b);
        });
      };
      return u(o), t[i.id] = [o], s;
    },
    update: function(i, a) {
      t[i.id] || (t[i.id] = []);
      var o = a.getContainer(), s = o.get("children"), u = e(i), f = t[i.id].pop(), l = NN(u, f), c = function v(p) {
        var g;
        p.type !== "group" && o.addShape(p.type, {
          attrs: p.attrs
        }), !((g = p.children) === null || g === void 0) && g.length && p.children.map(function(y) {
          return v(y);
        });
      }, h = function v(p) {
        var g, y = s.find(function(b) {
          return b.attrs.key === p.attrs.key;
        });
        y && o.removeChild(y), !((g = p.children) === null || g === void 0) && g.length && p.children.map(function(b) {
          return v(b);
        });
      }, d = function v(p) {
        var g = p.key;
        if (p.type !== "group") {
          var y = s.find(function(m) {
            return m.attrs.key === g;
          });
          switch (p.action) {
            case "change":
              if (y) {
                var b = p.val.keyshape ? a.getOriginStyle() : {};
                y.attr(U(U({}, b), p.val.attrs));
              }
              break;
            case "add":
              c(p.val);
              break;
            case "delete":
              h(p.val);
              break;
            case "restructure":
              h(p.formerTarget), c(p.nowTarget);
              break;
          }
        }
        p.children && p.children.forEach(function(m) {
          return v(m);
        });
      };
      d(l), t[i.id].push(u);
    },
    getAnchorPoints: function() {
      return [[0, 0.5], [1, 0.5], [0.5, 1], [0.5, 0]];
    }
  };
}
var B0 = {};
function x2(r) {
  return B0[r] || (B0[r] = Bf(r)), B0[r];
}
var VV = {
  defaultShapeType: "defaultType",
  className: null,
  getShape: function(t) {
    var e = this, n = e[t] || e[e.defaultShapeType] || e["simple-circle"];
    return n;
  },
  draw: function(t, e, n) {
    var i = this.getShape(t);
    n.shapeMap = {};
    var a = i.draw(e, n);
    return i.afterDraw && i.afterDraw(e, n, a), a;
  },
  baseUpdate: function(t, e, n, i) {
    var a, o, s = this.getShape(t);
    s.update && (s.mergeStyle = (a = s.getOptions) === null || a === void 0 ? void 0 : a.call(s, e, i), (o = s.update) === null || o === void 0 || o.call(s, e, n, i)), s.afterUpdate && s.afterUpdate(e, n);
  },
  setState: function(t, e, n, i) {
    var a = this.getShape(t);
    a.setState(e, n, i);
  },
  shouldUpdate: function(t) {
    var e = this.getShape(t);
    return !!e.update;
  },
  getControlPoints: function(t, e) {
    var n = this.getShape(t);
    return n.getControlPoints(e);
  },
  getAnchorPoints: function(t, e) {
    var n = this.getShape(t);
    return n.getAnchorPoints(e);
  }
}, G0 = {
  options: {},
  draw: function(t, e) {
    return this.drawShape(t, e);
  },
  drawShape: function() {
  },
  afterDraw: function() {
  },
  afterUpdate: function() {
  },
  setState: function() {
  },
  getControlPoints: function(t) {
    return t.controlPoints;
  },
  getAnchorPoints: function(t) {
    var e = this.options.anchorPoints, n = t.anchorPoints || e;
    return n;
  }
}, Or = function() {
  function r() {
  }
  return r.registerFactory = function(t, e) {
    var n = x2(t), i = VV, a = U(U({}, i), e);
    return r[n] = a, a.className = n, a;
  }, r.getFactory = function(t) {
    var e = x2(t);
    return r[e];
  }, r.registerNode = function(t, e, n) {
    var i = r.Node, a;
    if (typeof e == "string" || typeof e == "function") {
      var o = b2(e);
      a = U(U({}, i.getShape("single-node")), o);
    } else if (e.jsx) {
      var s = e.jsx, o = b2(s);
      a = U(U(U({}, i.getShape("single-node")), o), e);
    } else {
      i.getShape(n);
      var u = n ? i.getShape(n) : G0;
      a = U(U({}, u), e);
    }
    return a.type = t, a.itemType = "node", i[t] = a, a;
  }, r.registerEdge = function(t, e, n) {
    var i = r.Edge, a = n ? i.getShape(n) : G0, o = U(U({}, a), e);
    return o.type = t, o.itemType = "edge", i[t] = o, o;
  }, r.registerCombo = function(t, e, n) {
    var i = r.Combo, a = n ? i.getShape(n) : G0, o = U(U({}, a), e);
    return o.type = t, o.itemType = "combo", i[t] = o, o;
  }, r;
}();
Or.registerFactory("node", {
  defaultShapeType: "circle"
});
Or.registerFactory("edge", {
  defaultShapeType: "line"
});
Or.registerFactory("combo", {
  defaultShapeType: "circle"
});
var F0 = "bboxCache", z0 = "bboxCanvasCache", RN = function() {
  function r(t) {
    this._cfg = {}, this.destroyed = !1;
    var e = {
      id: void 0,
      type: "item",
      model: {},
      group: void 0,
      animate: !1,
      visible: !0,
      locked: !1,
      event: !0,
      keyShape: void 0,
      states: []
    };
    this._cfg = Object.assign(e, this.getDefaultCfg(), t);
    var n = this.get("model"), i = n.id, a = this.get("type");
    typeof i > "u" ? i = Sm(a) : typeof i != "string" && (i = String(i)), this.get("model").id = i, this.set("id", i);
    var o = t.group;
    o && (o.set("item", this), o.set("id", i)), this.init(), this.draw();
    var s = n.shape || n.type || (a === "edge" ? "line" : "circle"), u = this.get("shapeFactory");
    if (u && u[s]) {
      var f = u[s].options;
      if (f && f.stateStyles) {
        var l = this.get("styles") || n.stateStyles;
        l = kr({}, f.stateStyles, l), this.set("styles", l);
      }
    }
  }
  return r.prototype.calculateBBox = function() {
    var t = this.get("keyShape"), e = this.get("group"), n = Yv(t, e);
    return n.x = n.minX, n.y = n.minY, n.width = n.maxX - n.minX, n.height = n.maxY - n.minY, n.centerX = (n.minX + n.maxX) / 2, n.centerY = (n.minY + n.maxY) / 2, n;
  }, r.prototype.calculateCanvasBBox = function() {
    var t = this.get("keyShape"), e = this.get("group"), n = Yv(t, e);
    return n.x = n.minX, n.y = n.minY, n.width = n.maxX - n.minX, n.height = n.maxY - n.minY, n.centerX = (n.minX + n.maxX) / 2, n.centerY = (n.minY + n.maxY) / 2, n;
  }, r.prototype.drawInner = function() {
    var t = this, e = t.get("shapeFactory"), n = t.get("group"), i = t.get("model");
    n.clear();
    var a = i.visible;
    if (a !== void 0 && !a && t.changeVisibility(a), !!e) {
      t.updatePosition(i);
      var o = t.getShapeCfg(i), s = o.type, u = e.draw(s, o, n);
      u && (t.set("keyShape", u), u.set("isKeyShape", !0), u.set("draggable", !0)), this.setOriginStyle(), this.set("currentShape", s), this.restoreStates(e, s);
    }
  }, r.prototype.setOriginStyle = function() {
    var t = this.get("group"), e = t.get("children"), n = this.getKeyShape(), i = this, a = n.get("name");
    if (this.get("originStyle")) {
      var d = this.get("originStyle");
      a && !d[a] && (d[a] = {});
      for (var v = this.getCurrentStatesStyle(), p = function(y) {
        var b = e[y], m = b.get("name"), x = b.attr();
        if (m && m !== a) {
          var _ = v[m];
          d[m] || (d[m] = {}), _ ? Object.keys(x).forEach(function(M) {
            var C = x[M];
            C !== _[M] && (d[m][M] = C);
          }) : d[m] = b.get("type") !== "image" ? vr(x) : i.getShapeStyleByName(m);
        } else {
          var w = b.attr(), E = {};
          Object.keys(v).forEach(function(M) {
            var C = v[M];
            (M === a || !Rn(C)) && (E[M] = C);
          }), Object.keys(w).forEach(function(M) {
            var C = w[M];
            E[M] !== C && (a ? d[a][M] = C : d[M] = C);
          });
        }
      }, s = 0; s < e.length; s++)
        p(s);
      delete d.path, delete d.matrix, delete d.x, delete d.y, d[a] && (delete d[a].x, delete d[a].y, delete d[a].matrix, delete d[a].path), i.set("originStyle", d);
    } else {
      for (var o = {}, s = 0; s < e.length; s++) {
        var u = e[s], f = u.get("type"), l = u.get("name");
        if (l && l !== a)
          o[l] = f !== "image" ? vr(u.attr()) : i.getShapeStyleByName(l), f === "text" && o[l] && (delete o[l].x, delete o[l].y, delete o[l].matrix);
        else {
          var c = i.getShapeStyleByName();
          if (delete c.path, delete c.matrix, !a)
            Object.assign(o, c);
          else if (l)
            o[a] = c;
          else {
            var h = Sm("shape");
            u.set("name", h), t.shapeMap[h] = u, o[h] = f !== "image" ? vr(u.attr()) : i.getShapeStyleByName(l);
          }
        }
      }
      i.set("originStyle", o);
    }
  }, r.prototype.restoreStates = function(t, e) {
    var n = this, i = n.get("states");
    Se(i, function(a) {
      t.setState(e, a, !0, n);
    });
  }, r.prototype.init = function() {
    var t = Or.getFactory(this.get("type"));
    this.set("shapeFactory", t);
  }, r.prototype.get = function(t) {
    return this._cfg[t];
  }, r.prototype.set = function(t, e) {
    Rn(t) ? this._cfg = U(U({}, this._cfg), t) : this._cfg[t] = e;
  }, r.prototype.getDefaultCfg = function() {
    return {};
  }, r.prototype.clearCache = function() {
    this.set(F0, null), this.set(z0, null);
  }, r.prototype.beforeDraw = function() {
  }, r.prototype.afterDraw = function() {
  }, r.prototype.afterUpdate = function() {
  }, r.prototype.draw = function() {
    this.beforeDraw(), this.drawInner(), this.afterDraw();
  }, r.prototype.getShapeStyleByName = function(t) {
    var e = this.get("group"), n;
    if (t ? n = e.shapeMap[t] : n = this.getKeyShape(), n) {
      var i = {};
      return Se(n.attr(), function(a, o) {
        (o !== "img" || Qe(a)) && (i[o] = a);
      }), i;
    }
    return {};
  }, r.prototype.getShapeCfg = function(t, e) {
    var n = this.get("styles");
    if (n) {
      var i = t;
      return i.style = U(U({}, n), t.style), i;
    }
    return t;
  }, r.prototype.getStateStyle = function(t) {
    var e = this.get("styles"), n = e && e[t];
    return n;
  }, r.prototype.getOriginStyle = function() {
    return this.get("originStyle");
  }, r.prototype.getCurrentStatesStyle = function() {
    var t = this, e = {}, n = t.getStates();
    return !n || !n.length ? this.get("originStyle") : (Se(t.getStates(), function(i) {
      e = Object.assign(e, t.getStateStyle(i));
    }), e);
  }, r.prototype.setState = function(t, e) {
    var n = this.get("states"), i = this.get("shapeFactory"), a = t, o = t;
    Qe(e) && (a = "".concat(t, ":").concat(e), o = "".concat(t, ":"));
    var s = n;
    if (W1(e)) {
      var u = n.indexOf(o);
      if (e) {
        if (u > -1)
          return;
        n.push(a);
      } else
        u > -1 && n.splice(u, 1);
    } else if (Qe(e)) {
      var f = n.filter(function(h) {
        return h.includes(o);
      });
      f.length > 0 && this.clearStates(f), s = s.filter(function(h) {
        return !h.includes(o);
      }), s.push(a), this.set("states", s);
    }
    if (i) {
      var l = this.get("model"), c = l.type;
      i.setState(c, t, e, this);
    }
  }, r.prototype.clearStates = function(t) {
    var e = this, n = e.getStates(), i = e.get("shapeFactory"), a = e.get("model"), o = a.type;
    t || (t = n), Qe(t) && (t = [t]);
    var s = n.filter(function(u) {
      return t.indexOf(u) === -1;
    });
    e.set("states", s), t.forEach(function(u) {
      i.setState(o, u, !1, e);
    });
  }, r.prototype.getContainer = function() {
    return this.get("group");
  }, r.prototype.getKeyShape = function() {
    return this.get("keyShape");
  }, r.prototype.getModel = function() {
    return this.get("model");
  }, r.prototype.getType = function() {
    return this.get("type");
  }, r.prototype.getID = function() {
    return this.get("id");
  }, r.prototype.isItem = function() {
    return !0;
  }, r.prototype.getStates = function() {
    return this.get("states");
  }, r.prototype.hasState = function(t) {
    var e = this.getStates();
    return e.indexOf(t) >= 0;
  }, r.prototype.refresh = function(t) {
    var e = this.get("model");
    this.updatePosition(e), this.updateShape(t), this.afterUpdate(), this.clearCache();
  }, r.prototype.getUpdateType = function(t) {
  }, r.prototype.update = function(t, e) {
    e === void 0 && (e = void 0);
    var n = this.get("model");
    if (e === "move")
      this.updatePosition(t);
    else {
      var i = n.visible, a = t.visible;
      i !== a && a !== void 0 && this.changeVisibility(a);
      var o = {
        x: n.x,
        y: n.y
      };
      t.x = isNaN(+t.x) ? n.x : +t.x, t.y = isNaN(+t.y) ? n.y : +t.y;
      var s = this.get("styles");
      if (t.stateStyles) {
        var u = t.stateStyles;
        kt(s, u), delete t.stateStyles;
      }
      Object.assign(n, t), (o.x !== t.x || o.y !== t.y) && this.updatePosition(t), this.updateShape(e);
    }
    this.afterUpdate(), this.clearCache();
  }, r.prototype.updateShape = function(t) {
    var e = this.get("shapeFactory"), n = this.get("model"), i = n.type;
    if (e.shouldUpdate(i) && i === this.get("currentShape")) {
      var a = this.getShapeCfg(n, t);
      e.baseUpdate(i, a, this, t), t !== "move" && this.setOriginStyle();
    } else
      this.draw();
    this.restoreStates(e, i);
  }, r.prototype.updatePosition = function(t) {
    var e = this.get("model"), n = isNaN(+t.x) ? +e.x : +t.x, i = isNaN(+t.y) ? +e.y : +t.y, a = this.get("group");
    if (isNaN(n) || isNaN(i))
      return !1;
    e.x = n, e.y = i;
    var o = a.getMatrix();
    return o && o[6] === n && o[7] === i ? !1 : (a.resetMatrix(), wL(a, {
      x: n,
      y: i
    }), this.clearCache(), !0);
  }, r.prototype.getBBox = function() {
    var t = this.get(F0);
    return t || (t = this.calculateBBox(), this.set(F0, t)), t;
  }, r.prototype.getCanvasBBox = function() {
    var t = this.get(z0);
    return t || (t = this.calculateCanvasBBox(), this.set(z0, t)), t;
  }, r.prototype.toFront = function() {
    var t = this.get("group");
    t.toFront();
  }, r.prototype.toBack = function() {
    var t = this.get("group");
    t.toBack();
  }, r.prototype.show = function() {
    this.changeVisibility(!0);
  }, r.prototype.hide = function() {
    this.changeVisibility(!1);
  }, r.prototype.changeVisibility = function(t) {
    var e = this.get("group");
    t ? e.show() : e.hide(), this.set("visible", t);
  }, r.prototype.isVisible = function() {
    return this.get("visible");
  }, r.prototype.enableCapture = function(t) {
    var e = this.get("group");
    e && e.set("capture", t);
  }, r.prototype.destroy = function() {
    if (!this.destroyed) {
      var t = this.get("animate"), e = this.get("group");
      t && e.stopAnimate(), e.shapeMap = {}, this.clearCache(), e.remove(), this._cfg = null, this.destroyed = !0;
    }
  }, r;
}(), pd = {
  source: "start",
  target: "end"
}, va = "Node", qu = "Point", XV = "Anchor", BN = function(r) {
  Ht(t, r);
  function t() {
    return r !== null && r.apply(this, arguments) || this;
  }
  return t.prototype.getDefaultCfg = function() {
    return {
      type: "edge",
      sourceNode: null,
      targetNode: null,
      startPoint: null,
      endPoint: null,
      linkCenter: !1
    };
  }, t.prototype.setEnd = function(e, n) {
    var i = pd[e] + qu, a = e + va, o = this.get(a);
    o && !o.destroyed && o.removeEdge(this), Rn(n) ? (this.set(i, n), this.set(a, null)) : n && (n.addEdge(this), this.set(a, n), this.set(i, null));
  }, t.prototype.getLinkPoint = function(e, n, i) {
    var a = pd[e] + qu, o = e + va, s = this.get(a);
    if (!s) {
      var u = this.get(o), f = e + XV, l = this.getPrePoint(e, i), c = n[f];
      Tt(c) || (s = u.getLinkPointByAnchor(c)), s = s || u.getLinkPoint(l), Tt(s.index) || this.set("".concat(e, "AnchorIndex"), s.index);
    }
    return s;
  }, t.prototype.getPrePoint = function(e, n) {
    if (n && n.length) {
      var i = e === "source" ? 0 : n.length - 1;
      return n[i];
    }
    var a = e === "source" ? "target" : "source";
    return this.getEndPoint(a);
  }, t.prototype.getEndPoint = function(e) {
    var n = e + va, i = pd[e] + qu, a = this.get(n);
    return a ? a.get("model") : this.get(i);
  }, t.prototype.getControlPointsByCenter = function(e) {
    var n = this.getEndPoint("source"), i = this.getEndPoint("target"), a = this.get("shapeFactory"), o = e.type;
    return a.getControlPoints(o, {
      startPoint: n,
      endPoint: i
    });
  }, t.prototype.getEndCenter = function(e) {
    var n = e + va, i = pd[e] + qu, a = this.get(n);
    if (a) {
      var o = a.getBBox();
      return {
        x: o.centerX,
        y: o.centerY
      };
    }
    return this.get(i);
  }, t.prototype.init = function() {
    r.prototype.init.call(this), this.setSource(this.get("source")), this.setTarget(this.get("target"));
  }, t.prototype.getShapeCfg = function(e, n) {
    var i = this, a = i.get("linkCenter"), o = n != null && n.includes("move") ? e : r.prototype.getShapeCfg.call(this, e);
    if (a)
      o.startPoint = i.getEndCenter("source"), o.endPoint = i.getEndCenter("target");
    else {
      var s = o.controlPoints || i.getControlPointsByCenter(o);
      o.startPoint = i.getLinkPoint("source", e, s), o.endPoint = i.getLinkPoint("target", e, s);
    }
    return o.sourceNode = i.get("sourceNode"), o.targetNode = i.get("targetNode"), o;
  }, t.prototype.getModel = function() {
    var e = this.get("model"), n = this.get("source".concat(va)), i = this.get("target".concat(va));
    return n ? delete e["source".concat(va)] : e.source = this.get("start".concat(qu)), i ? delete e["target".concat(va)] : e.target = this.get("end".concat(qu)), !Qe(e.source) && !Rn(e.source) && (e.source = e.source.getID()), !Qe(e.target) && !Rn(e.target) && (e.target = e.target.getID()), e;
  }, t.prototype.setSource = function(e) {
    this.setEnd("source", e), this.set("source", e);
  }, t.prototype.setTarget = function(e) {
    this.setEnd("target", e), this.set("target", e);
  }, t.prototype.getSource = function() {
    return this.get("source");
  }, t.prototype.getTarget = function() {
    return this.get("target");
  }, t.prototype.updatePosition = function() {
    return !1;
  }, t.prototype.update = function(e, n) {
    n === void 0 && (n = void 0);
    var i = this.get("model"), a = i.visible, o = e.visible;
    a !== o && o !== void 0 && this.changeVisibility(o);
    var s = this.get("styles");
    if (e.stateStyles) {
      var u = e.stateStyles;
      kt(s, u), delete e.stateStyles;
    }
    Object.assign(i, e), this.updateShape(n), this.afterUpdate(), this.clearCache();
  }, t.prototype.destroy = function() {
    var e = this.get("source".concat(va)), n = this.get("target".concat(va));
    e && !e.destroyed && e.removeEdge(this), n && !n.destroyed && n.removeEdge(this), r.prototype.destroy.call(this);
  }, t;
}(RN), U0 = "anchorPointsCache", YV = "bboxCache", Tb = function(r) {
  Ht(t, r);
  function t() {
    return r !== null && r.apply(this, arguments) || this;
  }
  return t.prototype.getNearestPoint = function(e, n) {
    for (var i = 0, a = e[0], o = Vv(e[0], n), s = 0; s < e.length; s++) {
      var u = e[s], f = Vv(u, n);
      f < o && (a = u, o = f, i = s);
    }
    return a.anchorIndex = i, a;
  }, t.prototype.getDefaultCfg = function() {
    return {
      type: "node",
      edges: []
    };
  }, t.prototype.getEdges = function() {
    return this.get("edges");
  }, t.prototype.getInEdges = function() {
    var e = this;
    return this.get("edges").filter(function(n) {
      return n.get("target") === e;
    });
  }, t.prototype.getOutEdges = function() {
    var e = this;
    return this.get("edges").filter(function(n) {
      return n.get("source") === e;
    });
  }, t.prototype.getNeighbors = function(e) {
    var n = this, i = this.get("edges");
    if (e === "target") {
      var a = function(f) {
        return f.getSource() === n;
      };
      return i.filter(a).map(function(u) {
        return u.getTarget();
      });
    }
    if (e === "source") {
      var o = function(f) {
        return f.getTarget() === n;
      };
      return i.filter(o).map(function(u) {
        return u.getSource();
      });
    }
    var s = function(f) {
      return f.getSource() === n ? f.getTarget() : f.getSource();
    };
    return i.map(s);
  }, t.prototype.getLinkPointByAnchor = function(e) {
    var n = this.getAnchorPoints();
    return n[e];
  }, t.prototype.getLinkPoint = function(e) {
    var n = this.get("keyShape"), i = n.get("type"), a = this.get("type"), o, s, u = this.getBBox();
    a === "combo" ? (o = u.centerX || (u.maxX + u.minX) / 2, s = u.centerY || (u.maxY + u.minY) / 2) : (o = u.centerX, s = u.centerY);
    var f = this.getAnchorPoints(), l;
    switch (i) {
      case "circle":
        l = bL({
          x: o,
          y: s,
          r: u.width / 2
        }, e);
        break;
      case "ellipse":
        l = xL({
          x: o,
          y: s,
          rx: u.width / 2,
          ry: u.height / 2
        }, e);
        break;
      default:
        l = mL(u, e);
    }
    var c = l;
    return f.length && (c || (c = e), c = this.getNearestPoint(f, c)), c || (c = {
      x: o,
      y: s
    }), c;
  }, t.prototype.getAnchorPoints = function() {
    var e = this.get(U0);
    if (!e) {
      e = [];
      var n = this.get("shapeFactory"), i = this.getBBox(), a = this.get("model"), o = this.getShapeCfg(a), s = a.type, u = n.getAnchorPoints(s, o) || [];
      Se(u, function(f, l) {
        var c = {
          x: i.minX + f[0] * i.width,
          y: i.minY + f[1] * i.height,
          anchorIndex: l
        };
        e.push(c);
      }), this.set(U0, e);
    }
    return e;
  }, t.prototype.addEdge = function(e) {
    this.get("edges").push(e);
  }, t.prototype.lock = function() {
    this.set("locked", !0);
  }, t.prototype.unlock = function() {
    this.set("locked", !1);
  }, t.prototype.hasLocked = function() {
    return this.get("locked");
  }, t.prototype.removeEdge = function(e) {
    var n = this.getEdges(), i = n.indexOf(e);
    i > -1 && n.splice(i, 1);
  }, t.prototype.clearCache = function() {
    this.set(YV, null), this.set(U0, null);
  }, t.prototype.getUpdateType = function(e) {
    var n, i, a, o, s;
    if (!!e) {
      var u = !Tt(e.x), f = !Tt(e.y), l = Object.keys(e);
      if (l.length === 1 && (u || f) || l.length === 2 && u && f)
        return "move";
      if (At(e.x) || At(e.y) || e.type || e.anchorPoints || e.size || (e == null ? void 0 : e.style) && (((n = e == null ? void 0 : e.style) === null || n === void 0 ? void 0 : n.r) || ((i = e == null ? void 0 : e.style) === null || i === void 0 ? void 0 : i.width) || ((a = e == null ? void 0 : e.style) === null || a === void 0 ? void 0 : a.height) || ((o = e == null ? void 0 : e.style) === null || o === void 0 ? void 0 : o.rx) || ((s = e == null ? void 0 : e.style) === null || s === void 0 ? void 0 : s.ry)))
        return "bbox|label";
      var c = l.includes("label") || l.includes("labelCfg");
      return c ? "style|label" : "style";
    }
  }, t;
}(RN), _2 = "bboxCache", w2 = "bboxCanvasCache", j0 = "sizeCache", E2 = "anchorPointsCache", GN = function(r) {
  Ht(t, r);
  function t() {
    return r !== null && r.apply(this, arguments) || this;
  }
  return t.prototype.getDefaultCfg = function() {
    return {
      type: "combo",
      nodes: [],
      edges: [],
      combos: []
    };
  }, t.prototype.getShapeCfg = function(e) {
    var n = this.get("styles"), i = this.get("bbox");
    if (n && i) {
      var a = e, o = {
        r: Math.hypot(i.height, i.width) / 2 || Et.defaultCombo.size[0] / 2,
        width: i.width || Et.defaultCombo.size[0],
        height: i.height || Et.defaultCombo.size[1]
      };
      a.style = U(U(U({}, n), e.style), o);
      var s = e.padding || Et.defaultCombo.padding;
      return At(s) ? (o.r += s, o.width += s * 2, o.height += s * 2) : (o.r += s[0], o.width += s[1] + s[3] || s[1] * 2, o.height += s[0] + s[2] || s[0] * 2), this.set(j0, o), a;
    }
    return e;
  }, t.prototype.calculateCanvasBBox = function() {
    if (!this.destroyed) {
      var e = this.get("keyShape"), n = this.get("group"), i = Yv(e, n);
      i.centerX = (i.minX + i.maxX) / 2, i.centerY = (i.minY + i.maxY) / 2;
      var a = this.get(j0), o = this.get(_2) || {}, s = o.x, u = o.x;
      if (a) {
        a.width = Math.max(a.width, i.width), a.height = Math.max(a.height, i.height);
        var f = e.get("type");
        f === "circle" ? (i.width = a.r * 2, i.height = a.r * 2) : (i.width = a.width, i.height = a.height), i.minX = i.centerX - i.width / 2, i.minY = i.centerY - i.height / 2, i.maxX = i.centerX + i.width / 2, i.maxY = i.centerY + i.height / 2;
      } else
        i.width = i.maxX - i.minX, i.height = i.maxY - i.minY, i.centerX = (i.minX + i.maxX) / 2, i.centerY = (i.minY + i.maxY) / 2;
      return i.x = i.minX, i.y = i.minY, (i.x !== s || i.y !== u) && this.set(E2, null), i;
    }
  }, t.prototype.getChildren = function() {
    var e = this;
    return {
      nodes: e.getNodes(),
      combos: e.getCombos()
    };
  }, t.prototype.getNodes = function() {
    var e = this;
    return e.get("nodes");
  }, t.prototype.getCombos = function() {
    var e = this;
    return e.get("combos");
  }, t.prototype.addChild = function(e) {
    var n = this, i = e.getType();
    switch (i) {
      case "node":
        n.addNode(e);
        break;
      case "combo":
        n.addCombo(e);
        break;
      default:
        return console.warn("Only node or combo items are allowed to be added into a combo"), !1;
    }
    return !0;
  }, t.prototype.addCombo = function(e) {
    var n = this;
    return n.get("combos").push(e), !0;
  }, t.prototype.addNode = function(e) {
    var n = this;
    return n.get("nodes").push(e), !0;
  }, t.prototype.removeChild = function(e) {
    var n = this, i = e.getType();
    switch (i) {
      case "node":
        n.removeNode(e);
        break;
      case "combo":
        n.removeCombo(e);
        break;
      default:
        return console.warn("Only node or combo items are allowed to be added into a combo"), !1;
    }
    return !0;
  }, t.prototype.removeCombo = function(e) {
    if (!!e) {
      var n = this.getCombos(), i = n.indexOf(e);
      return i > -1 ? (n.splice(i, 1), !0) : !1;
    }
  }, t.prototype.removeNode = function(e) {
    if (!!e) {
      var n = this.getNodes(), i = n.indexOf(e);
      return i > -1 ? (n.splice(i, 1), !0) : !1;
    }
  }, t.prototype.getUpdateType = function(e) {
  }, t.prototype.getBBox = function() {
    this.set(w2, null);
    var e = this.calculateCanvasBBox();
    return e;
  }, t.prototype.clearCache = function() {
    this.set(_2, null), this.set(w2, null), this.set(E2, null);
  }, t.prototype.destroy = function() {
    if (!this.destroyed) {
      var e = this.get("animate"), n = this.get("group");
      e && n.stopAnimate(), n.shapeMap = {}, this.clearCache(), this.set(j0, null), this.set("bbox", null), n.remove(), this._cfg = null, this.destroyed = !0;
    }
  }, t;
}(Tb), gd = "node", yd = "edge", S2 = "vedge", Tl = "combo", HV = "default", M2 = "Mapper", to = "stateStyles", KV = function() {
  function r(t) {
    var e = this;
    this.edgeToBeUpdateMap = {}, this.throttleRefresh = Y1(function(n) {
      var i = e.graph;
      if (!(!i || i.get("destroyed"))) {
        var a = e.edgeToBeUpdateMap;
        if (!!a) {
          var o = Object.values(a);
          !o.length || (o.forEach(function(s) {
            var u = s.edge;
            if (!(!u || u.destroyed)) {
              var f = u.getSource(), l = u.getTarget();
              !f || f.destroyed || !l || l.destroyed || u.refresh(s.updateType);
            }
          }), e.edgeToBeUpdateMap = {});
        }
      }
    }, 16, {
      trailing: !0,
      leading: !0
    }), this.graph = t, this.destroyed = !1;
  }
  return r.prototype.addItem = function(t, e) {
    var n = this.graph, i = t === S2 ? yd : t, a = n.get("".concat(i, "Group")) || n.get("group"), o = Bf(i), s = null, u = n.get(i + Bf(to)) || {}, f = n.get(HV + o);
    e[to] && (u = e[to]), f && Se(f, function(w, E) {
      Xn(w) && !Dt(w) ? e[E] = kr({}, w, e[E]) : Dt(w) ? e[E] = e[E] || vr(f[E]) : e[E] = e[E] || f[E];
    });
    var l = n.get(i + M2);
    if (l) {
      var c = l(e);
      c[to] && (u = c[to], delete c[to]), Se(c, function(w, E) {
        Xn(w) && !Dt(w) ? e[E] = kr({}, e[E], w) : e[E] = c[E] || e[E];
      });
    }
    if (n.emit("beforeadditem", {
      type: t,
      model: e
    }), t === yd || t === S2) {
      var h = void 0, d = void 0;
      if (h = e.source, d = e.target, h && Qe(h) && (h = n.findById(h)), d && Qe(d) && (d = n.findById(d)), !h || !d) {
        console.warn("The source or target node of edge ".concat(e.id, " does not exist!"));
        return;
      }
      h.getType && h.getType() === "combo" && (e.isComboEdge = !0), d.getType && d.getType() === "combo" && (e.isComboEdge = !0), s = new BN({
        model: e,
        source: h,
        target: d,
        styles: u,
        linkCenter: n.get("linkCenter"),
        group: a.addGroup()
      });
    } else if (t === gd)
      s = new Tb({
        model: e,
        styles: u,
        group: a.addGroup()
      });
    else if (t === Tl) {
      var v = e.children, p = yv(v, n), g = void 0, y = void 0;
      if (isNaN(p.x) ? isNaN(e.x) && (g = Math.random() * 100) : g = p.x, isNaN(p.y) ? isNaN(e.y) && (y = Math.random() * 100) : y = p.y, isNaN(e.x) || isNaN(e.y))
        e.x = g, e.y = y;
      else {
        var b = e.x - g, m = e.y - y;
        this.updateComboSucceeds(e.id, b, m, v);
      }
      var x = a.addGroup();
      x.setZIndex(e.depth), s = new GN({
        model: e,
        styles: u,
        animate: !1,
        bbox: e.collapsed ? yv([], n) : p,
        group: x
      });
      var _ = s.getModel();
      (v || []).forEach(function(w) {
        var E = n.findById(w.id);
        s.addChild(E), w.depth = _.depth + 2;
      });
    }
    if (s)
      return n.get("".concat(t, "s")).push(s), n.get("itemMap")[s.get("id")] = s, n.emit("afteradditem", {
        item: s,
        model: e
      }), s;
  }, r.prototype.updateItem = function(t, e) {
    var n = this, i, a, o = this.graph;
    if (Qe(t) && (t = o.findById(t)), !(!t || t.destroyed)) {
      var s = "";
      t.getType && (s = t.getType());
      var u = o.get(s + M2), f = t.getModel(), l = f.x, c = f.y, h = t.getUpdateType(e);
      if (u) {
        var d = kr({}, f, e), v = u(d), p = kr({}, f, v, e);
        v[to] && (t.set("styles", p[to]), delete p[to]), Se(p, function(S, A) {
          e[A] = S;
        });
      } else
        Se(e, function(S, A) {
          f[A] && Xn(S) && !Dt(S) && (e[A] = U(U({}, f[A]), e[A]));
        });
      if (o.emit("beforeupdateitem", {
        item: t,
        cfg: e
      }), s === yd) {
        if (e.source) {
          var g = e.source;
          Qe(g) && (g = o.findById(g)), t.setSource(g);
        }
        if (e.target) {
          var y = e.target;
          Qe(y) && (y = o.findById(y)), t.setTarget(y);
        }
        t.update(e);
      } else if (s === gd) {
        t.update(e, h);
        var b = t.getEdges();
        h === "move" ? Se(b, function(S) {
          n.edgeToBeUpdateMap[S.getID()] = {
            edge: S,
            updateType: h
          }, n.throttleRefresh();
        }) : h != null && h.includes("bbox") && Se(b, function(S) {
          S.refresh(h);
        });
      } else if (s === Tl) {
        if (t.update(e, h), !isNaN(e.x) || !isNaN(e.y)) {
          var m = e.x - l || 0, x = e.y - c || 0;
          this.updateComboSucceeds(f.id, m, x);
        }
        var _ = t.getEdges(), w = (h == null ? void 0 : h.includes("bbox")) || h === "move";
        if (w && s === Tl) {
          var E = t.get("shapeFactory"), M = f.type || "circle", C = f.animate === void 0 || e.animate === void 0 ? (a = (i = E[M]) === null || i === void 0 ? void 0 : i.options) === null || a === void 0 ? void 0 : a.animate : f.animate || e.animate;
          C ? setTimeout(function() {
            if (!(!t || t.destroyed)) {
              var S = t.getKeyShape();
              !S || S.destroyed || Se(_, function(A) {
                A && !A.destroyed && A.refresh();
              });
            }
          }, 201) : Se(_, function(S) {
            S.refresh();
          });
        }
      }
      o.emit("afterupdateitem", {
        item: t,
        cfg: e
      });
    }
  }, r.prototype.updateCombo = function(t, e, n) {
    var i = this, a, o, s = this.graph;
    if (Qe(t) && (t = s.findById(t)), !(!t || t.destroyed)) {
      var u = t.getModel(), f = yv(e, s, t), l = f.x, c = f.y;
      t.set("bbox", f);
      var h = l, d = c;
      n ? (h = isNaN(u.x) ? l : u.x, d = isNaN(u.y) ? c : u.y) : (h = isNaN(l) ? u.x : l, d = isNaN(c) ? u.y : c), t.update({
        x: h,
        y: d
      });
      var v = t.get("shapeFactory"), p = u.type || "circle", g = u.animate === void 0 ? (o = (a = v[p]) === null || a === void 0 ? void 0 : a.options) === null || o === void 0 ? void 0 : o.animate : u.animate;
      g ? setTimeout(function() {
        if (!(!t || t.destroyed)) {
          var y = t.getKeyShape();
          !y || y.destroyed || (t.getShapeCfg(u), i.updateComboEdges(t));
        }
      }, 201) : this.updateComboEdges(t);
    }
  }, r.prototype.updateComboEdges = function(t) {
    for (var e = t.getEdges() || [], n = 0; n < e.length; n++) {
      var i = e[n];
      i && !i.destroyed && i.refresh();
    }
  }, r.prototype.collapseCombo = function(t, e) {
    e === void 0 && (e = !0);
    var n = this.graph;
    Qe(t) && (t = n.findById(t));
    var i = t.getChildren();
    i.nodes.forEach(function(a) {
      n.hideItem(a, e);
    }), i.combos.forEach(function(a) {
      n.hideItem(a, e);
    });
  }, r.prototype.updateComboSucceeds = function(t, e, n, i) {
    var a = this;
    i === void 0 && (i = []);
    var o = this.graph;
    if (!(!e && !n)) {
      var s = i;
      if (!(s != null && s.length)) {
        var u = o.get("comboTrees");
        u == null || u.forEach(function(f) {
          oi(f, function(l) {
            return l.id === t ? (s = l.children, !1) : !0;
          });
        });
      }
      s == null || s.forEach(function(f) {
        var l = o.findById(f.id);
        if (l) {
          var c = l.getModel();
          a.updateItem(f.id, {
            x: (c.x || 0) + e,
            y: (c.y || 0) + n
          });
        }
      });
    }
  }, r.prototype.expandCombo = function(t, e) {
    e === void 0 && (e = !0);
    var n = this.graph;
    Qe(t) && (t = n.findById(t));
    var i = t.getChildren();
    i.nodes.forEach(function(a) {
      n.showItem(a, e);
    }), i.combos.forEach(function(a) {
      a.getModel().collapsed ? a.show() : n.showItem(a, e);
    });
  }, r.prototype.removeItem = function(t) {
    var e = this, n = this.graph;
    if (Qe(t) && (t = n.findById(t)), !(!t || t.destroyed)) {
      var i = vr(t.getModel());
      n.emit("beforeremoveitem", {
        item: i
      });
      var a = "";
      t.getType && (a = t.getType());
      var o = n.get("".concat(a, "s")), s = o.indexOf(t);
      if (s > -1 && o.splice(s, 1), a === yd) {
        var u = n.get("v".concat(a, "s")), f = u.indexOf(t);
        f > -1 && u.splice(f, 1);
      }
      var l = t.get("id"), c = n.get("itemMap");
      delete c[l];
      var h = n.get("comboTrees"), d = t.get("id");
      if (a === gd) {
        var v = t.getModel().comboId;
        if (h && v) {
          var p = h, g = !1;
          h.forEach(function(w) {
            g || oi(w, function(E) {
              if (E.id === d && p) {
                var M = p.indexOf(E);
                return p.splice(M, 1), g = !0, !1;
              }
              return p = E.children, !0;
            });
          });
        }
        for (var y = t.getEdges(), b = y.length - 1; b >= 0; b--)
          n.removeItem(y[b], !1);
        v && n.updateCombo(v);
      } else if (a === Tl) {
        var m = t.getModel().parentId, x, _ = !1;
        (h || []).forEach(function(E) {
          _ || oi(E, function(M) {
            return M.id === d ? (x = M, _ = !0, !1) : !0;
          });
        }), x.removed = !0, x && x.children && x.children.forEach(function(E) {
          e.removeItem(E.id);
        });
        for (var y = t.getEdges(), b = y.length; b >= 0; b--)
          n.removeItem(y[b], !1);
        m && n.updateCombo(m);
      }
      t.destroy(), n.emit("afterremoveitem", {
        item: i,
        type: a
      });
    }
  }, r.prototype.setItemState = function(t, e, n) {
    var i = this.graph, a = e;
    Qe(n) && (a = "".concat(e, ":").concat(n)), !(t.hasState(a) === n && n || Qe(n) && t.hasState(a)) && (i.emit("beforeitemstatechange", {
      item: t,
      state: a,
      enabled: n
    }), t.setState(e, n), i.autoPaint(), i.emit("afteritemstatechange", {
      item: t,
      state: a,
      enabled: n
    }));
  }, r.prototype.priorityState = function(t, e) {
    var n = this.graph, i = t;
    Qe(t) && (i = n.findById(t)), this.setItemState(i, e, !1), this.setItemState(i, e, !0);
  }, r.prototype.clearItemStates = function(t, e) {
    var n = this.graph;
    Qe(t) && (t = n.findById(t)), n.emit("beforeitemstatesclear", {
      item: t,
      states: e
    }), t.clearStates(e), n.emit("afteritemstatesclear", {
      item: t,
      states: e
    });
  }, r.prototype.refreshItem = function(t) {
    var e = this.graph;
    Qe(t) && (t = e.findById(t)), e.emit("beforeitemrefresh", {
      item: t
    }), t.refresh(), e.emit("afteritemrefresh", {
      item: t
    });
  }, r.prototype.addCombos = function(t, e) {
    var n = this, i = this.graph;
    (t || []).forEach(function(o) {
      wa(o, function(s) {
        var u;
        return e.forEach(function(f) {
          f.id === s.id && (f.children = s.children, f.depth = s.depth, u = f);
        }), u && n.addItem("combo", u), !0;
      });
    });
    var a = i.get("comboGroup");
    a && a.sort();
  }, r.prototype.changeItemVisibility = function(t, e) {
    var n = this, i = this.graph;
    if (Qe(t) && (t = i.findById(t)), !t) {
      console.warn("The item to be shown or hidden does not exist!");
      return;
    }
    if (i.emit("beforeitemvisibilitychange", {
      item: t,
      visible: e
    }), t.changeVisibility(e), t.getType && t.getType() === gd) {
      var a = t.getEdges();
      Se(a, function(l) {
        e && !(l.get("source").isVisible() && l.get("target").isVisible()) || n.changeItemVisibility(l, e);
      });
    } else if (t.getType && t.getType() === Tl) {
      var o = i.get("comboTrees"), s = t.get("id"), u = [], f = !1;
      (o || []).forEach(function(c) {
        f || !c.children || c.children.length === 0 || oi(c, function(h) {
          return h.id === s ? (u = h.children, f = !0, !1) : !0;
        });
      }), u && (!e || e && !t.getModel().collapsed) && u.forEach(function(c) {
        var h = i.findById(c.id);
        n.changeItemVisibility(h, e);
      });
      var a = t.getEdges();
      Se(a, function(c) {
        e && !(c.get("source").isVisible() && c.get("target").isVisible()) || n.changeItemVisibility(c, e);
      });
    }
    return i.emit("afteritemvisibilitychange", {
      item: t,
      visible: e
    }), t;
  }, r.prototype.destroy = function() {
    this.graph = null, this.destroyed = !0;
  }, r;
}(), Fs = null, qV = function() {
  function r(t) {
    this.graph = t, this.cachedStates = {
      enabled: {},
      disabled: {}
    }, this.destroyed = !1;
  }
  return r.checkCache = function(t, e, n) {
    if (!!n[e]) {
      var i = n[e].indexOf(t);
      i >= 0 && n[e].splice(i, 1);
    }
  }, r.cacheState = function(t, e, n) {
    n[e] || (n[e] = []), n[e].push(t);
  }, r.prototype.updateState = function(t, e, n) {
    var i = this, a = r.checkCache, o = r.cacheState;
    if (!t.destroyed) {
      var s = this.cachedStates, u = s.enabled, f = s.disabled;
      n ? (a(t, e, f), o(t, e, u)) : (a(t, e, u), o(t, e, f)), Fs && clearTimeout(Fs), Fs = setTimeout(function() {
        Fs = null, i.updateGraphStates();
      }, 16);
    }
  }, r.prototype.updateStates = function(t, e, n) {
    var i = this;
    Qe(e) ? this.updateState(t, e, n) : e.forEach(function(a) {
      i.updateState(t, a, n);
    });
  }, r.prototype.updateGraphStates = function() {
    var t = this.graph.get("states"), e = this.cachedStates;
    Se(e.disabled, function(n, i) {
      t[i] && (t[i] = t[i].filter(function(a) {
        return n.indexOf(a) < 0 && !n.destroyed;
      }));
    }), Se(e.enabled, function(n, i) {
      if (!t[i])
        t[i] = n;
      else {
        var a = {};
        t[i].forEach(function(o) {
          o.destroyed || (a[o.get("id")] = !0);
        }), n.forEach(function(o) {
          if (!o.destroyed) {
            var s = o.get("id");
            a[s] || (a[s] = !0, t[i].push(o));
          }
        });
      }
    }), this.graph.emit("graphstatechange", {
      states: t
    }), this.cachedStates = {
      enabled: {},
      disabled: {}
    };
  }, r.prototype.destroy = function() {
    this.graph = null, this.cachedStates = null, Fs && clearTimeout(Fs), Fs = null, this.destroyed = !0;
  }, r;
}(), ZV = function(t, e) {
  return !t || !e ? t : t.replace(/\\?\{([^{}]+)\}/g, function(n, i) {
    if (n.charAt(0) === "\\")
      return n.slice(1);
    var a = e[i];
    return a === 0 && (a = "0"), a || "";
  });
}, FN = function(t) {
  var e = [];
  if (t.length < 2)
    throw new Error("point length must largn than 2, now it's ".concat(t.length));
  for (var n = 0, i = t; n < i.length; n++) {
    var a = i[n], o = a.x, s = a.y;
    e.push(o), e.push(s);
  }
  var u = SN(e);
  return u.unshift(["M", t[0].x, t[0].y]), u;
}, Qv = function(t, e, n, i) {
  n === void 0 && (n = 0), i === void 0 && (i = 0);
  var a = {
    x: (1 - n) * t.x + n * e.x,
    y: (1 - n) * t.y + n * e.y
  }, o = [0, 0];
  us(o, [e.x - t.x, e.y - t.y]), (!o || !o[0] && !o[1]) && (o = [0, 0]);
  var s = [-o[1] * i, o[0] * i];
  return a.x += s[0], a.y += s[1], a;
}, QV = function(t, e) {
  var n = t.length;
  if (!n)
    return "";
  for (var i = "", a = "", o = 0; o < n; o++) {
    var s = t[o];
    o === 0 ? a = "M{x} {y}" : a = "L{x} {y}", i += ZV(a, s);
  }
  return e && (i += "Z"), i;
}, Cm = function(t) {
  var e = [];
  return t.forEach(function(n) {
    var i = n[0];
    if (i !== "A")
      for (var a = 1; a < n.length; a = a + 2)
        e.push([n[a], n[a + 1]]);
    else {
      var o = n.length;
      e.push([n[o - 2], n[o - 1]]);
    }
  }), e;
}, Tm = function(t) {
  if (t.length < 2)
    throw new Error("point length must largn than 2, now it's ".concat(t.length));
  var e = t[0], n = t[1], i = t[t.length - 1], a = t[t.length - 2];
  t.unshift(i), t.unshift(a), t.push(e), t.push(n);
  for (var o = [], s = 1; s < t.length - 2; s += 1) {
    var u = t[s - 1].x, f = t[s - 1].y, l = t[s].x, c = t[s].y, h = t[s + 1].x, d = t[s + 1].y, v = s !== t.length - 2 ? t[s + 2].x : h, p = s !== t.length - 2 ? t[s + 2].y : d, g = l + (h - u) / 6, y = c + (d - f) / 6, b = h - (v - l) / 6, m = d - (p - c) / 6;
    o.push(["C", g, y, b, m, h, d]);
  }
  return o.unshift(["M", i.x, i.y]), o;
}, C2 = function(t, e) {
  return Vn([0, 0], us([0, 0], t), e);
}, T2 = function(t, e) {
  var n = [t[1] - e[1], e[0] - t[0]], i = Math.sqrt(n[0] * n[0] + n[1] * n[1]);
  if (i === 0)
    throw new Error("p0 should not be equal to p1");
  return [n[0] / i, n[1] / i];
}, A2 = function(t, e) {
  return [e[0] - t[0], e[1] - t[1]];
};
function Am(r, t) {
  var e = function(c) {
    var h = [c[0][0], c[0][1] - t], d = [c[0][0], c[0][1] + t];
    return "M ".concat(h, " A ").concat(t, ",").concat(t, ",0,0,0,").concat(d, " A ").concat(t, ",").concat(t, ",0,0,0,").concat(h);
  }, n = function(c) {
    var h = Vn([0, 0], T2(c[0], c[1]), t), d = Vn([0, 0], h, -1), v = Dn([0, 0], c[0], h), p = Dn([0, 0], c[1], h), g = Dn([0, 0], c[1], d), y = Dn([0, 0], c[0], d);
    return "M ".concat(v, " L ").concat(p, " A ").concat([t, t, "0,0,0", g].join(","), " L ").concat(y, " A ").concat([t, t, "0,0,0", v].join(","));
  };
  if (!r || r.length < 1)
    return "";
  if (r.length === 1)
    return e(r);
  if (r.length === 2)
    return n(r);
  for (var i = new Array(r.length), a = 0; a < i.length; ++a) {
    var o = a === 0 ? r[r.length - 1] : r[a - 1], s = r[a], u = Vn([0, 0], T2(o, s), t);
    i[a] = [Dn([0, 0], o, u), Dn([0, 0], s, u)];
  }
  var f = "A ".concat([t, t, "0,0,0,"].join(","));
  return i = i.map(function(l, c) {
    var h = "";
    return c === 0 && (h = "M ".concat(i[i.length - 1][1], " ")), h += "".concat(f + l[0], " L ").concat(l[1]), h;
  }), i.join(" ");
}
function zN(r, t) {
  var e = r.length, n = function(l) {
    var c = [l[0][0], l[0][1] - t], h = [l[0][0], l[0][1] + t];
    return "M ".concat(c, " A ").concat([t, t, "0,0,0", h].join(","), " A ").concat([t, t, "0,0,0", c].join(","));
  }, i = function(l) {
    var c = A2(l[0], l[1]), h = C2(c, t), d = Dn([0, 0], l[0], Vn([0, 0], h, -1)), v = Dn([0, 0], l[1], h), p = 1.2 * t, g = C2(us([0, 0], c), p), y = Vn([0, 0], g, -1), b = Dn([0, 0], d, y), m = Dn([0, 0], v, y), x = Dn([0, 0], d, g);
    return "M ".concat(d, " C ").concat([b, m, v].join(","), " S ").concat([x, d].join(","), " Z");
  };
  if (!r || e < 1)
    return "";
  if (e === 1)
    return n(r);
  if (e === 2)
    return i(r);
  for (var a = r.map(function(f, l) {
    var c = r[(l + 1) % e];
    return {
      p: f,
      v: us([0, 0], A2(f, c))
    };
  }), o = 0; o < a.length; ++o) {
    var s = o > 0 ? o - 1 : e - 1, u = us([0, 0], Dn([0, 0], a[s].v, Vn([0, 0], a[o].v, -1)));
    a[o].p = Dn([0, 0], a[o].p, Vn([0, 0], u, t));
  }
  return a.map(function(f) {
    var l = f.p;
    return {
      x: l[0],
      y: l[1]
    };
  });
}
const JV = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  getSpline: FN,
  getControlPoint: Qv,
  pointsToPolygon: QV,
  pathToPoints: Cm,
  getClosedSpline: Tm,
  roundedHull: Am,
  paddedHull: zN
}, Symbol.toStringTag, { value: "Module" }));
var I2 = function(t, e, n) {
  return (t.y - n.y) * (e.x - n.x) - (t.x - n.x) * (e.y - n.y);
}, P2 = function(t) {
  var e = t.map(function(s) {
    return {
      x: s.getModel().x,
      y: s.getModel().y
    };
  });
  if (e.sort(function(s, u) {
    return s.x === u.x ? s.y - u.y : s.x - u.x;
  }), e.length === 1)
    return e;
  for (var n = [], i = 0; i < e.length; i++) {
    for (; n.length >= 2 && I2(n[n.length - 2], n[n.length - 1], e[i]) <= 0; )
      n.pop();
    n.push(e[i]);
  }
  for (var a = [], i = e.length - 1; i >= 0; i--) {
    for (; a.length >= 2 && I2(a[a.length - 2], a[a.length - 1], e[i]) <= 0; )
      a.pop();
    a.push(e[i]);
  }
  a.pop(), n.pop();
  var o = n.concat(a);
  return o;
}, eX = {
  maxRoutingIterations: 100,
  maxMarchingIterations: 100,
  pixelGroupSize: 2,
  edgeR0: 10,
  edgeR1: 10,
  nodeR0: 5,
  nodeR1: 10,
  morphBuffer: 5,
  threshold: 1e-3,
  skip: 16,
  nodeInfluenceFactor: 1,
  edgeInfluenceFactor: 1,
  negativeNodeInfluenceFactor: -0.5
};
function tX(r, t, e) {
  var n = !1, i = function(u, f) {
    return t.cells[u + f * t.width];
  }, a = function(u, f) {
    var l = 0;
    return i(u - 1, f - 1) >= e && (l += 1), i(u, f - 1) > e && (l += 2), i(u - 1, f) > e && (l += 4), i(u, f) > e && (l += 8), l;
  }, o = function(u, f) {
    for (var l = u, c = f, h, d, v = 0; v < t.width * t.height; v++) {
      if (h = l, d = c, r.findIndex(function(g) {
        return g.x === l && g.y === c;
      }) > -1) {
        if (!(r[0].x !== l || r[0].y !== c))
          return !0;
      } else
        r.push({
          x: l,
          y: c
        });
      var p = a(l, c);
      switch (p) {
        case -1:
          return console.warn("Marched out of bounds"), !0;
        case 0:
        case 3:
        case 2:
        case 7:
          l++;
          break;
        case 12:
        case 14:
        case 4:
          l--;
          break;
        case 6:
          h === 0 && (d === -1 ? l -= 1 : l += 1);
          break;
        case 1:
        case 13:
        case 5:
          c--;
          break;
        case 9:
          h === 1 && (d === 0 ? c -= 1 : c += 1);
          break;
        case 10:
        case 8:
        case 11:
          c++;
          break;
        default:
          return console.warn("Marching squares invalid state: ".concat(p)), !0;
      }
    }
  };
  this.march = function() {
    for (var s = 0; s < t.width && !n; s += 1)
      for (var u = 0; u < t.height && !n; u += 1)
        i(s, u) > e && a(s, u) !== 15 && (n = o(s, u));
    return n;
  };
}
var rX = function(t, e, n) {
  var i = Math.ceil(t / n), a = Math.ceil(e / n), o = new Float32Array(Math.max(0, i * a)).fill(0);
  return {
    cells: o,
    width: i,
    height: a
  };
}, nX = function(t, e, n) {
  var i = null, a = Number.POSITIVE_INFINITY;
  return e.forEach(function(o) {
    var s = {
      x: t.getModel().x,
      y: t.getModel().y
    }, u = {
      x: o.getModel().x,
      y: o.getModel().y
    }, f = Xv(s, u), l = new gu(s.x, s.y, u.x, u.y), c = n.reduce(function(h, d) {
      return yb(d, l) > 0 ? h + 1 : h;
    }, 0);
    f * Math.pow(c + 1, 2) < a && (i = o, a = f * Math.pow(c + 1, 2));
  }), i;
}, UN = function(t, e) {
  var n = Number.POSITIVE_INFINITY, i = null;
  return t.forEach(function(a) {
    var o = yb(a, e);
    o >= 0 && o < n && (i = a, n = o);
  }), i;
}, iX = function(t, e, n, i) {
  var a = [], o = [];
  o.push(t);
  for (var s = !0, u = 0, f = function(d, v) {
    var p = !1;
    return v.forEach(function(g) {
      p || (em(d, {
        x: g.x1,
        y: g.y1
      }) || em(d, {
        x: g.x2,
        y: g.y2
      })) && (p = !0);
    }), p;
  }, l = function(d, v) {
    for (var p = 0, g = v; p < g.length; p++) {
      var y = g[p], b = y.getBBox(), m = [[b.x, b.y], [b.x + b.width, b.y], [b.x, b.y + b.height], [b.x + b.width, b.y + b.height]];
      if (Pc(m, d.x, d.y))
        return !0;
    }
    return !1;
  }; s && u < n; ) {
    s = !1;
    for (var c = function() {
      var d = o.pop(), v = UN(e, d);
      if (v) {
        var p = ML(v, d), g = p[0], y = p[1];
        if (y === 2) {
          var b = function(x) {
            for (var _ = i, w = O2(v, _, g, x), E = f(w, o) || f(w, a), M = l(w, e); !E && M && _ >= 1; )
              _ /= 1.5, w = O2(v, _, g, x), E = f(w, o) || f(w, a), M = l(w, e);
            w && !E && (!x || !M) && (o.push(new gu(d.x1, d.y1, w.x, w.y)), o.push(new gu(w.x, w.y, d.x2, d.y2)), s = !0);
          };
          b(!0), s || b(!1);
        }
      }
      s || a.push(d), u += 1;
    }; !s && o.length; )
      c();
  }
  for (; o.length; )
    a.push(o.pop());
  return a;
};
function aX(r, t, e, n, i) {
  var a = nX(r, e, t);
  if (a === null)
    return [];
  var o = function(c) {
    for (var h = []; c.length > 0; ) {
      var d = c.pop();
      if (c.length === 0) {
        h.push(d);
        break;
      }
      var v = c.pop(), p = new gu(d.x1, d.y1, v.x2, v.y2), g = UN(t, p);
      g ? (h.push(d), c.push(v)) : c.push(p);
    }
    return h;
  }, s = new gu(r.getModel().x, r.getModel().y, a.getModel().x, a.getModel().y), u = iX(s, t, n, i), f = o(u);
  return f;
}
var oX = function(t, e, n) {
  var i = Object.assign(eX, n), a = CL(t.map(function(b) {
    return {
      x: b.getModel().x,
      y: b.getModel().y
    };
  }));
  t = t.sort(function(b, m) {
    return Xv({
      x: b.getModel().x,
      y: b.getModel().y
    }, a) - Xv({
      x: m.getModel().x,
      y: m.getModel().y
    }, a);
  });
  var o = [], s = [];
  t.forEach(function(b) {
    var m = aX(b, e, o, i.maxRoutingIterations, i.morphBuffer);
    m.forEach(function(x) {
      s.push(x);
    }), o.push(b);
  });
  for (var u = sX(t, s, i.nodeR0), f = rX(u.width, u.height, i.pixelGroupSize), l = [], c = [], h = 0; h < i.maxMarchingIterations; h++)
    if (uX(t, e, s, u, f, i), l = [], c = [], !!new tX(l, f, i.threshold).march()) {
      var d = l.map(function(b) {
        return {
          x: Math.round(b.x * i.pixelGroupSize + u.minX),
          y: Math.round(b.y * i.pixelGroupSize + u.minY)
        };
      });
      if (d) {
        var v = d.length;
        if (i.skip > 1)
          for (v = Math.floor(d.length / i.skip); v < 3 && i.skip > 1; )
            i.skip -= 1, v = Math.floor(d.length / i.skip);
        for (var p = 0, g = 0; g < v; g += 1, p += i.skip)
          c.push({
            x: d[p].x,
            y: d[p].y
          });
      }
      var y = function() {
        for (var m = 0, x = t; m < x.length; m++) {
          var _ = x[m], w = c.map(function(E) {
            return [E.x, E.y];
          });
          if (!Pc(w, _.getBBox().centerX, _.getBBox().centerY))
            return !1;
        }
        return !0;
      };
      if (c && y())
        return c;
      if (i.threshold *= 0.9, h <= i.maxMarchingIterations * 0.5)
        i.memberInfluenceFactor *= 1.2, i.edgeInfluenceFactor *= 1.2;
      else if (i.nonMemberInfluenceFactor !== 0 && e.length > 0)
        i.nonMemberInfluenceFactor *= 0.8;
      else
        break;
    }
  return c;
};
function sX(r, t, e) {
  var n = {
    minX: Number.POSITIVE_INFINITY,
    minY: Number.POSITIVE_INFINITY,
    maxX: Number.NEGATIVE_INFINITY,
    maxY: Number.NEGATIVE_INFINITY,
    width: 0,
    height: 0,
    x: 0,
    y: 0
  }, i = [];
  r.forEach(function(u) {
    i.push(u.getBBox());
  }), t.forEach(function(u) {
    i.push(u.getBBox());
  });
  for (var a = 0, o = i; a < o.length; a++) {
    var s = o[a];
    n.minX = (s.minX < n.minX ? s.minX : n.minX) - e, n.minY = (s.minY < n.minY ? s.minY : n.minY) - e, n.maxX = (s.maxX > n.maxX ? s.maxX : n.maxX) + e, n.maxY = (s.maxY > n.maxY ? s.maxY : n.maxY) + e;
  }
  return n.width = n.maxX - n.minX, n.height = n.maxY - n.minY, n.x = n.minX, n.y = n.minY, n;
}
function uX(r, t, e, n, i, a) {
  function o(d, v) {
    var p = Math.floor((d - v) / a.pixelGroupSize);
    return p < 0 ? 0 : p;
  }
  function s(d, v) {
    return d * a.pixelGroupSize + v;
  }
  var u = (a.nodeR0 - a.nodeR1) * (a.nodeR0 - a.nodeR1), f = (a.edgeR0 - a.edgeR1) * (a.edgeR0 - a.edgeR1), l = function(v, p) {
    var g = Math.min(o(v.minX, p + n.minX), i.width), y = Math.min(o(v.minY, p + n.minY), i.height), b = Math.min(o(v.maxX, -p + n.minX), i.width), m = Math.min(o(v.maxY, -p + n.minY), i.height);
    return [g, y, b, m];
  }, c = function(v, p) {
    for (var g = v.getBBox(), y = l(g, a.nodeR1), b = y[0], m = y[1], x = y[2], _ = y[3], w = m; w < _; w += 1)
      for (var E = b; E < x; E += 1)
        if (!(p < 0 && i[E + w * i.width] <= 0)) {
          var M = s(E, n.minX), C = s(w, n.minY), S = AL({
            x: M,
            y: C
          }, {
            x: g.minX,
            y: g.minY,
            width: g.width,
            height: g.height
          });
          if (S < Math.pow(a.nodeR1, 2)) {
            var A = Math.sqrt(S) - a.nodeR1;
            i.cells[E + w * i.width] += p * A * A;
          }
        }
  }, h = function(v, p) {
    for (var g = v.getBBox(), y = l(g, a.edgeR1), b = y[0], m = y[1], x = y[2], _ = y[3], w = m; w < _; w += 1)
      for (var E = b; E < x; E += 1)
        if (!(p < 0 && i.cells[E + w * i.width] <= 0)) {
          var M = s(E, n.minX), C = s(w, n.minY), S = TL({
            x: M,
            y: C
          }, v);
          if (S < Math.pow(a.edgeR1, 2)) {
            var A = Math.sqrt(S) - a.edgeR1;
            i.cells[E + w * i.width] += p * A * A;
          }
        }
  };
  a.nodeInfluenceFactor && r.forEach(function(d) {
    c(d, a.nodeInfluenceFactor / u);
  }), a.edgeInfluenceFactor && e.forEach(function(d) {
    h(d, a.edgeInfluenceFactor / f);
  }), a.negativeNodeInfluenceFactor && t.forEach(function(d) {
    c(d, a.negativeNodeInfluenceFactor / u);
  });
}
function O2(r, t, e, n) {
  var i = r.getBBox(), a = e[0], o = e[1], s = e[2], u = e[3], f = {
    topLeft: {
      x: i.minX - t,
      y: i.minY - t
    },
    topRight: {
      x: i.maxX + t,
      y: i.minY - t
    },
    bottomLeft: {
      x: i.minX - t,
      y: i.maxY + t
    },
    bottomRight: {
      x: i.maxX + t,
      y: i.maxY + t
    }
  }, l = i.height * i.width;
  function c(v, p) {
    return i.width * ((v.y - i.minY + (p.y - i.minY)) * 0.5);
  }
  if (o) {
    if (a)
      return n ? f.topLeft : f.bottomRight;
    if (s)
      return n ? f.bottomLeft : f.topRight;
    var h = c(o, u);
    return h < l * 0.5 ? o.y > u.y ? n ? f.topLeft : f.bottomRight : n ? f.topRight : f.bottomLeft : o.y < u.y ? n ? f.bottomLeft : f.topRight : n ? f.bottomRight : f.topLeft;
  }
  if (u) {
    if (a)
      return n ? f.topRight : f.bottomLeft;
    if (s)
      return n ? f.bottomRight : f.topLeft;
  }
  var d = c(a, s);
  return d < l * 0.5 ? a.x > s.x ? n ? f.topLeft : f.bottomRight : n ? f.bottomLeft : f.topRight : a.x < s.x ? n ? f.topRight : f.bottomLeft : n ? f.bottomRight : f.topLeft;
}
var jN = function() {
  function r(t, e) {
    this.cfg = kr(this.getDefaultCfg(), e), this.graph = t, this.id = this.cfg.id, this.group = this.cfg.group, this.members = this.cfg.members.map(function(n) {
      return Qe(n) ? t.findById(n) : n;
    }), this.nonMembers = this.cfg.nonMembers.map(function(n) {
      return Qe(n) ? t.findById(n) : n;
    }), this.setPadding(), this.setType(), this.path = this.calcPath(this.members, this.nonMembers), this.render();
  }
  return r.prototype.getDefaultCfg = function() {
    return {
      id: "g6-hull",
      type: "round-convex",
      members: [],
      nonMembers: [],
      style: {
        fill: "lightblue",
        stroke: "blue",
        opacity: 0.2
      },
      padding: 10
    };
  }, r.prototype.setPadding = function() {
    var t = this.members.length && this.members[0].getKeyShape().getCanvasBBox().width / 2;
    this.padding = this.cfg.padding > 0 ? this.cfg.padding + t : 10 + t, this.cfg.bubbleCfg = {
      nodeR0: this.padding - t,
      nodeR1: this.padding - t,
      morphBuffer: this.padding - t
    };
  }, r.prototype.setType = function() {
    this.type = this.cfg.type, this.members.length < 3 && (this.type = "round-convex"), this.type !== "round-convex" && this.type !== "smooth-convex" && this.type !== "bubble" && (console.warn("The hull type should be either round-convex, smooth-convex or bubble, round-convex is used by default."), this.type = "round-convex");
  }, r.prototype.calcPath = function(t, e) {
    var n, i, a;
    switch (this.type) {
      case "round-convex":
        n = P2(t), a = Am(n.map(function(o) {
          return [o.x, o.y];
        }), this.padding), i = _m(a);
        break;
      case "smooth-convex":
        n = P2(t), n.length === 2 ? (a = Am(n.map(function(o) {
          return [o.x, o.y];
        }), this.padding), i = _m(a)) : n.length > 2 && (a = zN(n.map(function(o) {
          return [o.x, o.y];
        }), this.padding), i = Tm(a));
        break;
      case "bubble":
        n = oX(t, e, this.cfg.bubbleCfg), i = n.length >= 2 && Tm(n);
        break;
    }
    return i;
  }, r.prototype.render = function() {
    this.group.addShape("path", {
      attrs: U({
        path: this.path
      }, this.cfg.style),
      id: this.id,
      name: this.cfg.id,
      capture: !1
    }), this.group.toBack();
  }, r.prototype.addMember = function(t) {
    if (!!t) {
      Qe(t) && (t = this.graph.findById(t)), this.members.push(t);
      var e = this.nonMembers.indexOf(t);
      return e > -1 && this.nonMembers.splice(e, 1), this.updateData(this.members, this.nonMembers), !0;
    }
  }, r.prototype.addNonMember = function(t) {
    if (!!t) {
      Qe(t) && (t = this.graph.findById(t)), this.nonMembers.push(t);
      var e = this.members.indexOf(t);
      return e > -1 && this.members.splice(e, 1), this.updateData(this.members, this.nonMembers), !0;
    }
  }, r.prototype.removeMember = function(t) {
    if (!!t) {
      Qe(t) && (t = this.graph.findById(t));
      var e = this.members.indexOf(t);
      return e > -1 ? (this.members.splice(e, 1), this.updateData(this.members, this.nonMembers), !0) : !1;
    }
  }, r.prototype.removeNonMember = function(t) {
    if (!!t) {
      Qe(t) && (t = this.graph.findById(t));
      var e = this.nonMembers.indexOf(t);
      return e > -1 ? (this.nonMembers.splice(e, 1), this.updateData(this.members, this.nonMembers), !0) : !1;
    }
  }, r.prototype.updateData = function(t, e) {
    var n = this;
    this.group.findById(this.id).remove(), t && (this.members = t.map(function(i) {
      return Qe(i) ? n.graph.findById(i) : i;
    })), e && (this.nonMembers = e.map(function(i) {
      return Qe(i) ? n.graph.findById(i) : i;
    })), this.path = this.calcPath(this.members, this.nonMembers), this.render();
  }, r.prototype.updateStyle = function(t) {
    var e = this.group.findById(this.id);
    e.attr(U({}, t));
  }, r.prototype.updateCfg = function(t) {
    var e = this;
    this.cfg = kr(this.cfg, t), this.id = this.cfg.id, this.group = this.cfg.group, t.members && (this.members = this.cfg.members.map(function(n) {
      return Qe(n) ? e.graph.findById(n) : n;
    })), t.nonMembers && (this.nonMembers = this.cfg.nonMembers.map(function(n) {
      return Qe(n) ? e.graph.findById(n) : n;
    })), this.setPadding(), this.setType(), this.path = this.calcPath(this.members, this.nonMembers), this.render();
  }, r.prototype.contain = function(t) {
    var e = this, n;
    Qe(t) ? n = this.graph.findById(t) : n = t;
    var i, a = n.getKeyShape();
    if (n.get("type") === "path")
      i = Cm(a.attr("path"));
    else {
      var o = a.getCanvasBBox();
      i = [[o.minX, o.minY], [o.maxX, o.minY], [o.maxX, o.maxY], [o.minX, o.maxY]];
    }
    return i = i.map(function(s) {
      var u = e.graph.getPointByCanvas(s[0], s[1]);
      return [u.x, u.y];
    }), SL(i, Cm(this.path));
  }, r.prototype.destroy = function() {
    this.group.remove(), this.cfg = null;
  }, r;
}(), Al = $i, fX = "node", $N = function(r) {
  Ht(t, r);
  function t(e) {
    var n = r.call(this) || this;
    return n.sortCombos = Jc(function() {
      var i = n.get("comboSorted");
      if (!(!n || n.destroyed || i)) {
        n.set("comboSorted", !0);
        var a = [], o = {}, s = n.get("comboTrees");
        (s || []).forEach(function(f) {
          oi(f, function(l) {
            return a[l.depth] ? a[l.depth].push(l.id) : a[l.depth] = [l.id], o[l.id] = l.depth, !0;
          });
        });
        var u = n.getEdges().concat(n.get("vedges"));
        (u || []).forEach(function(f) {
          var l = f.getModel(), c = o[l.source] || 0, h = o[l.target] || 0, d = Math.max(c, h);
          a[d] ? a[d].push(l.id) : a[d] = [l.id];
        }), a.forEach(function(f) {
          if (!(!f || !f.length))
            for (var l = f.length - 1; l >= 0; l--) {
              var c = n.findById(f[l]);
              c && c.toFront();
            }
        });
      }
    }, 500, !1), n.cfg = kr(n.getDefaultCfg(), e), n.init(), n.animating = !1, n.destroyed = !1, n.cfg.enabledStack && (n.undoStack = new Mf(n.cfg.maxStep), n.redoStack = new Mf(n.cfg.maxStep)), n;
  }
  return t.prototype.init = function() {
    this.initCanvas();
    var e = new UV(this), n = new o9(this), i = new KV(this), a = new qV(this);
    this.set({
      viewController: e,
      modeController: n,
      itemController: i,
      stateController: a
    }), this.initLayoutController(), this.initEventController(), this.initGroups(), this.initPlugins();
  }, t.prototype.initGroups = function() {
    var e = this.get("canvas");
    if (!!e) {
      var n = e.get("el"), i = (n || {}).id, a = i === void 0 ? "g6" : i, o = e.addGroup({
        id: "".concat(a, "-root"),
        className: Et.rootContainerClassName
      });
      if (this.get("groupByTypes")) {
        var s = o.addGroup({
          id: "".concat(a, "-edge"),
          className: Et.edgeContainerClassName
        }), u = o.addGroup({
          id: "".concat(a, "-node"),
          className: Et.nodeContainerClassName
        }), f = o.addGroup({
          id: "".concat(a, "-combo"),
          className: Et.comboContainerClassName
        });
        f.toBack(), this.set({
          nodeGroup: u,
          edgeGroup: s,
          comboGroup: f
        });
      }
      var l = o.addGroup({
        id: "".concat(a, "-delegate"),
        className: Et.delegateContainerClassName
      });
      this.set({
        delegateGroup: l
      }), this.set("group", o);
    }
  }, t.prototype.getDefaultCfg = function() {
    return {
      container: void 0,
      width: void 0,
      height: void 0,
      renderer: "canvas",
      modes: {},
      plugins: [],
      data: {},
      fitViewPadding: 10,
      minZoom: 0.02,
      maxZoom: 10,
      event: !0,
      groupByTypes: !0,
      directed: !1,
      autoPaint: !0,
      nodes: [],
      edges: [],
      combos: [],
      vedges: [],
      itemMap: {},
      linkCenter: !1,
      defaultNode: {},
      defaultEdge: {},
      nodeStateStyles: {},
      edgeStateStyles: {},
      states: {},
      animate: !1,
      animateCfg: {
        onFrame: void 0,
        duration: 500,
        easing: "easeLinear"
      },
      callback: void 0,
      enabledStack: !1,
      maxStep: 10,
      tooltips: []
    };
  }, t.prototype.set = function(e, n) {
    return Rn(e) ? this.cfg = U(U({}, this.cfg), e) : this.cfg[e] = n, e === "enabledStack" && n && !this.undoStack && !this.redoStack && (this.undoStack = new Mf(this.cfg.maxStep), this.redoStack = new Mf(this.cfg.maxStep)), this;
  }, t.prototype.get = function(e) {
    var n;
    return (n = this.cfg) === null || n === void 0 ? void 0 : n[e];
  }, t.prototype.getGroup = function() {
    return this.get("group");
  }, t.prototype.getContainer = function() {
    return this.get("container");
  }, t.prototype.getMinZoom = function() {
    return this.get("minZoom");
  }, t.prototype.setMinZoom = function(e) {
    return this.set("minZoom", e);
  }, t.prototype.getMaxZoom = function() {
    return this.get("maxZoom");
  }, t.prototype.setMaxZoom = function(e) {
    return this.set("maxZoom", e);
  }, t.prototype.getWidth = function() {
    return this.get("width");
  }, t.prototype.getHeight = function() {
    return this.get("height");
  }, t.prototype.clearItemStates = function(e, n) {
    Qe(e) && (e = this.findById(e));
    var i = this.get("itemController");
    n || (n = e.get("states")), i.clearItemStates(e, n);
    var a = this.get("stateController");
    a.updateStates(e, n, !1);
  }, t.prototype.node = function(e) {
    typeof e == "function" && this.set("nodeMapper", e);
  }, t.prototype.edge = function(e) {
    typeof e == "function" && this.set("edgeMapper", e);
  }, t.prototype.combo = function(e) {
    typeof e == "function" && this.set("comboMapper", e);
  }, t.prototype.findById = function(e) {
    return this.get("itemMap")[e];
  }, t.prototype.find = function(e, n) {
    var i, a = this.get("".concat(e, "s"));
    return Se(a, function(o, s) {
      if (n(o, s))
        return i = o, i;
    }), i;
  }, t.prototype.findAll = function(e, n) {
    var i = [];
    return Se(this.get("".concat(e, "s")), function(a, o) {
      n(a, o) && i.push(a);
    }), i;
  }, t.prototype.findAllByState = function(e, n, i) {
    return i ? this.findAll(e, function(a) {
      return a.hasState(n) && i(a);
    }) : this.findAll(e, function(a) {
      return a.hasState(n);
    });
  }, t.prototype.translate = function(e, n, i, a) {
    var o = this, s = this.get("group"), u = vr(s.getMatrix());
    if (u || (u = [1, 0, 0, 0, 1, 0, 0, 0, 1]), i) {
      var f = Oc({
        animateCfg: a,
        callback: function() {
          return o.emit("viewportchange", {
            action: "translate",
            matrix: s.getMatrix()
          });
        }
      });
      Jy(s, {
        x: s.getCanvasBBox().x + e,
        y: s.getCanvasBBox().y + n
      }, i, f || {
        duration: 500,
        easing: "easeCubic"
      });
    } else
      u = Al(u, [["t", e, n]]), s.setMatrix(u), this.emit("viewportchange", {
        action: "translate",
        matrix: u
      }), this.autoPaint();
  }, t.prototype.moveTo = function(e, n, i, a) {
    var o = this.get("group");
    Jy(o, {
      x: e,
      y: n
    }, i, a || {
      duration: 500,
      easing: "easeCubic"
    }), this.emit("viewportchange", {
      action: "move",
      matrix: o.getMatrix()
    });
  }, t.prototype.fitView = function(e, n, i, a) {
    e && this.set("fitViewPadding", e);
    var o = this.get("viewController");
    n ? o.fitViewByRules(n, i, a) : o.fitView(i, a), this.autoPaint();
  }, t.prototype.fitCenter = function(e, n) {
    var i = this.get("viewController");
    i.fitCenter(e, n), this.autoPaint();
  }, t.prototype.addBehaviors = function(e, n) {
    var i = this.get("modeController");
    return i.manipulateBehaviors(e, n, !0), this;
  }, t.prototype.removeBehaviors = function(e, n) {
    var i = this.get("modeController");
    return i.manipulateBehaviors(e, n, !1), this;
  }, t.prototype.updateBehavior = function(e, n, i) {
    var a = this.get("modeController");
    return a.updateBehavior(e, n, i), this;
  }, t.prototype.zoom = function(e, n, i, a) {
    var o = this, s = this.get("group"), u = vr(s.getMatrix()) || [1, 0, 0, 0, 1, 0, 0, 0, 1], f = this.get("minZoom"), l = this.get("maxZoom"), c = this.getZoom() || 1, h = c * e, d = e, v = !1;
    if (f && h < f ? (d = f / c, v = !0) : l && h > l && (d = l / c, v = !0), n ? u = Al(u, [["t", -n.x, -n.y], ["s", d, d], ["t", n.x, n.y]]) : u = Al(u, [["s", d, d]]), i) {
      var p = vr(s.getMatrix());
      p || (p = [1, 0, 0, 0, 1, 0, 0, 0, 1]);
      var g = p[0], y = g * d, b = Oc({
        animateCfg: a,
        callback: function() {
          return o.emit("viewportchange", {
            action: "zoom",
            matrix: s.getMatrix()
          });
        }
      });
      s.animate(function(m) {
        if (m === 1)
          p = u;
        else {
          var x = mb(g, y, m) / p[0];
          n ? p = Al(p, [["t", -n.x, -n.y], ["s", x, x], ["t", n.x, n.y]]) : p = Al(p, [["s", x, x]]);
        }
        return {
          matrix: p
        };
      }, b);
    } else
      s.setMatrix(u), this.emit("viewportchange", {
        action: "zoom",
        matrix: u
      }), this.autoPaint();
    return !v;
  }, t.prototype.zoomTo = function(e, n, i, a) {
    var o = e / this.getZoom();
    return this.zoom(o, n, i, a);
  }, t.prototype.focusItem = function(e, n, i) {
    var a = this.get("viewController"), o = !1;
    n ? o = !0 : n === void 0 && (o = this.get("animate"));
    var s = {};
    i ? s = i : i === void 0 && (s = this.get("animateCfg")), a.focus(e, o, s), this.autoPaint();
  }, t.prototype.focusItems = function(e, n, i, a) {
    var o = this.get("viewController");
    o.focusItems(e, n, i, a);
  }, t.prototype.autoPaint = function() {
    this.get("autoPaint") && this.paint();
  }, t.prototype.paint = function() {
    this.emit("beforepaint"), this.get("canvas").draw(), this.emit("afterpaint");
  }, t.prototype.getPointByClient = function(e, n) {
    var i = this.get("viewController");
    return i.getPointByClient(e, n);
  }, t.prototype.getClientByPoint = function(e, n) {
    var i = this.get("viewController");
    return i.getClientByPoint(e, n);
  }, t.prototype.getPointByCanvas = function(e, n) {
    var i = this.get("viewController");
    return i.getPointByCanvas(e, n);
  }, t.prototype.getCanvasByPoint = function(e, n) {
    var i = this.get("viewController");
    return i.getCanvasByPoint(e, n);
  }, t.prototype.getGraphCenterPoint = function() {
    var e = this.get("group").getCanvasBBox();
    return {
      x: (e.minX + e.maxX) / 2,
      y: (e.minY + e.maxY) / 2
    };
  }, t.prototype.getViewPortCenterPoint = function() {
    return this.getPointByCanvas(this.get("width") / 2, this.get("height") / 2);
  }, t.prototype.showItem = function(e, n) {
    n === void 0 && (n = !0);
    var i = this.get("itemController"), a = i.changeItemVisibility(e, !0);
    if (n && this.get("enabledStack")) {
      var o = a.getID(), s = a.getType(), u = {}, f = {};
      switch (s) {
        case "node":
          u.nodes = [{
            id: o,
            visible: !1
          }], f.nodes = [{
            id: o,
            visible: !0
          }];
          break;
        case "edge":
          u.nodes = [{
            id: o,
            visible: !1
          }], f.edges = [{
            id: o,
            visible: !0
          }];
          break;
        case "combo":
          u.nodes = [{
            id: o,
            visible: !1
          }], f.combos = [{
            id: o,
            visible: !0
          }];
          break;
      }
      this.pushStack("visible", {
        before: u,
        after: f
      });
    }
  }, t.prototype.hideItem = function(e, n) {
    n === void 0 && (n = !0);
    var i = this.get("itemController"), a = i.changeItemVisibility(e, !1);
    if (n && this.get("enabledStack")) {
      var o = a.getID(), s = a.getType(), u = {}, f = {};
      switch (s) {
        case "node":
          u.nodes = [{
            id: o,
            visible: !0
          }], f.nodes = [{
            id: o,
            visible: !1
          }];
          break;
        case "edge":
          u.nodes = [{
            id: o,
            visible: !0
          }], f.edges = [{
            id: o,
            visible: !1
          }];
          break;
        case "combo":
          u.nodes = [{
            id: o,
            visible: !0
          }], f.combos = [{
            id: o,
            visible: !1
          }];
          break;
      }
      this.pushStack("visible", {
        before: u,
        after: f
      });
    }
  }, t.prototype.refreshItem = function(e) {
    var n = this.get("itemController");
    n.refreshItem(e);
  }, t.prototype.setAutoPaint = function(e) {
    var n = this;
    n.set("autoPaint", e);
    var i = n.get("canvas");
    i.set("autoDraw", e);
  }, t.prototype.remove = function(e, n) {
    n === void 0 && (n = !0), this.removeItem(e, n);
  }, t.prototype.removeItem = function(e, n) {
    n === void 0 && (n = !0);
    var i = e;
    if (Qe(e) && (i = this.findById(e)), !i && Qe(e))
      console.warn("The item ".concat(e, " to be removed does not exist!"));
    else if (i) {
      var a = "";
      if (i.getType && (a = i.getType()), n && this.get("enabledStack")) {
        var o = U(U({}, i.getModel()), {
          itemType: a
        }), s = {};
        switch (a) {
          case "node": {
            s.nodes = [o], s.edges = [];
            for (var u = i.getEdges(), f = u.length - 1; f >= 0; f--)
              s.edges.push(U(U({}, u[f].getModel()), {
                itemType: "edge"
              }));
            break;
          }
          case "edge":
            s.edges = [o];
            break;
          case "combo":
            s.combos = [o];
            break;
        }
        this.pushStack("delete", {
          before: s,
          after: {}
        });
      }
      if (a === "node") {
        var l = i.getModel();
        l.comboId && this.updateComboTree(i, void 0, !1);
      }
      var c = this.get("itemController");
      if (c.removeItem(i), a === "combo") {
        var h = am(this.get("comboTrees"));
        this.set("comboTrees", h);
      }
    }
  }, t.prototype.innerAddItem = function(e, n, i) {
    if (!a9(e, n))
      return !1;
    if (n.id && this.findById(n.id)) {
      console.warn("This item exists already. Be sure the id %c".concat(n.id, "%c is unique."), "font-size: 20px; color: red;", "");
      return;
    }
    var a, o = this.get("comboTrees") || [];
    if (e === "combo") {
      var s = this.get("itemMap"), u = !1;
      if (o.forEach(function(v) {
        u || wa(v, function(p) {
          if (n.parentId === p.id) {
            u = !0;
            var g = U({
              id: n.id,
              depth: p.depth + 2
            }, n);
            p.children ? p.children.push(g) : p.children = [g], n.depth = g.depth, a = i.addItem(e, n);
          }
          var y = s[p.id];
          return u && y && y.getType && y.getType() === "combo" && i.updateCombo(y, p.children), !0;
        });
      }), !u) {
        var f = U({
          id: n.id,
          depth: 0
        }, n);
        n.depth = f.depth, o.push(f), a = i.addItem(e, n);
      }
      this.set("comboTrees", o), n.collapsed && (this.collapseCombo(a, !1), this.updateCombo(a));
    } else if (e === "node" && Qe(n.comboId) && o) {
      var l = this.findById(n.comboId);
      l && l.getType && l.getType() !== "combo" && console.warn("'".concat(n.comboId, "' is not a id of a combo in the graph, the node will be added without combo.")), a = i.addItem(e, n);
      var c = this.get("itemMap"), h = !1, d = !1;
      o.forEach(function(v) {
        d || h || wa(v, function(p) {
          if (p.id === n.id)
            return d = !0, !1;
          if (n.comboId === p.id && !d) {
            h = !0;
            var g = vr(n);
            g.itemType = "node", p.children ? p.children.push(g) : p.children = [g], g.depth = p.depth + 1;
          }
          return h && c[p.id].getType && c[p.id].getType() === "combo" && i.updateCombo(c[p.id], p.children), !0;
        });
      });
    } else
      a = i.addItem(e, n);
    if (e === "node" && n.comboId || e === "combo" && n.parentId) {
      var l = this.findById(n.comboId || n.parentId);
      l && l.getType && l.getType() === "combo" && l.addChild(a);
    }
    return a;
  }, t.prototype.addItem = function(e, n, i, a) {
    i === void 0 && (i = !0), a === void 0 && (a = !0);
    var o = this.get("comboSorted");
    this.set("comboSorted", o && !a);
    var s = this.get("itemController"), u = this.innerAddItem(e, n, s);
    if (u === !1 || u === !0)
      return u;
    var f = this.get("combos");
    if (f && f.length > 0 && this.sortCombos(), this.autoPaint(), i && this.get("enabledStack")) {
      var l = U(U({}, u.getModel()), {
        itemType: e
      }), c = {};
      switch (e) {
        case "node":
          c.nodes = [l];
          break;
        case "edge":
          c.edges = [l];
          break;
        case "combo":
          c.combos = [l];
          break;
      }
      this.pushStack("add", {
        before: {},
        after: c
      });
    }
    return u;
  }, t.prototype.addItems = function(e, n, i) {
    e === void 0 && (e = []), n === void 0 && (n = !0), i === void 0 && (i = !0);
    var a = this.get("comboSorted");
    this.set("comboSorted", a && !i);
    for (var o = this.get("itemController"), s = [], u = 0; u < e.length; u++) {
      var f = e[u];
      f.type !== "edge" && f.type !== "vedge" ? s.push(this.innerAddItem(f.type, f.model, o)) : s.push(void 0);
    }
    for (var u = 0; u < e.length; u++) {
      var f = e[u];
      (f.type === "edge" || f.type === "vedge") && (s[u] = this.innerAddItem(f.type, f.model, o));
    }
    if (i) {
      var l = this.get("combos");
      l && l.length > 0 && this.sortCombos();
    }
    if (this.autoPaint(), n && this.get("enabledStack")) {
      for (var c = {
        nodes: [],
        edges: [],
        combos: []
      }, u = 0; u < e.length; u++) {
        var h = e[u].type, d = s[u];
        if (!!d && d !== !0) {
          var v = U(U({}, d.getModel()), {
            itemType: h
          });
          switch (h) {
            case "node":
              c.nodes.push(v);
              break;
            case "edge":
              c.edges.push(v);
              break;
            case "combo":
              c.combos.push(v);
              break;
          }
        }
      }
      this.pushStack("addItems", {
        before: {},
        after: c
      });
    }
    return s;
  }, t.prototype.add = function(e, n, i, a) {
    return i === void 0 && (i = !0), a === void 0 && (a = !0), this.addItem(e, n, i, a);
  }, t.prototype.updateItem = function(e, n, i) {
    var a = this;
    i === void 0 && (i = !0);
    var o = this.get("itemController"), s;
    Qe(e) ? s = this.findById(e) : s = e;
    var u = i && this.get("enabledStack"), f;
    u && (f = vr(s.getModel()));
    var l = "";
    s.getType && (l = s.getType());
    var c = Ga([], s.getStates(), !0);
    if (l === "combo" && Se(c, function(p) {
      return a.setItemState(s, p, !1);
    }), o.updateItem(s, n), l === "combo" && Se(c, function(p) {
      return a.setItemState(s, p, !0);
    }), u) {
      var h = {
        nodes: [],
        edges: [],
        combos: []
      }, d = {
        nodes: [],
        edges: [],
        combos: []
      }, v = U({
        id: f.id
      }, n);
      switch (l) {
        case "node":
          h.nodes.push(f), d.nodes.push(v);
          break;
        case "edge":
          h.edges.push(f), d.edges.push(v);
          break;
        case "combo":
          h.combos.push(f), d.combos.push(v);
          break;
      }
      this.pushStack("update", {
        before: h,
        after: d
      });
    }
  }, t.prototype.update = function(e, n, i) {
    i === void 0 && (i = !0), this.updateItem(e, n, i);
  }, t.prototype.setItemState = function(e, n, i) {
    Qe(e) && (e = this.findById(e));
    var a = this.get("itemController");
    a.setItemState(e, n, i);
    var o = this.get("stateController");
    Qe(i) ? o.updateState(e, "".concat(n, ":").concat(i), !0) : o.updateState(e, n, i);
  }, t.prototype.priorityState = function(e, n) {
    var i = this.get("itemController");
    i.priorityState(e, n);
  }, t.prototype.data = function(e) {
    _E(e), this.set("data", e);
  }, t.prototype.render = function() {
    var e = this;
    this.set("comboSorted", !1);
    var n = this.get("data");
    if (this.get("enabledStack") && this.clearStack(), !n)
      throw new Error("data must be defined first");
    var i = n.nodes, a = i === void 0 ? [] : i, o = n.edges, s = o === void 0 ? [] : o, u = n.combos, f = u === void 0 ? [] : u;
    if (this.clear(!0), this.emit("beforerender"), e.addItems(a.map(function(g) {
      return {
        type: "node",
        model: g
      };
    }), !1, !1), (f == null ? void 0 : f.length) !== 0) {
      var l = im(f, a);
      this.set("comboTrees", l), e.addCombos(f);
    }
    e.addItems(s.map(function(g) {
      return {
        type: "edge",
        model: g
      };
    }), !1, !1);
    var c = e.get("animate");
    (e.get("fitView") || e.get("fitCenter")) && e.set("animate", !1);
    var h = e.get("layoutController");
    if (h) {
      if (h.layout(d), this.destroyed)
        return;
    } else
      d();
    function d() {
      (e.get("comboTrees") || []).forEach(function(g) {
        wa(g, function(y) {
          var b = e.findById(y.id);
          return b.getType() === "combo" && y.collapsed && (e.collapseCombo(y.id, !1), e.updateCombo(b)), !0;
        });
      }), e.get("fitView") ? e.fitView() : e.get("fitCenter") && e.fitCenter(), e.autoPaint(), e.emit("afterrender"), (e.get("fitView") || e.get("fitCenter")) && e.set("animate", c), setTimeout(function() {
        var g;
        (g = e.getCombos()) === null || g === void 0 || g.forEach(function(y) {
          y.set("animate", !0);
        });
      }, 0);
    }
    if (!this.get("groupByTypes"))
      if (f && f.length !== 0)
        this.sortCombos();
      else if (n.nodes && n.edges && n.nodes.length < n.edges.length) {
        var v = this.getNodes();
        v.forEach(function(g) {
          g.toFront();
        });
      } else {
        var p = this.getEdges();
        p.forEach(function(g) {
          g.toBack();
        });
      }
    this.get("enabledStack") && this.pushStack("render");
  }, t.prototype.read = function(e) {
    this.data(e), this.render();
  }, t.prototype.diffItems = function(e, n, i) {
    var a = this, o, s = this.get("itemMap");
    Se(i, function(u) {
      if (o = s[u.id], o) {
        if (a.get("animate") && e === fX) {
          var f = o.getContainer().getMatrix();
          f || (f = [1, 0, 0, 0, 1, 0, 0, 0, 1]), o.set("originAttrs", {
            x: f[6],
            y: f[7]
          });
        }
        a.updateItem(o, u, !1);
      } else
        o = a.addItem(e, u, !1);
      o && n["".concat(e, "s")].push(o);
    });
  }, t.prototype.changeData = function(e, n) {
    var i = this, a;
    n === void 0 && (n = !0);
    var o = this, s = e || o.get("data");
    if (!_E(s))
      return this;
    this.emit("beforechangedata"), n && this.get("enabledStack") && this.pushStack("changedata", {
      before: o.save(),
      after: s
    }), this.set("comboSorted", !1), this.removeHulls(), this.getNodes().map(function(b) {
      return o.clearItemStates(b);
    }), this.getEdges().map(function(b) {
      return o.clearItemStates(b);
    });
    var u = this.get("canvas"), f = u.get("localRefresh");
    u.set("localRefresh", !1), o.get("data") || (o.data(s), o.render());
    var l = this.get("itemMap"), c = {
      nodes: [],
      edges: []
    }, h = s.combos;
    if (h) {
      var d = im(h, s.nodes);
      this.set("comboTrees", d);
    } else
      this.set("comboTrees", []);
    this.diffItems("node", c, s.nodes), Se(l, function(b, m) {
      l[m].getModel().depth = 0, !(b.getType && b.getType() === "edge") && (b.getType && b.getType() === "combo" ? (delete l[m], b.destroy()) : c.nodes.indexOf(b) < 0 && (delete l[m], o.remove(b, !1)));
    });
    for (var v = this.getCombos(), p = v.length, g = p - 1; g >= 0; g--)
      v[g].destroyed && v.splice(g, 1);
    h && (o.addCombos(h), this.get("groupByTypes") || this.sortCombos()), this.diffItems("edge", c, s.edges), Se(l, function(b, m) {
      b.getType && (b.getType() === "node" || b.getType() === "combo") || c.edges.indexOf(b) < 0 && (delete l[m], o.remove(b, !1));
    }), (this.get("comboTrees") || []).forEach(function(b) {
      wa(b, function(m) {
        var x = i.findById(m.id);
        return x.getType() === "combo" && m.collapsed && i.collapseCombo(m.id, !1), !0;
      });
    }), this.set({
      nodes: c.nodes,
      edges: c.edges
    });
    var y = this.get("layoutController");
    return y && (y.changeData(function() {
      setTimeout(function() {
        var b;
        (b = o.getCombos()) === null || b === void 0 || b.forEach(function(m) {
          m.set("animate", !0);
        });
      }, 0);
    }), o.get("animate") && !y.getLayoutType() ? (o.positionsAnimate(), (a = o.getCombos()) === null || a === void 0 || a.forEach(function(b) {
      return b.set("animate", !0);
    })) : o.autoPaint()), setTimeout(function() {
      u.set("localRefresh", f);
    }, 16), this.emit("afterchangedata"), this;
  }, t.prototype.addCombos = function(e) {
    var n = this, i = n.get("comboTrees"), a = this.get("itemController");
    a.addCombos(i, e);
  }, t.prototype.createCombo = function(e, n) {
    var i = this;
    this.set("comboSorted", !1);
    var a = "", o;
    if (!!e) {
      if (Qe(e))
        a = e, o = {
          id: e
        };
      else {
        if (a = e.id, !a) {
          console.warn("Create combo failed. Please assign a unique string id for the adding combo.");
          return;
        }
        o = e;
      }
      var s = n.map(function(f) {
        var l = i.findById(f), c = l.getModel(), h = "";
        l.getType && (h = l.getType());
        var d = {
          id: l.getID(),
          itemType: h
        };
        return h === "combo" ? (d.parentId = a, c.parentId = a) : h === "node" && (d.comboId = a, c.comboId = a), d;
      });
      o.children = s, this.addItem("combo", o, !1), this.set("comboSorted", !1);
      var u = this.get("comboTrees");
      (u || []).forEach(function(f) {
        wa(f, function(l) {
          return l.id === a ? (l.itemType = "combo", l.children = s, !1) : !0;
        });
      }), u && this.sortCombos();
    }
  }, t.prototype.uncombo = function(e) {
    var n = this, i, a = this, o = e;
    if (Qe(e) && (o = this.findById(e)), !o || o.getType && o.getType() !== "combo") {
      console.warn("The item is not a combo!");
      return;
    }
    var s = o.getModel().parentId, u = a.get("comboTrees");
    u || (u = []);
    var f = this.get("itemMap"), l = o.get("id"), c, h = [], d = this.get("combos"), v = this.findById(s);
    if (u.forEach(function(g) {
      c || wa(g, function(y) {
        var b;
        if (y.id === l) {
          c = y;
          var m = o.getEdges().map(function(_) {
            return _.getID();
          });
          m.forEach(function(_) {
            n.removeItem(_, !1);
          });
          var x = d.indexOf(o);
          d.splice(x, 1), delete f[l], o.destroy(), n.emit("afterremoveitem", {
            item: o,
            type: "combo"
          });
        }
        if (s && c && y.id === s) {
          v.removeCombo(o), h = y.children;
          var x = h.indexOf(c);
          return x !== -1 && h.splice(x, 1), (b = c.children) === null || b === void 0 || b.forEach(function(w) {
            var E = n.findById(w.id), M = E.getModel();
            E.getType && E.getType() === "combo" ? (w.parentId = s, delete w.comboId, M.parentId = s, delete M.comboId) : E.getType && E.getType() === "node" && (w.comboId = s, M.comboId = s), v.addChild(E), h.push(w);
          }), !1;
        }
        return !0;
      });
    }), !s && c) {
      var p = u.indexOf(c);
      u.splice(p, 1), (i = c.children) === null || i === void 0 || i.forEach(function(g) {
        g.parentId = void 0;
        var y = n.findById(g.id).getModel();
        delete y.parentId, delete y.comboId, g.itemType !== "node" && u.push(g);
      });
    }
  }, t.prototype.updateCombos = function(e) {
    var n = this;
    e === void 0 && (e = !1);
    var i = this, a = this.get("comboTrees"), o = i.get("itemController"), s = i.get("itemMap");
    (a || []).forEach(function(u) {
      wa(u, function(f) {
        var l;
        if (!f)
          return !0;
        var c = s[f.id];
        if (((l = c == null ? void 0 : c.getType) === null || l === void 0 ? void 0 : l.call(c)) === "combo") {
          var h = Ga([], c.getStates(), !0);
          Se(h, function(d) {
            return n.setItemState(c, d, !1);
          }), o.updateCombo(c, f.children, e), Se(h, function(d) {
            return n.setItemState(c, d, !0);
          });
        }
        return !0;
      });
    }), i.sortCombos();
  }, t.prototype.updateCombo = function(e) {
    var n = this, i = this, a = e, o;
    if (Qe(e) && (a = this.findById(e)), !a || a.getType && a.getType() !== "combo") {
      console.warn("The item to be updated is not a combo!");
      return;
    }
    o = a.get("id");
    var s = this.get("comboTrees"), u = i.get("itemController"), f = i.get("itemMap");
    (s || []).forEach(function(l) {
      wa(l, function(c) {
        if (!c)
          return !0;
        var h = f[c.id];
        if (o === c.id && h && h.getType && h.getType() === "combo") {
          var d = Ga([], h.getStates(), !0);
          Se(d, function(v) {
            h.getStateStyle(v) && n.setItemState(h, v, !1);
          }), u.updateCombo(h, c.children), Se(d, function(v) {
            h.getStateStyle(v) && n.setItemState(h, v, !0);
          }), o && (o = c.parentId);
        }
        return !0;
      });
    });
  }, t.prototype.updateComboTree = function(e, n, i) {
    i === void 0 && (i = !0);
    var a = this;
    this.set("comboSorted", !1);
    var o;
    Qe(e) ? o = a.findById(e) : o = e;
    var s = o.getModel(), u = s.comboId || s.parentId, f = "";
    if (o.getType && (f = o.getType()), n && f === "combo") {
      var l = this.get("comboTrees"), c = !0, h;
      if ((l || []).forEach(function(b) {
        h || oi(b, function(m) {
          if (!h)
            return m.id === o.getID() && (h = m), !0;
        });
      }), oi(h, function(b) {
        return b.id === n ? (c = !1, !1) : !0;
      }), !c) {
        console.warn("Failed to update the combo tree! The parentId points to a descendant of the combo!");
        return;
      }
    }
    if (i && this.get("enabledStack")) {
      var d = {}, v = {};
      f === "combo" ? (d.combos = [{
        id: s.id,
        parentId: s.parentId
      }], v.combos = [{
        id: s.id,
        parentId: n
      }]) : f === "node" && (d.nodes = [{
        id: s.id,
        parentId: s.comboId
      }], v.nodes = [{
        id: s.id,
        parentId: n
      }]), this.pushStack("updateComboTree", {
        before: d,
        after: v
      });
    }
    if (s.parentId || s.comboId) {
      var p = this.findById(s.parentId || s.comboId);
      p && p.removeChild(o);
    }
    if (f === "combo" ? s.parentId = n : f === "node" && (s.comboId = n), n) {
      var g = this.findById(n);
      g && g.addChild(o);
    }
    if (u) {
      var g = this.findById(u);
      g && g.removeChild(o);
    }
    var y = am(this.get("comboTrees"), s.id, n);
    this.set("comboTrees", y), this.updateCombos();
  }, t.prototype.save = function() {
    var e = [], n = [], i = [];
    return Se(this.get("nodes"), function(a) {
      e.push(a.getModel());
    }), Se(this.get("edges"), function(a) {
      n.push(a.getModel());
    }), Se(this.get("combos"), function(a) {
      i.push(a.getModel());
    }), {
      nodes: e,
      edges: n,
      combos: i
    };
  }, t.prototype.changeSize = function(e, n) {
    var i = this.get("viewController");
    return i.changeSize(e, n), this;
  }, t.prototype.refresh = function() {
    var e = this;
    if (e.emit("beforegraphrefresh"), e.get("animate"))
      e.positionsAnimate();
    else {
      var n = e.get("nodes"), i = e.get("edges"), a = e.get("edges");
      Se(n, function(o) {
        o.refresh();
      }), Se(i, function(o) {
        o.refresh();
      }), Se(a, function(o) {
        o.refresh();
      });
    }
    e.emit("aftergraphrefresh"), e.autoPaint();
  }, t.prototype.getNodes = function() {
    return this.get("nodes");
  }, t.prototype.getEdges = function() {
    return this.get("edges");
  }, t.prototype.getCombos = function() {
    return this.get("combos");
  }, t.prototype.getComboChildren = function(e) {
    if (Qe(e) && (e = this.findById(e)), !e || e.getType && e.getType() !== "combo") {
      console.warn("The combo does not exist!");
      return;
    }
    return e.getChildren();
  }, t.prototype.positionsAnimate = function(e) {
    var n = this;
    n.emit("beforeanimate");
    var i = n.get("animateCfg"), a = i.onFrame, o = e ? n.getNodes().concat(n.getCombos()) : n.getNodes(), s = o.map(function(f) {
      var l = f.getModel();
      return {
        id: l.id,
        x: l.x,
        y: l.y
      };
    });
    n.stopAnimate();
    var u = n.get("canvas");
    n.animating = !0, u.animate(function(f) {
      Se(s, function(l) {
        var c = n.findById(l.id);
        if (!(!c || c.destroyed)) {
          var h = c.get("originAttrs"), d = c.get("model"), v = c.getContainer().getMatrix();
          if (h == null && (v && (h = {
            x: v[6],
            y: v[7]
          }), c.set("originAttrs", h || 0)), a) {
            var p = a(c, f, l, h || {
              x: 0,
              y: 0
            });
            c.set("model", Object.assign(d, p));
          } else
            h ? (d.x = h.x + (l.x - h.x) * f, d.y = h.y + (l.y - h.y) * f) : (d.x = l.x, d.y = l.y);
        }
      }), n.refreshPositions(e);
    }, {
      duration: i.duration,
      easing: i.easing,
      callback: function() {
        Se(o, function(l) {
          l.set("originAttrs", null);
        }), i.callback && i.callback(), n.emit("afteranimate"), n.animating = !1;
      }
    });
  }, t.prototype.refreshPositions = function(e) {
    var n = this;
    n.emit("beforegraphrefreshposition");
    var i = n.get("nodes"), a = n.get("edges"), o = n.get("vedges"), s = n.get("combos"), u, f = {}, l = function(h) {
      Se(h, function(d) {
        u = d.getModel();
        var v = d.get("originAttrs");
        if (!(v && u.x === v.x && u.y === v.y)) {
          var p = d.updatePosition({
            x: u.x,
            y: u.y
          });
          f[u.id] = p, u.comboId && (f[u.comboId] = f[u.comboId] || p);
        }
      });
    };
    l(i), s && s.length !== 0 && (e && l(s), n.updateCombos()), Se(a, function(c) {
      var h = c.getSource().getModel(), d = c.getTarget();
      if (!Rn(d)) {
        var v = d.getModel();
        (f[h.id] || f[v.id] || c.getModel().isComboEdge) && c.refresh();
      }
    }), Se(o, function(c) {
      c.refresh();
    }), n.emit("aftergraphrefreshposition"), n.autoPaint();
  }, t.prototype.stopAnimate = function() {
    this.isAnimating() && this.get("canvas").stopAnimate();
  }, t.prototype.isAnimating = function() {
    return this.animating;
  }, t.prototype.getZoom = function() {
    var e = this.get("group").getMatrix();
    return e ? e[0] : 1;
  }, t.prototype.getCurrentMode = function() {
    var e = this.get("modeController");
    return e.getMode();
  }, t.prototype.setMode = function(e) {
    var n = this.get("modeController");
    return n.setMode(e), this;
  }, t.prototype.clear = function(e) {
    var n;
    return e === void 0 && (e = !1), (n = this.get("canvas")) === null || n === void 0 || n.clear(), this.initGroups(), this.set({
      itemMap: {},
      nodes: [],
      edges: [],
      vedges: [],
      groups: [],
      combos: [],
      comboTrees: []
    }), e || this.emit("afterrender"), this;
  }, t.prototype.updateLayout = function(e, n, i, a) {
    var o = this;
    e === void 0 && (e = {}), a === void 0 && (a = !0);
    var s = this.get("layoutController");
    if (Qe(e) && (e = {
      type: e
    }), n) {
      var u = i;
      u || (n === "begin" ? u = {
        x: 0,
        y: 0
      } : u = {
        x: this.getWidth() / 2,
        y: this.getHeight() / 2
      }), u = this.getPointByCanvas(u.x, u.y);
      var f = ["force", "gForce", "fruchterman", "force2"];
      f.includes(e.type) || !e.type && f.includes(s == null ? void 0 : s.layoutType) ? e.center = [u.x, u.y] : this.once("afterlayout", function(h) {
        var d = o.getGroup().getMatrix() || [1, 0, 0, 0, 1, 0, 0, 0, 1];
        u.x = u.x * d[0] + d[6], u.y = u.y * d[0] + d[7];
        var v = o.getGroup().getCanvasBBox(), p = v.minX, g = v.maxX, y = v.minY, b = v.maxY, m = {
          x: (p + g) / 2,
          y: (y + b) / 2
        };
        n === "begin" && (m.x = p, m.y = y), o.translate(u.x - m.x, u.y - m.y);
      });
    }
    var l = U({}, this.get("layout")), c = {};
    Object.assign(c, l, e), e.pipes && !e.type ? delete c.type : !e.pipes && c.type && delete c.pipes, this.set("layout", c), s && (s.isLayoutTypeSame(c) && c.gpuEnabled === l.gpuEnabled ? s.updateLayoutCfg(c) : s.changeLayout(c), a && this.get("enabledStack") && this.pushStack("layout", {
      before: l,
      after: c
    }));
  }, t.prototype.destroyLayout = function() {
    var e = this.get("layoutController");
    e == null || e.destroyLayout();
  }, t.prototype.layout = function() {
    var e, n = this.get("layoutController"), i = this.get("layout");
    if (!(!i || !n)) {
      if (i.workerEnabled) {
        n.layout();
        return;
      }
      !((e = n.layoutMethods) === null || e === void 0) && e.length ? n.relayout(!0) : n.layout();
    }
  }, t.prototype.collapseCombo = function(e, n) {
    var i = this;
    if (n === void 0 && (n = !0), !this.destroyed) {
      if (Qe(e) && (e = this.findById(e)), !e) {
        console.warn("The combo to be collapsed does not exist!");
        return;
      }
      this.emit("beforecollapseexpandcombo", {
        action: "expand",
        item: e
      });
      var a = e.getModel(), o = this.get("itemController");
      o.collapseCombo(e, n), a.collapsed = !0;
      var s = this.getEdges().concat(this.get("vedges")), u = [], f = this.get("comboTrees"), l = !1;
      (f || []).forEach(function(h) {
        l || oi(h, function(d) {
          if (l && d.depth <= a.depth)
            return !1;
          if (a.id === d.id && (l = !0), l) {
            var v = i.findById(d.id);
            v && v.getType && v.getType() === "combo" && (u = u.concat(v.getNodes()), u = u.concat(v.getCombos()));
          }
          return !0;
        });
      });
      var c = {};
      s.forEach(function(h) {
        var d = h.getModel(), v = d.isVEdge, p = d.size, g = p === void 0 ? 1 : p;
        if (!(h.isVisible() && !v)) {
          var y = h.getSource(), b = h.getTarget(), m = null, x;
          if (y.getModel().id === a.id || u.includes(y) && !u.includes(b) ? (m = b, x = !1) : (b.getModel().id === a.id || !u.includes(y) && u.includes(b)) && (m = y, x = !0), m) {
            if (v) {
              i.removeItem(h, !1);
              return;
            }
            for (var _ = m.getModel(); !m.isVisible(); ) {
              var w = _.parentId, E = _.comboId, M = w || E;
              if (m = i.findById(M), !m || !M)
                return;
              _ = m.getModel();
            }
            var C = _.id, S = x ? {
              source: C,
              target: a.id,
              size: g,
              isVEdge: !0
            } : {
              source: a.id,
              target: C,
              size: g,
              isVEdge: !0
            }, A = "".concat(S.source, "-").concat(S.target);
            if (c[A]) {
              c[A].size += g;
              return;
            }
            c[A] = S;
          }
        }
      }), this.addItems(Object.values(c).map(function(h) {
        return {
          type: "vedge",
          model: h
        };
      }), !1), this.emit("aftercollapseexpandcombo", {
        action: "collapse",
        item: e
      });
    }
  }, t.prototype.expandCombo = function(e, n) {
    var i = this;
    if (n === void 0 && (n = !0), Qe(e) && (e = this.findById(e)), !e || e.getType && e.getType() !== "combo") {
      console.warn("The combo to be collapsed does not exist!");
      return;
    }
    this.emit("beforecollapseexpandcombo", {
      action: "expand",
      item: e
    });
    var a = e.getModel(), o = this.get("itemController");
    o.expandCombo(e, n), a.collapsed = !1;
    var s = this.getEdges().concat(this.get("vedges")), u = [], f = this.get("comboTrees"), l = !1;
    (f || []).forEach(function(h) {
      l || oi(h, function(d) {
        if (l && d.depth <= a.depth)
          return !1;
        if (a.id === d.id && (l = !0), l) {
          var v = i.findById(d.id);
          v && v.getType && v.getType() === "combo" && (u = u.concat(v.getNodes()), u = u.concat(v.getCombos()));
        }
        return !0;
      });
    });
    var c = {};
    s.forEach(function(h) {
      if (!(h.isVisible() && !h.getModel().isVEdge)) {
        var d = h.getSource(), v = h.getTarget(), p = d.get("id"), g = v.get("id"), y = null, b;
        if (p === a.id || u.includes(d) && !u.includes(v) ? (y = v, b = !1) : g === a.id || !u.includes(d) && u.includes(v) ? (y = d, b = !0) : u.includes(d) && u.includes(v) && d.isVisible() && v.isVisible() && h.show(), y) {
          var m = h.getModel(), x = m.isVEdge, _ = m.size, w = _ === void 0 ? 1 : _;
          if (x) {
            i.removeItem(h, !1);
            return;
          }
          for (var E = y.getModel(); !y.isVisible(); ) {
            var M = E.parentId, C = E.comboId, S = M || C;
            if (y = i.findById(S), !y || !S)
              return;
            E = y.getModel();
          }
          for (var A = E.id, T = b ? v : d, P = T.getModel(); !T.isVisible(); ) {
            var k = P.parentId, L = P.comboId, O = k || L;
            if (T = i.findById(O), !T || !O)
              return;
            if (P.comboId === a.id || P.parentId === a.id)
              break;
            P = T.getModel();
          }
          var D = P.id;
          if (A) {
            var G = b ? {
              source: A,
              target: D,
              isVEdge: !0,
              size: w
            } : {
              source: D,
              target: A,
              isVEdge: !0,
              size: w
            }, R = "".concat(G.source, "-").concat(G.target);
            if (c[R]) {
              c[R].size += w;
              return;
            }
            c[R] = G;
          }
        }
      }
    }), this.addItems(Object.values(c).map(function(h) {
      return {
        type: "vedge",
        model: h
      };
    }), !1), this.emit("aftercollapseexpandcombo", {
      action: "expand",
      item: e
    });
  }, t.prototype.collapseExpandCombo = function(e, n) {
    if (n === void 0 && (n = !0), Qe(e) && (e = this.findById(e)), !(!e || e.getType && e.getType() !== "combo")) {
      for (var i = e.getModel(), a = this.findById(i.parentId); a; ) {
        var o = a.getModel();
        if (o.collapsed) {
          console.warn("Fail to expand the combo since it's ancestor combo is collapsed."), a = void 0;
          return;
        }
        a = this.findById(o.parentId);
      }
      var s = i.collapsed;
      s ? this.expandCombo(e, n) : this.collapseCombo(e, n), this.updateCombo(e);
    }
  }, t.prototype.getNeighbors = function(e, n) {
    var i = e;
    return Qe(e) && (i = this.findById(e)), i.getNeighbors(n);
  }, t.prototype.getNodeDegree = function(e, n, i) {
    n === void 0 && (n = void 0), i === void 0 && (i = !1);
    var a = e;
    Qe(e) && (a = this.findById(e));
    var o = this.get("degrees");
    (!o || i) && (o = Mo(this.save()), this.set("degrees", o));
    var s = o[a.getID()], u = 0;
    if (!s)
      return 0;
    switch (n) {
      case "in":
        u = s.inDegree;
        break;
      case "out":
        u = s.outDegree;
        break;
      case "all":
        u = s;
        break;
      default:
        u = s.degree;
        break;
    }
    return u;
  }, t.prototype.getUndoStack = function() {
    return this.undoStack;
  }, t.prototype.getRedoStack = function() {
    return this.redoStack;
  }, t.prototype.getStackData = function() {
    return this.get("enabledStack") ? {
      undoStack: this.undoStack.toArray(),
      redoStack: this.redoStack.toArray()
    } : null;
  }, t.prototype.clearStack = function() {
    this.get("enabledStack") && (this.undoStack.clear(), this.redoStack.clear());
  }, t.prototype.pushStack = function(e, n, i) {
    if (e === void 0 && (e = "update"), i === void 0 && (i = "undo"), !this.get("enabledStack")) {
      console.warn("\u8BF7\u5148\u542F\u7528 undo & redo \u529F\u80FD\uFF0C\u5728\u5B9E\u4F8B\u5316 Graph \u65F6\u5019\u914D\u7F6E enabledStack: true !");
      return;
    }
    var a = n ? vr(n) : {
      before: {},
      after: vr(this.save())
    };
    i === "redo" ? this.redoStack.push({
      action: e,
      data: a
    }) : this.undoStack.push({
      action: e,
      data: a
    }), this.emit("stackchange", {
      action: e,
      stackType: i,
      undoStack: this.undoStack,
      redoStack: this.redoStack
    });
  }, t.prototype.getAdjMatrix = function(e, n) {
    e === void 0 && (e = !0), n === void 0 && (n = this.get("directed"));
    var i = this.get("adjMatrix");
    return (!i || !e) && (i = pu(this.save(), n), this.set("adjMatrix", i)), i;
  }, t.prototype.getShortestPathMatrix = function(e, n) {
    e === void 0 && (e = !0), n === void 0 && (n = this.get("directed"));
    var i = this.get("adjMatrix"), a = this.get("shortestPathMatrix");
    return (!i || !e) && (i = pu(this.save(), n), this.set("adjMatrix", i)), (!a || !e) && (a = Ic(this.save(), n), this.set("shortestPathMatrix", a)), a;
  }, t.prototype.on = function(e, n, i) {
    return r.prototype.on.call(this, e, n, i);
  }, t.prototype.destroy = function() {
    var e, n, i, a, o;
    this.clear(), this.clearStack(), (e = this.get("itemController")) === null || e === void 0 || e.destroy(), (n = this.get("modeController")) === null || n === void 0 || n.destroy(), (i = this.get("viewController")) === null || i === void 0 || i.destroy(), (a = this.get("stateController")) === null || a === void 0 || a.destroy(), (o = this.get("canvas")) === null || o === void 0 || o.destroy(), this.cfg = null, this.destroyed = !0, this.redoStack = null, this.undoStack = null;
  }, t.prototype.createHull = function(e) {
    if (!e.members || e.members.length < 1) {
      console.warn("Create hull failed! The members is empty.");
      return;
    }
    var n = this.get("hullGroup"), i = this.get("hullMap");
    if (i || (i = {}, this.set("hullMap", i)), (!n || n.get("destroyed")) && (n = this.get("group").addGroup({
      id: "hullGroup"
    }), n.toBack(), this.set("hullGroup", n)), i[e.id])
      return console.warn("Existed hull id."), i[e.id];
    var a = n.addGroup({
      id: "".concat(e.id, "-container")
    }), o = new jN(this, U(U({}, e), {
      group: a
    })), s = o.id;
    return i[s] = o, o;
  }, t.prototype.getHulls = function() {
    return this.get("hullMap");
  }, t.prototype.getHullById = function(e) {
    return this.get("hullMap")[e];
  }, t.prototype.removeHull = function(e) {
    var n, i;
    Qe(e) ? i = this.getHullById(e) : i = e, (n = this.get("hullMap")) === null || n === void 0 || delete n[i.id], i.destroy();
  }, t.prototype.removeHulls = function() {
    var e = this.getHulls();
    !e || !Object.keys(e).length || (Object.keys(e).forEach(function(n) {
      var i = e[n];
      i.destroy();
    }), this.set("hullMap", {}));
  }, t;
}(FD);
function Im(r) {
  return Im = typeof Symbol == "function" && typeof Symbol.iterator == "symbol" ? function(t) {
    return typeof t;
  } : function(t) {
    return t && typeof Symbol == "function" && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t;
  }, Im(r);
}
var Zu = $i, D2 = "-shape", $0 = "-label", md = ["startArrow", "endArrow"], k2 = {
  lineWidth: 1,
  stroke: void 0,
  fill: void 0,
  lineAppendWidth: 1,
  opacity: void 0,
  strokeOpacity: void 0,
  fillOpacity: void 0,
  x: 0,
  y: 0,
  r: 10,
  width: 20,
  height: 20,
  shadowColor: void 0,
  shadowBlur: 0,
  shadowOffsetX: 0,
  shadowOffsetY: 0
}, lX = {
  lineWidth: 1,
  stroke: "#000",
  lineDash: void 0,
  startArrow: !1,
  endArrow: !1,
  opacity: void 0,
  strokeOpacity: void 0,
  fillOpacity: void 0,
  shadowColor: void 0,
  shadowBlur: 0,
  shadowOffsetX: 0,
  shadowOffsetY: 0
}, bd = {
  edge: lX,
  node: k2,
  combo: k2
}, Pm = "-label-bg", Ab = {
  options: {
    labelCfg: {
      style: {
        fontFamily: Et.windowFontFamily
      }
    },
    descriptionCfg: {
      style: {
        fontFamily: Et.windowFontFamily
      }
    }
  },
  itemType: "",
  type: "",
  getCustomConfig: function(t) {
    return {};
  },
  getOptions: function(t, e) {
    return e === "move" || (e == null ? void 0 : e.includes("bbox")) ? t : kr({}, this.options, this.getCustomConfig(t) || {}, t);
  },
  draw: function(t, e) {
    e.shapeMap = {}, this.mergeStyle = this.getOptions(t);
    var n = this.drawShape(t, e);
    if (n.set("className", this.itemType + D2), e.shapeMap[this.itemType + D2] = n, t.label) {
      var i = this.drawLabel(t, e);
      i.set("className", this.itemType + $0), e.shapeMap[this.itemType + $0] = i;
    }
    return n;
  },
  afterDraw: function(t, e, n) {
  },
  drawShape: function(t, e) {
    return null;
  },
  drawLabel: function(t, e) {
    var n = (this.mergeStyle || this.getOptions(t) || {}).labelCfg, i = n || {}, a = this.getLabelStyle(t, i, e), o = a.rotate;
    delete a.rotate;
    var s = e.addShape("text", {
      attrs: a,
      draggable: !0,
      className: "text-shape",
      name: "text-shape",
      labelRelated: !0
    });
    if (e.shapeMap["text-shape"] = s, !isNaN(o) && o !== "") {
      var u = s.getBBox(), f = [1, 0, 0, 0, 1, 0, 0, 0, 1];
      if (a.rotateCenter)
        switch (a.rotateCenter) {
          case "center":
            f = Zu(f, [["t", -u.width / 2, -u.height / 2], ["r", o], ["t", u.width / 2, u.height / 2]]);
            break;
          case "lefttop":
            f = Zu(f, [["t", -a.x, -a.y], ["r", o], ["t", a.x, a.y]]);
            break;
          case "leftcenter":
            f = Zu(f, [["t", -a.x, -a.y - u.height / 2], ["r", o], ["t", a.x, a.y + u.height / 2]]);
            break;
          default:
            f = Zu(f, [["t", -u.width / 2, -u.height / 2], ["r", o], ["t", u.width / 2, u.height / 2]]);
            break;
        }
      else
        f = Zu(f, [["t", -a.x, -a.y - u.height / 2], ["r", o], ["t", a.x, a.y + u.height / 2]]);
      s.setMatrix(f);
    }
    if (a.background) {
      var l = this.drawLabelBg(t, e, s), c = this.itemType + Pm;
      l.set("classname", c), e.shapeMap[c] = l, s.toFront();
    }
    return s;
  },
  drawLabelBg: function(t, e, n) {
    var i = this.options.labelCfg, a = kt({}, i, t.labelCfg), o = this.getLabelBgStyleByPosition(n, a), s = e.addShape("rect", {
      name: "text-bg-shape",
      attrs: o,
      labelRelated: !0
    });
    return e.shapeMap["text-bg-shape"] = s, s;
  },
  getLabelStyleByPosition: function(t, e, n) {
    return {
      text: t.label
    };
  },
  getLabelBgStyleByPosition: function(t, e) {
    return {};
  },
  getLabelStyle: function(t, e, n) {
    var i = this.getLabelStyleByPosition(t, e, n), a = "".concat(this.itemType, "Label"), o = Et[a] ? Et[a].style : null;
    return U(U(U({}, o), i), e.style);
  },
  getShapeStyle: function(t) {
    return t.style;
  },
  update: function(t, e, n) {
    this.updateShapeStyle(t, e, n), this.updateLabel(t, e, n);
  },
  updateShapeStyle: function(t, e, n) {
    var i, a = e.getContainer(), o = e.getKeyShape(), s = kt({}, o.attr(), t.style), u = function(c) {
      var h, d = s[c];
      if (Rn(d)) {
        var v = ((i = a.shapeMap) === null || i === void 0 ? void 0 : i[c]) || a.find(function(p) {
          return p.get("name") === c;
        });
        v == null || v.attr(d);
      } else
        o.attr((h = {}, h[c] = d, h));
    };
    for (var f in s)
      u(f);
  },
  updateLabel: function(t, e, n) {
    var i, a;
    if (t.label || t.label === "") {
      var o = e.getContainer(), s = (this.mergeStyle || this.getOptions({}, n) || {}).labelCfg, u = s === void 0 ? {} : s, f = this.itemType + $0, l = o.shapeMap[f] || o.find(function(x) {
        return x.get("className") === f;
      }), c = this.itemType + Pm, h = o.shapeMap[c] || o.find(function(x) {
        return x.get("className") === c;
      });
      if (l) {
        (!n || n === "bbox|label" || this.itemType === "edge" && n !== "style") && (u = kr(u, t.labelCfg));
        var v = this.getLabelStyleByPosition(t, u, o), p = (i = t.labelCfg) === null || i === void 0 ? void 0 : i.style, g = U(U({}, v), p), y = g.rotate;
        if (delete g.rotate, !isNaN(y) && y !== "") {
          var b = [1, 0, 0, 0, 1, 0, 0, 0, 1];
          b = Zu(b, [["t", -g.x, -g.y], ["r", y], ["t", g.x, g.y]]), g.matrix = b, l.attr(g);
        } else
          ((a = l.getMatrix()) === null || a === void 0 ? void 0 : a[4]) !== 1 && l.resetMatrix(), l.attr(g);
        if (!h)
          g.background && (h = this.drawLabelBg(t, o, l), h.set("classname", c), o.shapeMap[c] = h, l.toFront());
        else if (g.background) {
          var m = this.getLabelBgStyleByPosition(l, u);
          h.attr(m);
        } else
          o.removeChild(h);
      } else {
        var d = this.drawLabel(t, o);
        d.set("className", f), o.shapeMap[f] = d;
      }
    }
  },
  afterUpdate: function(t, e) {
  },
  setState: function(t, e, n) {
    var i, a, o, s = n.get("keyShape");
    if (!(!s || s.destroyed)) {
      var u = n.getType(), f = W1(e) ? t : "".concat(t, ":").concat(e), l = this.getStateStyle(f, n), c = n.getStateStyle(f);
      if (!(!c && !l)) {
        var h = kt({}, c || l), d = n.getContainer(), v = {
          x: 1,
          y: 1,
          cx: 1,
          cy: 1,
          matrix: 1
        };
        if (u === "combo" && (v.r = 1, v.width = 1, v.height = 1), e) {
          var p = function(O) {
            var D, G = h[O];
            if (Rn(G) && !md.includes(O)) {
              var R = ((o = d.shapeMap) === null || o === void 0 ? void 0 : o[O]) || d.find(function(F) {
                return F.get("name") === O;
              });
              R == null || R.attr(G);
            } else
              s.attr((D = {}, D[O] = G, D));
          };
          for (var g in h)
            p(g);
        } else {
          var y = mv(n.getCurrentStatesStyle()), b = n.getModel(), m = kt({}, b.style, mv(n.getOriginStyle())), x = s.get("name"), _ = s.attr(), w = {};
          Object.keys(_).forEach(function(L) {
            if (L !== "img") {
              var O = _[L];
              O && Im(O) === "object" ? w[L] = vr(O) : w[L] = O;
            }
          });
          var E = {}, M = function(O) {
            var D = h[O];
            if (Rn(D) && !md.includes(O)) {
              var G = d.shapeMap[O] || d.find(function(q) {
                return q.get("name") === O;
              });
              if (G) {
                var R = mv(G.attr());
                Se(D, function(q, ne) {
                  if (O === x && w[ne] && !v[ne]) {
                    delete w[ne];
                    var oe = m[O][ne] || bd[u][ne];
                    s.attr(ne, oe);
                  } else if (R[ne] || R[ne] === 0) {
                    delete R[ne];
                    var ie = m[O][ne] || bd[u][ne];
                    G.attr(ne, ie);
                  }
                }), E[O] = R;
              }
            } else if (w[O] && !v[O]) {
              delete w[O];
              var F = m[O] || (m[x] ? m[x][O] : void 0) || bd[u][O];
              s.attr(O, F);
            }
          };
          for (var C in h)
            M(C);
          x ? E[x] = w : kt(E, w);
          for (var g in y)
            if (!v[g]) {
              var S = y[g];
              (!Rn(S) || md.includes(g)) && (x ? (kt(m[x], (a = {}, a[g] = S, a)), delete m[g]) : kt(m, (i = {}, i[g] = S, i)), delete y[g]);
            }
          var A = {};
          kr(A, m, E, y);
          var T = !1, P = function(O) {
            var D, G, R = A[O];
            if (Rn(R) && !md.includes(O)) {
              var F = d.shapeMap[O] || d.find(function(ne) {
                return ne.get("name") === O;
              });
              F && ((F.get("type") === "text" || F.get("labelRelated")) && (delete R.x, delete R.y, delete R.matrix), O === x && (u === "combo" && (delete R.r, delete R.width, delete R.height), T = !0), F.attr(R));
            } else if (!T) {
              var q = R || bd[u][O];
              u === "combo" ? x || s.attr((D = {}, D[O] = q, D)) : s.attr((G = {}, G[O] = q, G));
            }
          };
          for (var k in A)
            P(k);
        }
      }
    }
  },
  getStateStyle: function(t, e) {
    var n = e.getModel(), i = e.getType(), a = this.getOptions(n), o = a.stateStyles, s = a.style, u = s === void 0 ? {} : s, f = n.stateStyles ? n.stateStyles[t] : o && o[t];
    return i === "combo" ? vr(f) : kt({}, u, f);
  },
  getControlPoints: function(t) {
    return t.controlPoints;
  },
  getAnchorPoints: function(t) {
    var e, n, i = (t == null ? void 0 : t.anchorPoints) || ((e = this.getCustomConfig(t)) === null || e === void 0 ? void 0 : e.anchorPoints) || ((n = this.options) === null || n === void 0 ? void 0 : n.anchorPoints);
    return i;
  }
}, cX = {
  itemType: "node",
  shapeType: "single-node",
  labelPosition: "center",
  offset: Et.nodeLabel.offset,
  getSize: function(t) {
    var e, n = ((e = this.mergeStyle) === null || e === void 0 ? void 0 : e.size) || t.size || this.getOptions({}).size || Et.defaultNode.size;
    return Dt(n) && n.length === 1 && (n = [n[0], n[0]]), Dt(n) || (n = [n, n]), n;
  },
  getLabelStyleByPosition: function(t, e) {
    var n = e.maxLength, i = t.label;
    n && (i = NL(i, n));
    var a = e.position || this.labelPosition;
    if (a === "center")
      return {
        x: 0,
        y: 0,
        text: i,
        textBaseline: "middle",
        textAlign: "center"
      };
    var o = e.offset;
    Tt(o) && (o = this.offset);
    var s = this.getSize(t), u;
    switch (a) {
      case "top":
        u = {
          x: 0,
          y: -s[1] / 2 - o,
          textBaseline: "bottom",
          textAlign: "center"
        };
        break;
      case "bottom":
        u = {
          x: 0,
          y: s[1] / 2 + o,
          textBaseline: "top",
          textAlign: "center"
        };
        break;
      case "left":
        u = {
          x: -s[0] / 2 - o,
          y: 0,
          textBaseline: "middle",
          textAlign: "right"
        };
        break;
      default:
        u = {
          x: s[0] / 2 + o,
          y: 0,
          textBaseline: "middle",
          textAlign: "left"
        };
        break;
    }
    return u.text = i, u;
  },
  getLabelBgStyleByPosition: function(t, e) {
    var n;
    if (!t)
      return {};
    var i = (n = e.style) === null || n === void 0 ? void 0 : n.background;
    if (!i)
      return {};
    var a = t.getBBox(), o = Cb(i.padding), s = a.width + o[1] + o[3], u = a.height + o[0] + o[2];
    return U(U({
      x: a.minX - o[3],
      y: a.minY - o[0]
    }, i), {
      width: s,
      height: u
    });
  },
  drawShape: function(t, e) {
    var n = this.shapeType, i = this.getShapeStyle(t), a = e.addShape(n, {
      attrs: i,
      draggable: !0,
      name: "node-shape"
    });
    return e.shapeMap["node-shape"] = a, a;
  },
  updateLinkPoints: function(t, e) {
    var n = (this.mergeStyle || this.getOptions(t)).linkPoints, i = e.shapeMap["link-point-left"] || e.find(function(A) {
      return A.get("className") === "link-point-left";
    }), a = e.shapeMap["link-point-right"] || e.find(function(A) {
      return A.get("className") === "link-point-right";
    }), o = e.shapeMap["link-point-top"] || e.find(function(A) {
      return A.get("className") === "link-point-top";
    }), s = e.shapeMap["link-point-bottom"] || e.find(function(A) {
      return A.get("className") === "link-point-bottom";
    }), u;
    i && (u = i.attr()), a && !u && (u = a.attr()), o && !u && (u = o.attr()), s && !u && (u = s.attr()), u || (u = n);
    var f = kt({}, u, t.linkPoints), l = f.fill, c = f.stroke, h = f.lineWidth, d = f.size / 2;
    d || (d = f.r);
    var v = t.linkPoints ? t.linkPoints : {
      left: void 0,
      right: void 0,
      top: void 0,
      bottom: void 0
    }, p = v.left, g = v.right, y = v.top, b = v.bottom, m = this.getSize(t), x = m[0], _ = m[1], w = {
      r: d,
      fill: l,
      stroke: c,
      lineWidth: h
    };
    if (i)
      !p && p !== void 0 ? (i.remove(), delete e.shapeMap["link-point-left"]) : i.attr(U(U({}, w), {
        x: -x / 2,
        y: 0
      }));
    else if (p) {
      var E = "link-point-left";
      e.shapeMap[E] = e.addShape("circle", {
        attrs: U(U({}, w), {
          x: -x / 2,
          y: 0
        }),
        className: E,
        name: E,
        isAnchorPoint: !0
      });
    }
    if (a)
      !g && g !== void 0 && (a.remove(), delete e.shapeMap["link-point-right"]), a.attr(U(U({}, w), {
        x: x / 2,
        y: 0
      }));
    else if (g) {
      var M = "link-point-right";
      e.shapeMap[M] = e.addShape("circle", {
        attrs: U(U({}, w), {
          x: x / 2,
          y: 0
        }),
        className: M,
        name: M,
        isAnchorPoint: !0
      });
    }
    if (o)
      !y && y !== void 0 && (o.remove(), delete e.shapeMap["link-point-top"]), o.attr(U(U({}, w), {
        x: 0,
        y: -_ / 2
      }));
    else if (y) {
      var C = "link-point-top";
      e.shapeMap[C] = e.addShape("circle", {
        attrs: U(U({}, w), {
          x: 0,
          y: -_ / 2
        }),
        className: C,
        name: C,
        isAnchorPoint: !0
      });
    }
    if (s)
      !b && b !== void 0 ? (s.remove(), delete e.shapeMap["link-point-bottom"]) : s.attr(U(U({}, w), {
        x: 0,
        y: _ / 2
      }));
    else if (b) {
      var S = "link-point-bottom";
      e.shapeMap[S] = e.addShape("circle", {
        attrs: U(U({}, w), {
          x: 0,
          y: _ / 2
        }),
        className: S,
        name: S,
        isAnchorPoint: !0
      });
    }
  },
  updateShape: function(t, e, n, i, a) {
    var o = e.get("keyShape");
    o.attr(U({}, n)), this.updateLabel(t, e, a), i && this.updateIcon(t, e);
  },
  updateIcon: function(t, e) {
    var n = this, i = e.getContainer(), a = (this.mergeStyle || this.getOptions(t)).icon, o = t.icon ? t.icon : {
      show: void 0,
      text: void 0
    }, s = o.show, u = o.text, f = i.shapeMap["".concat(this.type, "-icon")] || i.find(function(y) {
      return y.get("name") === "".concat(n.type, "-icon");
    });
    if (f)
      if (s || s === void 0) {
        var l = kt({}, f.attr(), a), c = l.width, h = c === void 0 ? 20 : c, d = l.height, v = d === void 0 ? 20 : d;
        (l.fontFamily === "iconfont" || l.hasOwnProperty("text")) && (h = 0, v = 0), f.attr(U(U({}, l), {
          x: -h / 2,
          y: -v / 2
        }));
      } else
        f.remove(), delete i.shapeMap["".concat(this.type, "-icon")];
    else if (s) {
      var p = "".concat(this.type, "-icon");
      if (u)
        i.shapeMap[p] = i.addShape("text", {
          attrs: U({
            x: 0,
            y: 0,
            fontSize: 12,
            fill: "#000",
            stroke: "#000",
            textBaseline: "middle",
            textAlign: "center"
          }, a),
          className: p,
          name: p
        });
      else {
        var h = a.width, v = a.height;
        i.shapeMap[p] = i.addShape("image", {
          attrs: U(U({}, a), {
            x: -h / 2,
            y: -v / 2
          }),
          className: p,
          name: p
        });
      }
      var g = i.shapeMap["node-label"] || i.find(function(y) {
        return y.get("name") === "node-label";
      });
      g && g.toFront();
    }
  }
}, hX = U(U({}, Ab), cX);
Or.registerNode("single-node", hX);
var xd = "edge-shape";
function dX(r) {
  var t = r;
  return r === "start" ? t = "end" : r === "end" && (t = "start"), t;
}
var vX = {
  itemType: "edge",
  labelPosition: "center",
  refX: 0,
  refY: 0,
  labelAutoRotate: !1,
  options: {
    size: Et.defaultEdge.size,
    style: {
      x: 0,
      y: 0,
      stroke: Et.defaultEdge.style.stroke,
      lineAppendWidth: Et.defaultEdge.style.lineAppendWidth
    },
    labelCfg: {
      style: {
        fill: Et.edgeLabel.style.fill,
        fontSize: Et.edgeLabel.style.fontSize,
        fontFamily: Et.windowFontFamily
      }
    },
    stateStyles: U({}, Et.edgeStateStyles)
  },
  getPath: function(t) {
    var e = [];
    return Se(t, function(n, i) {
      i === 0 ? e.push(["M", n.x, n.y]) : e.push(["L", n.x, n.y]);
    }), e;
  },
  getShapeStyle: function(t) {
    var e = this.options.style, n = {
      stroke: t.color
    }, i = kt({}, e, n, t.style), a = t.size || Et.defaultEdge.size;
    t = this.getPathPoints(t);
    var o = t.startPoint, s = t.endPoint, u = this.getControlPoints(t), f = [o];
    u && (f = f.concat(u)), f.push(s);
    var l = this.getPath(f), c = kt({}, Et.defaultEdge.style, {
      stroke: Et.defaultEdge.color,
      lineWidth: a,
      path: l
    }, i);
    return c;
  },
  updateShapeStyle: function(t, e, n) {
    var i, a = e.getContainer(), o = ((i = e.getKeyShape) === null || i === void 0 ? void 0 : i.call(e)) || a.shapeMap["edge-shape"], s = t.size;
    t = this.getPathPoints(t);
    var u = t.startPoint, f = t.endPoint, l = this.getControlPoints(t), c = [u];
    l && (c = c.concat(l)), c.push(f);
    var h = o.attr(), d = t.style || {};
    d.stroke === void 0 && (d.stroke = t.color);
    var v = t.sourceNode, p = t.targetNode, g = {
      radius: d.radius
    };
    l || (g = {
      source: v,
      target: p,
      offset: d.offset,
      radius: d.radius
    });
    var y = this.getPath(c, g), b = {};
    n === "move" ? b = {
      path: y
    } : (h.endArrow && d.endArrow === !1 && (t.style.endArrow = {
      path: ""
    }), h.startArrow && d.startArrow === !1 && (t.style.startArrow = {
      path: ""
    }), b = U({}, t.style), b.lineWidth === void 0 && (b.lineWdith = (At(s) ? s : s == null ? void 0 : s[0]) || h.lineWidth), b.path === void 0 && (b.path = y), b.stroke === void 0 && (b.stroke = h.stroke || t.color)), o && o.attr(b);
  },
  getLabelStyleByPosition: function(t, e, n) {
    var i = e.position || this.labelPosition, a = {}, o = n == null ? void 0 : n.shapeMap[xd], s;
    i === "start" ? s = 0 : i === "end" ? s = 1 : s = 0.5;
    var u = e.refX || this.refX, f = e.refY || this.refY;
    if (t.startPoint.x === t.endPoint.x && t.startPoint.y === t.endPoint.y)
      return a.x = t.startPoint.x + u, a.y = t.startPoint.y + f, a.text = t.label, a;
    var l;
    Tt(e.autoRotate) ? l = this.labelAutoRotate : l = e.autoRotate;
    var c = OL(o, s, u, f, l);
    return a.x = c.x, a.y = c.y, a.rotate = c.rotate, a.textAlign = this._getTextAlign(i, c.angle), a.text = t.label, a;
  },
  getLabelBgStyleByPosition: function(t, e) {
    if (!t)
      return {};
    var n = t.getBBox(), i = e.style && e.style.background;
    if (!i)
      return {};
    var a = i.padding, o = n.width + a[1] + a[3], s = n.height + a[0] + a[2], u = U(U({}, i), {
      width: o,
      height: s,
      x: n.minX - a[3],
      y: n.minY - a[0],
      matrix: [1, 0, 0, 0, 1, 0, 0, 0, 1]
    }), f;
    return Tt(e.autoRotate) ? f = this.labelAutoRotate : f = e.autoRotate, f && (u.matrix = t.attr("matrix") || [1, 0, 0, 0, 1, 0, 0, 0, 1]), u;
  },
  _getTextAlign: function(t, e) {
    var n = "center";
    return e ? (e = e % (Math.PI * 2), t !== "center" && (e >= 0 && e <= Math.PI / 2 || e >= 3 / 2 * Math.PI && e < 2 * Math.PI ? n = t : n = dX(t)), n) : t;
  },
  getControlPoints: function(t) {
    return t.controlPoints;
  },
  getPathPoints: function(t) {
    return t;
  },
  drawShape: function(t, e) {
    var n = this.getShapeStyle(t), i = e.addShape("path", {
      className: xd,
      name: xd,
      attrs: n
    });
    return e.shapeMap[xd] = i, i;
  },
  drawLabel: function(t, e) {
    var n = this.options.labelCfg, i = kr({}, n, t.labelCfg), a = this.getLabelStyle(t, i, e), o = a.rotate;
    delete a.rotate;
    var s = e.addShape("text", {
      attrs: a,
      name: "text-shape",
      labelRelated: !0
    });
    if (e.shapeMap["text-shape"] = s, !isNaN(o) && o !== "" && s.rotateAtStart(o), a.background) {
      var u = this.drawLabelBg(t, e, s, a, o), f = this.itemType + Pm;
      u.set("classname", f), e.shapeMap[f] = u, s.toFront();
    }
    return s;
  },
  drawLabelBg: function(t, e, n, i, a) {
    var o = this.options.labelCfg, s = kr({}, o, t.labelCfg), u = this.getLabelBgStyleByPosition(n, s), f = e.addShape("rect", {
      name: "text-bg-shape",
      attrs: u,
      labelRelated: !0
    });
    return e.shapeMap["text-bg-shape"] = f, f;
  }
}, pX = U(U({}, Ab), vX);
Or.registerEdge("single-edge", pX);
Or.registerEdge("line", {
  getControlPoints: function() {
  }
}, "single-edge");
Or.registerEdge("spline", {
  getPath: function(t) {
    var e = FN(t);
    return e;
  }
}, "single-edge");
Or.registerEdge("arc", {
  curveOffset: 20,
  clockwise: 1,
  getControlPoints: function(t) {
    var e = t.startPoint, n = t.endPoint, i = {
      x: (e.x + n.x) / 2,
      y: (e.y + n.y) / 2
    }, a, o;
    if (t.controlPoints !== void 0) {
      if (o = t.controlPoints[0], a = Qy(e, o, n), e.x <= n.x && e.y > n.y ? this.clockwise = a.x > o.x ? 0 : 1 : e.x <= n.x && e.y < n.y ? this.clockwise = a.x > o.x ? 1 : 0 : e.x > n.x && e.y <= n.y ? this.clockwise = a.y < o.y ? 0 : 1 : this.clockwise = a.y < o.y ? 1 : 0, (o.x - e.x) / (o.y - e.y) === (n.x - e.x) / (n.y - e.y))
        return [];
    } else {
      t.curveOffset === void 0 && (t.curveOffset = this.curveOffset), Dt(t.curveOffset) && (t.curveOffset = t.curveOffset[0]), t.curveOffset < 0 ? this.clockwise = 0 : this.clockwise = 1;
      var s = {
        x: n.x - e.x,
        y: n.y - e.y
      }, u = Math.atan2(s.y, s.x);
      o = {
        x: t.curveOffset * Math.cos(-Math.PI / 2 + u) + i.x,
        y: t.curveOffset * Math.sin(-Math.PI / 2 + u) + i.y
      }, a = Qy(e, o, n);
    }
    var f = Vv(e, a), l = [{
      x: f,
      y: f
    }];
    return l;
  },
  getPath: function(t) {
    var e = [];
    return e.push(["M", t[0].x, t[0].y]), t.length === 2 ? e.push(["L", t[1].x, t[1].y]) : e.push(["A", t[1].x, t[1].y, 0, 0, this.clockwise, t[2].x, t[2].y]), e;
  }
}, "single-edge");
Or.registerEdge("quadratic", {
  curvePosition: 0.5,
  curveOffset: -20,
  getControlPoints: function(t) {
    var e = t.controlPoints;
    if (!e || !e.length) {
      var n = t.startPoint, i = t.endPoint;
      t.curveOffset === void 0 && (t.curveOffset = this.curveOffset), t.curvePosition === void 0 && (t.curvePosition = this.curvePosition), Dt(this.curveOffset) && (t.curveOffset = t.curveOffset[0]), Dt(this.curvePosition) && (t.curvePosition = t.curveOffset[0]);
      var a = Qv(n, i, t.curvePosition, t.curveOffset);
      e = [a];
    }
    return e;
  },
  getPath: function(t) {
    var e = [];
    return e.push(["M", t[0].x, t[0].y]), e.push(["Q", t[1].x, t[1].y, t[2].x, t[2].y]), e;
  }
}, "single-edge");
Or.registerEdge("cubic", {
  curvePosition: [1 / 2, 1 / 2],
  curveOffset: [-20, 20],
  getControlPoints: function(t) {
    var e = t.controlPoints;
    if (t.curveOffset === void 0 && (t.curveOffset = this.curveOffset), t.curvePosition === void 0 && (t.curvePosition = this.curvePosition), At(t.curveOffset) && (t.curveOffset = [t.curveOffset, -t.curveOffset]), At(t.curvePosition) && (t.curvePosition = [t.curvePosition, 1 - t.curvePosition]), !e || !e.length || e.length < 2) {
      var n = t.startPoint, i = t.endPoint, a = Qv(n, i, t.curvePosition[0], t.curveOffset[0]), o = Qv(n, i, t.curvePosition[1], t.curveOffset[1]);
      e = [a, o];
    }
    return e;
  },
  getPath: function(t) {
    var e = [];
    return e.push(["M", t[0].x, t[0].y]), e.push(["C", t[1].x, t[1].y, t[2].x, t[2].y, t[3].x, t[3].y]), e;
  }
}, "single-edge");
Or.registerEdge("cubic-vertical", {
  curvePosition: [1 / 2, 1 / 2],
  minCurveOffset: [0, 0],
  curveOffset: void 0,
  getControlPoints: function(t) {
    var e = t.startPoint, n = t.endPoint;
    t.curvePosition === void 0 && (t.curvePosition = this.curvePosition), t.curveOffset === void 0 && (t.curveOffset = this.curveOffset), t.minCurveOffset === void 0 && (t.minCurveOffset = this.minCurveOffset), At(t.curveOffset) && (t.curveOffset = [t.curveOffset, -t.curveOffset]), At(t.minCurveOffset) && (t.minCurveOffset = [t.minCurveOffset, -t.minCurveOffset]), At(t.curvePosition) && (t.curvePosition = [t.curvePosition, 1 - t.curvePosition]);
    var i = n.y - e.y, a = [0, 0];
    t.curveOffset ? a = t.curveOffset : Math.abs(i) < Math.abs(t.minCurveOffset[0]) && (a = t.minCurveOffset);
    var o = {
      x: e.x,
      y: e.y + i * this.curvePosition[0] + a[0]
    }, s = {
      x: n.x,
      y: n.y - i * this.curvePosition[1] + a[1]
    };
    return [o, s];
  }
}, "cubic");
Or.registerEdge("cubic-horizontal", {
  curvePosition: [1 / 2, 1 / 2],
  minCurveOffset: [0, 0],
  curveOffset: void 0,
  getControlPoints: function(t) {
    var e = t.startPoint, n = t.endPoint;
    t.curvePosition === void 0 && (t.curvePosition = this.curvePosition), t.curveOffset === void 0 && (t.curveOffset = this.curveOffset), t.minCurveOffset === void 0 && (t.minCurveOffset = this.minCurveOffset), At(t.curveOffset) && (t.curveOffset = [t.curveOffset, -t.curveOffset]), At(t.minCurveOffset) && (t.minCurveOffset = [t.minCurveOffset, -t.minCurveOffset]), At(t.curvePosition) && (t.curvePosition = [t.curvePosition, 1 - t.curvePosition]);
    var i = n.x - e.x, a = [0, 0];
    t.curveOffset ? a = t.curveOffset : Math.abs(i) < Math.abs(t.minCurveOffset[0]) && (a = t.minCurveOffset);
    var o = {
      x: e.x + i * this.curvePosition[0] + a[0],
      y: e.y
    }, s = {
      x: n.x - i * this.curvePosition[1] + a[1],
      y: n.y
    }, u = [o, s];
    return u;
  }
}, "cubic");
Or.registerEdge("loop", {
  getPathPoints: function(t) {
    return PL(t);
  },
  getControlPoints: function(t) {
    return t.controlPoints;
  },
  afterDraw: function(t) {
    t.controlPoints = void 0;
  },
  afterUpdate: function(t) {
    t.controlPoints = void 0;
  }
}, "cubic");
var gX = {
  itemType: "combo",
  shapeType: "single-combo",
  labelPosition: "top",
  refX: Et.comboLabel.refX,
  refY: Et.comboLabel.refY,
  options: {
    style: {
      stroke: Et.defaultCombo.style.stroke,
      fill: Et.defaultCombo.style.fill,
      lineWidth: Et.defaultCombo.style.lineWidth
    },
    labelCfg: {
      style: {
        fill: Et.comboLabel.style.fill,
        fontSize: Et.comboLabel.style.fontSize,
        fontFamily: Et.windowFontFamily
      }
    },
    stateStyles: U({}, Et.comboStateStyles),
    collapsedSubstituteIcon: {
      show: !1,
      img: "https://gw.alipayobjects.com/mdn/rms_f8c6a0/afts/img/A*RsnHRqLfJn4AAAAAAAAAAAAAARQnAQ"
    }
  },
  getSize: function(t) {
    var e = vr(t.size || this.options.size || Et.defaultCombo.size);
    return Dt(e) && e.length === 1 && (e = [e[0], e[0]]), Dt(e) || (e = [e, e]), e;
  },
  getLabelStyleByPosition: function(t, e) {
    var n = e.position || this.labelPosition, i = t.style, a = t.padding || this.options.padding;
    Dt(a) && (a = a[0]);
    var o = e.refX, s = e.refY;
    Tt(o) && (o = this.refX), Tt(s) && (s = this.refY);
    var u = this.getSize(t), f = Math.max(i.r, u[0] / 2) || u[0] / 2, l = f + a, c;
    switch (n) {
      case "top":
        c = {
          x: 0,
          y: -l - s,
          textBaseline: "bottom",
          textAlign: "center"
        };
        break;
      case "bottom":
        c = {
          x: 0,
          y: l + s,
          textBaseline: "bottom",
          textAlign: "center"
        };
        break;
      case "left":
        c = {
          x: -l + o,
          y: 0,
          textAlign: "left"
        };
        break;
      case "center":
        c = {
          x: 0,
          y: 0,
          text: t.label,
          textAlign: "center"
        };
        break;
      default:
        c = {
          x: l + o,
          y: 0,
          textAlign: "right"
        };
        break;
    }
    return c.text = t.label, c;
  },
  drawShape: function(t, e) {
    var n = this.shapeType, i = this.getShapeStyle(t), a = e.addShape(n, {
      attrs: i,
      draggable: !0,
      name: "combo-shape"
    });
    return a;
  },
  updateCollapsedIcon: function(t, e, n) {
    var i = t.collapsed, a = t.collapsedSubstituteIcon, o = a === void 0 ? {} : a, s = Object.assign({}, this.options.collapsedSubstituteIcon, o), u = s.show, f = s.img, l = s.width, c = s.height, h = e.getContainer(), d = h.find(function(g) {
      return g.get("name") === "combo-collapsed-substitute-icon";
    }), v = d && !d.destroyed;
    if (i && u)
      if (v)
        d.show();
      else {
        var p = {
          width: l || n.r * 2 || n.width,
          height: c || n.r * 2 || n.height
        };
        h.addShape("image", {
          attrs: U({
            img: f,
            x: -p.width / 2,
            y: -p.height / 2
          }, p),
          name: "combo-collapsed-substitute-icon",
          draggable: !0
        });
      }
    else
      v && d.hide();
  },
  updateShape: function(t, e, n) {
    var i = this, a = e.get("keyShape"), o = e.get("animate"), s = o && (t.animate === void 0 ? this.options.animate : t.animate);
    s && a.animate ? (t.collapsed || this.updateCollapsedIcon(t, e, n), a.animate(n, {
      duration: 200,
      easing: "easeLinear",
      callback: function() {
        t.collapsed && i.updateCollapsedIcon(t, e, n);
      }
    })) : (a.attr(U({}, n)), this.updateCollapsedIcon(t, e, n)), this.updateLabel(t, e);
  }
}, yX = U(U({}, Ab), gX);
Or.registerCombo("single-combo", yX);
Or.registerCombo("circle", {
  options: {
    size: [Et.defaultCombo.size[0], Et.defaultCombo.size[0]],
    padding: Et.defaultCombo.padding[0],
    animate: !0,
    style: {
      stroke: Et.defaultCombo.style.stroke,
      fill: Et.defaultCombo.style.fill,
      lineWidth: Et.defaultCombo.style.lineWidth
    },
    labelCfg: {
      style: {
        fill: Et.comboLabel.style.fill,
        fontSize: Et.comboLabel.style.fontSize
      },
      refX: 0,
      refY: 0
    },
    stateStyles: U({}, Et.comboStateStyles),
    collapsedSubstituteIcon: {
      show: !1,
      img: "https://gw.alipayobjects.com/mdn/rms_f8c6a0/afts/img/A*RsnHRqLfJn4AAAAAAAAAAAAAARQnAQ"
    }
  },
  shapeType: "circle",
  labelPosition: "top",
  drawShape: function(t, e) {
    var n = this.getShapeStyle(t);
    delete n.height, delete n.width;
    var i = e.addShape("circle", {
      attrs: n,
      className: "circle-combo",
      name: "circle-combo",
      draggable: !0
    });
    return i;
  },
  getShapeStyle: function(t) {
    var e = this.options.style, n = t.padding || this.options.padding;
    Dt(n) && (n = n[0]);
    var i = {
      stroke: t.color
    }, a = kt({}, e, i, t.style), o = t.collapsed && t.fixCollapseSize ? t.fixCollapseSize : t.fixSize, s;
    if (o)
      s = At(o) ? o : o[0];
    else {
      var u = this.getSize(t);
      !At(a.r) || isNaN(a.r) ? s = u[0] / 2 || Et.defaultCombo.style.r : s = Math.max(a.r, u[0] / 2) || u[0] / 2;
    }
    a.r = s + n;
    var f = U({
      x: 0,
      y: 0
    }, a);
    return t.style ? t.style.r = s : t.style = {
      r: s
    }, f;
  },
  update: function(t, e) {
    var n = this.getSize(t), i = t.padding || this.options.padding;
    Dt(i) && (i = i[0]);
    var a = vr(t.style), o = t.collapsed && t.fixCollapseSize ? t.fixCollapseSize : t.fixSize, s;
    o ? s = At(o) ? o : o[0] : s = Math.max(a.r, n[0] / 2) || n[0] / 2, a.r = s + i;
    var u = e.get("sizeCache");
    u && (u.r = a.r);
    var f = {
      stroke: t.color
    }, l = e.get("keyShape"), c = kt({}, l.attr(), f, a);
    t.style ? t.style.r = s : t.style = {
      r: s
    }, this.updateShape(t, e, c, !0);
  }
}, "single-combo");
Or.registerCombo("rect", {
  options: {
    size: [40, 5],
    padding: [25, 20, 15, 20],
    animate: !0,
    style: {
      radius: 0,
      stroke: Et.defaultCombo.style.stroke,
      fill: Et.defaultCombo.style.fill,
      lineWidth: Et.defaultCombo.style.lineWidth
    },
    labelCfg: {
      style: {
        fill: Et.comboLabel.style.fill,
        fontSize: Et.comboLabel.style.fontSize,
        fontFamily: Et.windowFontFamily
      }
    },
    anchorPoints: [[0, 0.5], [1, 0.5]],
    stateStyles: U({}, Et.comboStateStyles),
    collapsedSubstituteIcon: {
      show: !1,
      img: "https://gw.alipayobjects.com/mdn/rms_f8c6a0/afts/img/A*RsnHRqLfJn4AAAAAAAAAAAAAARQnAQ"
    }
  },
  shapeType: "rect",
  labelPosition: "top",
  drawShape: function(t, e) {
    var n = this.getShapeStyle(t), i = e.addShape("rect", {
      attrs: n,
      className: "rect-combo",
      name: "rect-combo",
      draggable: !0
    });
    return i;
  },
  getLabelStyleByPosition: function(t, e) {
    var n = e.position || this.labelPosition, i = t.style, a = t.padding || this.options.padding;
    At(a) && (a = [a, a, a, a]);
    var o = e.refX, s = e.refY;
    Tt(o) && (o = this.refX), Tt(s) && (s = this.refY);
    var u = i.width / 2 + a[3], f = i.height / 2 + a[0], l;
    switch (n) {
      case "top":
        l = {
          x: 0 - u + o,
          y: 0 - f + s,
          textBaseline: "top",
          textAlign: "left"
        };
        break;
      case "bottom":
        l = {
          x: 0,
          y: f + s,
          textBaseline: "bottom",
          textAlign: "center"
        };
        break;
      case "left":
        l = {
          x: 0 - u + s,
          y: 0,
          textAlign: "left"
        };
        break;
      case "center":
        l = {
          x: 0,
          y: 0,
          text: t.label,
          textAlign: "center"
        };
        break;
      default:
        l = {
          x: u + o,
          y: 0,
          textAlign: "right"
        };
        break;
    }
    return l.text = t.label, l;
  },
  getShapeStyle: function(t) {
    var e = this.options.style, n = t.padding || this.options.padding;
    At(n) && (n = [n, n, n, n]);
    var i = {
      stroke: t.color
    }, a = kt({}, e, i, t.style), o = this.getSize(t), s, u, f = t.collapsed && t.fixCollapseSize ? t.fixCollapseSize : t.fixSize;
    f ? At(f) ? (s = f, u = f) : (s = f[0], u = f[1]) : (!At(a.width) || isNaN(a.width) ? s = o[0] || Et.defaultCombo.style.width : s = Math.max(a.width, o[0]) || o[0], !At(a.height) || isNaN(a.height) ? u = o[1] || Et.defaultCombo.style.height : u = Math.max(a.height, o[1]) || o[1]);
    var l = -s / 2 - n[3], c = -u / 2 - n[0];
    a.width = s + n[1] + n[3], a.height = u + n[0] + n[2];
    var h = U({
      x: l,
      y: c
    }, a);
    return t.style ? (t.style.width = s, t.style.height = u) : t.style = {
      width: s,
      height: u
    }, h;
  },
  update: function(t, e) {
    var n = this.getSize(t), i = t.padding || this.options.padding;
    At(i) && (i = [i, i, i, i]);
    var a = vr(t.style), o, s, u = t.collapsed && t.fixCollapseSize ? t.fixCollapseSize : t.fixSize;
    u ? At(u) ? (o = u, s = u) : (o = u[0], s = u[1]) : (o = Math.max(a.width, n[0]) || n[0], s = Math.max(a.height, n[1]) || n[1]), a.width = o + i[1] + i[3], a.height = s + i[0] + i[2];
    var f = e.get("sizeCache");
    f && (f.width = a.width, f.height = a.height), a.x = -o / 2 - i[3], a.y = -s / 2 - i[0];
    var l = {
      stroke: t.color
    }, c = e.get("keyShape"), h = kt({}, c.attr(), l, a);
    t.style ? (t.style.width = o, t.style.height = s) : t.style = {
      width: o,
      height: s
    }, this.updateShape(t, e, h, !1);
  }
}, "single-combo");
Or.registerNode("simple-circle", {
  options: {
    size: Et.defaultNode.size,
    style: {
      x: 0,
      y: 0,
      stroke: Et.defaultNode.style.stroke,
      fill: Et.defaultNode.style.fill,
      lineWidth: Et.defaultNode.style.lineWidth
    },
    labelCfg: {
      style: {
        fill: Et.nodeLabel.style.fill,
        fontSize: Et.nodeLabel.style.fontSize,
        fontFamily: Et.windowFontFamily
      }
    },
    stateStyles: U({}, Et.nodeStateStyles)
  },
  shapeType: "simple-circle",
  labelPosition: "center",
  shapeMap: {},
  drawShape: function(t, e) {
    var n = this.getShapeStyle(t), i = "".concat(this.type, "-keyShape"), a = e.addShape("circle", {
      attrs: n,
      className: "".concat(this.type, "-keyShape"),
      name: i,
      draggable: !0
    });
    return e.shapeMap[i] = a, a;
  },
  getShapeStyle: function(t) {
    var e = (this.mergeStyle || this.getOptions(t)).style, n = {
      stroke: t.color
    }, i = kr({}, e, n), a = this.getSize(t), o = a[0] / 2, s = U({
      x: 0,
      y: 0,
      r: o
    }, i);
    return s;
  },
  update: function(t, e, n) {
    var i = this.getSize(t), a = {
      stroke: t.color,
      r: i[0] / 2
    }, o = e.get("keyShape"), s = kr({}, o.attr(), a, t.style);
    this.updateShape(t, e, s, !0, n);
  }
}, "single-node");
Or.registerNode("simple-rect", {
  options: {
    size: [100, 30],
    style: {
      radius: 0,
      stroke: Et.defaultNode.style.stroke,
      fill: Et.defaultNode.style.fill,
      lineWidth: Et.defaultNode.style.lineWidth
    },
    labelCfg: {
      style: {
        fill: Et.nodeLabel.style.fill,
        fontSize: Et.nodeLabel.style.fontSize,
        fontFamily: Et.windowFontFamily
      }
    },
    anchorPoints: [[0, 0.5], [1, 0.5]],
    stateStyles: U({}, Et.nodeStateStyles)
  },
  shapeType: "simple-rect",
  labelPosition: "center",
  drawShape: function(t, e) {
    var n = this.getShapeStyle(t), i = e.addShape("rect", {
      attrs: n,
      className: "".concat(this.type, "-keyShape"),
      name: "".concat(this.type, "-keyShape"),
      draggable: !0
    });
    return i;
  },
  getShapeStyle: function(t) {
    var e = (this.mergeStyle || this.getOptions(t)).style, n = {
      stroke: t.color
    }, i = kt({}, e, n), a = this.getSize(t), o = i.width || a[0], s = i.height || a[1], u = U({
      x: -o / 2,
      y: -s / 2,
      width: o,
      height: s
    }, i);
    return u;
  },
  update: function(t, e, n) {
    e.getContainer();
    var i = (this.mergeStyle || this.getOptions(t)).style, a = this.getSize(t), o = e.get("keyShape");
    t.size || (a[0] = o.attr("width") || i.width, a[1] = o.attr("height") || i.height);
    var s = {
      stroke: t.color,
      x: -a[0] / 2,
      y: -a[1] / 2,
      width: a[0],
      height: a[1]
    }, u = kt({}, i, o.attr(), s);
    u = kt(u, t.style), this.updateShape(t, e, u, !1, n);
  }
}, "single-node");
Or.registerNode("image", {
  options: {
    img: "https://gw.alipayobjects.com/mdn/rms_f8c6a0/afts/img/A*eD7nT6tmYgAAAAAAAAAAAABkARQnAQ",
    size: 200,
    labelCfg: {
      style: {
        fontFamily: Et.windowFontFamily
      }
    },
    clipCfg: {
      show: !1,
      type: "circle",
      r: 50,
      rx: 50,
      ry: 35,
      width: 50,
      height: 35,
      points: [[30, 12], [12, 30], [30, 48], [48, 30]],
      path: [["M", 25, 25], ["L", 50, 25], ["A", 12.5, 12.5, 0, 1, 1, 50, 50], ["A", 12.5, 12.5, 0, 1, 0, 50, 50], ["L", 25, 75], ["Z"]],
      x: 0,
      y: 0
    }
  },
  shapeType: "image",
  labelPosition: "bottom",
  drawShape: function(t, e) {
    var n = this.shapeType, i = this.getShapeStyle(t);
    delete i.fill;
    var a = e.addShape(n, {
      attrs: i,
      className: "".concat(this.type, "-keyShape"),
      name: "".concat(this.type, "-keyShape"),
      draggable: !0
    });
    return this.drawClip(t, a), a;
  },
  drawClip: function(t, e) {
    var n = (this.mergeStyle || this.getOptions(t)).clipCfg;
    if (!!n.show) {
      var i = n.type, a = n.x, o = n.y, s = n.style;
      if (i === "circle") {
        var u = n.r;
        e.setClip({
          type: "circle",
          attrs: U({
            r: u,
            x: a,
            y: o
          }, s)
        });
      } else if (i === "rect") {
        var f = n.width, l = n.height, c = a - f / 2, h = o - l / 2;
        e.setClip({
          type: "rect",
          attrs: U({
            x: c,
            y: h,
            width: f,
            height: l
          }, s)
        });
      } else if (i === "ellipse") {
        var d = n.rx, v = n.ry;
        e.setClip({
          type: "ellipse",
          attrs: U({
            x: a,
            y: o,
            rx: d,
            ry: v
          }, s)
        });
      } else if (i === "polygon") {
        var p = n.points;
        e.setClip({
          type: "polygon",
          attrs: U({
            points: p
          }, s)
        });
      } else if (i === "path") {
        var g = n.path;
        e.setClip({
          type: "path",
          attrs: U({
            path: g
          }, s)
        });
      }
    }
  },
  getShapeStyle: function(t) {
    var e = this.mergeStyle || this.getOptions(t), n = e.style, i = e.img, a = this.getSize(t), o = a[0], s = a[1];
    n && (o = n.width || a[0], s = n.height || a[1]);
    var u = U({
      x: -o / 2,
      y: -s / 2,
      width: o,
      height: s,
      img: i
    }, n);
    return u;
  },
  updateShapeStyle: function(t, e) {
    var n = e.getContainer(), i = "".concat(this.itemType, "-shape"), a = n.shapeMap[i] || n.find(function(s) {
      return s.get("className") === i;
    }) || e.getKeyShape(), o = this.getShapeStyle(t);
    a && !a.destroyed && a.attr(o);
  }
}, "single-node");
const WN = {
  triangle: function(t, e, n) {
    t === void 0 && (t = 10), e === void 0 && (e = 15), n === void 0 && (n = 0);
    var i = n * 2, a = "M ".concat(i, ",0 L ").concat(i + e, ",-").concat(t / 2, " L ").concat(i + e, ",").concat(t / 2, " Z");
    return a;
  },
  vee: function(t, e, n) {
    t === void 0 && (t = 15), e === void 0 && (e = 20), n === void 0 && (n = 0);
    var i = n * 2, a = "M ".concat(i, ",0 L ").concat(i + e, ",-").concat(t / 2, `
        L `).concat(i + 2 * e / 3, ",0 L ").concat(i + e, ",").concat(t / 2, " Z");
    return a;
  },
  circle: function(t, e) {
    t === void 0 && (t = 5), e === void 0 && (e = 0);
    var n = e * 2, i = "M ".concat(n, `, 0
            a `).concat(t, ",").concat(t, " 0 1,0 ").concat(t * 2, `,0
            a `).concat(t, ",").concat(t, " 0 1,0 ").concat(-t * 2, ",0");
    return i;
  },
  rect: function(t, e, n) {
    t === void 0 && (t = 10), e === void 0 && (e = 10), n === void 0 && (n = 0);
    var i = n * 2, a = "M ".concat(i, ",").concat(-t / 2, ` 
        L `).concat(i + e, ",").concat(-t / 2, ` 
        L `).concat(i + e, ",").concat(t / 2, ` 
        L `).concat(i, ",").concat(t / 2, " Z");
    return a;
  },
  diamond: function(t, e, n) {
    t === void 0 && (t = 15), e === void 0 && (e = 15), n === void 0 && (n = 0);
    var i = n * 2, a = "M ".concat(i, `,0 
        L `).concat(i + e / 2, ",").concat(-t / 2, ` 
        L `).concat(i + e, `,0 
        L `).concat(i + e / 2, ",").concat(t / 2, " Z");
    return a;
  },
  triangleRect: function(t, e, n, i, a, o) {
    t === void 0 && (t = 15), e === void 0 && (e = 15), n === void 0 && (n = 15), i === void 0 && (i = 3), a === void 0 && (a = 5), o === void 0 && (o = 0);
    var s = o * 2, u = s + e + a, f = "M ".concat(s, ",0 L ").concat(s + e, ",-").concat(t / 2, " L ").concat(s + e, ",").concat(t / 2, ` Z
            M `).concat(u, ", -").concat(n / 2, `
            L `).concat(u + i, " -").concat(n / 2, `
            L `).concat(u + i, " ").concat(n / 2, `
            L `).concat(u, " ").concat(n / 2, `
            Z`);
    return f;
  }
}, VN = {
  collapse: function(t, e, n) {
    return [["M", t - n, e], ["a", n, n, 0, 1, 0, n * 2, 0], ["a", n, n, 0, 1, 0, -n * 2, 0], ["M", t - n + 4, e], ["L", t + n - 4, e]];
  },
  expand: function(t, e, n) {
    return [["M", t - n, e], ["a", n, n, 0, 1, 0, n * 2, 0], ["a", n, n, 0, 1, 0, -n * 2, 0], ["M", t - n + 4, e], ["L", t - n + 2 * n - 4, e], ["M", t - n + n, e - n + 4], ["L", t, e + n - 4]];
  },
  upTriangle: function(t, e, n) {
    var i = n * Math.cos(Math.PI / 6), a = n * Math.sin(Math.PI / 6);
    return [["M", t - i, e + a], ["L", t + i, e + a], ["L", t, e - n], ["Z"]];
  },
  downTriangle: function(t, e, n) {
    var i = n * Math.cos(Math.PI / 6), a = n * Math.sin(Math.PI / 6);
    return [["M", t - i, e - a], ["L", t + i, e - a], ["L", t, e + n], ["Z"]];
  }
};
var mX = ["#5F95FF", "#61DDAA", "#65789B", "#F6BD16", "#7262FD", "#78D3F8", "#9661BC", "#F6903D", "#008685", "#F08BB4"];
const bX = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  defaultSubjectColors: mX
}, Symbol.toStringTag, { value: "Module" }));
var XN = function(t) {
  return t === "force" || t === "g6force" || t === "gForce" || t === "force2";
};
const xX = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  isForce: XN
}, Symbol.toStringTag, { value: "Module" }));
var _X = $i, ci = U(U(U(U(U(U(U({}, NV), i9), JV), qW), bX), xX), {
  transform: _X,
  mat3: qD
}), YN = function() {
  function r(t) {
    this.graph = t, this.layoutCfg = t.get("layout") || {}, this.layoutType = this.getLayoutType(), this.layoutMethods = [], this.initLayout();
  }
  return r.prototype.initLayout = function() {
  }, r.prototype.getLayoutType = function() {
    return this.getLayoutCfgType(this.layoutCfg);
  }, r.prototype.getLayoutCfgType = function(t) {
    var e = t.type;
    if (e)
      return e;
    var n = t.pipes;
    return Array.isArray(n) ? n.map(function(i) {
      return (i == null ? void 0 : i.type) || "";
    }) : null;
  }, r.prototype.isLayoutTypeSame = function(t) {
    var e = this.getLayoutCfgType(t), n = Array.isArray(this.layoutType), i = Array.isArray(e);
    return n && i ? this.layoutType.every(function(a, o) {
      return a === e[o];
    }) : Array.isArray(e) || Array.isArray(this.layoutType) ? !1 : (t == null ? void 0 : t.type) === this.layoutType;
  }, r.prototype.refreshLayout = function() {
    var t = this, e = t.graph, n = t.layoutType, i = t.layoutCfg, a = i === void 0 ? {} : i;
    if (!!e) {
      var o = a.animate, s = o === void 0 && (n === "force" || n === "force2"), u = XN(n) && (o || s);
      e.get("animate") && !u ? e.positionsAnimate(n === "comboCombined") : e.refreshPositions(n === "comboCombined");
    }
  }, r.prototype.changeLayout = function(t) {
    var e = t.disableTriggerLayout, n = kn(t, ["disableTriggerLayout"]);
    this.layoutCfg = n, this.layoutType = n.type || this.layoutType, !e && this.layout();
  }, r.prototype.changeData = function(t) {
    this.layout(t);
  }, r.prototype.destoryLayoutMethods = function() {
    var t = this.layoutMethods, e = [];
    return t == null || t.forEach(function(n) {
      var i, a = (i = n.getType) === null || i === void 0 ? void 0 : i.call(n);
      a && e.push(a), n.destroy();
    }), this.layoutMethods = [], e;
  }, r.prototype.destroyLayout = function() {
    var t = this.graph;
    this.destoryLayoutMethods(), t.set("layout", void 0), this.layoutCfg = void 0, this.layoutType = void 0, this.layoutMethods = void 0;
  }, r.prototype.setDataFromGraph = function() {
    for (var t = [], e = [], n = [], i = [], a = [], o = [], s = [], u = this.graph.getNodes(), f = this.graph.getEdges(), l = this.graph.getCombos(), c = u.length, h = 0; h < c; h++) {
      var d = u[h];
      if (!(!d || d.destroyed)) {
        var v = d.getModel();
        if (!d.isVisible()) {
          e.push(v);
          continue;
        }
        t.push(v);
      }
    }
    for (var p = f.length, h = 0; h < p; h++) {
      var g = f[h];
      if (!(!g || g.destroyed)) {
        var v = g.getModel();
        if (!g.isVisible()) {
          i.push(v);
          continue;
        }
        v.isComboEdge ? a.push(v) : n.push(v);
      }
    }
    for (var y = l.length, h = 0; h < y; h++) {
      var b = l[h];
      if (!b.destroyed) {
        var v = b.getModel();
        if (!b.isVisible()) {
          s.push(v);
          continue;
        }
        o.push(v);
      }
    }
    return {
      nodes: t,
      hiddenNodes: e,
      edges: n,
      hiddenEdges: i,
      combos: o,
      hiddenCombos: s,
      comboEdges: a
    };
  }, r.prototype.relayout = function(t) {
    var e = this, n = this, i = n.graph, a = n.layoutMethods, o = n.layoutCfg;
    if (t) {
      this.data = this.setDataFromGraph();
      var s = this.data.nodes;
      if (!s)
        return !1;
      this.initPositions(o.center, s);
    }
    i.emit("beforelayout");
    var u = Promise.resolve();
    a == null || a.forEach(function(f, l) {
      var c = o[l] || o;
      u = u.then(function() {
        var h, d = e.execLayoutMethod(c, l);
        return l === a.length - 1 && ((h = o.onAllLayoutEnd) === null || h === void 0 || h.call(o)), d;
      });
    });
  }, r.prototype.filterLayoutData = function(t, e) {
    var n = t.nodes, i = t.edges, a = kn(t, ["nodes", "edges"]);
    if (!n)
      return t;
    var o, s;
    Ur(e == null ? void 0 : e.nodesFilter) ? o = e.nodesFilter : o = function() {
      return !0;
    };
    var u = n.filter(o);
    if (Ur(e == null ? void 0 : e.edgesFilter))
      s = e.edgesFilter;
    else {
      var f = u.reduce(function(l, c) {
        return l[c.id] = !0, l;
      }, {});
      s = function(c) {
        return f[c.source] && f[c.target];
      };
    }
    return U({
      nodes: u,
      edges: i.filter(s)
    }, a);
  }, r.prototype.getLayoutBBox = function(t) {
    var e = this.graph, n = Bv(e.getNodes(), function(o) {
      return o.getModel().layoutOrder;
    }), i = Object.values(n).map(function(o) {
      var s = TN(o);
      return s.size = [s.width, s.height], s;
    }), a = Object.values(Bv(t, "layoutOrder"));
    return {
      groupNodes: a,
      layoutNodes: i
    };
  }, r.prototype.layoutAnimate = function() {
  }, r.prototype.moveToZero = function() {
    var t = this.graph, e = t.get("data"), n = e.nodes;
    if (!(n[0].x === void 0 || n[0].x === null || Aa(n[0].x))) {
      for (var i = [0, 0], a = n.length, o = 0; o < a; o++) {
        var s = n[o];
        i[0] += s.x, i[1] += s.y;
      }
      i[0] /= n.length, i[1] /= n.length;
      for (var o = 0; o < a; o++) {
        var s = n[o];
        s.x -= i[0], s.y -= i[1];
      }
    }
  }, r.prototype.initPositions = function(t, e) {
    var n, i = this.graph;
    if (!e)
      return !1;
    var a = e.filter(function(m) {
      return Aa(m.x) || Aa(m.y);
    }), o = a ? a.length : 0;
    if (!!o) {
      var s = (n = this.initWithPreset) === null || n === void 0 ? void 0 : n.call(this);
      if (s)
        return !1;
      var u = i.get("width") * 0.85, f = i.get("height") * 0.85, l = Math.ceil(Math.sqrt(o) * (u / f)), c = Math.ceil(o / l), h = u / (l - 1), d = f / (c - 1);
      (!isFinite(h) || !h) && (h = 0), (!isFinite(d) || !h) && (d = 0);
      for (var v = t[0] - u / 2, p = t[1] - f / 2, g = !0, y = 0; y < o; y++) {
        var b = a[y];
        Aa(+b.x) && (g = !1, b.x = y % l * h + v), Aa(+b.y) && (g = !1, b.y = Math.floor(y / l) * d + p);
      }
      return g;
    }
  }, r.prototype.destroy = function() {
    this.graph = null, this.destoryLayoutMethods(), this.destroyed = !0;
  }, r;
}(), HN = function() {
  function r(t) {
    this.graph = t, this.destroyed = !1, this.initEvents();
  }
  return r;
}(), Io = Or.registerNode, KN = Or.registerEdge, wX = Or.registerCombo, qN = H1.registerBehavior, dt = Et;
Et.version, Or.registerNode, Or.registerEdge, Or.registerCombo, H1.registerBehavior;
var Ib = {}, lr = {}, Bp = {}, vs = {};
Object.defineProperty(vs, "__esModule", {
  value: !0
});
vs.MESSAGE = vs.ALGORITHM = void 0;
var EX = {
  pageRank: "pageRank",
  breadthFirstSearch: "breadthFirstSearch",
  connectedComponent: "connectedComponent",
  depthFirstSearch: "depthFirstSearch",
  detectCycle: "detectCycle",
  detectDirectedCycle: "detectDirectedCycle",
  detectAllCycles: "detectAllCycles",
  detectAllDirectedCycle: "detectAllDirectedCycle",
  detectAllUndirectedCycle: "detectAllUndirectedCycle",
  dijkstra: "dijkstra",
  findAllPath: "findAllPath",
  findShortestPath: "findShortestPath",
  floydWarshall: "floydWarshall",
  getAdjMatrix: "getAdjMatrix",
  getDegree: "getDegree",
  getInDegree: "getInDegree",
  getNeighbors: "getNeighbors",
  getOutDegree: "getOutDegree",
  labelPropagation: "labelPropagation",
  louvain: "louvain",
  GADDI: "GADDI",
  minimumSpanningTree: "minimumSpanningTree",
  SUCCESS: "SUCCESS",
  FAILURE: "FAILURE"
};
vs.ALGORITHM = EX;
var SX = {
  SUCCESS: "SUCCESS",
  FAILURE: "FAILURE"
};
vs.MESSAGE = SX;
var Gp = {}, ZN = {}, Cu = {};
Object.defineProperty(Cu, "__esModule", {
  value: !0
});
Cu.default = void 0;
var MX = function(t, e) {
  var n = t.nodes, i = t.edges, a = [], o = {};
  if (!n)
    throw new Error("invalid nodes data!");
  return n && n.forEach(function(s, u) {
    o[s.id] = u;
    var f = [];
    a.push(f);
  }), i && i.forEach(function(s) {
    var u = s.source, f = s.target, l = o[u], c = o[f];
    !l && l !== 0 || !c && c !== 0 || (a[l][c] = 1, e || (a[c][l] = 1));
  }), a;
}, CX = MX;
Cu.default = CX;
var Fp = {}, zp = {}, jf = {};
Object.defineProperty(jf, "__esModule", {
  value: !0
});
jf.default = jf.LinkedListNode = void 0;
var TX = function(t, e) {
  return t === e;
}, Om = function() {
  function r(t, e) {
    e === void 0 && (e = null), this.value = t, this.next = e;
  }
  return r.prototype.toString = function(t) {
    return t ? t(this.value) : "".concat(this.value);
  }, r;
}();
jf.LinkedListNode = Om;
var AX = function() {
  function r(t) {
    t === void 0 && (t = TX), this.head = null, this.tail = null, this.compare = t;
  }
  return r.prototype.prepend = function(t) {
    var e = new Om(t, this.head);
    return this.head = e, this.tail || (this.tail = e), this;
  }, r.prototype.append = function(t) {
    var e = new Om(t);
    return this.head ? (this.tail.next = e, this.tail = e, this) : (this.head = e, this.tail = e, this);
  }, r.prototype.delete = function(t) {
    if (!this.head)
      return null;
    for (var e = null; this.head && this.compare(this.head.value, t); )
      e = this.head, this.head = this.head.next;
    var n = this.head;
    if (n !== null)
      for (; n.next; )
        this.compare(n.next.value, t) ? (e = n.next, n.next = n.next.next) : n = n.next;
    return this.compare(this.tail.value, t) && (this.tail = n), e;
  }, r.prototype.find = function(t) {
    var e = t.value, n = e === void 0 ? void 0 : e, i = t.callback, a = i === void 0 ? void 0 : i;
    if (!this.head)
      return null;
    for (var o = this.head; o; ) {
      if (a && a(o.value) || n !== void 0 && this.compare(o.value, n))
        return o;
      o = o.next;
    }
    return null;
  }, r.prototype.deleteTail = function() {
    var t = this.tail;
    if (this.head === this.tail)
      return this.head = null, this.tail = null, t;
    for (var e = this.head; e.next; )
      e.next.next ? e = e.next : e.next = null;
    return this.tail = e, t;
  }, r.prototype.deleteHead = function() {
    if (!this.head)
      return null;
    var t = this.head;
    return this.head.next ? this.head = this.head.next : (this.head = null, this.tail = null), t;
  }, r.prototype.fromArray = function(t) {
    var e = this;
    return t.forEach(function(n) {
      return e.append(n);
    }), this;
  }, r.prototype.toArray = function() {
    for (var t = [], e = this.head; e; )
      t.push(e), e = e.next;
    return t;
  }, r.prototype.reverse = function() {
    for (var t = this.head, e = null, n = null; t; )
      n = t.next, t.next = e, e = t, t = n;
    this.tail = this.head, this.head = e;
  }, r.prototype.toString = function(t) {
    return t === void 0 && (t = void 0), this.toArray().map(function(e) {
      return e.toString(t);
    }).toString();
  }, r;
}(), IX = AX;
jf.default = IX;
Object.defineProperty(zp, "__esModule", {
  value: !0
});
zp.default = void 0;
var PX = OX(jf);
function OX(r) {
  return r && r.__esModule ? r : { default: r };
}
var DX = function() {
  function r() {
    this.linkedList = new PX.default();
  }
  return r.prototype.isEmpty = function() {
    return !this.linkedList.head;
  }, r.prototype.peek = function() {
    return this.linkedList.head ? this.linkedList.head.value : null;
  }, r.prototype.enqueue = function(t) {
    this.linkedList.append(t);
  }, r.prototype.dequeue = function() {
    var t = this.linkedList.deleteHead();
    return t ? t.value : null;
  }, r.prototype.toString = function(t) {
    return this.linkedList.toString(t);
  }, r;
}(), kX = DX;
zp.default = kX;
var yn = {};
Object.defineProperty(yn, "__esModule", {
  value: !0
});
yn.uniqueId = yn.getOutEdgesNodeId = yn.getNeighbors = yn.getEdgesByNodeId = void 0;
var LX = function(t, e, n) {
  e === void 0 && (e = []);
  var i = e.filter(function(u) {
    return u.source === t || u.target === t;
  });
  if (n === "target") {
    var a = function(f) {
      return f.source === t;
    };
    return i.filter(a).map(function(u) {
      return u.target;
    });
  }
  if (n === "source") {
    var o = function(f) {
      return f.target === t;
    };
    return i.filter(o).map(function(u) {
      return u.source;
    });
  }
  var s = function(f) {
    return f.source === t ? f.target : f.source;
  };
  return i.map(s);
};
yn.getNeighbors = LX;
var NX = function(t, e) {
  return e.filter(function(n) {
    return n.source === t;
  });
};
yn.getOutEdgesNodeId = NX;
var RX = function(t, e) {
  return e.filter(function(n) {
    return n.source === t || n.target === t;
  });
};
yn.getEdgesByNodeId = RX;
var BX = function(t) {
  t === void 0 && (t = 0);
  var e = "".concat(Math.random()).split(".")[1].substr(0, 5), n = "".concat(Math.random()).split(".")[1].substr(0, 5);
  return "".concat(t, "-").concat(e).concat(n);
};
yn.uniqueId = BX;
Object.defineProperty(Fp, "__esModule", {
  value: !0
});
Fp.default = void 0;
var GX = zX(zp), FX = yn;
function zX(r) {
  return r && r.__esModule ? r : { default: r };
}
function UX(r) {
  r === void 0 && (r = {});
  var t = r, e = function() {
  }, n = function() {
    var i = {};
    return function(a) {
      var o = a.next, s = o;
      return i[s] ? !1 : (i[s] = !0, !0);
    };
  }();
  return t.allowTraversal = r.allowTraversal || n, t.enter = r.enter || e, t.leave = r.leave || e, t;
}
var jX = function(t, e, n, i) {
  i === void 0 && (i = !0);
  var a = UX(n), o = new GX.default(), s = t.edges, u = s === void 0 ? [] : s;
  o.enqueue(e);
  for (var f = "", l = function() {
    var h = o.dequeue();
    a.enter({
      current: h,
      previous: f
    }), (0, FX.getNeighbors)(h, u, i ? "target" : void 0).forEach(function(d) {
      a.allowTraversal({
        previous: f,
        current: h,
        next: d
      }) && o.enqueue(d);
    }), a.leave({
      current: h,
      previous: f
    }), f = h;
  }; !o.isEmpty(); )
    l();
}, $X = jX;
Fp.default = $X;
var ps = {};
Object.defineProperty(ps, "__esModule", {
  value: !0
});
ps.default = WX;
ps.detectStrongConnectComponents = ps.detectConnectedComponents = void 0;
var QN = yn, JN = function(t) {
  for (var e = t.nodes, n = e === void 0 ? [] : e, i = t.edges, a = i === void 0 ? [] : i, o = [], s = {}, u = [], f = function d(v) {
    u.push(v), s[v.id] = !0;
    for (var p = (0, QN.getNeighbors)(v.id, a), g = function(m) {
      var x = p[m];
      if (!s[x]) {
        var _ = n.filter(function(w) {
          return w.id === x;
        });
        _.length > 0 && d(_[0]);
      }
    }, y = 0; y < p.length; ++y)
      g(y);
  }, l = 0; l < n.length; l++) {
    var c = n[l];
    if (!s[c.id]) {
      f(c);
      for (var h = []; u.length > 0; )
        h.push(u.pop());
      o.push(h);
    }
  }
  return o;
};
ps.detectConnectedComponents = JN;
var eR = function(t) {
  for (var e = t.nodes, n = e === void 0 ? [] : e, i = t.edges, a = i === void 0 ? [] : i, o = [], s = {}, u = {}, f = {}, l = [], c = 0, h = function g(y) {
    u[y.id] = c, f[y.id] = c, c += 1, o.push(y), s[y.id] = !0;
    for (var b = (0, QN.getNeighbors)(y.id, a, "target").filter(function(E) {
      return n.map(function(M) {
        return M.id;
      }).indexOf(E) > -1;
    }), m = function(M) {
      var C = b[M];
      if (!u[C] && u[C] !== 0) {
        var S = n.filter(function(A) {
          return A.id === C;
        });
        S.length > 0 && g(S[0]), f[y.id] = Math.min(f[y.id], f[C]);
      } else
        s[C] && (f[y.id] = Math.min(f[y.id], u[C]));
    }, x = 0; x < b.length; x++)
      m(x);
    if (f[y.id] === u[y.id]) {
      for (var _ = []; o.length > 0; ) {
        var w = o.pop();
        if (s[w.id] = !1, _.push(w), w === y)
          break;
      }
      _.length > 0 && l.push(_);
    }
  }, d = 0, v = n; d < v.length; d++) {
    var p = v[d];
    !u[p.id] && u[p.id] !== 0 && h(p);
  }
  return l;
};
ps.detectStrongConnectComponents = eR;
function WX(r, t) {
  return t ? eR(r) : JN(r);
}
var Eo = {};
Object.defineProperty(Eo, "__esModule", {
  value: !0
});
Eo.getOutDegree = Eo.getInDegree = Eo.default = void 0;
var Bc = function(t) {
  var e = {}, n = t.nodes, i = n === void 0 ? [] : n, a = t.edges, o = a === void 0 ? [] : a;
  return i.forEach(function(s) {
    e[s.id] = {
      degree: 0,
      inDegree: 0,
      outDegree: 0
    };
  }), o.forEach(function(s) {
    e[s.source].degree++, e[s.source].outDegree++, e[s.target].degree++, e[s.target].inDegree++;
  }), e;
}, VX = Bc;
Eo.default = VX;
var XX = function(t, e) {
  var n = Bc(t);
  return n[e] ? Bc(t)[e].inDegree : 0;
};
Eo.getInDegree = XX;
var YX = function(t, e) {
  var n = Bc(t);
  return n[e] ? Bc(t)[e].outDegree : 0;
};
Eo.getOutDegree = YX;
var Oa = {}, Up = {};
Object.defineProperty(Up, "__esModule", {
  value: !0
});
Up.default = qX;
var HX = yn;
function KX(r) {
  r === void 0 && (r = {});
  var t = r, e = function() {
  }, n = function() {
    var i = {};
    return function(a) {
      var o = a.next;
      return i[o] ? !1 : (i[o] = !0, !0);
    };
  }();
  return t.allowTraversal = r.allowTraversal || n, t.enter = r.enter || e, t.leave = r.leave || e, t;
}
function tR(r, t, e, n) {
  n.enter({
    current: t,
    previous: e
  });
  var i = r.edges, a = i === void 0 ? [] : i;
  (0, HX.getNeighbors)(t, a, "target").forEach(function(o) {
    n.allowTraversal({
      previous: e,
      current: t,
      next: o
    }) && tR(r, o, t, n);
  }), n.leave({
    current: t,
    previous: e
  });
}
function qX(r, t, e) {
  tR(r, t, "", KX(e));
}
function Dm(r) {
  return Dm = typeof Symbol == "function" && typeof Symbol.iterator == "symbol" ? function(t) {
    return typeof t;
  } : function(t) {
    return t && typeof Symbol == "function" && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t;
  }, Dm(r);
}
Object.defineProperty(Oa, "__esModule", {
  value: !0
});
Oa.detectAllUndirectedCycle = Oa.detectAllDirectedCycle = Oa.detectAllCycles = Oa.default = void 0;
var ZX = JX(Up), rR = QX(ps), nR = yn;
function iR(r) {
  if (typeof WeakMap != "function")
    return null;
  var t = /* @__PURE__ */ new WeakMap(), e = /* @__PURE__ */ new WeakMap();
  return (iR = function(i) {
    return i ? e : t;
  })(r);
}
function QX(r, t) {
  if (!t && r && r.__esModule)
    return r;
  if (r === null || Dm(r) !== "object" && typeof r != "function")
    return { default: r };
  var e = iR(t);
  if (e && e.has(r))
    return e.get(r);
  var n = {}, i = Object.defineProperty && Object.getOwnPropertyDescriptor;
  for (var a in r)
    if (a !== "default" && Object.prototype.hasOwnProperty.call(r, a)) {
      var o = i ? Object.getOwnPropertyDescriptor(r, a) : null;
      o && (o.get || o.set) ? Object.defineProperty(n, a, o) : n[a] = r[a];
    }
  return n.default = r, e && e.set(r, n), n;
}
function JX(r) {
  return r && r.__esModule ? r : { default: r };
}
var eY = function(t) {
  var e = null, n = t.nodes, i = n === void 0 ? [] : n, a = {}, o = {}, s = {}, u = {};
  i.forEach(function(c) {
    o[c.id] = c;
  });
  for (var f = {
    enter: function(h) {
      var d = h.current, v = h.previous;
      if (s[d]) {
        e = {};
        for (var p = d, g = v; g !== d; )
          e[p] = g, p = g, g = a[g];
        e[p] = g;
      } else
        s[d] = d, delete o[d], a[d] = v;
    },
    leave: function(h) {
      var d = h.current;
      u[d] = d, delete s[d];
    },
    allowTraversal: function(h) {
      var d = h.next;
      return e ? !1 : !u[d];
    }
  }; Object.keys(o).length; ) {
    var l = Object.keys(o)[0];
    (0, ZX.default)(t, l, f);
  }
  return e;
}, aR = function(t, e, n) {
  var i, a;
  n === void 0 && (n = !0);
  for (var o = [], s = (0, rR.default)(t, !1), u = 0, f = s; u < f.length; u++) {
    var l = f[u];
    if (!!l.length)
      for (var c = l[0], h = c.id, d = [c], v = (i = {}, i[h] = c, i), p = (a = {}, a[h] = /* @__PURE__ */ new Set(), a); d.length > 0; )
        for (var g = d.pop(), y = g.id, b = (0, nR.getNeighbors)(y, t.edges), m = function(w) {
          var E, M = b[w], C = t.nodes.find(function(L) {
            return L.id === M;
          });
          if (M === y)
            o.push((E = {}, E[M] = g, E));
          else if (!(M in p))
            v[M] = g, d.push(C), p[M] = /* @__PURE__ */ new Set([g]);
          else if (!p[y].has(C)) {
            for (var S = !0, A = [C, g], T = v[y]; p[M].size && !p[M].has(T) && (A.push(T), T !== v[T.id]); )
              T = v[T.id];
            if (A.push(T), e && n ? (S = !1, A.findIndex(function(L) {
              return e.indexOf(L.id) > -1;
            }) > -1 && (S = !0)) : e && !n && A.findIndex(function(L) {
              return e.indexOf(L.id) > -1;
            }) > -1 && (S = !1), S) {
              for (var P = {}, k = 1; k < A.length; k += 1)
                P[A[k - 1].id] = A[k];
              A.length && (P[A[A.length - 1].id] = A[0]), o.push(P);
            }
            p[M].add(g);
          }
        }, x = 0; x < b.length; x += 1)
          m(x);
  }
  return o;
};
Oa.detectAllUndirectedCycle = aR;
var oR = function(t, e, n) {
  n === void 0 && (n = !0);
  for (var i = [], a = /* @__PURE__ */ new Set(), o = [], s = [], u = {}, f = {}, l = function(T) {
    for (var P = [T]; P.length > 0; ) {
      var k = P.pop();
      a.has(k) && (a.delete(k), o[k.id].forEach(function(L) {
        P.push(L);
      }), o[k.id].clear());
    }
  }, c = function A(T, P, k) {
    var L = !1;
    if (e && n === !1 && e.indexOf(T.id) > -1)
      return L;
    i.push(T), a.add(T);
    for (var O = k[T.id], D = 0; D < O.length; D += 1) {
      var G = u[O[D]];
      if (G === P) {
        for (var R = {}, F = 1; F < i.length; F += 1)
          R[i[F - 1].id] = i[F];
        i.length && (R[i[i.length - 1].id] = i[0]), s.push(R), L = !0;
      } else
        a.has(G) || A(G, P, k) && (L = !0);
    }
    if (L)
      l(T);
    else
      for (var D = 0; D < O.length; D += 1) {
        var G = u[O[D]];
        o[G.id].has(T) || o[G.id].add(T);
      }
    return i.pop(), L;
  }, h = t.nodes, d = h === void 0 ? [] : h, v = 0; v < d.length; v += 1) {
    var p = d[v], g = p.id;
    f[g] = v, u[v] = p;
  }
  if (e && n)
    for (var y = function(T) {
      var P = e[T];
      f[d[T].id] = f[P], f[P] = 0, u[0] = d.find(function(k) {
        return k.id === P;
      }), u[f[d[T].id]] = d[T];
    }, v = 0; v < e.length; v++)
      y(v);
  for (var b = function(T) {
    for (var P, k, L = 1 / 0, O = 0; O < T.length; O += 1)
      for (var D = T[O], G = 0; G < D.length; G++) {
        var R = f[D[G].id];
        R < L && (L = R, k = O);
      }
    for (var F = T[k], q = [], O = 0; O < F.length; O += 1) {
      var ne = F[O];
      q[ne.id] = [];
      for (var oe = 0, ie = (0, nR.getNeighbors)(ne.id, t.edges, "target").filter(function(le) {
        return F.map(function(Me) {
          return Me.id;
        }).indexOf(le) > -1;
      }); oe < ie.length; oe++) {
        var Ee = ie[oe];
        Ee === ne.id && !(n === !1 && e.indexOf(ne.id) > -1) ? s.push((P = {}, P[ne.id] = ne, P)) : q[ne.id].push(f[Ee]);
      }
    }
    return {
      component: F,
      adjList: q,
      minIdx: L
    };
  }, m = 0; m < d.length; ) {
    var x = d.filter(function(A) {
      return f[A.id] >= m;
    }), _ = (0, rR.detectStrongConnectComponents)({
      nodes: x,
      edges: t.edges
    }).filter(function(A) {
      return A.length > 1;
    });
    if (_.length === 0)
      break;
    var w = b(_), E = w.minIdx, M = w.adjList, C = w.component;
    if (C.length > 1) {
      C.forEach(function(A) {
        o[A.id] = /* @__PURE__ */ new Set();
      });
      var S = u[E];
      if (e && n && e.indexOf(S.id) === -1)
        return s;
      c(S, S, M), m = E + 1;
    } else
      break;
  }
  return s;
};
Oa.detectAllDirectedCycle = oR;
var tY = function(t, e, n, i) {
  return i === void 0 && (i = !0), e ? oR(t, n, i) : aR(t, n, i);
};
Oa.detectAllCycles = tY;
var rY = eY;
Oa.default = rY;
var il = {};
const sR = /* @__PURE__ */ Ao(T6), th = /* @__PURE__ */ Ao(Fz);
Object.defineProperty(il, "__esModule", {
  value: !0
});
il.default = void 0;
var L2 = sR, nY = th, N2 = yn, iY = function(t, e, n) {
  for (var i = 1 / 0, a, o = 0; o < e.length; o++) {
    var s = e[o].id;
    !n[s] && t[s] <= i && (i = t[s], a = e[o]);
  }
  return a;
}, aY = function(t, e, n, i) {
  var a = t.nodes, o = a === void 0 ? [] : a, s = t.edges, u = s === void 0 ? [] : s, f = {}, l = {}, c = {};
  o.forEach(function(b, m) {
    var x = b.id;
    l[x] = 1 / 0, x === e && (l[x] = 0);
  });
  for (var h = o.length, d = function(m) {
    var x = iY(l, o, f), _ = x.id;
    if (f[_] = !0, l[_] === 1 / 0)
      return "continue";
    var w = [];
    n ? w = (0, N2.getOutEdgesNodeId)(_, u) : w = (0, N2.getEdgesByNodeId)(_, u), w.forEach(function(E) {
      var M = E.target, C = E.source, S = M === _ ? C : M, A = i && E[i] ? E[i] : 1;
      l[S] > l[x.id] + A ? (l[S] = l[x.id] + A, c[S] = [x.id]) : l[S] === l[x.id] + A && c[S].push(x.id);
    });
  }, v = 0; v < h; v++)
    d();
  c[e] = [e];
  var p = {};
  for (var g in l)
    l[g] !== 1 / 0 && uR(e, g, c, p);
  var y = {};
  for (var g in p)
    y[g] = p[g][0];
  return {
    length: l,
    path: y,
    allPath: p
  };
}, oY = aY;
il.default = oY;
function uR(r, t, e, n) {
  if (r === t)
    return [r];
  if (n[t])
    return n[t];
  for (var i = [], a = 0, o = e[t]; a < o.length; a++) {
    var s = o[a], u = uR(r, s, e, n);
    if (!u)
      return;
    for (var f = 0, l = u; f < l.length; f++) {
      var c = l[f];
      (0, nY.isArray)(c) ? i.push((0, L2.__spreadArray)((0, L2.__spreadArray)([], c, !0), [t], !1)) : i.push([c, t]);
    }
  }
  return n[t] = i, n[t];
}
var $f = {};
Object.defineProperty($f, "__esModule", {
  value: !0
});
$f.findShortestPath = $f.findAllPath = void 0;
var sY = uY(il), _d = yn;
function uY(r) {
  return r && r.__esModule ? r : { default: r };
}
var fY = function(t, e, n, i, a) {
  var o = (0, sY.default)(t, e, i, a), s = o.length, u = o.path, f = o.allPath;
  return {
    length: s[n],
    path: u[n],
    allPath: f[n]
  };
};
$f.findShortestPath = fY;
var lY = function(t, e, n, i) {
  var a;
  if (e === n)
    return [[e]];
  var o = t.edges, s = o === void 0 ? [] : o, u = [e], f = (a = {}, a[e] = !0, a), l = [], c = [], h = i ? (0, _d.getNeighbors)(e, s, "target") : (0, _d.getNeighbors)(e, s);
  for (l.push(h); u.length > 0 && l.length > 0; ) {
    var d = l[l.length - 1];
    if (d.length) {
      var v = d.shift();
      v && (u.push(v), f[v] = !0, h = i ? (0, _d.getNeighbors)(v, s, "target") : (0, _d.getNeighbors)(v, s), l.push(h.filter(function(y) {
        return !f[y];
      })));
    } else {
      var p = u.pop();
      f[p] = !1, l.pop();
      continue;
    }
    if (u[u.length - 1] === n) {
      var g = u.map(function(b) {
        return b;
      });
      c.push(g);
      var p = u.pop();
      f[p] = !1, l.pop();
    }
  }
  return c;
};
$f.findAllPath = lY;
var rh = {};
Object.defineProperty(rh, "__esModule", {
  value: !0
});
rh.default = void 0;
var cY = hY(Cu);
function hY(r) {
  return r && r.__esModule ? r : { default: r };
}
var dY = function(t, e) {
  for (var n = (0, cY.default)(t, e), i = [], a = n.length, o = 0; o < a; o += 1) {
    i[o] = [];
    for (var s = 0; s < a; s += 1)
      o === s ? i[o][s] = 0 : n[o][s] === 0 || !n[o][s] ? i[o][s] = 1 / 0 : i[o][s] = n[o][s];
  }
  for (var u = 0; u < a; u += 1)
    for (var o = 0; o < a; o += 1)
      for (var s = 0; s < a; s += 1)
        i[o][s] > i[o][u] + i[u][s] && (i[o][s] = i[o][u] + i[u][s]);
  return i;
}, vY = dY;
rh.default = vY;
var jp = {};
Object.defineProperty(jp, "__esModule", {
  value: !0
});
jp.default = void 0;
var pY = yY(Cu), gY = yn;
function yY(r) {
  return r && r.__esModule ? r : { default: r };
}
var mY = function(t, e, n, i) {
  e === void 0 && (e = !1), n === void 0 && (n = "weight"), i === void 0 && (i = 1e3);
  var a = t.nodes, o = a === void 0 ? [] : a, s = t.edges, u = s === void 0 ? [] : s, f = {}, l = {};
  o.forEach(function(m, x) {
    var _ = (0, gY.uniqueId)();
    m.clusterId = _, f[_] = {
      id: _,
      nodes: [m]
    }, l[m.id] = {
      node: m,
      idx: x
    };
  });
  var c = (0, pY.default)(t, e), h = {};
  c.forEach(function(m, x) {
    var _ = o[x].id;
    h[_] = {}, m.forEach(function(w, E) {
      if (!!w) {
        var M = o[E].id;
        h[_][M] = w;
      }
    });
  });
  for (var d = 0, v = function() {
    var x = !1;
    if (o.forEach(function(_) {
      var w = {};
      Object.keys(h[_.id]).forEach(function(k) {
        var L = h[_.id][k], O = l[k].node, D = O.clusterId;
        w[D] || (w[D] = 0), w[D] += L;
      });
      var E = -1 / 0, M = [];
      if (Object.keys(w).forEach(function(k) {
        E < w[k] ? (E = w[k], M = [k]) : E === w[k] && M.push(k);
      }), !(M.length === 1 && M[0] === _.clusterId)) {
        var C = M.indexOf(_.clusterId);
        if (C >= 0 && M.splice(C, 1), M && M.length) {
          x = !0;
          var S = f[_.clusterId], A = S.nodes.indexOf(_);
          S.nodes.splice(A, 1);
          var T = Math.floor(Math.random() * M.length), P = f[M[T]];
          P.nodes.push(_), _.clusterId = P.id;
        }
      }
    }), !x)
      return "break";
    d++;
  }; d < i; ) {
    var p = v();
    if (p === "break")
      break;
  }
  Object.keys(f).forEach(function(m) {
    var x = f[m];
    (!x.nodes || !x.nodes.length) && delete f[m];
  });
  var g = [], y = {};
  u.forEach(function(m) {
    var x = m.source, _ = m.target, w = m[n] || 1, E = l[x].node.clusterId, M = l[_].node.clusterId, C = "".concat(E, "---").concat(M);
    if (y[C])
      y[C].weight += w, y[C].count++;
    else {
      var S = {
        source: E,
        target: M,
        weight: w,
        count: 1
      };
      y[C] = S, g.push(S);
    }
  });
  var b = [];
  return Object.keys(f).forEach(function(m) {
    b.push(f[m]);
  }), {
    clusters: b,
    clusterEdges: g
  };
}, bY = mY;
jp.default = bY;
var $p = {}, nh = {};
Object.defineProperty(nh, "__esModule", {
  value: !0
});
nh.default = void 0;
var xY = th, _Y = function() {
  function r(t) {
    this.arr = t;
  }
  return r.prototype.getArr = function() {
    return this.arr || [];
  }, r.prototype.add = function(t) {
    var e, n = t.arr;
    if (!(!((e = this.arr) === null || e === void 0) && e.length))
      return new r(n);
    if (!(n != null && n.length))
      return new r(this.arr);
    if (this.arr.length === n.length) {
      var i = [];
      for (var a in this.arr)
        i[a] = this.arr[a] + n[a];
      return new r(i);
    }
  }, r.prototype.subtract = function(t) {
    var e, n = t.arr;
    if (!(!((e = this.arr) === null || e === void 0) && e.length))
      return new r(n);
    if (!(n != null && n.length))
      return new r(this.arr);
    if (this.arr.length === n.length) {
      var i = [];
      for (var a in this.arr)
        i[a] = this.arr[a] - n[a];
      return new r(i);
    }
  }, r.prototype.avg = function(t) {
    var e = [];
    if (t !== 0)
      for (var n in this.arr)
        e[n] = this.arr[n] / t;
    return new r(e);
  }, r.prototype.negate = function() {
    var t = [];
    for (var e in this.arr)
      t[e] = -this.arr[e];
    return new r(t);
  }, r.prototype.squareEuclideanDistance = function(t) {
    var e, n = t.arr;
    if (!(!((e = this.arr) === null || e === void 0) && e.length) || !(n != null && n.length))
      return 0;
    if (this.arr.length === n.length) {
      var i = 0;
      for (var a in this.arr)
        i += Math.pow(this.arr[a] - t.arr[a], 2);
      return i;
    }
  }, r.prototype.euclideanDistance = function(t) {
    var e, n = t.arr;
    if (!(!((e = this.arr) === null || e === void 0) && e.length) || !(n != null && n.length))
      return 0;
    if (this.arr.length === n.length) {
      var i = 0;
      for (var a in this.arr)
        i += Math.pow(this.arr[a] - t.arr[a], 2);
      return Math.sqrt(i);
    } else
      console.error("The two vectors are unequal in length.");
  }, r.prototype.normalize = function() {
    var t = [], e = (0, xY.clone)(this.arr);
    e.sort(function(o, s) {
      return o - s;
    });
    var n = e[e.length - 1], i = e[0];
    for (var a in this.arr)
      t[a] = (this.arr[a] - i) / (n - i);
    return new r(t);
  }, r.prototype.norm2 = function() {
    var t;
    if (!(!((t = this.arr) === null || t === void 0) && t.length))
      return 0;
    var e = 0;
    for (var n in this.arr)
      e += Math.pow(this.arr[n], 2);
    return Math.sqrt(e);
  }, r.prototype.dot = function(t) {
    var e, n = t.arr;
    if (!(!((e = this.arr) === null || e === void 0) && e.length) || !(n != null && n.length))
      return 0;
    if (this.arr.length === n.length) {
      var i = 0;
      for (var a in this.arr)
        i += this.arr[a] * t.arr[a];
      return i;
    } else
      console.error("The two vectors are unequal in length.");
  }, r.prototype.equal = function(t) {
    var e, n = t.arr;
    if (((e = this.arr) === null || e === void 0 ? void 0 : e.length) !== (n == null ? void 0 : n.length))
      return !1;
    for (var i in this.arr)
      if (this.arr[i] !== n[i])
        return !1;
    return !0;
  }, r;
}(), wY = _Y;
nh.default = wY;
var Da = {}, Wf = {};
Object.defineProperty(Wf, "__esModule", {
  value: !0
});
Wf.secondReg = Wf.dateReg = void 0;
var EY = /^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/;
Wf.secondReg = EY;
var SY = /^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})$/;
Wf.dateReg = SY;
Object.defineProperty(Da, "__esModule", {
  value: !0
});
Da.getPropertyWeight = Da.getAllSortProperties = Da.getAllProperties = Da.default = void 0;
var R2 = Wf, Pb = function(t, e) {
  t === void 0 && (t = []), e === void 0 && (e = 100);
  var n = {};
  t.forEach(function(a) {
    !a.properties || Object.keys(a.properties).forEach(function(o) {
      if (o === "id" || !"".concat(a.properties[o]).match(R2.secondReg) && !"".concat(a.properties[o]).match(R2.dateReg) && isNaN(Number(a.properties[o]))) {
        n.hasOwnProperty(o) && delete n[o];
        return;
      }
      n.hasOwnProperty(o) ? n[o] += 1 : n[o] = 1;
    });
  });
  var i = Object.keys(n).sort(function(a, o) {
    return n[o] - n[a];
  });
  return i.length < e ? i : i.slice(0, e);
};
Da.getAllSortProperties = Pb;
var MY = function(t, e) {
  return e.map(function(n) {
    return t.hasOwnProperty(n) ? t[n] : 0;
  });
}, fR = function(t) {
  for (var e = Pb(t), n = [], i = 0; i < t.length; i++)
    n[i] = MY(t[i].properties, e);
  return n;
};
Da.getPropertyWeight = fR;
var lR = function(t, e) {
  e === void 0 && (e = void 0);
  var n = [];
  return t.forEach(function(i) {
    e === void 0 && n.push(i), i[e] !== void 0 && n.push(i[e]);
  }), n;
};
Da.getAllProperties = lR;
var CY = {
  getAllSortProperties: Pb,
  getPropertyWeight: fR,
  getAllProperties: lR
};
Da.default = CY;
var ka = {}, ih = {};
Object.defineProperty(ih, "__esModule", {
  value: !0
});
ih.DistanceType = void 0;
var km;
ih.DistanceType = km;
(function(r) {
  r.EuclideanDistance = "euclideanDistance";
})(km || (ih.DistanceType = km = {}));
Object.defineProperty(ka, "__esModule", {
  value: !0
});
ka.oneHot = ka.getDistance = ka.getAllKeyValueMap = ka.default = void 0;
var B2 = th, G2 = ih, F2 = TY(nh);
function TY(r) {
  return r && r.__esModule ? r : { default: r };
}
var Ob = function(t, e, n) {
  var i = [];
  e != null && e.length ? i = e : (t.forEach(function(o) {
    i = i.concat(Object.keys(o));
  }), i = (0, B2.uniq)(i));
  var a = {};
  return i.forEach(function(o) {
    var s = [];
    t.forEach(function(u) {
      u[o] !== void 0 && u[o] !== "" && s.push(u[o]);
    }), s.length && !(n != null && n.includes(o)) && (a[o] = (0, B2.uniq)(s));
  }), a;
};
ka.getAllKeyValueMap = Ob;
var cR = function(t, e, n) {
  var i = Ob(t, e, n), a = [];
  if (!Object.keys(i).length)
    return a;
  var o = Object.values(i), s = o.every(function(u) {
    return u.every(function(f) {
      return typeof f == "number";
    });
  });
  return t.forEach(function(u, f) {
    var l = [];
    Object.keys(i).forEach(function(c) {
      var h = u[c], d = i[c], v = d.findIndex(function(y) {
        return h === y;
      }), p = [];
      if (s)
        p.push(h);
      else
        for (var g = 0; g < d.length; g++)
          g === v ? p.push(1) : p.push(0);
      l = l.concat(p);
    }), a[f] = l;
  }), a;
};
ka.oneHot = cR;
var hR = function(t, e, n, i) {
  n === void 0 && (n = G2.DistanceType.EuclideanDistance);
  var a = 0;
  switch (n) {
    case G2.DistanceType.EuclideanDistance:
      a = new F2.default(t).euclideanDistance(new F2.default(e));
      break;
  }
  return a;
};
ka.getDistance = hR;
var AY = {
  getAllKeyValueMap: Ob,
  oneHot: cR,
  getDistance: hR
};
ka.default = AY;
Object.defineProperty($p, "__esModule", {
  value: !0
});
$p.default = void 0;
var IY = th, PY = dR(Cu), Il = dR(nh), OY = Da, DY = ka;
function dR(r) {
  return r && r.__esModule ? r : { default: r };
}
var z2 = function(t, e, n, i) {
  for (var a = e.length, o = 2 * i, s = 0, u = 0; u < a; u++)
    for (var f = t[u].clusterId, l = 0; l < a; l++) {
      var c = t[l].clusterId;
      if (f === c) {
        var h = e[u][l] || 0, d = n[u] || 0, v = n[l] || 0;
        s += h - d * v / o;
      }
    }
  return s *= 1 / o, s;
}, W0 = function(t, e) {
  t === void 0 && (t = []);
  for (var n = t.length, i = new Il.default([]), a = 0; a < n; a++)
    i = i.add(new Il.default(e[a]));
  var o = i.avg(n);
  o.normalize();
  for (var s = 0, a = 0; a < n; a++) {
    var u = new Il.default(e[a]), f = u.squareEuclideanDistance(o);
    s += f;
  }
  var l = [];
  t.forEach(function() {
    l.push([]);
  });
  for (var a = 0; a < n; a++) {
    var u = new Il.default(e[a]);
    t[a].clusterInertial = 0;
    for (var c = 0; c < n; c++) {
      if (a === c) {
        l[a][c] = 0;
        continue;
      }
      var h = new Il.default(e[c]);
      l[a][c] = u.squareEuclideanDistance(h), t[a].clusterInertial += l[a][c];
    }
  }
  for (var d = 0, v = 2 * n * s, a = 0; a < n; a++)
    for (var p = t[a].clusterId, c = 0; c < n; c++) {
      var g = t[c].clusterId;
      if (!(a === c || p !== g)) {
        var y = t[a].clusterInertial * t[c].clusterInertial / Math.pow(v, 2) - l[a][c] / v;
        d += y;
      }
    }
  return Number(d.toFixed(4));
}, kY = function(t, e, n, i, a, o, s, u, f) {
  e === void 0 && (e = !1), n === void 0 && (n = "weight"), i === void 0 && (i = 1e-4), a === void 0 && (a = !1), o === void 0 && (o = void 0), s === void 0 && (s = []), u === void 0 && (u = ["id"]), f === void 0 && (f = 1);
  var l = t.nodes, c = l === void 0 ? [] : l, h = t.edges, d = h === void 0 ? [] : h, v = [];
  if (a) {
    c.forEach(function(R, F) {
      R.properties = R.properties || {}, R.originIndex = F;
    });
    var p = [];
    c.every(function(R) {
      return R.hasOwnProperty("nodeType");
    }) && (p = Array.from(new Set(c.map(function(R) {
      return R.nodeType;
    }))), c.forEach(function(R) {
      R.properties.nodeType = p.findIndex(function(F) {
        return F === R.nodeType;
      });
    }));
    var g = (0, OY.getAllProperties)(c, o);
    v = (0, DY.oneHot)(g, s, u);
  }
  var y = 1, b = {}, m = {};
  c.forEach(function(R, F) {
    var q = String(y++);
    R.clusterId = q, b[q] = {
      id: q,
      nodes: [R]
    }, m[R.id] = {
      node: R,
      idx: F
    };
  });
  var x = (0, PY.default)(t, e), _ = [], w = {}, E = 0;
  x.forEach(function(R, F) {
    var q = 0, ne = c[F].id;
    w[ne] = {}, R.forEach(function(oe, ie) {
      if (!!oe) {
        q += oe;
        var Ee = c[ie].id;
        w[ne][Ee] = oe, E += oe;
      }
    }), _.push(q);
  }), E /= 2;
  for (var M = 1 / 0, C = 1 / 0, S = 0, A = [], T = {}; ; ) {
    a && c.every(function(R) {
      return R.hasOwnProperty("properties");
    }) ? M = z2(c, x, _, E) + W0(c, v) * f : M = z2(c, x, _, E), S === 0 && (C = M, A = c, T = b);
    var P = M > 0 && M > C && M - C < i;
    if (M > C && (A = c.map(function(R) {
      return {
        node: R,
        clusterId: R.clusterId
      };
    }), T = (0, IY.clone)(b), C = M), P || S > 100)
      break;
    S++, Object.keys(b).forEach(function(R) {
      var F = 0;
      d.forEach(function(q) {
        var ne = q.source, oe = q.target, ie = m[ne].node.clusterId, Ee = m[oe].node.clusterId;
        (ie === R && Ee !== R || Ee === R && ie !== R) && (F = F + (q[n] || 1));
      }), b[R].sumTot = F;
    }), c.forEach(function(R, F) {
      var q = b[R.clusterId], ne = 0, oe, ie = _[F] / (2 * E), Ee = 0, Xe = q.nodes;
      Xe.forEach(function(X) {
        var De = m[X.id].idx;
        Ee += x[F][De] || 0;
      });
      var le = Ee - q.sumTot * ie, Me = Xe.filter(function(X) {
        return X.id !== R.id;
      });
      Me.forEach(function(X, De) {
        v[X.originIndex];
      });
      var $e = W0(Me, v) * f, et = w[R.id];
      if (Object.keys(et).forEach(function(X) {
        var De = m[X].node, Ke = De.clusterId;
        if (Ke !== R.clusterId) {
          var Fe = b[Ke], _t = Fe.nodes;
          if (!(!_t || !_t.length)) {
            var Kt = 0;
            _t.forEach(function(pe) {
              var se = m[pe.id].idx;
              Kt += x[F][se] || 0;
            });
            var Ye = Kt - Fe.sumTot * ie, vt = _t.concat([R]);
            vt.forEach(function(pe, se) {
              v[pe.originIndex];
            });
            var N = W0(vt, v) * f, Z = Ye - le;
            a && (Z = Ye + N - (le + $e)), Z > ne && (ne = Z, oe = Fe);
          }
        }
      }), ne > 0) {
        oe.nodes.push(R);
        var ft = R.clusterId;
        R.clusterId = oe.id;
        var pt = q.nodes.indexOf(R);
        q.nodes.splice(pt, 1);
        var $ = 0, te = 0;
        d.forEach(function(X) {
          var De = X.source, Ke = X.target, Fe = m[De].node.clusterId, _t = m[Ke].node.clusterId;
          (Fe === oe.id && _t !== oe.id || _t === oe.id && Fe !== oe.id) && ($ = $ + (X[n] || 1)), (Fe === ft && _t !== ft || _t === ft && Fe !== ft) && (te = te + (X[n] || 1));
        }), oe.sumTot = $, q.sumTot = te;
      }
    });
  }
  var k = {}, L = 0;
  Object.keys(T).forEach(function(R) {
    var F = T[R];
    if (!F.nodes || !F.nodes.length) {
      delete T[R];
      return;
    }
    var q = String(L + 1);
    q !== R && (F.id = q, F.nodes = F.nodes.map(function(ne) {
      return {
        id: ne.id,
        clusterId: q
      };
    }), T[q] = F, k[R] = q, delete T[R], L++);
  }), A.forEach(function(R) {
    var F = R.node, q = R.clusterId;
    !F || (F.clusterId = q, F.clusterId && k[F.clusterId] && (F.clusterId = k[F.clusterId]));
  });
  var O = [], D = {};
  d.forEach(function(R) {
    var F = R.source, q = R.target, ne = R[n] || 1, oe = m[F].node.clusterId, ie = m[q].node.clusterId;
    if (!(!oe || !ie)) {
      var Ee = "".concat(oe, "---").concat(ie);
      if (D[Ee])
        D[Ee].weight += ne, D[Ee].count++;
      else {
        var Xe = {
          source: oe,
          target: ie,
          weight: ne,
          count: 1
        };
        D[Ee] = Xe, O.push(Xe);
      }
    }
  });
  var G = [];
  return Object.keys(T).forEach(function(R) {
    G.push(T[R]);
  }), {
    clusters: G,
    clusterEdges: O
  };
}, LY = kY;
$p.default = LY;
var Wp = {}, Vp = {};
Object.defineProperty(Vp, "__esModule", {
  value: !0
});
Vp.default = void 0;
var NY = function() {
  function r(t) {
    this.count = t.length, this.parent = {};
    for (var e = 0, n = t; e < n.length; e++) {
      var i = n[e];
      this.parent[i] = i;
    }
  }
  return r.prototype.find = function(t) {
    for (; this.parent[t] !== t; )
      t = this.parent[t];
    return t;
  }, r.prototype.union = function(t, e) {
    var n = this.find(t), i = this.find(e);
    n !== i && (n < i ? (this.parent[e] !== e && this.union(this.parent[e], t), this.parent[e] = this.parent[t]) : (this.parent[t] !== t && this.union(this.parent[t], e), this.parent[t] = this.parent[e]));
  }, r.prototype.connected = function(t, e) {
    return this.find(t) === this.find(e);
  }, r;
}(), RY = NY;
Vp.default = RY;
var Xp = {};
Object.defineProperty(Xp, "__esModule", {
  value: !0
});
Xp.default = void 0;
var BY = function(t, e) {
  return t - e;
}, GY = function() {
  function r(t) {
    t === void 0 && (t = BY), this.compareFn = t, this.list = [];
  }
  return r.prototype.getLeft = function(t) {
    return 2 * t + 1;
  }, r.prototype.getRight = function(t) {
    return 2 * t + 2;
  }, r.prototype.getParent = function(t) {
    return t === 0 ? null : Math.floor((t - 1) / 2);
  }, r.prototype.isEmpty = function() {
    return this.list.length <= 0;
  }, r.prototype.top = function() {
    return this.isEmpty() ? void 0 : this.list[0];
  }, r.prototype.delMin = function() {
    var t = this.top(), e = this.list.pop();
    return this.list.length > 0 && (this.list[0] = e, this.moveDown(0)), t;
  }, r.prototype.insert = function(t) {
    if (t !== null) {
      this.list.push(t);
      var e = this.list.length - 1;
      return this.moveUp(e), !0;
    }
    return !1;
  }, r.prototype.moveUp = function(t) {
    for (var e = this.getParent(t); t && t > 0 && this.compareFn(this.list[e], this.list[t]) > 0; ) {
      var n = this.list[e];
      this.list[e] = this.list[t], this.list[t] = n, t = e, e = this.getParent(t);
    }
  }, r.prototype.moveDown = function(t) {
    var e, n = t, i = this.getLeft(t), a = this.getRight(t), o = this.list.length;
    i !== null && i < o && this.compareFn(this.list[n], this.list[i]) > 0 ? n = i : a !== null && a < o && this.compareFn(this.list[n], this.list[a]) > 0 && (n = a), t !== n && (e = [this.list[n], this.list[t]], this.list[t] = e[0], this.list[n] = e[1], this.moveDown(n));
  }, r;
}(), FY = GY;
Xp.default = FY;
Object.defineProperty(Wp, "__esModule", {
  value: !0
});
Wp.default = void 0;
var zY = vR(Vp), UY = vR(Xp), V0 = yn;
function vR(r) {
  return r && r.__esModule ? r : { default: r };
}
var jY = function(t, e) {
  var n = [], i = t.nodes, a = i === void 0 ? [] : i, o = t.edges, s = o === void 0 ? [] : o;
  if (a.length === 0)
    return n;
  var u = a[0], f = /* @__PURE__ */ new Set();
  f.add(u);
  var l = function(g, y) {
    return e ? g.weight - y.weight : 0;
  }, c = new UY.default(l);
  for ((0, V0.getEdgesByNodeId)(u.id, s).forEach(function(p) {
    c.insert(p);
  }); !c.isEmpty(); ) {
    var h = c.delMin(), d = h.source, v = h.target;
    f.has(d) && f.has(v) || (n.push(h), f.has(d) || (f.add(d), (0, V0.getEdgesByNodeId)(d, s).forEach(function(p) {
      c.insert(p);
    })), f.has(v) || (f.add(v), (0, V0.getEdgesByNodeId)(v, s).forEach(function(p) {
      c.insert(p);
    })));
  }
  return n;
}, U2 = function(t, e) {
  var n = [], i = t.nodes, a = i === void 0 ? [] : i, o = t.edges, s = o === void 0 ? [] : o;
  if (a.length === 0)
    return n;
  var u = s.map(function(d) {
    return d;
  });
  e && u.sort(function(d, v) {
    return d.weight - v.weight;
  });
  for (var f = new zY.default(a.map(function(d) {
    return d.id;
  })); u.length > 0; ) {
    var l = u.shift(), c = l.source, h = l.target;
    f.connected(c, h) || (n.push(l), f.union(c, h));
  }
  return n;
}, $Y = function(t, e, n) {
  var i = {
    prim: jY,
    kruskal: U2
  };
  return n ? i[n](t, e) : U2(t, e);
}, WY = $Y;
Wp.default = WY;
var Yp = {};
Object.defineProperty(Yp, "__esModule", {
  value: !0
});
Yp.default = void 0;
var VY = YY(Eo), XY = yn;
function YY(r) {
  return r && r.__esModule ? r : { default: r };
}
var HY = function(t, e, n) {
  typeof e != "number" && (e = 1e-6), typeof n != "number" && (n = 0.85);
  for (var i = 1, a = 0, o = 1e3, s = t.nodes, u = s === void 0 ? [] : s, f = t.edges, l = f === void 0 ? [] : f, c = u.length, h, d = {}, v = {}, p = 0; p < c; ++p) {
    var g = u[p], y = g.id;
    d[y] = 1 / c, v[y] = 1 / c;
  }
  for (var b = (0, VY.default)(t); o > 0 && i > e; ) {
    a = 0;
    for (var p = 0; p < c; ++p) {
      var g = u[p], y = g.id;
      if (h = 0, b[g.id].inDegree === 0)
        d[y] = 0;
      else {
        for (var m = (0, XY.getNeighbors)(y, l, "source"), x = 0; x < m.length; ++x) {
          var _ = m[x], w = b[_].outDegree;
          w > 0 && (h += v[_] / w);
        }
        d[y] = n * h, a += d[y];
      }
    }
    a = (1 - a) / c, i = 0;
    for (var p = 0; p < c; ++p) {
      var g = u[p], y = g.id;
      h = d[y] + a, i += Math.abs(h - v[y]), v[y] = h;
    }
    o -= 1;
  }
  return v;
}, KY = HY;
Yp.default = KY;
var Hp = {}, Kp = {}, pn = {};
Object.defineProperty(pn, "__esModule", {
  value: !0
});
pn.VACANT_NODE_LABEL = pn.VACANT_NODE_ID = pn.VACANT_GRAPH_ID = pn.VACANT_EDGE_LABEL = pn.VACANT_EDGE_ID = pn.Node = pn.Graph = pn.Edge = pn.AUTO_EDGE_ID = void 0;
var pR = -1;
pn.VACANT_EDGE_ID = pR;
var Gc = -1;
pn.VACANT_NODE_ID = Gc;
var gR = "-1";
pn.VACANT_EDGE_LABEL = gR;
var yR = "-1";
pn.VACANT_NODE_LABEL = yR;
var qY = -1;
pn.VACANT_GRAPH_ID = qY;
var ZY = "-1";
pn.AUTO_EDGE_ID = ZY;
var Lm = function() {
  function r(t, e, n, i) {
    t === void 0 && (t = pR), e === void 0 && (e = Gc), n === void 0 && (n = Gc), i === void 0 && (i = gR), this.id = t, this.from = e, this.to = n, this.label = i;
  }
  return r;
}();
pn.Edge = Lm;
var mR = function() {
  function r(t, e) {
    t === void 0 && (t = Gc), e === void 0 && (e = yR), this.id = t, this.label = e, this.edges = [], this.edgeMap = {};
  }
  return r.prototype.addEdge = function(t) {
    this.edges.push(t), this.edgeMap[t.id] = t;
  }, r;
}();
pn.Node = mR;
var QY = function() {
  function r(t, e, n) {
    t === void 0 && (t = Gc), e === void 0 && (e = !0), n === void 0 && (n = !1), this.id = t, this.edgeIdAutoIncrease = e, this.edges = [], this.nodes = [], this.nodeMap = {}, this.edgeMap = {}, this.nodeLabelMap = {}, this.edgeLabelMap = {}, this.counter = 0, this.directed = n;
  }
  return r.prototype.getNodeNum = function() {
    return this.nodes.length;
  }, r.prototype.addNode = function(t, e) {
    if (!this.nodeMap[t]) {
      var n = new mR(t, e);
      this.nodes.push(n), this.nodeMap[t] = n, this.nodeLabelMap[e] || (this.nodeLabelMap[e] = []), this.nodeLabelMap[e].push(t);
    }
  }, r.prototype.addEdge = function(t, e, n, i) {
    if ((this.edgeIdAutoIncrease || t === void 0) && (t = this.counter++), !(this.nodeMap[e] && this.nodeMap[n] && this.nodeMap[n].edgeMap[t])) {
      var a = new Lm(t, e, n, i);
      if (this.edges.push(a), this.edgeMap[t] = a, this.nodeMap[e].addEdge(a), this.edgeLabelMap[i] || (this.edgeLabelMap[i] = []), this.edgeLabelMap[i].push(a), !this.directed) {
        var o = new Lm(t, n, e, i);
        this.nodeMap[n].addEdge(o), this.edgeLabelMap[i].push(o);
      }
    }
  }, r;
}();
pn.Graph = QY;
Object.defineProperty(Kp, "__esModule", {
  value: !0
});
Kp.default = void 0;
var JY = th, si = pn, qs = function() {
  function r(t, e, n, i, a) {
    this.fromNode = t, this.toNode = e, this.nodeEdgeNodeLabel = {
      nodeLabel1: n || si.VACANT_NODE_LABEL,
      edgeLabel: i || si.VACANT_EDGE_LABEL,
      nodeLabel2: a || si.VACANT_NODE_LABEL
    };
  }
  return r.prototype.equalTo = function(t) {
    return this.fromNode === t.formNode && this.toNode === t.toNode && this.nodeEdgeNodeLabel === t.nodeEdgeNodeLabel;
  }, r.prototype.notEqualTo = function(t) {
    return !this.equalTo(t);
  }, r;
}(), j2 = function() {
  function r() {
    this.rmpath = [], this.dfsEdgeList = [];
  }
  return r.prototype.equalTo = function(t) {
    var e = this.dfsEdgeList.length, n = t.length;
    if (e !== n)
      return !1;
    for (var i = 0; i < e; i++)
      if (this.dfsEdgeList[i] !== t[i])
        return !1;
    return !0;
  }, r.prototype.notEqualTo = function(t) {
    return !this.equalTo(t);
  }, r.prototype.pushBack = function(t, e, n, i, a) {
    return this.dfsEdgeList.push(new qs(t, e, n, i, a)), this.dfsEdgeList;
  }, r.prototype.toGraph = function(t, e) {
    t === void 0 && (t = si.VACANT_GRAPH_ID), e === void 0 && (e = !1);
    var n = new si.Graph(t, !0, e);
    return this.dfsEdgeList.forEach(function(i) {
      var a = i.fromNode, o = i.toNode, s = i.nodeEdgeNodeLabel, u = s.nodeLabel1, f = s.edgeLabel, l = s.nodeLabel2;
      u !== si.VACANT_NODE_LABEL && n.addNode(a, u), l !== si.VACANT_NODE_LABEL && n.addNode(o, l), u !== si.VACANT_NODE_LABEL && l !== u && n.addEdge(void 0, a, o, f);
    }), n;
  }, r.prototype.buildRmpath = function() {
    this.rmpath = [];
    for (var t = void 0, e = this.dfsEdgeList.length, n = e - 1; n >= 0; n--) {
      var i = this.dfsEdgeList[n], a = i.fromNode, o = i.toNode;
      a < o && (t === void 0 || o === t) && (this.rmpath.push(n), t = a);
    }
    return this.rmpath;
  }, r.prototype.getNodeNum = function() {
    var t = {};
    return this.dfsEdgeList.forEach(function(e) {
      t[e.fromNode] || (t[e.fromNode] = !0), t[e.toNode] || (t[e.toNode] = !0);
    }), Object.keys(t).length;
  }, r;
}(), wd = function() {
  function r(t) {
    if (this.his = {}, this.nodesUsed = {}, this.edgesUsed = {}, this.edges = [], !!t) {
      for (; t; ) {
        var e = t.edge;
        this.edges.push(e), this.nodesUsed[e.from] = 1, this.nodesUsed[e.to] = 1, this.edgesUsed[e.id] = 1, t = t.preNode;
      }
      this.edges = this.edges.reverse();
    }
  }
  return r.prototype.hasNode = function(t) {
    return this.nodesUsed[t.id] === 1;
  }, r.prototype.hasEdge = function(t) {
    return this.edgesUsed[t.id] === 1;
  }, r;
}(), eH = function() {
  function r(t) {
    var e = t.graphs, n = t.minSupport, i = n === void 0 ? 2 : n, a = t.minNodeNum, o = a === void 0 ? 1 : a, s = t.maxNodeNum, u = s === void 0 ? 4 : s, f = t.top, l = f === void 0 ? 10 : f, c = t.directed, h = c === void 0 ? !1 : c, d = t.verbose, v = d === void 0 ? !1 : d;
    this.graphs = e, this.dfsCode = new j2(), this.support = 0, this.frequentSize1Subgraphs = [], this.frequentSubgraphs = [], this.minSupport = i, this.top = l, this.directed = h, this.counter = 0, this.maxNodeNum = u, this.minNodeNum = o, this.verbose = v, this.maxNodeNum < this.minNodeNum && (this.maxNodeNum = this.minNodeNum), this.reportDF = [];
  }
  return r.prototype.findForwardRootEdges = function(t, e) {
    var n = this, i = [], a = t.nodeMap;
    return e.edges.forEach(function(o) {
      (n.directed || e.label <= a[o.to].label) && i.push(o);
    }), i;
  }, r.prototype.findBackwardEdge = function(t, e, n, i) {
    if (!this.directed && e === n)
      return null;
    for (var a = t.nodeMap, o = a[n.to], s = o.edges, u = s.length, f = 0; f < u; f++) {
      var l = s[f];
      if (!(i.hasEdge(l) || l.to !== e.from)) {
        if (this.directed) {
          if (a[e.from].label < a[n.to].label || a[e.from].label === a[n.to].label && e.label <= l.label)
            return l;
        } else if (e.label < l.label || e.label === l.label && a[e.to].label <= a[n.to].label)
          return l;
      }
    }
    return null;
  }, r.prototype.findForwardPureEdges = function(t, e, n, i) {
    for (var a = [], o = e.to, s = t.nodeMap[o].edges, u = s.length, f = 0; f < u; f++) {
      var l = s[f], c = t.nodeMap[l.to];
      n <= c.label && !i.hasNode(c) && a.push(l);
    }
    return a;
  }, r.prototype.findForwardRmpathEdges = function(t, e, n, i) {
    for (var a = [], o = t.nodeMap, s = o[e.to].label, u = o[e.from], f = u.edges, l = f.length, c = 0; c < l; c++) {
      var h = f[c], d = o[h.to].label;
      e.to === h.to || n > d || i.hasNode(o[h.to]) || (e.label < h.label || e.label === h.label && s <= d) && a.push(h);
    }
    return a;
  }, r.prototype.getSupport = function(t) {
    var e = {};
    return t.forEach(function(n) {
      e[n.graphId] || (e[n.graphId] = !0);
    }), Object.keys(e).length;
  }, r.prototype.findMinLabel = function(t) {
    var e = void 0;
    return Object.keys(t).forEach(function(n) {
      var i = t[n], a = i.nodeLabel1, o = i.edgeLabel, s = i.nodeLabel2;
      if (!e) {
        e = {
          nodeLabel1: a,
          edgeLabel: o,
          nodeLabel2: s
        };
        return;
      }
      (a < e.nodeLabel1 || a === e.nodeLabel1 && o < e.edgeLabel || a === e.nodeLabel1 && o === e.edgeLabel && s < e.nodeLabel2) && (e = {
        nodeLabel1: a,
        edgeLabel: o,
        nodeLabel2: s
      });
    }), e;
  }, r.prototype.isMin = function() {
    var t = this, e = this.dfsCode;
    if (this.verbose && console.log("isMin checking", e), e.dfsEdgeList.length === 1)
      return !0;
    var n = this.directed, i = e.toGraph(si.VACANT_GRAPH_ID, n), a = i.nodeMap, o = new j2(), s = {};
    i.nodes.forEach(function(c) {
      var h = t.findForwardRootEdges(i, c);
      h.forEach(function(d) {
        var v = a[d.to], p = "".concat(c.label, "-").concat(d.label, "-").concat(v.label);
        s[p] || (s[p] = {
          projected: [],
          nodeLabel1: c.label,
          edgeLabel: d.label,
          nodeLabel2: v.label
        });
        var g = {
          graphId: i.id,
          edge: d,
          preNode: null
        };
        s[p].projected.push(g);
      });
    });
    var u = this.findMinLabel(s);
    if (!!u) {
      o.dfsEdgeList.push(new qs(0, 1, u.nodeLabel1, u.edgeLabel, u.nodeLabel2));
      var f = function c(h) {
        for (var d = o.buildRmpath(), v = o.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1, p = o.dfsEdgeList[d[0]].toNode, g = {}, y = !1, b = 0, m = n ? -1 : 0, x = function(D) {
          if (y)
            return "break";
          h.forEach(function(G) {
            var R = new wd(G), F = t.findBackwardEdge(i, R.edges[d[D]], R.edges[d[0]], R);
            F && (g[F.label] || (g[F.label] = {
              projected: [],
              edgeLabel: F.label
            }), g[F.label].projected.push({
              graphId: i.id,
              edge: g,
              preNode: G
            }), b = o.dfsEdgeList[d[D]].fromNode, y = !0);
          });
        }, _ = d.length - 1; _ > m; _--) {
          var w = x(_);
          if (w === "break")
            break;
        }
        if (y) {
          var E = t.findMinLabel(g);
          o.dfsEdgeList.push(new qs(p, b, si.VACANT_NODE_LABEL, E.edgeLabel, si.VACANT_NODE_LABEL));
          var M = o.dfsEdgeList.length - 1;
          return t.dfsCode.dfsEdgeList[M] !== o.dfsEdgeList[M] ? !1 : c(g[E.edgeLabel].projected);
        }
        var C = {};
        y = !1;
        var S = 0;
        h.forEach(function(O) {
          var D = new wd(O), G = t.findForwardPureEdges(i, D.edges[d[0]], v, D);
          G.length > 0 && (y = !0, S = p, G.forEach(function(R) {
            var F = "".concat(R.label, "-").concat(a[R.to].label);
            C[F] || (C[F] = {
              projected: [],
              edgeLabel: R.label,
              nodeLabel2: a[R.to].label
            }), C[F].projected.push({
              graphId: i.id,
              edge: R,
              preNode: O
            });
          }));
        });
        for (var A = d.length, T = function(D) {
          if (y)
            return "break";
          var G = d[D];
          h.forEach(function(R) {
            var F = new wd(R), q = t.findForwardRmpathEdges(i, F.edges[G], v, F);
            q.length > 0 && (y = !0, S = o.dfsEdgeList[G].fromNode, q.forEach(function(ne) {
              var oe = "".concat(ne.label, "-").concat(a[ne.to].label);
              C[oe] || (C[oe] = {
                projected: [],
                edgeLabel: ne.label,
                nodeLabel2: a[ne.to].label
              }), C[oe].projected.push({
                graphId: i.id,
                edge: ne,
                preNode: R
              });
            }));
          });
        }, _ = 0; _ < A; _++) {
          var P = T(_);
          if (P === "break")
            break;
        }
        if (!y)
          return !0;
        var k = t.findMinLabel(C);
        o.dfsEdgeList.push(new qs(S, p + 1, si.VACANT_NODE_LABEL, k.edgeLabel, k.nodeLabel2));
        var L = o.dfsEdgeList.length - 1;
        return e.dfsEdgeList[L] !== o.dfsEdgeList[L] ? !1 : c(C["".concat(k.edgeLabel, "-").concat(k.nodeLabel2)].projected);
      }, l = "".concat(u.nodeLabel1, "-").concat(u.edgeLabel, "-").concat(u.nodeLabel2);
      return f(s[l].projected);
    }
  }, r.prototype.report = function() {
    if (!(this.dfsCode.getNodeNum() < this.minNodeNum)) {
      this.counter++;
      var t = this.dfsCode.toGraph(this.counter, this.directed);
      this.frequentSubgraphs.push((0, JY.clone)(t));
    }
  }, r.prototype.subGraphMining = function(t) {
    var e = this, n = this.getSupport(t);
    if (!(n < this.minSupport) && !!this.isMin()) {
      this.report();
      var i = this.dfsCode.getNodeNum(), a = this.dfsCode.buildRmpath(), o = this.dfsCode.dfsEdgeList[a[0]].toNode, s = this.dfsCode.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1, u = {}, f = {};
      t.forEach(function(l) {
        for (var c = e.graphs[l.graphId], h = c.nodeMap, d = new wd(l), v = a.length - 1; v >= 0; v--) {
          var p = e.findBackwardEdge(c, d.edges[a[v]], d.edges[a[0]], d);
          if (p) {
            var g = "".concat(e.dfsCode.dfsEdgeList[a[v]].fromNode, "-").concat(p.label);
            f[g] || (f[g] = {
              projected: [],
              toNodeId: e.dfsCode.dfsEdgeList[a[v]].fromNode,
              edgeLabel: p.label
            }), f[g].projected.push({
              graphId: l.graphId,
              edge: p,
              preNode: l
            });
          }
        }
        if (!(i >= e.maxNodeNum)) {
          var y = e.findForwardPureEdges(c, d.edges[a[0]], s, d);
          y.forEach(function(m) {
            var x = "".concat(o, "-").concat(m.label, "-").concat(h[m.to].label);
            u[x] || (u[x] = {
              projected: [],
              fromNodeId: o,
              edgeLabel: m.label,
              nodeLabel2: h[m.to].label
            }), u[x].projected.push({
              graphId: l.graphId,
              edge: m,
              preNode: l
            });
          });
          for (var b = function(x) {
            var _ = e.findForwardRmpathEdges(c, d.edges[a[x]], s, d);
            _.forEach(function(w) {
              var E = "".concat(e.dfsCode.dfsEdgeList[a[x]].fromNode, "-").concat(w.label, "-").concat(h[w.to].label);
              u[E] || (u[E] = {
                projected: [],
                fromNodeId: e.dfsCode.dfsEdgeList[a[x]].fromNode,
                edgeLabel: w.label,
                nodeLabel2: h[w.to].label
              }), u[E].projected.push({
                graphId: l.graphId,
                edge: w,
                preNode: l
              });
            });
          }, v = 0; v < a.length; v++)
            b(v);
        }
      }), Object.keys(f).forEach(function(l) {
        var c = f[l], h = c.toNodeId, d = c.edgeLabel;
        e.dfsCode.dfsEdgeList.push(new qs(o, h, "-1", d, "-1")), e.subGraphMining(f[l].projected), e.dfsCode.dfsEdgeList.pop();
      }), Object.keys(u).forEach(function(l) {
        var c = u[l], h = c.fromNodeId, d = c.edgeLabel, v = c.nodeLabel2;
        e.dfsCode.dfsEdgeList.push(new qs(h, o + 1, si.VACANT_NODE_LABEL, d, v)), e.subGraphMining(u[l].projected), e.dfsCode.dfsEdgeList.pop();
      });
    }
  }, r.prototype.generate1EdgeFrequentSubGraphs = function() {
    var t = this.graphs, e = this.directed, n = this.minSupport, i = this.frequentSize1Subgraphs, a = {}, o = {}, s = {};
    return Object.keys(t).forEach(function(u) {
      var f = t[u], l = f.nodeMap;
      f.nodes.forEach(function(c, h) {
        var d = c.label, v = "".concat(u, "-").concat(d);
        if (!s[v]) {
          var p = a[d] || 0;
          p++, a[d] = p;
        }
        s[v] = {
          graphKey: u,
          label: d
        }, c.edges.forEach(function(g) {
          var y = d, b = l[g.to].label;
          if (!e && y > b) {
            var m = b;
            b = y, y = m;
          }
          var x = g.label, _ = "".concat(y, "-").concat(x, "-").concat(b);
          if (!o[_]) {
            var w = o[_] || 0;
            w++, o[_] = w;
          }
        });
      });
    }), Object.keys(a).forEach(function(u) {
      var f = a[u];
      if (!(f < n)) {
        var l = {
          nodes: [],
          edges: []
        };
        l.nodes.push({
          id: "0",
          label: u
        }), i.push(l);
      }
    }), i;
  }, r.prototype.run = function() {
    var t = this;
    if (this.frequentSize1Subgraphs = this.generate1EdgeFrequentSubGraphs(), !(this.maxNodeNum < 2)) {
      var e = this.graphs;
      this.directed;
      var n = {};
      Object.keys(e).forEach(function(i) {
        var a = e[i], o = a.nodeMap;
        a.nodes.forEach(function(s) {
          var u = t.findForwardRootEdges(a, s);
          u.forEach(function(f) {
            var l = o[f.to], c = "".concat(s.label, "-").concat(f.label, "-").concat(l.label);
            n[c] || (n[c] = {
              projected: [],
              nodeLabel1: s.label,
              edgeLabel: f.label,
              nodeLabel2: l.label
            });
            var h = {
              graphId: i,
              edge: f,
              preNode: null
            };
            n[c].projected.push(h);
          });
        });
      }), Object.keys(n).forEach(function(i) {
        var a = n[i], o = a.projected, s = a.nodeLabel1, u = a.edgeLabel, f = a.nodeLabel2;
        t.dfsCode.dfsEdgeList.push(new qs(0, 1, s, u, f)), t.subGraphMining(o), t.dfsCode.dfsEdgeList.pop();
      });
    }
  }, r;
}(), tH = function(t, e, n, i) {
  var a = {};
  return Object.keys(t).forEach(function(o, s) {
    var u = t[o], f = new si.Graph(s, !0, e), l = {};
    u.nodes.forEach(function(c, h) {
      f.addNode(h, c[n]), l[c.id] = h;
    }), u.edges.forEach(function(c, h) {
      var d = l[c.source], v = l[c.target];
      f.addEdge(-1, d, v, c[i]);
    }), f && f.getNodeNum() && (a[f.id] = f);
  }), a;
}, rH = function(t, e, n) {
  var i = [];
  return t.forEach(function(a) {
    var o = {
      nodes: [],
      edges: []
    };
    a.nodes.forEach(function(s) {
      var u;
      o.nodes.push((u = {
        id: "".concat(s.id)
      }, u[e] = s.label, u));
    }), a.edges.forEach(function(s) {
      var u;
      o.edges.push((u = {
        source: "".concat(s.from),
        target: "".concat(s.to)
      }, u[n] = s.label, u));
    }), i.push(o);
  }), i;
}, $2 = "cluster", nH = function(t) {
  var e = t.graphs, n = t.directed, i = n === void 0 ? !1 : n, a = t.nodeLabelProp, o = a === void 0 ? $2 : a, s = t.edgeLabelProp, u = s === void 0 ? $2 : s, f = tH(e, i, o, u), l = t.minSupport, c = t.maxNodeNum, h = t.minNodeNum, d = t.verbose, v = t.top, p = {
    graphs: f,
    minSupport: l,
    maxNodeNum: c,
    minNodeNum: h,
    top: v,
    verbose: d,
    directed: i
  }, g = new eH(p);
  g.run();
  var y = rH(g.frequentSubgraphs, o, u);
  return y;
}, iH = nH;
Kp.default = iH;
Object.defineProperty(Hp, "__esModule", {
  value: !0
});
Hp.default = void 0;
var W2 = sR, V2 = Db(rh), aH = Db(Kp), X2 = Db(il), oH = yn;
function Db(r) {
  return r && r.__esModule ? r : { default: r };
}
var Y2 = function(t, e, n, i) {
  n === void 0 && (n = "cluster"), i === void 0 && (i = 2);
  var a = [], o = t.nodes;
  return e.forEach(function(s, u) {
    a.push(bR(o, s, u, n, i));
  }), a;
}, bR = function(t, e, n, i, a) {
  var o = [n], s = [], u = {};
  return e.forEach(function(f, l) {
    if (f <= a && n !== l) {
      o.push(l), s.push(t[l]);
      var c = t[l][i];
      u[c] ? (u[c].count++, u[c].dists.push(f)) : u[c] = {
        count: 1,
        dists: [f]
      };
    }
  }), Object.keys(u).forEach(function(f) {
    u[f].dists = u[f].dists.sort(function(l, c) {
      return l - c;
    });
  }), {
    nodeIdx: n,
    nodeId: t[n].id,
    nodeIdxs: o,
    neighbors: s,
    neighborNum: o.length - 1,
    nodeLabelCountMap: u
  };
}, sH = function(t, e, n, i, a) {
  var o = Math.ceil(n / e), s = {}, u = 0;
  return i.forEach(function(f, l) {
    for (var c = 0, h = 0, d = f.nodeIdxs, v = f.neighborNum - 1; c < o; ) {
      for (var p = d[1 + Math.floor(Math.random() * v)], g = 0; (s["".concat(l, "-").concat(p)] || s["".concat(p, "-").concat(l)]) && (p = Math.floor(Math.random() * e), g++, !(g > 2 * e)); )
        ;
      if (g < 2 * e && (s["".concat(l, "-").concat(p)] = {
        start: l,
        end: p,
        distance: a[l][p]
      }, c++, u++, u >= n))
        return s;
      if (h++, h > 2 * e)
        break;
    }
    if (c < o) {
      var y = o - c;
      o = (o + y) / (e - l - 1);
    }
  }), s;
}, xv = function(t, e, n, i) {
  var a = n.nodes;
  return i || (i = {}), Object.keys(t).forEach(function(o) {
    var s, u;
    if (!(i && i[o])) {
      i[o] = {
        nodes: [],
        edges: []
      };
      var f = t[o], l = (s = e[f.start]) === null || s === void 0 ? void 0 : s.nodeIdxs, c = (u = e[f.end]) === null || u === void 0 ? void 0 : u.nodeIdxs;
      if (!(!l || !c)) {
        var h = new Set(c), d = l.filter(function(b) {
          return h.has(b);
        });
        if (!(!d || !d.length)) {
          for (var v = {}, p = d.length, g = 0; g < p; g++) {
            var y = a[d[g]];
            i[o].nodes.push(y), v[y.id] = !0;
          }
          n.edges.forEach(function(b) {
            v[b.source] && v[b.target] && i[o].edges.push(b);
          });
        }
      }
    }
  }), i;
}, _v = function(t, e, n, i) {
  var a, o, s = {};
  t.nodes.forEach(function(f) {
    s[f.id] = f;
  });
  var u = 0;
  return !(!((a = e == null ? void 0 : e.edges) === null || a === void 0) && a.length) || ((o = e == null ? void 0 : e.nodes) === null || o === void 0 ? void 0 : o.length) < 2 ? 0 : (t.edges.forEach(function(f) {
    var l = s[f.source][n], c = s[f.target][n], h = e == null ? void 0 : e.nodes[0][n], d = e == null ? void 0 : e.nodes[1][n], v = e == null ? void 0 : e.edges[0][i];
    f[i] === v && (l === h && c === d || l === d && c === h) && u++;
  }), u);
}, uH = function(t, e, n) {
  for (var i = 1 / 0, a = 0, o = function(f) {
    var l = t[f], c = Object.keys(l).sort(function(b, m) {
      return l[b] - l[m];
    }), h = 10, d = [];
    c.forEach(function(b, m) {
      d[m % h] || (d[m % h] = {
        graphs: [],
        totalCount: 0,
        aveCount: 0
      }), d[m % h].graphs.push(b), d[m % h].totalCount += l[b];
    });
    var v = 0, p = [];
    d.forEach(function(b) {
      var m = b.totalCount / b.graphs.length;
      b.aveCount = m, p.push(m);
      var x = 0, _ = b.length;
      b.graphs.forEach(function(w, E) {
        var M = l[w];
        b.graphs.forEach(function(C, S) {
          E !== S && (x += Math.abs(M - l[C]));
        });
      }), x /= _ * (_ - 1) / 2, v += x;
    }), v /= d.length;
    var g = 0;
    p.forEach(function(b, m) {
      p.forEach(function(x, _) {
        m !== _ && (g += Math.abs(b - x));
      }), g /= p.length * (p.length - 1) / 2;
    });
    var y = g - v;
    i < y && (i = y, a = f);
  }, s = 0; s < e; s++)
    o(s);
  return {
    structure: n[a],
    structureCountMap: t[a]
  };
}, H2 = function(t, e) {
  var n = {}, i = {};
  return t.forEach(function(a, o) {
    n[a.id] = {
      idx: o,
      node: a,
      degree: 0,
      inDegree: 0,
      outDegree: 0
    };
    var s = a[e];
    i[s] || (i[s] = []), i[s].push(a);
  }), {
    nodeMap: n,
    nodeLabelMap: i
  };
}, K2 = function(t, e, n) {
  var i = {}, a = {};
  return t.forEach(function(o, s) {
    i["".concat(oH.uniqueId)] = {
      idx: s,
      edge: o
    };
    var u = o[e];
    a[u] || (a[u] = []), a[u].push(o);
    var f = n[o.source];
    f && (f.degree++, f.outDegree++);
    var l = n[o.target];
    l && (l.degree++, l.inDegree++);
  }), {
    edgeMap: i,
    edgeLabelMap: a
  };
}, q2 = function(t, e, n) {
  var i = e.length, a = {};
  return e.forEach(function(o, s) {
    for (var u = n ? 0 : s + 1, f = t[s].id, l = u; l < i; l++)
      if (s !== l) {
        var c = t[l].id, h = o[l];
        a["".concat(f, "-").concat(c)] = h, n || (a["".concat(c, "-").concat(f)] = h);
      }
  }), a;
}, fH = function(t, e, n, i, a, o, s, u, f, l, c) {
  var h, d = "".concat(e.id, "-").concat(n.id);
  if (l && l[d])
    return l[d];
  var v = c ? c[d] : void 0;
  if (!v) {
    var p = (h = {}, h[d] = {
      start: i[e.id].idx,
      end: i[n.id].idx,
      distance: a
    }, h);
    c = xv(p, o, t, c), v = c[d];
  }
  return _v(v, s, u, f);
}, Z2 = function(t, e, n, i) {
  var a, o, s, u = (a = t[e]) === null || a === void 0 ? void 0 : a.degree, f = (o = t[e]) === null || o === void 0 ? void 0 : o.inDegree, l = (s = t[e]) === null || s === void 0 ? void 0 : s.outDegree;
  return t[e] === void 0 && (u = 1 / 0, f = 1 / 0, l = 1 / 0, i[e].forEach(function(c) {
    var h = n[c.id].degree;
    u > h && (u = h);
    var d = n[c.id].inDegree;
    f > d && (f = d);
    var v = n[c.id].outDegree;
    l > v && (l = v);
  }), t[e] = {
    degree: u,
    inDegree: f,
    outDegree: l
  }), {
    minPatternNodeLabelDegree: u,
    minPatternNodeLabelInDegree: f,
    minPatternNodeLabelOutDegree: l
  };
}, lH = function(t, e, n, i, a, o, s) {
  var u;
  if (n === void 0 && (n = !1), o === void 0 && (o = "cluster"), s === void 0 && (s = "cluster"), !(!t || !t.nodes)) {
    var f = t.nodes.length;
    if (!!f) {
      var l = (0, V2.default)(t, n), c = (0, V2.default)(e, n), h = q2(t.nodes, l, n), d = q2(e.nodes, c, n), v = H2(t.nodes, o), p = v.nodeMap, g = v.nodeLabelMap, y = H2(e.nodes, o), b = y.nodeMap, m = y.nodeLabelMap;
      K2(t.edges, s, p);
      var x = K2(e.edges, s, b).edgeLabelMap, _ = [];
      c == null || c.forEach(function(Ye) {
        _ = _.concat(Ye);
      }), a || (a = Math.max.apply(Math, (0, W2.__spreadArray)((0, W2.__spreadArray)([], _, !1), [2], !1))), i || (i = a);
      var w = Y2(t, l, o, i), E = Y2(e, c, o, i), M = Math.min(100, f * (f - 1) / 2), C = sH(i, f, M, w, l), S = xv(C, w, t), A = 10, T = 1, P = 1, k = 4, L = {
        graphs: S,
        nodeLabelProp: o,
        edgeLabelProp: s,
        minSupport: T,
        minNodeNum: P,
        maxNodeNum: k,
        directed: n
      }, O = (0, aH.default)(L).slice(0, A), D = O.length, G = [];
      O.forEach(function(Ye, vt) {
        G[vt] = {}, Object.keys(S).forEach(function(N) {
          var Z = S[N], pe = _v(Z, Ye, o, s);
          G[vt][N] = pe;
        });
      });
      var R = uH(G, D, O), F = R.structure, q = R.structureCountMap, ne = e.nodes[0], oe = [], ie = (u = e.nodes[0]) === null || u === void 0 ? void 0 : u[o], Ee = -1 / 0;
      e.nodes.forEach(function(Ye) {
        var vt = Ye[o], N = g[vt];
        (N == null ? void 0 : N.length) > Ee && (Ee = N.length, oe = N, ie = vt, ne = Ye);
      });
      var Xe = {}, le = {}, Me = {}, $e = {}, et = {}, ft = {};
      Object.keys(m).forEach(function(Ye, vt) {
        et[Ye] = [], n && (ft[Ye] = []);
        var N = m[Ye], Z = {};
        N.forEach(function(at) {
          var je = d["".concat(ne.id, "-").concat(at.id)];
          if (je && et[Ye].push(je), Z["".concat(ne.id, "-").concat(at.id)] = {
            start: 0,
            end: b[at.id].idx,
            distance: je
          }, n) {
            var lt = d["".concat(at.id, "-").concat(ne.id)];
            lt && ft[Ye].push(lt);
          }
        }), et[Ye] = et[Ye].sort(function(at, je) {
          return at - je;
        }), n && (ft[Ye] = ft[Ye].sort(function(at, je) {
          return at - je;
        })), le = xv(Z, E, e, le);
        var pe = [];
        if (Object.keys(Z).forEach(function(at) {
          if (Me[at]) {
            pe.push(Me[at]);
            return;
          }
          var je = le[at];
          Me[at] = _v(je, F, o, s), pe.push(Me[at]);
        }), pe = pe.sort(function(at, je) {
          return je - at;
        }), $e["".concat(ne.id, "-").concat(Ye)] = pe, Ye !== ie)
          for (var se = (oe == null ? void 0 : oe.length) || 0, Ce = function(je) {
            var lt = oe[je], ct = w[p[lt.id].idx], Ot = ct.nodeLabelCountMap[Ye], mt = m[Ye].length;
            if (!Ot || Ot.count < mt)
              return oe.splice(je, 1), "continue";
            for (var pr = !1, _r = 0; _r < mt; _r++)
              if (Ot.dists[_r] > et[Ye][_r]) {
                pr = !0;
                break;
              }
            if (pr)
              return oe.splice(je, 1), "continue";
            var jr = {};
            ct.neighbors.forEach(function(hr) {
              var Vr = h["".concat(lt.id, "-").concat(hr.id)];
              jr["".concat(lt.id, "-").concat(hr.id)] = {
                start: p[lt.id].idx,
                end: p[hr.id].idx,
                distance: Vr
              };
            }), S = xv(jr, w, t, S);
            var Cr = [];
            Object.keys(jr).forEach(function(hr) {
              if (q[hr]) {
                Cr.push(q[hr]);
                return;
              }
              var Vr = S[hr];
              q[hr] = _v(Vr, F, o, s), Cr.push(q[hr]);
            }), Cr = Cr.sort(function(hr, Vr) {
              return Vr - hr;
            });
            for (var mn = !1, _r = 0; _r < mt; _r++)
              if (Cr[_r] < pe[_r]) {
                mn = !0;
                break;
              }
            if (mn)
              return oe.splice(je, 1), "continue";
          }, ke = se - 1; ke >= 0; ke--)
            Ce(ke);
      });
      var pt = [];
      oe == null || oe.forEach(function(Ye) {
        for (var vt = p[Ye.id].idx, N = bR(t.nodes, l[vt], vt, o, a), Z = N.neighbors, pe = Z.length, se = !1, Ce = pe - 1; Ce >= 0; Ce--) {
          if (Z.length + 1 < e.nodes.length) {
            se = !0;
            return;
          }
          var ke = Z[Ce], at = ke[o];
          if (!m[at] || !m[at].length) {
            Z.splice(Ce, 1);
            continue;
          }
          if (!et[at] || !et[at].length) {
            Z.splice(Ce, 1);
            continue;
          }
          var je = "".concat(Ye.id, "-").concat(ke.id), lt = h[je], ct = et[at].length - 1, Ot = et[at][ct];
          if (lt > Ot) {
            Z.splice(Ce, 1);
            continue;
          }
          if (n) {
            var mt = "".concat(ke.id, "-").concat(Ye.id), pr = h[mt];
            ct = ft[at].length - 1;
            var _r = ft[at][ct];
            if (pr > _r) {
              Z.splice(Ce, 1);
              continue;
            }
          }
          var jr = q[je] ? q[je] : fH(t, Ye, ke, p, lt, w, F, o, s, q, S), Cr = "".concat(ne.id, "-").concat(at), mn = $e[Cr][$e[Cr].length - 1];
          if (jr < mn) {
            Z.splice(Ce, 1);
            continue;
          }
          var hr = Z2(Xe, at, b, m), Vr = hr.minPatternNodeLabelDegree;
          if (hr.minPatternNodeLabelInDegree, hr.minPatternNodeLabelOutDegree, p[ke.id].degree < Vr) {
            Z.splice(Ce, 1);
            continue;
          }
        }
        se || pt.push({
          nodes: [Ye].concat(Z)
        });
      });
      var $ = (0, X2.default)(e, ne.id, !1).length, te = {};
      n ? (Object.keys($).forEach(function(Ye) {
        var vt = b[Ye].node[o];
        te[vt] ? te[vt].push($[Ye]) : te[vt] = [$[Ye]];
      }), Object.keys(te).forEach(function(Ye) {
        te[Ye].sort(function(vt, N) {
          return vt - N;
        });
      })) : te = et;
      for (var X = pt.length, De = function(vt) {
        var N = pt[vt], Z = N.nodes[0], pe = {}, se = {};
        N.nodes.forEach(function($t, Ar) {
          se[$t.id] = {
            idx: Ar,
            node: $t,
            degree: 0,
            inDegree: 0,
            outDegree: 0
          };
          var Lt = $t[o];
          pe[Lt] ? pe[Lt]++ : pe[Lt] = 1;
        });
        var Ce = [], ke = {};
        t.edges.forEach(function($t) {
          se[$t.source] && se[$t.target] && (Ce.push($t), ke[$t[s]] ? ke[$t[s]]++ : ke[$t[s]] = 1, se[$t.source].degree++, se[$t.target].degree++, se[$t.source].outDegree++, se[$t.target].inDegree++);
        });
        for (var at = Object.keys(x).length, je = !1, lt = 0; lt < at; lt++) {
          var ct = Object.keys(x)[lt];
          if (!ke[ct] || ke[ct] < x[ct].length) {
            je = !0;
            break;
          }
        }
        if (je)
          return pt.splice(vt, 1), "continue";
        var Ot = Ce.length;
        if (Ot < e.edges.length)
          return pt.splice(vt, 1), "break";
        for (var mt = !1, pr = function(Ar) {
          var Lt = Ce[Ar], Rr = Lt[s], bn = x[Rr];
          if (!bn || !bn.length)
            return ke[Rr]--, bn && ke[Rr] < bn.length ? (mt = !0, "break") : (Ce.splice(Ar, 1), se[Lt.source].degree--, se[Lt.target].degree--, se[Lt.source].outDegree--, se[Lt.target].inDegree--, "continue");
          var Ka = se[Lt.source].node[o], la = se[Lt.target].node[o], Xi = !1;
          if (bn.forEach(function(qa) {
            var Za = b[qa.source].node, Qa = b[qa.target].node;
            Za[o] === Ka && Qa[o] === la && (Xi = !0), !n && Za[o] === la && Qa[o] === Ka && (Xi = !0);
          }), !Xi)
            return ke[Rr]--, bn && ke[Rr] < bn.length ? (mt = !0, "break") : (Ce.splice(Ar, 1), se[Lt.source].degree--, se[Lt.target].degree--, se[Lt.source].outDegree--, se[Lt.target].inDegree--, "continue");
        }, lt = Ot - 1; lt >= 0; lt--) {
          var _r = pr(lt);
          if (_r === "break")
            break;
        }
        if (mt)
          return pt.splice(vt, 1), "continue";
        N.edges = Ce;
        var jr = (0, X2.default)(N, N.nodes[0].id, !1).length;
        if (Object.keys(jr).reverse().forEach(function($t) {
          if (!($t === N.nodes[0].id || mt)) {
            if (jr[$t] === 1 / 0) {
              var Ar = se[$t].node[o];
              if (pe[Ar]--, pe[Ar] < m[Ar].length) {
                mt = !0;
                return;
              }
              var Lt = N.nodes.indexOf(se[$t].node);
              N.nodes.splice(Lt, 1), se[$t] = void 0;
              return;
            }
            var Rr = p[$t].node[o];
            if (!te[Rr] || !te[Rr].length || jr[$t] > te[Rr][te[Rr].length - 1]) {
              var Ar = se[$t].node[o];
              if (pe[Ar]--, pe[Ar] < m[Ar].length) {
                mt = !0;
                return;
              }
              var Lt = N.nodes.indexOf(se[$t].node);
              N.nodes.splice(Lt, 1), se[$t] = void 0;
            }
          }
        }), mt)
          return pt.splice(vt, 1), "continue";
        for (var Cr = !0, mn = 0; Cr && !mt; ) {
          Cr = !1;
          var hr = n ? se[Z.id].degree < b[ne.id].degree || se[Z.id].inDegree < b[ne.id].inDegree || se[Z.id].outDegree < b[ne.id].outDegree : se[Z.id].degree < b[ne.id].degree;
          if (hr) {
            mt = !0;
            break;
          }
          if (pe[Z[o]] < m[Z[o]].length) {
            mt = !0;
            break;
          }
          for (var Vr = N.nodes.length, di = Vr - 1; di >= 0; di--) {
            var Zr = N.nodes[di], fa = se[Zr.id].degree, Es = se[Zr.id].inDegree, Ss = se[Zr.id].outDegree, dn = Zr[o], Vi = Z2(Xe, dn, b, m), Ha = Vi.minPatternNodeLabelDegree, Ms = Vi.minPatternNodeLabelInDegree, Cs = Vi.minPatternNodeLabelOutDegree, Ts = n ? fa < Ha || Es < Ms || Ss < Cs : fa < Ha;
            if (Ts) {
              if (pe[Zr[o]]--, pe[Zr[o]] < m[Zr[o]].length) {
                mt = !0;
                break;
              }
              N.nodes.splice(di, 1), se[Zr.id] = void 0, Cr = !0;
            }
          }
          if (mt || !Cr && mn !== 0)
            break;
          Ot = Ce.length;
          for (var vi = Ot - 1; vi >= 0; vi--) {
            var Xr = Ce[vi];
            if (!se[Xr.source] || !se[Xr.target]) {
              Ce.splice(vi, 1);
              var pi = Xr[s];
              if (ke[pi]--, se[Xr.source] && (se[Xr.source].degree--, se[Xr.source].outDegree--), se[Xr.target] && (se[Xr.target].degree--, se[Xr.target].inDegree--), x[pi] && ke[pi] < x[pi].length) {
                mt = !0;
                break;
              }
              Cr = !0;
            }
          }
          mn++;
        }
        if (mt || mt || N.nodes.length < e.nodes.length || Ce.length < e.edges.length)
          return pt.splice(vt, 1), "continue";
      }, Ke = X - 1; Ke >= 0; Ke--) {
        var Fe = De(Ke);
        if (Fe === "break")
          break;
      }
      for (var _t = pt.length, Kt = function(vt) {
        var N = pt[vt], Z = {};
        N.edges.forEach(function(Ce) {
          var ke = "".concat(Ce.source, "-").concat(Ce.target, "-").concat(Ce.label);
          Z[ke] ? Z[ke]++ : Z[ke] = 1;
        });
        for (var pe = function(ke) {
          var at = pt[ke], je = {};
          at.edges.forEach(function(ct) {
            var Ot = "".concat(ct.source, "-").concat(ct.target, "-").concat(ct.label);
            je[Ot] ? je[Ot]++ : je[Ot] = 1;
          });
          var lt = !0;
          Object.keys(je).length !== Object.keys(Z).length ? lt = !1 : Object.keys(Z).forEach(function(ct) {
            je[ct] !== Z[ct] && (lt = !1);
          }), lt && pt.splice(ke, 1);
        }, se = _t - 1; se > vt; se--)
          pe(se);
        _t = pt.length;
      }, Ke = 0; Ke <= _t - 1; Ke++)
        Kt(Ke);
      return pt;
    }
  }
}, cH = lH;
Hp.default = cH;
(function(r) {
  function t(x) {
    return t = typeof Symbol == "function" && typeof Symbol.iterator == "symbol" ? function(_) {
      return typeof _;
    } : function(_) {
      return _ && typeof Symbol == "function" && _.constructor === Symbol && _ !== Symbol.prototype ? "symbol" : typeof _;
    }, t(x);
  }
  Object.defineProperty(r, "__esModule", {
    value: !0
  }), Object.defineProperty(r, "GADDI", {
    enumerable: !0,
    get: function() {
      return p.default;
    }
  }), Object.defineProperty(r, "breadthFirstSearch", {
    enumerable: !0,
    get: function() {
      return n.default;
    }
  }), Object.defineProperty(r, "connectedComponent", {
    enumerable: !0,
    get: function() {
      return i.default;
    }
  }), Object.defineProperty(r, "depthFirstSearch", {
    enumerable: !0,
    get: function() {
      return s.default;
    }
  }), Object.defineProperty(r, "detectCycle", {
    enumerable: !0,
    get: function() {
      return o.default;
    }
  }), Object.defineProperty(r, "dijkstra", {
    enumerable: !0,
    get: function() {
      return u.default;
    }
  }), Object.defineProperty(r, "findAllPath", {
    enumerable: !0,
    get: function() {
      return f.findAllPath;
    }
  }), Object.defineProperty(r, "findShortestPath", {
    enumerable: !0,
    get: function() {
      return f.findShortestPath;
    }
  }), Object.defineProperty(r, "floydWarshall", {
    enumerable: !0,
    get: function() {
      return l.default;
    }
  }), Object.defineProperty(r, "getAdjMatrix", {
    enumerable: !0,
    get: function() {
      return e.default;
    }
  }), Object.defineProperty(r, "getDegree", {
    enumerable: !0,
    get: function() {
      return a.default;
    }
  }), Object.defineProperty(r, "getInDegree", {
    enumerable: !0,
    get: function() {
      return a.getInDegree;
    }
  }), Object.defineProperty(r, "getNeighbors", {
    enumerable: !0,
    get: function() {
      return g.getNeighbors;
    }
  }), Object.defineProperty(r, "getOutDegree", {
    enumerable: !0,
    get: function() {
      return a.getOutDegree;
    }
  }), Object.defineProperty(r, "labelPropagation", {
    enumerable: !0,
    get: function() {
      return c.default;
    }
  }), Object.defineProperty(r, "louvain", {
    enumerable: !0,
    get: function() {
      return h.default;
    }
  }), Object.defineProperty(r, "minimumSpanningTree", {
    enumerable: !0,
    get: function() {
      return d.default;
    }
  }), Object.defineProperty(r, "pageRank", {
    enumerable: !0,
    get: function() {
      return v.default;
    }
  });
  var e = m(Cu), n = m(Fp), i = m(ps), a = b(Eo), o = m(Oa), s = m(Up), u = m(il), f = $f, l = m(rh), c = m(jp), h = m($p), d = m(Wp), v = m(Yp), p = m(Hp), g = yn;
  function y(x) {
    if (typeof WeakMap != "function")
      return null;
    var _ = /* @__PURE__ */ new WeakMap(), w = /* @__PURE__ */ new WeakMap();
    return (y = function(M) {
      return M ? w : _;
    })(x);
  }
  function b(x, _) {
    if (!_ && x && x.__esModule)
      return x;
    if (x === null || t(x) !== "object" && typeof x != "function")
      return { default: x };
    var w = y(_);
    if (w && w.has(x))
      return w.get(x);
    var E = {}, M = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for (var C in x)
      if (C !== "default" && Object.prototype.hasOwnProperty.call(x, C)) {
        var S = M ? Object.getOwnPropertyDescriptor(x, C) : null;
        S && (S.get || S.set) ? Object.defineProperty(E, C, S) : E[C] = x[C];
      }
    return E.default = x, w && w.set(x, E), E;
  }
  function m(x) {
    return x && x.__esModule ? x : { default: x };
  }
})(ZN);
function Nm(r) {
  return Nm = typeof Symbol == "function" && typeof Symbol.iterator == "symbol" ? function(t) {
    return typeof t;
  } : function(t) {
    return t && typeof Symbol == "function" && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t;
  }, Nm(r);
}
Object.defineProperty(Gp, "__esModule", {
  value: !0
});
Gp.default = void 0;
var X0 = hH(ZN), Q2 = vs;
function xR(r) {
  if (typeof WeakMap != "function")
    return null;
  var t = /* @__PURE__ */ new WeakMap(), e = /* @__PURE__ */ new WeakMap();
  return (xR = function(i) {
    return i ? e : t;
  })(r);
}
function hH(r, t) {
  if (!t && r && r.__esModule)
    return r;
  if (r === null || Nm(r) !== "object" && typeof r != "function")
    return { default: r };
  var e = xR(t);
  if (e && e.has(r))
    return e.get(r);
  var n = {}, i = Object.defineProperty && Object.getOwnPropertyDescriptor;
  for (var a in r)
    if (a !== "default" && Object.prototype.hasOwnProperty.call(r, a)) {
      var o = i ? Object.getOwnPropertyDescriptor(r, a) : null;
      o && (o.get || o.set) ? Object.defineProperty(n, a, o) : n[a] = r[a];
    }
  return n.default = r, e && e.set(r, n), n;
}
var Y0 = typeof self < "u" ? self : {};
Y0.onmessage = function(r) {
  var t = r.data, e = t._algorithmType, n = t.data;
  if (!!e) {
    if (typeof X0[e] == "function") {
      var i = X0[e].apply(X0, n);
      Y0.postMessage({
        _algorithmType: Q2.MESSAGE.SUCCESS,
        data: i
      });
      return;
    }
    Y0.postMessage({
      _algorithmType: Q2.MESSAGE.FAILURE
    });
  }
};
var dH = null;
Gp.default = dH;
Object.defineProperty(Bp, "__esModule", {
  value: !0
});
Bp.default = void 0;
var vH = vs, pH = gH(Gp);
function gH(r) {
  return r && r.__esModule ? r : { default: r };
}
var yH = function(t) {
  return function() {
    for (var e = [], n = 0; n < arguments.length; n++)
      e[n] = arguments[n];
    return new Promise(function(i, a) {
      var o = new pH.default();
      o.postMessage({
        _algorithmType: t,
        data: e
      }), o.onmessage = function(s) {
        var u = s.data, f = u.data, l = u._algorithmType;
        vH.MESSAGE.SUCCESS === l ? i(f) : a(), o.terminate();
      };
    });
  };
}, mH = yH;
Bp.default = mH;
Object.defineProperty(lr, "__esModule", {
  value: !0
});
lr.pageRankAsync = lr.minimumSpanningTreeAsync = lr.louvainAsync = lr.labelPropagationAsync = lr.getOutDegreeAsync = lr.getNeighborsAsync = lr.getInDegreeAsync = lr.getDegreeAsync = lr.getAdjMatrixAsync = lr.floydWarshallAsync = lr.findShortestPathAsync = lr.findAllPathAsync = lr.dijkstraAsync = lr.detectCycleAsync = lr.detectAllUndirectedCycleAsync = lr.detectAllDirectedCycleAsync = lr.detectAllCyclesAsync = lr.connectedComponentAsync = lr.GADDIAsync = void 0;
var Mn = bH(Bp), Cn = vs;
function bH(r) {
  return r && r.__esModule ? r : { default: r };
}
var xH = function(t, e) {
  return (0, Mn.default)(Cn.ALGORITHM.getAdjMatrix).apply(void 0, [t, e]);
};
lr.getAdjMatrixAsync = xH;
var _H = function(t, e) {
  return (0, Mn.default)(Cn.ALGORITHM.connectedComponent).apply(void 0, [t, e]);
};
lr.connectedComponentAsync = _H;
var wH = function(t) {
  return (0, Mn.default)(Cn.ALGORITHM.getDegree)(t);
};
lr.getDegreeAsync = wH;
var EH = function(t, e) {
  return (0, Mn.default)(Cn.ALGORITHM.getInDegree)(t, e);
};
lr.getInDegreeAsync = EH;
var SH = function(t, e) {
  return (0, Mn.default)(Cn.ALGORITHM.getOutDegree)(t, e);
};
lr.getOutDegreeAsync = SH;
var MH = function(t) {
  return (0, Mn.default)(Cn.ALGORITHM.detectCycle)(t);
};
lr.detectCycleAsync = MH;
var CH = function(t) {
  return (0, Mn.default)(Cn.ALGORITHM.detectAllCycles)(t);
};
lr.detectAllCyclesAsync = CH;
var TH = function(t) {
  return (0, Mn.default)(Cn.ALGORITHM.detectAllDirectedCycle)(t);
};
lr.detectAllDirectedCycleAsync = TH;
var AH = function(t) {
  return (0, Mn.default)(Cn.ALGORITHM.detectAllUndirectedCycle)(t);
};
lr.detectAllUndirectedCycleAsync = AH;
var IH = function(t, e, n, i) {
  return (0, Mn.default)(Cn.ALGORITHM.dijkstra).apply(void 0, [t, e, n, i]);
};
lr.dijkstraAsync = IH;
var PH = function(t, e, n, i) {
  return (0, Mn.default)(Cn.ALGORITHM.findAllPath).apply(void 0, [t, e, n, i]);
};
lr.findAllPathAsync = PH;
var OH = function(t, e, n, i, a) {
  return (0, Mn.default)(Cn.ALGORITHM.findShortestPath).apply(void 0, [t, e, n, i, a]);
};
lr.findShortestPathAsync = OH;
var DH = function(t, e) {
  return (0, Mn.default)(Cn.ALGORITHM.floydWarshall).apply(void 0, [t, e]);
};
lr.floydWarshallAsync = DH;
var kH = function(t, e, n, i) {
  return i === void 0 && (i = 1e3), (0, Mn.default)(Cn.ALGORITHM.labelPropagation)(t, e, n, i);
};
lr.labelPropagationAsync = kH;
var LH = function(t, e, n, i) {
  return (0, Mn.default)(Cn.ALGORITHM.louvain)(t, e, n, i);
};
lr.louvainAsync = LH;
var NH = function(t, e, n) {
  return (0, Mn.default)(Cn.ALGORITHM.minimumSpanningTree).apply(void 0, [t, e, n]);
};
lr.minimumSpanningTreeAsync = NH;
var RH = function(t, e, n) {
  return (0, Mn.default)(Cn.ALGORITHM.pageRank).apply(void 0, [t, e, n]);
};
lr.pageRankAsync = RH;
var BH = function(t, e, n) {
  return (0, Mn.default)(Cn.ALGORITHM.getNeighbors).apply(void 0, [t, e, n]);
};
lr.getNeighborsAsync = BH;
var GH = function(t, e, n, i, a, o, s) {
  return n === void 0 && (n = !1), o === void 0 && (o = "cluster"), s === void 0 && (s = "cluster"), (0, Mn.default)(Cn.ALGORITHM.GADDI).apply(void 0, [t, e, n, i, a, o, s]);
};
lr.GADDIAsync = GH;
(function(r) {
  Object.defineProperty(r, "__esModule", {
    value: !0
  }), Object.defineProperty(r, "GADDIAsync", {
    enumerable: !0,
    get: function() {
      return t.GADDIAsync;
    }
  }), Object.defineProperty(r, "connectedComponentAsync", {
    enumerable: !0,
    get: function() {
      return t.connectedComponentAsync;
    }
  }), r.default = void 0, Object.defineProperty(r, "detectAllCyclesAsync", {
    enumerable: !0,
    get: function() {
      return t.detectAllCyclesAsync;
    }
  }), Object.defineProperty(r, "detectAllDirectedCycleAsync", {
    enumerable: !0,
    get: function() {
      return t.detectAllDirectedCycleAsync;
    }
  }), Object.defineProperty(r, "detectAllUndirectedCycleAsync", {
    enumerable: !0,
    get: function() {
      return t.detectAllUndirectedCycleAsync;
    }
  }), Object.defineProperty(r, "detectCycleAsync", {
    enumerable: !0,
    get: function() {
      return t.detectCycleAsync;
    }
  }), r.detectDirectedCycleAsync = void 0, Object.defineProperty(r, "dijkstraAsync", {
    enumerable: !0,
    get: function() {
      return t.dijkstraAsync;
    }
  }), Object.defineProperty(r, "findAllPathAsync", {
    enumerable: !0,
    get: function() {
      return t.findAllPathAsync;
    }
  }), Object.defineProperty(r, "findShortestPathAsync", {
    enumerable: !0,
    get: function() {
      return t.findShortestPathAsync;
    }
  }), Object.defineProperty(r, "floydWarshallAsync", {
    enumerable: !0,
    get: function() {
      return t.floydWarshallAsync;
    }
  }), Object.defineProperty(r, "getAdjMatrixAsync", {
    enumerable: !0,
    get: function() {
      return t.getAdjMatrixAsync;
    }
  }), Object.defineProperty(r, "getDegreeAsync", {
    enumerable: !0,
    get: function() {
      return t.getDegreeAsync;
    }
  }), Object.defineProperty(r, "getInDegreeAsync", {
    enumerable: !0,
    get: function() {
      return t.getInDegreeAsync;
    }
  }), Object.defineProperty(r, "getNeighborsAsync", {
    enumerable: !0,
    get: function() {
      return t.getNeighborsAsync;
    }
  }), Object.defineProperty(r, "getOutDegreeAsync", {
    enumerable: !0,
    get: function() {
      return t.getOutDegreeAsync;
    }
  }), Object.defineProperty(r, "labelPropagationAsync", {
    enumerable: !0,
    get: function() {
      return t.labelPropagationAsync;
    }
  }), Object.defineProperty(r, "louvainAsync", {
    enumerable: !0,
    get: function() {
      return t.louvainAsync;
    }
  }), Object.defineProperty(r, "minimumSpanningTreeAsync", {
    enumerable: !0,
    get: function() {
      return t.minimumSpanningTreeAsync;
    }
  }), Object.defineProperty(r, "pageRankAsync", {
    enumerable: !0,
    get: function() {
      return t.pageRankAsync;
    }
  });
  var t = lr, e = t.detectCycleAsync;
  r.detectDirectedCycleAsync = e;
  var n = {
    getAdjMatrixAsync: t.getAdjMatrixAsync,
    connectedComponentAsync: t.connectedComponentAsync,
    getDegreeAsync: t.getDegreeAsync,
    getInDegreeAsync: t.getInDegreeAsync,
    getOutDegreeAsync: t.getOutDegreeAsync,
    detectCycleAsync: t.detectCycleAsync,
    detectDirectedCycleAsync: e,
    detectAllCyclesAsync: t.detectAllCyclesAsync,
    detectAllDirectedCycleAsync: t.detectAllDirectedCycleAsync,
    detectAllUndirectedCycleAsync: t.detectAllUndirectedCycleAsync,
    dijkstraAsync: t.dijkstraAsync,
    findAllPathAsync: t.findAllPathAsync,
    findShortestPathAsync: t.findShortestPathAsync,
    floydWarshallAsync: t.floydWarshallAsync,
    labelPropagationAsync: t.labelPropagationAsync,
    louvainAsync: t.louvainAsync,
    minimumSpanningTreeAsync: t.minimumSpanningTreeAsync,
    pageRankAsync: t.pageRankAsync,
    getNeighborsAsync: t.getNeighborsAsync,
    GADDIAsync: t.GADDIAsync
  };
  r.default = n;
})(Ib);
const FH = /* @__PURE__ */ AN(Ib), zH = /* @__PURE__ */ c6({
  __proto__: null,
  default: FH
}, [Ib]);
function UH() {
  return window ? window.devicePixelRatio : 1;
}
function _R(r, t, e, n) {
  var i = r - e, a = t - n;
  return Math.sqrt(i * i + a * a);
}
function ou(r, t, e, n, i, a) {
  return i >= r && i <= r + e && a >= t && a <= t + n;
}
function Fc(r, t) {
  return !(t.minX > r.maxX || t.maxX < r.minX || t.minY > r.maxY || t.maxY < r.minY);
}
function jH(r, t) {
  return !r || !t ? r || t : {
    minX: Math.min(r.minX, t.minX),
    minY: Math.min(r.minY, t.minY),
    maxX: Math.max(r.maxX, t.maxX),
    maxY: Math.max(r.maxY, t.maxY)
  };
}
function J2(r, t) {
  return r[0] === t[0] && r[1] === t[1];
}
var $H = /^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i, WH = /^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i, VH = /^p\s*\(\s*([axyn])\s*\)\s*(.*)/i, wR = /[\d.]+:(#[^\s]+|[^\)]+\))/gi;
function ER(r, t) {
  var e = r.match(wR);
  Se(e, function(n) {
    var i = n.split(":");
    t.addColorStop(i[0], i[1]);
  });
}
function XH(r, t, e) {
  var n = $H.exec(e), i = parseFloat(n[1]) % 360 * (Math.PI / 180), a = n[2], o = t.getBBox(), s, u;
  i >= 0 && i < 1 / 2 * Math.PI ? (s = {
    x: o.minX,
    y: o.minY
  }, u = {
    x: o.maxX,
    y: o.maxY
  }) : 1 / 2 * Math.PI <= i && i < Math.PI ? (s = {
    x: o.maxX,
    y: o.minY
  }, u = {
    x: o.minX,
    y: o.maxY
  }) : Math.PI <= i && i < 3 / 2 * Math.PI ? (s = {
    x: o.maxX,
    y: o.maxY
  }, u = {
    x: o.minX,
    y: o.minY
  }) : (s = {
    x: o.minX,
    y: o.maxY
  }, u = {
    x: o.maxX,
    y: o.minY
  });
  var f = Math.tan(i), l = f * f, c = (u.x - s.x + f * (u.y - s.y)) / (l + 1) + s.x, h = f * (u.x - s.x + f * (u.y - s.y)) / (l + 1) + s.y, d = r.createLinearGradient(s.x, s.y, c, h);
  return ER(a, d), d;
}
function YH(r, t, e) {
  var n = WH.exec(e), i = parseFloat(n[1]), a = parseFloat(n[2]), o = parseFloat(n[3]), s = n[4];
  if (o === 0) {
    var u = s.match(wR);
    return u[u.length - 1].split(":")[1];
  }
  var f = t.getBBox(), l = f.maxX - f.minX, c = f.maxY - f.minY, h = Math.sqrt(l * l + c * c) / 2, d = r.createRadialGradient(f.minX + l * i, f.minY + c * a, 0, f.minX + l / 2, f.minY + c / 2, o * h);
  return ER(s, d), d;
}
function HH(r, t, e) {
  if (t.get("patternSource") && t.get("patternSource") === e)
    return t.get("pattern");
  var n, i, a = VH.exec(e), o = a[1], s = a[2];
  function u() {
    n = r.createPattern(i, o), t.set("pattern", n), t.set("patternSource", e);
  }
  switch (o) {
    case "a":
      o = "repeat";
      break;
    case "x":
      o = "repeat-x";
      break;
    case "y":
      o = "repeat-y";
      break;
    case "n":
      o = "no-repeat";
      break;
    default:
      o = "no-repeat";
  }
  return i = new Image(), s.match(/^data:/i) || (i.crossOrigin = "Anonymous"), i.src = s, i.complete ? u() : (i.onload = u, i.src = i.src), n;
}
function KH(r, t, e) {
  var n = t.getBBox();
  if (isNaN(n.x) || isNaN(n.y) || isNaN(n.width) || isNaN(n.height))
    return e;
  if (Qe(e)) {
    if (e[1] === "(" || e[2] === "(") {
      if (e[0] === "l")
        return XH(r, t, e);
      if (e[0] === "r")
        return YH(r, t, e);
      if (e[0] === "p")
        return HH(r, t, e);
    }
    return e;
  }
  if (e instanceof CanvasPattern)
    return e;
}
function qH(r) {
  var t = 0, e = 0, n = 0, i = 0;
  return Dt(r) ? r.length === 1 ? t = e = n = i = r[0] : r.length === 2 ? (t = n = r[0], e = i = r[1]) : r.length === 3 ? (t = r[0], e = i = r[1], n = r[2]) : (t = r[0], e = r[1], n = r[2], i = r[3]) : t = e = n = i = r, [t, e, n, i];
}
function Ed(r) {
  return Math.sqrt(r[0] * r[0] + r[1] * r[1]);
}
function Rm(r, t) {
  return Ed(r) * Ed(t) ? (r[0] * t[0] + r[1] * t[1]) / (Ed(r) * Ed(t)) : 1;
}
function eS(r, t) {
  return (r[0] * t[1] < r[1] * t[0] ? -1 : 1) * Math.acos(Rm(r, t));
}
function tS(r, t) {
  var e = t[1], n = t[2], i = Ip(Pp(t[3]), Math.PI * 2), a = t[4], o = t[5], s = r[0], u = r[1], f = t[6], l = t[7], c = Math.cos(i) * (s - f) / 2 + Math.sin(i) * (u - l) / 2, h = -1 * Math.sin(i) * (s - f) / 2 + Math.cos(i) * (u - l) / 2, d = c * c / (e * e) + h * h / (n * n);
  d > 1 && (e *= Math.sqrt(d), n *= Math.sqrt(d));
  var v = e * e * (h * h) + n * n * (c * c), p = v ? Math.sqrt((e * e * (n * n) - v) / v) : 1;
  a === o && (p *= -1), isNaN(p) && (p = 0);
  var g = n ? p * e * h / n : 0, y = e ? p * -n * c / e : 0, b = (s + f) / 2 + Math.cos(i) * g - Math.sin(i) * y, m = (u + l) / 2 + Math.sin(i) * g + Math.cos(i) * y, x = [(c - g) / e, (h - y) / n], _ = [(-1 * c - g) / e, (-1 * h - y) / n], w = eS([1, 0], x), E = eS(x, _);
  return Rm(x, _) <= -1 && (E = Math.PI), Rm(x, _) >= 1 && (E = 0), o === 0 && E > 0 && (E = E - 2 * Math.PI), o === 1 && E < 0 && (E = E + 2 * Math.PI), {
    cx: b,
    cy: m,
    rx: J2(r, [f, l]) ? 0 : e,
    ry: J2(r, [f, l]) ? 0 : n,
    startAngle: w,
    endAngle: w + E,
    xRotation: i,
    arcFlag: a,
    sweepFlag: o
  };
}
var Jv = Math.sin, ep = Math.cos, kb = Math.atan2, Sd = Math.PI;
function SR(r, t, e, n, i, a, o) {
  var s = t.stroke, u = t.lineWidth, f = e - i, l = n - a, c = kb(l, f), h = new Bb({
    type: "path",
    canvas: r.get("canvas"),
    isArrowShape: !0,
    attrs: {
      path: "M" + 10 * ep(Sd / 6) + "," + 10 * Jv(Sd / 6) + " L0,0 L" + 10 * ep(Sd / 6) + ",-" + 10 * Jv(Sd / 6),
      stroke: s,
      lineWidth: u
    }
  });
  h.translate(i, a), h.rotateAtPoint(i, a, c), r.set(o ? "startArrowShape" : "endArrowShape", h);
}
function MR(r, t, e, n, i, a, o) {
  var s = t.startArrow, u = t.endArrow, f = t.stroke, l = t.lineWidth, c = o ? s : u, h = c.d, d = c.fill, v = c.stroke, p = c.lineWidth, g = kn(c, ["d", "fill", "stroke", "lineWidth"]), y = e - i, b = n - a, m = kb(b, y);
  h && (i = i - ep(m) * h, a = a - Jv(m) * h);
  var x = new Bb({
    type: "path",
    canvas: r.get("canvas"),
    isArrowShape: !0,
    attrs: U(U({}, g), {
      stroke: v || f,
      lineWidth: p || l,
      fill: d
    })
  });
  x.translate(i, a), x.rotateAtPoint(i, a, m), r.set(o ? "startArrowShape" : "endArrowShape", x);
}
function uu(r, t, e, n, i) {
  var a = kb(n - t, e - r);
  return {
    dx: ep(a) * i,
    dy: Jv(a) * i
  };
}
function Lb(r, t, e, n, i, a) {
  typeof t.startArrow == "object" ? MR(r, t, e, n, i, a, !0) : t.startArrow ? SR(r, t, e, n, i, a, !0) : r.set("startArrowShape", null);
}
function Nb(r, t, e, n, i, a) {
  typeof t.endArrow == "object" ? MR(r, t, e, n, i, a, !1) : t.endArrow ? SR(r, t, e, n, i, a, !1) : r.set("startArrowShape", null);
}
var rS = {
  fill: "fillStyle",
  stroke: "strokeStyle",
  opacity: "globalAlpha"
};
function Vf(r, t) {
  var e = t.attr();
  for (var n in e) {
    var i = e[n], a = rS[n] ? rS[n] : n;
    a === "matrix" && i ? r.transform(i[0], i[1], i[3], i[4], i[6], i[7]) : a === "lineDash" && r.setLineDash ? Dt(i) && r.setLineDash(i) : (a === "strokeStyle" || a === "fillStyle" ? i = KH(r, t, i) : a === "globalAlpha" && (i = i * r.globalAlpha), r[a] = i);
  }
}
function Bm(r, t, e) {
  for (var n = 0; n < t.length; n++) {
    var i = t[n];
    i.cfg.visible ? i.draw(r, e) : i.skipDraw();
  }
}
function ZH(r, t, e) {
  var n = r.get("refreshElements");
  Se(n, function(i) {
    if (i !== r)
      for (var a = i.cfg.parent; a && a !== r && !a.cfg.refresh; )
        a.cfg.refresh = !0, a = a.cfg.parent;
  }), n[0] === r ? Rb(t) : Gm(t, e);
}
function Gm(r, t) {
  for (var e = 0; e < r.length; e++) {
    var n = r[e];
    if (n.cfg.visible)
      if (n.cfg.hasChanged)
        n.cfg.refresh = !0, n.isGroup() && Rb(n.cfg.children);
      else if (n.cfg.refresh)
        n.isGroup() && Gm(n.cfg.children, t);
      else {
        var i = QH(n, t);
        n.cfg.refresh = i, i && n.isGroup() && Gm(n.cfg.children, t);
      }
  }
}
function CR(r) {
  for (var t = 0; t < r.length; t++) {
    var e = r[t];
    e.cfg.hasChanged = !1, e.isGroup() && !e.destroyed && CR(e.cfg.children);
  }
}
function Rb(r, t) {
  for (var e = 0; e < r.length; e++) {
    var n = r[e];
    n.cfg.refresh = !0, n.isGroup() && Rb(n.get("children"));
  }
}
function QH(r, t) {
  var e = r.cfg.cacheCanvasBBox, n = r.cfg.isInView && e && Fc(e, t);
  return n;
}
function TR(r, t, e, n) {
  var i = e.path, a = e.startArrow, o = e.endArrow;
  if (!!i) {
    var s = [0, 0], u = [0, 0], f = {
      dx: 0,
      dy: 0
    };
    t.beginPath();
    for (var l = 0; l < i.length; l++) {
      var c = i[l], h = c[0];
      if (l === 0 && a && a.d) {
        var d = r.getStartTangent();
        f = uu(d[0][0], d[0][1], d[1][0], d[1][1], a.d);
      } else if (l === i.length - 2 && i[l + 1][0] === "Z" && o && o.d) {
        var v = i[l + 1];
        if (v[0] === "Z") {
          var d = r.getEndTangent();
          f = uu(d[0][0], d[0][1], d[1][0], d[1][1], o.d);
        }
      } else if (l === i.length - 1 && o && o.d && i[0] !== "Z") {
        var d = r.getEndTangent();
        f = uu(d[0][0], d[0][1], d[1][0], d[1][1], o.d);
      }
      var p = f.dx, g = f.dy;
      switch (h) {
        case "M":
          t.moveTo(c[1] - p, c[2] - g), u = [c[1], c[2]];
          break;
        case "L":
          t.lineTo(c[1] - p, c[2] - g);
          break;
        case "Q":
          t.quadraticCurveTo(c[1], c[2], c[3] - p, c[4] - g);
          break;
        case "C":
          t.bezierCurveTo(c[1], c[2], c[3], c[4], c[5] - p, c[6] - g);
          break;
        case "A": {
          var y = void 0;
          n ? (y = n[l], y || (y = tS(s, c), n[l] = y)) : y = tS(s, c);
          var b = y.cx, m = y.cy, x = y.rx, _ = y.ry, w = y.startAngle, E = y.endAngle, M = y.xRotation, C = y.sweepFlag;
          if (t.ellipse)
            t.ellipse(b, m, x, _, M, w, E, 1 - C);
          else {
            var S = x > _ ? x : _, A = x > _ ? 1 : x / _, T = x > _ ? _ / x : 1;
            t.translate(b, m), t.rotate(M), t.scale(A, T), t.arc(0, 0, S, w, E, 1 - C), t.scale(1 / A, 1 / T), t.rotate(-M), t.translate(-b, -m);
          }
          break;
        }
        case "Z":
          t.closePath();
          break;
      }
      if (h === "Z")
        s = u;
      else {
        var P = c.length;
        s = [c[P - 2], c[P - 1]];
      }
    }
  }
}
function AR(r, t) {
  var e = r.get("canvas");
  e && (t === "remove" && (r._cacheCanvasBBox = r.get("cacheCanvasBBox")), r.get("hasChanged") || (r.set("hasChanged", !0), r.cfg.parent && r.cfg.parent.get("hasChanged") || (e.refreshElement(r, t, e), e.get("autoDraw") && e.draw())));
}
function JH(r) {
  var t;
  if (r.destroyed)
    t = r._cacheCanvasBBox;
  else {
    var e = r.get("cacheCanvasBBox"), n = e && !!(e.width && e.height), i = r.getCanvasBBox(), a = i && !!(i.width && i.height);
    n && a ? t = jH(e, i) : n ? t = e : a && (t = i);
  }
  return t;
}
function eK(r) {
  if (!r.length)
    return null;
  var t = [], e = [], n = [], i = [];
  return Se(r, function(a) {
    var o = JH(a);
    o && (t.push(o.minX), e.push(o.minY), n.push(o.maxX), i.push(o.maxY));
  }), {
    minX: Fi(t),
    minY: Fi(e),
    maxX: Gi(n),
    maxY: Gi(i)
  };
}
function tK(r, t) {
  return !r || !t || !Fc(r, t) ? null : {
    minX: Math.max(r.minX, t.minX),
    minY: Math.max(r.minY, t.minY),
    maxX: Math.min(r.maxX, t.maxX),
    maxY: Math.min(r.maxY, t.maxY)
  };
}
var IR = function(r) {
  Ht(t, r);
  function t() {
    return r !== null && r.apply(this, arguments) || this;
  }
  return t.prototype.onCanvasChange = function(e) {
    AR(this, e);
  }, t.prototype.getShapeBase = function() {
    return F1;
  }, t.prototype.getGroupBase = function() {
    return t;
  }, t.prototype._applyClip = function(e, n) {
    n && (e.save(), Vf(e, n), n.createPath(e), e.restore(), e.clip(), n._afterDraw());
  }, t.prototype.cacheCanvasBBox = function() {
    var e = this.cfg.children, n = [], i = [];
    Se(e, function(h) {
      var d = h.cfg.cacheCanvasBBox;
      d && h.cfg.isInView && (n.push(d.minX, d.maxX), i.push(d.minY, d.maxY));
    });
    var a = null;
    if (n.length) {
      var o = Fi(n), s = Gi(n), u = Fi(i), f = Gi(i);
      a = {
        minX: o,
        minY: u,
        x: o,
        y: u,
        maxX: s,
        maxY: f,
        width: s - o,
        height: f - u
      };
      var l = this.cfg.canvas;
      if (l) {
        var c = l.getViewRange();
        this.set("isInView", Fc(a, c));
      }
    } else
      this.set("isInView", !1);
    this.set("cacheCanvasBBox", a);
  }, t.prototype.draw = function(e, n) {
    var i = this.cfg.children, a = n ? this.cfg.refresh : !0;
    i.length && a && (e.save(), Vf(e, this), this._applyClip(e, this.getClip()), Bm(e, i, n), e.restore(), this.cacheCanvasBBox()), this.cfg.refresh = null, this.set("hasChanged", !1);
  }, t.prototype.skipDraw = function() {
    this.set("cacheCanvasBBox", null), this.set("hasChanged", !1);
  }, t;
}(fN), rK = function(r) {
  Ht(t, r);
  function t() {
    return r !== null && r.apply(this, arguments) || this;
  }
  return t.prototype.getDefaultAttrs = function() {
    var e = r.prototype.getDefaultAttrs.call(this);
    return U(U({}, e), { lineWidth: 1, lineAppendWidth: 0, strokeOpacity: 1, fillOpacity: 1 });
  }, t.prototype.getShapeBase = function() {
    return F1;
  }, t.prototype.getGroupBase = function() {
    return IR;
  }, t.prototype.onCanvasChange = function(e) {
    AR(this, e);
  }, t.prototype.calculateBBox = function() {
    var e = this.get("type"), n = this.getHitLineWidth(), i = hN(e), a = i(this), o = n / 2, s = a.x - o, u = a.y - o, f = a.x + a.width + o, l = a.y + a.height + o;
    return {
      x: s,
      minX: s,
      y: u,
      minY: u,
      width: a.width + n,
      height: a.height + n,
      maxX: f,
      maxY: l
    };
  }, t.prototype.isFill = function() {
    return !!this.attrs.fill || this.isClipShape();
  }, t.prototype.isStroke = function() {
    return !!this.attrs.stroke;
  }, t.prototype._applyClip = function(e, n) {
    n && (e.save(), Vf(e, n), n.createPath(e), e.restore(), e.clip(), n._afterDraw());
  }, t.prototype.draw = function(e, n) {
    var i = this.cfg.clipShape;
    if (n) {
      if (this.cfg.refresh === !1) {
        this.set("hasChanged", !1);
        return;
      }
      var a = this.getCanvasBBox();
      if (!Fc(n, a)) {
        this.set("hasChanged", !1), this.cfg.isInView && this._afterDraw();
        return;
      }
    }
    e.save(), Vf(e, this), this._applyClip(e, i), this.drawPath(e), e.restore(), this._afterDraw();
  }, t.prototype.getCanvasViewBox = function() {
    var e = this.cfg.canvas;
    return e ? e.getViewRange() : null;
  }, t.prototype.cacheCanvasBBox = function() {
    var e = this.getCanvasViewBox();
    if (e) {
      var n = this.getCanvasBBox(), i = Fc(n, e);
      this.set("isInView", i), i ? this.set("cacheCanvasBBox", n) : this.set("cacheCanvasBBox", null);
    }
  }, t.prototype._afterDraw = function() {
    this.cacheCanvasBBox(), this.set("hasChanged", !1), this.set("refresh", null);
  }, t.prototype.skipDraw = function() {
    this.set("cacheCanvasBBox", null), this.set("isInView", null), this.set("hasChanged", !1);
  }, t.prototype.drawPath = function(e) {
    this.createPath(e), this.strokeAndFill(e), this.afterDrawPath(e);
  }, t.prototype.fill = function(e) {
    e.fill();
  }, t.prototype.stroke = function(e) {
    e.stroke();
  }, t.prototype.strokeAndFill = function(e) {
    var n = this.attrs, i = n.lineWidth, a = n.opacity, o = n.strokeOpacity, s = n.fillOpacity;
    this.isFill() && (!Tt(s) && s !== 1 ? (e.globalAlpha = s, this.fill(e), e.globalAlpha = a) : this.fill(e)), this.isStroke() && i > 0 && (!Tt(o) && o !== 1 && (e.globalAlpha = o), this.stroke(e)), this.afterDrawPath(e);
  }, t.prototype.createPath = function(e) {
  }, t.prototype.afterDrawPath = function(e) {
  }, t.prototype.isInShape = function(e, n) {
    var i = this.isStroke(), a = this.isFill(), o = this.getHitLineWidth();
    return this.isInStrokeOrPath(e, n, i, a, o);
  }, t.prototype.isInStrokeOrPath = function(e, n, i, a, o) {
    return !1;
  }, t.prototype.getHitLineWidth = function() {
    if (!this.isStroke())
      return 0;
    var e = this.attrs;
    return e.lineWidth + e.lineAppendWidth;
  }, t;
}(lN);
const oa = rK;
var nK = function(r) {
  Ht(t, r);
  function t() {
    return r !== null && r.apply(this, arguments) || this;
  }
  return t.prototype.getDefaultAttrs = function() {
    var e = r.prototype.getDefaultAttrs.call(this);
    return U(U({}, e), { x: 0, y: 0, r: 0 });
  }, t.prototype.isInStrokeOrPath = function(e, n, i, a, o) {
    var s = this.attr(), u = s.x, f = s.y, l = s.r, c = o / 2, h = _R(u, f, e, n);
    return a && i ? h <= l + c : a ? h <= l : i ? h >= l - c && h <= l + c : !1;
  }, t.prototype.createPath = function(e) {
    var n = this.attr(), i = n.x, a = n.y, o = n.r;
    e.beginPath(), e.arc(i, a, o, 0, Math.PI * 2, !1), e.closePath();
  }, t;
}(oa);
const iK = nK;
function Md(r, t, e, n) {
  return r / (e * e) + t / (n * n);
}
var aK = function(r) {
  Ht(t, r);
  function t() {
    return r !== null && r.apply(this, arguments) || this;
  }
  return t.prototype.getDefaultAttrs = function() {
    var e = r.prototype.getDefaultAttrs.call(this);
    return U(U({}, e), { x: 0, y: 0, rx: 0, ry: 0 });
  }, t.prototype.isInStrokeOrPath = function(e, n, i, a, o) {
    var s = this.attr(), u = o / 2, f = s.x, l = s.y, c = s.rx, h = s.ry, d = (e - f) * (e - f), v = (n - l) * (n - l);
    return a && i ? Md(d, v, c + u, h + u) <= 1 : a ? Md(d, v, c, h) <= 1 : i ? Md(d, v, c - u, h - u) >= 1 && Md(d, v, c + u, h + u) <= 1 : !1;
  }, t.prototype.createPath = function(e) {
    var n = this.attr(), i = n.x, a = n.y, o = n.rx, s = n.ry;
    if (e.beginPath(), e.ellipse)
      e.ellipse(i, a, o, s, 0, 0, Math.PI * 2, !1);
    else {
      var u = o > s ? o : s, f = o > s ? 1 : o / s, l = o > s ? s / o : 1;
      e.save(), e.translate(i, a), e.scale(f, l), e.arc(0, 0, u, 0, Math.PI * 2), e.restore(), e.closePath();
    }
  }, t;
}(oa);
const oK = aK;
function nS(r) {
  return r instanceof HTMLElement && Qe(r.nodeName) && r.nodeName.toUpperCase() === "CANVAS";
}
var sK = function(r) {
  Ht(t, r);
  function t() {
    return r !== null && r.apply(this, arguments) || this;
  }
  return t.prototype.getDefaultAttrs = function() {
    var e = r.prototype.getDefaultAttrs.call(this);
    return U(U({}, e), { x: 0, y: 0, width: 0, height: 0 });
  }, t.prototype.initAttrs = function(e) {
    this._setImage(e.img);
  }, t.prototype.isStroke = function() {
    return !1;
  }, t.prototype.isOnlyHitBox = function() {
    return !0;
  }, t.prototype._afterLoading = function() {
    if (this.get("toDraw") === !0) {
      var e = this.get("canvas");
      e ? e.draw() : this.createPath(this.get("context"));
    }
  }, t.prototype._setImage = function(e) {
    var n = this, i = this.attrs;
    if (Qe(e)) {
      var a = new Image();
      a.onload = function() {
        if (n.destroyed)
          return !1;
        n.attr("img", a), n.set("loading", !1), n._afterLoading();
        var o = n.get("callback");
        o && o.call(n);
      }, a.crossOrigin = "Anonymous", a.src = e, this.set("loading", !0);
    } else
      e instanceof Image ? (i.width || (i.width = e.width), i.height || (i.height = e.height)) : nS(e) && (i.width || (i.width = Number(e.getAttribute("width"))), i.height || (i.height, Number(e.getAttribute("height"))));
  }, t.prototype.onAttrChange = function(e, n, i) {
    r.prototype.onAttrChange.call(this, e, n, i), e === "img" && this._setImage(n);
  }, t.prototype.createPath = function(e) {
    if (this.get("loading")) {
      this.set("toDraw", !0), this.set("context", e);
      return;
    }
    var n = this.attr(), i = n.x, a = n.y, o = n.width, s = n.height, u = n.sx, f = n.sy, l = n.swidth, c = n.sheight, h = n.img;
    (h instanceof Image || nS(h)) && (!Tt(u) && !Tt(f) && !Tt(l) && !Tt(c) ? e.drawImage(h, u, f, l, c, i, a, o, s) : e.drawImage(h, i, a, o, s));
  }, t;
}(oa);
const uK = sK;
function is(r, t, e, n, i, a, o) {
  var s = Math.min(r, e), u = Math.max(r, e), f = Math.min(t, n), l = Math.max(t, n), c = i / 2;
  return a >= s - c && a <= u + c && o >= f - c && o <= l + c ? Bn.pointToLine(r, t, e, n, a, o) <= i / 2 : !1;
}
var fK = function(r) {
  Ht(t, r);
  function t() {
    return r !== null && r.apply(this, arguments) || this;
  }
  return t.prototype.getDefaultAttrs = function() {
    var e = r.prototype.getDefaultAttrs.call(this);
    return U(U({}, e), { x1: 0, y1: 0, x2: 0, y2: 0, startArrow: !1, endArrow: !1 });
  }, t.prototype.initAttrs = function(e) {
    this.setArrow();
  }, t.prototype.onAttrChange = function(e, n, i) {
    r.prototype.onAttrChange.call(this, e, n, i), this.setArrow();
  }, t.prototype.setArrow = function() {
    var e = this.attr(), n = e.x1, i = e.y1, a = e.x2, o = e.y2, s = e.startArrow, u = e.endArrow;
    s && Lb(this, e, a, o, n, i), u && Nb(this, e, n, i, a, o);
  }, t.prototype.isInStrokeOrPath = function(e, n, i, a, o) {
    if (!i || !o)
      return !1;
    var s = this.attr(), u = s.x1, f = s.y1, l = s.x2, c = s.y2;
    return is(u, f, l, c, o, e, n);
  }, t.prototype.createPath = function(e) {
    var n = this.attr(), i = n.x1, a = n.y1, o = n.x2, s = n.y2, u = n.startArrow, f = n.endArrow, l = {
      dx: 0,
      dy: 0
    }, c = {
      dx: 0,
      dy: 0
    };
    u && u.d && (l = uu(i, a, o, s, n.startArrow.d)), f && f.d && (c = uu(i, a, o, s, n.endArrow.d)), e.beginPath(), e.moveTo(i + l.dx, a + l.dy), e.lineTo(o - c.dx, s - c.dy);
  }, t.prototype.afterDrawPath = function(e) {
    var n = this.get("startArrowShape"), i = this.get("endArrowShape");
    n && n.draw(e), i && i.draw(e);
  }, t.prototype.getTotalLength = function() {
    var e = this.attr(), n = e.x1, i = e.y1, a = e.x2, o = e.y2;
    return Bn.length(n, i, a, o);
  }, t.prototype.getPoint = function(e) {
    var n = this.attr(), i = n.x1, a = n.y1, o = n.x2, s = n.y2;
    return Bn.pointAt(i, a, o, s, e);
  }, t;
}(oa);
const lK = fK;
var cK = {
  circle: function(r, t, e) {
    return [
      ["M", r - e, t],
      ["A", e, e, 0, 1, 0, r + e, t],
      ["A", e, e, 0, 1, 0, r - e, t]
    ];
  },
  square: function(r, t, e) {
    return [["M", r - e, t - e], ["L", r + e, t - e], ["L", r + e, t + e], ["L", r - e, t + e], ["Z"]];
  },
  diamond: function(r, t, e) {
    return [["M", r - e, t], ["L", r, t - e], ["L", r + e, t], ["L", r, t + e], ["Z"]];
  },
  triangle: function(r, t, e) {
    var n = e * Math.sin(0.3333333333333333 * Math.PI);
    return [["M", r - e, t + n], ["L", r, t - n], ["L", r + e, t + n], ["Z"]];
  },
  "triangle-down": function(r, t, e) {
    var n = e * Math.sin(0.3333333333333333 * Math.PI);
    return [["M", r - e, t - n], ["L", r + e, t - n], ["L", r, t + n], ["Z"]];
  }
}, hK = function(r) {
  Ht(t, r);
  function t() {
    return r !== null && r.apply(this, arguments) || this;
  }
  return t.prototype.initAttrs = function(e) {
    this._resetParamsCache();
  }, t.prototype._resetParamsCache = function() {
    this.set("paramsCache", {});
  }, t.prototype.onAttrChange = function(e, n, i) {
    r.prototype.onAttrChange.call(this, e, n, i), ["symbol", "x", "y", "r", "radius"].indexOf(e) !== -1 && this._resetParamsCache();
  }, t.prototype.isOnlyHitBox = function() {
    return !0;
  }, t.prototype._getR = function(e) {
    return Tt(e.r) ? e.radius : e.r;
  }, t.prototype._getPath = function() {
    var e = this.attr(), n = e.x, i = e.y, a = e.symbol || "circle", o = this._getR(e), s, u;
    if (Ur(a))
      s = a, u = s(n, i, o), u = MN(u);
    else {
      if (s = t.Symbols[a], !s)
        return console.warn(a + " marker is not supported."), null;
      u = s(n, i, o);
    }
    return u;
  }, t.prototype.createPath = function(e) {
    var n = this._getPath(), i = this.get("paramsCache");
    TR(this, e, { path: n }, i);
  }, t.Symbols = cK, t;
}(oa);
const dK = hK;
function PR(r, t, e) {
  var n = _N();
  return r.createPath(n), n.isPointInPath(t, e);
}
var vK = 1e-6;
function H0(r) {
  return Math.abs(r) < vK ? 0 : r < 0 ? -1 : 1;
}
function pK(r, t, e) {
  return (e[0] - r[0]) * (t[1] - r[1]) === (t[0] - r[0]) * (e[1] - r[1]) && Math.min(r[0], t[0]) <= e[0] && e[0] <= Math.max(r[0], t[0]) && Math.min(r[1], t[1]) <= e[1] && e[1] <= Math.max(r[1], t[1]);
}
function OR(r, t, e) {
  var n = !1, i = r.length;
  if (i <= 2)
    return !1;
  for (var a = 0; a < i; a++) {
    var o = r[a], s = r[(a + 1) % i];
    if (pK(o, s, [t, e]))
      return !0;
    H0(o[1] - e) > 0 != H0(s[1] - e) > 0 && H0(t - (e - o[1]) * (o[0] - s[0]) / (o[1] - s[1]) - o[0]) < 0 && (n = !n);
  }
  return n;
}
function ic(r, t, e, n, i, a, o, s) {
  var u = (Math.atan2(s - t, o - r) + Math.PI * 2) % (Math.PI * 2);
  if (u < n || u > i)
    return !1;
  var f = {
    x: r + e * Math.cos(u),
    y: t + e * Math.sin(u)
  };
  return _R(f.x, f.y, o, s) <= a / 2;
}
var gK = $i;
function yK(r) {
  for (var t = !1, e = r.length, n = 0; n < e; n++) {
    var i = r[n], a = i[0];
    if (a === "C" || a === "A" || a === "Q") {
      t = !0;
      break;
    }
  }
  return t;
}
function mK(r, t, e, n, i) {
  for (var a = !1, o = t / 2, s = 0; s < r.length; s++) {
    var u = r[s], f = u.currentPoint, l = u.params, c = u.prePoint, h = u.box;
    if (!(h && !ou(h.x - o, h.y - o, h.width + t, h.height + t, e, n))) {
      switch (u.command) {
        case "L":
        case "Z":
          a = is(c[0], c[1], f[0], f[1], t, e, n);
          break;
        case "Q":
          var d = yN.pointDistance(c[0], c[1], l[1], l[2], l[3], l[4], e, n);
          a = d <= t / 2;
          break;
        case "C":
          var v = vc.pointDistance(
            c[0],
            c[1],
            l[1],
            l[2],
            l[3],
            l[4],
            l[5],
            l[6],
            e,
            n,
            i
          );
          a = v <= t / 2;
          break;
        case "A":
          var p = u.arcParams, g = p.cx, y = p.cy, b = p.rx, m = p.ry, x = p.startAngle, _ = p.endAngle, w = p.xRotation, E = [e, n, 1], M = b > m ? b : m, C = b > m ? 1 : b / m, S = b > m ? m / b : 1, A = gK(null, [
            ["t", -g, -y],
            ["r", -w],
            ["s", 1 / C, 1 / S]
          ]);
          Mu(E, E, A), a = ic(0, 0, M, x, _, t, E[0], E[1]);
          break;
      }
      if (a)
        break;
    }
  }
  return a;
}
function bK(r) {
  for (var t = r.length, e = [], n = [], i = [], a = 0; a < t; a++) {
    var o = r[a], s = o[0];
    s === "M" ? (i.length && (n.push(i), i = []), i.push([o[1], o[2]])) : s === "Z" ? i.length && (e.push(i), i = []) : i.push([o[1], o[2]]);
  }
  return i.length > 0 && n.push(i), {
    polygons: e,
    polylines: n
  };
}
const Cd = U({ hasArc: yK, extractPolygons: bK, isPointInStroke: mK }, E9);
function iS(r, t, e) {
  for (var n = !1, i = 0; i < r.length; i++) {
    var a = r[i];
    if (n = OR(a, t, e), n)
      break;
  }
  return n;
}
var xK = function(r) {
  Ht(t, r);
  function t() {
    return r !== null && r.apply(this, arguments) || this;
  }
  return t.prototype.getDefaultAttrs = function() {
    var e = r.prototype.getDefaultAttrs.call(this);
    return U(U({}, e), { startArrow: !1, endArrow: !1 });
  }, t.prototype.initAttrs = function(e) {
    this._setPathArr(e.path), this.setArrow();
  }, t.prototype.onAttrChange = function(e, n, i) {
    r.prototype.onAttrChange.call(this, e, n, i), e === "path" && this._setPathArr(n), this.setArrow();
  }, t.prototype._setPathArr = function(e) {
    this.attrs.path = MN(e);
    var n = Cd.hasArc(e);
    this.set("hasArc", n), this.set("paramsCache", {}), this.set("segments", null), this.set("curve", null), this.set("tCache", null), this.set("totalLength", null);
  }, t.prototype.getSegments = function() {
    var e = this.get("segements");
    return e || (e = CN(this.attr("path")), this.set("segments", e)), e;
  }, t.prototype.setArrow = function() {
    var e = this.attr(), n = e.startArrow, i = e.endArrow;
    if (n) {
      var a = this.getStartTangent();
      Lb(this, e, a[0][0], a[0][1], a[1][0], a[1][1]);
    }
    if (i) {
      var a = this.getEndTangent();
      Nb(this, e, a[0][0], a[0][1], a[1][0], a[1][1]);
    }
  }, t.prototype.isInStrokeOrPath = function(e, n, i, a, o) {
    var s = this.getSegments(), u = this.get("hasArc"), f = !1;
    if (i) {
      var l = this.getTotalLength();
      f = Cd.isPointInStroke(s, o, e, n, l);
    }
    if (!f && a)
      if (u)
        f = PR(this, e, n);
      else {
        var c = this.attr("path"), h = Cd.extractPolygons(c);
        f = iS(h.polygons, e, n) || iS(h.polylines, e, n);
      }
    return f;
  }, t.prototype.createPath = function(e) {
    var n = this.attr(), i = this.get("paramsCache");
    TR(this, e, n, i);
  }, t.prototype.afterDrawPath = function(e) {
    var n = this.get("startArrowShape"), i = this.get("endArrowShape");
    n && n.draw(e), i && i.draw(e);
  }, t.prototype.getTotalLength = function() {
    var e = this.get("totalLength");
    return Tt(e) ? (this._calculateCurve(), this._setTcache(), this.get("totalLength")) : e;
  }, t.prototype.getPoint = function(e) {
    var n = this.get("tCache");
    n || (this._calculateCurve(), this._setTcache(), n = this.get("tCache"));
    var i, a, o = this.get("curve");
    if (!n || n.length === 0)
      return o ? {
        x: o[0][1],
        y: o[0][2]
      } : null;
    Se(n, function(l, c) {
      e >= l[0] && e <= l[1] && (i = (e - l[0]) / (l[1] - l[0]), a = c);
    });
    var s = o[a];
    if (Tt(s) || Tt(a))
      return null;
    var u = s.length, f = o[a + 1];
    return vc.pointAt(s[u - 2], s[u - 1], f[1], f[2], f[3], f[4], f[5], f[6], i);
  }, t.prototype._calculateCurve = function() {
    var e = this.attr().path;
    this.set("curve", Cd.pathToCurve(e));
  }, t.prototype._setTcache = function() {
    var e = 0, n = 0, i = [], a, o, s, u, f = this.get("curve");
    if (!!f) {
      if (Se(f, function(l, c) {
        s = f[c + 1], u = l.length, s && (e += vc.length(l[u - 2], l[u - 1], s[1], s[2], s[3], s[4], s[5], s[6]) || 0);
      }), this.set("totalLength", e), e === 0) {
        this.set("tCache", []);
        return;
      }
      Se(f, function(l, c) {
        s = f[c + 1], u = l.length, s && (a = [], a[0] = n / e, o = vc.length(l[u - 2], l[u - 1], s[1], s[2], s[3], s[4], s[5], s[6]), n += o || 0, a[1] = n / e, i.push(a));
      }), this.set("tCache", i);
    }
  }, t.prototype.getStartTangent = function() {
    var e = this.getSegments(), n;
    if (e.length > 1) {
      var i = e[0].currentPoint, a = e[1].currentPoint, o = e[1].startTangent;
      n = [], o ? (n.push([i[0] - o[0], i[1] - o[1]]), n.push([i[0], i[1]])) : (n.push([a[0], a[1]]), n.push([i[0], i[1]]));
    }
    return n;
  }, t.prototype.getEndTangent = function() {
    var e = this.getSegments(), n = e.length, i;
    if (n > 1) {
      var a = e[n - 2].currentPoint, o = e[n - 1].currentPoint, s = e[n - 1].endTangent;
      i = [], s ? (i.push([o[0] - s[0], o[1] - s[1]]), i.push([o[0], o[1]])) : (i.push([a[0], a[1]]), i.push([o[0], o[1]]));
    }
    return i;
  }, t;
}(oa);
const Bb = xK;
function DR(r, t, e, n, i) {
  var a = r.length;
  if (a < 2)
    return !1;
  for (var o = 0; o < a - 1; o++) {
    var s = r[o][0], u = r[o][1], f = r[o + 1][0], l = r[o + 1][1];
    if (is(s, u, f, l, t, e, n))
      return !0;
  }
  if (i) {
    var c = r[0], h = r[a - 1];
    if (is(c[0], c[1], h[0], h[1], t, e, n))
      return !0;
  }
  return !1;
}
var _K = function(r) {
  Ht(t, r);
  function t() {
    return r !== null && r.apply(this, arguments) || this;
  }
  return t.prototype.isInStrokeOrPath = function(e, n, i, a, o) {
    var s = this.attr().points, u = !1;
    return i && (u = DR(s, o, e, n, !0)), !u && a && (u = OR(s, e, n)), u;
  }, t.prototype.createPath = function(e) {
    var n = this.attr(), i = n.points;
    if (!(i.length < 2)) {
      e.beginPath();
      for (var a = 0; a < i.length; a++) {
        var o = i[a];
        a === 0 ? e.moveTo(o[0], o[1]) : e.lineTo(o[0], o[1]);
      }
      e.closePath();
    }
  }, t;
}(oa);
const wK = _K;
var EK = function(r) {
  Ht(t, r);
  function t() {
    return r !== null && r.apply(this, arguments) || this;
  }
  return t.prototype.getDefaultAttrs = function() {
    var e = r.prototype.getDefaultAttrs.call(this);
    return U(U({}, e), { startArrow: !1, endArrow: !1 });
  }, t.prototype.initAttrs = function(e) {
    this.setArrow();
  }, t.prototype.onAttrChange = function(e, n, i) {
    r.prototype.onAttrChange.call(this, e, n, i), this.setArrow(), ["points"].indexOf(e) !== -1 && this._resetCache();
  }, t.prototype._resetCache = function() {
    this.set("totalLength", null), this.set("tCache", null);
  }, t.prototype.setArrow = function() {
    var e = this.attr(), n = this.attrs, i = n.points, a = n.startArrow, o = n.endArrow, s = i.length, u = i[0][0], f = i[0][1], l = i[s - 1][0], c = i[s - 1][1];
    a && Lb(this, e, i[1][0], i[1][1], u, f), o && Nb(this, e, i[s - 2][0], i[s - 2][1], l, c);
  }, t.prototype.isFill = function() {
    return !1;
  }, t.prototype.isInStrokeOrPath = function(e, n, i, a, o) {
    if (!i || !o)
      return !1;
    var s = this.attr().points;
    return DR(s, o, e, n, !1);
  }, t.prototype.isStroke = function() {
    return !0;
  }, t.prototype.createPath = function(e) {
    var n = this.attr(), i = n.points, a = n.startArrow, o = n.endArrow, s = i.length;
    if (!(i.length < 2)) {
      var u = i[0][0], f = i[0][1], l = i[s - 1][0], c = i[s - 1][1];
      if (a && a.d) {
        var h = uu(u, f, i[1][0], i[1][1], a.d);
        u += h.dx, f += h.dy;
      }
      if (o && o.d) {
        var h = uu(i[s - 2][0], i[s - 2][1], l, c, o.d);
        l -= h.dx, c -= h.dy;
      }
      e.beginPath(), e.moveTo(u, f);
      for (var d = 0; d < s - 1; d++) {
        var v = i[d];
        e.lineTo(v[0], v[1]);
      }
      e.lineTo(l, c);
    }
  }, t.prototype.afterDrawPath = function(e) {
    var n = this.get("startArrowShape"), i = this.get("endArrowShape");
    n && n.draw(e), i && i.draw(e);
  }, t.prototype.getTotalLength = function() {
    var e = this.attr().points, n = this.get("totalLength");
    return Tt(n) ? (this.set("totalLength", xN.length(e)), this.get("totalLength")) : n;
  }, t.prototype.getPoint = function(e) {
    var n = this.attr().points, i = this.get("tCache");
    i || (this._setTcache(), i = this.get("tCache"));
    var a, o;
    return Se(i, function(s, u) {
      e >= s[0] && e <= s[1] && (a = (e - s[0]) / (s[1] - s[0]), o = u);
    }), Bn.pointAt(n[o][0], n[o][1], n[o + 1][0], n[o + 1][1], a);
  }, t.prototype._setTcache = function() {
    var e = this.attr().points;
    if (!(!e || e.length === 0)) {
      var n = this.getTotalLength();
      if (!(n <= 0)) {
        var i = 0, a = [], o, s;
        Se(e, function(u, f) {
          e[f + 1] && (o = [], o[0] = i / n, s = Bn.length(u[0], u[1], e[f + 1][0], e[f + 1][1]), i += s, o[1] = i / n, a.push(o));
        }), this.set("tCache", a);
      }
    }
  }, t.prototype.getStartTangent = function() {
    var e = this.attr().points, n = [];
    return n.push([e[1][0], e[1][1]]), n.push([e[0][0], e[0][1]]), n;
  }, t.prototype.getEndTangent = function() {
    var e = this.attr().points, n = e.length - 1, i = [];
    return i.push([e[n - 1][0], e[n - 1][1]]), i.push([e[n][0], e[n][1]]), i;
  }, t;
}(oa);
const SK = EK;
function MK(r, t, e, n, i, a, o) {
  var s = i / 2;
  return ou(r - s, t - s, e, i, a, o) || ou(r + e - s, t - s, i, n, a, o) || ou(r + s, t + n - s, e, i, a, o) || ou(r - s, t + s, i, n, a, o);
}
function CK(r, t, e, n, i, a, o, s) {
  return is(r + i, t, r + e - i, t, a, o, s) || is(r + e, t + i, r + e, t + n - i, a, o, s) || is(r + e - i, t + n, r + i, t + n, a, o, s) || is(r, t + n - i, r, t + i, a, o, s) || ic(r + e - i, t + i, i, 1.5 * Math.PI, 2 * Math.PI, a, o, s) || ic(r + e - i, t + n - i, i, 0, 0.5 * Math.PI, a, o, s) || ic(r + i, t + n - i, i, 0.5 * Math.PI, Math.PI, a, o, s) || ic(r + i, t + i, i, Math.PI, 1.5 * Math.PI, a, o, s);
}
var TK = function(r) {
  Ht(t, r);
  function t() {
    return r !== null && r.apply(this, arguments) || this;
  }
  return t.prototype.getDefaultAttrs = function() {
    var e = r.prototype.getDefaultAttrs.call(this);
    return U(U({}, e), { x: 0, y: 0, width: 0, height: 0, radius: 0 });
  }, t.prototype.isInStrokeOrPath = function(e, n, i, a, o) {
    var s = this.attr(), u = s.x, f = s.y, l = s.width, c = s.height, h = s.radius;
    if (h) {
      var v = !1;
      return i && (v = CK(u, f, l, c, h, o, e, n)), !v && a && (v = PR(this, e, n)), v;
    } else {
      var d = o / 2;
      if (a && i)
        return ou(u - d, f - d, l + d, c + d, e, n);
      if (a)
        return ou(u, f, l, c, e, n);
      if (i)
        return MK(u, f, l, c, o, e, n);
    }
  }, t.prototype.createPath = function(e) {
    var n = this.attr(), i = n.x, a = n.y, o = n.width, s = n.height, u = n.radius;
    if (e.beginPath(), u === 0)
      e.rect(i, a, o, s);
    else {
      var f = qH(u), l = f[0], c = f[1], h = f[2], d = f[3];
      e.moveTo(i + l, a), e.lineTo(i + o - c, a), c !== 0 && e.arc(i + o - c, a + c, c, -Math.PI / 2, 0), e.lineTo(i + o, a + s - h), h !== 0 && e.arc(i + o - h, a + s - h, h, 0, Math.PI / 2), e.lineTo(i + d, a + s), d !== 0 && e.arc(i + d, a + s - d, d, Math.PI / 2, Math.PI), e.lineTo(i, a + l), l !== 0 && e.arc(i + l, a + l, l, Math.PI, Math.PI * 1.5), e.closePath();
    }
  }, t;
}(oa);
const AK = TK;
var IK = function(r) {
  Ht(t, r);
  function t() {
    return r !== null && r.apply(this, arguments) || this;
  }
  return t.prototype.getDefaultAttrs = function() {
    var e = r.prototype.getDefaultAttrs.call(this);
    return U(U({}, e), { x: 0, y: 0, text: null, fontSize: 12, fontFamily: "sans-serif", fontStyle: "normal", fontWeight: "normal", fontVariant: "normal", textAlign: "start", textBaseline: "bottom" });
  }, t.prototype.isOnlyHitBox = function() {
    return !0;
  }, t.prototype.initAttrs = function(e) {
    this._assembleFont(), e.text && this._setText(e.text);
  }, t.prototype._assembleFont = function() {
    var e = this.attrs;
    e.font = EN(e);
  }, t.prototype._setText = function(e) {
    var n = null;
    Qe(e) && e.indexOf(`
`) !== -1 && (n = e.split(`
`)), this.set("textArr", n);
  }, t.prototype.onAttrChange = function(e, n, i) {
    r.prototype.onAttrChange.call(this, e, n, i), e.startsWith("font") && this._assembleFont(), e === "text" && this._setText(n);
  }, t.prototype._getSpaceingY = function() {
    var e = this.attrs, n = e.lineHeight, i = e.fontSize * 1;
    return n ? n - i : i * 0.14;
  }, t.prototype._drawTextArr = function(e, n, i) {
    var a = this.attrs, o = a.textBaseline, s = a.x, u = a.y, f = a.fontSize * 1, l = this._getSpaceingY(), c = wN(a.text, a.fontSize, a.lineHeight), h;
    Se(n, function(d, v) {
      h = u + v * (l + f) - c + f, o === "middle" && (h += c - f - (c - f) / 2), o === "top" && (h += c - f), Tt(d) || (i ? e.fillText(d, s, h) : e.strokeText(d, s, h));
    });
  }, t.prototype._drawText = function(e, n) {
    var i = this.attr(), a = i.x, o = i.y, s = this.get("textArr");
    if (s)
      this._drawTextArr(e, s, n);
    else {
      var u = i.text;
      Tt(u) || (n ? e.fillText(u, a, o) : e.strokeText(u, a, o));
    }
  }, t.prototype.strokeAndFill = function(e) {
    var n = this.attrs, i = n.lineWidth, a = n.opacity, o = n.strokeOpacity, s = n.fillOpacity;
    this.isStroke() && i > 0 && (!Tt(o) && o !== 1 && (e.globalAlpha = a), this.stroke(e)), this.isFill() && (!Tt(s) && s !== 1 ? (e.globalAlpha = s, this.fill(e), e.globalAlpha = a) : this.fill(e)), this.afterDrawPath(e);
  }, t.prototype.fill = function(e) {
    this._drawText(e, !0);
  }, t.prototype.stroke = function(e) {
    this._drawText(e, !1);
  }, t;
}(oa);
const PK = IK;
function OK(r, t) {
  if (t) {
    var e = VL(t);
    return au(e, r);
  }
  return r;
}
function kR(r, t, e) {
  var n = r.getTotalMatrix();
  if (n) {
    var i = OK([t, e, 1], n), a = i[0], o = i[1];
    return [a, o];
  }
  return [t, e];
}
function aS(r, t, e) {
  if (r.isCanvas && r.isCanvas())
    return !0;
  if (!cm(r) || r.cfg.isInView === !1)
    return !1;
  if (r.cfg.clipShape) {
    var n = kR(r, t, e), i = n[0], a = n[1];
    if (r.isClipped(i, a))
      return !1;
  }
  var o = r.cfg.cacheCanvasBBox || r.getCanvasBBox();
  return t >= o.minX && t <= o.maxX && e >= o.minY && e <= o.maxY;
}
function LR(r, t, e) {
  if (!aS(r, t, e))
    return null;
  for (var n = null, i = r.getChildren(), a = i.length, o = a - 1; o >= 0; o--) {
    var s = i[o];
    if (s.isGroup())
      n = LR(s, t, e);
    else if (aS(s, t, e)) {
      var u = s, f = kR(s, t, e), l = f[0], c = f[1];
      u.isInShape(l, c) && (n = s);
    }
    if (n)
      break;
  }
  return n;
}
var po = function(r) {
  Ht(t, r);
  function t() {
    return r !== null && r.apply(this, arguments) || this;
  }
  return t.prototype.getDefaultCfg = function() {
    var e = r.prototype.getDefaultCfg.call(this);
    return e.renderer = "canvas", e.autoDraw = !0, e.localRefresh = !0, e.refreshElements = [], e.clipView = !0, e.quickHit = !1, e;
  }, t.prototype.onCanvasChange = function(e) {
    (e === "attr" || e === "sort" || e === "changeSize") && (this.set("refreshElements", [this]), this.draw());
  }, t.prototype.getShapeBase = function() {
    return F1;
  }, t.prototype.getGroupBase = function() {
    return IR;
  }, t.prototype.getPixelRatio = function() {
    var e = this.get("pixelRatio") || UH();
    return e >= 1 ? Math.ceil(e) : 1;
  }, t.prototype.getViewRange = function() {
    return {
      minX: 0,
      minY: 0,
      maxX: this.cfg.width,
      maxY: this.cfg.height
    };
  }, t.prototype.createDom = function() {
    var e = document.createElement("canvas"), n = e.getContext("2d");
    return this.set("context", n), e;
  }, t.prototype.setDOMSize = function(e, n) {
    r.prototype.setDOMSize.call(this, e, n);
    var i = this.get("context"), a = this.get("el"), o = this.getPixelRatio();
    a.width = o * e, a.height = o * n, o > 1 && i.scale(o, o);
  }, t.prototype.clear = function() {
    r.prototype.clear.call(this), this._clearFrame();
    var e = this.get("context"), n = this.get("el");
    e.clearRect(0, 0, n.width, n.height);
  }, t.prototype.getShape = function(e, n) {
    var i;
    return this.get("quickHit") ? i = LR(this, e, n) : i = r.prototype.getShape.call(this, e, n, null), i;
  }, t.prototype._getRefreshRegion = function() {
    var e = this.get("refreshElements"), n = this.getViewRange(), i;
    if (e.length && e[0] === this)
      i = n;
    else if (i = eK(e), i) {
      i.minX = Math.floor(i.minX), i.minY = Math.floor(i.minY), i.maxX = Math.ceil(i.maxX), i.maxY = Math.ceil(i.maxY), i.maxY += 1;
      var a = this.get("clipView");
      a && (i = tK(i, n));
    }
    return i;
  }, t.prototype.refreshElement = function(e) {
    var n = this.get("refreshElements");
    n.push(e);
  }, t.prototype._clearFrame = function() {
    var e = this.get("drawFrame");
    e && (LD(e), this.set("drawFrame", null), this.set("refreshElements", []));
  }, t.prototype.draw = function() {
    var e = this.get("drawFrame");
    this.get("autoDraw") && e || this._startDraw();
  }, t.prototype._drawAll = function() {
    var e = this.get("context"), n = this.get("el"), i = this.getChildren();
    e.clearRect(0, 0, n.width, n.height), Vf(e, this), Bm(e, i), this.set("refreshElements", []);
  }, t.prototype._drawRegion = function() {
    var e = this.get("context"), n = this.get("refreshElements"), i = this.getChildren(), a = this._getRefreshRegion();
    a ? (e.clearRect(a.minX, a.minY, a.maxX - a.minX, a.maxY - a.minY), e.save(), e.beginPath(), e.rect(a.minX, a.minY, a.maxX - a.minX, a.maxY - a.minY), e.clip(), Vf(e, this), ZH(this, i, a), Bm(e, i, a), e.restore()) : n.length && CR(n), Se(n, function(o) {
      o.get("hasChanged") && o.set("hasChanged", !1);
    }), this.set("refreshElements", []);
  }, t.prototype._startDraw = function() {
    var e = this, n = this.get("drawFrame");
    n || (n = kD(function() {
      e.get("localRefresh") ? e._drawRegion() : e._drawAll(), e.set("drawFrame", null);
    }), this.set("drawFrame", n));
  }, t.prototype.skipDraw = function() {
  }, t.prototype.removeDom = function() {
    var e = this.get("el");
    e.width = 0, e.height = 0, e.parentNode.removeChild(e);
  }, t;
}(uN), Fm = {
  rect: "path",
  circle: "circle",
  line: "line",
  path: "path",
  marker: "path",
  text: "text",
  polyline: "polyline",
  polygon: "polygon",
  image: "image",
  ellipse: "ellipse",
  dom: "foreignObject"
}, xr = {
  opacity: "opacity",
  fillStyle: "fill",
  fill: "fill",
  fillOpacity: "fill-opacity",
  strokeStyle: "stroke",
  strokeOpacity: "stroke-opacity",
  stroke: "stroke",
  x: "x",
  y: "y",
  r: "r",
  rx: "rx",
  ry: "ry",
  width: "width",
  height: "height",
  x1: "x1",
  x2: "x2",
  y1: "y1",
  y2: "y2",
  lineCap: "stroke-linecap",
  lineJoin: "stroke-linejoin",
  lineWidth: "stroke-width",
  lineDash: "stroke-dasharray",
  lineDashOffset: "stroke-dashoffset",
  miterLimit: "stroke-miterlimit",
  font: "font",
  fontSize: "font-size",
  fontStyle: "font-style",
  fontVariant: "font-variant",
  fontWeight: "font-weight",
  fontFamily: "font-family",
  startArrow: "marker-start",
  endArrow: "marker-end",
  path: "d",
  class: "class",
  id: "id",
  style: "style",
  preserveAspectRatio: "preserveAspectRatio"
};
function Ui(r) {
  return document.createElementNS("http://www.w3.org/2000/svg", r);
}
function NR(r) {
  var t = Fm[r.type], e = r.getParent();
  if (!t)
    throw new Error("the type " + r.type + " is not supported by svg");
  var n = Ui(t);
  if (r.get("id") && (n.id = r.get("id")), r.set("el", n), r.set("attrs", {}), e) {
    var i = e.get("el");
    i || (i = e.createDom(), e.set("el", i)), i.appendChild(n);
  }
  return n;
}
function RR(r, t) {
  var e = r.get("el"), n = GD(e.children).sort(t), i = document.createDocumentFragment();
  n.forEach(function(a) {
    i.appendChild(a);
  }), e.appendChild(i);
}
function DK(r, t) {
  var e = r.parentNode, n = Array.from(e.childNodes).filter(
    function(s) {
      return s.nodeType === 1 && s.nodeName.toLowerCase() !== "defs";
    }
  ), i = n[t], a = n.indexOf(r);
  if (i) {
    if (a > t)
      e.insertBefore(r, i);
    else if (a < t) {
      var o = n[t + 1];
      o ? e.insertBefore(r, o) : e.appendChild(r);
    }
  } else
    e.appendChild(r);
}
function kK(r, t) {
  var e = r.cfg.el, n = r.attr(), i = {
    dx: n.shadowOffsetX,
    dy: n.shadowOffsetY,
    blur: n.shadowBlur,
    color: n.shadowColor
  };
  if (!i.dx && !i.dy && !i.blur && !i.color)
    e.removeAttribute("filter");
  else {
    var a = t.find("filter", i);
    a || (a = t.addShadow(i)), e.setAttribute("filter", "url(#" + a + ")");
  }
}
function ah(r) {
  var t = r.attr().matrix;
  if (t) {
    for (var e = r.cfg.el, n = [], i = 0; i < 9; i += 3)
      n.push(t[i] + "," + t[i + 1]);
    n = n.join(","), n.indexOf("NaN") === -1 ? e.setAttribute("transform", "matrix(" + n + ")") : console.warn("invalid matrix:", t);
  }
}
function zc(r, t) {
  var e = r.getClip(), n = r.get("el");
  if (!e)
    n.removeAttribute("clip-path");
  else if (e && !n.hasAttribute("clip-path")) {
    NR(e), e.createPath(t);
    var i = t.addClip(e);
    n.setAttribute("clip-path", "url(#" + i + ")");
  }
}
function BR(r, t) {
  t.forEach(function(e) {
    e.draw(r);
  });
}
function GR(r, t) {
  var e = r.get("canvas");
  if (e && e.get("autoDraw")) {
    var n = e.get("context"), i = r.getParent(), a = i ? i.getChildren() : [e], o = r.get("el");
    if (t === "remove") {
      var s = r.get("isClipShape");
      if (s) {
        var u = o && o.parentNode, f = u && u.parentNode;
        u && f && f.removeChild(u);
      } else
        o && o.parentNode && o.parentNode.removeChild(o);
    } else if (t === "show")
      o.setAttribute("visibility", "visible");
    else if (t === "hide")
      o.setAttribute("visibility", "hidden");
    else if (t === "zIndex")
      DK(o, a.indexOf(r));
    else if (t === "sort") {
      var l = r.get("children");
      l && l.length && RR(r, function(c, h) {
        return l.indexOf(c) - l.indexOf(h) ? 1 : 0;
      });
    } else
      t === "clear" ? o && (o.innerHTML = "") : t === "matrix" ? ah(r) : t === "clip" ? zc(r, n) : t === "attr" || t === "add" && r.draw(n);
  }
}
var FR = function(r) {
  Ht(t, r);
  function t() {
    return r !== null && r.apply(this, arguments) || this;
  }
  return t.prototype.isEntityGroup = function() {
    return !0;
  }, t.prototype.createDom = function() {
    var e = Ui("g");
    this.set("el", e);
    var n = this.getParent();
    if (n) {
      var i = n.get("el");
      i || (i = n.createDom(), n.set("el", i)), i.appendChild(e);
    }
    return e;
  }, t.prototype.afterAttrsChange = function(e) {
    r.prototype.afterAttrsChange.call(this, e);
    var n = this.get("canvas");
    if (n && n.get("autoDraw")) {
      var i = n.get("context");
      this.createPath(i, e);
    }
  }, t.prototype.onCanvasChange = function(e) {
    GR(this, e);
  }, t.prototype.getShapeBase = function() {
    return z1;
  }, t.prototype.getGroupBase = function() {
    return t;
  }, t.prototype.draw = function(e) {
    var n = this.getChildren(), i = this.get("el");
    this.get("destroyed") ? i && i.parentNode.removeChild(i) : (i || this.createDom(), zc(this, e), this.createPath(e), n.length && BR(e, n));
  }, t.prototype.createPath = function(e, n) {
    var i = this.attr(), a = this.get("el");
    Se(n || i, function(o, s) {
      xr[s] && a.setAttribute(xr[s], o);
    }), ah(this);
  }, t;
}(fN), LK = function(r) {
  Ht(t, r);
  function t() {
    var e = r !== null && r.apply(this, arguments) || this;
    return e.type = "svg", e.canFill = !1, e.canStroke = !1, e;
  }
  return t.prototype.getDefaultAttrs = function() {
    var e = r.prototype.getDefaultAttrs.call(this);
    return U(U({}, e), { lineWidth: 1, lineAppendWidth: 0, strokeOpacity: 1, fillOpacity: 1 });
  }, t.prototype.afterAttrsChange = function(e) {
    r.prototype.afterAttrsChange.call(this, e);
    var n = this.get("canvas");
    if (n && n.get("autoDraw")) {
      var i = n.get("context");
      this.draw(i, e);
    }
  }, t.prototype.getShapeBase = function() {
    return z1;
  }, t.prototype.getGroupBase = function() {
    return FR;
  }, t.prototype.onCanvasChange = function(e) {
    GR(this, e);
  }, t.prototype.calculateBBox = function() {
    var e = this.get("el"), n = null;
    if (e)
      n = e.getBBox();
    else {
      var i = hN(this.get("type"));
      i && (n = i(this));
    }
    if (n) {
      var a = n.x, o = n.y, s = n.width, u = n.height, f = this.getHitLineWidth(), l = f / 2, c = a - l, h = o - l, d = a + s + l, v = o + u + l;
      return {
        x: c,
        y: h,
        minX: c,
        minY: h,
        maxX: d,
        maxY: v,
        width: s + f,
        height: u + f
      };
    }
    return {
      x: 0,
      y: 0,
      minX: 0,
      minY: 0,
      maxX: 0,
      maxY: 0,
      width: 0,
      height: 0
    };
  }, t.prototype.isFill = function() {
    var e = this.attr(), n = e.fill, i = e.fillStyle;
    return (n || i || this.isClipShape()) && this.canFill;
  }, t.prototype.isStroke = function() {
    var e = this.attr(), n = e.stroke, i = e.strokeStyle;
    return (n || i) && this.canStroke;
  }, t.prototype.draw = function(e, n) {
    var i = this.get("el");
    this.get("destroyed") ? i && i.parentNode.removeChild(i) : (i || NR(this), zc(this, e), this.createPath(e, n), this.shadow(e, n), this.strokeAndFill(e, n), this.transform(n));
  }, t.prototype.createPath = function(e, n) {
  }, t.prototype.strokeAndFill = function(e, n) {
    var i = n || this.attr(), a = i.fill, o = i.fillStyle, s = i.stroke, u = i.strokeStyle, f = i.fillOpacity, l = i.strokeOpacity, c = i.lineWidth, h = this.get("el");
    this.canFill && (n ? "fill" in i ? this._setColor(e, "fill", a) : "fillStyle" in i && this._setColor(e, "fill", o) : this._setColor(e, "fill", a || o), f && h.setAttribute(xr.fillOpacity, f)), this.canStroke && c > 0 && (n ? "stroke" in i ? this._setColor(e, "stroke", s) : "strokeStyle" in i && this._setColor(e, "stroke", u) : this._setColor(e, "stroke", s || u), l && h.setAttribute(xr.strokeOpacity, l), c && h.setAttribute(xr.lineWidth, c));
  }, t.prototype._setColor = function(e, n, i) {
    var a = this.get("el");
    if (!i) {
      a.setAttribute(xr[n], "none");
      return;
    }
    if (i = i.trim(), /^[r,R,L,l]{1}[\s]*\(/.test(i)) {
      var o = e.find("gradient", i);
      o || (o = e.addGradient(i)), a.setAttribute(xr[n], "url(#" + o + ")");
    } else if (/^[p,P]{1}[\s]*\(/.test(i)) {
      var o = e.find("pattern", i);
      o || (o = e.addPattern(i)), a.setAttribute(xr[n], "url(#" + o + ")");
    } else
      a.setAttribute(xr[n], i);
  }, t.prototype.shadow = function(e, n) {
    var i = this.attr(), a = n || i, o = a.shadowOffsetX, s = a.shadowOffsetY, u = a.shadowBlur, f = a.shadowColor;
    (o || s || u || f) && kK(this, e);
  }, t.prototype.transform = function(e) {
    var n = this.attr(), i = (e || n).matrix;
    i && ah(this);
  }, t.prototype.isInShape = function(e, n) {
    return this.isPointInPath(e, n);
  }, t.prototype.isPointInPath = function(e, n) {
    var i = this.get("el"), a = this.get("canvas"), o = a.get("el").getBoundingClientRect(), s = e + o.left, u = n + o.top, f = document.elementFromPoint(s, u);
    return !!(f && f.isEqualNode(i));
  }, t.prototype.getHitLineWidth = function() {
    var e = this.attrs, n = e.lineWidth, i = e.lineAppendWidth;
    return this.isStroke() ? n + i : 0;
  }, t;
}(lN);
const Wi = LK;
var NK = function(r) {
  Ht(t, r);
  function t() {
    var e = r !== null && r.apply(this, arguments) || this;
    return e.type = "circle", e.canFill = !0, e.canStroke = !0, e;
  }
  return t.prototype.getDefaultAttrs = function() {
    var e = r.prototype.getDefaultAttrs.call(this);
    return U(U({}, e), { x: 0, y: 0, r: 0 });
  }, t.prototype.createPath = function(e, n) {
    var i = this.attr(), a = this.get("el");
    Se(n || i, function(o, s) {
      s === "x" || s === "y" ? a.setAttribute("c" + s, o) : xr[s] && a.setAttribute(xr[s], o);
    });
  }, t;
}(Wi);
const RK = NK;
var BK = function(r) {
  Ht(t, r);
  function t() {
    var e = r !== null && r.apply(this, arguments) || this;
    return e.type = "dom", e.canFill = !1, e.canStroke = !1, e;
  }
  return t.prototype.createPath = function(e, n) {
    var i = this.attr(), a = this.get("el");
    if (Se(n || i, function(f, l) {
      xr[l] && a.setAttribute(xr[l], f);
    }), typeof i.html == "function") {
      var o = i.html.call(this, i);
      if (o instanceof Element || o instanceof HTMLDocument) {
        for (var s = a.childNodes, u = s.length - 1; u >= 0; u--)
          a.removeChild(s[u]);
        a.appendChild(o);
      } else
        a.innerHTML = o;
    } else
      a.innerHTML = i.html;
  }, t;
}(Wi);
const GK = BK;
var FK = function(r) {
  Ht(t, r);
  function t() {
    var e = r !== null && r.apply(this, arguments) || this;
    return e.type = "ellipse", e.canFill = !0, e.canStroke = !0, e;
  }
  return t.prototype.getDefaultAttrs = function() {
    var e = r.prototype.getDefaultAttrs.call(this);
    return U(U({}, e), { x: 0, y: 0, rx: 0, ry: 0 });
  }, t.prototype.createPath = function(e, n) {
    var i = this.attr(), a = this.get("el");
    Se(n || i, function(o, s) {
      s === "x" || s === "y" ? a.setAttribute("c" + s, o) : xr[s] && a.setAttribute(xr[s], o);
    });
  }, t;
}(Wi);
const zK = FK;
var UK = function(r) {
  Ht(t, r);
  function t() {
    var e = r !== null && r.apply(this, arguments) || this;
    return e.type = "image", e.canFill = !1, e.canStroke = !1, e;
  }
  return t.prototype.getDefaultAttrs = function() {
    var e = r.prototype.getDefaultAttrs.call(this);
    return U(U({}, e), { x: 0, y: 0, width: 0, height: 0 });
  }, t.prototype.createPath = function(e, n) {
    var i = this, a = this.attr(), o = this.get("el");
    Se(n || a, function(s, u) {
      u === "img" ? i._setImage(a.img) : xr[u] && o.setAttribute(xr[u], s);
    });
  }, t.prototype.setAttr = function(e, n) {
    this.attrs[e] = n, e === "img" && this._setImage(n);
  }, t.prototype._setImage = function(e) {
    var n = this.attr(), i = this.get("el");
    if (Qe(e))
      i.setAttribute("href", e);
    else if (e instanceof window.Image)
      n.width || (i.setAttribute("width", e.width), this.attr("width", e.width)), n.height || (i.setAttribute("height", e.height), this.attr("height", e.height)), i.setAttribute("href", e.src);
    else if (e instanceof HTMLElement && Qe(e.nodeName) && e.nodeName.toUpperCase() === "CANVAS")
      i.setAttribute("href", e.toDataURL());
    else if (e instanceof ImageData) {
      var a = document.createElement("canvas");
      a.setAttribute("width", "" + e.width), a.setAttribute("height", "" + e.height), a.getContext("2d").putImageData(e, 0, 0), n.width || (i.setAttribute("width", "" + e.width), this.attr("width", e.width)), n.height || (i.setAttribute("height", "" + e.height), this.attr("height", e.height)), i.setAttribute("href", a.toDataURL());
    }
  }, t;
}(Wi);
const jK = UK;
var $K = function(r) {
  Ht(t, r);
  function t() {
    var e = r !== null && r.apply(this, arguments) || this;
    return e.type = "line", e.canFill = !1, e.canStroke = !0, e;
  }
  return t.prototype.getDefaultAttrs = function() {
    var e = r.prototype.getDefaultAttrs.call(this);
    return U(U({}, e), { x1: 0, y1: 0, x2: 0, y2: 0, startArrow: !1, endArrow: !1 });
  }, t.prototype.createPath = function(e, n) {
    var i = this.attr(), a = this.get("el");
    Se(n || i, function(o, s) {
      if (s === "startArrow" || s === "endArrow")
        if (o) {
          var u = Xn(o) ? e.addArrow(i, xr[s]) : e.getDefaultArrow(i, xr[s]);
          a.setAttribute(xr[s], "url(#" + u + ")");
        } else
          a.removeAttribute(xr[s]);
      else
        xr[s] && a.setAttribute(xr[s], o);
    });
  }, t.prototype.getTotalLength = function() {
    var e = this.attr(), n = e.x1, i = e.y1, a = e.x2, o = e.y2;
    return Bn.length(n, i, a, o);
  }, t.prototype.getPoint = function(e) {
    var n = this.attr(), i = n.x1, a = n.y1, o = n.x2, s = n.y2;
    return Bn.pointAt(i, a, o, s, e);
  }, t;
}(Wi);
const WK = $K;
var Td = {
  circle: function(r, t, e) {
    return [
      ["M", r, t],
      ["m", -e, 0],
      ["a", e, e, 0, 1, 0, e * 2, 0],
      ["a", e, e, 0, 1, 0, -e * 2, 0]
    ];
  },
  square: function(r, t, e) {
    return [["M", r - e, t - e], ["L", r + e, t - e], ["L", r + e, t + e], ["L", r - e, t + e], ["Z"]];
  },
  diamond: function(r, t, e) {
    return [["M", r - e, t], ["L", r, t - e], ["L", r + e, t], ["L", r, t + e], ["Z"]];
  },
  triangle: function(r, t, e) {
    var n = e * Math.sin(0.3333333333333333 * Math.PI);
    return [["M", r - e, t + n], ["L", r, t - n], ["L", r + e, t + n], ["z"]];
  },
  triangleDown: function(r, t, e) {
    var n = e * Math.sin(0.3333333333333333 * Math.PI);
    return [["M", r - e, t - n], ["L", r + e, t - n], ["L", r, t + n], ["Z"]];
  }
};
const oS = {
  get: function(r) {
    return Td[r];
  },
  register: function(r, t) {
    Td[r] = t;
  },
  remove: function(r) {
    delete Td[r];
  },
  getAll: function() {
    return Td;
  }
};
var VK = function(r) {
  Ht(t, r);
  function t() {
    var e = r !== null && r.apply(this, arguments) || this;
    return e.type = "marker", e.canFill = !0, e.canStroke = !0, e;
  }
  return t.prototype.createPath = function(e) {
    var n = this.get("el");
    n.setAttribute("d", this._assembleMarker());
  }, t.prototype._assembleMarker = function() {
    var e = this._getPath();
    return Dt(e) ? e.map(function(n) {
      return n.join(" ");
    }).join("") : e;
  }, t.prototype._getPath = function() {
    var e = this.attr(), n = e.x, i = e.y, a = e.r || e.radius, o = e.symbol || "circle", s;
    return Ur(o) ? s = o : s = oS.get(o), s ? s(n, i, a) : (console.warn(s + " symbol is not exist."), null);
  }, t.symbolsFactory = oS, t;
}(Wi);
const XK = VK;
var YK = function(r) {
  Ht(t, r);
  function t() {
    var e = r !== null && r.apply(this, arguments) || this;
    return e.type = "path", e.canFill = !0, e.canStroke = !0, e;
  }
  return t.prototype.getDefaultAttrs = function() {
    var e = r.prototype.getDefaultAttrs.call(this);
    return U(U({}, e), { startArrow: !1, endArrow: !1 });
  }, t.prototype.createPath = function(e, n) {
    var i = this, a = this.attr(), o = this.get("el");
    Se(n || a, function(s, u) {
      if (u === "path" && Dt(s))
        o.setAttribute("d", i._formatPath(s));
      else if (u === "startArrow" || u === "endArrow")
        if (s) {
          var f = Xn(s) ? e.addArrow(a, xr[u]) : e.getDefaultArrow(a, xr[u]);
          o.setAttribute(xr[u], "url(#" + f + ")");
        } else
          o.removeAttribute(xr[u]);
      else
        xr[u] && o.setAttribute(xr[u], s);
    });
  }, t.prototype._formatPath = function(e) {
    var n = e.map(function(i) {
      return i.join(" ");
    }).join("");
    return ~n.indexOf("NaN") ? "" : n;
  }, t.prototype.getTotalLength = function() {
    var e = this.get("el");
    return e ? e.getTotalLength() : null;
  }, t.prototype.getPoint = function(e) {
    var n = this.get("el"), i = this.getTotalLength();
    if (i === 0)
      return null;
    var a = n ? n.getPointAtLength(e * i) : null;
    return a ? {
      x: a.x,
      y: a.y
    } : null;
  }, t;
}(Wi);
const HK = YK;
var KK = function(r) {
  Ht(t, r);
  function t() {
    var e = r !== null && r.apply(this, arguments) || this;
    return e.type = "polygon", e.canFill = !0, e.canStroke = !0, e;
  }
  return t.prototype.createPath = function(e, n) {
    var i = this.attr(), a = this.get("el");
    Se(n || i, function(o, s) {
      s === "points" && Dt(o) && o.length >= 2 ? a.setAttribute("points", o.map(function(u) {
        return u[0] + "," + u[1];
      }).join(" ")) : xr[s] && a.setAttribute(xr[s], o);
    });
  }, t;
}(Wi);
const qK = KK;
var ZK = function(r) {
  Ht(t, r);
  function t() {
    var e = r !== null && r.apply(this, arguments) || this;
    return e.type = "polyline", e.canFill = !0, e.canStroke = !0, e;
  }
  return t.prototype.getDefaultAttrs = function() {
    var e = r.prototype.getDefaultAttrs.call(this);
    return U(U({}, e), { startArrow: !1, endArrow: !1 });
  }, t.prototype.onAttrChange = function(e, n, i) {
    r.prototype.onAttrChange.call(this, e, n, i), ["points"].indexOf(e) !== -1 && this._resetCache();
  }, t.prototype._resetCache = function() {
    this.set("totalLength", null), this.set("tCache", null);
  }, t.prototype.createPath = function(e, n) {
    var i = this.attr(), a = this.get("el");
    Se(n || i, function(o, s) {
      s === "points" && Dt(o) && o.length >= 2 ? a.setAttribute("points", o.map(function(u) {
        return u[0] + "," + u[1];
      }).join(" ")) : xr[s] && a.setAttribute(xr[s], o);
    });
  }, t.prototype.getTotalLength = function() {
    var e = this.attr().points, n = this.get("totalLength");
    return Tt(n) ? (this.set("totalLength", xN.length(e)), this.get("totalLength")) : n;
  }, t.prototype.getPoint = function(e) {
    var n = this.attr().points, i = this.get("tCache");
    i || (this._setTcache(), i = this.get("tCache"));
    var a, o;
    return Se(i, function(s, u) {
      e >= s[0] && e <= s[1] && (a = (e - s[0]) / (s[1] - s[0]), o = u);
    }), Bn.pointAt(n[o][0], n[o][1], n[o + 1][0], n[o + 1][1], a);
  }, t.prototype._setTcache = function() {
    var e = this.attr().points;
    if (!(!e || e.length === 0)) {
      var n = this.getTotalLength();
      if (!(n <= 0)) {
        var i = 0, a = [], o, s;
        Se(e, function(u, f) {
          e[f + 1] && (o = [], o[0] = i / n, s = Bn.length(u[0], u[1], e[f + 1][0], e[f + 1][1]), i += s, o[1] = i / n, a.push(o));
        }), this.set("tCache", a);
      }
    }
  }, t.prototype.getStartTangent = function() {
    var e = this.attr().points, n = [];
    return n.push([e[1][0], e[1][1]]), n.push([e[0][0], e[0][1]]), n;
  }, t.prototype.getEndTangent = function() {
    var e = this.attr().points, n = e.length - 1, i = [];
    return i.push([e[n - 1][0], e[n - 1][1]]), i.push([e[n][0], e[n][1]]), i;
  }, t;
}(Wi);
const QK = ZK;
function JK(r) {
  var t = 0, e = 0, n = 0, i = 0;
  return Dt(r) ? r.length === 1 ? t = e = n = i = r[0] : r.length === 2 ? (t = n = r[0], e = i = r[1]) : r.length === 3 ? (t = r[0], e = i = r[1], n = r[2]) : (t = r[0], e = r[1], n = r[2], i = r[3]) : t = e = n = i = r, {
    r1: t,
    r2: e,
    r3: n,
    r4: i
  };
}
var eq = function(r) {
  Ht(t, r);
  function t() {
    var e = r !== null && r.apply(this, arguments) || this;
    return e.type = "rect", e.canFill = !0, e.canStroke = !0, e;
  }
  return t.prototype.getDefaultAttrs = function() {
    var e = r.prototype.getDefaultAttrs.call(this);
    return U(U({}, e), { x: 0, y: 0, width: 0, height: 0, radius: 0 });
  }, t.prototype.createPath = function(e, n) {
    var i = this, a = this.attr(), o = this.get("el"), s = !1, u = ["x", "y", "width", "height", "radius"];
    Se(n || a, function(f, l) {
      u.indexOf(l) !== -1 && !s ? (o.setAttribute("d", i._assembleRect(a)), s = !0) : u.indexOf(l) === -1 && xr[l] && o.setAttribute(xr[l], f);
    });
  }, t.prototype._assembleRect = function(e) {
    var n = e.x, i = e.y, a = e.width, o = e.height, s = e.radius;
    if (!s)
      return "M " + n + "," + i + " l " + a + ",0 l 0," + o + " l" + -a + " 0 z";
    var u = JK(s);
    Dt(s) ? s.length === 1 ? u.r1 = u.r2 = u.r3 = u.r4 = s[0] : s.length === 2 ? (u.r1 = u.r3 = s[0], u.r2 = u.r4 = s[1]) : s.length === 3 ? (u.r1 = s[0], u.r2 = u.r4 = s[1], u.r3 = s[2]) : (u.r1 = s[0], u.r2 = s[1], u.r3 = s[2], u.r4 = s[3]) : u.r1 = u.r2 = u.r3 = u.r4 = s;
    var f = [
      ["M " + (n + u.r1) + "," + i],
      ["l " + (a - u.r1 - u.r2) + ",0"],
      ["a " + u.r2 + "," + u.r2 + ",0,0,1," + u.r2 + "," + u.r2],
      ["l 0," + (o - u.r2 - u.r3)],
      ["a " + u.r3 + "," + u.r3 + ",0,0,1," + -u.r3 + "," + u.r3],
      ["l " + (u.r3 + u.r4 - a) + ",0"],
      ["a " + u.r4 + "," + u.r4 + ",0,0,1," + -u.r4 + "," + -u.r4],
      ["l 0," + (u.r4 + u.r1 - o)],
      ["a " + u.r1 + "," + u.r1 + ",0,0,1," + u.r1 + "," + -u.r1],
      ["z"]
    ];
    return f.join(" ");
  }, t;
}(Wi);
const tq = eq;
var sS = 0.3, rq = {
  top: "before-edge",
  middle: "central",
  bottom: "after-edge",
  alphabetic: "baseline",
  hanging: "hanging"
}, nq = {
  top: "text-before-edge",
  middle: "central",
  bottom: "text-after-edge",
  alphabetic: "alphabetic",
  hanging: "hanging"
}, iq = {
  left: "left",
  start: "left",
  center: "middle",
  right: "end",
  end: "end"
}, aq = function(r) {
  Ht(t, r);
  function t() {
    var e = r !== null && r.apply(this, arguments) || this;
    return e.type = "text", e.canFill = !0, e.canStroke = !0, e;
  }
  return t.prototype.getDefaultAttrs = function() {
    var e = r.prototype.getDefaultAttrs.call(this);
    return U(U({}, e), { x: 0, y: 0, text: null, fontSize: 12, fontFamily: "sans-serif", fontStyle: "normal", fontWeight: "normal", fontVariant: "normal", textAlign: "start", textBaseline: "bottom" });
  }, t.prototype.createPath = function(e, n) {
    var i = this, a = this.attr(), o = this.get("el");
    this._setFont(), Se(n || a, function(s, u) {
      u === "text" ? i._setText("" + s) : u === "matrix" && s ? ah(i) : xr[u] && o.setAttribute(xr[u], s);
    }), o.setAttribute("paint-order", "stroke"), o.setAttribute("style", "stroke-linecap:butt; stroke-linejoin:miter;");
  }, t.prototype._setFont = function() {
    var e = this.get("el"), n = this.attr(), i = n.textBaseline, a = n.textAlign, o = WL();
    o && o.name === "firefox" ? e.setAttribute("dominant-baseline", nq[i] || "alphabetic") : e.setAttribute("alignment-baseline", rq[i] || "baseline"), e.setAttribute("text-anchor", iq[a] || "left");
  }, t.prototype._setText = function(e) {
    var n = this.get("el"), i = this.attr(), a = i.x, o = i.textBaseline, s = o === void 0 ? "bottom" : o;
    if (!e)
      n.innerHTML = "";
    else if (~e.indexOf(`
`)) {
      var u = e.split(`
`), f = u.length - 1, l = "";
      Se(u, function(c, h) {
        h === 0 ? s === "alphabetic" ? l += '<tspan x="' + a + '" dy="' + -f + 'em">' + c + "</tspan>" : s === "top" ? l += '<tspan x="' + a + '" dy="0.9em">' + c + "</tspan>" : s === "middle" ? l += '<tspan x="' + a + '" dy="' + -(f - 1) / 2 + 'em">' + c + "</tspan>" : s === "bottom" ? l += '<tspan x="' + a + '" dy="-' + (f + sS) + 'em">' + c + "</tspan>" : s === "hanging" && (l += '<tspan x="' + a + '" dy="' + (-(f - 1) - sS) + 'em">' + c + "</tspan>") : l += '<tspan x="' + a + '" dy="1em">' + c + "</tspan>";
      }), n.innerHTML = l;
    } else
      n.innerHTML = e;
  }, t;
}(Wi);
const oq = aq;
var sq = /^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i, uq = /^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i, fq = /[\d.]+:(#[^\s]+|[^)]+\))/gi;
function zR(r) {
  var t = r.match(fq);
  if (!t)
    return "";
  var e = "";
  return t.sort(function(n, i) {
    return n = n.split(":"), i = i.split(":"), Number(n[0]) - Number(i[0]);
  }), Se(t, function(n) {
    n = n.split(":"), e += '<stop offset="' + n[0] + '" stop-color="' + n[1] + '"></stop>';
  }), e;
}
function lq(r, t) {
  var e = sq.exec(r), n = Ip(Pp(parseFloat(e[1])), Math.PI * 2), i = e[2], a, o;
  n >= 0 && n < 0.5 * Math.PI ? (a = {
    x: 0,
    y: 0
  }, o = {
    x: 1,
    y: 1
  }) : 0.5 * Math.PI <= n && n < Math.PI ? (a = {
    x: 1,
    y: 0
  }, o = {
    x: 0,
    y: 1
  }) : Math.PI <= n && n < 1.5 * Math.PI ? (a = {
    x: 1,
    y: 1
  }, o = {
    x: 0,
    y: 0
  }) : (a = {
    x: 0,
    y: 1
  }, o = {
    x: 1,
    y: 0
  });
  var s = Math.tan(n), u = s * s, f = (o.x - a.x + s * (o.y - a.y)) / (u + 1) + a.x, l = s * (o.x - a.x + s * (o.y - a.y)) / (u + 1) + a.y;
  t.setAttribute("x1", a.x), t.setAttribute("y1", a.y), t.setAttribute("x2", f), t.setAttribute("y2", l), t.innerHTML = zR(i);
}
function cq(r, t) {
  var e = uq.exec(r), n = parseFloat(e[1]), i = parseFloat(e[2]), a = parseFloat(e[3]), o = e[4];
  t.setAttribute("cx", n), t.setAttribute("cy", i), t.setAttribute("r", a), t.innerHTML = zR(o);
}
var hq = function() {
  function r(t) {
    this.cfg = {};
    var e = null, n = ja("gradient_");
    return t.toLowerCase()[0] === "l" ? (e = Ui("linearGradient"), lq(t, e)) : (e = Ui("radialGradient"), cq(t, e)), e.setAttribute("id", n), this.el = e, this.id = n, this.cfg = t, this;
  }
  return r.prototype.match = function(t, e) {
    return this.cfg === e;
  }, r;
}(), dq = {
  shadowColor: "color",
  shadowOpacity: "opacity",
  shadowBlur: "blur",
  shadowOffsetX: "dx",
  shadowOffsetY: "dy"
}, vq = {
  x: "-40%",
  y: "-40%",
  width: "200%",
  height: "200%"
}, pq = function() {
  function r(t) {
    this.type = "filter", this.cfg = {}, this.type = "filter";
    var e = Ui("filter");
    return Se(vq, function(n, i) {
      e.setAttribute(i, n);
    }), this.el = e, this.id = ja("filter_"), this.el.id = this.id, this.cfg = t, this._parseShadow(t, e), this;
  }
  return r.prototype.match = function(t, e) {
    if (this.type !== t)
      return !1;
    var n = !0, i = this.cfg;
    return Se(Object.keys(i), function(a) {
      if (i[a] !== e[a])
        return n = !1, !1;
    }), n;
  }, r.prototype.update = function(t, e) {
    var n = this.cfg;
    return n[dq[t]] = e, this._parseShadow(n, this.el), this;
  }, r.prototype._parseShadow = function(t, e) {
    var n = `<feDropShadow
      dx="` + (t.dx || 0) + `"
      dy="` + (t.dy || 0) + `"
      stdDeviation="` + (t.blur ? t.blur / 10 : 0) + `"
      flood-color="` + (t.color ? t.color : "#000") + `"
      flood-opacity="` + (t.opacity ? t.opacity : 1) + `"
      />`;
    e.innerHTML = n;
  }, r;
}(), uS = function() {
  function r(t, e) {
    this.cfg = {};
    var n = Ui("marker"), i = ja("marker_");
    n.setAttribute("id", i);
    var a = Ui("path");
    a.setAttribute("stroke", t.stroke || "none"), a.setAttribute("fill", t.fill || "none"), n.appendChild(a), n.setAttribute("overflow", "visible"), n.setAttribute("orient", "auto-start-reverse"), this.el = n, this.child = a, this.id = i;
    var o = t[e === "marker-start" ? "startArrow" : "endArrow"];
    return this.stroke = t.stroke || "#000", o === !0 ? this._setDefaultPath(e, a) : (this.cfg = o, this._setMarker(t.lineWidth, a)), this;
  }
  return r.prototype.match = function() {
    return !1;
  }, r.prototype._setDefaultPath = function(t, e) {
    var n = this.el;
    e.setAttribute("d", "M0,0 L" + 10 * Math.cos(Math.PI / 6) + ",5 L0,10"), n.setAttribute("refX", "" + 10 * Math.cos(Math.PI / 6)), n.setAttribute("refY", "" + 5);
  }, r.prototype._setMarker = function(t, e) {
    var n = this.el, i = this.cfg.path, a = this.cfg.d;
    Dt(i) && (i = i.map(function(o) {
      return o.join(" ");
    }).join("")), e.setAttribute("d", i), n.appendChild(e), a && n.setAttribute("refX", "" + a / t);
  }, r.prototype.update = function(t) {
    var e = this.child;
    e.attr ? e.attr("fill", t) : e.setAttribute("fill", t);
  }, r;
}(), gq = function() {
  function r(t) {
    this.type = "clip", this.cfg = {};
    var e = Ui("clipPath");
    this.el = e, this.id = ja("clip_"), e.id = this.id;
    var n = t.cfg.el;
    return e.appendChild(n), this.cfg = t, this;
  }
  return r.prototype.match = function() {
    return !1;
  }, r.prototype.remove = function() {
    var t = this.el;
    t.parentNode.removeChild(t);
  }, r;
}(), yq = /^p\s*\(\s*([axyn])\s*\)\s*(.*)/i, mq = function() {
  function r(t) {
    this.cfg = {};
    var e = Ui("pattern");
    e.setAttribute("patternUnits", "userSpaceOnUse");
    var n = Ui("image");
    e.appendChild(n);
    var i = ja("pattern_");
    e.id = i, this.el = e, this.id = i, this.cfg = t;
    var a = yq.exec(t), o = a[2];
    n.setAttribute("href", o);
    var s = new Image();
    o.match(/^data:/i) || (s.crossOrigin = "Anonymous"), s.src = o;
    function u() {
      e.setAttribute("width", "" + s.width), e.setAttribute("height", "" + s.height);
    }
    return s.complete ? u() : (s.onload = u, s.src = s.src), this;
  }
  return r.prototype.match = function(t, e) {
    return this.cfg === e;
  }, r;
}(), bq = function() {
  function r(t) {
    var e = Ui("defs"), n = ja("defs_");
    e.id = n, t.appendChild(e), this.children = [], this.defaultArrow = {}, this.el = e, this.canvas = t;
  }
  return r.prototype.find = function(t, e) {
    for (var n = this.children, i = null, a = 0; a < n.length; a++)
      if (n[a].match(t, e)) {
        i = n[a].id;
        break;
      }
    return i;
  }, r.prototype.findById = function(t) {
    for (var e = this.children, n = null, i = 0; i < e.length; i++)
      if (e[i].id === t) {
        n = e[i];
        break;
      }
    return n;
  }, r.prototype.add = function(t) {
    this.children.push(t), t.canvas = this.canvas, t.parent = this;
  }, r.prototype.getDefaultArrow = function(t, e) {
    var n = t.stroke || t.strokeStyle;
    if (this.defaultArrow[n])
      return this.defaultArrow[n].id;
    var i = new uS(t, e);
    return this.defaultArrow[n] = i, this.el.appendChild(i.el), this.add(i), i.id;
  }, r.prototype.addGradient = function(t) {
    var e = new hq(t);
    return this.el.appendChild(e.el), this.add(e), e.id;
  }, r.prototype.addArrow = function(t, e) {
    var n = new uS(t, e);
    return this.el.appendChild(n.el), this.add(n), n.id;
  }, r.prototype.addShadow = function(t) {
    var e = new pq(t);
    return this.el.appendChild(e.el), this.add(e), e.id;
  }, r.prototype.addPattern = function(t) {
    var e = new mq(t);
    return this.el.appendChild(e.el), this.add(e), e.id;
  }, r.prototype.addClip = function(t) {
    var e = new gq(t);
    return this.el.appendChild(e.el), this.add(e), e.id;
  }, r;
}(), gc = function(r) {
  Ht(t, r);
  function t(e) {
    return r.call(this, U(U({}, e), {
      autoDraw: !0,
      renderer: "svg"
    })) || this;
  }
  return t.prototype.getShapeBase = function() {
    return z1;
  }, t.prototype.getGroupBase = function() {
    return FR;
  }, t.prototype.getShape = function(e, n, i) {
    var a = i.target || i.srcElement;
    if (!Fm[a.tagName]) {
      for (var o = a.parentNode; o && !Fm[o.tagName]; )
        o = o.parentNode;
      a = o;
    }
    return this.find(function(s) {
      return s.get("el") === a;
    });
  }, t.prototype.createDom = function() {
    var e = Ui("svg"), n = new bq(e);
    return e.setAttribute("width", "" + this.get("width")), e.setAttribute("height", "" + this.get("height")), this.set("context", n), e;
  }, t.prototype.onCanvasChange = function(e) {
    var n = this.get("context"), i = this.get("el");
    if (e === "sort") {
      var a = this.get("children");
      a && a.length && RR(this, function(s, u) {
        return a.indexOf(s) - a.indexOf(u) ? 1 : 0;
      });
    } else if (e === "clear") {
      if (i) {
        i.innerHTML = "";
        var o = n.el;
        o.innerHTML = "", i.appendChild(o);
      }
    } else
      e === "matrix" ? ah(this) : e === "clip" ? zc(this, n) : e === "changeSize" && (i.setAttribute("width", "" + this.get("width")), i.setAttribute("height", "" + this.get("height")));
  }, t.prototype.draw = function() {
    var e = this.get("context"), n = this.getChildren();
    zc(this, e), n.length && BR(e, n);
  }, t;
}(uN), UR = { exports: {} }, xq = {
  aliceblue: [240, 248, 255],
  antiquewhite: [250, 235, 215],
  aqua: [0, 255, 255],
  aquamarine: [127, 255, 212],
  azure: [240, 255, 255],
  beige: [245, 245, 220],
  bisque: [255, 228, 196],
  black: [0, 0, 0],
  blanchedalmond: [255, 235, 205],
  blue: [0, 0, 255],
  blueviolet: [138, 43, 226],
  brown: [165, 42, 42],
  burlywood: [222, 184, 135],
  cadetblue: [95, 158, 160],
  chartreuse: [127, 255, 0],
  chocolate: [210, 105, 30],
  coral: [255, 127, 80],
  cornflowerblue: [100, 149, 237],
  cornsilk: [255, 248, 220],
  crimson: [220, 20, 60],
  cyan: [0, 255, 255],
  darkblue: [0, 0, 139],
  darkcyan: [0, 139, 139],
  darkgoldenrod: [184, 134, 11],
  darkgray: [169, 169, 169],
  darkgreen: [0, 100, 0],
  darkgrey: [169, 169, 169],
  darkkhaki: [189, 183, 107],
  darkmagenta: [139, 0, 139],
  darkolivegreen: [85, 107, 47],
  darkorange: [255, 140, 0],
  darkorchid: [153, 50, 204],
  darkred: [139, 0, 0],
  darksalmon: [233, 150, 122],
  darkseagreen: [143, 188, 143],
  darkslateblue: [72, 61, 139],
  darkslategray: [47, 79, 79],
  darkslategrey: [47, 79, 79],
  darkturquoise: [0, 206, 209],
  darkviolet: [148, 0, 211],
  deeppink: [255, 20, 147],
  deepskyblue: [0, 191, 255],
  dimgray: [105, 105, 105],
  dimgrey: [105, 105, 105],
  dodgerblue: [30, 144, 255],
  firebrick: [178, 34, 34],
  floralwhite: [255, 250, 240],
  forestgreen: [34, 139, 34],
  fuchsia: [255, 0, 255],
  gainsboro: [220, 220, 220],
  ghostwhite: [248, 248, 255],
  gold: [255, 215, 0],
  goldenrod: [218, 165, 32],
  gray: [128, 128, 128],
  green: [0, 128, 0],
  greenyellow: [173, 255, 47],
  grey: [128, 128, 128],
  honeydew: [240, 255, 240],
  hotpink: [255, 105, 180],
  indianred: [205, 92, 92],
  indigo: [75, 0, 130],
  ivory: [255, 255, 240],
  khaki: [240, 230, 140],
  lavender: [230, 230, 250],
  lavenderblush: [255, 240, 245],
  lawngreen: [124, 252, 0],
  lemonchiffon: [255, 250, 205],
  lightblue: [173, 216, 230],
  lightcoral: [240, 128, 128],
  lightcyan: [224, 255, 255],
  lightgoldenrodyellow: [250, 250, 210],
  lightgray: [211, 211, 211],
  lightgreen: [144, 238, 144],
  lightgrey: [211, 211, 211],
  lightpink: [255, 182, 193],
  lightsalmon: [255, 160, 122],
  lightseagreen: [32, 178, 170],
  lightskyblue: [135, 206, 250],
  lightslategray: [119, 136, 153],
  lightslategrey: [119, 136, 153],
  lightsteelblue: [176, 196, 222],
  lightyellow: [255, 255, 224],
  lime: [0, 255, 0],
  limegreen: [50, 205, 50],
  linen: [250, 240, 230],
  magenta: [255, 0, 255],
  maroon: [128, 0, 0],
  mediumaquamarine: [102, 205, 170],
  mediumblue: [0, 0, 205],
  mediumorchid: [186, 85, 211],
  mediumpurple: [147, 112, 219],
  mediumseagreen: [60, 179, 113],
  mediumslateblue: [123, 104, 238],
  mediumspringgreen: [0, 250, 154],
  mediumturquoise: [72, 209, 204],
  mediumvioletred: [199, 21, 133],
  midnightblue: [25, 25, 112],
  mintcream: [245, 255, 250],
  mistyrose: [255, 228, 225],
  moccasin: [255, 228, 181],
  navajowhite: [255, 222, 173],
  navy: [0, 0, 128],
  oldlace: [253, 245, 230],
  olive: [128, 128, 0],
  olivedrab: [107, 142, 35],
  orange: [255, 165, 0],
  orangered: [255, 69, 0],
  orchid: [218, 112, 214],
  palegoldenrod: [238, 232, 170],
  palegreen: [152, 251, 152],
  paleturquoise: [175, 238, 238],
  palevioletred: [219, 112, 147],
  papayawhip: [255, 239, 213],
  peachpuff: [255, 218, 185],
  peru: [205, 133, 63],
  pink: [255, 192, 203],
  plum: [221, 160, 221],
  powderblue: [176, 224, 230],
  purple: [128, 0, 128],
  rebeccapurple: [102, 51, 153],
  red: [255, 0, 0],
  rosybrown: [188, 143, 143],
  royalblue: [65, 105, 225],
  saddlebrown: [139, 69, 19],
  salmon: [250, 128, 114],
  sandybrown: [244, 164, 96],
  seagreen: [46, 139, 87],
  seashell: [255, 245, 238],
  sienna: [160, 82, 45],
  silver: [192, 192, 192],
  skyblue: [135, 206, 235],
  slateblue: [106, 90, 205],
  slategray: [112, 128, 144],
  slategrey: [112, 128, 144],
  snow: [255, 250, 250],
  springgreen: [0, 255, 127],
  steelblue: [70, 130, 180],
  tan: [210, 180, 140],
  teal: [0, 128, 128],
  thistle: [216, 191, 216],
  tomato: [255, 99, 71],
  turquoise: [64, 224, 208],
  violet: [238, 130, 238],
  wheat: [245, 222, 179],
  white: [255, 255, 255],
  whitesmoke: [245, 245, 245],
  yellow: [255, 255, 0],
  yellowgreen: [154, 205, 50]
}, jR = { exports: {} }, _q = function(t) {
  return !t || typeof t == "string" ? !1 : t instanceof Array || Array.isArray(t) || t.length >= 0 && (t.splice instanceof Function || Object.getOwnPropertyDescriptor(t, t.length - 1) && t.constructor.name !== "String");
}, wq = _q, Eq = Array.prototype.concat, Sq = Array.prototype.slice, fS = jR.exports = function(t) {
  for (var e = [], n = 0, i = t.length; n < i; n++) {
    var a = t[n];
    wq(a) ? e = Eq.call(e, Sq.call(a)) : e.push(a);
  }
  return e;
};
fS.wrap = function(r) {
  return function() {
    return r(fS(arguments));
  };
};
var yc = xq, oh = jR.exports, $R = Object.hasOwnProperty, WR = /* @__PURE__ */ Object.create(null);
for (var K0 in yc)
  $R.call(yc, K0) && (WR[yc[K0]] = K0);
var Ei = UR.exports = {
  to: {},
  get: {}
};
Ei.get = function(r) {
  var t = r.substring(0, 3).toLowerCase(), e, n;
  switch (t) {
    case "hsl":
      e = Ei.get.hsl(r), n = "hsl";
      break;
    case "hwb":
      e = Ei.get.hwb(r), n = "hwb";
      break;
    default:
      e = Ei.get.rgb(r), n = "rgb";
      break;
  }
  return e ? { model: n, value: e } : null;
};
Ei.get.rgb = function(r) {
  if (!r)
    return null;
  var t = /^#([a-f0-9]{3,4})$/i, e = /^#([a-f0-9]{6})([a-f0-9]{2})?$/i, n = /^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/, i = /^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/, a = /^(\w+)$/, o = [0, 0, 0, 1], s, u, f;
  if (s = r.match(e)) {
    for (f = s[2], s = s[1], u = 0; u < 3; u++) {
      var l = u * 2;
      o[u] = parseInt(s.slice(l, l + 2), 16);
    }
    f && (o[3] = parseInt(f, 16) / 255);
  } else if (s = r.match(t)) {
    for (s = s[1], f = s[3], u = 0; u < 3; u++)
      o[u] = parseInt(s[u] + s[u], 16);
    f && (o[3] = parseInt(f + f, 16) / 255);
  } else if (s = r.match(n)) {
    for (u = 0; u < 3; u++)
      o[u] = parseInt(s[u + 1], 0);
    s[4] && (s[5] ? o[3] = parseFloat(s[4]) * 0.01 : o[3] = parseFloat(s[4]));
  } else if (s = r.match(i)) {
    for (u = 0; u < 3; u++)
      o[u] = Math.round(parseFloat(s[u + 1]) * 2.55);
    s[4] && (s[5] ? o[3] = parseFloat(s[4]) * 0.01 : o[3] = parseFloat(s[4]));
  } else
    return (s = r.match(a)) ? s[1] === "transparent" ? [0, 0, 0, 0] : $R.call(yc, s[1]) ? (o = yc[s[1]], o[3] = 1, o) : null : null;
  for (u = 0; u < 3; u++)
    o[u] = fs(o[u], 0, 255);
  return o[3] = fs(o[3], 0, 1), o;
};
Ei.get.hsl = function(r) {
  if (!r)
    return null;
  var t = /^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/, e = r.match(t);
  if (e) {
    var n = parseFloat(e[4]), i = (parseFloat(e[1]) % 360 + 360) % 360, a = fs(parseFloat(e[2]), 0, 100), o = fs(parseFloat(e[3]), 0, 100), s = fs(isNaN(n) ? 1 : n, 0, 1);
    return [i, a, o, s];
  }
  return null;
};
Ei.get.hwb = function(r) {
  if (!r)
    return null;
  var t = /^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/, e = r.match(t);
  if (e) {
    var n = parseFloat(e[4]), i = (parseFloat(e[1]) % 360 + 360) % 360, a = fs(parseFloat(e[2]), 0, 100), o = fs(parseFloat(e[3]), 0, 100), s = fs(isNaN(n) ? 1 : n, 0, 1);
    return [i, a, o, s];
  }
  return null;
};
Ei.to.hex = function() {
  var r = oh(arguments);
  return "#" + Ad(r[0]) + Ad(r[1]) + Ad(r[2]) + (r[3] < 1 ? Ad(Math.round(r[3] * 255)) : "");
};
Ei.to.rgb = function() {
  var r = oh(arguments);
  return r.length < 4 || r[3] === 1 ? "rgb(" + Math.round(r[0]) + ", " + Math.round(r[1]) + ", " + Math.round(r[2]) + ")" : "rgba(" + Math.round(r[0]) + ", " + Math.round(r[1]) + ", " + Math.round(r[2]) + ", " + r[3] + ")";
};
Ei.to.rgb.percent = function() {
  var r = oh(arguments), t = Math.round(r[0] / 255 * 100), e = Math.round(r[1] / 255 * 100), n = Math.round(r[2] / 255 * 100);
  return r.length < 4 || r[3] === 1 ? "rgb(" + t + "%, " + e + "%, " + n + "%)" : "rgba(" + t + "%, " + e + "%, " + n + "%, " + r[3] + ")";
};
Ei.to.hsl = function() {
  var r = oh(arguments);
  return r.length < 4 || r[3] === 1 ? "hsl(" + r[0] + ", " + r[1] + "%, " + r[2] + "%)" : "hsla(" + r[0] + ", " + r[1] + "%, " + r[2] + "%, " + r[3] + ")";
};
Ei.to.hwb = function() {
  var r = oh(arguments), t = "";
  return r.length >= 4 && r[3] !== 1 && (t = ", " + r[3]), "hwb(" + r[0] + ", " + r[1] + "%, " + r[2] + "%" + t + ")";
};
Ei.to.keyword = function(r) {
  return WR[r.slice(0, 3)];
};
function fs(r, t, e) {
  return Math.min(Math.max(t, r), e);
}
function Ad(r) {
  var t = Math.round(r).toString(16).toUpperCase();
  return t.length < 2 ? "0" + t : t;
}
var Gb = { exports: {} }, Mq = {
  aliceblue: [240, 248, 255],
  antiquewhite: [250, 235, 215],
  aqua: [0, 255, 255],
  aquamarine: [127, 255, 212],
  azure: [240, 255, 255],
  beige: [245, 245, 220],
  bisque: [255, 228, 196],
  black: [0, 0, 0],
  blanchedalmond: [255, 235, 205],
  blue: [0, 0, 255],
  blueviolet: [138, 43, 226],
  brown: [165, 42, 42],
  burlywood: [222, 184, 135],
  cadetblue: [95, 158, 160],
  chartreuse: [127, 255, 0],
  chocolate: [210, 105, 30],
  coral: [255, 127, 80],
  cornflowerblue: [100, 149, 237],
  cornsilk: [255, 248, 220],
  crimson: [220, 20, 60],
  cyan: [0, 255, 255],
  darkblue: [0, 0, 139],
  darkcyan: [0, 139, 139],
  darkgoldenrod: [184, 134, 11],
  darkgray: [169, 169, 169],
  darkgreen: [0, 100, 0],
  darkgrey: [169, 169, 169],
  darkkhaki: [189, 183, 107],
  darkmagenta: [139, 0, 139],
  darkolivegreen: [85, 107, 47],
  darkorange: [255, 140, 0],
  darkorchid: [153, 50, 204],
  darkred: [139, 0, 0],
  darksalmon: [233, 150, 122],
  darkseagreen: [143, 188, 143],
  darkslateblue: [72, 61, 139],
  darkslategray: [47, 79, 79],
  darkslategrey: [47, 79, 79],
  darkturquoise: [0, 206, 209],
  darkviolet: [148, 0, 211],
  deeppink: [255, 20, 147],
  deepskyblue: [0, 191, 255],
  dimgray: [105, 105, 105],
  dimgrey: [105, 105, 105],
  dodgerblue: [30, 144, 255],
  firebrick: [178, 34, 34],
  floralwhite: [255, 250, 240],
  forestgreen: [34, 139, 34],
  fuchsia: [255, 0, 255],
  gainsboro: [220, 220, 220],
  ghostwhite: [248, 248, 255],
  gold: [255, 215, 0],
  goldenrod: [218, 165, 32],
  gray: [128, 128, 128],
  green: [0, 128, 0],
  greenyellow: [173, 255, 47],
  grey: [128, 128, 128],
  honeydew: [240, 255, 240],
  hotpink: [255, 105, 180],
  indianred: [205, 92, 92],
  indigo: [75, 0, 130],
  ivory: [255, 255, 240],
  khaki: [240, 230, 140],
  lavender: [230, 230, 250],
  lavenderblush: [255, 240, 245],
  lawngreen: [124, 252, 0],
  lemonchiffon: [255, 250, 205],
  lightblue: [173, 216, 230],
  lightcoral: [240, 128, 128],
  lightcyan: [224, 255, 255],
  lightgoldenrodyellow: [250, 250, 210],
  lightgray: [211, 211, 211],
  lightgreen: [144, 238, 144],
  lightgrey: [211, 211, 211],
  lightpink: [255, 182, 193],
  lightsalmon: [255, 160, 122],
  lightseagreen: [32, 178, 170],
  lightskyblue: [135, 206, 250],
  lightslategray: [119, 136, 153],
  lightslategrey: [119, 136, 153],
  lightsteelblue: [176, 196, 222],
  lightyellow: [255, 255, 224],
  lime: [0, 255, 0],
  limegreen: [50, 205, 50],
  linen: [250, 240, 230],
  magenta: [255, 0, 255],
  maroon: [128, 0, 0],
  mediumaquamarine: [102, 205, 170],
  mediumblue: [0, 0, 205],
  mediumorchid: [186, 85, 211],
  mediumpurple: [147, 112, 219],
  mediumseagreen: [60, 179, 113],
  mediumslateblue: [123, 104, 238],
  mediumspringgreen: [0, 250, 154],
  mediumturquoise: [72, 209, 204],
  mediumvioletred: [199, 21, 133],
  midnightblue: [25, 25, 112],
  mintcream: [245, 255, 250],
  mistyrose: [255, 228, 225],
  moccasin: [255, 228, 181],
  navajowhite: [255, 222, 173],
  navy: [0, 0, 128],
  oldlace: [253, 245, 230],
  olive: [128, 128, 0],
  olivedrab: [107, 142, 35],
  orange: [255, 165, 0],
  orangered: [255, 69, 0],
  orchid: [218, 112, 214],
  palegoldenrod: [238, 232, 170],
  palegreen: [152, 251, 152],
  paleturquoise: [175, 238, 238],
  palevioletred: [219, 112, 147],
  papayawhip: [255, 239, 213],
  peachpuff: [255, 218, 185],
  peru: [205, 133, 63],
  pink: [255, 192, 203],
  plum: [221, 160, 221],
  powderblue: [176, 224, 230],
  purple: [128, 0, 128],
  rebeccapurple: [102, 51, 153],
  red: [255, 0, 0],
  rosybrown: [188, 143, 143],
  royalblue: [65, 105, 225],
  saddlebrown: [139, 69, 19],
  salmon: [250, 128, 114],
  sandybrown: [244, 164, 96],
  seagreen: [46, 139, 87],
  seashell: [255, 245, 238],
  sienna: [160, 82, 45],
  silver: [192, 192, 192],
  skyblue: [135, 206, 235],
  slateblue: [106, 90, 205],
  slategray: [112, 128, 144],
  slategrey: [112, 128, 144],
  snow: [255, 250, 250],
  springgreen: [0, 255, 127],
  steelblue: [70, 130, 180],
  tan: [210, 180, 140],
  teal: [0, 128, 128],
  thistle: [216, 191, 216],
  tomato: [255, 99, 71],
  turquoise: [64, 224, 208],
  violet: [238, 130, 238],
  wheat: [245, 222, 179],
  white: [255, 255, 255],
  whitesmoke: [245, 245, 245],
  yellow: [255, 255, 0],
  yellowgreen: [154, 205, 50]
}, fu = Mq, VR = {};
for (var q0 in fu)
  fu.hasOwnProperty(q0) && (VR[fu[q0]] = q0);
var Gt = Gb.exports = {
  rgb: { channels: 3, labels: "rgb" },
  hsl: { channels: 3, labels: "hsl" },
  hsv: { channels: 3, labels: "hsv" },
  hwb: { channels: 3, labels: "hwb" },
  cmyk: { channels: 4, labels: "cmyk" },
  xyz: { channels: 3, labels: "xyz" },
  lab: { channels: 3, labels: "lab" },
  lch: { channels: 3, labels: "lch" },
  hex: { channels: 1, labels: ["hex"] },
  keyword: { channels: 1, labels: ["keyword"] },
  ansi16: { channels: 1, labels: ["ansi16"] },
  ansi256: { channels: 1, labels: ["ansi256"] },
  hcg: { channels: 3, labels: ["h", "c", "g"] },
  apple: { channels: 3, labels: ["r16", "g16", "b16"] },
  gray: { channels: 1, labels: ["gray"] }
};
for (var ni in Gt)
  if (Gt.hasOwnProperty(ni)) {
    if (!("channels" in Gt[ni]))
      throw new Error("missing channels property: " + ni);
    if (!("labels" in Gt[ni]))
      throw new Error("missing channel labels property: " + ni);
    if (Gt[ni].labels.length !== Gt[ni].channels)
      throw new Error("channel and label counts mismatch: " + ni);
    var Cq = Gt[ni].channels, Tq = Gt[ni].labels;
    delete Gt[ni].channels, delete Gt[ni].labels, Object.defineProperty(Gt[ni], "channels", { value: Cq }), Object.defineProperty(Gt[ni], "labels", { value: Tq });
  }
Gt.rgb.hsl = function(r) {
  var t = r[0] / 255, e = r[1] / 255, n = r[2] / 255, i = Math.min(t, e, n), a = Math.max(t, e, n), o = a - i, s, u, f;
  return a === i ? s = 0 : t === a ? s = (e - n) / o : e === a ? s = 2 + (n - t) / o : n === a && (s = 4 + (t - e) / o), s = Math.min(s * 60, 360), s < 0 && (s += 360), f = (i + a) / 2, a === i ? u = 0 : f <= 0.5 ? u = o / (a + i) : u = o / (2 - a - i), [s, u * 100, f * 100];
};
Gt.rgb.hsv = function(r) {
  var t, e, n, i, a, o = r[0] / 255, s = r[1] / 255, u = r[2] / 255, f = Math.max(o, s, u), l = f - Math.min(o, s, u), c = function(h) {
    return (f - h) / 6 / l + 1 / 2;
  };
  return l === 0 ? i = a = 0 : (a = l / f, t = c(o), e = c(s), n = c(u), o === f ? i = n - e : s === f ? i = 1 / 3 + t - n : u === f && (i = 2 / 3 + e - t), i < 0 ? i += 1 : i > 1 && (i -= 1)), [
    i * 360,
    a * 100,
    f * 100
  ];
};
Gt.rgb.hwb = function(r) {
  var t = r[0], e = r[1], n = r[2], i = Gt.rgb.hsl(r)[0], a = 1 / 255 * Math.min(t, Math.min(e, n));
  return n = 1 - 1 / 255 * Math.max(t, Math.max(e, n)), [i, a * 100, n * 100];
};
Gt.rgb.cmyk = function(r) {
  var t = r[0] / 255, e = r[1] / 255, n = r[2] / 255, i, a, o, s;
  return s = Math.min(1 - t, 1 - e, 1 - n), i = (1 - t - s) / (1 - s) || 0, a = (1 - e - s) / (1 - s) || 0, o = (1 - n - s) / (1 - s) || 0, [i * 100, a * 100, o * 100, s * 100];
};
function Aq(r, t) {
  return Math.pow(r[0] - t[0], 2) + Math.pow(r[1] - t[1], 2) + Math.pow(r[2] - t[2], 2);
}
Gt.rgb.keyword = function(r) {
  var t = VR[r];
  if (t)
    return t;
  var e = 1 / 0, n;
  for (var i in fu)
    if (fu.hasOwnProperty(i)) {
      var a = fu[i], o = Aq(r, a);
      o < e && (e = o, n = i);
    }
  return n;
};
Gt.keyword.rgb = function(r) {
  return fu[r];
};
Gt.rgb.xyz = function(r) {
  var t = r[0] / 255, e = r[1] / 255, n = r[2] / 255;
  t = t > 0.04045 ? Math.pow((t + 0.055) / 1.055, 2.4) : t / 12.92, e = e > 0.04045 ? Math.pow((e + 0.055) / 1.055, 2.4) : e / 12.92, n = n > 0.04045 ? Math.pow((n + 0.055) / 1.055, 2.4) : n / 12.92;
  var i = t * 0.4124 + e * 0.3576 + n * 0.1805, a = t * 0.2126 + e * 0.7152 + n * 0.0722, o = t * 0.0193 + e * 0.1192 + n * 0.9505;
  return [i * 100, a * 100, o * 100];
};
Gt.rgb.lab = function(r) {
  var t = Gt.rgb.xyz(r), e = t[0], n = t[1], i = t[2], a, o, s;
  return e /= 95.047, n /= 100, i /= 108.883, e = e > 8856e-6 ? Math.pow(e, 1 / 3) : 7.787 * e + 16 / 116, n = n > 8856e-6 ? Math.pow(n, 1 / 3) : 7.787 * n + 16 / 116, i = i > 8856e-6 ? Math.pow(i, 1 / 3) : 7.787 * i + 16 / 116, a = 116 * n - 16, o = 500 * (e - n), s = 200 * (n - i), [a, o, s];
};
Gt.hsl.rgb = function(r) {
  var t = r[0] / 360, e = r[1] / 100, n = r[2] / 100, i, a, o, s, u;
  if (e === 0)
    return u = n * 255, [u, u, u];
  n < 0.5 ? a = n * (1 + e) : a = n + e - n * e, i = 2 * n - a, s = [0, 0, 0];
  for (var f = 0; f < 3; f++)
    o = t + 1 / 3 * -(f - 1), o < 0 && o++, o > 1 && o--, 6 * o < 1 ? u = i + (a - i) * 6 * o : 2 * o < 1 ? u = a : 3 * o < 2 ? u = i + (a - i) * (2 / 3 - o) * 6 : u = i, s[f] = u * 255;
  return s;
};
Gt.hsl.hsv = function(r) {
  var t = r[0], e = r[1] / 100, n = r[2] / 100, i = e, a = Math.max(n, 0.01), o, s;
  return n *= 2, e *= n <= 1 ? n : 2 - n, i *= a <= 1 ? a : 2 - a, s = (n + e) / 2, o = n === 0 ? 2 * i / (a + i) : 2 * e / (n + e), [t, o * 100, s * 100];
};
Gt.hsv.rgb = function(r) {
  var t = r[0] / 60, e = r[1] / 100, n = r[2] / 100, i = Math.floor(t) % 6, a = t - Math.floor(t), o = 255 * n * (1 - e), s = 255 * n * (1 - e * a), u = 255 * n * (1 - e * (1 - a));
  switch (n *= 255, i) {
    case 0:
      return [n, u, o];
    case 1:
      return [s, n, o];
    case 2:
      return [o, n, u];
    case 3:
      return [o, s, n];
    case 4:
      return [u, o, n];
    case 5:
      return [n, o, s];
  }
};
Gt.hsv.hsl = function(r) {
  var t = r[0], e = r[1] / 100, n = r[2] / 100, i = Math.max(n, 0.01), a, o, s;
  return s = (2 - e) * n, a = (2 - e) * i, o = e * i, o /= a <= 1 ? a : 2 - a, o = o || 0, s /= 2, [t, o * 100, s * 100];
};
Gt.hwb.rgb = function(r) {
  var t = r[0] / 360, e = r[1] / 100, n = r[2] / 100, i = e + n, a, o, s, u;
  i > 1 && (e /= i, n /= i), a = Math.floor(6 * t), o = 1 - n, s = 6 * t - a, (a & 1) !== 0 && (s = 1 - s), u = e + s * (o - e);
  var f, l, c;
  switch (a) {
    default:
    case 6:
    case 0:
      f = o, l = u, c = e;
      break;
    case 1:
      f = u, l = o, c = e;
      break;
    case 2:
      f = e, l = o, c = u;
      break;
    case 3:
      f = e, l = u, c = o;
      break;
    case 4:
      f = u, l = e, c = o;
      break;
    case 5:
      f = o, l = e, c = u;
      break;
  }
  return [f * 255, l * 255, c * 255];
};
Gt.cmyk.rgb = function(r) {
  var t = r[0] / 100, e = r[1] / 100, n = r[2] / 100, i = r[3] / 100, a, o, s;
  return a = 1 - Math.min(1, t * (1 - i) + i), o = 1 - Math.min(1, e * (1 - i) + i), s = 1 - Math.min(1, n * (1 - i) + i), [a * 255, o * 255, s * 255];
};
Gt.xyz.rgb = function(r) {
  var t = r[0] / 100, e = r[1] / 100, n = r[2] / 100, i, a, o;
  return i = t * 3.2406 + e * -1.5372 + n * -0.4986, a = t * -0.9689 + e * 1.8758 + n * 0.0415, o = t * 0.0557 + e * -0.204 + n * 1.057, i = i > 31308e-7 ? 1.055 * Math.pow(i, 1 / 2.4) - 0.055 : i * 12.92, a = a > 31308e-7 ? 1.055 * Math.pow(a, 1 / 2.4) - 0.055 : a * 12.92, o = o > 31308e-7 ? 1.055 * Math.pow(o, 1 / 2.4) - 0.055 : o * 12.92, i = Math.min(Math.max(0, i), 1), a = Math.min(Math.max(0, a), 1), o = Math.min(Math.max(0, o), 1), [i * 255, a * 255, o * 255];
};
Gt.xyz.lab = function(r) {
  var t = r[0], e = r[1], n = r[2], i, a, o;
  return t /= 95.047, e /= 100, n /= 108.883, t = t > 8856e-6 ? Math.pow(t, 1 / 3) : 7.787 * t + 16 / 116, e = e > 8856e-6 ? Math.pow(e, 1 / 3) : 7.787 * e + 16 / 116, n = n > 8856e-6 ? Math.pow(n, 1 / 3) : 7.787 * n + 16 / 116, i = 116 * e - 16, a = 500 * (t - e), o = 200 * (e - n), [i, a, o];
};
Gt.lab.xyz = function(r) {
  var t = r[0], e = r[1], n = r[2], i, a, o;
  a = (t + 16) / 116, i = e / 500 + a, o = a - n / 200;
  var s = Math.pow(a, 3), u = Math.pow(i, 3), f = Math.pow(o, 3);
  return a = s > 8856e-6 ? s : (a - 16 / 116) / 7.787, i = u > 8856e-6 ? u : (i - 16 / 116) / 7.787, o = f > 8856e-6 ? f : (o - 16 / 116) / 7.787, i *= 95.047, a *= 100, o *= 108.883, [i, a, o];
};
Gt.lab.lch = function(r) {
  var t = r[0], e = r[1], n = r[2], i, a, o;
  return i = Math.atan2(n, e), a = i * 360 / 2 / Math.PI, a < 0 && (a += 360), o = Math.sqrt(e * e + n * n), [t, o, a];
};
Gt.lch.lab = function(r) {
  var t = r[0], e = r[1], n = r[2], i, a, o;
  return o = n / 360 * 2 * Math.PI, i = e * Math.cos(o), a = e * Math.sin(o), [t, i, a];
};
Gt.rgb.ansi16 = function(r) {
  var t = r[0], e = r[1], n = r[2], i = 1 in arguments ? arguments[1] : Gt.rgb.hsv(r)[2];
  if (i = Math.round(i / 50), i === 0)
    return 30;
  var a = 30 + (Math.round(n / 255) << 2 | Math.round(e / 255) << 1 | Math.round(t / 255));
  return i === 2 && (a += 60), a;
};
Gt.hsv.ansi16 = function(r) {
  return Gt.rgb.ansi16(Gt.hsv.rgb(r), r[2]);
};
Gt.rgb.ansi256 = function(r) {
  var t = r[0], e = r[1], n = r[2];
  if (t === e && e === n)
    return t < 8 ? 16 : t > 248 ? 231 : Math.round((t - 8) / 247 * 24) + 232;
  var i = 16 + 36 * Math.round(t / 255 * 5) + 6 * Math.round(e / 255 * 5) + Math.round(n / 255 * 5);
  return i;
};
Gt.ansi16.rgb = function(r) {
  var t = r % 10;
  if (t === 0 || t === 7)
    return r > 50 && (t += 3.5), t = t / 10.5 * 255, [t, t, t];
  var e = (~~(r > 50) + 1) * 0.5, n = (t & 1) * e * 255, i = (t >> 1 & 1) * e * 255, a = (t >> 2 & 1) * e * 255;
  return [n, i, a];
};
Gt.ansi256.rgb = function(r) {
  if (r >= 232) {
    var t = (r - 232) * 10 + 8;
    return [t, t, t];
  }
  r -= 16;
  var e, n = Math.floor(r / 36) / 5 * 255, i = Math.floor((e = r % 36) / 6) / 5 * 255, a = e % 6 / 5 * 255;
  return [n, i, a];
};
Gt.rgb.hex = function(r) {
  var t = ((Math.round(r[0]) & 255) << 16) + ((Math.round(r[1]) & 255) << 8) + (Math.round(r[2]) & 255), e = t.toString(16).toUpperCase();
  return "000000".substring(e.length) + e;
};
Gt.hex.rgb = function(r) {
  var t = r.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);
  if (!t)
    return [0, 0, 0];
  var e = t[0];
  t[0].length === 3 && (e = e.split("").map(function(s) {
    return s + s;
  }).join(""));
  var n = parseInt(e, 16), i = n >> 16 & 255, a = n >> 8 & 255, o = n & 255;
  return [i, a, o];
};
Gt.rgb.hcg = function(r) {
  var t = r[0] / 255, e = r[1] / 255, n = r[2] / 255, i = Math.max(Math.max(t, e), n), a = Math.min(Math.min(t, e), n), o = i - a, s, u;
  return o < 1 ? s = a / (1 - o) : s = 0, o <= 0 ? u = 0 : i === t ? u = (e - n) / o % 6 : i === e ? u = 2 + (n - t) / o : u = 4 + (t - e) / o + 4, u /= 6, u %= 1, [u * 360, o * 100, s * 100];
};
Gt.hsl.hcg = function(r) {
  var t = r[1] / 100, e = r[2] / 100, n = 1, i = 0;
  return e < 0.5 ? n = 2 * t * e : n = 2 * t * (1 - e), n < 1 && (i = (e - 0.5 * n) / (1 - n)), [r[0], n * 100, i * 100];
};
Gt.hsv.hcg = function(r) {
  var t = r[1] / 100, e = r[2] / 100, n = t * e, i = 0;
  return n < 1 && (i = (e - n) / (1 - n)), [r[0], n * 100, i * 100];
};
Gt.hcg.rgb = function(r) {
  var t = r[0] / 360, e = r[1] / 100, n = r[2] / 100;
  if (e === 0)
    return [n * 255, n * 255, n * 255];
  var i = [0, 0, 0], a = t % 1 * 6, o = a % 1, s = 1 - o, u = 0;
  switch (Math.floor(a)) {
    case 0:
      i[0] = 1, i[1] = o, i[2] = 0;
      break;
    case 1:
      i[0] = s, i[1] = 1, i[2] = 0;
      break;
    case 2:
      i[0] = 0, i[1] = 1, i[2] = o;
      break;
    case 3:
      i[0] = 0, i[1] = s, i[2] = 1;
      break;
    case 4:
      i[0] = o, i[1] = 0, i[2] = 1;
      break;
    default:
      i[0] = 1, i[1] = 0, i[2] = s;
  }
  return u = (1 - e) * n, [
    (e * i[0] + u) * 255,
    (e * i[1] + u) * 255,
    (e * i[2] + u) * 255
  ];
};
Gt.hcg.hsv = function(r) {
  var t = r[1] / 100, e = r[2] / 100, n = t + e * (1 - t), i = 0;
  return n > 0 && (i = t / n), [r[0], i * 100, n * 100];
};
Gt.hcg.hsl = function(r) {
  var t = r[1] / 100, e = r[2] / 100, n = e * (1 - t) + 0.5 * t, i = 0;
  return n > 0 && n < 0.5 ? i = t / (2 * n) : n >= 0.5 && n < 1 && (i = t / (2 * (1 - n))), [r[0], i * 100, n * 100];
};
Gt.hcg.hwb = function(r) {
  var t = r[1] / 100, e = r[2] / 100, n = t + e * (1 - t);
  return [r[0], (n - t) * 100, (1 - n) * 100];
};
Gt.hwb.hcg = function(r) {
  var t = r[1] / 100, e = r[2] / 100, n = 1 - e, i = n - t, a = 0;
  return i < 1 && (a = (n - i) / (1 - i)), [r[0], i * 100, a * 100];
};
Gt.apple.rgb = function(r) {
  return [r[0] / 65535 * 255, r[1] / 65535 * 255, r[2] / 65535 * 255];
};
Gt.rgb.apple = function(r) {
  return [r[0] / 255 * 65535, r[1] / 255 * 65535, r[2] / 255 * 65535];
};
Gt.gray.rgb = function(r) {
  return [r[0] / 100 * 255, r[0] / 100 * 255, r[0] / 100 * 255];
};
Gt.gray.hsl = Gt.gray.hsv = function(r) {
  return [0, 0, r[0]];
};
Gt.gray.hwb = function(r) {
  return [0, 100, r[0]];
};
Gt.gray.cmyk = function(r) {
  return [0, 0, 0, r[0]];
};
Gt.gray.lab = function(r) {
  return [r[0], 0, 0];
};
Gt.gray.hex = function(r) {
  var t = Math.round(r[0] / 100 * 255) & 255, e = (t << 16) + (t << 8) + t, n = e.toString(16).toUpperCase();
  return "000000".substring(n.length) + n;
};
Gt.rgb.gray = function(r) {
  var t = (r[0] + r[1] + r[2]) / 3;
  return [t / 255 * 100];
};
var tp = Gb.exports;
function Iq() {
  for (var r = {}, t = Object.keys(tp), e = t.length, n = 0; n < e; n++)
    r[t[n]] = {
      distance: -1,
      parent: null
    };
  return r;
}
function Pq(r) {
  var t = Iq(), e = [r];
  for (t[r].distance = 0; e.length; )
    for (var n = e.pop(), i = Object.keys(tp[n]), a = i.length, o = 0; o < a; o++) {
      var s = i[o], u = t[s];
      u.distance === -1 && (u.distance = t[n].distance + 1, u.parent = n, e.unshift(s));
    }
  return t;
}
function Oq(r, t) {
  return function(e) {
    return t(r(e));
  };
}
function Dq(r, t) {
  for (var e = [t[r].parent, r], n = tp[t[r].parent][r], i = t[r].parent; t[i].parent; )
    e.unshift(t[i].parent), n = Oq(tp[t[i].parent][i], n), i = t[i].parent;
  return n.conversion = e, n;
}
var kq = function(r) {
  for (var t = Pq(r), e = {}, n = Object.keys(t), i = n.length, a = 0; a < i; a++) {
    var o = n[a], s = t[o];
    s.parent !== null && (e[o] = Dq(o, t));
  }
  return e;
}, zm = Gb.exports, Lq = kq, gf = {}, Nq = Object.keys(zm);
function Rq(r) {
  var t = function(e) {
    return e == null ? e : (arguments.length > 1 && (e = Array.prototype.slice.call(arguments)), r(e));
  };
  return "conversion" in r && (t.conversion = r.conversion), t;
}
function Bq(r) {
  var t = function(e) {
    if (e == null)
      return e;
    arguments.length > 1 && (e = Array.prototype.slice.call(arguments));
    var n = r(e);
    if (typeof n == "object")
      for (var i = n.length, a = 0; a < i; a++)
        n[a] = Math.round(n[a]);
    return n;
  };
  return "conversion" in r && (t.conversion = r.conversion), t;
}
Nq.forEach(function(r) {
  gf[r] = {}, Object.defineProperty(gf[r], "channels", { value: zm[r].channels }), Object.defineProperty(gf[r], "labels", { value: zm[r].labels });
  var t = Lq(r), e = Object.keys(t);
  e.forEach(function(n) {
    var i = t[n];
    gf[r][n] = Bq(i), gf[r][n].raw = Rq(i);
  });
});
var Gq = gf, ac = UR.exports, bi = Gq, Fb = [].slice, XR = [
  "keyword",
  "gray",
  "hex"
], Um = {};
Object.keys(bi).forEach(function(r) {
  Um[Fb.call(bi[r].labels).sort().join("")] = r;
});
var rp = {};
function jn(r, t) {
  if (!(this instanceof jn))
    return new jn(r, t);
  if (t && t in XR && (t = null), t && !(t in bi))
    throw new Error("Unknown model: " + t);
  var e, n;
  if (r == null)
    this.model = "rgb", this.color = [0, 0, 0], this.valpha = 1;
  else if (r instanceof jn)
    this.model = r.model, this.color = r.color.slice(), this.valpha = r.valpha;
  else if (typeof r == "string") {
    var i = ac.get(r);
    if (i === null)
      throw new Error("Unable to parse color from string: " + r);
    this.model = i.model, n = bi[this.model].channels, this.color = i.value.slice(0, n), this.valpha = typeof i.value[n] == "number" ? i.value[n] : 1;
  } else if (r.length) {
    this.model = t || "rgb", n = bi[this.model].channels;
    var a = Fb.call(r, 0, n);
    this.color = jm(a, n), this.valpha = typeof r[n] == "number" ? r[n] : 1;
  } else if (typeof r == "number")
    r &= 16777215, this.model = "rgb", this.color = [
      r >> 16 & 255,
      r >> 8 & 255,
      r & 255
    ], this.valpha = 1;
  else {
    this.valpha = 1;
    var o = Object.keys(r);
    "alpha" in r && (o.splice(o.indexOf("alpha"), 1), this.valpha = typeof r.alpha == "number" ? r.alpha : 0);
    var s = o.sort().join("");
    if (!(s in Um))
      throw new Error("Unable to parse color from object: " + JSON.stringify(r));
    this.model = Um[s];
    var u = bi[this.model].labels, f = [];
    for (e = 0; e < u.length; e++)
      f.push(r[u[e]]);
    this.color = jm(f);
  }
  if (rp[this.model])
    for (n = bi[this.model].channels, e = 0; e < n; e++) {
      var l = rp[this.model][e];
      l && (this.color[e] = l(this.color[e]));
    }
  this.valpha = Math.max(0, Math.min(1, this.valpha)), Object.freeze && Object.freeze(this);
}
jn.prototype = {
  toString: function() {
    return this.string();
  },
  toJSON: function() {
    return this[this.model]();
  },
  string: function(r) {
    var t = this.model in ac.to ? this : this.rgb();
    t = t.round(typeof r == "number" ? r : 1);
    var e = t.valpha === 1 ? t.color : t.color.concat(this.valpha);
    return ac.to[t.model](e);
  },
  percentString: function(r) {
    var t = this.rgb().round(typeof r == "number" ? r : 1), e = t.valpha === 1 ? t.color : t.color.concat(this.valpha);
    return ac.to.rgb.percent(e);
  },
  array: function() {
    return this.valpha === 1 ? this.color.slice() : this.color.concat(this.valpha);
  },
  object: function() {
    for (var r = {}, t = bi[this.model].channels, e = bi[this.model].labels, n = 0; n < t; n++)
      r[e[n]] = this.color[n];
    return this.valpha !== 1 && (r.alpha = this.valpha), r;
  },
  unitArray: function() {
    var r = this.rgb().color;
    return r[0] /= 255, r[1] /= 255, r[2] /= 255, this.valpha !== 1 && r.push(this.valpha), r;
  },
  unitObject: function() {
    var r = this.rgb().object();
    return r.r /= 255, r.g /= 255, r.b /= 255, this.valpha !== 1 && (r.alpha = this.valpha), r;
  },
  round: function(r) {
    return r = Math.max(r || 0, 0), new jn(this.color.map(zq(r)).concat(this.valpha), this.model);
  },
  alpha: function(r) {
    return arguments.length ? new jn(this.color.concat(Math.max(0, Math.min(1, r))), this.model) : this.valpha;
  },
  red: tn("rgb", 0, _n(255)),
  green: tn("rgb", 1, _n(255)),
  blue: tn("rgb", 2, _n(255)),
  hue: tn(["hsl", "hsv", "hsl", "hwb", "hcg"], 0, function(r) {
    return (r % 360 + 360) % 360;
  }),
  saturationl: tn("hsl", 1, _n(100)),
  lightness: tn("hsl", 2, _n(100)),
  saturationv: tn("hsv", 1, _n(100)),
  value: tn("hsv", 2, _n(100)),
  chroma: tn("hcg", 1, _n(100)),
  gray: tn("hcg", 2, _n(100)),
  white: tn("hwb", 1, _n(100)),
  wblack: tn("hwb", 2, _n(100)),
  cyan: tn("cmyk", 0, _n(100)),
  magenta: tn("cmyk", 1, _n(100)),
  yellow: tn("cmyk", 2, _n(100)),
  black: tn("cmyk", 3, _n(100)),
  x: tn("xyz", 0, _n(100)),
  y: tn("xyz", 1, _n(100)),
  z: tn("xyz", 2, _n(100)),
  l: tn("lab", 0, _n(100)),
  a: tn("lab", 1),
  b: tn("lab", 2),
  keyword: function(r) {
    return arguments.length ? new jn(r) : bi[this.model].keyword(this.color);
  },
  hex: function(r) {
    return arguments.length ? new jn(r) : ac.to.hex(this.rgb().round().color);
  },
  rgbNumber: function() {
    var r = this.rgb().color;
    return (r[0] & 255) << 16 | (r[1] & 255) << 8 | r[2] & 255;
  },
  luminosity: function() {
    for (var r = this.rgb().color, t = [], e = 0; e < r.length; e++) {
      var n = r[e] / 255;
      t[e] = n <= 0.03928 ? n / 12.92 : Math.pow((n + 0.055) / 1.055, 2.4);
    }
    return 0.2126 * t[0] + 0.7152 * t[1] + 0.0722 * t[2];
  },
  contrast: function(r) {
    var t = this.luminosity(), e = r.luminosity();
    return t > e ? (t + 0.05) / (e + 0.05) : (e + 0.05) / (t + 0.05);
  },
  level: function(r) {
    var t = this.contrast(r);
    return t >= 7.1 ? "AAA" : t >= 4.5 ? "AA" : "";
  },
  isDark: function() {
    var r = this.rgb().color, t = (r[0] * 299 + r[1] * 587 + r[2] * 114) / 1e3;
    return t < 128;
  },
  isLight: function() {
    return !this.isDark();
  },
  negate: function() {
    for (var r = this.rgb(), t = 0; t < 3; t++)
      r.color[t] = 255 - r.color[t];
    return r;
  },
  lighten: function(r) {
    var t = this.hsl();
    return t.color[2] += t.color[2] * r, t;
  },
  darken: function(r) {
    var t = this.hsl();
    return t.color[2] -= t.color[2] * r, t;
  },
  saturate: function(r) {
    var t = this.hsl();
    return t.color[1] += t.color[1] * r, t;
  },
  desaturate: function(r) {
    var t = this.hsl();
    return t.color[1] -= t.color[1] * r, t;
  },
  whiten: function(r) {
    var t = this.hwb();
    return t.color[1] += t.color[1] * r, t;
  },
  blacken: function(r) {
    var t = this.hwb();
    return t.color[2] += t.color[2] * r, t;
  },
  grayscale: function() {
    var r = this.rgb().color, t = r[0] * 0.3 + r[1] * 0.59 + r[2] * 0.11;
    return jn.rgb(t, t, t);
  },
  fade: function(r) {
    return this.alpha(this.valpha - this.valpha * r);
  },
  opaquer: function(r) {
    return this.alpha(this.valpha + this.valpha * r);
  },
  rotate: function(r) {
    var t = this.hsl(), e = t.color[0];
    return e = (e + r) % 360, e = e < 0 ? 360 + e : e, t.color[0] = e, t;
  },
  mix: function(r, t) {
    if (!r || !r.rgb)
      throw new Error('Argument to "mix" was not a Color instance, but rather an instance of ' + typeof r);
    var e = r.rgb(), n = this.rgb(), i = t === void 0 ? 0.5 : t, a = 2 * i - 1, o = e.alpha() - n.alpha(), s = ((a * o === -1 ? a : (a + o) / (1 + a * o)) + 1) / 2, u = 1 - s;
    return jn.rgb(
      s * e.red() + u * n.red(),
      s * e.green() + u * n.green(),
      s * e.blue() + u * n.blue(),
      e.alpha() * i + n.alpha() * (1 - i)
    );
  }
};
Object.keys(bi).forEach(function(r) {
  if (XR.indexOf(r) === -1) {
    var t = bi[r].channels;
    jn.prototype[r] = function() {
      if (this.model === r)
        return new jn(this);
      if (arguments.length)
        return new jn(arguments, r);
      var e = typeof arguments[t] == "number" ? t : this.valpha;
      return new jn(Uq(bi[this.model][r].raw(this.color)).concat(e), r);
    }, jn[r] = function(e) {
      return typeof e == "number" && (e = jm(Fb.call(arguments), t)), new jn(e, r);
    };
  }
});
function Fq(r, t) {
  return Number(r.toFixed(t));
}
function zq(r) {
  return function(t) {
    return Fq(t, r);
  };
}
function tn(r, t, e) {
  return r = Array.isArray(r) ? r : [r], r.forEach(function(n) {
    (rp[n] || (rp[n] = []))[t] = e;
  }), r = r[0], function(n) {
    var i;
    return arguments.length ? (e && (n = e(n)), i = this[r](), i.color[t] = n, i) : (i = this[r]().color[t], e && (i = e(i)), i);
  };
}
function _n(r) {
  return function(t) {
    return Math.max(0, Math.min(r, t));
  };
}
function Uq(r) {
  return Array.isArray(r) ? r : [r];
}
function jm(r, t) {
  for (var e = 0; e < t; e++)
    typeof r[e] != "number" && (r[e] = 0);
  return r;
}
var mc = jn, YR = { exports: {} };
(function(r) {
  (function(t) {
    var e = /^\s+/, n = /\s+$/, i = 0, a = t.round, o = t.min, s = t.max, u = t.random;
    function f($, te) {
      if ($ = $ || "", te = te || {}, $ instanceof f)
        return $;
      if (!(this instanceof f))
        return new f($, te);
      var X = l($);
      this._originalInput = $, this._r = X.r, this._g = X.g, this._b = X.b, this._a = X.a, this._roundA = a(100 * this._a) / 100, this._format = te.format || X.format, this._gradientType = te.gradientType, this._r < 1 && (this._r = a(this._r)), this._g < 1 && (this._g = a(this._g)), this._b < 1 && (this._b = a(this._b)), this._ok = X.ok, this._tc_id = i++;
    }
    f.prototype = {
      isDark: function() {
        return this.getBrightness() < 128;
      },
      isLight: function() {
        return !this.isDark();
      },
      isValid: function() {
        return this._ok;
      },
      getOriginalInput: function() {
        return this._originalInput;
      },
      getFormat: function() {
        return this._format;
      },
      getAlpha: function() {
        return this._a;
      },
      getBrightness: function() {
        var $ = this.toRgb();
        return ($.r * 299 + $.g * 587 + $.b * 114) / 1e3;
      },
      getLuminance: function() {
        var $ = this.toRgb(), te, X, De, Ke, Fe, _t;
        return te = $.r / 255, X = $.g / 255, De = $.b / 255, te <= 0.03928 ? Ke = te / 12.92 : Ke = t.pow((te + 0.055) / 1.055, 2.4), X <= 0.03928 ? Fe = X / 12.92 : Fe = t.pow((X + 0.055) / 1.055, 2.4), De <= 0.03928 ? _t = De / 12.92 : _t = t.pow((De + 0.055) / 1.055, 2.4), 0.2126 * Ke + 0.7152 * Fe + 0.0722 * _t;
      },
      setAlpha: function($) {
        return this._a = R($), this._roundA = a(100 * this._a) / 100, this;
      },
      toHsv: function() {
        var $ = v(this._r, this._g, this._b);
        return { h: $.h * 360, s: $.s, v: $.v, a: this._a };
      },
      toHsvString: function() {
        var $ = v(this._r, this._g, this._b), te = a($.h * 360), X = a($.s * 100), De = a($.v * 100);
        return this._a == 1 ? "hsv(" + te + ", " + X + "%, " + De + "%)" : "hsva(" + te + ", " + X + "%, " + De + "%, " + this._roundA + ")";
      },
      toHsl: function() {
        var $ = h(this._r, this._g, this._b);
        return { h: $.h * 360, s: $.s, l: $.l, a: this._a };
      },
      toHslString: function() {
        var $ = h(this._r, this._g, this._b), te = a($.h * 360), X = a($.s * 100), De = a($.l * 100);
        return this._a == 1 ? "hsl(" + te + ", " + X + "%, " + De + "%)" : "hsla(" + te + ", " + X + "%, " + De + "%, " + this._roundA + ")";
      },
      toHex: function($) {
        return g(this._r, this._g, this._b, $);
      },
      toHexString: function($) {
        return "#" + this.toHex($);
      },
      toHex8: function($) {
        return y(this._r, this._g, this._b, this._a, $);
      },
      toHex8String: function($) {
        return "#" + this.toHex8($);
      },
      toRgb: function() {
        return { r: a(this._r), g: a(this._g), b: a(this._b), a: this._a };
      },
      toRgbString: function() {
        return this._a == 1 ? "rgb(" + a(this._r) + ", " + a(this._g) + ", " + a(this._b) + ")" : "rgba(" + a(this._r) + ", " + a(this._g) + ", " + a(this._b) + ", " + this._roundA + ")";
      },
      toPercentageRgb: function() {
        return { r: a(F(this._r, 255) * 100) + "%", g: a(F(this._g, 255) * 100) + "%", b: a(F(this._b, 255) * 100) + "%", a: this._a };
      },
      toPercentageRgbString: function() {
        return this._a == 1 ? "rgb(" + a(F(this._r, 255) * 100) + "%, " + a(F(this._g, 255) * 100) + "%, " + a(F(this._b, 255) * 100) + "%)" : "rgba(" + a(F(this._r, 255) * 100) + "%, " + a(F(this._g, 255) * 100) + "%, " + a(F(this._b, 255) * 100) + "%, " + this._roundA + ")";
      },
      toName: function() {
        return this._a === 0 ? "transparent" : this._a < 1 ? !1 : D[g(this._r, this._g, this._b, !0)] || !1;
      },
      toFilter: function($) {
        var te = "#" + b(this._r, this._g, this._b, this._a), X = te, De = this._gradientType ? "GradientType = 1, " : "";
        if ($) {
          var Ke = f($);
          X = "#" + b(Ke._r, Ke._g, Ke._b, Ke._a);
        }
        return "progid:DXImageTransform.Microsoft.gradient(" + De + "startColorstr=" + te + ",endColorstr=" + X + ")";
      },
      toString: function($) {
        var te = !!$;
        $ = $ || this._format;
        var X = !1, De = this._a < 1 && this._a >= 0, Ke = !te && De && ($ === "hex" || $ === "hex6" || $ === "hex3" || $ === "hex4" || $ === "hex8" || $ === "name");
        return Ke ? $ === "name" && this._a === 0 ? this.toName() : this.toRgbString() : ($ === "rgb" && (X = this.toRgbString()), $ === "prgb" && (X = this.toPercentageRgbString()), ($ === "hex" || $ === "hex6") && (X = this.toHexString()), $ === "hex3" && (X = this.toHexString(!0)), $ === "hex4" && (X = this.toHex8String(!0)), $ === "hex8" && (X = this.toHex8String()), $ === "name" && (X = this.toName()), $ === "hsl" && (X = this.toHslString()), $ === "hsv" && (X = this.toHsvString()), X || this.toHexString());
      },
      clone: function() {
        return f(this.toString());
      },
      _applyModification: function($, te) {
        var X = $.apply(null, [this].concat([].slice.call(te)));
        return this._r = X._r, this._g = X._g, this._b = X._b, this.setAlpha(X._a), this;
      },
      lighten: function() {
        return this._applyModification(w, arguments);
      },
      brighten: function() {
        return this._applyModification(E, arguments);
      },
      darken: function() {
        return this._applyModification(M, arguments);
      },
      desaturate: function() {
        return this._applyModification(m, arguments);
      },
      saturate: function() {
        return this._applyModification(x, arguments);
      },
      greyscale: function() {
        return this._applyModification(_, arguments);
      },
      spin: function() {
        return this._applyModification(C, arguments);
      },
      _applyCombination: function($, te) {
        return $.apply(null, [this].concat([].slice.call(te)));
      },
      analogous: function() {
        return this._applyCombination(k, arguments);
      },
      complement: function() {
        return this._applyCombination(S, arguments);
      },
      monochromatic: function() {
        return this._applyCombination(L, arguments);
      },
      splitcomplement: function() {
        return this._applyCombination(P, arguments);
      },
      triad: function() {
        return this._applyCombination(A, arguments);
      },
      tetrad: function() {
        return this._applyCombination(T, arguments);
      }
    }, f.fromRatio = function($, te) {
      if (typeof $ == "object") {
        var X = {};
        for (var De in $)
          $.hasOwnProperty(De) && (De === "a" ? X[De] = $[De] : X[De] = Xe($[De]));
        $ = X;
      }
      return f($, te);
    };
    function l($) {
      var te = { r: 0, g: 0, b: 0 }, X = 1, De = null, Ke = null, Fe = null, _t = !1, Kt = !1;
      return typeof $ == "string" && ($ = ft($)), typeof $ == "object" && (et($.r) && et($.g) && et($.b) ? (te = c($.r, $.g, $.b), _t = !0, Kt = String($.r).substr(-1) === "%" ? "prgb" : "rgb") : et($.h) && et($.s) && et($.v) ? (De = Xe($.s), Ke = Xe($.v), te = p($.h, De, Ke), _t = !0, Kt = "hsv") : et($.h) && et($.s) && et($.l) && (De = Xe($.s), Fe = Xe($.l), te = d($.h, De, Fe), _t = !0, Kt = "hsl"), $.hasOwnProperty("a") && (X = $.a)), X = R(X), {
        ok: _t,
        format: $.format || Kt,
        r: o(255, s(te.r, 0)),
        g: o(255, s(te.g, 0)),
        b: o(255, s(te.b, 0)),
        a: X
      };
    }
    function c($, te, X) {
      return {
        r: F($, 255) * 255,
        g: F(te, 255) * 255,
        b: F(X, 255) * 255
      };
    }
    function h($, te, X) {
      $ = F($, 255), te = F(te, 255), X = F(X, 255);
      var De = s($, te, X), Ke = o($, te, X), Fe, _t, Kt = (De + Ke) / 2;
      if (De == Ke)
        Fe = _t = 0;
      else {
        var Ye = De - Ke;
        switch (_t = Kt > 0.5 ? Ye / (2 - De - Ke) : Ye / (De + Ke), De) {
          case $:
            Fe = (te - X) / Ye + (te < X ? 6 : 0);
            break;
          case te:
            Fe = (X - $) / Ye + 2;
            break;
          case X:
            Fe = ($ - te) / Ye + 4;
            break;
        }
        Fe /= 6;
      }
      return { h: Fe, s: _t, l: Kt };
    }
    function d($, te, X) {
      var De, Ke, Fe;
      $ = F($, 360), te = F(te, 100), X = F(X, 100);
      function _t(vt, N, Z) {
        return Z < 0 && (Z += 1), Z > 1 && (Z -= 1), Z < 1 / 6 ? vt + (N - vt) * 6 * Z : Z < 1 / 2 ? N : Z < 2 / 3 ? vt + (N - vt) * (2 / 3 - Z) * 6 : vt;
      }
      if (te === 0)
        De = Ke = Fe = X;
      else {
        var Kt = X < 0.5 ? X * (1 + te) : X + te - X * te, Ye = 2 * X - Kt;
        De = _t(Ye, Kt, $ + 1 / 3), Ke = _t(Ye, Kt, $), Fe = _t(Ye, Kt, $ - 1 / 3);
      }
      return { r: De * 255, g: Ke * 255, b: Fe * 255 };
    }
    function v($, te, X) {
      $ = F($, 255), te = F(te, 255), X = F(X, 255);
      var De = s($, te, X), Ke = o($, te, X), Fe, _t, Kt = De, Ye = De - Ke;
      if (_t = De === 0 ? 0 : Ye / De, De == Ke)
        Fe = 0;
      else {
        switch (De) {
          case $:
            Fe = (te - X) / Ye + (te < X ? 6 : 0);
            break;
          case te:
            Fe = (X - $) / Ye + 2;
            break;
          case X:
            Fe = ($ - te) / Ye + 4;
            break;
        }
        Fe /= 6;
      }
      return { h: Fe, s: _t, v: Kt };
    }
    function p($, te, X) {
      $ = F($, 360) * 6, te = F(te, 100), X = F(X, 100);
      var De = t.floor($), Ke = $ - De, Fe = X * (1 - te), _t = X * (1 - Ke * te), Kt = X * (1 - (1 - Ke) * te), Ye = De % 6, vt = [X, _t, Fe, Fe, Kt, X][Ye], N = [Kt, X, X, _t, Fe, Fe][Ye], Z = [Fe, Fe, Kt, X, X, _t][Ye];
      return { r: vt * 255, g: N * 255, b: Z * 255 };
    }
    function g($, te, X, De) {
      var Ke = [
        Ee(a($).toString(16)),
        Ee(a(te).toString(16)),
        Ee(a(X).toString(16))
      ];
      return De && Ke[0].charAt(0) == Ke[0].charAt(1) && Ke[1].charAt(0) == Ke[1].charAt(1) && Ke[2].charAt(0) == Ke[2].charAt(1) ? Ke[0].charAt(0) + Ke[1].charAt(0) + Ke[2].charAt(0) : Ke.join("");
    }
    function y($, te, X, De, Ke) {
      var Fe = [
        Ee(a($).toString(16)),
        Ee(a(te).toString(16)),
        Ee(a(X).toString(16)),
        Ee(le(De))
      ];
      return Ke && Fe[0].charAt(0) == Fe[0].charAt(1) && Fe[1].charAt(0) == Fe[1].charAt(1) && Fe[2].charAt(0) == Fe[2].charAt(1) && Fe[3].charAt(0) == Fe[3].charAt(1) ? Fe[0].charAt(0) + Fe[1].charAt(0) + Fe[2].charAt(0) + Fe[3].charAt(0) : Fe.join("");
    }
    function b($, te, X, De) {
      var Ke = [
        Ee(le(De)),
        Ee(a($).toString(16)),
        Ee(a(te).toString(16)),
        Ee(a(X).toString(16))
      ];
      return Ke.join("");
    }
    f.equals = function($, te) {
      return !$ || !te ? !1 : f($).toRgbString() == f(te).toRgbString();
    }, f.random = function() {
      return f.fromRatio({
        r: u(),
        g: u(),
        b: u()
      });
    };
    function m($, te) {
      te = te === 0 ? 0 : te || 10;
      var X = f($).toHsl();
      return X.s -= te / 100, X.s = q(X.s), f(X);
    }
    function x($, te) {
      te = te === 0 ? 0 : te || 10;
      var X = f($).toHsl();
      return X.s += te / 100, X.s = q(X.s), f(X);
    }
    function _($) {
      return f($).desaturate(100);
    }
    function w($, te) {
      te = te === 0 ? 0 : te || 10;
      var X = f($).toHsl();
      return X.l += te / 100, X.l = q(X.l), f(X);
    }
    function E($, te) {
      te = te === 0 ? 0 : te || 10;
      var X = f($).toRgb();
      return X.r = s(0, o(255, X.r - a(255 * -(te / 100)))), X.g = s(0, o(255, X.g - a(255 * -(te / 100)))), X.b = s(0, o(255, X.b - a(255 * -(te / 100)))), f(X);
    }
    function M($, te) {
      te = te === 0 ? 0 : te || 10;
      var X = f($).toHsl();
      return X.l -= te / 100, X.l = q(X.l), f(X);
    }
    function C($, te) {
      var X = f($).toHsl(), De = (X.h + te) % 360;
      return X.h = De < 0 ? 360 + De : De, f(X);
    }
    function S($) {
      var te = f($).toHsl();
      return te.h = (te.h + 180) % 360, f(te);
    }
    function A($) {
      var te = f($).toHsl(), X = te.h;
      return [
        f($),
        f({ h: (X + 120) % 360, s: te.s, l: te.l }),
        f({ h: (X + 240) % 360, s: te.s, l: te.l })
      ];
    }
    function T($) {
      var te = f($).toHsl(), X = te.h;
      return [
        f($),
        f({ h: (X + 90) % 360, s: te.s, l: te.l }),
        f({ h: (X + 180) % 360, s: te.s, l: te.l }),
        f({ h: (X + 270) % 360, s: te.s, l: te.l })
      ];
    }
    function P($) {
      var te = f($).toHsl(), X = te.h;
      return [
        f($),
        f({ h: (X + 72) % 360, s: te.s, l: te.l }),
        f({ h: (X + 216) % 360, s: te.s, l: te.l })
      ];
    }
    function k($, te, X) {
      te = te || 6, X = X || 30;
      var De = f($).toHsl(), Ke = 360 / X, Fe = [f($)];
      for (De.h = (De.h - (Ke * te >> 1) + 720) % 360; --te; )
        De.h = (De.h + Ke) % 360, Fe.push(f(De));
      return Fe;
    }
    function L($, te) {
      te = te || 6;
      for (var X = f($).toHsv(), De = X.h, Ke = X.s, Fe = X.v, _t = [], Kt = 1 / te; te--; )
        _t.push(f({ h: De, s: Ke, v: Fe })), Fe = (Fe + Kt) % 1;
      return _t;
    }
    f.mix = function($, te, X) {
      X = X === 0 ? 0 : X || 50;
      var De = f($).toRgb(), Ke = f(te).toRgb(), Fe = X / 100, _t = {
        r: (Ke.r - De.r) * Fe + De.r,
        g: (Ke.g - De.g) * Fe + De.g,
        b: (Ke.b - De.b) * Fe + De.b,
        a: (Ke.a - De.a) * Fe + De.a
      };
      return f(_t);
    }, f.readability = function($, te) {
      var X = f($), De = f(te);
      return (t.max(X.getLuminance(), De.getLuminance()) + 0.05) / (t.min(X.getLuminance(), De.getLuminance()) + 0.05);
    }, f.isReadable = function($, te, X) {
      var De = f.readability($, te), Ke, Fe;
      switch (Fe = !1, Ke = pt(X), Ke.level + Ke.size) {
        case "AAsmall":
        case "AAAlarge":
          Fe = De >= 4.5;
          break;
        case "AAlarge":
          Fe = De >= 3;
          break;
        case "AAAsmall":
          Fe = De >= 7;
          break;
      }
      return Fe;
    }, f.mostReadable = function($, te, X) {
      var De = null, Ke = 0, Fe, _t, Kt, Ye;
      X = X || {}, _t = X.includeFallbackColors, Kt = X.level, Ye = X.size;
      for (var vt = 0; vt < te.length; vt++)
        Fe = f.readability($, te[vt]), Fe > Ke && (Ke = Fe, De = f(te[vt]));
      return f.isReadable($, De, { level: Kt, size: Ye }) || !_t ? De : (X.includeFallbackColors = !1, f.mostReadable($, ["#fff", "#000"], X));
    };
    var O = f.names = {
      aliceblue: "f0f8ff",
      antiquewhite: "faebd7",
      aqua: "0ff",
      aquamarine: "7fffd4",
      azure: "f0ffff",
      beige: "f5f5dc",
      bisque: "ffe4c4",
      black: "000",
      blanchedalmond: "ffebcd",
      blue: "00f",
      blueviolet: "8a2be2",
      brown: "a52a2a",
      burlywood: "deb887",
      burntsienna: "ea7e5d",
      cadetblue: "5f9ea0",
      chartreuse: "7fff00",
      chocolate: "d2691e",
      coral: "ff7f50",
      cornflowerblue: "6495ed",
      cornsilk: "fff8dc",
      crimson: "dc143c",
      cyan: "0ff",
      darkblue: "00008b",
      darkcyan: "008b8b",
      darkgoldenrod: "b8860b",
      darkgray: "a9a9a9",
      darkgreen: "006400",
      darkgrey: "a9a9a9",
      darkkhaki: "bdb76b",
      darkmagenta: "8b008b",
      darkolivegreen: "556b2f",
      darkorange: "ff8c00",
      darkorchid: "9932cc",
      darkred: "8b0000",
      darksalmon: "e9967a",
      darkseagreen: "8fbc8f",
      darkslateblue: "483d8b",
      darkslategray: "2f4f4f",
      darkslategrey: "2f4f4f",
      darkturquoise: "00ced1",
      darkviolet: "9400d3",
      deeppink: "ff1493",
      deepskyblue: "00bfff",
      dimgray: "696969",
      dimgrey: "696969",
      dodgerblue: "1e90ff",
      firebrick: "b22222",
      floralwhite: "fffaf0",
      forestgreen: "228b22",
      fuchsia: "f0f",
      gainsboro: "dcdcdc",
      ghostwhite: "f8f8ff",
      gold: "ffd700",
      goldenrod: "daa520",
      gray: "808080",
      green: "008000",
      greenyellow: "adff2f",
      grey: "808080",
      honeydew: "f0fff0",
      hotpink: "ff69b4",
      indianred: "cd5c5c",
      indigo: "4b0082",
      ivory: "fffff0",
      khaki: "f0e68c",
      lavender: "e6e6fa",
      lavenderblush: "fff0f5",
      lawngreen: "7cfc00",
      lemonchiffon: "fffacd",
      lightblue: "add8e6",
      lightcoral: "f08080",
      lightcyan: "e0ffff",
      lightgoldenrodyellow: "fafad2",
      lightgray: "d3d3d3",
      lightgreen: "90ee90",
      lightgrey: "d3d3d3",
      lightpink: "ffb6c1",
      lightsalmon: "ffa07a",
      lightseagreen: "20b2aa",
      lightskyblue: "87cefa",
      lightslategray: "789",
      lightslategrey: "789",
      lightsteelblue: "b0c4de",
      lightyellow: "ffffe0",
      lime: "0f0",
      limegreen: "32cd32",
      linen: "faf0e6",
      magenta: "f0f",
      maroon: "800000",
      mediumaquamarine: "66cdaa",
      mediumblue: "0000cd",
      mediumorchid: "ba55d3",
      mediumpurple: "9370db",
      mediumseagreen: "3cb371",
      mediumslateblue: "7b68ee",
      mediumspringgreen: "00fa9a",
      mediumturquoise: "48d1cc",
      mediumvioletred: "c71585",
      midnightblue: "191970",
      mintcream: "f5fffa",
      mistyrose: "ffe4e1",
      moccasin: "ffe4b5",
      navajowhite: "ffdead",
      navy: "000080",
      oldlace: "fdf5e6",
      olive: "808000",
      olivedrab: "6b8e23",
      orange: "ffa500",
      orangered: "ff4500",
      orchid: "da70d6",
      palegoldenrod: "eee8aa",
      palegreen: "98fb98",
      paleturquoise: "afeeee",
      palevioletred: "db7093",
      papayawhip: "ffefd5",
      peachpuff: "ffdab9",
      peru: "cd853f",
      pink: "ffc0cb",
      plum: "dda0dd",
      powderblue: "b0e0e6",
      purple: "800080",
      rebeccapurple: "663399",
      red: "f00",
      rosybrown: "bc8f8f",
      royalblue: "4169e1",
      saddlebrown: "8b4513",
      salmon: "fa8072",
      sandybrown: "f4a460",
      seagreen: "2e8b57",
      seashell: "fff5ee",
      sienna: "a0522d",
      silver: "c0c0c0",
      skyblue: "87ceeb",
      slateblue: "6a5acd",
      slategray: "708090",
      slategrey: "708090",
      snow: "fffafa",
      springgreen: "00ff7f",
      steelblue: "4682b4",
      tan: "d2b48c",
      teal: "008080",
      thistle: "d8bfd8",
      tomato: "ff6347",
      turquoise: "40e0d0",
      violet: "ee82ee",
      wheat: "f5deb3",
      white: "fff",
      whitesmoke: "f5f5f5",
      yellow: "ff0",
      yellowgreen: "9acd32"
    }, D = f.hexNames = G(O);
    function G($) {
      var te = {};
      for (var X in $)
        $.hasOwnProperty(X) && (te[$[X]] = X);
      return te;
    }
    function R($) {
      return $ = parseFloat($), (isNaN($) || $ < 0 || $ > 1) && ($ = 1), $;
    }
    function F($, te) {
      oe($) && ($ = "100%");
      var X = ie($);
      return $ = o(te, s(0, parseFloat($))), X && ($ = parseInt($ * te, 10) / 100), t.abs($ - te) < 1e-6 ? 1 : $ % te / parseFloat(te);
    }
    function q($) {
      return o(1, s(0, $));
    }
    function ne($) {
      return parseInt($, 16);
    }
    function oe($) {
      return typeof $ == "string" && $.indexOf(".") != -1 && parseFloat($) === 1;
    }
    function ie($) {
      return typeof $ == "string" && $.indexOf("%") != -1;
    }
    function Ee($) {
      return $.length == 1 ? "0" + $ : "" + $;
    }
    function Xe($) {
      return $ <= 1 && ($ = $ * 100 + "%"), $;
    }
    function le($) {
      return t.round(parseFloat($) * 255).toString(16);
    }
    function Me($) {
      return ne($) / 255;
    }
    var $e = function() {
      var $ = "[-\\+]?\\d+%?", te = "[-\\+]?\\d*\\.\\d+%?", X = "(?:" + te + ")|(?:" + $ + ")", De = "[\\s|\\(]+(" + X + ")[,|\\s]+(" + X + ")[,|\\s]+(" + X + ")\\s*\\)?", Ke = "[\\s|\\(]+(" + X + ")[,|\\s]+(" + X + ")[,|\\s]+(" + X + ")[,|\\s]+(" + X + ")\\s*\\)?";
      return {
        CSS_UNIT: new RegExp(X),
        rgb: new RegExp("rgb" + De),
        rgba: new RegExp("rgba" + Ke),
        hsl: new RegExp("hsl" + De),
        hsla: new RegExp("hsla" + Ke),
        hsv: new RegExp("hsv" + De),
        hsva: new RegExp("hsva" + Ke),
        hex3: /^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,
        hex6: /^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,
        hex4: /^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,
        hex8: /^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/
      };
    }();
    function et($) {
      return !!$e.CSS_UNIT.exec($);
    }
    function ft($) {
      $ = $.replace(e, "").replace(n, "").toLowerCase();
      var te = !1;
      if (O[$])
        $ = O[$], te = !0;
      else if ($ == "transparent")
        return { r: 0, g: 0, b: 0, a: 0, format: "name" };
      var X;
      return (X = $e.rgb.exec($)) ? { r: X[1], g: X[2], b: X[3] } : (X = $e.rgba.exec($)) ? { r: X[1], g: X[2], b: X[3], a: X[4] } : (X = $e.hsl.exec($)) ? { h: X[1], s: X[2], l: X[3] } : (X = $e.hsla.exec($)) ? { h: X[1], s: X[2], l: X[3], a: X[4] } : (X = $e.hsv.exec($)) ? { h: X[1], s: X[2], v: X[3] } : (X = $e.hsva.exec($)) ? { h: X[1], s: X[2], v: X[3], a: X[4] } : (X = $e.hex8.exec($)) ? {
        r: ne(X[1]),
        g: ne(X[2]),
        b: ne(X[3]),
        a: Me(X[4]),
        format: te ? "name" : "hex8"
      } : (X = $e.hex6.exec($)) ? {
        r: ne(X[1]),
        g: ne(X[2]),
        b: ne(X[3]),
        format: te ? "name" : "hex"
      } : (X = $e.hex4.exec($)) ? {
        r: ne(X[1] + "" + X[1]),
        g: ne(X[2] + "" + X[2]),
        b: ne(X[3] + "" + X[3]),
        a: Me(X[4] + "" + X[4]),
        format: te ? "name" : "hex8"
      } : (X = $e.hex3.exec($)) ? {
        r: ne(X[1] + "" + X[1]),
        g: ne(X[2] + "" + X[2]),
        b: ne(X[3] + "" + X[3]),
        format: te ? "name" : "hex"
      } : !1;
    }
    function pt($) {
      var te, X;
      return $ = $ || { level: "AA", size: "small" }, te = ($.level || "AA").toUpperCase(), X = ($.size || "small").toLowerCase(), te !== "AA" && te !== "AAA" && (te = "AA"), X !== "small" && X !== "large" && (X = "small"), { level: te, size: X };
    }
    r.exports ? r.exports = f : window.tinycolor = f;
  })(Math);
})(YR);
const Id = YR.exports;
var Pd = 2, lS = 0.16, jq = 0.05, $q = 0.05, Wq = 0.15, HR = 5, KR = 4, Vq = [{
  index: 7,
  opacity: 0.15
}, {
  index: 6,
  opacity: 0.25
}, {
  index: 5,
  opacity: 0.3
}, {
  index: 5,
  opacity: 0.45
}, {
  index: 5,
  opacity: 0.65
}, {
  index: 5,
  opacity: 0.85
}, {
  index: 4,
  opacity: 0.9
}, {
  index: 3,
  opacity: 0.95
}, {
  index: 2,
  opacity: 0.97
}, {
  index: 1,
  opacity: 0.98
}];
function cS(r, t, e) {
  var n;
  return Math.round(r.h) >= 60 && Math.round(r.h) <= 240 ? n = e ? Math.round(r.h) - Pd * t : Math.round(r.h) + Pd * t : n = e ? Math.round(r.h) + Pd * t : Math.round(r.h) - Pd * t, n < 0 ? n += 360 : n >= 360 && (n -= 360), n;
}
function hS(r, t, e) {
  if (r.h === 0 && r.s === 0)
    return r.s;
  var n;
  return e ? n = r.s - lS * t : t === KR ? n = r.s + lS : n = r.s + jq * t, n > 1 && (n = 1), e && t === HR && n > 0.1 && (n = 0.1), n < 0.06 && (n = 0.06), Number(n.toFixed(2));
}
function dS(r, t, e) {
  var n;
  return e ? n = r.v + $q * t : n = r.v - Wq * t, n > 1 && (n = 1), Number(n.toFixed(2));
}
function np(r) {
  for (var t = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {}, e = [], n = Id(r), i = HR; i > 0; i -= 1) {
    var a = n.toHsv(), o = Id({
      h: cS(a, i, !0),
      s: hS(a, i, !0),
      v: dS(a, i, !0)
    }).toHexString();
    e.push(o);
  }
  e.push(n.toHexString());
  for (var s = 1; s <= KR; s += 1) {
    var u = n.toHsv(), f = Id({
      h: cS(u, s),
      s: hS(u, s),
      v: dS(u, s)
    }).toHexString();
    e.push(f);
  }
  return t.theme === "dark" ? Vq.map(function(l) {
    var c = l.index, h = l.opacity, d = Id.mix(t.backgroundColor || "#141414", e[c], h * 100).toHexString();
    return d;
  }) : e;
}
var Z0 = {
  red: "#F5222D",
  volcano: "#FA541C",
  orange: "#FA8C16",
  gold: "#FAAD14",
  yellow: "#FADB14",
  lime: "#A0D911",
  green: "#52C41A",
  cyan: "#13C2C2",
  blue: "#1890FF",
  geekblue: "#2F54EB",
  purple: "#722ED1",
  magenta: "#EB2F96",
  grey: "#666666"
}, Q0 = {}, J0 = {};
Object.keys(Z0).forEach(function(r) {
  Q0[r] = np(Z0[r]), Q0[r].primary = Q0[r][5], J0[r] = np(Z0[r], {
    theme: "dark",
    backgroundColor: "#141414"
  }), J0[r].primary = J0[r][5];
});
var En = function(t, e, n) {
  var i = mc(t), a = mc(e);
  return mc([(1 - n) * i.red() + n * a.red(), (1 - n) * i.green() + n * a.green(), (1 - n) * i.blue() + n * a.blue()]).rgb();
}, Xq = function(t, e, n) {
  e === void 0 && (e = "#fff"), n === void 0 && (n = "rgb(150, 150, 150)");
  var i = En(e, t, 0.05).rgb().toString(), a = En(e, t, 0.1).rgb().toString(), o = En(e, t, 0.2).rgb().toString(), s = En(e, t, 0.4).rgb().toString(), u = En(e, n, 0.02).rgb().toString(), f = En(e, n, 0.05).rgb().toString(), l = En(e, n, 0.1).rgb().toString(), c = En(e, n, 0.2).rgb().toString(), h = En(e, n, 0.3).rgb().toString(), d = np(t, {
    theme: "default",
    backgroundColor: e
  }), v = mc(t).hex().toLowerCase(), p = d.indexOf(v), g = t;
  return p !== -1 && (g = d[p + 1]), {
    mainStroke: t,
    mainFill: a,
    activeStroke: t,
    activeFill: i,
    inactiveStroke: s,
    inactiveFill: i,
    selectedStroke: t,
    selectedFill: e,
    highlightStroke: g,
    highlightFill: o,
    disableStroke: h,
    disableFill: f,
    edgeMainStroke: h,
    edgeActiveStroke: t,
    edgeInactiveStroke: c,
    edgeSelectedStroke: t,
    edgeHighlightStroke: t,
    edgeDisableStroke: l,
    comboMainStroke: h,
    comboMainFill: u,
    comboActiveStroke: t,
    comboActiveFill: i,
    comboInactiveStroke: h,
    comboInactiveFill: u,
    comboSelectedStroke: t,
    comboSelectedFill: u,
    comboHighlightStroke: g,
    comboHighlightFill: u,
    comboDisableStroke: c,
    comboDisableFill: f
  };
}, Yq = function(t, e, n) {
  e === void 0 && (e = "#fff"), n === void 0 && (n = "#777");
  var i = En(e, t, 0.2).rgb().toString(), a = En(e, t, 0.3).rgb().toString(), o = En(e, t, 0.6).rgb().toString(), s = En(e, t, 0.8).rgb().toString(), u = En(e, n, 0.2).rgb().toString(), f = En(e, n, 0.25).rgb().toString(), l = En(e, n, 0.3).rgb().toString(), c = En(e, n, 0.4).rgb().toString(), h = En(e, n, 0.5).rgb().toString(), d = np(t, {
    theme: "dark",
    backgroundColor: e
  }), v = mc(t).hex().toLowerCase(), p = d.indexOf(v), g = t;
  return p !== -1 && (g = d[p + 1]), {
    mainStroke: s,
    mainFill: i,
    activeStroke: t,
    activeFill: a,
    inactiveStroke: s,
    inactiveFill: i,
    selectedStroke: t,
    selectedFill: i,
    highlightStroke: t,
    highlightFill: o,
    disableStroke: h,
    disableFill: f,
    edgeMainStroke: n,
    edgeActiveStroke: t,
    edgeInactiveStroke: n,
    edgeSelectedStroke: t,
    edgeHighlightStroke: t,
    edgeDisableStroke: l,
    comboMainStroke: c,
    comboMainFill: f,
    comboActiveStroke: t,
    comboActiveFill: u,
    comboInactiveStroke: c,
    comboInactiveFill: f,
    comboSelectedStroke: t,
    comboSelectedFill: u,
    comboHighlightStroke: g,
    comboHighlightFill: f,
    comboDisableStroke: c,
    comboDisableFill: u
  };
}, zb = function(t, e, n, i) {
  return e === void 0 && (e = "#fff"), n === void 0 && (n = "default"), n === "default" ? Xq(t, e, "rgb(150, 150, 150)") : Yq(t, e, "#777");
}, Hq = function(t, e, n, i) {
  e === void 0 && (e = "#fff"), n === void 0 && (n = "default");
  var a = [];
  return t.forEach(function(o) {
    a.push(zb(o, e, n));
  }), a;
};
const Kq = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  mixColor: En,
  getColorsWithSubjectColor: zb,
  getColorSetsBySubjectColors: Hq
}, Symbol.toStringTag, { value: "Module" }));
var qq = "rgb(95, 149, 255)", Zq = "rgb(255, 255, 255)", vS = "rgb(0, 0, 0)", dr = zb(qq, Zq);
const lu = {
  version: "0.7.10",
  rootContainerClassName: "root-container",
  nodeContainerClassName: "node-container",
  edgeContainerClassName: "edge-container",
  comboContainerClassName: "combo-container",
  delegateContainerClassName: "delegate-container",
  defaultLoopPosition: "top",
  nodeLabel: {
    style: {
      fill: "#000",
      fontSize: 12,
      textAlign: "center",
      textBaseline: "middle"
    },
    offset: 4
  },
  defaultNode: {
    type: "circle",
    style: {
      lineWidth: 1,
      stroke: dr.mainStroke,
      fill: dr.mainFill
    },
    size: 20,
    color: dr.mainStroke,
    linkPoints: {
      size: 8,
      lineWidth: 1,
      fill: dr.activeFill,
      stroke: dr.activeStroke
    }
  },
  nodeStateStyles: {
    active: {
      fill: dr.activeFill,
      stroke: dr.activeStroke,
      lineWidth: 2,
      shadowColor: dr.mainStroke,
      shadowBlur: 10
    },
    selected: {
      fill: dr.selectedFill,
      stroke: dr.selectedStroke,
      lineWidth: 4,
      shadowColor: dr.selectedStroke,
      shadowBlur: 10,
      "text-shape": {
        fontWeight: 500
      }
    },
    highlight: {
      fill: dr.highlightFill,
      stroke: dr.highlightStroke,
      lineWidth: 2,
      "text-shape": {
        fontWeight: 500
      }
    },
    inactive: {
      fill: dr.inactiveFill,
      stroke: dr.inactiveStroke,
      lineWidth: 1
    },
    disable: {
      fill: dr.disableFill,
      stroke: dr.disableStroke,
      lineWidth: 1
    }
  },
  edgeLabel: {
    style: {
      fill: vS,
      textAlign: "center",
      textBaseline: "middle",
      fontSize: 12
    }
  },
  defaultEdge: {
    type: "line",
    size: 1,
    style: {
      stroke: dr.edgeMainStroke,
      lineAppendWidth: 2
    },
    color: dr.edgeMainStroke
  },
  edgeStateStyles: {
    active: {
      stroke: dr.edgeActiveStroke,
      lineWidth: 1
    },
    selected: {
      stroke: dr.edgeSelectedStroke,
      lineWidth: 2,
      shadowColor: dr.edgeSelectedStroke,
      shadowBlur: 10,
      "text-shape": {
        fontWeight: 500
      }
    },
    highlight: {
      stroke: dr.edgeHighlightStroke,
      lineWidth: 2,
      "text-shape": {
        fontWeight: 500
      }
    },
    inactive: {
      stroke: dr.edgeInactiveStroke,
      lineWidth: 1
    },
    disable: {
      stroke: dr.edgeDisableStroke,
      lineWidth: 1
    }
  },
  comboLabel: {
    style: {
      fill: vS,
      textBaseline: "middle",
      fontSize: 12
    },
    refY: 10,
    refX: 10
  },
  defaultCombo: {
    type: "circle",
    style: {
      fill: dr.comboMainFill,
      lineWidth: 1,
      stroke: dr.comboMainStroke,
      r: 5,
      width: 20,
      height: 10
    },
    size: [20, 5],
    color: dr.comboMainStroke,
    padding: [25, 20, 15, 20]
  },
  comboStateStyles: {
    active: {
      stroke: dr.comboActiveStroke,
      lineWidth: 1,
      fill: dr.comboActiveFill
    },
    selected: {
      stroke: dr.comboSelectedStroke,
      lineWidth: 2,
      fill: dr.comboSelectedFill,
      shadowColor: dr.comboSelectedStroke,
      shadowBlur: 10,
      "text-shape": {
        fontWeight: 500
      }
    },
    highlight: {
      stroke: dr.comboHighlightStroke,
      lineWidth: 2,
      fill: dr.comboHighlightFill,
      "text-shape": {
        fontWeight: 500
      }
    },
    inactive: {
      stroke: dr.comboInactiveStroke,
      fill: dr.comboInactiveFill,
      lineWidth: 1
    },
    disable: {
      stroke: dr.comboDisableStroke,
      fill: dr.comboDisableFill,
      lineWidth: 1
    }
  },
  delegateStyle: {
    fill: "#F3F9FF",
    fillOpacity: 0.5,
    stroke: "#1890FF",
    strokeOpacity: 0.9,
    lineDash: [5, 5]
  },
  textWaterMarkerConfig: {
    width: 150,
    height: 100,
    compatible: !1,
    text: {
      x: 0,
      y: 60,
      lineHeight: 20,
      rotate: 20,
      fontSize: 14,
      fontFamily: "Microsoft YaHei",
      fill: "rgba(0, 0, 0, 0.1)",
      baseline: "Middle"
    }
  },
  imageWaterMarkerConfig: {
    width: 150,
    height: 130,
    compatible: !1,
    image: {
      x: 0,
      y: 0,
      width: 30,
      height: 20,
      rotate: 0
    }
  },
  waterMarkerImage: "https://gw.alipayobjects.com/os/s/prod/antv/assets/image/logo-with-text-73b8a.svg"
};
function Pl(r, t, e) {
  if (r) {
    if (typeof r.addEventListener == "function")
      return r.addEventListener(t, e, !1), {
        remove: function() {
          r.removeEventListener(t, e, !1);
        }
      };
    if (typeof r.attachEvent == "function")
      return r.attachEvent("on" + t, e), {
        remove: function() {
          r.detachEvent("on" + t, e);
        }
      };
  }
}
var oc, ey, qR, $m;
function Qq() {
  oc = document.createElement("table"), ey = document.createElement("tr"), qR = /^\s*<(\w+|!)[^>]*>/, $m = {
    tr: document.createElement("tbody"),
    tbody: oc,
    thead: oc,
    tfoot: oc,
    td: ey,
    th: ey,
    "*": document.createElement("div")
  };
}
function Nr(r) {
  oc || Qq();
  var t = qR.test(r) && RegExp.$1;
  (!t || !(t in $m)) && (t = "*");
  var e = $m[t];
  r = typeof r == "string" ? r.replace(/(^\s*)|(\s*$)/g, "") : r, e.innerHTML = "" + r;
  var n = e.childNodes[0];
  return n && e.contains(n) && e.removeChild(n), n;
}
function ar(r, t) {
  if (r)
    for (var e in t)
      t.hasOwnProperty(e) && (r.style[e] = t[e]);
  return r;
}
var Jq = ci.cloneEvent, eZ = ci.isViewportChanged, tZ = function(r) {
  Ht(t, r);
  function t(e) {
    var n = r.call(this, e) || this;
    return n.extendEvents = [], n.dragging = !1, n.preItem = null, n.graph = e, n.destroyed = !1, n.initEvents(), n;
  }
  return t.prototype.initEvents = function() {
    var e = this, n = e.graph, i = e.extendEvents, a = i === void 0 ? [] : i, o = n.get("canvas"), s = o.get("el"), u = If(this, "onCanvasEvents"), f = If(this, "onExtendEvents"), l = If(this, "onWheelEvent");
    o.off("*").on("*", u), this.canvasHandler = u, a.push(Pl(s, "DOMMouseScroll", l)), a.push(Pl(s, "mousewheel", l)), typeof window < "u" && (a.push(Pl(window, "keydown", f)), a.push(Pl(window, "keyup", f)), a.push(Pl(window, "focus", f)));
  }, t.getItemRoot = function(e) {
    for (; e && !e.get("item"); )
      e = e.get("parent");
    return e;
  }, t.prototype.onCanvasEvents = function(e) {
    var n = this.graph, i = n.get("canvas"), a = e.target, o = e.type;
    e.canvasX = e.x, e.canvasY = e.y;
    var s = {
      x: e.canvasX,
      y: e.canvasY
    }, u = n.get("group"), f = u.getMatrix();
    if (f || (f = [1, 0, 0, 0, 1, 0, 0, 0, 1]), eZ(f) && (s = n.getPointByClient(e.clientX, e.clientY)), e.x = s.x, e.y = s.y, e.currentTarget = n, a === i) {
      (o === "mousemove" || o === "mouseleave") && this.handleMouseMove(e, "canvas"), e.target = i, e.item = null, n.emit(o, e), n.emit("canvas:".concat(o), e);
      return;
    }
    var l = t.getItemRoot(a);
    if (!l) {
      n.emit(o, e);
      return;
    }
    var c = l.get("item");
    if (!c.destroyed) {
      var h = c.getType();
      if (e.target = a, e.item = c, e.canvasX === e.x && e.canvasY === e.y) {
        var d = n.getCanvasByPoint(e.x, e.y);
        e.canvasX = d.x, e.canvasY = d.y;
      }
      n.emit(o, e), e.name && !e.name.includes(":") ? n.emit("".concat(h, ":").concat(o), e) : n.emit(e.name, e), o === "dragstart" && (this.dragging = !0), o === "dragend" && (this.dragging = !1), o === "mousemove" && this.handleMouseMove(e, h);
    }
  }, t.prototype.onExtendEvents = function(e) {
    this.graph.emit(e.type, e);
  }, t.prototype.onWheelEvent = function(e) {
    Tt(e.wheelDelta) && (e.wheelDelta = -e.detail), this.graph.emit("wheel", e);
  }, t.prototype.handleMouseMove = function(e, n) {
    var i = this, a = i.graph, o = i.preItem, s = a.get("canvas"), u = e.target === s ? null : e.item;
    e = Jq(e), o && o !== u && !o.destroyed && (e.item = o, this.emitCustomEvent(o.getType(), "mouseleave", e), this.dragging && this.emitCustomEvent(o.getType(), "dragleave", e)), u && o !== u && (e.item = u, this.emitCustomEvent(n, "mouseenter", e), this.dragging && this.emitCustomEvent(n, "dragenter", e)), this.preItem = u;
  }, t.prototype.emitCustomEvent = function(e, n, i) {
    i.type = n, this.graph.emit("".concat(e, ":").concat(n), i);
  }, t.prototype.destroy = function() {
    var e = this, n = e.graph, i = e.canvasHandler, a = e.extendEvents, o = n.get("canvas");
    o.off("*", i), Se(a, function(s) {
      s.remove();
    }), this.dragging = !1, this.preItem = null, this.extendEvents.length = 0, this.canvasHandler = null, this.destroyed = !0;
  }, t;
}(HN), sr = {}, So = {}, an = {};
Object.defineProperty(an, "__esModule", { value: !0 });
an.Base = void 0;
var rZ = function() {
  function r() {
    this.nodes = [], this.edges = [], this.combos = [], this.comboEdges = [], this.hiddenNodes = [], this.hiddenEdges = [], this.hiddenCombos = [], this.positions = [], this.destroyed = !1, this.onLayoutEnd = function() {
    };
  }
  return r.prototype.layout = function(t) {
    return this.init(t), this.execute(!0);
  }, r.prototype.init = function(t) {
    this.nodes = t.nodes || [], this.edges = t.edges || [], this.combos = t.combos || [], this.comboEdges = t.comboEdges || [], this.hiddenNodes = t.hiddenNodes || [], this.hiddenEdges = t.hiddenEdges || [], this.hiddenCombos = t.hiddenCombos || [];
  }, r.prototype.execute = function(t) {
  }, r.prototype.executeWithWorker = function() {
  }, r.prototype.getDefaultCfg = function() {
    return {};
  }, r.prototype.updateCfg = function(t) {
    t && Object.assign(this, t);
  }, r.prototype.getType = function() {
    return "base";
  }, r.prototype.destroy = function() {
    this.nodes = null, this.edges = null, this.combos = null, this.positions = null, this.destroyed = !0;
  }, r;
}();
an.Base = rZ;
var ty = {}, Xf = {};
Object.defineProperty(Xf, "__esModule", { value: !0 });
Xf.camelize = Xf.isString = void 0;
var nZ = function(r) {
  return typeof r == "string";
};
Xf.isString = nZ;
var iZ = function(r) {
  var t = /* @__PURE__ */ Object.create(null);
  return function(e) {
    var n = t[e];
    return n || (t[e] = r(e));
  };
}, aZ = /-(\w)/g;
Xf.camelize = iZ(function(r) {
  return r.replace(aZ, function(t, e) {
    return e ? e.toUpperCase() : "";
  });
});
var qp = {};
Object.defineProperty(qp, "__esModule", { value: !0 });
qp.isArray = void 0;
qp.isArray = Array.isArray;
var Ub = {};
(function(r) {
  Object.defineProperty(r, "__esModule", { value: !0 }), r.toNumber = r.isNaN = r.isNumber = void 0;
  var t = function(i) {
    return typeof i == "number";
  };
  r.isNumber = t;
  var e = function(i) {
    return Number.isNaN(Number(i));
  };
  r.isNaN = e;
  var n = function(i) {
    var a = parseFloat(i);
    return (0, r.isNaN)(a) ? i : a;
  };
  r.toNumber = n;
})(Ub);
var Zp = {}, jb = {};
(function(r) {
  var t = Oe && Oe.__assign || function() {
    return t = Object.assign || function(i) {
      for (var a, o = 1, s = arguments.length; o < s; o++) {
        a = arguments[o];
        for (var u in a)
          Object.prototype.hasOwnProperty.call(a, u) && (i[u] = a[u]);
      }
      return i;
    }, t.apply(this, arguments);
  };
  Object.defineProperty(r, "__esModule", { value: !0 }), r.clone = r.isObject = void 0;
  var e = function(i) {
    return i !== null && typeof i == "object";
  };
  r.isObject = e;
  var n = function(i) {
    if (i === null)
      return i;
    if (i instanceof Date)
      return new Date(i.getTime());
    if (i instanceof Array) {
      var a = [];
      return i.forEach(function(s) {
        a.push(s);
      }), a.map(function(s) {
        return (0, r.clone)(s);
      });
    }
    if (typeof i == "object" && Object.keys(i).length) {
      var o = t({}, i);
      return Object.keys(o).forEach(function(s) {
        o[s] = (0, r.clone)(o[s]);
      }), o;
    }
    return i;
  };
  r.clone = n;
})(jb);
(function(r) {
  Object.defineProperty(r, "__esModule", { value: !0 }), r.getCoreNodeAndRelativeLeafNodes = r.getAvgNodePosition = r.findMinMaxNodeXY = r.traverseTreeUp = r.scaleMatrix = r.getAdjMatrix = r.floydWarshall = r.getDegreeMap = r.getDegree = r.getEdgeTerminal = void 0;
  var t = jb, e = function(g, y) {
    var b = g[y];
    return (0, t.isObject)(b) ? b.cell : b;
  };
  r.getEdgeTerminal = e;
  var n = function(g, y, b) {
    for (var m = [], x = 0; x < g; x++)
      m[x] = {
        in: 0,
        out: 0,
        all: 0
      };
    return b && b.forEach(function(_) {
      var w = (0, r.getEdgeTerminal)(_, "source"), E = (0, r.getEdgeTerminal)(_, "target");
      w && m[y[w]] && (m[y[w]].out += 1, m[y[w]].all += 1), E && m[y[E]] && (m[y[E]].in += 1, m[y[E]].all += 1);
    }), m;
  };
  r.getDegree = n;
  var i = function(g, y) {
    var b = {};
    return g.forEach(function(m) {
      b[m.id] = {
        in: 0,
        out: 0,
        all: 0
      };
    }), y && y.forEach(function(m) {
      var x = (0, r.getEdgeTerminal)(m, "source"), _ = (0, r.getEdgeTerminal)(m, "target");
      x && (b[x].out += 1, b[x].all += 1), _ && (b[_].in += 1, b[_].all += 1);
    }), b;
  };
  r.getDegreeMap = i;
  var a = function(g) {
    for (var y = [], b = g.length, m = 0; m < b; m += 1) {
      y[m] = [];
      for (var x = 0; x < b; x += 1)
        m === x ? y[m][x] = 0 : g[m][x] === 0 || !g[m][x] ? y[m][x] = 1 / 0 : y[m][x] = g[m][x];
    }
    for (var _ = 0; _ < b; _ += 1)
      for (var m = 0; m < b; m += 1)
        for (var x = 0; x < b; x += 1)
          y[m][x] > y[m][_] + y[_][x] && (y[m][x] = y[m][_] + y[_][x]);
    return y;
  };
  r.floydWarshall = a;
  var o = function(g, y) {
    var b = g.nodes, m = g.edges, x = [], _ = {};
    if (!b)
      throw new Error("invalid nodes data!");
    return b && b.forEach(function(w, E) {
      _[w.id] = E;
      var M = [];
      x.push(M);
    }), m == null || m.forEach(function(w) {
      var E = (0, r.getEdgeTerminal)(w, "source"), M = (0, r.getEdgeTerminal)(w, "target"), C = _[E], S = _[M];
      C === void 0 || S === void 0 || (x[C][S] = 1, y || (x[S][C] = 1));
    }), x;
  };
  r.getAdjMatrix = o;
  var s = function(g, y) {
    var b = [];
    return g.forEach(function(m) {
      var x = [];
      m.forEach(function(_) {
        x.push(_ * y);
      }), b.push(x);
    }), b;
  };
  r.scaleMatrix = s;
  var u = function(g, y) {
    if (g && g.children) {
      for (var b = g.children.length - 1; b >= 0; b--)
        if (!u(g.children[b], y))
          return;
    }
    return !!y(g);
  }, f = function(g, y) {
    typeof y == "function" && u(g, y);
  };
  r.traverseTreeUp = f;
  var l = function(g) {
    var y = 1 / 0, b = 1 / 0, m = -1 / 0, x = -1 / 0;
    return g.forEach(function(_) {
      y > _.x && (y = _.x), b > _.y && (b = _.y), m < _.x && (m = _.x), x < _.y && (x = _.y);
    }), { minX: y, minY: b, maxX: m, maxY: x };
  };
  r.findMinMaxNodeXY = l;
  var c = function(g) {
    var y = { x: 0, y: 0 };
    g.forEach(function(m) {
      y.x += m.x || 0, y.y += m.y || 0;
    });
    var b = g.length || 1;
    return {
      x: y.x / b,
      y: y.y / b
    };
  };
  r.getAvgNodePosition = c;
  var h = function(g, y, b) {
    var m, x;
    return g === "source" ? ((m = b == null ? void 0 : b.find(function(_) {
      return _.target === y.id;
    })) === null || m === void 0 ? void 0 : m.source) || {} : ((x = b == null ? void 0 : b.find(function(_) {
      return _.source === y.id;
    })) === null || x === void 0 ? void 0 : x.target) || {};
  }, d = function(g, y, b) {
    var m = [];
    switch (g) {
      case "source":
        m = b == null ? void 0 : b.filter(function(_) {
          return _.source === y.id;
        }).map(function(_) {
          return _.target;
        });
        break;
      case "target":
        m = b == null ? void 0 : b.filter(function(_) {
          return _.target === y.id;
        }).map(function(_) {
          return _.source;
        });
        break;
      case "both":
        m = b == null ? void 0 : b.filter(function(_) {
          return _.source === y.id;
        }).map(function(_) {
          return _.target;
        }).concat(b == null ? void 0 : b.filter(function(_) {
          return _.target === y.id;
        }).map(function(_) {
          return _.source;
        }));
        break;
    }
    var x = new Set(m);
    return Array.from(x);
  }, v = function(g, y, b, m, x) {
    var _ = b[y] || "", w = (m == null ? void 0 : m.filter(function(E) {
      return E[y] === _;
    })) || [];
    return g === "leaf" && (w = w.filter(function(E) {
      var M, C;
      return ((M = x[E.id]) === null || M === void 0 ? void 0 : M.in) === 0 || ((C = x[E.id]) === null || C === void 0 ? void 0 : C.out) === 0;
    })), w;
  }, p = function(g, y, b, m, x, _) {
    var w = x[y.id], E = w.in, M = w.out, C = y, S = [];
    E === 0 ? (C = h("source", y, b), S = d("both", C, b).map(function(T) {
      return _[T];
    })) : M === 0 && (C = h("target", y, b), S = d("both", C, b).map(function(T) {
      return _[T];
    })), S = S.filter(function(T) {
      return x[T.id] && (x[T.id].in === 0 || x[T.id].out === 0);
    });
    var A = v(g, m, y, S, x);
    return { coreNode: C, relativeLeafNodes: S, sameTypeLeafNodes: A };
  };
  r.getCoreNodeAndRelativeLeafNodes = p;
})(Zp);
var ry = {}, pS;
function oZ() {
  return pS || (pS = 1, function(r) {
    Object.defineProperty(r, "__esModule", { value: !0 }), r.getFuncByUnknownType = r.getFunc = r.isFunction = void 0;
    var t = on(), e = Ub, n = function(o) {
      return typeof o == "function";
    };
    r.isFunction = n;
    var i = function(o, s, u) {
      var f;
      return u ? f = u : (0, e.isNumber)(o) ? f = function() {
        return o;
      } : f = function() {
        return s;
      }, f;
    };
    r.getFunc = i;
    var a = function(o, s, u) {
      return u === void 0 && (u = !0), !s && s !== 0 ? function(f) {
        return f.size ? (0, t.isArray)(f.size) ? f.size[0] > f.size[1] ? f.size[0] : f.size[1] : (0, t.isObject)(f.size) ? f.size.width > f.size.height ? f.size.width : f.size.height : f.size : o;
      } : (0, r.isFunction)(s) ? s : (0, e.isNumber)(s) ? function() {
        return s;
      } : (0, t.isArray)(s) ? function() {
        if (u) {
          var f = Math.max.apply(Math, s);
          return isNaN(f) ? o : f;
        }
        return s;
      } : (0, t.isObject)(s) ? function() {
        if (u) {
          var f = Math.max(s.width, s.height);
          return isNaN(f) ? o : f;
        }
        return [s.width, s.height];
      } : function() {
        return o;
      };
    };
    r.getFuncByUnknownType = a;
  }(ry)), ry;
}
var gS;
function on() {
  return gS || (gS = 1, function(r) {
    var t = Oe && Oe.__createBinding || (Object.create ? function(n, i, a, o) {
      o === void 0 && (o = a);
      var s = Object.getOwnPropertyDescriptor(i, a);
      (!s || ("get" in s ? !i.__esModule : s.writable || s.configurable)) && (s = { enumerable: !0, get: function() {
        return i[a];
      } }), Object.defineProperty(n, o, s);
    } : function(n, i, a, o) {
      o === void 0 && (o = a), n[o] = i[a];
    }), e = Oe && Oe.__exportStar || function(n, i) {
      for (var a in n)
        a !== "default" && !Object.prototype.hasOwnProperty.call(i, a) && t(i, n, a);
    };
    Object.defineProperty(r, "__esModule", { value: !0 }), e(Xf, r), e(qp, r), e(Ub, r), e(Zp, r), e(jb, r), e(oZ(), r);
  }(ty)), ty;
}
var sZ = Oe && Oe.__extends || function() {
  var r = function(t, e) {
    return r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(n, i) {
      n.__proto__ = i;
    } || function(n, i) {
      for (var a in i)
        Object.prototype.hasOwnProperty.call(i, a) && (n[a] = i[a]);
    }, r(t, e);
  };
  return function(t, e) {
    if (typeof e != "function" && e !== null)
      throw new TypeError("Class extends value " + String(e) + " is not a constructor or null");
    r(t, e);
    function n() {
      this.constructor = t;
    }
    t.prototype = e === null ? Object.create(e) : (n.prototype = e.prototype, new n());
  };
}();
Object.defineProperty(So, "__esModule", { value: !0 });
So.getLayoutByName = So.unRegisterLayout = So.registerLayout = void 0;
var uZ = an, fZ = on(), as = /* @__PURE__ */ new Map(), lZ = function(r, t) {
  if (as.get(r) && console.warn("The layout with the name ".concat(r, " exists already, it will be overridden")), (0, fZ.isObject)(t)) {
    var e = function(n) {
      sZ(i, n);
      function i(a) {
        var o = n.call(this) || this, s = o, u = {}, f = s.getDefaultCfg();
        return Object.assign(u, f, t, a), Object.keys(u).forEach(function(l) {
          var c = u[l];
          s[l] = c;
        }), o;
      }
      return i;
    }(uZ.Base);
    as.set(r, e);
  } else
    as.set(r, t);
  return as.get(r);
};
So.registerLayout = lZ;
var cZ = function(r) {
  as.has(r) && as.delete(r);
};
So.unRegisterLayout = cZ;
var hZ = function(r) {
  return as.has(r) ? as.get(r) : null;
};
So.getLayoutByName = hZ;
var ny = {}, sh = {}, dZ = Oe && Oe.__extends || function() {
  var r = function(t, e) {
    return r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(n, i) {
      n.__proto__ = i;
    } || function(n, i) {
      for (var a in i)
        Object.prototype.hasOwnProperty.call(i, a) && (n[a] = i[a]);
    }, r(t, e);
  };
  return function(t, e) {
    if (typeof e != "function" && e !== null)
      throw new TypeError("Class extends value " + String(e) + " is not a constructor or null");
    r(t, e);
    function n() {
      this.constructor = t;
    }
    t.prototype = e === null ? Object.create(e) : (n.prototype = e.prototype, new n());
  };
}();
Object.defineProperty(sh, "__esModule", { value: !0 });
sh.GridLayout = void 0;
var Qu = on(), vZ = an, pZ = function(r) {
  dZ(t, r);
  function t(e) {
    var n = r.call(this) || this;
    return n.begin = [0, 0], n.preventOverlap = !0, n.preventOverlapPadding = 10, n.condense = !1, n.sortBy = "degree", n.nodes = [], n.edges = [], n.width = 300, n.height = 300, n.row = 0, n.col = 0, n.cellWidth = 0, n.cellHeight = 0, n.cellUsed = {}, n.id2manPos = {}, n.onLayoutEnd = function() {
    }, n.updateCfg(e), n;
  }
  return t.prototype.getDefaultCfg = function() {
    return {
      begin: [0, 0],
      preventOverlap: !0,
      preventOverlapPadding: 10,
      condense: !1,
      rows: void 0,
      cols: void 0,
      position: void 0,
      sortBy: "degree",
      nodeSize: 30
    };
  }, t.prototype.execute = function() {
    var e = this, n = e.nodes, i = e.edges, a = e.begin, o = n.length;
    if (o === 0)
      return e.onLayoutEnd && e.onLayoutEnd(), {
        nodes: n,
        edges: i
      };
    if (o === 1)
      return n[0].x = a[0], n[0].y = a[1], e.onLayoutEnd && e.onLayoutEnd(), {
        nodes: n,
        edges: i
      };
    var s = e.sortBy, u = e.width, f = e.height, l = e.condense, c = e.preventOverlapPadding, h = e.preventOverlap, d = e.nodeSpacing, v = e.nodeSize, p = [];
    n.forEach(function(T) {
      p.push(T);
    });
    var g = {};
    if (p.forEach(function(T, P) {
      g[T.id] = P;
    }), (s === "degree" || !(0, Qu.isString)(s) || p[0][s] === void 0) && (s = "degree", (0, Qu.isNaN)(n[0].degree))) {
      var y = (0, Qu.getDegree)(p.length, g, i);
      p.forEach(function(T, P) {
        T.degree = y[P].all;
      });
    }
    p.sort(function(T, P) {
      return P[s] - T[s];
    }), !u && typeof window < "u" && (u = window.innerWidth), !f && typeof window < "u" && (f = window.innerHeight);
    var b = e.rows, m = e.cols != null ? e.cols : e.columns;
    if (e.cells = o, b != null && m != null ? (e.rows = b, e.cols = m) : b != null && m == null ? (e.rows = b, e.cols = Math.ceil(e.cells / e.rows)) : b == null && m != null ? (e.cols = m, e.rows = Math.ceil(e.cells / e.cols)) : (e.splits = Math.sqrt(e.cells * e.height / e.width), e.rows = Math.round(e.splits), e.cols = Math.round(e.width / e.height * e.splits)), e.rows = Math.max(e.rows, 1), e.cols = Math.max(e.cols, 1), e.cols * e.rows > e.cells) {
      var x = e.small(), _ = e.large();
      (x - 1) * _ >= e.cells ? e.small(x - 1) : (_ - 1) * x >= e.cells && e.large(_ - 1);
    } else
      for (; e.cols * e.rows < e.cells; ) {
        var x = e.small(), _ = e.large();
        (_ + 1) * x >= e.cells ? e.large(_ + 1) : e.small(x + 1);
      }
    if (e.cellWidth = u / e.cols, e.cellHeight = f / e.rows, l && (e.cellWidth = 0, e.cellHeight = 0), h || d) {
      var w = (0, Qu.getFuncByUnknownType)(10, d), E = (0, Qu.getFuncByUnknownType)(30, v, !1);
      p.forEach(function(T) {
        (!T.x || !T.y) && (T.x = 0, T.y = 0);
        var P = E(T) || 30, k, L;
        (0, Qu.isArray)(P) ? (k = P[0], L = P[1]) : (k = P, L = P);
        var O = w !== void 0 ? w(T) : c, D = k + O, G = L + O;
        e.cellWidth = Math.max(e.cellWidth, D), e.cellHeight = Math.max(e.cellHeight, G);
      });
    }
    e.cellUsed = {}, e.row = 0, e.col = 0, e.id2manPos = {};
    for (var M = 0; M < p.length; M++) {
      var C = p[M], S = void 0;
      if (e.position && (S = e.position(C)), S && (S.row !== void 0 || S.col !== void 0)) {
        var A = {
          row: S.row,
          col: S.col
        };
        if (A.col === void 0)
          for (A.col = 0; e.used(A.row, A.col); )
            A.col++;
        else if (A.row === void 0)
          for (A.row = 0; e.used(A.row, A.col); )
            A.row++;
        e.id2manPos[C.id] = A, e.use(A.row, A.col);
      }
      e.getPos(C);
    }
    return e.onLayoutEnd && e.onLayoutEnd(), {
      edges: i,
      nodes: p
    };
  }, t.prototype.small = function(e) {
    var n = this, i, a = n.rows || 5, o = n.cols || 5;
    if (e == null)
      i = Math.min(a, o);
    else {
      var s = Math.min(a, o);
      s === n.rows ? n.rows = e : n.cols = e;
    }
    return i;
  }, t.prototype.large = function(e) {
    var n = this, i, a = n.rows || 5, o = n.cols || 5;
    if (e == null)
      i = Math.max(a, o);
    else {
      var s = Math.max(a, o);
      s === n.rows ? n.rows = e : n.cols = e;
    }
    return i;
  }, t.prototype.used = function(e, n) {
    var i = this;
    return i.cellUsed["c-".concat(e, "-").concat(n)] || !1;
  }, t.prototype.use = function(e, n) {
    var i = this;
    i.cellUsed["c-".concat(e, "-").concat(n)] = !0;
  }, t.prototype.moveToNextCell = function() {
    var e = this, n = e.cols || 5;
    e.col++, e.col >= n && (e.col = 0, e.row++);
  }, t.prototype.getPos = function(e) {
    var n = this, i = n.begin, a = n.cellWidth, o = n.cellHeight, s, u, f = n.id2manPos[e.id];
    if (f)
      s = f.col * a + a / 2 + i[0], u = f.row * o + o / 2 + i[1];
    else {
      for (; n.used(n.row, n.col); )
        n.moveToNextCell();
      s = n.col * a + a / 2 + i[0], u = n.row * o + o / 2 + i[1], n.use(n.row, n.col), n.moveToNextCell();
    }
    e.x = s, e.y = u;
  }, t.prototype.getType = function() {
    return "grid";
  }, t;
}(vZ.Base);
sh.GridLayout = pZ;
var uh = {}, gZ = Oe && Oe.__extends || function() {
  var r = function(t, e) {
    return r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(n, i) {
      n.__proto__ = i;
    } || function(n, i) {
      for (var a in i)
        Object.prototype.hasOwnProperty.call(i, a) && (n[a] = i[a]);
    }, r(t, e);
  };
  return function(t, e) {
    if (typeof e != "function" && e !== null)
      throw new TypeError("Class extends value " + String(e) + " is not a constructor or null");
    r(t, e);
    function n() {
      this.constructor = t;
    }
    t.prototype = e === null ? Object.create(e) : (n.prototype = e.prototype, new n());
  };
}();
Object.defineProperty(uh, "__esModule", { value: !0 });
uh.RandomLayout = void 0;
var yZ = an, mZ = function(r) {
  gZ(t, r);
  function t(e) {
    var n = r.call(this) || this;
    return n.center = [0, 0], n.width = 300, n.height = 300, n.nodes = [], n.edges = [], n.onLayoutEnd = function() {
    }, n.updateCfg(e), n;
  }
  return t.prototype.getDefaultCfg = function() {
    return {
      center: [0, 0],
      width: 300,
      height: 300
    };
  }, t.prototype.execute = function() {
    var e = this, n = e.nodes, i = 0.9, a = e.center;
    return !e.width && typeof window < "u" && (e.width = window.innerWidth), !e.height && typeof window < "u" && (e.height = window.innerHeight), n && n.forEach(function(o) {
      o.x = (Math.random() - 0.5) * i * e.width + a[0], o.y = (Math.random() - 0.5) * i * e.height + a[1];
    }), e.onLayoutEnd && e.onLayoutEnd(), {
      nodes: n,
      edges: this.edges
    };
  }, t.prototype.getType = function() {
    return "random";
  }, t;
}(yZ.Base);
uh.RandomLayout = mZ;
var fh = {}, bZ = Oe && Oe.__extends || function() {
  var r = function(t, e) {
    return r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(n, i) {
      n.__proto__ = i;
    } || function(n, i) {
      for (var a in i)
        Object.prototype.hasOwnProperty.call(i, a) && (n[a] = i[a]);
    }, r(t, e);
  };
  return function(t, e) {
    if (typeof e != "function" && e !== null)
      throw new TypeError("Class extends value " + String(e) + " is not a constructor or null");
    r(t, e);
    function n() {
      this.constructor = t;
    }
    t.prototype = e === null ? Object.create(e) : (n.prototype = e.prototype, new n());
  };
}();
Object.defineProperty(fh, "__esModule", { value: !0 });
fh.GForceLayout = void 0;
var xZ = an, Wn = on(), iy = function(r, t) {
  var e;
  return r ? (0, Wn.isNumber)(r) ? e = function(n) {
    return r;
  } : e = r : e = function(n) {
    return t || 1;
  }, e;
}, _Z = function(r) {
  bZ(t, r);
  function t(e) {
    var n = r.call(this) || this;
    return n.maxIteration = 500, n.workerEnabled = !1, n.edgeStrength = 200, n.nodeStrength = 1e3, n.coulombDisScale = 5e-3, n.damping = 0.9, n.maxSpeed = 1e3, n.minMovement = 0.5, n.interval = 0.02, n.factor = 1, n.linkDistance = 1, n.gravity = 10, n.preventOverlap = !0, n.collideStrength = 1, n.tick = function() {
    }, n.nodes = [], n.edges = [], n.width = 300, n.height = 300, n.nodeMap = {}, n.nodeIdxMap = {}, n.animate = !0, n.updateCfg(e), n;
  }
  return t.prototype.getDefaultCfg = function() {
    return {
      maxIteration: 500,
      gravity: 10,
      enableTick: !0,
      animate: !0
    };
  }, t.prototype.execute = function() {
    var e, n, i = this, a = i.nodes;
    if (i.timeInterval !== void 0 && typeof window < "u" && window.clearInterval(i.timeInterval), !a || a.length === 0) {
      (e = i.onLayoutEnd) === null || e === void 0 || e.call(i);
      return;
    }
    !i.width && typeof window < "u" && (i.width = window.innerWidth), !i.height && typeof window < "u" && (i.height = window.innerHeight), i.center || (i.center = [i.width / 2, i.height / 2]);
    var o = i.center;
    if (a.length === 1) {
      a[0].x = o[0], a[0].y = o[1], (n = i.onLayoutEnd) === null || n === void 0 || n.call(i);
      return;
    }
    var s = {}, u = {};
    a.forEach(function(v, p) {
      (0, Wn.isNumber)(v.x) || (v.x = Math.random() * i.width), (0, Wn.isNumber)(v.y) || (v.y = Math.random() * i.height), s[v.id] = v, u[v.id] = p;
    }), i.nodeMap = s, i.nodeIdxMap = u, i.linkDistance = iy(i.linkDistance, 1), i.nodeStrength = iy(i.nodeStrength, 1), i.edgeStrength = iy(i.edgeStrength, 1);
    var f = i.nodeSize, l;
    if (i.preventOverlap) {
      var c = i.nodeSpacing, h;
      (0, Wn.isNumber)(c) ? h = function() {
        return c;
      } : (0, Wn.isFunction)(c) ? h = c : h = function() {
        return 0;
      }, f ? (0, Wn.isArray)(f) ? l = function(v) {
        return Math.max(f[0], f[1]) + h(v);
      } : l = function(v) {
        return f + h(v);
      } : l = function(v) {
        return v.size ? (0, Wn.isArray)(v.size) ? Math.max(v.size[0], v.size[1]) + h(v) : (0, Wn.isObject)(v.size) ? Math.max(v.size.width, v.size.height) + h(v) : v.size + h(v) : 10 + h(v);
      };
    }
    i.nodeSize = l;
    var d = i.edges;
    i.degrees = (0, Wn.getDegree)(a.length, i.nodeIdxMap, d), i.getMass || (i.getMass = function(v) {
      var p = v.mass || i.degrees[i.nodeIdxMap[v.id]].all || 1;
      return p;
    }), i.run();
  }, t.prototype.run = function() {
    var e, n = this, i = n.maxIteration, a = n.nodes, o = n.workerEnabled, s = n.minMovement, u = n.animate;
    if (!!a)
      if (o || !u) {
        for (var f = 0; f < i; f++) {
          var l = n.runOneStep(f);
          if (n.reachMoveThreshold(a, l, s))
            break;
        }
        (e = n.onLayoutEnd) === null || e === void 0 || e.call(n);
      } else {
        if (typeof window > "u")
          return;
        var c = 0;
        this.timeInterval = window.setInterval(function() {
          var h, d;
          if (!!a) {
            var v = n.runOneStep(c) || [];
            n.reachMoveThreshold(a, v, s) && ((h = n.onLayoutEnd) === null || h === void 0 || h.call(n), window.clearInterval(n.timeInterval)), c++, c >= i && ((d = n.onLayoutEnd) === null || d === void 0 || d.call(n), window.clearInterval(n.timeInterval));
          }
        }, 0);
      }
  }, t.prototype.reachMoveThreshold = function(e, n, i) {
    var a = 0;
    return e.forEach(function(o, s) {
      var u = o.x - n[s].x, f = o.y - n[s].y;
      a += Math.sqrt(u * u + f * f);
    }), a /= e.length, a < i;
  }, t.prototype.runOneStep = function(e) {
    var n, i = this, a = i.nodes, o = i.edges, s = [], u = [];
    if (!!a) {
      a.forEach(function(c, h) {
        s[2 * h] = 0, s[2 * h + 1] = 0, u[2 * h] = 0, u[2 * h + 1] = 0;
      }), i.calRepulsive(s, a), o && i.calAttractive(s, o), i.calGravity(s, a);
      var f = Math.max(0.02, i.interval - e * 2e-3);
      i.updateVelocity(s, u, f, a);
      var l = [];
      return a.forEach(function(c) {
        l.push({
          x: c.x,
          y: c.y
        });
      }), i.updatePosition(u, f, a), (n = i.tick) === null || n === void 0 || n.call(i), l;
    }
  }, t.prototype.calRepulsive = function(e, n) {
    var i = this, a = i.getMass, o = i.factor, s = i.coulombDisScale, u = i.preventOverlap, f = i.collideStrength, l = f === void 0 ? 1 : f, c = i.nodeStrength, h = i.nodeSize;
    n.forEach(function(d, v) {
      var p = a ? a(d) : 1;
      n.forEach(function(g, y) {
        if (!(v >= y)) {
          var b = d.x - g.x, m = d.y - g.y;
          b === 0 && m === 0 && (b = Math.random() * 0.01, m = Math.random() * 0.01);
          var x = b * b + m * m, _ = Math.sqrt(x), w = (_ + 0.1) * s, E = b / _, M = m / _, C = (c(d) + c(g)) * 0.5 * o / (w * w), S = a ? a(g) : 1;
          if (e[2 * v] += E * C, e[2 * v + 1] += M * C, e[2 * y] -= E * C, e[2 * y + 1] -= M * C, u && (h(d) + h(g)) / 2 > _) {
            var A = l * (c(d) + c(g)) * 0.5 / x;
            e[2 * v] += E * A / p, e[2 * v + 1] += M * A / p, e[2 * y] -= E * A / S, e[2 * y + 1] -= M * A / S;
          }
        }
      });
    });
  }, t.prototype.calAttractive = function(e, n) {
    var i = this, a = i.nodeMap, o = i.nodeIdxMap, s = i.linkDistance, u = i.edgeStrength, f = i.nodeSize, l = i.getMass;
    n.forEach(function(c, h) {
      var d = (0, Wn.getEdgeTerminal)(c, "source"), v = (0, Wn.getEdgeTerminal)(c, "target"), p = a[d], g = a[v], y = g.x - p.x, b = g.y - p.y;
      y === 0 && b === 0 && (y = Math.random() * 0.01, b = Math.random() * 0.01);
      var m = Math.sqrt(y * y + b * b), x = y / m, _ = b / m, w = s(c, p, g) || 1 + (f(p) + f(p) || 0) / 2, E = w - m, M = E * u(c), C = o[d], S = o[v], A = l ? l(p) : 1, T = l ? l(g) : 1;
      e[2 * C] -= x * M / A, e[2 * C + 1] -= _ * M / A, e[2 * S] += x * M / T, e[2 * S + 1] += _ * M / T;
    });
  }, t.prototype.calGravity = function(e, n) {
    for (var i = this, a = i.center, o = i.gravity, s = i.degrees, u = n.length, f = 0; f < u; f++) {
      var l = n[f], c = l.x - a[0], h = l.y - a[1], d = o;
      if (i.getCenter) {
        var v = i.getCenter(l, s[f].all);
        v && (0, Wn.isNumber)(v[0]) && (0, Wn.isNumber)(v[1]) && (0, Wn.isNumber)(v[2]) && (c = l.x - v[0], h = l.y - v[1], d = v[2]);
      }
      !d || (e[2 * f] -= d * c, e[2 * f + 1] -= d * h);
    }
  }, t.prototype.updateVelocity = function(e, n, i, a) {
    var o = this, s = i * o.damping;
    a.forEach(function(u, f) {
      var l = e[2 * f] * s || 0.01, c = e[2 * f + 1] * s || 0.01, h = Math.sqrt(l * l + c * c);
      if (h > o.maxSpeed) {
        var d = o.maxSpeed / h;
        l = d * l, c = d * c;
      }
      n[2 * f] = l, n[2 * f + 1] = c;
    });
  }, t.prototype.updatePosition = function(e, n, i) {
    i.forEach(function(a, o) {
      if ((0, Wn.isNumber)(a.fx) && (0, Wn.isNumber)(a.fy)) {
        a.x = a.fx, a.y = a.fy;
        return;
      }
      var s = e[2 * o] * n, u = e[2 * o + 1] * n;
      a.x += s, a.y += u;
    });
  }, t.prototype.stop = function() {
    this.timeInterval && typeof window < "u" && window.clearInterval(this.timeInterval);
  }, t.prototype.destroy = function() {
    var e = this;
    e.stop(), e.tick = null, e.nodes = null, e.edges = null, e.destroyed = !0;
  }, t.prototype.getType = function() {
    return "gForce";
  }, t;
}(xZ.Base);
fh.GForceLayout = _Z;
var lh = {}, Qp = {};
function wZ(r) {
  const t = +this._x.call(null, r), e = +this._y.call(null, r);
  return ZR(this.cover(t, e), t, e, r);
}
function ZR(r, t, e, n) {
  if (isNaN(t) || isNaN(e))
    return r;
  var i, a = r._root, o = { data: n }, s = r._x0, u = r._y0, f = r._x1, l = r._y1, c, h, d, v, p, g, y, b;
  if (!a)
    return r._root = o, r;
  for (; a.length; )
    if ((p = t >= (c = (s + f) / 2)) ? s = c : f = c, (g = e >= (h = (u + l) / 2)) ? u = h : l = h, i = a, !(a = a[y = g << 1 | p]))
      return i[y] = o, r;
  if (d = +r._x.call(null, a.data), v = +r._y.call(null, a.data), t === d && e === v)
    return o.next = a, i ? i[y] = o : r._root = o, r;
  do
    i = i ? i[y] = new Array(4) : r._root = new Array(4), (p = t >= (c = (s + f) / 2)) ? s = c : f = c, (g = e >= (h = (u + l) / 2)) ? u = h : l = h;
  while ((y = g << 1 | p) === (b = (v >= h) << 1 | d >= c));
  return i[b] = a, i[y] = o, r;
}
function EZ(r) {
  var t, e, n = r.length, i, a, o = new Array(n), s = new Array(n), u = 1 / 0, f = 1 / 0, l = -1 / 0, c = -1 / 0;
  for (e = 0; e < n; ++e)
    isNaN(i = +this._x.call(null, t = r[e])) || isNaN(a = +this._y.call(null, t)) || (o[e] = i, s[e] = a, i < u && (u = i), i > l && (l = i), a < f && (f = a), a > c && (c = a));
  if (u > l || f > c)
    return this;
  for (this.cover(u, f).cover(l, c), e = 0; e < n; ++e)
    ZR(this, o[e], s[e], r[e]);
  return this;
}
function SZ(r, t) {
  if (isNaN(r = +r) || isNaN(t = +t))
    return this;
  var e = this._x0, n = this._y0, i = this._x1, a = this._y1;
  if (isNaN(e))
    i = (e = Math.floor(r)) + 1, a = (n = Math.floor(t)) + 1;
  else {
    for (var o = i - e || 1, s = this._root, u, f; e > r || r >= i || n > t || t >= a; )
      switch (f = (t < n) << 1 | r < e, u = new Array(4), u[f] = s, s = u, o *= 2, f) {
        case 0:
          i = e + o, a = n + o;
          break;
        case 1:
          e = i - o, a = n + o;
          break;
        case 2:
          i = e + o, n = a - o;
          break;
        case 3:
          e = i - o, n = a - o;
          break;
      }
    this._root && this._root.length && (this._root = s);
  }
  return this._x0 = e, this._y0 = n, this._x1 = i, this._y1 = a, this;
}
function MZ() {
  var r = [];
  return this.visit(function(t) {
    if (!t.length)
      do
        r.push(t.data);
      while (t = t.next);
  }), r;
}
function CZ(r) {
  return arguments.length ? this.cover(+r[0][0], +r[0][1]).cover(+r[1][0], +r[1][1]) : isNaN(this._x0) ? void 0 : [[this._x0, this._y0], [this._x1, this._y1]];
}
function ei(r, t, e, n, i) {
  this.node = r, this.x0 = t, this.y0 = e, this.x1 = n, this.y1 = i;
}
function TZ(r, t, e) {
  var n, i = this._x0, a = this._y0, o, s, u, f, l = this._x1, c = this._y1, h = [], d = this._root, v, p;
  for (d && h.push(new ei(d, i, a, l, c)), e == null ? e = 1 / 0 : (i = r - e, a = t - e, l = r + e, c = t + e, e *= e); v = h.pop(); )
    if (!(!(d = v.node) || (o = v.x0) > l || (s = v.y0) > c || (u = v.x1) < i || (f = v.y1) < a))
      if (d.length) {
        var g = (o + u) / 2, y = (s + f) / 2;
        h.push(
          new ei(d[3], g, y, u, f),
          new ei(d[2], o, y, g, f),
          new ei(d[1], g, s, u, y),
          new ei(d[0], o, s, g, y)
        ), (p = (t >= y) << 1 | r >= g) && (v = h[h.length - 1], h[h.length - 1] = h[h.length - 1 - p], h[h.length - 1 - p] = v);
      } else {
        var b = r - +this._x.call(null, d.data), m = t - +this._y.call(null, d.data), x = b * b + m * m;
        if (x < e) {
          var _ = Math.sqrt(e = x);
          i = r - _, a = t - _, l = r + _, c = t + _, n = d.data;
        }
      }
  return n;
}
function AZ(r) {
  if (isNaN(l = +this._x.call(null, r)) || isNaN(c = +this._y.call(null, r)))
    return this;
  var t, e = this._root, n, i, a, o = this._x0, s = this._y0, u = this._x1, f = this._y1, l, c, h, d, v, p, g, y;
  if (!e)
    return this;
  if (e.length)
    for (; ; ) {
      if ((v = l >= (h = (o + u) / 2)) ? o = h : u = h, (p = c >= (d = (s + f) / 2)) ? s = d : f = d, t = e, !(e = e[g = p << 1 | v]))
        return this;
      if (!e.length)
        break;
      (t[g + 1 & 3] || t[g + 2 & 3] || t[g + 3 & 3]) && (n = t, y = g);
    }
  for (; e.data !== r; )
    if (i = e, !(e = e.next))
      return this;
  return (a = e.next) && delete e.next, i ? (a ? i.next = a : delete i.next, this) : t ? (a ? t[g] = a : delete t[g], (e = t[0] || t[1] || t[2] || t[3]) && e === (t[3] || t[2] || t[1] || t[0]) && !e.length && (n ? n[y] = e : this._root = e), this) : (this._root = a, this);
}
function IZ(r) {
  for (var t = 0, e = r.length; t < e; ++t)
    this.remove(r[t]);
  return this;
}
function PZ() {
  return this._root;
}
function OZ() {
  var r = 0;
  return this.visit(function(t) {
    if (!t.length)
      do
        ++r;
      while (t = t.next);
  }), r;
}
function DZ(r) {
  var t = [], e, n = this._root, i, a, o, s, u;
  for (n && t.push(new ei(n, this._x0, this._y0, this._x1, this._y1)); e = t.pop(); )
    if (!r(n = e.node, a = e.x0, o = e.y0, s = e.x1, u = e.y1) && n.length) {
      var f = (a + s) / 2, l = (o + u) / 2;
      (i = n[3]) && t.push(new ei(i, f, l, s, u)), (i = n[2]) && t.push(new ei(i, a, l, f, u)), (i = n[1]) && t.push(new ei(i, f, o, s, l)), (i = n[0]) && t.push(new ei(i, a, o, f, l));
    }
  return this;
}
function kZ(r) {
  var t = [], e = [], n;
  for (this._root && t.push(new ei(this._root, this._x0, this._y0, this._x1, this._y1)); n = t.pop(); ) {
    var i = n.node;
    if (i.length) {
      var a, o = n.x0, s = n.y0, u = n.x1, f = n.y1, l = (o + u) / 2, c = (s + f) / 2;
      (a = i[0]) && t.push(new ei(a, o, s, l, c)), (a = i[1]) && t.push(new ei(a, l, s, u, c)), (a = i[2]) && t.push(new ei(a, o, c, l, f)), (a = i[3]) && t.push(new ei(a, l, c, u, f));
    }
    e.push(n);
  }
  for (; n = e.pop(); )
    r(n.node, n.x0, n.y0, n.x1, n.y1);
  return this;
}
function LZ(r) {
  return r[0];
}
function NZ(r) {
  return arguments.length ? (this._x = r, this) : this._x;
}
function RZ(r) {
  return r[1];
}
function BZ(r) {
  return arguments.length ? (this._y = r, this) : this._y;
}
function Jp(r, t, e) {
  var n = new $b(t == null ? LZ : t, e == null ? RZ : e, NaN, NaN, NaN, NaN);
  return r == null ? n : n.addAll(r);
}
function $b(r, t, e, n, i, a) {
  this._x = r, this._y = t, this._x0 = e, this._y0 = n, this._x1 = i, this._y1 = a, this._root = void 0;
}
function yS(r) {
  for (var t = { data: r.data }, e = t; r = r.next; )
    e = e.next = { data: r.data };
  return t;
}
var ti = Jp.prototype = $b.prototype;
ti.copy = function() {
  var r = new $b(this._x, this._y, this._x0, this._y0, this._x1, this._y1), t = this._root, e, n;
  if (!t)
    return r;
  if (!t.length)
    return r._root = yS(t), r;
  for (e = [{ source: t, target: r._root = new Array(4) }]; t = e.pop(); )
    for (var i = 0; i < 4; ++i)
      (n = t.source[i]) && (n.length ? e.push({ source: n, target: t.target[i] = new Array(4) }) : t.target[i] = yS(n));
  return r;
};
ti.add = wZ;
ti.addAll = EZ;
ti.cover = SZ;
ti.data = MZ;
ti.extent = CZ;
ti.find = TZ;
ti.remove = AZ;
ti.removeAll = IZ;
ti.root = PZ;
ti.size = OZ;
ti.visit = DZ;
ti.visitAfter = kZ;
ti.x = NZ;
ti.y = BZ;
const GZ = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  quadtree: Jp
}, Symbol.toStringTag, { value: "Module" })), FZ = /* @__PURE__ */ Ao(GZ);
Object.defineProperty(Qp, "__esModule", { value: !0 });
Qp.forceNBody = void 0;
var zZ = FZ, UZ = 0.81, mS = 0.1;
function jZ(r, t, e, n, i) {
  var a = e / n, o = r.map(function(u, f) {
    var l = t[u.id], c = l.data, h = l.x, d = l.y, v = l.size, p = c.layout.force.nodeStrength;
    return {
      x: h,
      y: d,
      size: v,
      index: f,
      vx: 0,
      vy: 0,
      weight: a * p
    };
  }), s = (0, zZ.quadtree)(o, function(u) {
    return u.x;
  }, function(u) {
    return u.y;
  }).visitAfter($Z);
  return o.forEach(function(u) {
    VZ(u, s);
  }), o.map(function(u, f) {
    var l = t[r[f].id], c = l.data.layout.force.mass, h = c === void 0 ? 1 : c;
    i[2 * f] = u.vx / h, i[2 * f + 1] = u.vy / h;
  }), i;
}
Qp.forceNBody = jZ;
function $Z(r) {
  var t = 0, e = 0, n = 0;
  if (r.length) {
    for (var i = 0; i < 4; i++) {
      var a = r[i];
      a && a.weight && (t += a.weight, e += a.x * a.weight, n += a.y * a.weight);
    }
    r.x = e / t, r.y = n / t, r.weight = t;
  } else {
    var a = r;
    r.x = a.data.x, r.y = a.data.y, r.weight = a.data.weight;
  }
}
var WZ = function(r, t, e, n, i, a) {
  var o = a.x - r.x || mS, s = a.y - r.y || mS, u = n - t, f = o * o + s * s, l = Math.sqrt(f) * f;
  if (u * u * UZ < f) {
    var c = r.weight / l;
    return a.vx += o * c, a.vy += s * c, !0;
  }
  if (r.length)
    return !1;
  if (r.data !== a) {
    var c = r.data.weight / l;
    a.vx += o * c, a.vy += s * c;
  }
};
function VZ(r, t) {
  t.visit(function(e, n, i, a, o) {
    return WZ(e, n, i, a, o, r);
  });
}
var XZ = Oe && Oe.__extends || function() {
  var r = function(t, e) {
    return r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(n, i) {
      n.__proto__ = i;
    } || function(n, i) {
      for (var a in i)
        Object.prototype.hasOwnProperty.call(i, a) && (n[a] = i[a]);
    }, r(t, e);
  };
  return function(t, e) {
    if (typeof e != "function" && e !== null)
      throw new TypeError("Class extends value " + String(e) + " is not a constructor or null");
    r(t, e);
    function n() {
      this.constructor = t;
    }
    t.prototype = e === null ? Object.create(e) : (n.prototype = e.prototype, new n());
  };
}(), Zi = Oe && Oe.__assign || function() {
  return Zi = Object.assign || function(r) {
    for (var t, e = 1, n = arguments.length; e < n; e++) {
      t = arguments[e];
      for (var i in t)
        Object.prototype.hasOwnProperty.call(t, i) && (r[i] = t[i]);
    }
    return r;
  }, Zi.apply(this, arguments);
};
Object.defineProperty(lh, "__esModule", { value: !0 });
lh.Force2Layout = void 0;
var YZ = an, wn = on(), HZ = Qp, ay = function(r, t) {
  var e;
  return r ? (0, wn.isNumber)(r) ? e = function(n) {
    return r;
  } : e = r : e = function(n) {
    return t || 1;
  }, e;
}, KZ = function(r) {
  XZ(t, r);
  function t(e) {
    var n = r.call(this) || this;
    n.maxIteration = 1e3, n.workerEnabled = !1, n.edgeStrength = 200, n.nodeStrength = 1e3, n.coulombDisScale = 5e-3, n.damping = 0.9, n.maxSpeed = 1e3, n.minMovement = 0.4, n.interval = 0.02, n.factor = 1, n.linkDistance = 200, n.gravity = 0, n.clusterNodeStrength = 20, n.preventOverlap = !0, n.distanceThresholdMode = "mean", n.tick = function() {
    }, n.nodes = [], n.edges = [], n.width = 300, n.height = 300, n.nodeMap = {}, n.nodeIdxMap = {}, n.judgingDistance = 0, n.centripetalOptions = {
      leaf: 2,
      single: 2,
      others: 1,
      center: function(a) {
        return {
          x: n.width / 2,
          y: n.height / 2
        };
      }
    };
    var i = e.getMass;
    return n.propsGetMass = i, n.updateCfg(e), n;
  }
  return t.prototype.getCentripetalOptions = function() {
    var e = this, n = e.leafCluster, i = e.clustering, a = e.nodeClusterBy, o = e.nodes, s = e.nodeMap, u = e.clusterNodeStrength, f = function(m) {
      return typeof u == "function" ? u(m) : u;
    }, l = {}, c;
    if (n) {
      c = this.getSameTypeLeafMap() || {};
      var h = Array.from(new Set(o == null ? void 0 : o.map(function(m) {
        return m[a];
      }))) || [];
      l = {
        single: 100,
        leaf: function(m, x, _) {
          var w = c[m.id] || {}, E = w.relativeLeafNodes, M = w.sameTypeLeafNodes;
          return (M == null ? void 0 : M.length) === (E == null ? void 0 : E.length) || (h == null ? void 0 : h.length) === 1 ? 1 : f(m);
        },
        others: 1,
        center: function(m, x, _) {
          var w, E = (((w = m.data) === null || w === void 0 ? void 0 : w.layout) || {}).degree;
          if (!E)
            return {
              x: 100,
              y: 100
            };
          var M;
          if (E === 1) {
            var C = (c[m.id] || {}).sameTypeLeafNodes, S = C === void 0 ? [] : C;
            S.length === 1 ? M = void 0 : S.length > 1 && (M = (0, wn.getAvgNodePosition)(S));
          } else
            M = void 0;
          return {
            x: M == null ? void 0 : M.x,
            y: M == null ? void 0 : M.y
          };
        }
      };
    }
    if (i) {
      c || (c = this.getSameTypeLeafMap());
      var d = Array.from(new Set(o.map(function(m, x) {
        return m[a];
      }))).filter(function(m) {
        return m !== void 0;
      }), v = {};
      d.forEach(function(m) {
        var x = o.filter(function(_) {
          return _[a] === m;
        }).map(function(_) {
          return s[_.id];
        });
        v[m] = (0, wn.getAvgNodePosition)(x);
      }), l = {
        single: function(m) {
          return f(m);
        },
        leaf: function(m) {
          return f(m);
        },
        others: function(m) {
          return f(m);
        },
        center: function(m, x, _) {
          var w = v[m[a]];
          return {
            x: w == null ? void 0 : w.x,
            y: w == null ? void 0 : w.y
          };
        }
      };
    }
    this.centripetalOptions = Zi(Zi({}, this.centripetalOptions), l);
    var p = this.centripetalOptions, g = p.leaf, y = p.single, b = p.others;
    g && typeof g != "function" && (this.centripetalOptions.leaf = function() {
      return g;
    }), y && typeof y != "function" && (this.centripetalOptions.single = function() {
      return y;
    }), b && typeof b != "function" && (this.centripetalOptions.others = function() {
      return b;
    });
  }, t.prototype.updateCfg = function(e) {
    e && Object.assign(this, e);
  }, t.prototype.getDefaultCfg = function() {
    return {
      maxIteration: 500,
      gravity: 10,
      enableTick: !0,
      animate: !0
    };
  }, t.prototype.execute = function() {
    var e = this;
    e.stop();
    var n = e.nodes, i = e.edges, a = e.defSpringLen;
    if (e.judgingDistance = 0, !n || n.length === 0) {
      e.onLayoutEnd([]);
      return;
    }
    !e.width && typeof window < "u" && (e.width = window.innerWidth), !e.height && typeof window < "u" && (e.height = window.innerHeight), e.center || (e.center = [e.width / 2, e.height / 2]);
    var o = e.center;
    if (n.length === 1) {
      n[0].x = o[0], n[0].y = o[1], e.onLayoutEnd([Zi({}, n[0])]);
      return;
    }
    e.degreesMap = (0, wn.getDegreeMap)(n, i), e.propsGetMass ? e.getMass = e.propsGetMass : e.getMass = function(d) {
      var v = 1;
      (0, wn.isNumber)(d.mass) && (v = d.mass);
      var p = e.degreesMap[d.id].all;
      return !p || p < 5 ? v : p * 5 * v;
    };
    var s = e.nodeSize, u;
    if (e.preventOverlap) {
      var f = e.nodeSpacing, l;
      (0, wn.isNumber)(f) ? l = function() {
        return f;
      } : (0, wn.isFunction)(f) ? l = f : l = function() {
        return 0;
      }, s ? (0, wn.isArray)(s) ? u = function(d) {
        return Math.max(s[0], s[1]) + l(d);
      } : u = function(d) {
        return s + l(d);
      } : u = function(d) {
        return d.size ? (0, wn.isArray)(d.size) ? Math.max(d.size[0], d.size[1]) + l(d) : (0, wn.isObject)(d.size) ? Math.max(d.size.width, d.size.height) + l(d) : d.size + l(d) : 10 + l(d);
      };
    }
    e.nodeSize = u, e.linkDistance = ay(e.linkDistance, 1), e.nodeStrength = ay(e.nodeStrength, 1), e.edgeStrength = ay(e.edgeStrength, 1);
    var c = {}, h = {};
    n.forEach(function(d, v) {
      (0, wn.isNumber)(d.x) || (d.x = Math.random() * e.width), (0, wn.isNumber)(d.y) || (d.y = Math.random() * e.height);
      var p = e.degreesMap[d.id];
      c[d.id] = Zi(Zi({}, d), { data: Zi(Zi({}, d.data), { size: e.nodeSize(d) || 30, layout: {
        inDegree: p.in,
        outDegree: p.out,
        degree: p.all,
        tDegree: p.in,
        sDegree: p.out,
        force: {
          mass: e.getMass(d),
          nodeStrength: e.nodeStrength(d)
        }
      } }) }), h[d.id] = v;
    }), e.nodeMap = c, e.nodeIdxMap = h, e.edgeInfos = [], i == null || i.forEach(function(d) {
      var v = c[d.source], p = c[d.target];
      !v || !p ? elf.edgeInfos.push({}) : e.edgeInfos.push({
        edgeStrength: e.edgeStrength(d),
        linkDistance: a ? a(Zi(Zi({}, d), { source: v, target: p }), v, p) : e.linkDistance(d, v, p) || 1 + (s(v) + s(v) || 0) / 2
      });
    }), this.getCentripetalOptions(), e.onLayoutEnd = e.onLayoutEnd || function() {
    }, e.run();
  }, t.prototype.run = function() {
    var e = this, n = e.maxIteration, i = e.nodes, a = e.workerEnabled, o = e.minMovement, s = e.animate, u = e.nodeMap;
    if (!!i) {
      var f = [];
      i.forEach(function(v, p) {
        f[2 * p] = 0, f[2 * p + 1] = 0;
      });
      var l = n, c = !s;
      if (a || c) {
        for (var h = 0; (e.judgingDistance > o || h < 1) && h < l; h++)
          e.runOneStep(h, f);
        e.onLayoutEnd(Object.values(u));
      } else {
        if (typeof window > "u")
          return;
        var d = 0;
        this.timeInterval = window.setInterval(function() {
          !i || (e.runOneStep(d, f), d++, (d >= l || e.judgingDistance < o) && (e.onLayoutEnd(Object.values(u)), window.clearInterval(e.timeInterval)));
        }, 0);
      }
    }
  }, t.prototype.runOneStep = function(e, n) {
    var i, a = this, o = a.nodes, s = a.edges;
    a.nodeMap;
    var u = a.monitor, f = [];
    if (!!(o != null && o.length)) {
      a.calRepulsive(f), s && a.calAttractive(f), a.calGravity(f);
      var l = a.interval;
      if (a.updateVelocity(f, n, l), a.updatePosition(n, l), (i = a.tick) === null || i === void 0 || i.call(a), u) {
        var c = this.calTotalEnergy(f);
        u({ energy: c, nodes: o, edges: s, iterations: e });
      }
    }
  }, t.prototype.calTotalEnergy = function(e) {
    var n = this, i = n.nodes, a = n.nodeMap;
    if (!(i != null && i.length))
      return 0;
    var o = 0;
    return i.forEach(function(s, u) {
      var f = e[2 * u], l = e[2 * u + 1], c = f * f + l * l, h = a[s.id].data.layout.force.mass, d = h === void 0 ? 1 : h;
      o += d * c * 0.5;
    }), o;
  }, t.prototype.calRepulsive = function(e) {
    var n = this, i = n.nodes, a = n.nodeMap, o = n.factor, s = n.coulombDisScale;
    n.nodeSize, (0, HZ.forceNBody)(i, a, o, s * s, e);
  }, t.prototype.calAttractive = function(e) {
    var n = this, i = n.edges, a = n.nodeMap, o = n.nodeIdxMap, s = n.edgeInfos;
    n.nodeSize, i.forEach(function(u, f) {
      var l = (0, wn.getEdgeTerminal)(u, "source"), c = (0, wn.getEdgeTerminal)(u, "target"), h = a[l], d = a[c];
      if (!(!h || !d)) {
        var v = d.x - h.x, p = d.y - h.y;
        !v && !p && (v = Math.random() * 0.01, p = Math.random() * 0.01);
        var g = Math.sqrt(v * v + p * p), y = v / g, b = p / g, m = s[f] || {}, x = m.linkDistance, _ = x === void 0 ? 200 : x, w = m.edgeStrength, E = w === void 0 ? 200 : w, M = _ - g, C = M * E, S = h.data.layout.force.mass || 1, A = d.data.layout.force.mass || 1, T = 1 / S, P = 1 / A, k = y * C, L = b * C, O = 2 * o[l], D = 2 * o[c];
        e[O] -= k * T, e[O + 1] -= L * T, e[D] += k * P, e[D + 1] += L * P;
      }
    });
  }, t.prototype.calGravity = function(e) {
    var n, i = this, a = i.nodes, o = i.edges, s = o === void 0 ? [] : o, u = i.nodeMap, f = i.width, l = i.height, c = i.center, h = i.gravity, d = i.degreesMap, v = i.centripetalOptions;
    if (!!a)
      for (var p = a.length, g = 0; g < p; g++) {
        var y = 2 * g, b = u[a[g].id], m = b.data.layout.force.mass, x = m === void 0 ? 1 : m, _ = 0, w = 0, E = h, M = d[b.id], C = M.in, S = M.out, A = M.all, T = (n = i.getCenter) === null || n === void 0 ? void 0 : n.call(i, b, A);
        if (T) {
          var P = T[0], k = T[1], L = T[2];
          _ = b.x - P, w = b.y - k, E = L;
        } else
          _ = b.x - c[0], w = b.y - c[1];
        if (E && (e[y] -= E * _ / x, e[y + 1] -= E * w / x), v) {
          var O = v.leaf, D = v.single, G = v.others, R = v.center, F = (R == null ? void 0 : R(b, a, s, f, l)) || { x: 0, y: 0, centerStrength: 0 }, q = F.x, ne = F.y, oe = F.centerStrength;
          if (!(0, wn.isNumber)(q) || !(0, wn.isNumber)(ne))
            continue;
          var ie = (b.x - q) / x, Ee = (b.y - ne) / x;
          if (oe && (e[y] -= oe * ie, e[y + 1] -= oe * Ee), A === 0) {
            var Xe = D(b);
            if (!Xe)
              continue;
            e[y] -= Xe * ie, e[y + 1] -= Xe * Ee;
            continue;
          }
          if (C === 0 || S === 0) {
            var le = O(b, a, s);
            if (!le)
              continue;
            e[y] -= le * ie, e[y + 1] -= le * Ee;
            continue;
          }
          var Me = G(b);
          if (!Me)
            continue;
          e[y] -= Me * ie, e[y + 1] -= Me * Ee;
        }
      }
  }, t.prototype.updateVelocity = function(e, n, i) {
    var a = this, o = a.nodes, s = a.damping, u = a.maxSpeed;
    !(o != null && o.length) || o.forEach(function(f, l) {
      var c = (n[2 * l] + e[2 * l] * i) * s || 0.01, h = (n[2 * l + 1] + e[2 * l + 1] * i) * s || 0.01, d = Math.sqrt(c * c + h * h);
      if (d > u) {
        var v = u / d;
        c = v * c, h = v * h;
      }
      n[2 * l] = c, n[2 * l + 1] = h;
    });
  }, t.prototype.updatePosition = function(e, n) {
    var i = this, a = i.nodes, o = i.distanceThresholdMode, s = i.nodeMap;
    if (!(a != null && a.length)) {
      this.judgingDistance = 0;
      return;
    }
    var u = 0;
    o === "max" ? i.judgingDistance = -1 / 0 : o === "min" && (i.judgingDistance = 1 / 0), a.forEach(function(f, l) {
      var c = s[f.id];
      if ((0, wn.isNumber)(f.fx) && (0, wn.isNumber)(f.fy)) {
        f.x = f.fx, f.y = f.fy, c.x = f.x, c.y = f.y;
        return;
      }
      var h = e[2 * l] * n, d = e[2 * l + 1] * n;
      f.x += h, f.y += d, c.x = f.x, c.y = f.y;
      var v = Math.sqrt(h * h + d * d);
      switch (o) {
        case "max":
          i.judgingDistance < v && (i.judgingDistance = v);
          break;
        case "min":
          i.judgingDistance > v && (i.judgingDistance = v);
          break;
        default:
          u = u + v;
          break;
      }
    }), (!o || o === "mean") && (i.judgingDistance = u / a.length);
  }, t.prototype.stop = function() {
    this.timeInterval && typeof window < "u" && window.clearInterval(this.timeInterval);
  }, t.prototype.destroy = function() {
    var e = this;
    e.stop(), e.tick = null, e.nodes = null, e.edges = null, e.destroyed = !0;
  }, t.prototype.getType = function() {
    return "force2";
  }, t.prototype.getSameTypeLeafMap = function() {
    var e = this, n = e.nodeClusterBy, i = e.nodes, a = e.edges, o = e.nodeMap, s = e.degreesMap;
    if (!!(i != null && i.length)) {
      var u = {};
      return i.forEach(function(f, l) {
        var c = s[f.id].all;
        c === 1 && (u[f.id] = (0, wn.getCoreNodeAndRelativeLeafNodes)("leaf", f, a, n, s, o));
      }), u;
    }
  }, t;
}(YZ.Base);
lh.Force2Layout = KZ;
var Wb = {}, eg = {};
function qZ(r, t) {
  var e, n = 1;
  r == null && (r = 0), t == null && (t = 0);
  function i() {
    var a, o = e.length, s, u = 0, f = 0;
    for (a = 0; a < o; ++a)
      s = e[a], u += s.x, f += s.y;
    for (u = (u / o - r) * n, f = (f / o - t) * n, a = 0; a < o; ++a)
      s = e[a], s.x -= u, s.y -= f;
  }
  return i.initialize = function(a) {
    e = a;
  }, i.x = function(a) {
    return arguments.length ? (r = +a, i) : r;
  }, i.y = function(a) {
    return arguments.length ? (t = +a, i) : t;
  }, i.strength = function(a) {
    return arguments.length ? (n = +a, i) : n;
  }, i;
}
function Sn(r) {
  return function() {
    return r;
  };
}
function os(r) {
  return (r() - 0.5) * 1e-6;
}
function ZZ(r) {
  return r.x + r.vx;
}
function QZ(r) {
  return r.y + r.vy;
}
function JZ(r) {
  var t, e, n, i = 1, a = 1;
  typeof r != "function" && (r = Sn(r == null ? 1 : +r));
  function o() {
    for (var f, l = t.length, c, h, d, v, p, g, y = 0; y < a; ++y)
      for (c = Jp(t, ZZ, QZ).visitAfter(s), f = 0; f < l; ++f)
        h = t[f], p = e[h.index], g = p * p, d = h.x + h.vx, v = h.y + h.vy, c.visit(b);
    function b(m, x, _, w, E) {
      var M = m.data, C = m.r, S = p + C;
      if (M) {
        if (M.index > h.index) {
          var A = d - M.x - M.vx, T = v - M.y - M.vy, P = A * A + T * T;
          P < S * S && (A === 0 && (A = os(n), P += A * A), T === 0 && (T = os(n), P += T * T), P = (S - (P = Math.sqrt(P))) / P * i, h.vx += (A *= P) * (S = (C *= C) / (g + C)), h.vy += (T *= P) * S, M.vx -= A * (S = 1 - S), M.vy -= T * S);
        }
        return;
      }
      return x > d + S || w < d - S || _ > v + S || E < v - S;
    }
  }
  function s(f) {
    if (f.data)
      return f.r = e[f.data.index];
    for (var l = f.r = 0; l < 4; ++l)
      f[l] && f[l].r > f.r && (f.r = f[l].r);
  }
  function u() {
    if (!!t) {
      var f, l = t.length, c;
      for (e = new Array(l), f = 0; f < l; ++f)
        c = t[f], e[c.index] = +r(c, f, t);
    }
  }
  return o.initialize = function(f, l) {
    t = f, n = l, u();
  }, o.iterations = function(f) {
    return arguments.length ? (a = +f, o) : a;
  }, o.strength = function(f) {
    return arguments.length ? (i = +f, o) : i;
  }, o.radius = function(f) {
    return arguments.length ? (r = typeof f == "function" ? f : Sn(+f), u(), o) : r;
  }, o;
}
function eQ(r) {
  return r.index;
}
function bS(r, t) {
  var e = r.get(t);
  if (!e)
    throw new Error("node not found: " + t);
  return e;
}
function tQ(r) {
  var t = eQ, e = c, n, i = Sn(30), a, o, s, u, f, l = 1;
  r == null && (r = []);
  function c(g) {
    return 1 / Math.min(s[g.source.index], s[g.target.index]);
  }
  function h(g) {
    for (var y = 0, b = r.length; y < l; ++y)
      for (var m = 0, x, _, w, E, M, C, S; m < b; ++m)
        x = r[m], _ = x.source, w = x.target, E = w.x + w.vx - _.x - _.vx || os(f), M = w.y + w.vy - _.y - _.vy || os(f), C = Math.sqrt(E * E + M * M), C = (C - a[m]) / C * g * n[m], E *= C, M *= C, w.vx -= E * (S = u[m]), w.vy -= M * S, _.vx += E * (S = 1 - S), _.vy += M * S;
  }
  function d() {
    if (!!o) {
      var g, y = o.length, b = r.length, m = new Map(o.map((_, w) => [t(_, w, o), _])), x;
      for (g = 0, s = new Array(y); g < b; ++g)
        x = r[g], x.index = g, typeof x.source != "object" && (x.source = bS(m, x.source)), typeof x.target != "object" && (x.target = bS(m, x.target)), s[x.source.index] = (s[x.source.index] || 0) + 1, s[x.target.index] = (s[x.target.index] || 0) + 1;
      for (g = 0, u = new Array(b); g < b; ++g)
        x = r[g], u[g] = s[x.source.index] / (s[x.source.index] + s[x.target.index]);
      n = new Array(b), v(), a = new Array(b), p();
    }
  }
  function v() {
    if (!!o)
      for (var g = 0, y = r.length; g < y; ++g)
        n[g] = +e(r[g], g, r);
  }
  function p() {
    if (!!o)
      for (var g = 0, y = r.length; g < y; ++g)
        a[g] = +i(r[g], g, r);
  }
  return h.initialize = function(g, y) {
    o = g, f = y, d();
  }, h.links = function(g) {
    return arguments.length ? (r = g, d(), h) : r;
  }, h.id = function(g) {
    return arguments.length ? (t = g, h) : t;
  }, h.iterations = function(g) {
    return arguments.length ? (l = +g, h) : l;
  }, h.strength = function(g) {
    return arguments.length ? (e = typeof g == "function" ? g : Sn(+g), v(), h) : e;
  }, h.distance = function(g) {
    return arguments.length ? (i = typeof g == "function" ? g : Sn(+g), p(), h) : i;
  }, h;
}
var rQ = { value: () => {
} };
function QR() {
  for (var r = 0, t = arguments.length, e = {}, n; r < t; ++r) {
    if (!(n = arguments[r] + "") || n in e || /[\s.]/.test(n))
      throw new Error("illegal type: " + n);
    e[n] = [];
  }
  return new wv(e);
}
function wv(r) {
  this._ = r;
}
function nQ(r, t) {
  return r.trim().split(/^|\s+/).map(function(e) {
    var n = "", i = e.indexOf(".");
    if (i >= 0 && (n = e.slice(i + 1), e = e.slice(0, i)), e && !t.hasOwnProperty(e))
      throw new Error("unknown type: " + e);
    return { type: e, name: n };
  });
}
wv.prototype = QR.prototype = {
  constructor: wv,
  on: function(r, t) {
    var e = this._, n = nQ(r + "", e), i, a = -1, o = n.length;
    if (arguments.length < 2) {
      for (; ++a < o; )
        if ((i = (r = n[a]).type) && (i = iQ(e[i], r.name)))
          return i;
      return;
    }
    if (t != null && typeof t != "function")
      throw new Error("invalid callback: " + t);
    for (; ++a < o; )
      if (i = (r = n[a]).type)
        e[i] = xS(e[i], r.name, t);
      else if (t == null)
        for (i in e)
          e[i] = xS(e[i], r.name, null);
    return this;
  },
  copy: function() {
    var r = {}, t = this._;
    for (var e in t)
      r[e] = t[e].slice();
    return new wv(r);
  },
  call: function(r, t) {
    if ((i = arguments.length - 2) > 0)
      for (var e = new Array(i), n = 0, i, a; n < i; ++n)
        e[n] = arguments[n + 2];
    if (!this._.hasOwnProperty(r))
      throw new Error("unknown type: " + r);
    for (a = this._[r], n = 0, i = a.length; n < i; ++n)
      a[n].value.apply(t, e);
  },
  apply: function(r, t, e) {
    if (!this._.hasOwnProperty(r))
      throw new Error("unknown type: " + r);
    for (var n = this._[r], i = 0, a = n.length; i < a; ++i)
      n[i].value.apply(t, e);
  }
};
function iQ(r, t) {
  for (var e = 0, n = r.length, i; e < n; ++e)
    if ((i = r[e]).name === t)
      return i.value;
}
function xS(r, t, e) {
  for (var n = 0, i = r.length; n < i; ++n)
    if (r[n].name === t) {
      r[n] = rQ, r = r.slice(0, n).concat(r.slice(n + 1));
      break;
    }
  return e != null && r.push({ name: t, value: e }), r;
}
var Yf = 0, sc = 0, Ol = 0, JR = 1e3, ip, uc, ap = 0, mu = 0, tg = 0, Uc = typeof performance == "object" && performance.now ? performance : Date, e3 = typeof window == "object" && window.requestAnimationFrame ? window.requestAnimationFrame.bind(window) : function(r) {
  setTimeout(r, 17);
};
function t3() {
  return mu || (e3(aQ), mu = Uc.now() + tg);
}
function aQ() {
  mu = 0;
}
function Wm() {
  this._call = this._time = this._next = null;
}
Wm.prototype = r3.prototype = {
  constructor: Wm,
  restart: function(r, t, e) {
    if (typeof r != "function")
      throw new TypeError("callback is not a function");
    e = (e == null ? t3() : +e) + (t == null ? 0 : +t), !this._next && uc !== this && (uc ? uc._next = this : ip = this, uc = this), this._call = r, this._time = e, Vm();
  },
  stop: function() {
    this._call && (this._call = null, this._time = 1 / 0, Vm());
  }
};
function r3(r, t, e) {
  var n = new Wm();
  return n.restart(r, t, e), n;
}
function oQ() {
  t3(), ++Yf;
  for (var r = ip, t; r; )
    (t = mu - r._time) >= 0 && r._call.call(null, t), r = r._next;
  --Yf;
}
function _S() {
  mu = (ap = Uc.now()) + tg, Yf = sc = 0;
  try {
    oQ();
  } finally {
    Yf = 0, uQ(), mu = 0;
  }
}
function sQ() {
  var r = Uc.now(), t = r - ap;
  t > JR && (tg -= t, ap = r);
}
function uQ() {
  for (var r, t = ip, e, n = 1 / 0; t; )
    t._call ? (n > t._time && (n = t._time), r = t, t = t._next) : (e = t._next, t._next = null, t = r ? r._next = e : ip = e);
  uc = r, Vm(n);
}
function Vm(r) {
  if (!Yf) {
    sc && (sc = clearTimeout(sc));
    var t = r - mu;
    t > 24 ? (r < 1 / 0 && (sc = setTimeout(_S, r - Uc.now() - tg)), Ol && (Ol = clearInterval(Ol))) : (Ol || (ap = Uc.now(), Ol = setInterval(sQ, JR)), Yf = 1, e3(_S));
  }
}
const fQ = 1664525, lQ = 1013904223, wS = 4294967296;
function cQ() {
  let r = 1;
  return () => (r = (fQ * r + lQ) % wS) / wS;
}
function hQ(r) {
  return r.x;
}
function dQ(r) {
  return r.y;
}
var vQ = 10, pQ = Math.PI * (3 - Math.sqrt(5));
function gQ(r) {
  var t, e = 1, n = 1e-3, i = 1 - Math.pow(n, 1 / 300), a = 0, o = 0.6, s = /* @__PURE__ */ new Map(), u = r3(c), f = QR("tick", "end"), l = cQ();
  r == null && (r = []);
  function c() {
    h(), f.call("tick", t), e < n && (u.stop(), f.call("end", t));
  }
  function h(p) {
    var g, y = r.length, b;
    p === void 0 && (p = 1);
    for (var m = 0; m < p; ++m)
      for (e += (a - e) * i, s.forEach(function(x) {
        x(e);
      }), g = 0; g < y; ++g)
        b = r[g], b.fx == null ? b.x += b.vx *= o : (b.x = b.fx, b.vx = 0), b.fy == null ? b.y += b.vy *= o : (b.y = b.fy, b.vy = 0);
    return t;
  }
  function d() {
    for (var p = 0, g = r.length, y; p < g; ++p) {
      if (y = r[p], y.index = p, y.fx != null && (y.x = y.fx), y.fy != null && (y.y = y.fy), isNaN(y.x) || isNaN(y.y)) {
        var b = vQ * Math.sqrt(0.5 + p), m = p * pQ;
        y.x = b * Math.cos(m), y.y = b * Math.sin(m);
      }
      (isNaN(y.vx) || isNaN(y.vy)) && (y.vx = y.vy = 0);
    }
  }
  function v(p) {
    return p.initialize && p.initialize(r, l), p;
  }
  return d(), t = {
    tick: h,
    restart: function() {
      return u.restart(c), t;
    },
    stop: function() {
      return u.stop(), t;
    },
    nodes: function(p) {
      return arguments.length ? (r = p, d(), s.forEach(v), t) : r;
    },
    alpha: function(p) {
      return arguments.length ? (e = +p, t) : e;
    },
    alphaMin: function(p) {
      return arguments.length ? (n = +p, t) : n;
    },
    alphaDecay: function(p) {
      return arguments.length ? (i = +p, t) : +i;
    },
    alphaTarget: function(p) {
      return arguments.length ? (a = +p, t) : a;
    },
    velocityDecay: function(p) {
      return arguments.length ? (o = 1 - p, t) : 1 - o;
    },
    randomSource: function(p) {
      return arguments.length ? (l = p, s.forEach(v), t) : l;
    },
    force: function(p, g) {
      return arguments.length > 1 ? (g == null ? s.delete(p) : s.set(p, v(g)), t) : s.get(p);
    },
    find: function(p, g, y) {
      var b = 0, m = r.length, x, _, w, E, M;
      for (y == null ? y = 1 / 0 : y *= y, b = 0; b < m; ++b)
        E = r[b], x = p - E.x, _ = g - E.y, w = x * x + _ * _, w < y && (M = E, y = w);
      return M;
    },
    on: function(p, g) {
      return arguments.length > 1 ? (f.on(p, g), t) : f.on(p);
    }
  };
}
function yQ() {
  var r, t, e, n, i = Sn(-30), a, o = 1, s = 1 / 0, u = 0.81;
  function f(d) {
    var v, p = r.length, g = Jp(r, hQ, dQ).visitAfter(c);
    for (n = d, v = 0; v < p; ++v)
      t = r[v], g.visit(h);
  }
  function l() {
    if (!!r) {
      var d, v = r.length, p;
      for (a = new Array(v), d = 0; d < v; ++d)
        p = r[d], a[p.index] = +i(p, d, r);
    }
  }
  function c(d) {
    var v = 0, p, g, y = 0, b, m, x;
    if (d.length) {
      for (b = m = x = 0; x < 4; ++x)
        (p = d[x]) && (g = Math.abs(p.value)) && (v += p.value, y += g, b += g * p.x, m += g * p.y);
      d.x = b / y, d.y = m / y;
    } else {
      p = d, p.x = p.data.x, p.y = p.data.y;
      do
        v += a[p.data.index];
      while (p = p.next);
    }
    d.value = v;
  }
  function h(d, v, p, g) {
    if (!d.value)
      return !0;
    var y = d.x - t.x, b = d.y - t.y, m = g - v, x = y * y + b * b;
    if (m * m / u < x)
      return x < s && (y === 0 && (y = os(e), x += y * y), b === 0 && (b = os(e), x += b * b), x < o && (x = Math.sqrt(o * x)), t.vx += y * d.value * n / x, t.vy += b * d.value * n / x), !0;
    if (d.length || x >= s)
      return;
    (d.data !== t || d.next) && (y === 0 && (y = os(e), x += y * y), b === 0 && (b = os(e), x += b * b), x < o && (x = Math.sqrt(o * x)));
    do
      d.data !== t && (m = a[d.data.index] * n / x, t.vx += y * m, t.vy += b * m);
    while (d = d.next);
  }
  return f.initialize = function(d, v) {
    r = d, e = v, l();
  }, f.strength = function(d) {
    return arguments.length ? (i = typeof d == "function" ? d : Sn(+d), l(), f) : i;
  }, f.distanceMin = function(d) {
    return arguments.length ? (o = d * d, f) : Math.sqrt(o);
  }, f.distanceMax = function(d) {
    return arguments.length ? (s = d * d, f) : Math.sqrt(s);
  }, f.theta = function(d) {
    return arguments.length ? (u = d * d, f) : Math.sqrt(u);
  }, f;
}
function mQ(r, t, e) {
  var n, i = Sn(0.1), a, o;
  typeof r != "function" && (r = Sn(+r)), t == null && (t = 0), e == null && (e = 0);
  function s(f) {
    for (var l = 0, c = n.length; l < c; ++l) {
      var h = n[l], d = h.x - t || 1e-6, v = h.y - e || 1e-6, p = Math.sqrt(d * d + v * v), g = (o[l] - p) * a[l] * f / p;
      h.vx += d * g, h.vy += v * g;
    }
  }
  function u() {
    if (!!n) {
      var f, l = n.length;
      for (a = new Array(l), o = new Array(l), f = 0; f < l; ++f)
        o[f] = +r(n[f], f, n), a[f] = isNaN(o[f]) ? 0 : +i(n[f], f, n);
    }
  }
  return s.initialize = function(f) {
    n = f, u();
  }, s.strength = function(f) {
    return arguments.length ? (i = typeof f == "function" ? f : Sn(+f), u(), s) : i;
  }, s.radius = function(f) {
    return arguments.length ? (r = typeof f == "function" ? f : Sn(+f), u(), s) : r;
  }, s.x = function(f) {
    return arguments.length ? (t = +f, s) : t;
  }, s.y = function(f) {
    return arguments.length ? (e = +f, s) : e;
  }, s;
}
function bQ(r) {
  var t = Sn(0.1), e, n, i;
  typeof r != "function" && (r = Sn(r == null ? 0 : +r));
  function a(s) {
    for (var u = 0, f = e.length, l; u < f; ++u)
      l = e[u], l.vx += (i[u] - l.x) * n[u] * s;
  }
  function o() {
    if (!!e) {
      var s, u = e.length;
      for (n = new Array(u), i = new Array(u), s = 0; s < u; ++s)
        n[s] = isNaN(i[s] = +r(e[s], s, e)) ? 0 : +t(e[s], s, e);
    }
  }
  return a.initialize = function(s) {
    e = s, o();
  }, a.strength = function(s) {
    return arguments.length ? (t = typeof s == "function" ? s : Sn(+s), o(), a) : t;
  }, a.x = function(s) {
    return arguments.length ? (r = typeof s == "function" ? s : Sn(+s), o(), a) : r;
  }, a;
}
function xQ(r) {
  var t = Sn(0.1), e, n, i;
  typeof r != "function" && (r = Sn(r == null ? 0 : +r));
  function a(s) {
    for (var u = 0, f = e.length, l; u < f; ++u)
      l = e[u], l.vy += (i[u] - l.y) * n[u] * s;
  }
  function o() {
    if (!!e) {
      var s, u = e.length;
      for (n = new Array(u), i = new Array(u), s = 0; s < u; ++s)
        n[s] = isNaN(i[s] = +r(e[s], s, e)) ? 0 : +t(e[s], s, e);
    }
  }
  return a.initialize = function(s) {
    e = s, o();
  }, a.strength = function(s) {
    return arguments.length ? (t = typeof s == "function" ? s : Sn(+s), o(), a) : t;
  }, a.y = function(s) {
    return arguments.length ? (r = typeof s == "function" ? s : Sn(+s), o(), a) : r;
  }, a;
}
const _Q = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  forceCenter: qZ,
  forceCollide: JZ,
  forceLink: tQ,
  forceManyBody: yQ,
  forceRadial: mQ,
  forceSimulation: gQ,
  forceX: bQ,
  forceY: xQ
}, Symbol.toStringTag, { value: "Module" })), Vb = /* @__PURE__ */ Ao(_Q);
var Xb = {}, wQ = Oe && Oe.__createBinding || (Object.create ? function(r, t, e, n) {
  n === void 0 && (n = e);
  var i = Object.getOwnPropertyDescriptor(t, e);
  (!i || ("get" in i ? !t.__esModule : i.writable || i.configurable)) && (i = { enumerable: !0, get: function() {
    return t[e];
  } }), Object.defineProperty(r, n, i);
} : function(r, t, e, n) {
  n === void 0 && (n = e), r[n] = t[e];
}), EQ = Oe && Oe.__setModuleDefault || (Object.create ? function(r, t) {
  Object.defineProperty(r, "default", { enumerable: !0, value: t });
} : function(r, t) {
  r.default = t;
}), SQ = Oe && Oe.__importStar || function(r) {
  if (r && r.__esModule)
    return r;
  var t = {};
  if (r != null)
    for (var e in r)
      e !== "default" && Object.prototype.hasOwnProperty.call(r, e) && wQ(t, r, e);
  return EQ(t, r), t;
};
Object.defineProperty(Xb, "__esModule", { value: !0 });
var Ju = SQ(Vb), Od = on();
function MQ() {
  function r(ie) {
    return function() {
      return ie;
    };
  }
  var t = function(ie) {
    return ie.cluster;
  }, e = r(1), n = r(-1), i = r(100), a = r(0.1), o = [0, 0], s = [], u = {}, f = [], l = 100, c = 100, h = {
    none: {
      x: 0,
      y: 0
    }
  }, d = [], v, p = "force", g = !0, y = 0.1;
  function b(ie) {
    if (!g)
      return b;
    v.tick(), M();
    for (var Ee = 0, Xe = s.length, le = void 0, Me = ie * y; Ee < Xe; ++Ee)
      le = s[Ee], le.vx += (h[t(le)].x - le.x) * Me, le.vy += (h[t(le)].y - le.y) * Me;
  }
  function m() {
    !s || x();
  }
  function x() {
    if (!(!s || !s.length)) {
      if (t(s[0]) === void 0)
        throw Error("Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInABox.groupBy('clusterAttr') before calling .links()");
      var ie = _();
      v = Ju.forceSimulation(ie.nodes).force("x", Ju.forceX(l).strength(0.1)).force("y", Ju.forceY(c).strength(0.1)).force("collide", Ju.forceCollide(function(Ee) {
        return Ee.r;
      }).iterations(4)).force("charge", Ju.forceManyBody().strength(n)).force("links", Ju.forceLink(ie.nodes.length ? ie.links : []).distance(i).strength(a)), d = v.nodes(), M();
    }
  }
  function _() {
    var ie = [], Ee = [], Xe = {}, le = [], Me = {}, $e = [];
    return Me = w(s), $e = E(f), le = Object.keys(Me), le.forEach(function(et, ft) {
      var pt = Me[et];
      ie.push({
        id: et,
        size: pt.count,
        r: Math.sqrt(pt.sumforceNodeSize / Math.PI)
      }), Xe[et] = ft;
    }), $e.forEach(function(et) {
      var ft = (0, Od.getEdgeTerminal)(et, "source"), pt = (0, Od.getEdgeTerminal)(et, "target"), $ = Xe[ft], te = Xe[pt];
      $ !== void 0 && te !== void 0 && Ee.push({
        source: $,
        target: te,
        count: et.count
      });
    }), {
      nodes: ie,
      links: Ee
    };
  }
  function w(ie) {
    var Ee = {};
    return ie.forEach(function(Xe) {
      var le = t(Xe);
      Ee[le] || (Ee[le] = {
        count: 0,
        sumforceNodeSize: 0
      });
    }), ie.forEach(function(Xe) {
      var le = t(Xe), Me = e(Xe), $e = Ee[le];
      $e.count = $e.count + 1, $e.sumforceNodeSize = $e.sumforceNodeSize + Math.PI * (Me * Me) * 1.3, Ee[le] = $e;
    }), Ee;
  }
  function E(ie) {
    var Ee = {}, Xe = [];
    ie.forEach(function(Me) {
      var $e = C(Me), et = 0;
      Ee[$e] !== void 0 && (et = Ee[$e]), et += 1, Ee[$e] = et;
    });
    var le = Object.entries(Ee);
    return le.forEach(function(Me) {
      var $e = Me[0], et = Me[1], ft = $e.split("~")[0], pt = $e.split("~")[1];
      ft !== void 0 && pt !== void 0 && Xe.push({
        source: ft,
        target: pt,
        count: et
      });
    }), Xe;
  }
  function M() {
    return h = {
      none: {
        x: 0,
        y: 0
      }
    }, d.forEach(function(ie) {
      h[ie.id] = {
        x: ie.x - o[0],
        y: ie.y - o[1]
      };
    }), h;
  }
  function C(ie) {
    var Ee = (0, Od.getEdgeTerminal)(ie, "source"), Xe = (0, Od.getEdgeTerminal)(ie, "target"), le = t(u[Ee]), Me = t(u[Xe]);
    return le <= Me ? "".concat(le, "~").concat(Me) : "".concat(Me, "~").concat(le);
  }
  function S(ie) {
    u = {}, ie.forEach(function(Ee) {
      u[Ee.id] = Ee;
    });
  }
  function A(ie) {
    return arguments.length ? (p = ie, m(), b) : p;
  }
  function T(ie) {
    return arguments.length ? typeof ie == "string" ? (t = function(Ee) {
      return Ee[ie];
    }, b) : (t = ie, b) : t;
  }
  function P(ie) {
    return arguments.length ? (g = ie, b) : g;
  }
  function k(ie) {
    return arguments.length ? (y = ie, b) : y;
  }
  function L(ie) {
    return arguments.length ? (l = ie, b) : l;
  }
  function O(ie) {
    return arguments.length ? (c = ie, b) : c;
  }
  function D(ie) {
    return arguments.length ? (S(ie || []), s = ie || [], b) : s;
  }
  function G(ie) {
    return arguments.length ? (f = ie || [], m(), b) : f;
  }
  function R(ie) {
    return arguments.length ? (typeof ie == "function" ? e = ie : e = r(+ie), m(), b) : e;
  }
  function F(ie) {
    return arguments.length ? (typeof ie == "function" ? n = ie : n = r(+ie), m(), b) : n;
  }
  function q(ie) {
    return arguments.length ? (typeof ie == "function" ? i = ie : i = r(+ie), m(), b) : i;
  }
  function ne(ie) {
    return arguments.length ? (typeof ie == "function" ? a = ie : a = r(+ie), m(), b) : a;
  }
  function oe(ie) {
    return arguments.length ? (o = ie, b) : o;
  }
  return b.initialize = function(ie) {
    s = ie, m();
  }, b.template = A, b.groupBy = T, b.enableGrouping = P, b.strength = k, b.centerX = L, b.centerY = O, b.nodes = D, b.links = G, b.forceNodeSize = R, b.nodeSize = b.forceNodeSize, b.forceCharge = F, b.forceLinkDistance = q, b.forceLinkStrength = ne, b.offset = oe, b.getFocis = M, b;
}
Xb.default = MQ;
var Co = {};
Object.defineProperty(Co, "__esModule", { value: !0 });
Co.FORCE_LAYOUT_TYPE_MAP = Co.LAYOUT_MESSAGE = void 0;
Co.LAYOUT_MESSAGE = {
  RUN: "LAYOUT_RUN",
  END: "LAYOUT_END",
  ERROR: "LAYOUT_ERROR",
  TICK: "LAYOUT_TICK",
  GPURUN: "GPU_LAYOUT_RUN",
  GPUEND: "GPU_LAYOUT_END"
};
Co.FORCE_LAYOUT_TYPE_MAP = {
  gForce: !0,
  force2: !0,
  fruchterman: !0,
  forceAtlas2: !0,
  force: !0,
  "graphin-force": !0
};
var CQ = Oe && Oe.__extends || function() {
  var r = function(t, e) {
    return r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(n, i) {
      n.__proto__ = i;
    } || function(n, i) {
      for (var a in i)
        Object.prototype.hasOwnProperty.call(i, a) && (n[a] = i[a]);
    }, r(t, e);
  };
  return function(t, e) {
    if (typeof e != "function" && e !== null)
      throw new TypeError("Class extends value " + String(e) + " is not a constructor or null");
    r(t, e);
    function n() {
      this.constructor = t;
    }
    t.prototype = e === null ? Object.create(e) : (n.prototype = e.prototype, new n());
  };
}(), TQ = Oe && Oe.__createBinding || (Object.create ? function(r, t, e, n) {
  n === void 0 && (n = e);
  var i = Object.getOwnPropertyDescriptor(t, e);
  (!i || ("get" in i ? !t.__esModule : i.writable || i.configurable)) && (i = { enumerable: !0, get: function() {
    return t[e];
  } }), Object.defineProperty(r, n, i);
} : function(r, t, e, n) {
  n === void 0 && (n = e), r[n] = t[e];
}), AQ = Oe && Oe.__setModuleDefault || (Object.create ? function(r, t) {
  Object.defineProperty(r, "default", { enumerable: !0, value: t });
} : function(r, t) {
  r.default = t;
}), IQ = Oe && Oe.__importStar || function(r) {
  if (r && r.__esModule)
    return r;
  var t = {};
  if (r != null)
    for (var e in r)
      e !== "default" && Object.prototype.hasOwnProperty.call(r, e) && TQ(t, r, e);
  return AQ(t, r), t;
}, PQ = Oe && Oe.__importDefault || function(r) {
  return r && r.__esModule ? r : { default: r };
};
Object.defineProperty(eg, "__esModule", { value: !0 });
eg.ForceLayout = void 0;
var ef = IQ(Vb), OQ = PQ(Xb), zs = on(), DQ = an, kQ = Co, LQ = function(r) {
  CQ(t, r);
  function t(e) {
    var n = r.call(this) || this;
    return n.center = [0, 0], n.nodeStrength = null, n.edgeStrength = null, n.preventOverlap = !1, n.clusterNodeStrength = null, n.clusterEdgeStrength = null, n.clusterEdgeDistance = null, n.clusterNodeSize = null, n.clusterFociStrength = null, n.linkDistance = 50, n.alphaDecay = 0.028, n.alphaMin = 1e-3, n.alpha = 0.3, n.collideStrength = 1, n.workerEnabled = !1, n.tick = function() {
    }, n.onLayoutEnd = function() {
    }, n.ticking = void 0, e && n.updateCfg(e), n;
  }
  return t.prototype.getDefaultCfg = function() {
    return {
      center: [0, 0],
      nodeStrength: null,
      edgeStrength: null,
      preventOverlap: !1,
      nodeSize: void 0,
      nodeSpacing: void 0,
      linkDistance: 50,
      forceSimulation: null,
      alphaDecay: 0.028,
      alphaMin: 1e-3,
      alpha: 0.3,
      collideStrength: 1,
      clustering: !1,
      clusterNodeStrength: -1,
      clusterEdgeStrength: 0.1,
      clusterEdgeDistance: 100,
      clusterFociStrength: 0.8,
      clusterNodeSize: 10,
      tick: function() {
      },
      onLayoutEnd: function() {
      },
      workerEnabled: !1
    };
  }, t.prototype.init = function(e) {
    var n = this;
    n.nodes = e.nodes || [];
    var i = e.edges || [];
    n.edges = i.map(function(a) {
      var o = {}, s = ["targetNode", "sourceNode", "startPoint", "endPoint"];
      return Object.keys(a).forEach(function(u) {
        s.indexOf(u) > -1 || (o[u] = a[u]);
      }), o;
    }), n.ticking = !1;
  }, t.prototype.execute = function(e) {
    var n = this, i = n.nodes, a = n.edges;
    if (!n.ticking) {
      var o = n.forceSimulation, s = n.alphaMin, u = n.alphaDecay, f = n.alpha;
      if (o) {
        if (e) {
          if (n.clustering && n.clusterForce && (n.clusterForce.nodes(i), n.clusterForce.links(a)), o.nodes(i), a && n.edgeForce)
            n.edgeForce.links(a);
          else if (a && !n.edgeForce) {
            var h = ef.forceLink().id(function(g) {
              return g.id;
            }).links(a);
            n.edgeStrength && h.strength(n.edgeStrength), n.linkDistance && h.distance(n.linkDistance), n.edgeForce = h, o.force("link", h);
          }
        }
        n.preventOverlap && n.overlapProcess(o), o.alpha(f).restart(), this.ticking = !0;
      } else
        try {
          var l = ef.forceManyBody();
          if (n.nodeStrength && l.strength(n.nodeStrength), o = ef.forceSimulation().nodes(i), n.clustering) {
            var c = (0, OQ.default)();
            c.centerX(n.center[0]).centerY(n.center[1]).template("force").strength(n.clusterFociStrength), a && c.links(a), i && c.nodes(i), c.forceLinkDistance(n.clusterEdgeDistance).forceLinkStrength(n.clusterEdgeStrength).forceCharge(n.clusterNodeStrength).forceNodeSize(n.clusterNodeSize), n.clusterForce = c, o.force("group", c);
          }
          if (o.force("center", ef.forceCenter(n.center[0], n.center[1])).force("charge", l).alpha(f).alphaDecay(u).alphaMin(s), n.preventOverlap && n.overlapProcess(o), a) {
            var h = ef.forceLink().id(function(p) {
              return p.id;
            }).links(a);
            n.edgeStrength && h.strength(n.edgeStrength), n.linkDistance && h.distance(n.linkDistance), n.edgeForce = h, o.force("link", h);
          }
          if (n.workerEnabled && !RQ() && (n.workerEnabled = !1, console.warn("workerEnabled option is only supported when running in web worker.")), !n.workerEnabled)
            o.on("tick", function() {
              n.tick();
            }).on("end", function() {
              n.ticking = !1, n.onLayoutEnd && n.onLayoutEnd();
            }), n.ticking = !0;
          else {
            o.stop();
            for (var d = NQ(o), v = 1; v <= d; v++)
              o.tick(), postMessage({
                nodes: i,
                currentTick: v,
                totalTicks: d,
                type: kQ.LAYOUT_MESSAGE.TICK
              }, void 0);
            n.ticking = !1;
          }
          n.forceSimulation = o, n.ticking = !0;
        } catch (p) {
          n.ticking = !1, console.warn(p);
        }
    }
  }, t.prototype.overlapProcess = function(e) {
    var n = this, i = n.nodeSize, a = n.nodeSpacing, o, s, u = n.collideStrength;
    if ((0, zs.isNumber)(a) ? s = function() {
      return a;
    } : (0, zs.isFunction)(a) ? s = a : s = function() {
      return 0;
    }, !i)
      o = function(h) {
        if (h.size) {
          if ((0, zs.isArray)(h.size)) {
            var d = h.size[0] > h.size[1] ? h.size[0] : h.size[1];
            return d / 2 + s(h);
          }
          if ((0, zs.isObject)(h.size)) {
            var d = h.size.width > h.size.height ? h.size.width : h.size.height;
            return d / 2 + s(h);
          }
          return h.size / 2 + s(h);
        }
        return 10 + s(h);
      };
    else if ((0, zs.isFunction)(i))
      o = function(h) {
        var d = i(h);
        return d + s(h);
      };
    else if ((0, zs.isArray)(i)) {
      var f = i[0] > i[1] ? i[0] : i[1], l = f / 2;
      o = function(h) {
        return l + s(h);
      };
    } else if ((0, zs.isNumber)(i)) {
      var c = i / 2;
      o = function(h) {
        return c + s(h);
      };
    } else
      o = function() {
        return 10;
      };
    e.force("collisionForce", ef.forceCollide(o).strength(u));
  }, t.prototype.updateCfg = function(e) {
    var n = this;
    n.ticking && (n.forceSimulation.stop(), n.ticking = !1), n.forceSimulation = null, Object.assign(n, e);
  }, t.prototype.destroy = function() {
    var e = this;
    e.ticking && (e.forceSimulation.stop(), e.ticking = !1), e.nodes = null, e.edges = null, e.destroyed = !0;
  }, t;
}(DQ.Base);
eg.ForceLayout = LQ;
function NQ(r) {
  var t = r.alphaMin(), e = r.alphaTarget(), n = r.alpha(), i = Math.log((t - e) / (n - e)) / Math.log(1 - r.alphaDecay()), a = Math.ceil(i);
  return a;
}
function RQ() {
  return typeof WorkerGlobalScope < "u" && self instanceof WorkerGlobalScope;
}
(function(r) {
  var t = Oe && Oe.__createBinding || (Object.create ? function(n, i, a, o) {
    o === void 0 && (o = a);
    var s = Object.getOwnPropertyDescriptor(i, a);
    (!s || ("get" in s ? !i.__esModule : s.writable || s.configurable)) && (s = { enumerable: !0, get: function() {
      return i[a];
    } }), Object.defineProperty(n, o, s);
  } : function(n, i, a, o) {
    o === void 0 && (o = a), n[o] = i[a];
  }), e = Oe && Oe.__exportStar || function(n, i) {
    for (var a in n)
      a !== "default" && !Object.prototype.hasOwnProperty.call(i, a) && t(i, n, a);
  };
  Object.defineProperty(r, "__esModule", { value: !0 }), e(eg, r);
})(Wb);
var ch = {}, BQ = Oe && Oe.__extends || function() {
  var r = function(t, e) {
    return r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(n, i) {
      n.__proto__ = i;
    } || function(n, i) {
      for (var a in i)
        Object.prototype.hasOwnProperty.call(i, a) && (n[a] = i[a]);
    }, r(t, e);
  };
  return function(t, e) {
    if (typeof e != "function" && e !== null)
      throw new TypeError("Class extends value " + String(e) + " is not a constructor or null");
    r(t, e);
    function n() {
      this.constructor = t;
    }
    t.prototype = e === null ? Object.create(e) : (n.prototype = e.prototype, new n());
  };
}();
Object.defineProperty(ch, "__esModule", { value: !0 });
ch.CircularLayout = void 0;
var GQ = an, La = on();
function FQ(r, t, e, n) {
  r.forEach(function(i, a) {
    r[a].children = [], r[a].parent = [];
  }), n ? t.forEach(function(i) {
    var a = (0, La.getEdgeTerminal)(i, "source"), o = (0, La.getEdgeTerminal)(i, "target"), s = 0;
    a && (s = e[a]);
    var u = 0;
    o && (u = e[o]);
    var f = r[s].children, l = r[u].parent;
    f.push(r[u].id), l.push(r[s].id);
  }) : t.forEach(function(i) {
    var a = (0, La.getEdgeTerminal)(i, "source"), o = (0, La.getEdgeTerminal)(i, "target"), s = 0;
    a && (s = e[a]);
    var u = 0;
    o && (u = e[o]);
    var f = r[s].children, l = r[u].children;
    f.push(r[u].id), l.push(r[s].id);
  });
}
function zQ(r, t, e) {
  for (var n = e.length, i = 0; i < n; i++) {
    var a = (0, La.getEdgeTerminal)(e[i], "source"), o = (0, La.getEdgeTerminal)(e[i], "target");
    if (r.id === a && t.id === o || t.id === a && r.id === o)
      return !0;
  }
  return !1;
}
function UQ(r, t) {
  var e = r.degree, n = t.degree;
  return e < n ? -1 : e > n ? 1 : 0;
}
var jQ = function(r) {
  BQ(t, r);
  function t(e) {
    var n = r.call(this) || this;
    return n.radius = null, n.nodeSize = void 0, n.startRadius = null, n.endRadius = null, n.startAngle = 0, n.endAngle = 2 * Math.PI, n.clockwise = !0, n.divisions = 1, n.ordering = null, n.angleRatio = 1, n.nodes = [], n.edges = [], n.nodeMap = {}, n.degrees = [], n.width = 300, n.height = 300, n.updateCfg(e), n;
  }
  return t.prototype.getDefaultCfg = function() {
    return {
      radius: null,
      startRadius: null,
      endRadius: null,
      startAngle: 0,
      endAngle: 2 * Math.PI,
      clockwise: !0,
      divisions: 1,
      ordering: null,
      angleRatio: 1
    };
  }, t.prototype.execute = function() {
    var e, n = this, i = n.nodes, a = n.edges, o = i.length;
    if (o === 0) {
      n.onLayoutEnd && n.onLayoutEnd();
      return;
    }
    !n.width && typeof window < "u" && (n.width = window.innerWidth), !n.height && typeof window < "u" && (n.height = window.innerHeight), n.center || (n.center = [n.width / 2, n.height / 2]);
    var s = n.center;
    if (o === 1) {
      i[0].x = s[0], i[0].y = s[1], n.onLayoutEnd && n.onLayoutEnd();
      return;
    }
    var u = n.radius, f = n.startRadius, l = n.endRadius, c = n.divisions, h = n.startAngle, d = n.endAngle, v = n.angleRatio, p = n.ordering, g = n.clockwise, y = n.nodeSpacing, b = n.nodeSize, m = (d - h) / o, x = {};
    i.forEach(function(O, D) {
      x[O.id] = D;
    }), n.nodeMap = x;
    var _ = (0, La.getDegree)(i.length, x, a);
    if (n.degrees = _, y) {
      var w = (0, La.getFuncByUnknownType)(10, y), E = (0, La.getFuncByUnknownType)(10, b), M = -1 / 0;
      i.forEach(function(O) {
        var D = E(O);
        M < D && (M = D);
      });
      var C = 0;
      i.forEach(function(O, D) {
        D === 0 ? C += M || 10 : C += (w(O) || 0) + (M || 10);
      }), u = C / (2 * Math.PI);
    } else
      !u && !f && !l ? u = n.height > n.width ? n.width / 2 : n.height / 2 : !f && l ? f = l : f && !l && (l = f);
    var S = m * v, A = [];
    p === "topology" ? A = n.topologyOrdering() : p === "topology-directed" ? A = n.topologyOrdering(!0) : p === "degree" ? A = n.degreeOrdering() : A = i;
    for (var T = Math.ceil(o / c), P = 0; P < o; ++P) {
      var k = u;
      !k && f !== null && l !== null && (k = f + P * (l - f) / (o - 1)), k || (k = 10 + P * 100 / (o - 1));
      var L = h + P % T * S + 2 * Math.PI / c * Math.floor(P / T);
      g || (L = d - P % T * S - 2 * Math.PI / c * Math.floor(P / T)), A[P].x = s[0] + Math.cos(L) * k, A[P].y = s[1] + Math.sin(L) * k, A[P].weight = _[P].all;
    }
    return (e = n.onLayoutEnd) === null || e === void 0 || e.call(n), {
      nodes: A,
      edges: this.edges
    };
  }, t.prototype.topologyOrdering = function(e) {
    e === void 0 && (e = !1);
    var n = this, i = n.degrees, a = n.edges, o = n.nodes, s = (0, La.clone)(o), u = n.nodeMap, f = [s[0]], l = [o[0]], c = [], h = o.length;
    c[0] = !0, FQ(s, a, u, e);
    var d = 0;
    return s.forEach(function(v, p) {
      if (p !== 0)
        if ((p === h - 1 || i[p].all !== i[p + 1].all || zQ(f[d], v, a)) && !c[p])
          f.push(v), l.push(o[u[v.id]]), c[p] = !0, d++;
        else {
          for (var g = f[d].children, y = !1, b = 0; b < g.length; b++) {
            var m = u[g[b]];
            if (i[m].all === i[p].all && !c[m]) {
              f.push(s[m]), l.push(o[u[s[m].id]]), c[m] = !0, y = !0;
              break;
            }
          }
          for (var x = 0; !y && (c[x] || (f.push(s[x]), l.push(o[u[s[x].id]]), c[x] = !0, y = !0), x++, x !== h); )
            ;
        }
    }), l;
  }, t.prototype.degreeOrdering = function() {
    var e = this, n = e.nodes, i = [], a = e.degrees;
    return n.forEach(function(o, s) {
      o.degree = a[s].all, i.push(o);
    }), i.sort(UQ), i;
  }, t.prototype.getType = function() {
    return "circular";
  }, t;
}(GQ.Base);
ch.CircularLayout = jQ;
var al = {}, Yb = {}, Hb = {}, Kb = {}, qb = {}, Zb = {};
Object.defineProperty(Zb, "__esModule", { value: !0 });
var $Q = function(r, t) {
  if (r !== "next" && r !== "prev")
    return t;
}, ES = function(r) {
  r.prev.next = r.next, r.next.prev = r.prev, delete r.next, delete r.prev;
}, WQ = function() {
  function r() {
    var t = {};
    t.prev = t, t.next = t.prev, this.shortcut = t;
  }
  return r.prototype.dequeue = function() {
    var t = this.shortcut, e = t.prev;
    if (e && e !== t)
      return ES(e), e;
  }, r.prototype.enqueue = function(t) {
    var e = this.shortcut;
    t.prev && t.next && ES(t), t.next = e.next, e.next.prev = t, e.next = t, t.prev = e;
  }, r.prototype.toString = function() {
    for (var t = [], e = this.shortcut, n = e.prev; n !== e; )
      t.push(JSON.stringify(n, $Q)), n = n == null ? void 0 : n.prev;
    return "[".concat(t.join(", "), "]");
  }, r;
}();
Zb.default = WQ;
var Df;
(function(r) {
  r.DEFAULT_EDGE_NAME = "\0", r.GRAPH_NODE = "\0", r.EDGE_KEY_DELIM = "";
})(Df || (Df = {}));
function SS(r, t) {
  var e = r.get(t) || 0;
  r.set(t, e + 1);
}
function MS(r, t) {
  var e = r.get(t);
  e !== void 0 && (e = e - 1, e > 0 ? r.set(t, e) : r.delete(t));
}
function n3(r, t, e, n) {
  var i = String(t), a = String(e);
  if (!r && i > a) {
    var o = i;
    i = a, a = o;
  }
  return i + Df.EDGE_KEY_DELIM + a + Df.EDGE_KEY_DELIM + (n === void 0 ? Df.DEFAULT_EDGE_NAME : n);
}
function CS(r, t, e, n) {
  var i = String(t), a = String(e), o = {
    v: t,
    w: e
  };
  if (!r && i > a) {
    var s = o.v;
    o.v = o.w, o.w = s;
  }
  return n !== void 0 && (o.name = n), o;
}
function oy(r, t) {
  return n3(r, t.v, t.w, t.name);
}
function TS(r) {
  return typeof r == "function";
}
var VQ = function(t) {
  return t.nodes().map(function(e) {
    var n = t.node(e), i = t.parent(e), a = {
      id: e,
      value: n,
      parent: i
    };
    return a.value === void 0 && delete a.value, a.parent === void 0 && delete a.parent, a;
  });
}, XQ = function(t) {
  return t.edges().map(function(e) {
    var n = t.edge(e), i = {
      v: e.v,
      w: e.w,
      value: n,
      name: e.name
    };
    return i.name === void 0 && delete i.name, i.value === void 0 && delete i.value, i;
  });
}, YQ = function(t) {
  var e = {
    options: {
      directed: t.isDirected(),
      multigraph: t.isMultigraph(),
      compound: t.isCompound()
    },
    nodes: VQ(t),
    edges: XQ(t),
    value: t.graph()
  };
  return e.value === void 0 && delete e.value, e;
}, HQ = function(t) {
  var e = new Tu(t.options);
  return t.value !== void 0 && e.setGraph(t.value), t.nodes.forEach(function(n) {
    e.setNode(n.id, n.value), n.parent && e.setParent(n.id, n.parent);
  }), t.edges.forEach(function(n) {
    e.setEdge(n.v, n.w, n.value, n.name);
  }), e;
};
function AS(r, t) {
  var e = Object.keys(r);
  if (Object.getOwnPropertySymbols) {
    var n = Object.getOwnPropertySymbols(r);
    t && (n = n.filter(function(i) {
      return Object.getOwnPropertyDescriptor(r, i).enumerable;
    })), e.push.apply(e, n);
  }
  return e;
}
function IS(r) {
  for (var t = 1; t < arguments.length; t++) {
    var e = arguments[t] != null ? arguments[t] : {};
    t % 2 ? AS(Object(e), !0).forEach(function(n) {
      KQ(r, n, e[n]);
    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(r, Object.getOwnPropertyDescriptors(e)) : AS(Object(e)).forEach(function(n) {
      Object.defineProperty(r, n, Object.getOwnPropertyDescriptor(e, n));
    });
  }
  return r;
}
function KQ(r, t, e) {
  return t in r ? Object.defineProperty(r, t, { value: e, enumerable: !0, configurable: !0, writable: !0 }) : r[t] = e, r;
}
function qQ(r, t) {
  if (!(r instanceof t))
    throw new TypeError("Cannot call a class as a function");
}
function PS(r, t) {
  for (var e = 0; e < t.length; e++) {
    var n = t[e];
    n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(r, n.key, n);
  }
}
function ZQ(r, t, e) {
  return t && PS(r.prototype, t), e && PS(r, e), Object.defineProperty(r, "prototype", { writable: !1 }), r;
}
var QQ = {
  compound: !1,
  multigraph: !1,
  directed: !0
}, Tu = /* @__PURE__ */ function() {
  function r() {
    var t = this, e = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : {};
    qQ(this, r), this.directed = !0, this.multigraph = !1, this.compound = !1, this.GRAPH_NODE = Df.GRAPH_NODE, this.label = void 0, this.nodeCountNum = 0, this.edgeCountNum = 0, this.defaultNodeLabelFn = function() {
    }, this.defaultEdgeLabelFn = function() {
    }, this.parentMap = void 0, this.childrenMap = void 0, this.nodesLabelMap = /* @__PURE__ */ new Map(), this.inEdgesMap = /* @__PURE__ */ new Map(), this.outEdgesMap = /* @__PURE__ */ new Map(), this.predecessorsMap = /* @__PURE__ */ new Map(), this.successorsMap = /* @__PURE__ */ new Map(), this.edgesMap = /* @__PURE__ */ new Map(), this.edgesLabelsMap = /* @__PURE__ */ new Map(), this.isDirected = function() {
      return t.directed;
    }, this.isMultigraph = function() {
      return t.multigraph;
    }, this.isCompound = function() {
      return t.compound;
    }, this.setGraph = function(i) {
      return t.label = i, t;
    }, this.graph = function() {
      return t.label;
    }, this.setDefaultNodeLabel = function(i) {
      return TS(i) ? t.defaultNodeLabelFn = i : t.defaultNodeLabelFn = function() {
        return i;
      }, t;
    }, this.nodeCount = function() {
      return t.nodeCountNum;
    }, this.node = function(i) {
      return t.nodesLabelMap.get(i);
    }, this.nodes = function() {
      return Array.from(t.nodesLabelMap.keys());
    }, this.sources = function() {
      return t.nodes().filter(function(i) {
        var a;
        return !(!((a = t.inEdgesMap.get(i)) === null || a === void 0) && a.size);
      });
    }, this.sinks = function() {
      return t.nodes().filter(function(i) {
        var a;
        return !(!((a = t.outEdgesMap.get(i)) === null || a === void 0) && a.size);
      });
    }, this.setNodes = function(i, a) {
      return i.map(function(o) {
        return t.setNode(o, a);
      }), t;
    }, this.hasNode = function(i) {
      return t.nodesLabelMap.has(i);
    }, this.checkCompound = function() {
      if (!t.isCompound())
        throw new Error("Cannot construct parent-children relations in a non-compound graph");
    }, this.parent = function(i) {
      if (t.isCompound()) {
        var a, o = (a = t.parentMap) === null || a === void 0 ? void 0 : a.get(i);
        if (o !== t.GRAPH_NODE)
          return o;
      }
    }, this.removeFromParentsChildList = function(i) {
      var a = t.parentMap.get(i);
      t.childrenMap.get(a).delete(i);
    }, this.setParent = function(i, a) {
      var o, s;
      t.checkCompound();
      for (var u = a === void 0 ? t.GRAPH_NODE : a, f = t.parent(u); f; ) {
        if (i === f)
          throw new Error("Setting " + a + " as parent of " + i + " would create a cycle");
        f = t.parent(f);
      }
      a && t.setNode(a), t.setNode(i), t.removeFromParentsChildList(i), (o = t.parentMap) === null || o === void 0 || o.set(i, u);
      var l = t.childrenMap.get(u);
      return l.set(i, !0), (s = t.childrenMap) === null || s === void 0 || s.set(u, l), t;
    }, this.children = function(i) {
      var a = i === void 0 ? t.GRAPH_NODE : i;
      if (t.isCompound()) {
        var o, s = (o = t.childrenMap) === null || o === void 0 ? void 0 : o.get(a);
        return s ? Array.from(s.keys()) : void 0;
      }
      if (a === t.GRAPH_NODE)
        return t.nodes();
      if (i && t.hasNode(i))
        return [];
    }, this.predecessors = function(i) {
      var a = t.predecessorsMap.get(i);
      return a ? Array.from(a.keys()) : void 0;
    }, this.successors = function(i) {
      var a = t.successorsMap.get(i);
      return a ? Array.from(a.keys()) : void 0;
    }, this.neighbors = function(i) {
      var a;
      if (!!t.hasNode(i))
        return Array.from(new Set((a = t.predecessors(i)) === null || a === void 0 ? void 0 : a.concat(t.successors(i))));
    }, this.isLeaf = function(i) {
      var a;
      if (t.isDirected()) {
        var o;
        return !(!((o = t.successors(i)) === null || o === void 0) && o.length);
      }
      return !(!((a = t.neighbors(i)) === null || a === void 0) && a.length);
    }, this.filterNodes = function(i) {
      var a = t.directed, o = t.multigraph, s = t.compound, u = new r({
        directed: a,
        multigraph: o,
        compound: s
      });
      if (u.setGraph(t.graph()), t.nodes().forEach(function(l) {
        i(l) && u.setNode(l, t.node(l));
      }), t.edges().forEach(function(l) {
        u.hasNode(l.v) && u.hasNode(l.w) && u.setEdgeObj(l, t.edge(l));
      }), s) {
        var f = function(c) {
          for (var h = t.parent(c); h !== void 0 && !u.hasNode(h); )
            h = t.parent(h);
          return h;
        };
        u.nodes().forEach(function(l) {
          u.setParent(l, f(l));
        });
      }
      return u;
    }, this.setDefaultEdgeLabel = function(i) {
      return TS(i) ? t.defaultEdgeLabelFn = i : t.defaultEdgeLabelFn = function() {
        return i;
      }, t;
    }, this.edgeCount = function() {
      return t.edgeCountNum;
    }, this.setEdgeObj = function(i, a) {
      return t.setEdge(i.v, i.w, a, i.name);
    }, this.setPath = function(i, a) {
      return i.reduce(function(o, s) {
        return t.setEdge(o, s, a), s;
      }), t;
    }, this.edgeFromArgs = function(i, a, o) {
      return t.edge({
        v: i,
        w: a,
        name: o
      });
    }, this.edge = function(i) {
      return t.edgesLabelsMap.get(oy(t.isDirected(), i));
    }, this.hasEdge = function(i, a, o) {
      return t.edgesLabelsMap.has(oy(t.isDirected(), {
        v: i,
        w: a,
        name: o
      }));
    }, this.removeEdgeObj = function(i) {
      var a = i.v, o = i.w, s = i.name;
      return t.removeEdge(a, o, s);
    }, this.edges = function() {
      return Array.from(t.edgesMap.values());
    }, this.inEdges = function(i, a) {
      var o = t.inEdgesMap.get(i);
      if (o)
        return Array.from(o.values()).filter(function(s) {
          return !a || s.v === a;
        });
    }, this.outEdges = function(i, a) {
      var o = t.outEdgesMap.get(i);
      if (o)
        return Array.from(o.values()).filter(function(s) {
          return !a || s.w === a;
        });
    }, this.nodeEdges = function(i, a) {
      var o;
      if (!!t.hasNode(i))
        return (o = t.inEdges(i, a)) === null || o === void 0 ? void 0 : o.concat(t.outEdges(i, a));
    }, this.toJSON = function() {
      return YQ(t);
    }, this.nodeInDegree = function(i) {
      var a = t.inEdgesMap.get(i);
      return a ? a.size : 0;
    }, this.nodeOutDegree = function(i) {
      var a = t.outEdgesMap.get(i);
      return a ? a.size : 0;
    }, this.nodeDegree = function(i) {
      return t.nodeInDegree(i) + t.nodeOutDegree(i);
    }, this.source = function(i) {
      return i.v;
    }, this.target = function(i) {
      return i.w;
    };
    var n = IS(IS({}, QQ), e);
    this.compound = n.compound, this.directed = n.directed, this.multigraph = n.multigraph, this.compound && (this.parentMap = /* @__PURE__ */ new Map(), this.childrenMap = /* @__PURE__ */ new Map());
  }
  return ZQ(r, [{
    key: "setNode",
    value: function(e, n) {
      var i = this.nodesLabelMap, a = this.defaultNodeLabelFn, o = this.isCompound, s = this.parentMap, u = this.childrenMap, f = this.inEdgesMap, l = this.outEdgesMap, c = this.predecessorsMap, h = this.successorsMap;
      if (i.has(e))
        return n !== void 0 && i.set(e, n), this;
      if (i.set(e, n || a(e)), o()) {
        var d;
        s == null || s.set(e, this.GRAPH_NODE), u == null || u.set(e, /* @__PURE__ */ new Map()), u != null && u.has(this.GRAPH_NODE) || u == null || u.set(this.GRAPH_NODE, /* @__PURE__ */ new Map()), u == null || (d = u.get(this.GRAPH_NODE)) === null || d === void 0 || d.set(e, !0);
      }
      return [f, l, c, h].forEach(function(v) {
        return v.set(e, /* @__PURE__ */ new Map());
      }), this.nodeCountNum += 1, this;
    }
  }, {
    key: "removeNode",
    value: function(e) {
      var n = this;
      if (this.hasNode(e)) {
        var i = function(g) {
          n.removeEdge(g.v, g.w, g.name);
        }, a = this.inEdgesMap, o = this.outEdgesMap, s = this.predecessorsMap, u = this.successorsMap, f = this.nodesLabelMap;
        if (this.isCompound()) {
          var l, c, h;
          this.removeFromParentsChildList(e), (l = this.parentMap) === null || l === void 0 || l.delete(e), (c = this.children(e)) === null || c === void 0 || c.forEach(function(p) {
            return n.setParent(p);
          }), (h = this.childrenMap) === null || h === void 0 || h.delete(e);
        }
        var d = a.get(e), v = o.get(e);
        Array.from(d.values()).forEach(function(p) {
          return i(p);
        }), Array.from(v.values()).forEach(function(p) {
          return i(p);
        }), f.delete(e), a.delete(e), o.delete(e), s.delete(e), u.delete(e), this.nodeCountNum -= 1;
      }
      return this;
    }
  }, {
    key: "setEdge",
    value: function(e, n, i, a) {
      var o, s, u = CS(this.isDirected(), e, n, a), f = oy(this.isDirected(), u), l = u.v, c = u.w;
      if (this.edgesLabelsMap.has(f))
        return this.edgesLabelsMap.set(f, i), this;
      if (a !== void 0 && !this.isMultigraph())
        throw new Error("Cannot set a named edge when isMultigraph = false");
      this.setNode(l), this.setNode(c), this.edgesLabelsMap.set(f, i || this.defaultEdgeLabelFn(l, c, a)), Object.freeze(u), this.edgesMap.set(f, u);
      var h = this.predecessorsMap.get(c), d = this.successorsMap.get(l);
      return SS(h, l), SS(d, c), (o = this.inEdgesMap.get(c)) === null || o === void 0 || o.set(f, u), (s = this.outEdgesMap.get(l)) === null || s === void 0 || s.set(f, u), this.edgeCountNum += 1, this;
    }
  }, {
    key: "removeEdge",
    value: function(e, n, i) {
      var a = n3(this.isDirected(), e, n, i), o = this.edgesMap.get(a);
      if (o) {
        var s = CS(this.isDirected(), e, n, i), u = s.v, f = s.w;
        this.edgesLabelsMap.delete(a), this.edgesMap.delete(a);
        var l = this.predecessorsMap.get(f), c = this.successorsMap.get(u);
        MS(l, u), MS(c, f), this.inEdgesMap.get(f).delete(a), this.outEdgesMap.get(u).delete(a), this.edgeCountNum -= 1;
      }
      return this;
    }
  }]), r;
}();
Tu.fromJSON = HQ;
function Xm(r) {
  return Xm = typeof Symbol == "function" && typeof Symbol.iterator == "symbol" ? function(t) {
    return typeof t;
  } : function(t) {
    return t && typeof Symbol == "function" && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t;
  }, Xm(r);
}
function JQ(r, t) {
  if (!(r instanceof t))
    throw new TypeError("Cannot call a class as a function");
}
function OS(r, t) {
  for (var e = 0; e < t.length; e++) {
    var n = t[e];
    n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(r, n.key, n);
  }
}
function eJ(r, t, e) {
  return t && OS(r.prototype, t), e && OS(r, e), Object.defineProperty(r, "prototype", { writable: !1 }), r;
}
function su() {
  return typeof Reflect < "u" && Reflect.get ? su = Reflect.get : su = function(t, e, n) {
    var i = tJ(t, e);
    if (!!i) {
      var a = Object.getOwnPropertyDescriptor(i, e);
      return a.get ? a.get.call(arguments.length < 3 ? t : n) : a.value;
    }
  }, su.apply(this, arguments);
}
function tJ(r, t) {
  for (; !Object.prototype.hasOwnProperty.call(r, t) && (r = yo(r), r !== null); )
    ;
  return r;
}
function rJ(r, t) {
  if (typeof t != "function" && t !== null)
    throw new TypeError("Super expression must either be null or a function");
  r.prototype = Object.create(t && t.prototype, { constructor: { value: r, writable: !0, configurable: !0 } }), Object.defineProperty(r, "prototype", { writable: !1 }), t && Ym(r, t);
}
function Ym(r, t) {
  return Ym = Object.setPrototypeOf || function(n, i) {
    return n.__proto__ = i, n;
  }, Ym(r, t);
}
function nJ(r) {
  var t = oJ();
  return function() {
    var n = yo(r), i;
    if (t) {
      var a = yo(this).constructor;
      i = Reflect.construct(n, arguments, a);
    } else
      i = n.apply(this, arguments);
    return iJ(this, i);
  };
}
function iJ(r, t) {
  if (t && (Xm(t) === "object" || typeof t == "function"))
    return t;
  if (t !== void 0)
    throw new TypeError("Derived constructors may only return object or undefined");
  return aJ(r);
}
function aJ(r) {
  if (r === void 0)
    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
  return r;
}
function oJ() {
  if (typeof Reflect > "u" || !Reflect.construct || Reflect.construct.sham)
    return !1;
  if (typeof Proxy == "function")
    return !0;
  try {
    return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function() {
    })), !0;
  } catch {
    return !1;
  }
}
function yo(r) {
  return yo = Object.setPrototypeOf ? Object.getPrototypeOf : function(e) {
    return e.__proto__ || Object.getPrototypeOf(e);
  }, yo(r);
}
var sJ = /* @__PURE__ */ function(r) {
  rJ(e, r);
  var t = nJ(e);
  function e() {
    var n;
    JQ(this, e);
    for (var i = arguments.length, a = new Array(i), o = 0; o < i; o++)
      a[o] = arguments[o];
    return n = t.call.apply(t, [this].concat(a)), n.eventPool = {}, n;
  }
  return eJ(e, [{
    key: "appendEvent",
    value: function(i, a) {
      this.eventPool[i] || (this.eventPool[i] = []), this.eventPool[i].push(a);
    }
  }, {
    key: "removeEvent",
    value: function(i, a) {
      if (!!this.eventPool[i]) {
        var o = this.eventPool[i].indexOf(a);
        o > -1 && this.eventPool[i].splice(o, 1);
      }
    }
  }, {
    key: "emitEvent",
    value: function(i) {
      for (var a = arguments.length, o = new Array(a > 1 ? a - 1 : 0), s = 1; s < a; s++)
        o[s - 1] = arguments[s];
      !this.eventPool[i] || this.eventPool[i].forEach(function(u) {
        u.apply(void 0, o);
      });
    }
  }, {
    key: "setNode",
    value: function(i, a) {
      return su(yo(e.prototype), "setNode", this).call(this, i, a), this.emitEvent("nodeAdd", i, a), this;
    }
  }, {
    key: "removeNode",
    value: function(i) {
      return su(yo(e.prototype), "removeNode", this).call(this, i), this.emitEvent("nodeRemove", i), this;
    }
  }, {
    key: "setEdge",
    value: function(i, a, o, s) {
      return su(yo(e.prototype), "setEdge", this).call(this, i, a, o, s), this.emitEvent("edgeAdd", i, a, o, s), this;
    }
  }, {
    key: "removeEdge",
    value: function(i, a, o) {
      return su(yo(e.prototype), "removeEdge", this).call(this, i, a, o), this.emitEvent("edgeRemove", i, a, o), this;
    }
  }]), e;
}(Tu);
function DS(r, t) {
  for (var e = 0; e < t.length; e++) {
    var n = t[e];
    n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(r, n.key, n);
  }
}
function uJ(r, t, e) {
  return t && DS(r.prototype, t), e && DS(r, e), Object.defineProperty(r, "prototype", { writable: !1 }), r;
}
function fJ(r, t) {
  if (!(r instanceof t))
    throw new TypeError("Cannot call a class as a function");
}
var i3 = /* @__PURE__ */ uJ(function r() {
  var t = this;
  fJ(this, r), this.arr = [], this.keyIndice = /* @__PURE__ */ new Map(), this.size = function() {
    return t.arr.length;
  }, this.keys = function() {
    return t.arr.map(function(e) {
      return e.key;
    });
  }, this.has = function(e) {
    return t.keyIndice.has(e);
  }, this.priority = function(e) {
    var n = t.keyIndice.get(e);
    if (n !== void 0)
      return t.arr[n].priority;
  }, this.swap = function(e, n) {
    var i = t.arr, a = t.keyIndice, o = [i[e], i[n]], s = o[0], u = o[1];
    i[e] = u, i[n] = s, a.set(s.key, n), a.set(u.key, e);
  }, this.innerDecrease = function(e) {
    for (var n = t.arr, i = n[e].priority, a, o = e; o !== 0; ) {
      var s;
      if (a = o >> 1, ((s = n[a]) === null || s === void 0 ? void 0 : s.priority) < i)
        break;
      t.swap(o, a), o = a;
    }
  }, this.heapify = function(e) {
    var n = t.arr, i = e << 1, a = i + 1, o = e;
    i < n.length && (o = n[i].priority < n[o].priority ? i : o, a < n.length && (o = n[a].priority < n[o].priority ? a : o), o !== e && (t.swap(e, o), t.heapify(o)));
  }, this.min = function() {
    if (t.size() === 0)
      throw new Error("Queue underflow");
    return t.arr[0].key;
  }, this.add = function(e, n) {
    var i = t.keyIndice, a = t.arr;
    if (!i.has(e)) {
      var o = a.length;
      return i.set(e, o), a.push({
        key: e,
        priority: n
      }), t.innerDecrease(o), !0;
    }
    return !1;
  }, this.removeMin = function() {
    t.swap(0, t.arr.length - 1);
    var e = t.arr.pop();
    return t.keyIndice.delete(e.key), t.heapify(0), e.key;
  }, this.decrease = function(e, n) {
    if (!t.has(e))
      throw new Error("There's no key named ".concat(e));
    var i = t.keyIndice.get(e);
    if (n > t.arr[i].priority)
      throw new Error("New priority is greater than current priority.Key: ".concat(e, " Old: + ").concat(t.arr[i].priority, " New: ").concat(n));
    t.arr[i].priority = n, t.innerDecrease(i);
  };
}), lJ = function(t, e) {
  var n = new Tu(), i = /* @__PURE__ */ new Map(), a = new i3(), o;
  function s(l) {
    var c = l.v === o ? l.w : l.v, h = a.priority(c);
    if (h !== void 0) {
      var d = e(l);
      d < h && (i.set(c, o), a.decrease(c, d));
    }
  }
  if (t.nodeCount() === 0)
    return n;
  t.nodes().forEach(function(l) {
    a.add(l, Number.POSITIVE_INFINITY), n.setNode(l);
  }), a.decrease(t.nodes()[0], 0);
  for (var u = !1; a.size() > 0; ) {
    var f;
    if (o = a.removeMin(), i.has(o))
      n.setEdge(o, i.get(o));
    else {
      if (u)
        throw new Error("Input graph is not connected: " + t.graph());
      u = !0;
    }
    (f = t.nodeEdges(o)) === null || f === void 0 || f.forEach(s);
  }
  return n;
}, cJ = function(t) {
  var e = /* @__PURE__ */ new Set(), n = [], i = t.nodes();
  return i.forEach(function(a) {
    for (var o = [], s = [a]; s.length > 0; ) {
      var u = s.pop();
      if (!e.has(u)) {
        var f, l;
        e.add(u), o.push(u), (f = t.successors(u)) === null || f === void 0 || f.forEach(function(c) {
          return s.push(c);
        }), (l = t.predecessors(u)) === null || l === void 0 || l.forEach(function(c) {
          return s.push(c);
        });
      }
    }
    o.length && n.push(o);
  }), n;
}, hJ = function r(t, e, n, i, a, o) {
  i.includes(e) || (i.push(e), n || o.push(e), a(e).forEach(function(s) {
    return r(t, s, n, i, a, o);
  }), n && o.push(e));
}, Qb = function(t, e, n) {
  var i = Array.isArray(e) ? e : [e], a = function(f) {
    return t.isDirected() ? t.successors(f) : t.neighbors(f);
  }, o = [], s = [];
  return i.forEach(function(u) {
    if (t.hasNode(u))
      hJ(t, u, n === "post", s, a, o);
    else
      throw new Error("Graph does not have node: " + u);
  }), o;
};
function dJ(r, t) {
  return yJ(r) || gJ(r, t) || pJ(r, t) || vJ();
}
function vJ() {
  throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`);
}
function pJ(r, t) {
  if (!!r) {
    if (typeof r == "string")
      return kS(r, t);
    var e = Object.prototype.toString.call(r).slice(8, -1);
    if (e === "Object" && r.constructor && (e = r.constructor.name), e === "Map" || e === "Set")
      return Array.from(r);
    if (e === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))
      return kS(r, t);
  }
}
function kS(r, t) {
  (t == null || t > r.length) && (t = r.length);
  for (var e = 0, n = new Array(t); e < t; e++)
    n[e] = r[e];
  return n;
}
function gJ(r, t) {
  var e = r == null ? null : typeof Symbol < "u" && r[Symbol.iterator] || r["@@iterator"];
  if (e != null) {
    var n = [], i = !0, a = !1, o, s;
    try {
      for (e = e.call(r); !(i = (o = e.next()).done) && (n.push(o.value), !(t && n.length === t)); i = !0)
        ;
    } catch (u) {
      a = !0, s = u;
    } finally {
      try {
        !i && e.return != null && e.return();
      } finally {
        if (a)
          throw s;
      }
    }
    return n;
  }
}
function yJ(r) {
  if (Array.isArray(r))
    return r;
}
var mJ = function() {
  return 1;
}, a3 = function(t, e, n, i) {
  return bJ(t, e, n || mJ, i || function(a) {
    return t.outEdges(a);
  });
}, bJ = function(t, e, n, i) {
  var a = /* @__PURE__ */ new Map(), o = new i3(), s, u, f = function(h) {
    var d = h.v !== s ? h.v : h.w, v = a.get(d), p = n(h), g = u.distance + p;
    if (p < 0)
      throw new Error("dijkstra does not allow negative edge weights. Bad edge: " + h + " Weight: " + p);
    g < v.distance && (v.distance = g, v.predecessor = s, o.decrease(d, g));
  };
  for (t.nodes().forEach(function(c) {
    var h = c === e ? 0 : Number.POSITIVE_INFINITY;
    a.set(c, {
      distance: h
    }), o.add(c, h);
  }); o.size() > 0 && (s = o.removeMin(), u = a.get(s), !(u && u.distance === Number.POSITIVE_INFINITY)); )
    i(s).forEach(f);
  var l = {};
  return Array.from(a.entries()).forEach(function(c) {
    var h = dJ(c, 2), d = h[0], v = h[1];
    return l[String(d)] = v, l;
  }), l;
}, xJ = function(t, e, n) {
  var i = {};
  return t.nodes().forEach(function(a) {
    return i[String(a)] = a3(t, a, e, n), i;
  }), i;
}, o3 = function(t) {
  var e = 0, n = [], i = /* @__PURE__ */ new Map(), a = [];
  function o(s) {
    var u, f = {
      onStack: !0,
      lowlink: e,
      index: e
    };
    if (i.set(s, f), e += 1, n.push(s), (u = t.successors(s)) === null || u === void 0 || u.forEach(function(d) {
      var v;
      if (i.has(d)) {
        if (!((v = i.get(d)) === null || v === void 0) && v.onStack) {
          var g = i.get(d);
          f.lowlink = Math.min(f.lowlink, g.index);
        }
      } else {
        o(d);
        var p = i.get(d);
        f.lowlink = Math.min(f.lowlink, p.lowlink);
      }
    }), f.lowlink === f.index) {
      var l = [], c;
      do {
        c = n.pop();
        var h = i.get(c);
        h.onStack = !1, l.push(c);
      } while (s !== c);
      a.push(l);
    }
  }
  return t.nodes().forEach(function(s) {
    i.has(s) || o(s);
  }), a;
}, _J = function(t) {
  return o3(t).filter(function(e) {
    return e.length > 1 || e.length === 1 && t.hasEdge(e[0], e[0]);
  });
};
function Hm(r) {
  return Hm = typeof Symbol == "function" && typeof Symbol.iterator == "symbol" ? function(t) {
    return typeof t;
  } : function(t) {
    return t && typeof Symbol == "function" && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t;
  }, Hm(r);
}
function LS(r, t) {
  for (var e = 0; e < t.length; e++) {
    var n = t[e];
    n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(r, n.key, n);
  }
}
function wJ(r, t, e) {
  return t && LS(r.prototype, t), e && LS(r, e), Object.defineProperty(r, "prototype", { writable: !1 }), r;
}
function EJ(r, t) {
  if (!(r instanceof t))
    throw new TypeError("Cannot call a class as a function");
}
function SJ(r, t) {
  if (typeof t != "function" && t !== null)
    throw new TypeError("Super expression must either be null or a function");
  r.prototype = Object.create(t && t.prototype, { constructor: { value: r, writable: !0, configurable: !0 } }), Object.defineProperty(r, "prototype", { writable: !1 }), t && jc(r, t);
}
function MJ(r) {
  var t = s3();
  return function() {
    var n = $c(r), i;
    if (t) {
      var a = $c(this).constructor;
      i = Reflect.construct(n, arguments, a);
    } else
      i = n.apply(this, arguments);
    return CJ(this, i);
  };
}
function CJ(r, t) {
  if (t && (Hm(t) === "object" || typeof t == "function"))
    return t;
  if (t !== void 0)
    throw new TypeError("Derived constructors may only return object or undefined");
  return TJ(r);
}
function TJ(r) {
  if (r === void 0)
    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
  return r;
}
function Km(r) {
  var t = typeof Map == "function" ? /* @__PURE__ */ new Map() : void 0;
  return Km = function(n) {
    if (n === null || !AJ(n))
      return n;
    if (typeof n != "function")
      throw new TypeError("Super expression must either be null or a function");
    if (typeof t < "u") {
      if (t.has(n))
        return t.get(n);
      t.set(n, i);
    }
    function i() {
      return Ev(n, arguments, $c(this).constructor);
    }
    return i.prototype = Object.create(n.prototype, { constructor: { value: i, enumerable: !1, writable: !0, configurable: !0 } }), jc(i, n);
  }, Km(r);
}
function Ev(r, t, e) {
  return s3() ? Ev = Reflect.construct : Ev = function(i, a, o) {
    var s = [null];
    s.push.apply(s, a);
    var u = Function.bind.apply(i, s), f = new u();
    return o && jc(f, o.prototype), f;
  }, Ev.apply(null, arguments);
}
function s3() {
  if (typeof Reflect > "u" || !Reflect.construct || Reflect.construct.sham)
    return !1;
  if (typeof Proxy == "function")
    return !0;
  try {
    return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function() {
    })), !0;
  } catch {
    return !1;
  }
}
function AJ(r) {
  return Function.toString.call(r).indexOf("[native code]") !== -1;
}
function jc(r, t) {
  return jc = Object.setPrototypeOf || function(n, i) {
    return n.__proto__ = i, n;
  }, jc(r, t);
}
function $c(r) {
  return $c = Object.setPrototypeOf ? Object.getPrototypeOf : function(e) {
    return e.__proto__ || Object.getPrototypeOf(e);
  }, $c(r);
}
var qm = /* @__PURE__ */ function(r) {
  SJ(e, r);
  var t = MJ(e);
  function e() {
    return EJ(this, e), t.apply(this, arguments);
  }
  return wJ(e);
}(/* @__PURE__ */ Km(Error));
function u3(r) {
  var t = /* @__PURE__ */ new Set(), e = /* @__PURE__ */ new Set(), n = [];
  function i(a) {
    if (e.has(a))
      throw new qm();
    if (!t.has(a)) {
      var o;
      e.add(a), t.add(a), (o = r.predecessors(a)) === null || o === void 0 || o.forEach(i), e.delete(a), n.push(a);
    }
  }
  if (r.sinks().forEach(i), t.size !== r.nodeCount())
    throw new qm();
  return n;
}
var IJ = function(t) {
  try {
    u3(t);
  } catch (e) {
    if (e instanceof qm)
      return !1;
    throw e;
  }
  return !0;
}, PJ = function(t, e) {
  return Qb(t, e, "post");
}, OJ = function(t, e) {
  return Qb(t, e, "pre");
}, DJ = function() {
  return 1;
};
function kJ(r, t, e) {
  return LJ(r, t || DJ, e || function(n) {
    return r.outEdges(n);
  });
}
function LJ(r, t, e) {
  var n = {}, i = r.nodes();
  return i.forEach(function(a) {
    var o = String(a);
    n[o] = {}, n[o][o] = {
      distance: 0
    }, i.forEach(function(s) {
      a !== s && (n[o][String(s)] = {
        distance: Number.POSITIVE_INFINITY
      });
    }), e(a).forEach(function(s) {
      var u = s.v === a ? s.w : s.v, f = t(s);
      n[o][String(u)] = {
        distance: f,
        predecessor: a
      };
    });
  }), i.forEach(function(a) {
    var o = String(a), s = n[o];
    i.forEach(function(u) {
      var f = String(u), l = n[f];
      i.forEach(function(c) {
        var h = String(c), d = l[o], v = s[h], p = l[h], g = d.distance + v.distance;
        g < p.distance && (p.distance = g, p.predecessor = v.predecessor);
      });
    });
  }), n;
}
const NJ = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  components: cJ,
  dfs: Qb,
  dijkstra: a3,
  dijkstraAll: xJ,
  findCycles: _J,
  tarjan: o3,
  isAcyclic: IJ,
  postorder: PJ,
  preorder: OJ,
  prim: lJ,
  topsort: u3,
  floydWarshall: kJ
}, Symbol.toStringTag, { value: "Module" }));
var RJ = function(t, e) {
  for (var n = t.nodes(), i = 0; i < n.length; i++) {
    var a = n[i];
    if (e.hasNode(a))
      return !0;
  }
  return !1;
}, f3 = function(t, e) {
  for (var n = t.edges(), i = 0; i < n.length; i++) {
    var a = n[i];
    if (e.hasEdge(a.v, a.w, a.name))
      return !0;
  }
  return !1;
}, l3 = function(t, e) {
  var n = t.nodes(), i = n.filter(function(a) {
    return e.hasNode(a);
  });
  return i;
}, c3 = function(t, e) {
  var n = t.edges(), i = n.filter(function(a) {
    return e.hasEdge(a.v, a.w, a.name);
  });
  return i;
}, h3 = function(t, e) {
  return t.isCompound() === e.isCompound() && t.isDirected() === e.isDirected() && t.isMultigraph() === e.isMultigraph();
}, rg = function(t, e) {
  var n = l3(t, e);
  return n.length === t.nodes().length;
}, Jb = function(t, e) {
  var n = c3(t, e);
  return n.length === t.edges().length;
}, BJ = function(t, e) {
  return h3(t, e) && t.nodeCount() === e.nodeCount() && rg(t, e) && t.edgeCount() === e.edgeCount() && Jb(t, e);
}, GJ = function(t, e) {
  return rg(t, e) && Jb(t, e);
};
function FJ(r, t) {
  return $J(r) || jJ(r, t) || UJ(r, t) || zJ();
}
function zJ() {
  throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`);
}
function UJ(r, t) {
  if (!!r) {
    if (typeof r == "string")
      return NS(r, t);
    var e = Object.prototype.toString.call(r).slice(8, -1);
    if (e === "Object" && r.constructor && (e = r.constructor.name), e === "Map" || e === "Set")
      return Array.from(r);
    if (e === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))
      return NS(r, t);
  }
}
function NS(r, t) {
  (t == null || t > r.length) && (t = r.length);
  for (var e = 0, n = new Array(t); e < t; e++)
    n[e] = r[e];
  return n;
}
function jJ(r, t) {
  var e = r == null ? null : typeof Symbol < "u" && r[Symbol.iterator] || r["@@iterator"];
  if (e != null) {
    var n = [], i = !0, a = !1, o, s;
    try {
      for (e = e.call(r); !(i = (o = e.next()).done) && (n.push(o.value), !(t && n.length === t)); i = !0)
        ;
    } catch (u) {
      a = !0, s = u;
    } finally {
      try {
        !i && e.return != null && e.return();
      } finally {
        if (a)
          throw s;
      }
    }
    return n;
  }
}
function $J(r) {
  if (Array.isArray(r))
    return r;
}
function WJ(r) {
  return r instanceof Tu;
}
function op(r) {
  if (r.isMultigraph())
    return !1;
  for (var t = r.edges(), e = /* @__PURE__ */ new Map(), n = 0; n < t.length; n++) {
    var i = t[n];
    if (i.v === i.w)
      return !1;
    var a = [i.v, i.w].sort(), o = FJ(a, 2), s = o[0], u = o[1], f = "".concat(s, "-").concat(u);
    if (e.has(f))
      return !1;
    e.set(f, !0);
  }
  return !0;
}
function VJ(r) {
  return r.nodes().length === 0;
}
function XJ(r) {
  for (var t = r.edges(), e = 0; e < t.length; e++) {
    var n = t[e];
    if (n.v === n.w)
      return !0;
  }
  return !1;
}
const YJ = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  isGraph: WJ,
  isSimpleGraph: op,
  isNullGraph: VJ,
  hasSelfLoop: XJ
}, Symbol.toStringTag, { value: "Module" }));
var HJ = function(t, e) {
  if (!op(t) || !op(e) || !rg(t, e) || f3(t, e))
    return !1;
  var n = t.nodeCount();
  return t.edgeCount() + e.edgeCount() === n * (n - 1) / 2;
};
const KJ = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  containAllSameEdges: Jb,
  containAllSameNodes: rg,
  containSameEdges: f3,
  containSameNodes: RJ,
  isGraphComplement: HJ,
  isGraphOptionSame: h3,
  getSameEdges: c3,
  getSameNodes: l3,
  isGraphSame: BJ,
  isGraphContainsAnother: GJ
}, Symbol.toStringTag, { value: "Module" }));
var qJ = function(t) {
  if (!op(t))
    return null;
  for (var e = t.nodeCount(), n = new Tu({
    compound: t.isCompound(),
    directed: t.isDirected(),
    multigraph: t.isMultigraph()
  }), i = t.nodes(), a = 0; a < e; a++) {
    var o = i[a];
    n.setNode(o, t.node(o));
    for (var s = a + 1; s < e; s++) {
      var u = i[s];
      t.hasEdge(o, u) || n.setEdge(o, u);
    }
  }
  return n;
};
const ZJ = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  getGraphComplement: qJ
}, Symbol.toStringTag, { value: "Module" })), QJ = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  Graph: Tu,
  GraphWithEvent: sJ,
  algorithm: NJ,
  comparision: KJ,
  essence: YJ,
  generate: ZJ
}, Symbol.toStringTag, { value: "Module" })), ng = /* @__PURE__ */ Ao(QJ);
var d3 = Oe && Oe.__extends || function() {
  var r = function(t, e) {
    return r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(n, i) {
      n.__proto__ = i;
    } || function(n, i) {
      for (var a in i)
        Object.prototype.hasOwnProperty.call(i, a) && (n[a] = i[a]);
    }, r(t, e);
  };
  return function(t, e) {
    if (typeof e != "function" && e !== null)
      throw new TypeError("Class extends value " + String(e) + " is not a constructor or null");
    r(t, e);
    function n() {
      this.constructor = t;
    }
    t.prototype = e === null ? Object.create(e) : (n.prototype = e.prototype, new n());
  };
}(), JJ = Oe && Oe.__importDefault || function(r) {
  return r && r.__esModule ? r : { default: r };
};
Object.defineProperty(qb, "__esModule", { value: !0 });
var eee = JJ(Zb), tee = ng, ree = function(r) {
  d3(t, r);
  function t() {
    return r !== null && r.apply(this, arguments) || this;
  }
  return t;
}(eee.default), nee = function(r) {
  d3(t, r);
  function t() {
    return r !== null && r.apply(this, arguments) || this;
  }
  return t;
}(tee.Graph), iee = function() {
  return 1;
}, aee = function(r, t) {
  var e;
  if (r.nodeCount() <= 1)
    return [];
  var n = see(r, t || iee), i = oee(n.graph, n.buckets, n.zeroIdx);
  return (e = i.map(function(a) {
    return r.outEdges(a.v, a.w);
  })) === null || e === void 0 ? void 0 : e.flat();
}, oee = function(r, t, e) {
  for (var n = [], i = t[t.length - 1], a = t[0], o; r.nodeCount(); ) {
    for (; o = a.dequeue(); )
      sy(r, t, e, o);
    for (; o = i.dequeue(); )
      sy(r, t, e, o);
    if (r.nodeCount()) {
      for (var s = t.length - 2; s > 0; --s)
        if (o = t[s].dequeue(), o) {
          n = n.concat(sy(r, t, e, o, !0));
          break;
        }
    }
  }
  return n;
}, sy = function(r, t, e, n, i) {
  var a, o, s = [];
  return (a = r.inEdges(n.v)) === null || a === void 0 || a.forEach(function(u) {
    var f = r.edge(u), l = r.node(u.v);
    i && s.push({ v: u.v, w: u.w, in: 0, out: 0 }), l.out === void 0 && (l.out = 0), l.out -= f, Zm(t, e, l);
  }), (o = r.outEdges(n.v)) === null || o === void 0 || o.forEach(function(u) {
    var f = r.edge(u), l = u.w, c = r.node(l);
    c.in === void 0 && (c.in = 0), c.in -= f, Zm(t, e, c);
  }), r.removeNode(n.v), i ? s : void 0;
}, see = function(r, t) {
  var e = new nee(), n = 0, i = 0;
  r.nodes().forEach(function(f) {
    e.setNode(f, { v: f, in: 0, out: 0 });
  }), r.edges().forEach(function(f) {
    var l = e.edge(f) || 0, c = (t == null ? void 0 : t(f)) || 1, h = l + c;
    e.setEdge(f.v, f.w, h), i = Math.max(i, e.node(f.v).out += c), n = Math.max(n, e.node(f.w).in += c);
  });
  for (var a = [], o = i + n + 3, s = 0; s < o; s++)
    a.push(new ree());
  var u = n + 1;
  return e.nodes().forEach(function(f) {
    Zm(a, u, e.node(f));
  }), { buckets: a, zeroIdx: u, graph: e };
}, Zm = function(r, t, e) {
  e.out ? e.in ? r[e.out - e.in + t].enqueue(e) : r[r.length - 1].enqueue(e) : r[0].enqueue(e);
};
qb.default = aee;
var uee = Oe && Oe.__importDefault || function(r) {
  return r && r.__esModule ? r : { default: r };
};
Object.defineProperty(Kb, "__esModule", { value: !0 });
var fee = uee(qb), lee = function(r) {
  var t = function(n) {
    return function(i) {
      var a;
      return ((a = n.edge(i)) === null || a === void 0 ? void 0 : a.weight) || 1;
    };
  }, e = r.graph().acyclicer === "greedy" ? (0, fee.default)(r, t(r)) : cee(r);
  e == null || e.forEach(function(n) {
    var i = r.edge(n);
    r.removeEdgeObj(n), i.forwardName = n.name, i.reversed = !0, r.setEdge(n.w, n.v, i, "rev-".concat(Math.random()));
  });
}, cee = function(r) {
  var t = [], e = {}, n = {}, i = function(a) {
    var o;
    n[a] || (n[a] = !0, e[a] = !0, (o = r.outEdges(a)) === null || o === void 0 || o.forEach(function(s) {
      e[s.w] ? t.push(s) : i(s.w);
    }), delete e[a]);
  };
  return r.nodes().forEach(i), t;
}, hee = function(r) {
  r.edges().forEach(function(t) {
    var e = r.edge(t);
    if (e.reversed) {
      r.removeEdgeObj(t);
      var n = e.forwardName;
      delete e.reversed, delete e.forwardName, r.setEdge(t.w, t.v, e, n);
    }
  });
};
Kb.default = { run: lee, undo: hee };
var ex = {}, Mi = {}, Po = {}, dee = Oe && Oe.__extends || function() {
  var r = function(t, e) {
    return r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(n, i) {
      n.__proto__ = i;
    } || function(n, i) {
      for (var a in i)
        Object.prototype.hasOwnProperty.call(i, a) && (n[a] = i[a]);
    }, r(t, e);
  };
  return function(t, e) {
    if (typeof e != "function" && e !== null)
      throw new TypeError("Class extends value " + String(e) + " is not a constructor or null");
    r(t, e);
    function n() {
      this.constructor = t;
    }
    t.prototype = e === null ? Object.create(e) : (n.prototype = e.prototype, new n());
  };
}();
Object.defineProperty(Po, "__esModule", { value: !0 });
Po.Graph = void 0;
var vee = ng, pee = function(r) {
  dee(t, r);
  function t() {
    return r !== null && r.apply(this, arguments) || this;
  }
  return t;
}(vee.Graph);
Po.Graph = pee;
(function(r) {
  Object.defineProperty(r, "__esModule", { value: !0 }), r.minBy = r.notime = r.time = r.partition = r.maxRank = r.addBorderNode = r.removeEmptyRanks = r.normalizeRanks = r.buildLayerMatrix = r.intersectRect = r.predecessorWeights = r.successorWeights = r.zipObject = r.asNonCompoundGraph = r.simplify = r.addDummyNode = void 0;
  var t = on(), e = Po, n = function(x, _) {
    return Number(x) - Number(_);
  }, i = function(x, _, w, E) {
    var M;
    do
      M = "".concat(E).concat(Math.random());
    while (x.hasNode(M));
    return w.dummy = _, x.setNode(M, w), M;
  };
  r.addDummyNode = i;
  var a = function(x) {
    var _ = new e.Graph().setGraph(x.graph());
    return x.nodes().forEach(function(w) {
      _.setNode(w, x.node(w));
    }), x.edges().forEach(function(w) {
      var E = _.edgeFromArgs(w.v, w.w) || { weight: 0, minlen: 1 }, M = x.edge(w);
      _.setEdge(w.v, w.w, {
        weight: E.weight + M.weight,
        minlen: Math.max(E.minlen, M.minlen)
      });
    }), _;
  };
  r.simplify = a;
  var o = function(x) {
    var _ = new e.Graph({ multigraph: x.isMultigraph() }).setGraph(x.graph());
    return x.nodes().forEach(function(w) {
      var E;
      !((E = x.children(w)) === null || E === void 0) && E.length || _.setNode(w, x.node(w));
    }), x.edges().forEach(function(w) {
      _.setEdgeObj(w, x.edge(w));
    }), _;
  };
  r.asNonCompoundGraph = o;
  var s = function(x, _) {
    return x == null ? void 0 : x.reduce(function(w, E, M) {
      return w[E] = _[M], w;
    }, {});
  };
  r.zipObject = s;
  var u = function(x) {
    var _ = {};
    return x.nodes().forEach(function(w) {
      var E, M = {};
      (E = x.outEdges(w)) === null || E === void 0 || E.forEach(function(C) {
        var S;
        M[C.w] = (M[C.w] || 0) + (((S = x.edge(C)) === null || S === void 0 ? void 0 : S.weight) || 0);
      }), _[w] = M;
    }), _;
  };
  r.successorWeights = u;
  var f = function(x) {
    var _ = x.nodes(), w = _.map(function(E) {
      var M, C = {};
      return (M = x.inEdges(E)) === null || M === void 0 || M.forEach(function(S) {
        C[S.v] = (C[S.v] || 0) + x.edge(S).weight;
      }), C;
    });
    return (0, r.zipObject)(_, w);
  };
  r.predecessorWeights = f;
  var l = function(x, _) {
    var w = Number(x.x), E = Number(x.y), M = Number(_.x) - w, C = Number(_.y) - E, S = Number(x.width) / 2, A = Number(x.height) / 2;
    if (!M && !C)
      return { x: 0, y: 0 };
    var T, P;
    return Math.abs(C) * S > Math.abs(M) * A ? (C < 0 && (A = -A), T = A * M / C, P = A) : (M < 0 && (S = -S), T = S, P = S * C / M), { x: w + T, y: E + P };
  };
  r.intersectRect = l;
  var c = function(x) {
    for (var _ = [], w = (0, r.maxRank)(x) + 1, E = 0; E < w; E++)
      _.push([]);
    x.nodes().forEach(function(M) {
      var C = x.node(M), S = C.rank;
      S !== void 0 && _[S] && _[S].push(M);
    });
    for (var E = 0; E < w; E++)
      _[E] = _[E].sort(function(C, S) {
        var A, T;
        return n((A = x.node(C)) === null || A === void 0 ? void 0 : A.order, (T = x.node(S)) === null || T === void 0 ? void 0 : T.order);
      });
    return _;
  };
  r.buildLayerMatrix = c;
  var h = function(x) {
    var _ = x.nodes().filter(function(E) {
      var M;
      return ((M = x.node(E)) === null || M === void 0 ? void 0 : M.rank) !== void 0;
    }).map(function(E) {
      return x.node(E).rank;
    }), w = Math.min.apply(Math, _);
    x.nodes().forEach(function(E) {
      var M = x.node(E);
      M.hasOwnProperty("rank") && w !== 1 / 0 && (M.rank -= w);
    });
  };
  r.normalizeRanks = h;
  var d = function(x) {
    var _ = x.nodes(), w = _.filter(function(P) {
      var k;
      return ((k = x.node(P)) === null || k === void 0 ? void 0 : k.rank) !== void 0;
    }).map(function(P) {
      return x.node(P).rank;
    }), E = Math.min.apply(Math, w), M = [];
    _.forEach(function(P) {
      var k, L = (((k = x.node(P)) === null || k === void 0 ? void 0 : k.rank) || 0) - E;
      M[L] || (M[L] = []), M[L].push(P);
    });
    for (var C = 0, S = x.graph().nodeRankFactor || 0, A = 0; A < M.length; A++) {
      var T = M[A];
      T === void 0 ? A % S !== 0 && (C -= 1) : C && (T == null || T.forEach(function(P) {
        var k = x.node(P);
        k && (k.rank = k.rank || 0, k.rank += C);
      }));
    }
  };
  r.removeEmptyRanks = d;
  var v = function(x, _, w, E) {
    var M = {
      width: 0,
      height: 0
    };
    return (0, t.isNumber)(w) && (0, t.isNumber)(E) && (M.rank = w, M.order = E), (0, r.addDummyNode)(x, "border", M, _);
  };
  r.addBorderNode = v;
  var p = function(x) {
    var _;
    return x.nodes().forEach(function(w) {
      var E, M = (E = x.node(w)) === null || E === void 0 ? void 0 : E.rank;
      M !== void 0 && (_ === void 0 || M > _) && (_ = M);
    }), _ || (_ = 0), _;
  };
  r.maxRank = p;
  var g = function(x, _) {
    var w = { lhs: [], rhs: [] };
    return x == null || x.forEach(function(E) {
      _(E) ? w.lhs.push(E) : w.rhs.push(E);
    }), w;
  };
  r.partition = g;
  var y = function(x, _) {
    var w = Date.now();
    try {
      return _();
    } finally {
      console.log("".concat(x, " time: ").concat(Date.now() - w, "ms"));
    }
  };
  r.time = y;
  var b = function(x, _) {
    return _();
  };
  r.notime = b;
  var m = function(x, _) {
    return x.reduce(function(w, E) {
      var M = _(w), C = _(E);
      return M > C ? E : w;
    });
  };
  r.minBy = m;
})(Mi);
Object.defineProperty(ex, "__esModule", { value: !0 });
var gee = Mi, yee = function(r) {
  r.graph().dummyChains = [], r.edges().forEach(function(t) {
    return mee(r, t);
  });
}, mee = function(r, t) {
  var e = t.v, n = r.node(e).rank, i = t.w, a = r.node(i).rank, o = t.name, s = r.edge(t), u = s.labelRank;
  if (a !== n + 1) {
    r.removeEdgeObj(t);
    var f = r.graph(), l, c, h;
    for (h = 0, ++n; n < a; ++h, ++n)
      s.points = [], c = {
        edgeLabel: s,
        width: 0,
        height: 0,
        edgeObj: t,
        rank: n
      }, l = (0, gee.addDummyNode)(r, "edge", c, "_d"), n === u && (c.width = s.width, c.height = s.height, c.dummy = "edge-label", c.labelpos = s.labelpos), r.setEdge(e, l, { weight: s.weight }, o), h === 0 && (f.dummyChains || (f.dummyChains = []), f.dummyChains.push(l)), e = l;
    r.setEdge(e, i, { weight: s.weight }, o);
  }
}, bee = function(r) {
  var t;
  (t = r.graph().dummyChains) === null || t === void 0 || t.forEach(function(e) {
    var n = r.node(e), i = n.edgeLabel, a;
    n.edgeObj && r.setEdgeObj(n.edgeObj, i);
    for (var o = e; n.dummy; )
      a = r.successors(o)[0], r.removeNode(o), i.points.push({ x: n.x, y: n.y }), n.dummy === "edge-label" && (i.x = n.x, i.y = n.y, i.width = n.width, i.height = n.height), o = a, n = r.node(o);
  });
};
ex.default = { run: yee, undo: bee };
var tx = {}, na = {};
Object.defineProperty(na, "__esModule", { value: !0 });
na.slack = na.longestPathWithLayer = na.longestPath = void 0;
var v3 = function(r) {
  var t, e = {}, n = function(i) {
    var a, o = r.node(i);
    if (e[i])
      return o.rank;
    e[i] = !0;
    var s;
    return (a = r.outEdges(i)) === null || a === void 0 || a.forEach(function(u) {
      var f = n(u.w), l = r.edge(u).minlen, c = f - l;
      c && (s === void 0 || c < s) && (s = c);
    }), s || (s = 0), o.rank = s, s;
  };
  (t = r.sources()) === null || t === void 0 || t.forEach(function(i) {
    return n(i);
  });
};
na.longestPath = v3;
var p3 = function(r) {
  var t, e = {}, n, i = function(o) {
    var s, u = r.node(o);
    if (e[o])
      return u.rank;
    e[o] = !0;
    var f;
    return (s = r.outEdges(o)) === null || s === void 0 || s.forEach(function(l) {
      var c = i(l.w), h = r.edge(l).minlen, d = c - h;
      d && (f === void 0 || d < f) && (f = d);
    }), f || (f = 0), (n === void 0 || f < n) && (n = f), u.rank = f, f;
  };
  (t = r.sources()) === null || t === void 0 || t.forEach(function(o) {
    return i(o);
  }), n === void 0 && (n = 0);
  var a = function(o, s) {
    var u, f = r.node(o), l = isNaN(f.layer) ? s : f.layer;
    (f.rank === void 0 || f.rank < l) && (f.rank = l), (u = r.outEdges(o)) === null || u === void 0 || u.map(function(c) {
      a(c.w, l + r.edge(c).minlen);
    });
  };
  r.nodes().forEach(function(o) {
    var s = r.node(o);
    isNaN(s.layer) ? s.rank -= n : a(o, s.layer);
  });
};
na.longestPathWithLayer = p3;
var g3 = function(r, t) {
  return r.node(t.w).rank - r.node(t.v).rank - r.edge(t).minlen;
};
na.slack = g3;
na.default = {
  longestPath: v3,
  longestPathWithLayer: p3,
  slack: g3
};
var gs = {};
Object.defineProperty(gs, "__esModule", { value: !0 });
gs.feasibleTreeWithLayer = gs.feasibleTree = void 0;
var bu = na, xee = Mi, y3 = Po, m3 = function(r) {
  var t = new y3.Graph({ directed: !1 }), e = r.nodes()[0], n = r.nodeCount();
  t.setNode(e, {});
  for (var i, a; _ee(t, r) < n; )
    i = x3(t, r), a = t.hasNode(i.v) ? (0, bu.slack)(r, i) : -(0, bu.slack)(r, i), _3(t, r, a);
  return t;
};
gs.feasibleTree = m3;
var _ee = function(r, t) {
  var e = function(n) {
    t.nodeEdges(n).forEach(function(i) {
      var a = i.v, o = n === a ? i.w : a;
      !r.hasNode(o) && !(0, bu.slack)(t, i) && (r.setNode(o, {}), r.setEdge(n, o, {}), e(o));
    });
  };
  return r.nodes().forEach(e), r.nodeCount();
}, b3 = function(r) {
  var t = new y3.Graph({ directed: !1 }), e = r.nodes()[0], n = r.nodeCount();
  t.setNode(e, {});
  for (var i, a; wee(t, r) < n; )
    i = x3(t, r), a = t.hasNode(i.v) ? (0, bu.slack)(r, i) : -(0, bu.slack)(r, i), _3(t, r, a);
  return t;
};
gs.feasibleTreeWithLayer = b3;
var wee = function(r, t) {
  var e = function(n) {
    var i;
    (i = t.nodeEdges(n)) === null || i === void 0 || i.forEach(function(a) {
      var o = a.v, s = n === o ? a.w : o;
      !r.hasNode(s) && (t.node(s).layer !== void 0 || !(0, bu.slack)(t, a)) && (r.setNode(s, {}), r.setEdge(n, s, {}), e(s));
    });
  };
  return r.nodes().forEach(e), r.nodeCount();
}, x3 = function(r, t) {
  return (0, xee.minBy)(t.edges(), function(e) {
    return r.hasNode(e.v) !== r.hasNode(e.w) ? (0, bu.slack)(t, e) : 1 / 0;
  });
}, _3 = function(r, t, e) {
  r.nodes().forEach(function(n) {
    t.node(n).rank || (t.node(n).rank = 0), t.node(n).rank += e;
  });
};
gs.default = {
  feasibleTree: m3,
  feasibleTreeWithLayer: b3
};
var w3 = {};
(function(r) {
  Object.defineProperty(r, "__esModule", { value: !0 }), r.exchangeEdges = r.enterEdge = r.leaveEdge = r.initLowLimValues = r.calcCutValue = r.initCutValues = void 0;
  var t = gs, e = na, n = Mi, i = ng, a = i.algorithm.preorder, o = i.algorithm.postorder, s = function(m) {
    var x = (0, n.simplify)(m);
    (0, e.longestPath)(x);
    var _ = (0, t.feasibleTree)(x);
    (0, r.initLowLimValues)(_), (0, r.initCutValues)(_, x);
    for (var w, E; w = (0, r.leaveEdge)(_); )
      E = (0, r.enterEdge)(_, x, w), (0, r.exchangeEdges)(_, x, w, E);
  }, u = function(m, x) {
    var _ = o(m, m.nodes());
    _ = _ == null ? void 0 : _.slice(0, (_ == null ? void 0 : _.length) - 1), _ == null || _.forEach(function(w) {
      f(m, x, w);
    });
  };
  r.initCutValues = u;
  var f = function(m, x, _) {
    var w = m.node(_), E = w.parent;
    m.edgeFromArgs(_, E).cutvalue = (0, r.calcCutValue)(m, x, _);
  }, l = function(m, x, _) {
    var w, E = m.node(_), M = E.parent, C = !0, S = x.edgeFromArgs(_, M), A = 0;
    return S || (C = !1, S = x.edgeFromArgs(M, _)), A = S.weight, (w = x.nodeEdges(_)) === null || w === void 0 || w.forEach(function(T) {
      var P = T.v === _, k = P ? T.w : T.v;
      if (k !== M) {
        var L = P === C, O = x.edge(T).weight;
        if (A += L ? O : -O, y(m, _, k)) {
          var D = m.edgeFromArgs(_, k).cutvalue;
          A += L ? -D : D;
        }
      }
    }), A;
  };
  r.calcCutValue = l;
  var c = function(m, x) {
    x === void 0 && (x = m.nodes()[0]), h(m, {}, 1, x);
  };
  r.initLowLimValues = c;
  var h = function(m, x, _, w, E) {
    var M, C = _, S = _, A = m.node(w);
    return x[w] = !0, (M = m.neighbors(w)) === null || M === void 0 || M.forEach(function(T) {
      x[T] || (S = h(m, x, S, T, w));
    }), A.low = C, A.lim = S++, E ? A.parent = E : delete A.parent, S;
  }, d = function(m) {
    return m.edges().find(function(x) {
      return m.edge(x).cutvalue < 0;
    });
  };
  r.leaveEdge = d;
  var v = function(m, x, _) {
    var w = _.v, E = _.w;
    x.hasEdge(w, E) || (w = _.w, E = _.v);
    var M = m.node(w), C = m.node(E), S = M, A = !1;
    M.lim > C.lim && (S = C, A = !0);
    var T = x.edges().filter(function(P) {
      return A === b(m, m.node(P.v), S) && A !== b(m, m.node(P.w), S);
    });
    return (0, n.minBy)(T, function(P) {
      return (0, e.slack)(x, P);
    });
  };
  r.enterEdge = v;
  var p = function(m, x, _, w) {
    var E = _.v, M = _.w;
    m.removeEdge(E, M), m.setEdge(w.v, w.w, {}), (0, r.initLowLimValues)(m), (0, r.initCutValues)(m, x), g(m, x);
  };
  r.exchangeEdges = p;
  var g = function(m, x) {
    var _ = m.nodes().find(function(E) {
      var M;
      return !(!((M = x.node(E)) === null || M === void 0) && M.parent);
    }), w = a(m, _);
    w = w == null ? void 0 : w.slice(1), w == null || w.forEach(function(E) {
      var M = m.node(E).parent, C = x.edgeFromArgs(E, M), S = !1;
      C || (C = x.edgeFromArgs(M, E), S = !0), x.node(E).rank = x.node(M).rank + (S ? C.minlen : -C.minlen);
    });
  }, y = function(m, x, _) {
    return m.hasEdge(x, _);
  }, b = function(m, x, _) {
    return _.low <= x.lim && x.lim <= _.lim;
  };
  r.default = s;
})(w3);
var Eee = Oe && Oe.__importDefault || function(r) {
  return r && r.__esModule ? r : { default: r };
};
Object.defineProperty(tx, "__esModule", { value: !0 });
var E3 = na, See = gs, Mee = Eee(w3), Cee = function(r) {
  switch (r.graph().ranker) {
    case "network-simplex":
      Aee(r);
      break;
    case "tight-tree":
      RS(r);
      break;
    case "longest-path":
      Tee(r);
      break;
    default:
      RS(r);
  }
}, Tee = E3.longestPath, RS = function(r) {
  (0, E3.longestPathWithLayer)(r), (0, See.feasibleTreeWithLayer)(r);
}, Aee = function(r) {
  (0, Mee.default)(r);
};
tx.default = Cee;
var rx = {};
Object.defineProperty(rx, "__esModule", { value: !0 });
var Iee = function(r) {
  var t, e = {}, n = 0, i = function(a) {
    var o, s = n;
    (o = r.children(a)) === null || o === void 0 || o.forEach(i), e[a] = { low: s, lim: n++ };
  };
  return (t = r.children()) === null || t === void 0 || t.forEach(i), e;
}, Pee = function(r, t, e, n) {
  var i = [], a = [], o = Math.min(t[e].low, t[n].low), s = Math.max(t[e].lim, t[n].lim), u, f;
  u = e;
  do
    u = r.parent(u), i.push(u);
  while (u && (t[u].low > o || s > t[u].lim));
  for (f = u, u = n; u && u !== f; )
    a.push(u), u = r.parent(u);
  return { lca: f, path: i.concat(a.reverse()) };
}, Oee = function(r) {
  var t, e = Iee(r);
  (t = r.graph().dummyChains) === null || t === void 0 || t.forEach(function(n) {
    var i, a, o = n, s = r.node(o), u = s.edgeObj;
    if (!!u)
      for (var f = Pee(r, e, u.v, u.w), l = f.path, c = f.lca, h = 0, d = l[h], v = !0; o !== u.w; ) {
        if (s = r.node(o), v) {
          for (; d !== c && ((i = r.node(d)) === null || i === void 0 ? void 0 : i.maxRank) < s.rank; )
            h++, d = l[h];
          d === c && (v = !1);
        }
        if (!v) {
          for (; h < l.length - 1 && ((a = r.node(l[h + 1])) === null || a === void 0 ? void 0 : a.minRank) <= s.rank; )
            h++;
          d = l[h];
        }
        r.setParent(o, d), o = r.successors(o)[0];
      }
  });
};
rx.default = Oee;
var nx = {};
Object.defineProperty(nx, "__esModule", { value: !0 });
var Qm = Mi, Dee = function(r) {
  var t, e = (0, Qm.addDummyNode)(r, "root", {}, "_root"), n = kee(r), i = Math.max.apply(Math, Object.values(n));
  Math.abs(i) === 1 / 0 && (i = 1);
  var a = i - 1, o = 2 * a + 1;
  r.graph().nestingRoot = e, r.edges().forEach(function(u) {
    r.edge(u).minlen *= o;
  });
  var s = Lee(r) + 1;
  (t = r.children()) === null || t === void 0 || t.forEach(function(u) {
    S3(r, e, o, s, a, n, u);
  }), r.graph().nodeRankFactor = o;
}, S3 = function(r, t, e, n, i, a, o) {
  var s = r.children(o);
  if (!(s != null && s.length)) {
    o !== t && r.setEdge(t, o, { weight: 0, minlen: e });
    return;
  }
  var u = (0, Qm.addBorderNode)(r, "_bt"), f = (0, Qm.addBorderNode)(r, "_bb"), l = r.node(o);
  r.setParent(u, o), l.borderTop = u, r.setParent(f, o), l.borderBottom = f, s == null || s.forEach(function(c) {
    S3(r, t, e, n, i, a, c);
    var h = r.node(c), d = h.borderTop ? h.borderTop : c, v = h.borderBottom ? h.borderBottom : c, p = h.borderTop ? n : 2 * n, g = d !== v ? 1 : i - a[o] + 1;
    r.setEdge(u, d, {
      minlen: g,
      weight: p,
      nestingEdge: !0
    }), r.setEdge(v, f, {
      minlen: g,
      weight: p,
      nestingEdge: !0
    });
  }), r.parent(o) || r.setEdge(t, u, { weight: 0, minlen: i + a[o] });
}, kee = function(r) {
  var t, e = {}, n = function(i, a) {
    var o = r.children(i);
    o == null || o.forEach(function(s) {
      return n(s, a + 1);
    }), e[i] = a;
  };
  return (t = r.children()) === null || t === void 0 || t.forEach(function(i) {
    return n(i, 1);
  }), e;
}, Lee = function(r) {
  var t = 0;
  return r.edges().forEach(function(e) {
    t += r.edge(e).weight;
  }), t;
}, Nee = function(r) {
  var t = r.graph();
  t.nestingRoot && r.removeNode(t.nestingRoot), delete t.nestingRoot, r.edges().forEach(function(e) {
    var n = r.edge(e);
    n.nestingEdge && r.removeEdgeObj(e);
  });
};
nx.default = { run: Dee, cleanup: Nee };
var ix = {};
Object.defineProperty(ix, "__esModule", { value: !0 });
var Ree = Mi, Bee = function(r) {
  var t, e = function(n) {
    var i = r.children(n), a = r.node(n);
    if (i != null && i.length && i.forEach(function(u) {
      return e(u);
    }), a.hasOwnProperty("minRank")) {
      a.borderLeft = [], a.borderRight = [];
      for (var o = a.minRank, s = a.maxRank + 1; o < s; o += 1)
        BS(r, "borderLeft", "_bl", n, a, o), BS(r, "borderRight", "_br", n, a, o);
    }
  };
  (t = r.children()) === null || t === void 0 || t.forEach(function(n) {
    return e(n);
  });
}, BS = function(r, t, e, n, i, a) {
  var o = { rank: a, borderType: t, width: 0, height: 0 }, s = i[t][a - 1], u = (0, Ree.addDummyNode)(r, "border", o, e);
  i[t][a] = u, r.setParent(u, n), s && r.setEdge(s, u, { weight: 1 });
};
ix.default = Bee;
var ax = {};
Object.defineProperty(ax, "__esModule", { value: !0 });
var Gee = function(r) {
  var t, e = (t = r.graph().rankdir) === null || t === void 0 ? void 0 : t.toLowerCase();
  (e === "lr" || e === "rl") && M3(r);
}, Fee = function(r) {
  var t, e = (t = r.graph().rankdir) === null || t === void 0 ? void 0 : t.toLowerCase();
  (e === "bt" || e === "rl") && zee(r), (e === "lr" || e === "rl") && (Uee(r), M3(r));
}, M3 = function(r) {
  r.nodes().forEach(function(t) {
    GS(r.node(t));
  }), r.edges().forEach(function(t) {
    GS(r.edge(t));
  });
}, GS = function(r) {
  var t = r.width;
  r.width = r.height, r.height = t;
}, zee = function(r) {
  r.nodes().forEach(function(t) {
    uy(r.node(t));
  }), r.edges().forEach(function(t) {
    var e, n = r.edge(t);
    (e = n.points) === null || e === void 0 || e.forEach(function(i) {
      return uy(i);
    }), n.hasOwnProperty("y") && uy(n);
  });
}, uy = function(r) {
  r != null && r.y && (r.y = -r.y);
}, Uee = function(r) {
  r.nodes().forEach(function(t) {
    fy(r.node(t));
  }), r.edges().forEach(function(t) {
    var e, n = r.edge(t);
    (e = n.points) === null || e === void 0 || e.forEach(function(i) {
      return fy(i);
    }), n.hasOwnProperty("x") && fy(n);
  });
}, fy = function(r) {
  var t = r.x;
  r.x = r.y, r.y = t;
};
ax.default = { adjust: Gee, undo: Fee };
var ox = {}, sx = {};
Object.defineProperty(sx, "__esModule", { value: !0 });
var jee = function(r) {
  for (var t = {}, e = r.nodes().filter(function(c) {
    var h;
    return !(!((h = r.children(c)) === null || h === void 0) && h.length);
  }), n = e.map(function(c) {
    return r.node(c).rank;
  }), i = Math.max.apply(Math, n), a = [], o = 0; o < i + 1; o++)
    a.push([]);
  var s = function(c) {
    var h;
    if (!t.hasOwnProperty(c)) {
      t[c] = !0;
      var d = r.node(c);
      isNaN(d.rank) || a[d.rank].push(c), (h = r.successors(c)) === null || h === void 0 || h.forEach(function(v) {
        return s(v);
      });
    }
  }, u = e.sort(function(c, h) {
    return r.node(c).rank - r.node(h).rank;
  }), f = u.filter(function(c) {
    return r.node(c).fixorder !== void 0;
  }), l = f.sort(function(c, h) {
    return r.node(c).fixorder - r.node(h).fixorder;
  });
  return l == null || l.forEach(function(c) {
    isNaN(r.node(c).rank) || a[r.node(c).rank].push(c), t[c] = !0;
  }), u == null || u.forEach(s), a;
};
sx.default = jee;
var ux = {};
Object.defineProperty(ux, "__esModule", { value: !0 });
var $ee = Mi, Wee = function(r, t, e) {
  for (var n = (0, $ee.zipObject)(e, e.map(function(l, c) {
    return c;
  })), i = t.map(function(l) {
    var c, h = (c = r.outEdges(l)) === null || c === void 0 ? void 0 : c.map(function(d) {
      return { pos: n[d.w] || 0, weight: r.edge(d).weight };
    });
    return h == null ? void 0 : h.sort(function(d, v) {
      return d.pos - v.pos;
    });
  }), a = i.flat().filter(function(l) {
    return l !== void 0;
  }), o = 1; o < e.length; )
    o <<= 1;
  var s = 2 * o - 1;
  o -= 1;
  var u = Array(s).fill(0, 0, s), f = 0;
  return a == null || a.forEach(function(l) {
    if (l) {
      var c = l.pos + o;
      u[c] += l.weight;
      for (var h = 0; c > 0; )
        c % 2 && (h += u[c + 1]), c = c - 1 >> 1, u[c] += l.weight;
      f += l.weight * h;
    }
  }), f;
}, Vee = function(r, t) {
  for (var e = 0, n = 1; n < (t == null ? void 0 : t.length); n += 1)
    e += Wee(r, t[n - 1], t[n]);
  return e;
};
ux.default = Vee;
var fx = {};
Object.defineProperty(fx, "__esModule", { value: !0 });
var Xee = Po, Yee = function(r, t, e) {
  var n = Hee(r), i = new Xee.Graph({ compound: !0 }).setGraph({ root: n }).setDefaultNodeLabel(function(a) {
    return r.node(a);
  });
  return r.nodes().forEach(function(a) {
    var o, s = r.node(a), u = r.parent(a);
    (s.rank === t || s.minRank <= t && t <= s.maxRank) && (i.setNode(a), i.setParent(a, u || n), (o = r[e](a)) === null || o === void 0 || o.forEach(function(f) {
      var l = f.v === a ? f.w : f.v, c = i.edgeFromArgs(l, a), h = c !== void 0 ? c.weight : 0;
      i.setEdge(l, a, { weight: r.edge(f).weight + h });
    }), s.hasOwnProperty("minRank") && i.setNode(a, {
      borderLeft: s.borderLeft[t],
      borderRight: s.borderRight[t]
    }));
  }), i;
}, Hee = function(r) {
  for (var t; r.hasNode(t = "_root".concat(Math.random())); )
    ;
  return t;
};
fx.default = Yee;
var lx = {};
Object.defineProperty(lx, "__esModule", { value: !0 });
var Kee = function(r, t, e) {
  var n = {}, i;
  e == null || e.forEach(function(a) {
    for (var o = r.parent(a), s, u; o; ) {
      if (s = r.parent(o), s ? (u = n[s], n[s] = o) : (u = i, i = o), u && u !== o) {
        t.setEdge(u, o);
        return;
      }
      o = s;
    }
  });
};
lx.default = Kee;
var cx = {}, hx = {};
Object.defineProperty(hx, "__esModule", { value: !0 });
var qee = function(r, t) {
  return t.map(function(e) {
    var n = r.inEdges(e);
    if (!(n != null && n.length))
      return { v: e };
    {
      var i = { sum: 0, weight: 0 };
      return n == null || n.forEach(function(a) {
        var o = r.edge(a), s = r.node(a.v);
        i.sum += o.weight * s.order, i.weight += o.weight;
      }), {
        v: e,
        barycenter: i.sum / i.weight,
        weight: i.weight
      };
    }
  });
};
hx.default = qee;
var dx = {};
Object.defineProperty(dx, "__esModule", { value: !0 });
var Zee = function(r, t) {
  var e, n, i, a = {};
  r == null || r.forEach(function(s, u) {
    a[s.v] = {
      i: u,
      indegree: 0,
      in: [],
      out: [],
      vs: [s.v]
    };
    var f = a[s.v];
    s.barycenter !== void 0 && (f.barycenter = s.barycenter, f.weight = s.weight);
  }), (e = t.edges()) === null || e === void 0 || e.forEach(function(s) {
    var u = a[s.v], f = a[s.w];
    u !== void 0 && f !== void 0 && (f.indegree++, u.out.push(a[s.w]));
  });
  var o = (i = (n = Object.values(a)).filter) === null || i === void 0 ? void 0 : i.call(n, function(s) {
    return !s.indegree;
  });
  return Qee(o);
}, Qee = function(r) {
  for (var t, e, n = [], i = function(f) {
    return function(l) {
      l.merged || (l.barycenter === void 0 || f.barycenter === void 0 || l.barycenter >= f.barycenter) && Jee(f, l);
    };
  }, a = function(f) {
    return function(l) {
      l.in.push(f), --l.indegree === 0 && r.push(l);
    };
  }, o = function() {
    var f = r.pop();
    n.push(f), (t = f.in.reverse()) === null || t === void 0 || t.forEach(function(l) {
      return i(f)(l);
    }), (e = f.out) === null || e === void 0 || e.forEach(function(l) {
      return a(f)(l);
    });
  }; r != null && r.length; )
    o();
  var s = n.filter(function(f) {
    return !f.merged;
  }), u = [
    "vs",
    "i",
    "barycenter",
    "weight"
  ];
  return s.map(function(f) {
    var l = {};
    return u == null || u.forEach(function(c) {
      f[c] !== void 0 && (l[c] = f[c]);
    }), l;
  });
}, Jee = function(r, t) {
  var e, n = 0, i = 0;
  r.weight && (n += r.barycenter * r.weight, i += r.weight), t.weight && (n += t.barycenter * t.weight, i += t.weight), r.vs = (e = t.vs) === null || e === void 0 ? void 0 : e.concat(r.vs), r.barycenter = n / i, r.weight = i, r.i = Math.min(t.i, r.i), t.merged = !0;
};
dx.default = Zee;
var vx = {};
Object.defineProperty(vx, "__esModule", { value: !0 });
var ete = Mi, tte = function(r, t, e) {
  var n = (0, ete.partition)(r, function(c) {
    return c.hasOwnProperty("fixorder") && !isNaN(c.fixorder) || c.hasOwnProperty("barycenter");
  }), i = n.lhs, a = n.rhs.sort(function(c, h) {
    return -c.i - -h.i;
  }), o = [], s = 0, u = 0, f = 0;
  i == null || i.sort(rte(!!t, !!e)), f = FS(o, a, f), i == null || i.forEach(function(c) {
    var h;
    f += (h = c.vs) === null || h === void 0 ? void 0 : h.length, o.push(c.vs), s += c.barycenter * c.weight, u += c.weight, f = FS(o, a, f);
  });
  var l = { vs: o.flat() };
  return u && (l.barycenter = s / u, l.weight = u), l;
}, FS = function(r, t, e) {
  for (var n = e, i; t.length && (i = t[t.length - 1]).i <= n; )
    t.pop(), r == null || r.push(i.vs), n++;
  return n;
}, rte = function(r, t) {
  return function(e, n) {
    if (e.fixorder !== void 0 && n.fixorder !== void 0)
      return e.fixorder - n.fixorder;
    if (e.barycenter < n.barycenter)
      return -1;
    if (e.barycenter > n.barycenter)
      return 1;
    if (t && e.order !== void 0 && n.order !== void 0) {
      if (e.order < n.order)
        return -1;
      if (e.order > n.order)
        return 1;
    }
    return r ? n.i - e.i : e.i - n.i;
  };
};
vx.default = tte;
var px = Oe && Oe.__importDefault || function(r) {
  return r && r.__esModule ? r : { default: r };
};
Object.defineProperty(cx, "__esModule", { value: !0 });
var nte = px(hx), ite = px(dx), ate = px(vx), C3 = function(r, t, e, n, i) {
  var a, o, s, u, f = r.children(t), l = r.node(t), c = l ? l.borderLeft : void 0, h = l ? l.borderRight : void 0, d = {};
  c && (f = f == null ? void 0 : f.filter(function(m) {
    return m !== c && m !== h;
  }));
  var v = (0, nte.default)(r, f || []);
  v == null || v.forEach(function(m) {
    var x;
    if (!((x = r.children(m.v)) === null || x === void 0) && x.length) {
      var _ = C3(r, m.v, e, n);
      d[m.v] = _, _.hasOwnProperty("barycenter") && ste(m, _);
    }
  });
  var p = (0, ite.default)(v, e);
  ote(p, d), (a = p.filter(function(m) {
    return m.vs.length > 0;
  })) === null || a === void 0 || a.forEach(function(m) {
    var x = r.node(m.vs[0]);
    x && (m.fixorder = x.fixorder, m.order = x.order);
  });
  var g = (0, ate.default)(p, n, i);
  if (c && (g.vs = [c, g.vs, h].flat(), !((o = r.predecessors(c)) === null || o === void 0) && o.length)) {
    var y = r.node(((s = r.predecessors(c)) === null || s === void 0 ? void 0 : s[0]) || ""), b = r.node(((u = r.predecessors(h)) === null || u === void 0 ? void 0 : u[0]) || "");
    g.hasOwnProperty("barycenter") || (g.barycenter = 0, g.weight = 0), g.barycenter = (g.barycenter * g.weight + y.order + b.order) / (g.weight + 2), g.weight += 2;
  }
  return g;
}, ote = function(r, t) {
  r == null || r.forEach(function(e) {
    var n, i = (n = e.vs) === null || n === void 0 ? void 0 : n.map(function(a) {
      return t[a] ? t[a].vs : a;
    });
    e.vs = i.flat();
  });
}, ste = function(r, t) {
  r.barycenter !== void 0 ? (r.barycenter = (r.barycenter * r.weight + t.barycenter * t.weight) / (r.weight + t.weight), r.weight += t.weight) : (r.barycenter = t.barycenter, r.weight = t.weight);
};
cx.default = C3;
var hh = Oe && Oe.__importDefault || function(r) {
  return r && r.__esModule ? r : { default: r };
};
Object.defineProperty(ox, "__esModule", { value: !0 });
var zS = hh(sx), US = hh(ux), ute = hh(fx), fte = hh(lx), lte = hh(cx), jS = on(), cte = Po, ly = Mi, hte = function(r) {
  for (var t = (0, ly.maxRank)(r), e = [], n = [], i = 1; i < t + 1; i++)
    e.push(i);
  for (var i = t - 1; i > -1; i--)
    n.push(i);
  var a = $S(r, e, "inEdges"), o = $S(r, n, "outEdges"), s = (0, zS.default)(r);
  cy(r, s);
  for (var u = Number.POSITIVE_INFINITY, f, i = 0, l = 0; l < 4; ++i, ++l) {
    WS(i % 2 ? a : o, i % 4 >= 2), s = (0, ly.buildLayerMatrix)(r);
    var c = (0, US.default)(r, s);
    c < u && (l = 0, f = (0, jS.clone)(s), u = c);
  }
  s = (0, zS.default)(r), cy(r, s);
  for (var i = 0, l = 0; l < 4; ++i, ++l) {
    WS(i % 2 ? a : o, i % 4 >= 2, !0), s = (0, ly.buildLayerMatrix)(r);
    var c = (0, US.default)(r, s);
    c < u && (l = 0, f = (0, jS.clone)(s), u = c);
  }
  cy(r, f);
}, $S = function(r, t, e) {
  return t.map(function(n) {
    return (0, ute.default)(r, n, e);
  });
}, WS = function(r, t, e) {
  var n = new cte.Graph();
  r == null || r.forEach(function(i) {
    for (var a, o = i.graph().root, s = (0, lte.default)(i, o, n, t, e), u = 0; u < ((a = s.vs) === null || a === void 0 ? void 0 : a.length); u++) {
      var f = i.node(s.vs[u]);
      f && (f.order = u);
    }
    (0, fte.default)(i, n, s.vs);
  });
}, cy = function(r, t) {
  t == null || t.forEach(function(e) {
    e == null || e.forEach(function(n, i) {
      r.node(n).order = i;
    });
  });
};
ox.default = hte;
var gx = {}, T3 = {};
(function(r) {
  var t = Oe && Oe.__extends || function() {
    var m = function(x, _) {
      return m = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(w, E) {
        w.__proto__ = E;
      } || function(w, E) {
        for (var M in E)
          Object.prototype.hasOwnProperty.call(E, M) && (w[M] = E[M]);
      }, m(x, _);
    };
    return function(x, _) {
      if (typeof _ != "function" && _ !== null)
        throw new TypeError("Class extends value " + String(_) + " is not a constructor or null");
      m(x, _);
      function w() {
        this.constructor = x;
      }
      x.prototype = _ === null ? Object.create(_) : (w.prototype = _.prototype, new w());
    };
  }();
  Object.defineProperty(r, "__esModule", { value: !0 }), r.width = r.sep = r.positionX = r.balance = r.alignCoordinates = r.findSmallestWidthAlignment = r.buildBlockGraph = r.horizontalCompaction = r.verticalAlignment = r.hasConflict = r.addConflict = r.findOtherInnerSegmentNode = r.findType2Conflicts = r.findType1Conflicts = void 0;
  var e = ng, n = Mi, i = function(m) {
    t(x, m);
    function x() {
      return m !== null && m.apply(this, arguments) || this;
    }
    return x;
  }(e.Graph), a = function(m, x) {
    var _ = {}, w = function(E, M) {
      var C = 0, S = 0, A = E.length, T = M == null ? void 0 : M[(M == null ? void 0 : M.length) - 1];
      return M == null || M.forEach(function(P, k) {
        var L, O = (0, r.findOtherInnerSegmentNode)(m, P), D = O ? m.node(O).order : A;
        (O || P === T) && ((L = M.slice(S, k + 1)) === null || L === void 0 || L.forEach(function(G) {
          var R;
          (R = m.predecessors(G)) === null || R === void 0 || R.forEach(function(F) {
            var q, ne = m.node(F), oe = ne.order;
            (oe < C || D < oe) && !(ne.dummy && ((q = m.node(G)) === null || q === void 0 ? void 0 : q.dummy)) && (0, r.addConflict)(_, F, G);
          });
        }), S = k + 1, C = D);
      }), M;
    };
    return x != null && x.length && x.reduce(w), _;
  };
  r.findType1Conflicts = a;
  var o = function(m, x) {
    var _ = {}, w = function(M, C, S, A, T) {
      for (var P, k = [], L = C; L < S; L++)
        k.push(L);
      k.forEach(function(O) {
        var D, G;
        P = M[O], !((D = m.node(P)) === null || D === void 0) && D.dummy && ((G = m.predecessors(P)) === null || G === void 0 || G.forEach(function(R) {
          var F = m.node(R);
          F.dummy && (F.order < A || F.order > T) && (0, r.addConflict)(_, R, P);
        }));
      });
    }, E = function(M, C) {
      var S = -1, A, T = 0;
      return C == null || C.forEach(function(P, k) {
        var L;
        if (((L = m.node(P)) === null || L === void 0 ? void 0 : L.dummy) === "border") {
          var O = m.predecessors(P) || [];
          O.length && (A = m.node(O[0]).order, w(C, T, k, S, A), T = k, S = A);
        }
        w(C, T, C.length, A, M.length);
      }), C;
    };
    return x != null && x.length && x.reduce(E), _;
  };
  r.findType2Conflicts = o;
  var s = function(m, x) {
    var _, w;
    if (!((_ = m.node(x)) === null || _ === void 0) && _.dummy)
      return (w = m.predecessors(x)) === null || w === void 0 ? void 0 : w.find(function(E) {
        return m.node(E).dummy;
      });
  };
  r.findOtherInnerSegmentNode = s;
  var u = function(m, x, _) {
    var w = x, E = _;
    if (w > E) {
      var M = w;
      w = E, E = M;
    }
    var C = m[w];
    C || (m[w] = C = {}), C[E] = !0;
  };
  r.addConflict = u;
  var f = function(m, x, _) {
    var w = x, E = _;
    if (w > E) {
      var M = x;
      w = E, E = M;
    }
    return !!m[w];
  };
  r.hasConflict = f;
  var l = function(m, x, _, w) {
    var E = {}, M = {}, C = {};
    return x == null || x.forEach(function(S) {
      S == null || S.forEach(function(A, T) {
        E[A] = A, M[A] = A, C[A] = T;
      });
    }), x == null || x.forEach(function(S) {
      var A = -1;
      S == null || S.forEach(function(T) {
        var P = w(T);
        if (P.length) {
          P = P.sort(function(G, R) {
            return C[G] - C[R];
          });
          for (var k = (P.length - 1) / 2, L = Math.floor(k), O = Math.ceil(k); L <= O; ++L) {
            var D = P[L];
            M[T] === T && A < C[D] && !(0, r.hasConflict)(_, T, D) && (M[D] = T, M[T] = E[T] = E[D], A = C[D]);
          }
        }
      });
    }), { root: E, align: M };
  };
  r.verticalAlignment = l;
  var c = function(m, x, _, w, E) {
    var M, C = {}, S = (0, r.buildBlockGraph)(m, x, _, E), A = E ? "borderLeft" : "borderRight", T = function(L, O) {
      for (var D = S.nodes(), G = D.pop(), R = {}; G; )
        R[G] ? L(G) : (R[G] = !0, D.push(G), D = D.concat(O(G))), G = D.pop();
    }, P = function(L) {
      C[L] = (S.inEdges(L) || []).reduce(function(O, D) {
        return Math.max(O, (C[D.v] || 0) + S.edge(D));
      }, 0);
    }, k = function(L) {
      var O = (S.outEdges(L) || []).reduce(function(G, R) {
        return Math.min(G, (C[R.w] || 0) - S.edge(R));
      }, Number.POSITIVE_INFINITY), D = m.node(L);
      O !== Number.POSITIVE_INFINITY && D.borderType !== A && (C[L] = Math.max(C[L], O));
    };
    return T(P, S.predecessors.bind(S)), T(k, S.successors.bind(S)), (M = Object.values(w)) === null || M === void 0 || M.forEach(function(L) {
      C[L] = C[_[L]];
    }), C;
  };
  r.horizontalCompaction = c;
  var h = function(m, x, _, w) {
    var E = new i(), M = m.graph(), C = (0, r.sep)(M.nodesep, M.edgesep, w);
    return x == null || x.forEach(function(S) {
      var A;
      S == null || S.forEach(function(T) {
        var P = _[T];
        if (E.setNode(P), A) {
          var k = _[A], L = E.edgeFromArgs(k, P);
          E.setEdge(k, P, Math.max(C(m, T, A), L || 0));
        }
        A = T;
      });
    }), E;
  };
  r.buildBlockGraph = h;
  var d = function(m, x) {
    return (0, n.minBy)(Object.values(x), function(_) {
      var w, E = Number.NEGATIVE_INFINITY, M = Number.POSITIVE_INFINITY;
      return (w = Object.keys(_)) === null || w === void 0 || w.forEach(function(C) {
        var S = _[C], A = (0, r.width)(m, C) / 2;
        E = Math.max(S + A, E), M = Math.min(S - A, M);
      }), E - M;
    });
  };
  r.findSmallestWidthAlignment = d;
  function v(m, x) {
    var _ = Object.values(x), w = Math.min.apply(Math, _), E = Math.max.apply(Math, _);
    ["u", "d"].forEach(function(M) {
      ["l", "r"].forEach(function(C) {
        var S = M + C, A = m[S], T;
        if (A !== x) {
          var P = Object.values(A);
          T = C === "l" ? w - Math.min.apply(Math, P) : E - Math.max.apply(Math, P), T && (m[S] = {}, Object.keys(A).forEach(function(k) {
            m[S][k] = A[k] + T;
          }));
        }
      });
    });
  }
  r.alignCoordinates = v;
  var p = function(m, x) {
    var _ = {};
    return Object.keys(m.ul).forEach(function(w) {
      if (x)
        _[w] = m[x.toLowerCase()][w];
      else {
        var E = Object.values(m).map(function(M) {
          return M[w];
        });
        _[w] = (E[0] + E[1]) / 2;
      }
    }), _;
  };
  r.balance = p;
  var g = function(m) {
    var x = (0, n.buildLayerMatrix)(m), _ = Object.assign((0, r.findType1Conflicts)(m, x), (0, r.findType2Conflicts)(m, x)), w = {}, E;
    ["u", "d"].forEach(function(C) {
      E = C === "u" ? x : Object.values(x).reverse(), ["l", "r"].forEach(function(S) {
        S === "r" && (E = E.map(function(k) {
          return Object.values(k).reverse();
        }));
        var A = (C === "u" ? m.predecessors : m.successors).bind(m), T = (0, r.verticalAlignment)(m, E, _, A), P = (0, r.horizontalCompaction)(m, E, T.root, T.align, S === "r");
        S === "r" && Object.keys(P).forEach(function(k) {
          P[k] = -P[k];
        }), w[C + S] = P;
      });
    });
    var M = (0, r.findSmallestWidthAlignment)(m, w);
    return v(w, M), (0, r.balance)(w, m.graph().align);
  };
  r.positionX = g;
  var y = function(m, x, _) {
    return function(w, E, M) {
      var C = w.node(E), S = w.node(M), A = 0, T;
      if (A += C.width / 2, C.hasOwnProperty("labelpos"))
        switch ((C.labelpos || "").toLowerCase()) {
          case "l":
            T = -C.width / 2;
            break;
          case "r":
            T = C.width / 2;
            break;
        }
      if (T && (A += _ ? T : -T), T = 0, A += (C.dummy ? x : m) / 2, A += (S.dummy ? x : m) / 2, A += S.width / 2, S.labelpos)
        switch ((S.labelpos || "").toLowerCase()) {
          case "l":
            T = S.width / 2;
            break;
          case "r":
            T = -S.width / 2;
            break;
        }
      return T && (A += _ ? T : -T), T = 0, A;
    };
  };
  r.sep = y;
  var b = function(m, x) {
    return m.node(x).width || 0;
  };
  r.width = b;
})(T3);
Object.defineProperty(gx, "__esModule", { value: !0 });
var yx = Mi, Us = T3, dte = function(r) {
  var t = (0, yx.buildLayerMatrix)(r), e = r.graph().ranksep, n = 0;
  t == null || t.forEach(function(i) {
    var a = i.map(function(s) {
      return r.node(s).height;
    }), o = Math.max.apply(Math, a);
    i == null || i.forEach(function(s) {
      r.node(s).y = n + o / 2;
    }), n += o + e;
  });
}, vte = function(r) {
  var t = (0, yx.buildLayerMatrix)(r), e = Object.assign((0, Us.findType1Conflicts)(r, t), (0, Us.findType2Conflicts)(r, t)), n = {}, i = [];
  ["u", "d"].forEach(function(o) {
    i = o === "u" ? t : Object.values(t).reverse(), ["l", "r"].forEach(function(s) {
      s === "r" && (i = i.map(function(c) {
        return Object.values(c).reverse();
      }));
      var u = (o === "u" ? r.predecessors : r.successors).bind(r), f = (0, Us.verticalAlignment)(r, i, e, u), l = (0, Us.horizontalCompaction)(r, i, f.root, f.align, s === "r");
      s === "r" && Object.keys(l).forEach(function(c) {
        return l[c] = -l[c];
      }), n[o + s] = l;
    });
  });
  var a = (0, Us.findSmallestWidthAlignment)(r, n);
  return a && (0, Us.alignCoordinates)(n, a), (0, Us.balance)(n, r.graph().align);
}, pte = function(r) {
  var t, e = (0, yx.asNonCompoundGraph)(r);
  dte(e);
  var n = vte(e);
  (t = Object.keys(n)) === null || t === void 0 || t.forEach(function(i) {
    e.node(i).x = n[i];
  });
};
gx.default = pte;
var mx = {};
Object.defineProperty(mx, "__esModule", { value: !0 });
var gte = function(r, t) {
  var e = r.nodes().filter(function(o) {
    var s;
    return !(!((s = r.children(o)) === null || s === void 0) && s.length);
  }), n = e.map(function(o) {
    return r.node(o).rank;
  }), i = Math.max.apply(Math, n), a = Array(i + 1).fill([]);
  t == null || t.forEach(function(o) {
    var s = r.node(o);
    !s || (s == null ? void 0 : s.dummy) || isNaN(s.rank) || (s.fixorder = a[s.rank].length, a[s.rank].push(o));
  });
};
mx.default = gte;
var sp = Oe && Oe.__assign || function() {
  return sp = Object.assign || function(r) {
    for (var t, e = 1, n = arguments.length; e < n; e++) {
      t = arguments[e];
      for (var i in t)
        Object.prototype.hasOwnProperty.call(t, i) && (r[i] = t[i]);
    }
    return r;
  }, sp.apply(this, arguments);
}, Va = Oe && Oe.__importDefault || function(r) {
  return r && r.__esModule ? r : { default: r };
};
Object.defineProperty(Hb, "__esModule", { value: !0 });
var VS = Va(Kb), XS = Va(ex), yte = Va(tx), Ua = Mi, mte = Va(rx), YS = Va(nx), bte = Va(ix), HS = Va(ax), xte = Va(ox), _te = Va(gx), wte = Va(mx), Ete = Po, Ste = function(r, t) {
  var e = t && t.debugTiming ? Ua.time : Ua.notime;
  e("layout", function() {
    t && !t.keepNodeOrder && t.prevGraph && e("  inheritOrder", function() {
      Cte(r, t.prevGraph);
    });
    var n = e("  buildLayoutGraph", function() {
      return Lte(r);
    });
    t && t.edgeLabelSpace === !1 || e("  makeSpaceForEdgeLabels", function() {
      Nte(n);
    });
    try {
      e("  runLayout", function() {
        Mte(n, e, t);
      });
    } catch (i) {
      if (i.message === "Not possible to find intersection inside of the rectangle") {
        console.error(`The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph's structure:
`, i);
        return;
      }
      throw i;
    }
    e("  updateInputGraph", function() {
      Tte(r, n);
    });
  });
}, Mte = function(r, t, e) {
  t("    removeSelfEdges", function() {
    Wte(r);
  }), t("    acyclic", function() {
    VS.default.run(r);
  }), t("    nestingGraph.run", function() {
    YS.default.run(r);
  }), t("    rank", function() {
    (0, yte.default)((0, Ua.asNonCompoundGraph)(r));
  }), t("    injectEdgeLabelProxies", function() {
    Rte(r);
  }), t("    removeEmptyRanks", function() {
    (0, Ua.removeEmptyRanks)(r);
  }), t("    nestingGraph.cleanup", function() {
    YS.default.cleanup(r);
  }), t("    normalizeRanks", function() {
    (0, Ua.normalizeRanks)(r);
  }), t("    assignRankMinMax", function() {
    Bte(r);
  }), t("    removeEdgeLabelProxies", function() {
    Gte(r);
  }), t("    normalize.run", function() {
    XS.default.run(r);
  }), t("    parentDummyChains", function() {
    (0, mte.default)(r);
  }), t("    addBorderSegments", function() {
    (0, bte.default)(r);
  }), e && e.keepNodeOrder && t("    initDataOrder", function() {
    (0, wte.default)(r, e.nodeOrder);
  }), t("    order", function() {
    (0, xte.default)(r);
  }), t("    insertSelfEdges", function() {
    Vte(r);
  }), t("    adjustCoordinateSystem", function() {
    HS.default.adjust(r);
  }), t("    position", function() {
    (0, _te.default)(r);
  }), t("    positionSelfEdges", function() {
    Xte(r);
  }), t("    removeBorderNodes", function() {
    $te(r);
  }), t("    normalize.undo", function() {
    XS.default.undo(r);
  }), t("    fixupEdgeLabelCoords", function() {
    Ute(r);
  }), t("    undoCoordinateSystem", function() {
    HS.default.undo(r);
  }), t("    translateGraph", function() {
    Fte(r);
  }), t("    assignNodeIntersects", function() {
    zte(r);
  }), t("    reversePoints", function() {
    jte(r);
  }), t("    acyclic.undo", function() {
    VS.default.undo(r);
  });
}, Cte = function(r, t) {
  r.nodes().forEach(function(e) {
    var n = r.node(e), i = t.node(e);
    i !== void 0 ? (n.fixorder = i._order, delete i._order) : delete n.fixorder;
  });
}, Tte = function(r, t) {
  r.nodes().forEach(function(e) {
    var n, i = r.node(e);
    if (i) {
      var a = t.node(e);
      i.x = a.x, i.y = a.y, i._order = a.order, i._rank = a.rank, !((n = t.children(e)) === null || n === void 0) && n.length && (i.width = a.width, i.height = a.height);
    }
  }), r.edges().forEach(function(e) {
    var n = r.edge(e), i = t.edge(e);
    n.points = i.points, i.hasOwnProperty("x") && (n.x = i.x, n.y = i.y);
  }), r.graph().width = t.graph().width, r.graph().height = t.graph().height;
}, Ate = ["nodesep", "edgesep", "ranksep", "marginx", "marginy"], Ite = { ranksep: 50, edgesep: 20, nodesep: 50, rankdir: "tb" }, hy = ["acyclicer", "ranker", "rankdir", "align"], Pte = ["width", "height", "layer", "fixorder"], Ote = { width: 0, height: 0 }, Dte = ["minlen", "weight", "width", "height", "labeloffset"], kte = {
  minlen: 1,
  weight: 1,
  width: 0,
  height: 0,
  labeloffset: 10,
  labelpos: "r"
}, dy = ["labelpos"], Lte = function(r) {
  var t = new Ete.Graph({ multigraph: !0, compound: !0 }), e = py(r.graph()), n = {};
  return hy == null || hy.forEach(function(i) {
    e[i] !== void 0 && (n[i] = e[i]);
  }), t.setGraph(Object.assign({}, Ite, vy(e, Ate), n)), r.nodes().forEach(function(i) {
    var a = py(r.node(i)), o = sp(sp({}, Ote), a), s = vy(o, Pte);
    t.setNode(i, s), t.setParent(i, r.parent(i));
  }), r.edges().forEach(function(i) {
    var a = py(r.edge(i)), o = {};
    dy == null || dy.forEach(function(s) {
      a[s] !== void 0 && (o[s] = a[s]);
    }), t.setEdgeObj(i, Object.assign({}, kte, vy(a, Dte), o));
  }), t;
}, Nte = function(r) {
  var t = r.graph();
  t.ranksep || (t.ranksep = 0), t.ranksep /= 2, r.nodes().forEach(function(e) {
    var n = r.node(e);
    isNaN(n.layer) || n.layer || (n.layer = 0);
  }), r.edges().forEach(function(e) {
    var n, i = r.edge(e);
    i.minlen *= 2, ((n = i.labelpos) === null || n === void 0 ? void 0 : n.toLowerCase()) !== "c" && (t.rankdir === "TB" || t.rankdir === "BT" ? i.width += i.labeloffset : i.height += i.labeloffset);
  });
}, Rte = function(r) {
  r.edges().forEach(function(t) {
    var e = r.edge(t);
    if (e.width && e.height) {
      var n = r.node(t.v), i = r.node(t.w), a = {
        e: t,
        rank: (i.rank - n.rank) / 2 + n.rank
      };
      (0, Ua.addDummyNode)(r, "edge-proxy", a, "_ep");
    }
  });
}, Bte = function(r) {
  var t = 0;
  r.nodes().forEach(function(e) {
    var n, i, a = r.node(e);
    a.borderTop && (a.minRank = (n = r.node(a.borderTop)) === null || n === void 0 ? void 0 : n.rank, a.maxRank = (i = r.node(a.borderBottom)) === null || i === void 0 ? void 0 : i.rank, t = Math.max(t, a.maxRank || -1 / 0));
  }), r.graph().maxRank = t;
}, Gte = function(r) {
  r.nodes().forEach(function(t) {
    var e = r.node(t);
    e.dummy === "edge-proxy" && (r.edge(e.e).labelRank = e.rank, r.removeNode(t));
  });
}, Fte = function(r) {
  var t, e = 0, n, i = 0, a = r.graph(), o = a.marginx || 0, s = a.marginy || 0, u = function(f) {
    if (!!f) {
      var l = f.x, c = f.y, h = f.width, d = f.height;
      !isNaN(l) && !isNaN(h) && (t === void 0 && (t = l - h / 2), t = Math.min(t, l - h / 2), e = Math.max(e, l + h / 2)), !isNaN(c) && !isNaN(d) && (n === void 0 && (n = c - d / 2), n = Math.min(n, c - d / 2), i = Math.max(i, c + d / 2));
    }
  };
  r.nodes().forEach(function(f) {
    u(r.node(f));
  }), r.edges().forEach(function(f) {
    var l = r.edge(f);
    l != null && l.hasOwnProperty("x") && u(l);
  }), t -= o, n -= s, r.nodes().forEach(function(f) {
    var l = r.node(f);
    l && (l.x -= t, l.y -= n);
  }), r.edges().forEach(function(f) {
    var l, c = r.edge(f);
    (l = c.points) === null || l === void 0 || l.forEach(function(h) {
      h.x -= t, h.y -= n;
    }), c.hasOwnProperty("x") && (c.x -= t), c.hasOwnProperty("y") && (c.y -= n);
  }), a.width = e - t + o, a.height = i - n + s;
}, zte = function(r) {
  r.edges().forEach(function(t) {
    var e = r.edge(t), n = r.node(t.v), i = r.node(t.w), a, o;
    e.points ? (a = e.points[0], o = e.points[e.points.length - 1]) : (e.points = [], a = i, o = n), e.points.unshift((0, Ua.intersectRect)(n, a)), e.points.push((0, Ua.intersectRect)(i, o));
  });
}, Ute = function(r) {
  r.edges().forEach(function(t) {
    var e = r.edge(t);
    if (e != null && e.hasOwnProperty("x"))
      switch ((e.labelpos === "l" || e.labelpos === "r") && (e.width -= e.labeloffset), e.labelpos) {
        case "l":
          e.x -= e.width / 2 + e.labeloffset;
          break;
        case "r":
          e.x += e.width / 2 + e.labeloffset;
          break;
      }
  });
}, jte = function(r) {
  r.edges().forEach(function(t) {
    var e, n = r.edge(t);
    n.reversed && ((e = n.points) === null || e === void 0 || e.reverse());
  });
}, $te = function(r) {
  r.nodes().forEach(function(t) {
    var e, n, i;
    if (!((e = r.children(t)) === null || e === void 0) && e.length) {
      var a = r.node(t), o = r.node(a.borderTop), s = r.node(a.borderBottom), u = r.node(a.borderLeft[((n = a.borderLeft) === null || n === void 0 ? void 0 : n.length) - 1]), f = r.node(a.borderRight[((i = a.borderRight) === null || i === void 0 ? void 0 : i.length) - 1]);
      a.width = Math.abs((f == null ? void 0 : f.x) - (u == null ? void 0 : u.x)) || 10, a.height = Math.abs((s == null ? void 0 : s.y) - (o == null ? void 0 : o.y)) || 10, a.x = ((u == null ? void 0 : u.x) || 0) + a.width / 2, a.y = ((o == null ? void 0 : o.y) || 0) + a.height / 2;
    }
  }), r.nodes().forEach(function(t) {
    var e;
    ((e = r.node(t)) === null || e === void 0 ? void 0 : e.dummy) === "border" && r.removeNode(t);
  });
}, Wte = function(r) {
  r.edges().forEach(function(t) {
    if (t.v === t.w) {
      var e = r.node(t.v);
      e.selfEdges || (e.selfEdges = []), e.selfEdges.push({ e: t, label: r.edge(t) }), r.removeEdgeObj(t);
    }
  });
}, Vte = function(r) {
  var t = (0, Ua.buildLayerMatrix)(r);
  t == null || t.forEach(function(e) {
    var n = 0;
    e == null || e.forEach(function(i, a) {
      var o, s = r.node(i);
      s.order = a + n, (o = s.selfEdges) === null || o === void 0 || o.forEach(function(u) {
        (0, Ua.addDummyNode)(r, "selfedge", {
          width: u.label.width,
          height: u.label.height,
          rank: s.rank,
          order: a + ++n,
          e: u.e,
          label: u.label
        }, "_se");
      }), delete s.selfEdges;
    });
  });
}, Xte = function(r) {
  r.nodes().forEach(function(t) {
    var e = r.node(t);
    if (e.dummy === "selfedge") {
      var n = r.node(e.e.v), i = n.x + n.width / 2, a = n.y, o = e.x - i, s = n.height / 2;
      r.setEdgeObj(e.e, e.label), r.removeNode(t), e.label.points = [
        { x: i + 2 * o / 3, y: a - s },
        { x: i + 5 * o / 6, y: a - s },
        { y: a, x: i + o },
        { x: i + 5 * o / 6, y: a + s },
        { x: i + 2 * o / 3, y: a + s }
      ], e.label.x = e.x, e.label.y = e.y;
    }
  });
}, vy = function(r, t) {
  var e = {};
  return t == null || t.forEach(function(n) {
    r[n] !== void 0 && (e[n] = +r[n]);
  }), e;
}, py = function(r) {
  r === void 0 && (r = {});
  var t = {};
  return Object.keys(r).forEach(function(e) {
    t[e.toLowerCase()] = r[e];
  }), t;
};
Hb.default = Ste;
var Yte = Oe && Oe.__importDefault || function(r) {
  return r && r.__esModule ? r : { default: r };
};
Object.defineProperty(Yb, "__esModule", { value: !0 });
var Hte = Yte(Hb), KS = Mi;
Yb.default = {
  layout: Hte.default,
  util: {
    time: KS.time,
    notime: KS.notime
  }
};
var Kte = Oe && Oe.__extends || function() {
  var r = function(t, e) {
    return r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(n, i) {
      n.__proto__ = i;
    } || function(n, i) {
      for (var a in i)
        Object.prototype.hasOwnProperty.call(i, a) && (n[a] = i[a]);
    }, r(t, e);
  };
  return function(t, e) {
    if (typeof e != "function" && e !== null)
      throw new TypeError("Class extends value " + String(e) + " is not a constructor or null");
    r(t, e);
    function n() {
      this.constructor = t;
    }
    t.prototype = e === null ? Object.create(e) : (n.prototype = e.prototype, new n());
  };
}(), qte = Oe && Oe.__importDefault || function(r) {
  return r && r.__esModule ? r : { default: r };
};
Object.defineProperty(al, "__esModule", { value: !0 });
al.DagreLayout = void 0;
var Zte = qte(Yb), yi = on(), Qte = an, qS = Po, Jte = function(r) {
  Kte(t, r);
  function t(e) {
    var n = r.call(this) || this;
    return n.rankdir = "TB", n.nodesep = 50, n.ranksep = 50, n.controlPoints = !1, n.sortByCombo = !1, n.edgeLabelSpace = !0, n.radial = !1, n.nodes = [], n.edges = [], n.onLayoutEnd = function() {
    }, n.layoutNode = function(i) {
      var a = n, o = a.nodes, s = o.find(function(f) {
        return f.id === i;
      });
      if (s) {
        var u = s.layout !== !1;
        return u;
      }
      return !0;
    }, n.updateCfg(e), n;
  }
  return t.prototype.getDefaultCfg = function() {
    return {
      rankdir: "TB",
      align: void 0,
      nodeSize: void 0,
      nodesepFunc: void 0,
      ranksepFunc: void 0,
      nodesep: 50,
      ranksep: 50,
      controlPoints: !1,
      radial: !1,
      focusNode: null
    };
  }, t.prototype.execute = function() {
    var e = this, n, i, a = this, o = a.nodes, s = a.nodeSize, u = a.rankdir, f = a.combos, l = a.begin, c = a.radial;
    if (!!o) {
      var h = a.edges || [], d = new qS.Graph({
        multigraph: !0,
        compound: !0
      }), v;
      s ? (0, yi.isArray)(s) ? v = function() {
        return s;
      } : v = function() {
        return [s, s];
      } : v = function(le) {
        return le.size ? (0, yi.isArray)(le.size) ? le.size : (0, yi.isObject)(le.size) ? [le.size.width || 40, le.size.height || 40] : [le.size, le.size] : [40, 40];
      };
      var p = (0, yi.getFunc)(a.ranksep, 50, a.ranksepFunc), g = (0, yi.getFunc)(a.nodesep, 50, a.nodesepFunc), y = g, b = p;
      (u === "LR" || u === "RL") && (y = p, b = g), d.setDefaultEdgeLabel(function() {
        return {};
      }), d.setGraph(a);
      var m = {};
      this.sortByCombo && f && f.forEach(function(le) {
        !le.parentId || (m[le.parentId] || (m[le.parentId] = !0, d.setNode(le.parentId, {})), d.setParent(le.id, le.parentId));
      }), o.filter(function(le) {
        return le.layout !== !1;
      }).forEach(function(le) {
        var Me = v(le), $e = b(le), et = y(le), ft = Me[0] + 2 * et, pt = Me[1] + 2 * $e, $ = le.layer;
        (0, yi.isNumber)($) ? d.setNode(le.id, { width: ft, height: pt, layer: $ }) : d.setNode(le.id, { width: ft, height: pt }), e.sortByCombo && le.comboId && (m[le.comboId] || (m[le.comboId] = !0, d.setNode(le.comboId, {})), d.setParent(le.id, le.comboId));
      }), h.forEach(function(le) {
        var Me = (0, yi.getEdgeTerminal)(le, "source"), $e = (0, yi.getEdgeTerminal)(le, "target");
        e.layoutNode(Me) && e.layoutNode($e) && d.setEdge(Me, $e, {
          weight: le.weight || 1
        });
      });
      var x = void 0;
      !((n = a.preset) === null || n === void 0) && n.nodes && (x = new qS.Graph({
        multigraph: !0,
        compound: !0
      }), a.preset.nodes.forEach(function(le) {
        x == null || x.setNode(le.id, le);
      })), Zte.default.layout(d, {
        prevGraph: x,
        edgeLabelSpace: a.edgeLabelSpace,
        keepNodeOrder: Boolean(!!a.nodeOrder),
        nodeOrder: a.nodeOrder
      });
      var _ = [0, 0];
      if (l) {
        var w = 1 / 0, E = 1 / 0;
        d.nodes().forEach(function(le) {
          var Me = d.node(le);
          w > Me.x && (w = Me.x), E > Me.y && (E = Me.y);
        }), d.edges().forEach(function(le) {
          var Me, $e = d.edge(le);
          (Me = $e.points) === null || Me === void 0 || Me.forEach(function(et) {
            w > et.x && (w = et.x), E > et.y && (E = et.y);
          });
        }), _[0] = l[0] - w, _[1] = l[1] - E;
      }
      if (c) {
        var M = this, C = M.focusNode, S = M.ranksep, A = M.getRadialPos, T = (0, yi.isString)(C) ? C : C == null ? void 0 : C.id, P = T ? (i = d.node(T)) === null || i === void 0 ? void 0 : i._rank : 0, k = [], L = u === "LR" || u === "RL", O = L ? "y" : "x", D = L ? "height" : "width", G = 1 / 0, R = -1 / 0;
        d.nodes().forEach(function(le) {
          var Me = d.node(le), $e = o.findIndex(function(X) {
            return X.id === le;
          });
          if (!!o[$e]) {
            var et = g(o[$e]);
            if (P === 0)
              k[Me._rank] || (k[Me._rank] = { nodes: [], totalWidth: 0, maxSize: -1 / 0 }), k[Me._rank].nodes.push(le), k[Me._rank].totalWidth += et * 2 + Me[D], k[Me._rank].maxSize < Math.max(Me.width, Me.height) && (k[Me._rank].maxSize = Math.max(Me.width, Me.height));
            else {
              var ft = Me._rank - P;
              if (ft === 0)
                k[ft] || (k[ft] = { nodes: [], totalWidth: 0, maxSize: -1 / 0 }), k[ft].nodes.push(le), k[ft].totalWidth += et * 2 + Me[D], k[ft].maxSize < Math.max(Me.width, Me.height) && (k[ft].maxSize = Math.max(Me.width, Me.height));
              else {
                var pt = Math.abs(ft);
                k[pt] || (k[pt] = { left: [], right: [], totalWidth: 0, maxSize: -1 / 0 }), k[pt].totalWidth += et * 2 + Me[D], k[pt].maxSize < Math.max(Me.width, Me.height) && (k[pt].maxSize = Math.max(Me.width, Me.height)), ft < 0 ? k[pt].left.push(le) : k[pt].right.push(le);
              }
            }
            var $ = Me[O] - Me[D] / 2 - et, te = Me[O] + Me[D] / 2 + et;
            $ < G && (G = $), te > R && (R = te);
          }
        });
        var F = S || 50, q = {}, ne = (R - G) / 0.9, oe = [(G + R - ne) * 0.5, (G + R + ne) * 0.5], ie = function(le, Me, $e, et) {
          $e === void 0 && ($e = -1 / 0), et === void 0 && (et = [0, 1]);
          var ft = $e;
          return le.forEach(function(pt) {
            var $ = d.node(pt);
            q[pt] = Me;
            var te = A($[O], oe, ne, Me, et), X = te.x, De = te.y, Ke = o.findIndex(function(_t) {
              return _t.id === pt;
            });
            if (!!o[Ke]) {
              o[Ke].x = X + _[0], o[Ke].y = De + _[1], o[Ke]._order = $._order;
              var Fe = p(o[Ke]);
              ft < Fe && (ft = Fe);
            }
          }), ft;
        }, Ee = !0, Xe = 0;
        k.forEach(function(le) {
          var Me, $e, et, ft, pt, $, te;
          if (!(!(!((Me = le == null ? void 0 : le.nodes) === null || Me === void 0) && Me.length) && !(!(($e = le == null ? void 0 : le.left) === null || $e === void 0) && $e.length) && !(!((et = le == null ? void 0 : le.right) === null || et === void 0) && et.length))) {
            if (Ee && le.nodes.length === 1) {
              var X = o.findIndex(function(Fe) {
                return Fe.id === le.nodes[0];
              });
              o[X].x = _[0], o[X].y = _[1], q[le.nodes[0]] = 0, F = p(o[X]), Ee = !1;
              return;
            }
            F = Math.max(F, le.totalWidth / (2 * Math.PI));
            var De = -1 / 0;
            if (P === 0 || ((ft = le.nodes) === null || ft === void 0 ? void 0 : ft.length))
              De = ie(le.nodes, F, De, [0, 1]);
            else {
              var Ke = ((pt = le.left) === null || pt === void 0 ? void 0 : pt.length) / ((($ = le.left) === null || $ === void 0 ? void 0 : $.length) + ((te = le.right) === null || te === void 0 ? void 0 : te.length));
              De = ie(le.left, F, De, [0, Ke]), De = ie(le.right, F, De, [Ke + 0.05, 1]);
            }
            F += De, Ee = !1, Xe - le.maxSize;
          }
        }), d.edges().forEach(function(le) {
          var Me, $e, et, ft = d.edge(le), pt = h.findIndex(function(Kt) {
            var Ye = (0, yi.getEdgeTerminal)(Kt, "source"), vt = (0, yi.getEdgeTerminal)(Kt, "target");
            return Ye === le.v && vt === le.w;
          });
          if (a.edgeLabelSpace && a.controlPoints && h[pt].type !== "loop") {
            var $ = O === "x" ? "y" : "x", te = (Me = ft == null ? void 0 : ft.points) === null || Me === void 0 ? void 0 : Me.slice(1, ft.points.length - 1), X = [], De = ($e = d.node(le.v)) === null || $e === void 0 ? void 0 : $e[$], Ke = De - ((et = d.node(le.w)) === null || et === void 0 ? void 0 : et[$]), Fe = q[le.v], _t = Fe - q[le.w];
            te == null || te.forEach(function(Kt) {
              var Ye = (Kt[$] - De) / Ke * _t + Fe, vt = A(Kt[O], oe, ne, Ye);
              X.push({
                x: vt.x + _[0],
                y: vt.y + _[1]
              });
            }), h[pt].controlPoints = X;
          }
        });
      } else
        d.nodes().forEach(function(le) {
          var Me = d.node(le), $e = o.findIndex(function(et) {
            return et.id === le;
          });
          !o[$e] || (o[$e].x = Me.x + _[0], o[$e].y = Me.y + _[1], o[$e]._order = Me._order);
        }), d.edges().forEach(function(le) {
          var Me, $e = d.edge(le), et = h.findIndex(function(ft) {
            var pt = (0, yi.getEdgeTerminal)(ft, "source"), $ = (0, yi.getEdgeTerminal)(ft, "target");
            return pt === le.v && $ === le.w;
          });
          a.edgeLabelSpace && a.controlPoints && h[et].type !== "loop" && (h[et].controlPoints = (Me = $e == null ? void 0 : $e.points) === null || Me === void 0 ? void 0 : Me.slice(1, $e.points.length - 1), h[et].controlPoints.forEach(function(ft) {
            ft.x += _[0], ft.y += _[1];
          }));
        });
      return a.onLayoutEnd && a.onLayoutEnd(), {
        nodes: o,
        edges: h
      };
    }
  }, t.prototype.getRadialPos = function(e, n, i, a, o) {
    o === void 0 && (o = [0, 1]);
    var s = (e - n[0]) / i;
    s = s * (o[1] - o[0]) + o[0];
    var u = s * 2 * Math.PI;
    return {
      x: Math.cos(u) * a,
      y: Math.sin(u) * a
    };
  }, t.prototype.getType = function() {
    return "dagre";
  }, t;
}(Qte.Base);
al.DagreLayout = Jte;
var dh = {};
const up = { graph: { meta: { rankDir: "TB", nodeSep: 50, rankSep: 50, edgeSep: 5, align: void 0 } }, subScene: { meta: { paddingTop: 20, paddingBottom: 20, paddingLeft: 20, paddingRight: 20, labelHeight: 20 } }, nodeSize: { meta: { width: 100, maxLabelWidth: 0, height: 20 }, node: { width: 80, height: 20, labelOffset: 10, maxLabelWidth: 40 }, bridge: { width: 5, height: 5, radius: 2, labelOffset: 0 } } };
function Jm(r = {}, t = up) {
  var e, n, i, a;
  const o = JSON.parse(JSON.stringify(t)), s = ((e = r == null ? void 0 : r.graph) === null || e === void 0 ? void 0 : e.meta) || {}, u = ((n = r == null ? void 0 : r.subScene) === null || n === void 0 ? void 0 : n.meta) || {}, f = ((i = r == null ? void 0 : r.nodeSize) === null || i === void 0 ? void 0 : i.meta) || {}, l = ((a = r == null ? void 0 : r.nodeSize) === null || a === void 0 ? void 0 : a.node) || {}, c = o.nodeSize.bridge;
  return { graph: { meta: Object.assign(o.graph.meta, s) }, subScene: { meta: Object.assign(o.subScene.meta, u) }, nodeSize: { meta: Object.assign(o.nodeSize.meta, f), node: Object.assign(o.nodeSize.node, l), bridge: c } };
}
function A3(r) {
  return `\u25EC${r}\u25EC`;
}
const Hf = A3("ROOT"), I3 = A3("BRIDGE_GRAPH");
var ui, xu, Kf, e1;
(function(r) {
  r[r.META = 0] = "META", r[r.NODE = 1] = "NODE", r[r.BRIDGE = 2] = "BRIDGE";
})(ui || (ui = {})), function(r) {
  r[r.INCLUDE = 0] = "INCLUDE", r[r.EXCLUDE = 1] = "EXCLUDE", r[r.UNSPECIFIED = 2] = "UNSPECIFIED";
}(xu || (xu = {})), function(r) {
  r[r.META = 0] = "META", r[r.CORE = 1] = "CORE", r[r.BRIDGE = 2] = "BRIDGE";
}(Kf || (Kf = {})), function(r) {
  r[r.META = 0] = "META", r[r.OP = 1] = "OP", r[r.SERIES = 2] = "SERIES";
}(e1 || (e1 = {}));
var Dd = typeof globalThis < "u" ? globalThis : typeof window < "u" ? window : typeof global < "u" ? global : typeof self < "u" ? self : {};
function bx(r, t) {
  return r(t = { exports: {} }, t.exports), t.exports;
}
var ere = function() {
  this.__data__ = [], this.size = 0;
}, ol = function(r, t) {
  return r === t || r != r && t != t;
}, ig = function(r, t) {
  for (var e = r.length; e--; )
    if (ol(r[e][0], t))
      return e;
  return -1;
}, tre = Array.prototype.splice, rre = function(r) {
  var t = this.__data__, e = ig(t, r);
  return !(e < 0) && (e == t.length - 1 ? t.pop() : tre.call(t, e, 1), --this.size, !0);
}, nre = function(r) {
  var t = this.__data__, e = ig(t, r);
  return e < 0 ? void 0 : t[e][1];
}, ire = function(r) {
  return ig(this.__data__, r) > -1;
}, are = function(r, t) {
  var e = this.__data__, n = ig(e, r);
  return n < 0 ? (++this.size, e.push([r, t])) : e[n][1] = t, this;
};
function yf(r) {
  var t = -1, e = r == null ? 0 : r.length;
  for (this.clear(); ++t < e; ) {
    var n = r[t];
    this.set(n[0], n[1]);
  }
}
yf.prototype.clear = ere, yf.prototype.delete = rre, yf.prototype.get = nre, yf.prototype.has = ire, yf.prototype.set = are;
var ag = yf, ore = function() {
  this.__data__ = new ag(), this.size = 0;
}, sre = function(r) {
  var t = this.__data__, e = t.delete(r);
  return this.size = t.size, e;
}, ure = function(r) {
  return this.__data__.get(r);
}, fre = function(r) {
  return this.__data__.has(r);
}, P3 = typeof Dd == "object" && Dd && Dd.Object === Object && Dd, lre = typeof self == "object" && self && self.Object === Object && self, sa = P3 || lre || Function("return this")(), ji = sa.Symbol, O3 = Object.prototype, cre = O3.hasOwnProperty, hre = O3.toString, Dl = ji ? ji.toStringTag : void 0, dre = function(r) {
  var t = cre.call(r, Dl), e = r[Dl];
  try {
    r[Dl] = void 0;
    var n = !0;
  } catch {
  }
  var i = hre.call(r);
  return n && (t ? r[Dl] = e : delete r[Dl]), i;
}, vre = Object.prototype.toString, pre = function(r) {
  return vre.call(r);
}, ZS = ji ? ji.toStringTag : void 0, _s = function(r) {
  return r == null ? r === void 0 ? "[object Undefined]" : "[object Null]" : ZS && ZS in Object(r) ? dre(r) : pre(r);
}, li = function(r) {
  var t = typeof r;
  return r != null && (t == "object" || t == "function");
}, QS, vh = function(r) {
  if (!li(r))
    return !1;
  var t = _s(r);
  return t == "[object Function]" || t == "[object GeneratorFunction]" || t == "[object AsyncFunction]" || t == "[object Proxy]";
}, gy = sa["__core-js_shared__"], JS = (QS = /[^.]+$/.exec(gy && gy.keys && gy.keys.IE_PROTO || "")) ? "Symbol(src)_1." + QS : "", gre = function(r) {
  return !!JS && JS in r;
}, yre = Function.prototype.toString, Au = function(r) {
  if (r != null) {
    try {
      return yre.call(r);
    } catch {
    }
    try {
      return r + "";
    } catch {
    }
  }
  return "";
}, mre = /^\[object .+?Constructor\]$/, bre = Function.prototype, xre = Object.prototype, _re = bre.toString, wre = xre.hasOwnProperty, Ere = RegExp("^" + _re.call(wre).replace(/[\\^$.*+?()[\]{}|]/g, "\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g, "$1.*?") + "$"), Sre = function(r) {
  return !(!li(r) || gre(r)) && (vh(r) ? Ere : mre).test(Au(r));
}, Mre = function(r, t) {
  return r == null ? void 0 : r[t];
}, Iu = function(r, t) {
  var e = Mre(r, t);
  return Sre(e) ? e : void 0;
}, Wc = Iu(sa, "Map"), Vc = Iu(Object, "create"), Cre = function() {
  this.__data__ = Vc ? Vc(null) : {}, this.size = 0;
}, Tre = function(r) {
  var t = this.has(r) && delete this.__data__[r];
  return this.size -= t ? 1 : 0, t;
}, Are = Object.prototype.hasOwnProperty, Ire = function(r) {
  var t = this.__data__;
  if (Vc) {
    var e = t[r];
    return e === "__lodash_hash_undefined__" ? void 0 : e;
  }
  return Are.call(t, r) ? t[r] : void 0;
}, Pre = Object.prototype.hasOwnProperty, Ore = function(r) {
  var t = this.__data__;
  return Vc ? t[r] !== void 0 : Pre.call(t, r);
}, Dre = function(r, t) {
  var e = this.__data__;
  return this.size += this.has(r) ? 0 : 1, e[r] = Vc && t === void 0 ? "__lodash_hash_undefined__" : t, this;
};
function mf(r) {
  var t = -1, e = r == null ? 0 : r.length;
  for (this.clear(); ++t < e; ) {
    var n = r[t];
    this.set(n[0], n[1]);
  }
}
mf.prototype.clear = Cre, mf.prototype.delete = Tre, mf.prototype.get = Ire, mf.prototype.has = Ore, mf.prototype.set = Dre;
var eM = mf, kre = function() {
  this.size = 0, this.__data__ = { hash: new eM(), map: new (Wc || ag)(), string: new eM() };
}, Lre = function(r) {
  var t = typeof r;
  return t == "string" || t == "number" || t == "symbol" || t == "boolean" ? r !== "__proto__" : r === null;
}, og = function(r, t) {
  var e = r.__data__;
  return Lre(t) ? e[typeof t == "string" ? "string" : "hash"] : e.map;
}, Nre = function(r) {
  var t = og(this, r).delete(r);
  return this.size -= t ? 1 : 0, t;
}, Rre = function(r) {
  return og(this, r).get(r);
}, Bre = function(r) {
  return og(this, r).has(r);
}, Gre = function(r, t) {
  var e = og(this, r), n = e.size;
  return e.set(r, t), this.size += e.size == n ? 0 : 1, this;
};
function bf(r) {
  var t = -1, e = r == null ? 0 : r.length;
  for (this.clear(); ++t < e; ) {
    var n = r[t];
    this.set(n[0], n[1]);
  }
}
bf.prototype.clear = kre, bf.prototype.delete = Nre, bf.prototype.get = Rre, bf.prototype.has = Bre, bf.prototype.set = Gre;
var sg = bf, Fre = function(r, t) {
  var e = this.__data__;
  if (e instanceof ag) {
    var n = e.__data__;
    if (!Wc || n.length < 199)
      return n.push([r, t]), this.size = ++e.size, this;
    e = this.__data__ = new sg(n);
  }
  return e.set(r, t), this.size = e.size, this;
};
function xf(r) {
  var t = this.__data__ = new ag(r);
  this.size = t.size;
}
xf.prototype.clear = ore, xf.prototype.delete = sre, xf.prototype.get = ure, xf.prototype.has = fre, xf.prototype.set = Fre;
var kf = xf, xx = function(r, t) {
  for (var e = -1, n = r == null ? 0 : r.length; ++e < n && t(r[e], e, r) !== !1; )
    ;
  return r;
}, fp = function() {
  try {
    var r = Iu(Object, "defineProperty");
    return r({}, "", {}), r;
  } catch {
  }
}(), ug = function(r, t, e) {
  t == "__proto__" && fp ? fp(r, t, { configurable: !0, enumerable: !0, value: e, writable: !0 }) : r[t] = e;
}, zre = Object.prototype.hasOwnProperty, fg = function(r, t, e) {
  var n = r[t];
  zre.call(r, t) && ol(n, e) && (e !== void 0 || t in r) || ug(r, t, e);
}, ph = function(r, t, e, n) {
  var i = !e;
  e || (e = {});
  for (var a = -1, o = t.length; ++a < o; ) {
    var s = t[a], u = n ? n(e[s], r[s], s, e, r) : void 0;
    u === void 0 && (u = r[s]), i ? ug(e, s, u) : fg(e, s, u);
  }
  return e;
}, Ure = function(r, t) {
  for (var e = -1, n = Array(r); ++e < r; )
    n[e] = t(e);
  return n;
}, ia = function(r) {
  return r != null && typeof r == "object";
}, tM = function(r) {
  return ia(r) && _s(r) == "[object Arguments]";
}, D3 = Object.prototype, jre = D3.hasOwnProperty, $re = D3.propertyIsEnumerable, qf = tM(function() {
  return arguments;
}()) ? tM : function(r) {
  return ia(r) && jre.call(r, "callee") && !$re.call(r, "callee");
}, nn = Array.isArray, Wre = function() {
  return !1;
}, _u = bx(function(r, t) {
  var e = t && !t.nodeType && t, n = e && r && !r.nodeType && r, i = n && n.exports === e ? sa.Buffer : void 0, a = (i ? i.isBuffer : void 0) || Wre;
  r.exports = a;
}), Vre = /^(?:0|[1-9]\d*)$/, lg = function(r, t) {
  var e = typeof r;
  return !!(t = t == null ? 9007199254740991 : t) && (e == "number" || e != "symbol" && Vre.test(r)) && r > -1 && r % 1 == 0 && r < t;
}, _x = function(r) {
  return typeof r == "number" && r > -1 && r % 1 == 0 && r <= 9007199254740991;
}, Br = {};
Br["[object Float32Array]"] = Br["[object Float64Array]"] = Br["[object Int8Array]"] = Br["[object Int16Array]"] = Br["[object Int32Array]"] = Br["[object Uint8Array]"] = Br["[object Uint8ClampedArray]"] = Br["[object Uint16Array]"] = Br["[object Uint32Array]"] = !0, Br["[object Arguments]"] = Br["[object Array]"] = Br["[object ArrayBuffer]"] = Br["[object Boolean]"] = Br["[object DataView]"] = Br["[object Date]"] = Br["[object Error]"] = Br["[object Function]"] = Br["[object Map]"] = Br["[object Number]"] = Br["[object Object]"] = Br["[object RegExp]"] = Br["[object Set]"] = Br["[object String]"] = Br["[object WeakMap]"] = !1;
var Xre = function(r) {
  return ia(r) && _x(r.length) && !!Br[_s(r)];
}, cg = function(r) {
  return function(t) {
    return r(t);
  };
}, Zf = bx(function(r, t) {
  var e = t && !t.nodeType && t, n = e && r && !r.nodeType && r, i = n && n.exports === e && P3.process, a = function() {
    try {
      var o = n && n.require && n.require("util").types;
      return o || i && i.binding && i.binding("util");
    } catch {
    }
  }();
  r.exports = a;
}), rM = Zf && Zf.isTypedArray, gh = rM ? cg(rM) : Xre, Yre = Object.prototype.hasOwnProperty, k3 = function(r, t) {
  var e = nn(r), n = !e && qf(r), i = !e && !n && _u(r), a = !e && !n && !i && gh(r), o = e || n || i || a, s = o ? Ure(r.length, String) : [], u = s.length;
  for (var f in r)
    !t && !Yre.call(r, f) || o && (f == "length" || i && (f == "offset" || f == "parent") || a && (f == "buffer" || f == "byteLength" || f == "byteOffset") || lg(f, u)) || s.push(f);
  return s;
}, Hre = Object.prototype, hg = function(r) {
  var t = r && r.constructor;
  return r === (typeof t == "function" && t.prototype || Hre);
}, L3 = function(r, t) {
  return function(e) {
    return r(t(e));
  };
}, Kre = L3(Object.keys, Object), qre = Object.prototype.hasOwnProperty, wx = function(r) {
  if (!hg(r))
    return Kre(r);
  var t = [];
  for (var e in Object(r))
    qre.call(r, e) && e != "constructor" && t.push(e);
  return t;
}, Oo = function(r) {
  return r != null && _x(r.length) && !vh(r);
}, ws = function(r) {
  return Oo(r) ? k3(r) : wx(r);
}, Zre = function(r, t) {
  return r && ph(t, ws(t), r);
}, Qre = function(r) {
  var t = [];
  if (r != null)
    for (var e in Object(r))
      t.push(e);
  return t;
}, Jre = Object.prototype.hasOwnProperty, ene = function(r) {
  if (!li(r))
    return Qre(r);
  var t = hg(r), e = [];
  for (var n in r)
    (n != "constructor" || !t && Jre.call(r, n)) && e.push(n);
  return e;
}, Pu = function(r) {
  return Oo(r) ? k3(r, !0) : ene(r);
}, tne = function(r, t) {
  return r && ph(t, Pu(t), r);
}, N3 = bx(function(r, t) {
  var e = t && !t.nodeType && t, n = e && r && !r.nodeType && r, i = n && n.exports === e ? sa.Buffer : void 0, a = i ? i.allocUnsafe : void 0;
  r.exports = function(o, s) {
    if (s)
      return o.slice();
    var u = o.length, f = a ? a(u) : new o.constructor(u);
    return o.copy(f), f;
  };
}), R3 = function(r, t) {
  var e = -1, n = r.length;
  for (t || (t = Array(n)); ++e < n; )
    t[e] = r[e];
  return t;
}, B3 = function(r, t) {
  for (var e = -1, n = r == null ? 0 : r.length, i = 0, a = []; ++e < n; ) {
    var o = r[e];
    t(o, e, r) && (a[i++] = o);
  }
  return a;
}, G3 = function() {
  return [];
}, rne = Object.prototype.propertyIsEnumerable, nM = Object.getOwnPropertySymbols, Ex = nM ? function(r) {
  return r == null ? [] : (r = Object(r), B3(nM(r), function(t) {
    return rne.call(r, t);
  }));
} : G3, nne = function(r, t) {
  return ph(r, Ex(r), t);
}, Sx = function(r, t) {
  for (var e = -1, n = t.length, i = r.length; ++e < n; )
    r[i + e] = t[e];
  return r;
}, dg = L3(Object.getPrototypeOf, Object), F3 = Object.getOwnPropertySymbols ? function(r) {
  for (var t = []; r; )
    Sx(t, Ex(r)), r = dg(r);
  return t;
} : G3, ine = function(r, t) {
  return ph(r, F3(r), t);
}, z3 = function(r, t, e) {
  var n = t(r);
  return nn(r) ? n : Sx(n, e(r));
}, t1 = function(r) {
  return z3(r, ws, Ex);
}, ane = function(r) {
  return z3(r, Pu, F3);
}, r1 = Iu(sa, "DataView"), n1 = Iu(sa, "Promise"), Lf = Iu(sa, "Set"), i1 = Iu(sa, "WeakMap"), one = Au(r1), sne = Au(Wc), une = Au(n1), fne = Au(Lf), lne = Au(i1), Zs = _s;
(r1 && Zs(new r1(new ArrayBuffer(1))) != "[object DataView]" || Wc && Zs(new Wc()) != "[object Map]" || n1 && Zs(n1.resolve()) != "[object Promise]" || Lf && Zs(new Lf()) != "[object Set]" || i1 && Zs(new i1()) != "[object WeakMap]") && (Zs = function(r) {
  var t = _s(r), e = t == "[object Object]" ? r.constructor : void 0, n = e ? Au(e) : "";
  if (n)
    switch (n) {
      case one:
        return "[object DataView]";
      case sne:
        return "[object Map]";
      case une:
        return "[object Promise]";
      case fne:
        return "[object Set]";
      case lne:
        return "[object WeakMap]";
    }
  return t;
});
var wu = Zs, cne = Object.prototype.hasOwnProperty, hne = function(r) {
  var t = r.length, e = new r.constructor(t);
  return t && typeof r[0] == "string" && cne.call(r, "index") && (e.index = r.index, e.input = r.input), e;
}, lp = sa.Uint8Array, Mx = function(r) {
  var t = new r.constructor(r.byteLength);
  return new lp(t).set(new lp(r)), t;
}, dne = function(r, t) {
  var e = t ? Mx(r.buffer) : r.buffer;
  return new r.constructor(e, r.byteOffset, r.byteLength);
}, vne = /\w*$/, pne = function(r) {
  var t = new r.constructor(r.source, vne.exec(r));
  return t.lastIndex = r.lastIndex, t;
}, iM = ji ? ji.prototype : void 0, aM = iM ? iM.valueOf : void 0, gne = function(r) {
  return aM ? Object(aM.call(r)) : {};
}, U3 = function(r, t) {
  var e = t ? Mx(r.buffer) : r.buffer;
  return new r.constructor(e, r.byteOffset, r.length);
}, yne = function(r, t, e) {
  var n = r.constructor;
  switch (t) {
    case "[object ArrayBuffer]":
      return Mx(r);
    case "[object Boolean]":
    case "[object Date]":
      return new n(+r);
    case "[object DataView]":
      return dne(r, e);
    case "[object Float32Array]":
    case "[object Float64Array]":
    case "[object Int8Array]":
    case "[object Int16Array]":
    case "[object Int32Array]":
    case "[object Uint8Array]":
    case "[object Uint8ClampedArray]":
    case "[object Uint16Array]":
    case "[object Uint32Array]":
      return U3(r, e);
    case "[object Map]":
      return new n();
    case "[object Number]":
    case "[object String]":
      return new n(r);
    case "[object RegExp]":
      return pne(r);
    case "[object Set]":
      return new n();
    case "[object Symbol]":
      return gne(r);
  }
}, oM = Object.create, j3 = function() {
  function r() {
  }
  return function(t) {
    if (!li(t))
      return {};
    if (oM)
      return oM(t);
    r.prototype = t;
    var e = new r();
    return r.prototype = void 0, e;
  };
}(), $3 = function(r) {
  return typeof r.constructor != "function" || hg(r) ? {} : j3(dg(r));
}, mne = function(r) {
  return ia(r) && wu(r) == "[object Map]";
}, sM = Zf && Zf.isMap, bne = sM ? cg(sM) : mne, xne = function(r) {
  return ia(r) && wu(r) == "[object Set]";
}, uM = Zf && Zf.isSet, _ne = uM ? cg(uM) : xne, Lr = {};
Lr["[object Arguments]"] = Lr["[object Array]"] = Lr["[object ArrayBuffer]"] = Lr["[object DataView]"] = Lr["[object Boolean]"] = Lr["[object Date]"] = Lr["[object Float32Array]"] = Lr["[object Float64Array]"] = Lr["[object Int8Array]"] = Lr["[object Int16Array]"] = Lr["[object Int32Array]"] = Lr["[object Map]"] = Lr["[object Number]"] = Lr["[object Object]"] = Lr["[object RegExp]"] = Lr["[object Set]"] = Lr["[object String]"] = Lr["[object Symbol]"] = Lr["[object Uint8Array]"] = Lr["[object Uint8ClampedArray]"] = Lr["[object Uint16Array]"] = Lr["[object Uint32Array]"] = !0, Lr["[object Error]"] = Lr["[object Function]"] = Lr["[object WeakMap]"] = !1;
var W3 = function r(t, e, n, i, a, o) {
  var s, u = 1 & e, f = 2 & e, l = 4 & e;
  if (n && (s = a ? n(t, i, a, o) : n(t)), s !== void 0)
    return s;
  if (!li(t))
    return t;
  var c = nn(t);
  if (c) {
    if (s = hne(t), !u)
      return R3(t, s);
  } else {
    var h = wu(t), d = h == "[object Function]" || h == "[object GeneratorFunction]";
    if (_u(t))
      return N3(t, u);
    if (h == "[object Object]" || h == "[object Arguments]" || d && !a) {
      if (s = f || d ? {} : $3(t), !u)
        return f ? ine(t, tne(s, t)) : nne(t, Zre(s, t));
    } else {
      if (!Lr[h])
        return a ? t : {};
      s = yne(t, h, u);
    }
  }
  o || (o = new kf());
  var v = o.get(t);
  if (v)
    return v;
  o.set(t, s), _ne(t) ? t.forEach(function(g) {
    s.add(r(g, e, n, g, t, o));
  }) : bne(t) && t.forEach(function(g, y) {
    s.set(y, r(g, e, n, y, t, o));
  });
  var p = c ? void 0 : (l ? f ? ane : t1 : f ? Pu : ws)(t);
  return xx(p || t, function(g, y) {
    p && (g = t[y = g]), fg(s, y, r(g, e, n, y, t, o));
  }), s;
}, wne = function(r) {
  return W3(r, 4);
}, Cx = function(r) {
  return function() {
    return r;
  };
}, Tx = function(r) {
  return function(t, e, n) {
    for (var i = -1, a = Object(t), o = n(t), s = o.length; s--; ) {
      var u = o[r ? s : ++i];
      if (e(a[u], u, a) === !1)
        break;
    }
    return t;
  };
}(), Ax = function(r, t) {
  return r && Tx(r, t, ws);
}, vg = function(r, t) {
  return function(e, n) {
    if (e == null)
      return e;
    if (!Oo(e))
      return r(e, n);
    for (var i = e.length, a = t ? i : -1, o = Object(e); (t ? a-- : ++a < i) && n(o[a], a, o) !== !1; )
      ;
    return e;
  };
}(Ax), Ou = function(r) {
  return r;
}, V3 = function(r) {
  return typeof r == "function" ? r : Ou;
}, X3 = function(r, t) {
  return (nn(r) ? xx : vg)(r, V3(t));
}, Y3 = X3, Ene = function(r, t) {
  var e = [];
  return vg(r, function(n, i, a) {
    t(n, i, a) && e.push(n);
  }), e;
}, Sne = function(r) {
  return this.__data__.set(r, "__lodash_hash_undefined__"), this;
}, Mne = function(r) {
  return this.__data__.has(r);
};
function Sv(r) {
  var t = -1, e = r == null ? 0 : r.length;
  for (this.__data__ = new sg(); ++t < e; )
    this.add(r[t]);
}
Sv.prototype.add = Sv.prototype.push = Sne, Sv.prototype.has = Mne;
var H3 = Sv, Cne = function(r, t) {
  for (var e = -1, n = r == null ? 0 : r.length; ++e < n; )
    if (t(r[e], e, r))
      return !0;
  return !1;
}, K3 = function(r, t) {
  return r.has(t);
}, q3 = function(r, t, e, n, i, a) {
  var o = 1 & e, s = r.length, u = t.length;
  if (s != u && !(o && u > s))
    return !1;
  var f = a.get(r), l = a.get(t);
  if (f && l)
    return f == t && l == r;
  var c = -1, h = !0, d = 2 & e ? new H3() : void 0;
  for (a.set(r, t), a.set(t, r); ++c < s; ) {
    var v = r[c], p = t[c];
    if (n)
      var g = o ? n(p, v, c, t, r, a) : n(v, p, c, r, t, a);
    if (g !== void 0) {
      if (g)
        continue;
      h = !1;
      break;
    }
    if (d) {
      if (!Cne(t, function(y, b) {
        if (!K3(d, b) && (v === y || i(v, y, e, n, a)))
          return d.push(b);
      })) {
        h = !1;
        break;
      }
    } else if (v !== p && !i(v, p, e, n, a)) {
      h = !1;
      break;
    }
  }
  return a.delete(r), a.delete(t), h;
}, Tne = function(r) {
  var t = -1, e = Array(r.size);
  return r.forEach(function(n, i) {
    e[++t] = [i, n];
  }), e;
}, Ix = function(r) {
  var t = -1, e = Array(r.size);
  return r.forEach(function(n) {
    e[++t] = n;
  }), e;
}, fM = ji ? ji.prototype : void 0, yy = fM ? fM.valueOf : void 0, Ane = function(r, t, e, n, i, a, o) {
  switch (e) {
    case "[object DataView]":
      if (r.byteLength != t.byteLength || r.byteOffset != t.byteOffset)
        return !1;
      r = r.buffer, t = t.buffer;
    case "[object ArrayBuffer]":
      return !(r.byteLength != t.byteLength || !a(new lp(r), new lp(t)));
    case "[object Boolean]":
    case "[object Date]":
    case "[object Number]":
      return ol(+r, +t);
    case "[object Error]":
      return r.name == t.name && r.message == t.message;
    case "[object RegExp]":
    case "[object String]":
      return r == t + "";
    case "[object Map]":
      var s = Tne;
    case "[object Set]":
      var u = 1 & n;
      if (s || (s = Ix), r.size != t.size && !u)
        return !1;
      var f = o.get(r);
      if (f)
        return f == t;
      n |= 2, o.set(r, t);
      var l = q3(s(r), s(t), n, i, a, o);
      return o.delete(r), l;
    case "[object Symbol]":
      if (yy)
        return yy.call(r) == yy.call(t);
  }
  return !1;
}, Ine = Object.prototype.hasOwnProperty, Pne = function(r, t, e, n, i, a) {
  var o = 1 & e, s = t1(r), u = s.length;
  if (u != t1(t).length && !o)
    return !1;
  for (var f = u; f--; ) {
    var l = s[f];
    if (!(o ? l in t : Ine.call(t, l)))
      return !1;
  }
  var c = a.get(r), h = a.get(t);
  if (c && h)
    return c == t && h == r;
  var d = !0;
  a.set(r, t), a.set(t, r);
  for (var v = o; ++f < u; ) {
    var p = r[l = s[f]], g = t[l];
    if (n)
      var y = o ? n(g, p, l, t, r, a) : n(p, g, l, r, t, a);
    if (!(y === void 0 ? p === g || i(p, g, e, n, a) : y)) {
      d = !1;
      break;
    }
    v || (v = l == "constructor");
  }
  if (d && !v) {
    var b = r.constructor, m = t.constructor;
    b == m || !("constructor" in r) || !("constructor" in t) || typeof b == "function" && b instanceof b && typeof m == "function" && m instanceof m || (d = !1);
  }
  return a.delete(r), a.delete(t), d;
}, lM = Object.prototype.hasOwnProperty, One = function(r, t, e, n, i, a) {
  var o = nn(r), s = nn(t), u = o ? "[object Array]" : wu(r), f = s ? "[object Array]" : wu(t), l = (u = u == "[object Arguments]" ? "[object Object]" : u) == "[object Object]", c = (f = f == "[object Arguments]" ? "[object Object]" : f) == "[object Object]", h = u == f;
  if (h && _u(r)) {
    if (!_u(t))
      return !1;
    o = !0, l = !1;
  }
  if (h && !l)
    return a || (a = new kf()), o || gh(r) ? q3(r, t, e, n, i, a) : Ane(r, t, u, e, n, i, a);
  if (!(1 & e)) {
    var d = l && lM.call(r, "__wrapped__"), v = c && lM.call(t, "__wrapped__");
    if (d || v) {
      var p = d ? r.value() : r, g = v ? t.value() : t;
      return a || (a = new kf()), i(p, g, e, n, a);
    }
  }
  return !!h && (a || (a = new kf()), Pne(r, t, e, n, i, a));
}, Z3 = function r(t, e, n, i, a) {
  return t === e || (t == null || e == null || !ia(t) && !ia(e) ? t != t && e != e : One(t, e, n, i, r, a));
}, Dne = function(r, t, e, n) {
  var i = e.length, a = i, o = !n;
  if (r == null)
    return !a;
  for (r = Object(r); i--; ) {
    var s = e[i];
    if (o && s[2] ? s[1] !== r[s[0]] : !(s[0] in r))
      return !1;
  }
  for (; ++i < a; ) {
    var u = (s = e[i])[0], f = r[u], l = s[1];
    if (o && s[2]) {
      if (f === void 0 && !(u in r))
        return !1;
    } else {
      var c = new kf();
      if (n)
        var h = n(f, l, u, r, t, c);
      if (!(h === void 0 ? Z3(l, f, 3, n, c) : h))
        return !1;
    }
  }
  return !0;
}, Q3 = function(r) {
  return r == r && !li(r);
}, kne = function(r) {
  for (var t = ws(r), e = t.length; e--; ) {
    var n = t[e], i = r[n];
    t[e] = [n, i, Q3(i)];
  }
  return t;
}, J3 = function(r, t) {
  return function(e) {
    return e != null && e[r] === t && (t !== void 0 || r in Object(e));
  };
}, Lne = function(r) {
  var t = kne(r);
  return t.length == 1 && t[0][2] ? J3(t[0][0], t[0][1]) : function(e) {
    return e === r || Dne(e, r, t);
  };
}, Eu = function(r) {
  return typeof r == "symbol" || ia(r) && _s(r) == "[object Symbol]";
}, Nne = /\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/, Rne = /^\w*$/, Px = function(r, t) {
  if (nn(r))
    return !1;
  var e = typeof r;
  return !(e != "number" && e != "symbol" && e != "boolean" && r != null && !Eu(r)) || Rne.test(r) || !Nne.test(r) || t != null && r in Object(t);
};
function Ox(r, t) {
  if (typeof r != "function" || t != null && typeof t != "function")
    throw new TypeError("Expected a function");
  var e = function() {
    var n = arguments, i = t ? t.apply(this, n) : n[0], a = e.cache;
    if (a.has(i))
      return a.get(i);
    var o = r.apply(this, n);
    return e.cache = a.set(i, o) || a, o;
  };
  return e.cache = new (Ox.Cache || sg)(), e;
}
Ox.Cache = sg;
var Bne = Ox, Gne = /[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g, Fne = /\\(\\)?/g, zne = function(r) {
  var t = Bne(r, function(n) {
    return e.size === 500 && e.clear(), n;
  }), e = t.cache;
  return t;
}(function(r) {
  var t = [];
  return r.charCodeAt(0) === 46 && t.push(""), r.replace(Gne, function(e, n, i, a) {
    t.push(i ? a.replace(Fne, "$1") : n || e);
  }), t;
}), Nf = function(r, t) {
  for (var e = -1, n = r == null ? 0 : r.length, i = Array(n); ++e < n; )
    i[e] = t(r[e], e, r);
  return i;
}, cM = ji ? ji.prototype : void 0, hM = cM ? cM.toString : void 0, Une = function r(t) {
  if (typeof t == "string")
    return t;
  if (nn(t))
    return Nf(t, r) + "";
  if (Eu(t))
    return hM ? hM.call(t) : "";
  var e = t + "";
  return e == "0" && 1 / t == -1 / 0 ? "-0" : e;
}, eB = function(r) {
  return r == null ? "" : Une(r);
}, pg = function(r, t) {
  return nn(r) ? r : Px(r, t) ? [r] : zne(eB(r));
}, yh = function(r) {
  if (typeof r == "string" || Eu(r))
    return r;
  var t = r + "";
  return t == "0" && 1 / r == -1 / 0 ? "-0" : t;
}, gg = function(r, t) {
  for (var e = 0, n = (t = pg(t, r)).length; r != null && e < n; )
    r = r[yh(t[e++])];
  return e && e == n ? r : void 0;
}, jne = function(r, t, e) {
  var n = r == null ? void 0 : gg(r, t);
  return n === void 0 ? e : n;
}, $ne = function(r, t) {
  return r != null && t in Object(r);
}, tB = function(r, t, e) {
  for (var n = -1, i = (t = pg(t, r)).length, a = !1; ++n < i; ) {
    var o = yh(t[n]);
    if (!(a = r != null && e(r, o)))
      break;
    r = r[o];
  }
  return a || ++n != i ? a : !!(i = r == null ? 0 : r.length) && _x(i) && lg(o, i) && (nn(r) || qf(r));
}, rB = function(r, t) {
  return r != null && tB(r, t, $ne);
}, Wne = function(r, t) {
  return Px(r) && Q3(t) ? J3(yh(r), t) : function(e) {
    var n = jne(e, r);
    return n === void 0 && n === t ? rB(e, r) : Z3(t, n, 3);
  };
}, nB = function(r) {
  return function(t) {
    return t == null ? void 0 : t[r];
  };
}, Vne = function(r) {
  return function(t) {
    return gg(t, r);
  };
}, Xne = function(r) {
  return Px(r) ? nB(yh(r)) : Vne(r);
}, Do = function(r) {
  return typeof r == "function" ? r : r == null ? Ou : typeof r == "object" ? nn(r) ? Wne(r[0], r[1]) : Lne(r) : Xne(r);
}, iB = function(r, t) {
  return (nn(r) ? B3 : Ene)(r, Do(t));
}, Yne = Object.prototype.hasOwnProperty, Hne = function(r, t) {
  return r != null && Yne.call(r, t);
}, aB = function(r, t) {
  return r != null && tB(r, t, Hne);
}, Kne = Object.prototype.hasOwnProperty, qne = function(r) {
  if (r == null)
    return !0;
  if (Oo(r) && (nn(r) || typeof r == "string" || typeof r.splice == "function" || _u(r) || gh(r) || qf(r)))
    return !r.length;
  var t = wu(r);
  if (t == "[object Map]" || t == "[object Set]")
    return !r.size;
  if (hg(r))
    return !wx(r).length;
  for (var e in r)
    if (Kne.call(r, e))
      return !1;
  return !0;
}, oB = function(r) {
  return r === void 0;
}, sB = function(r, t) {
  var e = -1, n = Oo(r) ? Array(r.length) : [];
  return vg(r, function(i, a, o) {
    n[++e] = t(i, a, o);
  }), n;
}, uB = function(r, t) {
  return (nn(r) ? Nf : sB)(r, Do(t));
}, Zne = function(r, t, e, n) {
  var i = -1, a = r == null ? 0 : r.length;
  for (n && a && (e = r[++i]); ++i < a; )
    e = t(e, r[i], i, r);
  return e;
}, Qne = function(r, t, e, n, i) {
  return i(r, function(a, o, s) {
    e = n ? (n = !1, a) : t(e, a, o, s);
  }), e;
}, fB = function(r, t, e) {
  var n = nn(r) ? Zne : Qne, i = arguments.length < 3;
  return n(r, Do(t), e, i, vg);
}, Jne = function(r) {
  return typeof r == "string" || !nn(r) && ia(r) && _s(r) == "[object String]";
}, eie = nB("length"), tie = RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]"), rie = function(r) {
  return tie.test(r);
}, nie = "[\\ud800-\\udfff]", a1 = "[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]", o1 = "\\ud83c[\\udffb-\\udfff]", lB = "[^\\ud800-\\udfff]", cB = "(?:\\ud83c[\\udde6-\\uddff]){2}", hB = "[\\ud800-\\udbff][\\udc00-\\udfff]", dM = "(?:" + a1 + "|" + o1 + ")?", iie = "[\\ufe0e\\ufe0f]?" + dM + ("(?:\\u200d(?:" + [lB, cB, hB].join("|") + ")[\\ufe0e\\ufe0f]?" + dM + ")*"), aie = "(?:" + [lB + a1 + "?", a1, cB, hB, nie].join("|") + ")", vM = RegExp(o1 + "(?=" + o1 + ")|" + aie + iie, "g"), oie = function(r) {
  for (var t = vM.lastIndex = 0; vM.test(r); )
    ++t;
  return t;
}, sie = function(r) {
  return rie(r) ? oie(r) : eie(r);
}, uie = function(r) {
  if (r == null)
    return 0;
  if (Oo(r))
    return Jne(r) ? sie(r) : r.length;
  var t = wu(r);
  return t == "[object Map]" || t == "[object Set]" ? r.size : wx(r).length;
}, fie = function(r, t, e) {
  var n = nn(r), i = n || _u(r) || gh(r);
  if (t = Do(t), e == null) {
    var a = r && r.constructor;
    e = i ? n ? new a() : [] : li(r) && vh(a) ? j3(dg(r)) : {};
  }
  return (i ? xx : Ax)(r, function(o, s, u) {
    return t(e, o, s, u);
  }), e;
}, pM = ji ? ji.isConcatSpreadable : void 0, lie = function(r) {
  return nn(r) || qf(r) || !!(pM && r && r[pM]);
}, Dx = function r(t, e, n, i, a) {
  var o = -1, s = t.length;
  for (n || (n = lie), a || (a = []); ++o < s; ) {
    var u = t[o];
    e > 0 && n(u) ? e > 1 ? r(u, e - 1, n, i, a) : Sx(a, u) : i || (a[a.length] = u);
  }
  return a;
}, cie = function(r, t, e) {
  switch (e.length) {
    case 0:
      return r.call(t);
    case 1:
      return r.call(t, e[0]);
    case 2:
      return r.call(t, e[0], e[1]);
    case 3:
      return r.call(t, e[0], e[1], e[2]);
  }
  return r.apply(t, e);
}, gM = Math.max, dB = function(r, t, e) {
  return t = gM(t === void 0 ? r.length - 1 : t, 0), function() {
    for (var n = arguments, i = -1, a = gM(n.length - t, 0), o = Array(a); ++i < a; )
      o[i] = n[t + i];
    i = -1;
    for (var s = Array(t + 1); ++i < t; )
      s[i] = n[i];
    return s[t] = e(o), cie(r, this, s);
  };
}, hie = fp ? function(r, t) {
  return fp(r, "toString", { configurable: !0, enumerable: !1, value: Cx(t), writable: !0 });
} : Ou, die = Date.now, vB = function(r) {
  var t = 0, e = 0;
  return function() {
    var n = die(), i = 16 - (n - e);
    if (e = n, i > 0) {
      if (++t >= 800)
        return arguments[0];
    } else
      t = 0;
    return r.apply(void 0, arguments);
  };
}(hie), yg = function(r, t) {
  return vB(dB(r, t, Ou), r + "");
}, pB = function(r, t, e, n) {
  for (var i = r.length, a = e + (n ? 1 : -1); n ? a-- : ++a < i; )
    if (t(r[a], a, r))
      return a;
  return -1;
}, vie = function(r) {
  return r != r;
}, pie = function(r, t, e) {
  for (var n = e - 1, i = r.length; ++n < i; )
    if (r[n] === t)
      return n;
  return -1;
}, gie = function(r, t, e) {
  return t == t ? pie(r, t, e) : pB(r, vie, e);
}, yie = function(r, t) {
  return !!(r != null && r.length) && gie(r, t, 0) > -1;
}, mie = function(r, t, e) {
  for (var n = -1, i = r == null ? 0 : r.length; ++n < i; )
    if (e(t, r[n]))
      return !0;
  return !1;
}, bie = function() {
}, xie = Lf && 1 / Ix(new Lf([, -0]))[1] == 1 / 0 ? function(r) {
  return new Lf(r);
} : bie, _ie = function(r, t, e) {
  var n = -1, i = yie, a = r.length, o = !0, s = [], u = s;
  if (e)
    o = !1, i = mie;
  else if (a >= 200) {
    var f = t ? null : xie(r);
    if (f)
      return Ix(f);
    o = !1, i = K3, u = new H3();
  } else
    u = t ? [] : s;
  e:
    for (; ++n < a; ) {
      var l = r[n], c = t ? t(l) : l;
      if (l = e || l !== 0 ? l : 0, o && c == c) {
        for (var h = u.length; h--; )
          if (u[h] === c)
            continue e;
        t && u.push(c), s.push(l);
      } else
        i(u, c, e) || (u !== s && u.push(c), s.push(l));
    }
  return s;
}, gB = function(r) {
  return ia(r) && Oo(r);
}, wie = yg(function(r) {
  return _ie(Dx(r, 1, gB, !0));
}), Eie = function(r, t) {
  return Nf(t, function(e) {
    return r[e];
  });
}, cp, yB = function(r) {
  return r == null ? [] : Eie(r, ws(r));
};
try {
  cp = { clone: wne, constant: Cx, each: Y3, filter: iB, has: aB, isArray: nn, isEmpty: qne, isFunction: vh, isUndefined: oB, keys: ws, map: uB, reduce: fB, size: uie, transform: fie, union: wie, values: yB };
} catch {
}
cp || (cp = window._);
var wt = cp, kx = br;
function br(r) {
  this._isDirected = !wt.has(r, "directed") || r.directed, this._isMultigraph = !!wt.has(r, "multigraph") && r.multigraph, this._isCompound = !!wt.has(r, "compound") && r.compound, this._label = void 0, this._defaultNodeLabelFn = wt.constant(void 0), this._defaultEdgeLabelFn = wt.constant(void 0), this._nodes = {}, this._isCompound && (this._parent = {}, this._children = {}, this._children["\0"] = {}), this._in = {}, this._preds = {}, this._out = {}, this._sucs = {}, this._edgeObjs = {}, this._edgeLabels = {};
}
function yM(r, t) {
  r[t] ? r[t]++ : r[t] = 1;
}
function mM(r, t) {
  --r[t] || delete r[t];
}
function fc(r, t, e, n) {
  var i = "" + t, a = "" + e;
  if (!r && i > a) {
    var o = i;
    i = a, a = o;
  }
  return i + "" + a + "" + (wt.isUndefined(n) ? "\0" : n);
}
function Sie(r, t, e, n) {
  var i = "" + t, a = "" + e;
  if (!r && i > a) {
    var o = i;
    i = a, a = o;
  }
  var s = { v: i, w: a };
  return n && (s.name = n), s;
}
function my(r, t) {
  return fc(r, t.v, t.w, t.name);
}
br.prototype._nodeCount = 0, br.prototype._edgeCount = 0, br.prototype.isDirected = function() {
  return this._isDirected;
}, br.prototype.isMultigraph = function() {
  return this._isMultigraph;
}, br.prototype.isCompound = function() {
  return this._isCompound;
}, br.prototype.setGraph = function(r) {
  return this._label = r, this;
}, br.prototype.graph = function() {
  return this._label;
}, br.prototype.setDefaultNodeLabel = function(r) {
  return wt.isFunction(r) || (r = wt.constant(r)), this._defaultNodeLabelFn = r, this;
}, br.prototype.nodeCount = function() {
  return this._nodeCount;
}, br.prototype.nodes = function() {
  return wt.keys(this._nodes);
}, br.prototype.sources = function() {
  var r = this;
  return wt.filter(this.nodes(), function(t) {
    return wt.isEmpty(r._in[t]);
  });
}, br.prototype.sinks = function() {
  var r = this;
  return wt.filter(this.nodes(), function(t) {
    return wt.isEmpty(r._out[t]);
  });
}, br.prototype.setNodes = function(r, t) {
  var e = arguments, n = this;
  return wt.each(r, function(i) {
    e.length > 1 ? n.setNode(i, t) : n.setNode(i);
  }), this;
}, br.prototype.setNode = function(r, t) {
  return wt.has(this._nodes, r) ? (arguments.length > 1 && (this._nodes[r] = t), this) : (this._nodes[r] = arguments.length > 1 ? t : this._defaultNodeLabelFn(r), this._isCompound && (this._parent[r] = "\0", this._children[r] = {}, this._children["\0"][r] = !0), this._in[r] = {}, this._preds[r] = {}, this._out[r] = {}, this._sucs[r] = {}, ++this._nodeCount, this);
}, br.prototype.node = function(r) {
  return this._nodes[r];
}, br.prototype.hasNode = function(r) {
  return wt.has(this._nodes, r);
}, br.prototype.removeNode = function(r) {
  var t = this;
  if (wt.has(this._nodes, r)) {
    var e = function(n) {
      t.removeEdge(t._edgeObjs[n]);
    };
    delete this._nodes[r], this._isCompound && (this._removeFromParentsChildList(r), delete this._parent[r], wt.each(this.children(r), function(n) {
      t.setParent(n);
    }), delete this._children[r]), wt.each(wt.keys(this._in[r]), e), delete this._in[r], delete this._preds[r], wt.each(wt.keys(this._out[r]), e), delete this._out[r], delete this._sucs[r], --this._nodeCount;
  }
  return this;
}, br.prototype.setParent = function(r, t) {
  if (!this._isCompound)
    throw new Error("Cannot set parent in a non-compound graph");
  if (wt.isUndefined(t))
    t = "\0";
  else {
    for (var e = t += ""; !wt.isUndefined(e); e = this.parent(e))
      if (e === r)
        throw new Error("Setting " + t + " as parent of " + r + " would create a cycle");
    this.setNode(t);
  }
  return this.setNode(r), this._removeFromParentsChildList(r), this._parent[r] = t, this._children[t][r] = !0, this;
}, br.prototype._removeFromParentsChildList = function(r) {
  delete this._children[this._parent[r]][r];
}, br.prototype.parent = function(r) {
  if (this._isCompound) {
    var t = this._parent[r];
    if (t !== "\0")
      return t;
  }
}, br.prototype.children = function(r) {
  if (wt.isUndefined(r) && (r = "\0"), this._isCompound) {
    var t = this._children[r];
    if (t)
      return wt.keys(t);
  } else {
    if (r === "\0")
      return this.nodes();
    if (this.hasNode(r))
      return [];
  }
}, br.prototype.predecessors = function(r) {
  var t = this._preds[r];
  if (t)
    return wt.keys(t);
}, br.prototype.successors = function(r) {
  var t = this._sucs[r];
  if (t)
    return wt.keys(t);
}, br.prototype.neighbors = function(r) {
  var t = this.predecessors(r);
  if (t)
    return wt.union(t, this.successors(r));
}, br.prototype.isLeaf = function(r) {
  return (this.isDirected() ? this.successors(r) : this.neighbors(r)).length === 0;
}, br.prototype.filterNodes = function(r) {
  var t = new this.constructor({ directed: this._isDirected, multigraph: this._isMultigraph, compound: this._isCompound });
  t.setGraph(this.graph());
  var e = this;
  wt.each(this._nodes, function(a, o) {
    r(o) && t.setNode(o, a);
  }), wt.each(this._edgeObjs, function(a) {
    t.hasNode(a.v) && t.hasNode(a.w) && t.setEdge(a, e.edge(a));
  });
  var n = {};
  function i(a) {
    var o = e.parent(a);
    return o === void 0 || t.hasNode(o) ? (n[a] = o, o) : o in n ? n[o] : i(o);
  }
  return this._isCompound && wt.each(t.nodes(), function(a) {
    t.setParent(a, i(a));
  }), t;
}, br.prototype.setDefaultEdgeLabel = function(r) {
  return wt.isFunction(r) || (r = wt.constant(r)), this._defaultEdgeLabelFn = r, this;
}, br.prototype.edgeCount = function() {
  return this._edgeCount;
}, br.prototype.edges = function() {
  return wt.values(this._edgeObjs);
}, br.prototype.setPath = function(r, t) {
  var e = this, n = arguments;
  return wt.reduce(r, function(i, a) {
    return n.length > 1 ? e.setEdge(i, a, t) : e.setEdge(i, a), a;
  }), this;
}, br.prototype.setEdge = function() {
  var r, t, e, n, i = !1, a = arguments[0];
  typeof a == "object" && a !== null && "v" in a ? (r = a.v, t = a.w, e = a.name, arguments.length === 2 && (n = arguments[1], i = !0)) : (r = a, t = arguments[1], e = arguments[3], arguments.length > 2 && (n = arguments[2], i = !0)), r = "" + r, t = "" + t, wt.isUndefined(e) || (e = "" + e);
  var o = fc(this._isDirected, r, t, e);
  if (wt.has(this._edgeLabels, o))
    return i && (this._edgeLabels[o] = n), this;
  if (!wt.isUndefined(e) && !this._isMultigraph)
    throw new Error("Cannot set a named edge when isMultigraph = false");
  this.setNode(r), this.setNode(t), this._edgeLabels[o] = i ? n : this._defaultEdgeLabelFn(r, t, e);
  var s = Sie(this._isDirected, r, t, e);
  return r = s.v, t = s.w, Object.freeze(s), this._edgeObjs[o] = s, yM(this._preds[t], r), yM(this._sucs[r], t), this._in[t][o] = s, this._out[r][o] = s, this._edgeCount++, this;
}, br.prototype.edge = function(r, t, e) {
  var n = arguments.length === 1 ? my(this._isDirected, arguments[0]) : fc(this._isDirected, r, t, e);
  return this._edgeLabels[n];
}, br.prototype.hasEdge = function(r, t, e) {
  var n = arguments.length === 1 ? my(this._isDirected, arguments[0]) : fc(this._isDirected, r, t, e);
  return wt.has(this._edgeLabels, n);
}, br.prototype.removeEdge = function(r, t, e) {
  var n = arguments.length === 1 ? my(this._isDirected, arguments[0]) : fc(this._isDirected, r, t, e), i = this._edgeObjs[n];
  return i && (r = i.v, t = i.w, delete this._edgeLabels[n], delete this._edgeObjs[n], mM(this._preds[t], r), mM(this._sucs[r], t), delete this._in[t][n], delete this._out[r][n], this._edgeCount--), this;
}, br.prototype.inEdges = function(r, t) {
  var e = this._in[r];
  if (e) {
    var n = wt.values(e);
    return t ? wt.filter(n, function(i) {
      return i.v === t;
    }) : n;
  }
}, br.prototype.outEdges = function(r, t) {
  var e = this._out[r];
  if (e) {
    var n = wt.values(e);
    return t ? wt.filter(n, function(i) {
      return i.w === t;
    }) : n;
  }
}, br.prototype.nodeEdges = function(r, t) {
  var e = this.inEdges(r, t);
  if (e)
    return e.concat(this.outEdges(r, t));
};
var bM = { Graph: kx, version: "2.1.8" }, Mie = { write: function(r) {
  var t = { options: { directed: r.isDirected(), multigraph: r.isMultigraph(), compound: r.isCompound() }, nodes: Cie(r), edges: Tie(r) };
  return wt.isUndefined(r.graph()) || (t.value = wt.clone(r.graph())), t;
}, read: function(r) {
  var t = new kx(r.options).setGraph(r.value);
  return wt.each(r.nodes, function(e) {
    t.setNode(e.v, e.value), e.parent && t.setParent(e.v, e.parent);
  }), wt.each(r.edges, function(e) {
    t.setEdge({ v: e.v, w: e.w, name: e.name }, e.value);
  }), t;
} };
function Cie(r) {
  return wt.map(r.nodes(), function(t) {
    var e = r.node(t), n = r.parent(t), i = { v: t };
    return wt.isUndefined(e) || (i.value = e), wt.isUndefined(n) || (i.parent = n), i;
  });
}
function Tie(r) {
  return wt.map(r.edges(), function(t) {
    var e = r.edge(t), n = { v: t.v, w: t.w };
    return wt.isUndefined(t.name) || (n.name = t.name), wt.isUndefined(e) || (n.value = e), n;
  });
}
var Aie = function(r) {
  var t, e = {}, n = [];
  function i(a) {
    wt.has(e, a) || (e[a] = !0, t.push(a), wt.each(r.successors(a), i), wt.each(r.predecessors(a), i));
  }
  return wt.each(r.nodes(), function(a) {
    t = [], i(a), t.length && n.push(t);
  }), n;
}, mB = Di;
function Di() {
  this._arr = [], this._keyIndices = {};
}
Di.prototype.size = function() {
  return this._arr.length;
}, Di.prototype.keys = function() {
  return this._arr.map(function(r) {
    return r.key;
  });
}, Di.prototype.has = function(r) {
  return wt.has(this._keyIndices, r);
}, Di.prototype.priority = function(r) {
  var t = this._keyIndices[r];
  if (t !== void 0)
    return this._arr[t].priority;
}, Di.prototype.min = function() {
  if (this.size() === 0)
    throw new Error("Queue underflow");
  return this._arr[0].key;
}, Di.prototype.add = function(r, t) {
  var e = this._keyIndices;
  if (r = String(r), !wt.has(e, r)) {
    var n = this._arr, i = n.length;
    return e[r] = i, n.push({ key: r, priority: t }), this._decrease(i), !0;
  }
  return !1;
}, Di.prototype.removeMin = function() {
  this._swap(0, this._arr.length - 1);
  var r = this._arr.pop();
  return delete this._keyIndices[r.key], this._heapify(0), r.key;
}, Di.prototype.decrease = function(r, t) {
  var e = this._keyIndices[r];
  if (t > this._arr[e].priority)
    throw new Error("New priority is greater than current priority. Key: " + r + " Old: " + this._arr[e].priority + " New: " + t);
  this._arr[e].priority = t, this._decrease(e);
}, Di.prototype._heapify = function(r) {
  var t = this._arr, e = 2 * r, n = e + 1, i = r;
  e < t.length && (i = t[e].priority < t[i].priority ? e : i, n < t.length && (i = t[n].priority < t[i].priority ? n : i), i !== r && (this._swap(r, i), this._heapify(i)));
}, Di.prototype._decrease = function(r) {
  for (var t, e = this._arr, n = e[r].priority; r !== 0 && !(e[t = r >> 1].priority < n); )
    this._swap(r, t), r = t;
}, Di.prototype._swap = function(r, t) {
  var e = this._arr, n = this._keyIndices, i = e[r], a = e[t];
  e[r] = a, e[t] = i, n[a.key] = r, n[i.key] = t;
};
var bB = function(r, t, e, n) {
  return function(i, a, o, s) {
    var u, f, l = {}, c = new mB(), h = function(d) {
      var v = d.v !== u ? d.v : d.w, p = l[v], g = o(d), y = f.distance + g;
      if (g < 0)
        throw new Error("dijkstra does not allow negative edge weights. Bad edge: " + d + " Weight: " + g);
      y < p.distance && (p.distance = y, p.predecessor = u, c.decrease(v, y));
    };
    for (i.nodes().forEach(function(d) {
      var v = d === a ? 0 : Number.POSITIVE_INFINITY;
      l[d] = { distance: v }, c.add(d, v);
    }); c.size() > 0 && (u = c.removeMin(), (f = l[u]).distance !== Number.POSITIVE_INFINITY); )
      s(u).forEach(h);
    return l;
  }(r, String(t), e || Iie, n || function(i) {
    return r.outEdges(i);
  });
}, Iie = wt.constant(1), Pie = function(r, t, e) {
  return wt.transform(r.nodes(), function(n, i) {
    n[i] = bB(r, i, t, e);
  }, {});
}, xB = function(r) {
  var t = 0, e = [], n = {}, i = [];
  function a(o) {
    var s = n[o] = { onStack: !0, lowlink: t, index: t++ };
    if (e.push(o), r.successors(o).forEach(function(l) {
      wt.has(n, l) ? n[l].onStack && (s.lowlink = Math.min(s.lowlink, n[l].index)) : (a(l), s.lowlink = Math.min(s.lowlink, n[l].lowlink));
    }), s.lowlink === s.index) {
      var u, f = [];
      do
        u = e.pop(), n[u].onStack = !1, f.push(u);
      while (o !== u);
      i.push(f);
    }
  }
  return r.nodes().forEach(function(o) {
    wt.has(n, o) || a(o);
  }), i;
}, Oie = function(r) {
  return wt.filter(xB(r), function(t) {
    return t.length > 1 || t.length === 1 && r.hasEdge(t[0], t[0]);
  });
}, Die = function(r, t, e) {
  return function(n, i, a) {
    var o = {}, s = n.nodes();
    return s.forEach(function(u) {
      o[u] = {}, o[u][u] = { distance: 0 }, s.forEach(function(f) {
        u !== f && (o[u][f] = { distance: Number.POSITIVE_INFINITY });
      }), a(u).forEach(function(f) {
        var l = f.v === u ? f.w : f.v, c = i(f);
        o[u][l] = { distance: c, predecessor: u };
      });
    }), s.forEach(function(u) {
      var f = o[u];
      s.forEach(function(l) {
        var c = o[l];
        s.forEach(function(h) {
          var d = c[u], v = f[h], p = c[h], g = d.distance + v.distance;
          g < p.distance && (p.distance = g, p.predecessor = v.predecessor);
        });
      });
    }), o;
  }(r, t || kie, e || function(n) {
    return r.outEdges(n);
  });
}, kie = wt.constant(1), by = _B;
function _B(r) {
  var t = {}, e = {}, n = [];
  if (wt.each(r.sinks(), function i(a) {
    if (wt.has(e, a))
      throw new hp();
    wt.has(t, a) || (e[a] = !0, t[a] = !0, wt.each(r.predecessors(a), i), delete e[a], n.push(a));
  }), wt.size(t) !== r.nodeCount())
    throw new hp();
  return n;
}
function hp() {
}
_B.CycleException = hp, hp.prototype = new Error();
var xM = function(r, t, e) {
  wt.isArray(t) || (t = [t]);
  var n = (r.isDirected() ? r.successors : r.neighbors).bind(r), i = [], a = {};
  return wt.each(t, function(o) {
    if (!r.hasNode(o))
      throw new Error("Graph does not have node: " + o);
    wB(r, o, e === "post", a, n, i);
  }), i;
};
function wB(r, t, e, n, i, a) {
  wt.has(n, t) || (n[t] = !0, e || a.push(t), wt.each(i(t), function(o) {
    wB(r, o, e, n, i, a);
  }), e && a.push(t));
}
var dp, Lie = { Graph: bM.Graph, json: Mie, alg: { components: Aie, dijkstra: bB, dijkstraAll: Pie, findCycles: Oie, floydWarshall: Die, isAcyclic: function(r) {
  try {
    by(r);
  } catch (t) {
    if (t instanceof by.CycleException)
      return !1;
    throw t;
  }
  return !0;
}, postorder: function(r, t) {
  return xM(r, t, "post");
}, preorder: function(r, t) {
  return xM(r, t, "pre");
}, prim: function(r, t) {
  var e, n = new kx(), i = {}, a = new mB();
  function o(u) {
    var f = u.v === e ? u.w : u.v, l = a.priority(f);
    if (l !== void 0) {
      var c = t(u);
      c < l && (i[f] = e, a.decrease(f, c));
    }
  }
  if (r.nodeCount() === 0)
    return n;
  wt.each(r.nodes(), function(u) {
    a.add(u, Number.POSITIVE_INFINITY), n.setNode(u);
  }), a.decrease(r.nodes()[0], 0);
  for (var s = !1; a.size() > 0; ) {
    if (e = a.removeMin(), wt.has(i, e))
      n.setEdge(e, i[e]);
    else {
      if (s)
        throw new Error("Input graph is not connected: " + r);
      s = !0;
    }
    r.nodeEdges(e).forEach(o);
  }
  return n;
}, tarjan: xB, topsort: by }, version: bM.version };
try {
  dp = Lie;
} catch {
}
dp || (dp = window.graphlib);
var ua = dp, Nie = function(r) {
  return W3(r, 5);
}, Xc = function(r, t, e) {
  if (!li(e))
    return !1;
  var n = typeof t;
  return !!(n == "number" ? Oo(e) && lg(t, e.length) : n == "string" && t in e) && ol(e[t], r);
}, EB = Object.prototype, Rie = EB.hasOwnProperty, Bie = yg(function(r, t) {
  r = Object(r);
  var e = -1, n = t.length, i = n > 2 ? t[2] : void 0;
  for (i && Xc(t[0], t[1], i) && (n = 1); ++e < n; )
    for (var a = t[e], o = Pu(a), s = -1, u = o.length; ++s < u; ) {
      var f = o[s], l = r[f];
      (l === void 0 || ol(l, EB[f]) && !Rie.call(r, f)) && (r[f] = a[f]);
    }
  return r;
}), Gie = function(r) {
  return function(t, e, n) {
    var i = Object(t);
    if (!Oo(t)) {
      var a = Do(e);
      t = ws(t), e = function(s) {
        return a(i[s], s, i);
      };
    }
    var o = r(t, e, n);
    return o > -1 ? i[a ? t[o] : o] : void 0;
  };
}, Fie = /^\s+|\s+$/g, zie = /^[-+]0x[0-9a-f]+$/i, Uie = /^0b[01]+$/i, jie = /^0o[0-7]+$/i, $ie = parseInt, Wie = function(r) {
  if (typeof r == "number")
    return r;
  if (Eu(r))
    return NaN;
  if (li(r)) {
    var t = typeof r.valueOf == "function" ? r.valueOf() : r;
    r = li(t) ? t + "" : t;
  }
  if (typeof r != "string")
    return r === 0 ? r : +r;
  r = r.replace(Fie, "");
  var e = Uie.test(r);
  return e || jie.test(r) ? $ie(r.slice(2), e ? 2 : 8) : zie.test(r) ? NaN : +r;
}, Mv = function(r) {
  return r ? (r = Wie(r)) === 1 / 0 || r === -1 / 0 ? 17976931348623157e292 * (r < 0 ? -1 : 1) : r == r ? r : 0 : r === 0 ? r : 0;
}, Vie = function(r) {
  var t = Mv(r), e = t % 1;
  return t == t ? e ? t - e : t : 0;
}, Xie = Math.max, Yie = Gie(function(r, t, e) {
  var n = r == null ? 0 : r.length;
  if (!n)
    return -1;
  var i = e == null ? 0 : Vie(e);
  return i < 0 && (i = Xie(n + i, 0)), pB(r, Do(t), i);
}), SB = function(r) {
  return r != null && r.length ? Dx(r, 1) : [];
}, Hie = function(r, t) {
  return r == null ? r : Tx(r, V3(t), Pu);
}, Kie = function(r) {
  var t = r == null ? 0 : r.length;
  return t ? r[t - 1] : void 0;
}, qie = function(r, t) {
  var e = {};
  return t = Do(t), Ax(r, function(n, i, a) {
    ug(e, i, t(n, i, a));
  }), e;
}, Lx = function(r, t, e) {
  for (var n = -1, i = r.length; ++n < i; ) {
    var a = r[n], o = t(a);
    if (o != null && (s === void 0 ? o == o && !Eu(o) : e(o, s)))
      var s = o, u = a;
  }
  return u;
}, Zie = function(r, t) {
  return r > t;
}, Qie = function(r) {
  return r && r.length ? Lx(r, Ou, Zie) : void 0;
}, s1 = function(r, t, e) {
  (e !== void 0 && !ol(r[t], e) || e === void 0 && !(t in r)) && ug(r, t, e);
}, Jie = Function.prototype, eae = Object.prototype, MB = Jie.toString, tae = eae.hasOwnProperty, rae = MB.call(Object), nae = function(r) {
  if (!ia(r) || _s(r) != "[object Object]")
    return !1;
  var t = dg(r);
  if (t === null)
    return !0;
  var e = tae.call(t, "constructor") && t.constructor;
  return typeof e == "function" && e instanceof e && MB.call(e) == rae;
}, u1 = function(r, t) {
  if ((t !== "constructor" || typeof r[t] != "function") && t != "__proto__")
    return r[t];
}, iae = function(r) {
  return ph(r, Pu(r));
}, aae = function(r, t, e, n, i, a, o) {
  var s = u1(r, e), u = u1(t, e), f = o.get(u);
  if (f)
    s1(r, e, f);
  else {
    var l = a ? a(s, u, e + "", r, t, o) : void 0, c = l === void 0;
    if (c) {
      var h = nn(u), d = !h && _u(u), v = !h && !d && gh(u);
      l = u, h || d || v ? nn(s) ? l = s : gB(s) ? l = R3(s) : d ? (c = !1, l = N3(u, !0)) : v ? (c = !1, l = U3(u, !0)) : l = [] : nae(u) || qf(u) ? (l = s, qf(s) ? l = iae(s) : li(s) && !vh(s) || (l = $3(u))) : c = !1;
    }
    c && (o.set(u, l), i(l, u, n, a, o), o.delete(u)), s1(r, e, l);
  }
}, oae = function r(t, e, n, i, a) {
  t !== e && Tx(e, function(o, s) {
    if (a || (a = new kf()), li(o))
      aae(t, e, s, n, r, i, a);
    else {
      var u = i ? i(u1(t, s), o, s + "", t, e, a) : void 0;
      u === void 0 && (u = o), s1(t, s, u);
    }
  }, Pu);
}, sae = function(r) {
  return yg(function(t, e) {
    var n = -1, i = e.length, a = i > 1 ? e[i - 1] : void 0, o = i > 2 ? e[2] : void 0;
    for (a = r.length > 3 && typeof a == "function" ? (i--, a) : void 0, o && Xc(e[0], e[1], o) && (a = i < 3 ? void 0 : a, i = 1), t = Object(t); ++n < i; ) {
      var s = e[n];
      s && r(t, s, n, a);
    }
    return t;
  });
}(function(r, t, e) {
  oae(r, t, e);
}), CB = function(r, t) {
  return r < t;
}, uae = function(r) {
  return r && r.length ? Lx(r, Ou, CB) : void 0;
}, fae = function(r, t) {
  return r && r.length ? Lx(r, Do(t), CB) : void 0;
}, lae = function() {
  return sa.Date.now();
}, cae = function(r, t, e, n) {
  if (!li(r))
    return r;
  for (var i = -1, a = (t = pg(t, r)).length, o = a - 1, s = r; s != null && ++i < a; ) {
    var u = yh(t[i]), f = e;
    if (u === "__proto__" || u === "constructor" || u === "prototype")
      return r;
    if (i != o) {
      var l = s[u];
      (f = n ? n(l, u, s) : void 0) === void 0 && (f = li(l) ? l : lg(t[i + 1]) ? [] : {});
    }
    fg(s, u, f), s = s[u];
  }
  return r;
}, hae = function(r, t, e) {
  for (var n = -1, i = t.length, a = {}; ++n < i; ) {
    var o = t[n], s = gg(r, o);
    e(s, o) && cae(a, pg(o, r), s);
  }
  return a;
}, dae = function(r, t) {
  return hae(r, t, function(e, n) {
    return rB(r, n);
  });
}, vae = function(r) {
  return vB(dB(r, void 0, SB), r + "");
}(function(r, t) {
  return r == null ? {} : dae(r, t);
}), pae = Math.ceil, gae = Math.max, yae = function(r, t, e, n) {
  for (var i = -1, a = gae(pae((t - r) / (e || 1)), 0), o = Array(a); a--; )
    o[n ? a : ++i] = r, r += e;
  return o;
}, mae = function(r) {
  return function(t, e, n) {
    return n && typeof n != "number" && Xc(t, e, n) && (e = n = void 0), t = Mv(t), e === void 0 ? (e = t, t = 0) : e = Mv(e), n = n === void 0 ? t < e ? 1 : -1 : Mv(n), yae(t, e, n, r);
  };
}(), bae = function(r, t) {
  var e = r.length;
  for (r.sort(t); e--; )
    r[e] = r[e].value;
  return r;
}, xae = function(r, t) {
  if (r !== t) {
    var e = r !== void 0, n = r === null, i = r == r, a = Eu(r), o = t !== void 0, s = t === null, u = t == t, f = Eu(t);
    if (!s && !f && !a && r > t || a && o && u && !s && !f || n && o && u || !e && u || !i)
      return 1;
    if (!n && !a && !f && r < t || f && e && i && !n && !a || s && e && i || !o && i || !u)
      return -1;
  }
  return 0;
}, _ae = function(r, t, e) {
  for (var n = -1, i = r.criteria, a = t.criteria, o = i.length, s = e.length; ++n < o; ) {
    var u = xae(i[n], a[n]);
    if (u)
      return n >= s ? u : u * (e[n] == "desc" ? -1 : 1);
  }
  return r.index - t.index;
}, wae = function(r, t, e) {
  t = t.length ? Nf(t, function(a) {
    return nn(a) ? function(o) {
      return gg(o, a.length === 1 ? a[0] : a);
    } : a;
  }) : [Ou];
  var n = -1;
  t = Nf(t, cg(Do));
  var i = sB(r, function(a, o, s) {
    return { criteria: Nf(t, function(u) {
      return u(a);
    }), index: ++n, value: a };
  });
  return bae(i, function(a, o) {
    return _ae(a, o, e);
  });
}, Eae = yg(function(r, t) {
  if (r == null)
    return [];
  var e = t.length;
  return e > 1 && Xc(r, t[0], t[1]) ? t = [] : e > 2 && Xc(t[0], t[1], t[2]) && (t = [t[0]]), wae(r, Dx(t, 1), []);
}), Sae = 0, Mae = function(r) {
  var t = ++Sae;
  return eB(r) + t;
}, Cae = function(r, t, e) {
  for (var n = -1, i = r.length, a = t.length, o = {}; ++n < i; ) {
    var s = n < a ? t[n] : void 0;
    e(o, r[n], s);
  }
  return o;
}, vp, Tae = function(r, t) {
  return Cae(r || [], t || [], fg);
};
try {
  vp = { cloneDeep: Nie, constant: Cx, defaults: Bie, each: Y3, filter: iB, find: Yie, flatten: SB, forEach: X3, forIn: Hie, has: aB, isUndefined: oB, last: Kie, map: uB, mapValues: qie, max: Qie, merge: sae, min: uae, minBy: fae, now: lae, pick: vae, range: mae, reduce: fB, sortBy: Eae, uniqueId: Mae, values: yB, zipObject: Tae };
} catch {
}
vp || (vp = window._);
var J = vp, Aae = Cv;
function Cv() {
  var r = {};
  r._next = r._prev = r, this._sentinel = r;
}
function _M(r) {
  r._prev._next = r._next, r._next._prev = r._prev, delete r._next, delete r._prev;
}
function Iae(r, t) {
  if (r !== "_next" && r !== "_prev")
    return t;
}
Cv.prototype.dequeue = function() {
  var r = this._sentinel, t = r._prev;
  if (t !== r)
    return _M(t), t;
}, Cv.prototype.enqueue = function(r) {
  var t = this._sentinel;
  r._prev && r._next && _M(r), r._next = t._next, t._next._prev = r, t._next = r, r._prev = t;
}, Cv.prototype.toString = function() {
  for (var r = [], t = this._sentinel, e = t._prev; e !== t; )
    r.push(JSON.stringify(e, Iae)), e = e._prev;
  return "[" + r.join(", ") + "]";
};
var Pae = ua.Graph, Oae = function(r, t) {
  if (r.nodeCount() <= 1)
    return [];
  var e = function(i, a) {
    var o = new Pae(), s = 0, u = 0;
    J.forEach(i.nodes(), function(c) {
      o.setNode(c, { v: c, in: 0, out: 0 });
    }), J.forEach(i.edges(), function(c) {
      var h = o.edge(c.v, c.w) || 0, d = a(c), v = h + d;
      o.setEdge(c.v, c.w, v), u = Math.max(u, o.node(c.v).out += d), s = Math.max(s, o.node(c.w).in += d);
    });
    var f = J.range(u + s + 3).map(function() {
      return new Aae();
    }), l = s + 1;
    return J.forEach(o.nodes(), function(c) {
      f1(f, l, o.node(c));
    }), { graph: o, buckets: f, zeroIdx: l };
  }(r, t || Dae), n = function(i, a, o) {
    for (var s, u = [], f = a[a.length - 1], l = a[0]; i.nodeCount(); ) {
      for (; s = l.dequeue(); )
        xy(i, a, o, s);
      for (; s = f.dequeue(); )
        xy(i, a, o, s);
      if (i.nodeCount()) {
        for (var c = a.length - 2; c > 0; --c)
          if (s = a[c].dequeue()) {
            u = u.concat(xy(i, a, o, s, !0));
            break;
          }
      }
    }
    return u;
  }(e.graph, e.buckets, e.zeroIdx);
  return J.flatten(J.map(n, function(i) {
    return r.outEdges(i.v, i.w);
  }), !0);
}, Dae = J.constant(1);
function xy(r, t, e, n, i) {
  var a = i ? [] : void 0;
  return J.forEach(r.inEdges(n.v), function(o) {
    var s = r.edge(o), u = r.node(o.v);
    i && a.push({ v: o.v, w: o.w }), u.out -= s, f1(t, e, u);
  }), J.forEach(r.outEdges(n.v), function(o) {
    var s = r.edge(o), u = o.w, f = r.node(u);
    f.in -= s, f1(t, e, f);
  }), r.removeNode(n.v), a;
}
function f1(r, t, e) {
  e.out ? e.in ? r[e.out - e.in + t].enqueue(e) : r[r.length - 1].enqueue(e) : r[0].enqueue(e);
}
var wM = { run: function(r) {
  var t = r.graph().acyclicer === "greedy" ? Oae(r, function(e) {
    return function(n) {
      return e.edge(n).weight;
    };
  }(r)) : function(e) {
    var n = [], i = {}, a = {};
    function o(s) {
      J.has(a, s) || (a[s] = !0, i[s] = !0, J.forEach(e.outEdges(s), function(u) {
        J.has(i, u.w) ? n.push(u) : o(u.w);
      }), delete i[s]);
    }
    return J.forEach(e.nodes(), o), n;
  }(r);
  J.forEach(t, function(e) {
    var n = r.edge(e);
    r.removeEdge(e), n.forwardName = e.name, n.reversed = !0, r.setEdge(e.w, e.v, n, J.uniqueId("rev"));
  });
}, undo: function(r) {
  J.forEach(r.edges(), function(t) {
    var e = r.edge(t);
    if (e.reversed) {
      r.removeEdge(t);
      var n = e.forwardName;
      delete e.reversed, delete e.forwardName, r.setEdge(t.w, t.v, e, n);
    }
  });
} }, EM = ua.Graph, Gn = { addDummyNode: SM, simplify: function(r) {
  var t = new EM().setGraph(r.graph());
  return J.forEach(r.nodes(), function(e) {
    t.setNode(e, r.node(e));
  }), J.forEach(r.edges(), function(e) {
    var n = t.edge(e.v, e.w) || { weight: 0, minlen: 1 }, i = r.edge(e);
    t.setEdge(e.v, e.w, { weight: n.weight + i.weight, minlen: Math.max(n.minlen, i.minlen) });
  }), t;
}, asNonCompoundGraph: function(r) {
  var t = new EM({ multigraph: r.isMultigraph() }).setGraph(r.graph());
  return J.forEach(r.nodes(), function(e) {
    r.children(e).length || t.setNode(e, r.node(e));
  }), J.forEach(r.edges(), function(e) {
    t.setEdge(e, r.edge(e));
  }), t;
}, successorWeights: function(r) {
  var t = J.map(r.nodes(), function(e) {
    var n = {};
    return J.forEach(r.outEdges(e), function(i) {
      n[i.w] = (n[i.w] || 0) + r.edge(i).weight;
    }), n;
  });
  return J.zipObject(r.nodes(), t);
}, predecessorWeights: function(r) {
  var t = J.map(r.nodes(), function(e) {
    var n = {};
    return J.forEach(r.inEdges(e), function(i) {
      n[i.v] = (n[i.v] || 0) + r.edge(i).weight;
    }), n;
  });
  return J.zipObject(r.nodes(), t);
}, intersectRect: function(r, t) {
  var e, n, i = r.x, a = r.y, o = t.x - i, s = t.y - a, u = r.width / 2, f = r.height / 2;
  if (!o && !s)
    throw new Error("Not possible to find intersection inside of the rectangle");
  return Math.abs(s) * u > Math.abs(o) * f ? (s < 0 && (f = -f), e = f * o / s, n = f) : (o < 0 && (u = -u), e = u, n = u * s / o), { x: i + e, y: a + n };
}, buildLayerMatrix: function(r) {
  var t = J.map(J.range(MM(r) + 1), function() {
    return [];
  });
  return J.forEach(r.nodes(), function(e) {
    var n = r.node(e), i = n.rank;
    J.isUndefined(i) || (t[i][n.order] = e);
  }), t;
}, normalizeRanks: function(r) {
  var t = J.min(J.map(r.nodes(), function(e) {
    return r.node(e).rank;
  }));
  J.forEach(r.nodes(), function(e) {
    var n = r.node(e);
    J.has(n, "rank") && (n.rank -= t);
  });
}, removeEmptyRanks: function(r) {
  var t = J.min(J.map(r.nodes(), function(a) {
    return r.node(a).rank;
  })), e = [];
  J.forEach(r.nodes(), function(a) {
    var o = r.node(a).rank - t;
    e[o] || (e[o] = []), e[o].push(a);
  });
  var n = 0, i = r.graph().nodeRankFactor;
  J.forEach(e, function(a, o) {
    J.isUndefined(a) && o % i != 0 ? --n : n && J.forEach(a, function(s) {
      r.node(s).rank += n;
    });
  });
}, addBorderNode: function(r, t, e, n) {
  var i = { width: 0, height: 0 };
  return arguments.length >= 4 && (i.rank = e, i.order = n), SM(r, "border", i, t);
}, maxRank: MM, partition: function(r, t) {
  var e = { lhs: [], rhs: [] };
  return J.forEach(r, function(n) {
    t(n) ? e.lhs.push(n) : e.rhs.push(n);
  }), e;
}, time: function(r, t) {
  var e = J.now();
  try {
    return t();
  } finally {
    console.log(r + " time: " + (J.now() - e) + "ms");
  }
}, notime: function(r, t) {
  return t();
} };
function SM(r, t, e, n) {
  var i;
  do
    i = J.uniqueId(n);
  while (r.hasNode(i));
  return e.dummy = t, r.setNode(i, e), i;
}
function MM(r) {
  return J.max(J.map(r.nodes(), function(t) {
    var e = r.node(t).rank;
    if (!J.isUndefined(e))
      return e;
  }));
}
var CM = { run: function(r) {
  r.graph().dummyChains = [], J.forEach(r.edges(), function(t) {
    (function(e, n) {
      var i, a, o, s = n.v, u = e.node(s).rank, f = n.w, l = e.node(f).rank, c = n.name, h = e.edge(n), d = h.labelRank;
      if (l !== u + 1) {
        for (e.removeEdge(n), o = 0, ++u; u < l; ++o, ++u)
          h.points = [], a = { width: 0, height: 0, edgeLabel: h, edgeObj: n, rank: u }, i = Gn.addDummyNode(e, "edge", a, "_d"), u === d && (a.width = h.width, a.height = h.height, a.dummy = "edge-label", a.labelpos = h.labelpos), e.setEdge(s, i, { weight: h.weight }, c), o === 0 && e.graph().dummyChains.push(i), s = i;
        e.setEdge(s, f, { weight: h.weight }, c);
      }
    })(r, t);
  });
}, undo: function(r) {
  J.forEach(r.graph().dummyChains, function(t) {
    var e, n = r.node(t), i = n.edgeLabel;
    for (r.setEdge(n.edgeObj, i); n.dummy; )
      e = r.successors(t)[0], r.removeNode(t), i.points.push({ x: n.x, y: n.y }), n.dummy === "edge-label" && (i.x = n.x, i.y = n.y, i.width = n.width, i.height = n.height), t = e, n = r.node(t);
  });
} }, TB = function(r) {
  var t = {};
  J.forEach(r.sources(), function e(n) {
    var i = r.node(n);
    if (J.has(t, n))
      return i.rank;
    t[n] = !0;
    var a = J.min(J.map(r.outEdges(n), function(o) {
      return e(o.w) - r.edge(o).minlen;
    }));
    return a !== Number.POSITIVE_INFINITY && a != null || (a = 0), i.rank = a;
  });
}, AB = function(r, t) {
  return r.node(t.w).rank - r.node(t.v).rank - r.edge(t).minlen;
}, kae = ua.Graph, pp = AB, IB = function(r) {
  var t, e, n = new kae({ directed: !1 }), i = r.nodes()[0], a = r.nodeCount();
  for (n.setNode(i, {}); Lae(n, r) < a; )
    t = Nae(n, r), e = n.hasNode(t.v) ? pp(r, t) : -pp(r, t), Rae(n, r, e);
  return n;
};
function Lae(r, t) {
  return J.forEach(r.nodes(), function e(n) {
    J.forEach(t.nodeEdges(n), function(i) {
      var a = i.v, o = n === a ? i.w : a;
      r.hasNode(o) || pp(t, i) || (r.setNode(o, {}), r.setEdge(n, o, {}), e(o));
    });
  }), r.nodeCount();
}
function Nae(r, t) {
  return J.minBy(t.edges(), function(e) {
    if (r.hasNode(e.v) !== r.hasNode(e.w))
      return pp(t, e);
  });
}
function Rae(r, t, e) {
  J.forEach(r.nodes(), function(n) {
    t.node(n).rank += e;
  });
}
var Bae = AB, Gae = TB, Fae = ua.alg.preorder, zae = ua.alg.postorder, Uae = Gn.simplify, jae = Qs;
function Qs(r) {
  r = Uae(r), Gae(r);
  var t, e = IB(r);
  for (Rx(e), Nx(e, r); t = DB(e); )
    LB(e, r, t, kB(e, r, t));
}
function Nx(r, t) {
  var e = zae(r, r.nodes());
  e = e.slice(0, e.length - 1), J.forEach(e, function(n) {
    (function(i, a, o) {
      var s = i.node(o).parent;
      i.edge(o, s).cutvalue = PB(i, a, o);
    })(r, t, n);
  });
}
function PB(r, t, e) {
  var n = r.node(e).parent, i = !0, a = t.edge(e, n), o = 0;
  return a || (i = !1, a = t.edge(n, e)), o = a.weight, J.forEach(t.nodeEdges(e), function(s) {
    var u, f, l = s.v === e, c = l ? s.w : s.v;
    if (c !== n) {
      var h = l === i, d = t.edge(s).weight;
      if (o += h ? d : -d, u = e, f = c, r.hasEdge(u, f)) {
        var v = r.edge(e, c).cutvalue;
        o += h ? -v : v;
      }
    }
  }), o;
}
function Rx(r, t) {
  arguments.length < 2 && (t = r.nodes()[0]), OB(r, {}, 1, t);
}
function OB(r, t, e, n, i) {
  var a = e, o = r.node(n);
  return t[n] = !0, J.forEach(r.neighbors(n), function(s) {
    J.has(t, s) || (e = OB(r, t, e, s, n));
  }), o.low = a, o.lim = e++, i ? o.parent = i : delete o.parent, e;
}
function DB(r) {
  return J.find(r.edges(), function(t) {
    return r.edge(t).cutvalue < 0;
  });
}
function kB(r, t, e) {
  var n = e.v, i = e.w;
  t.hasEdge(n, i) || (n = e.w, i = e.v);
  var a = r.node(n), o = r.node(i), s = a, u = !1;
  a.lim > o.lim && (s = o, u = !0);
  var f = J.filter(t.edges(), function(l) {
    return u === TM(r, r.node(l.v), s) && u !== TM(r, r.node(l.w), s);
  });
  return J.minBy(f, function(l) {
    return Bae(t, l);
  });
}
function LB(r, t, e, n) {
  var i = e.v, a = e.w;
  r.removeEdge(i, a), r.setEdge(n.v, n.w, {}), Rx(r), Nx(r, t), function(o, s) {
    var u = J.find(o.nodes(), function(l) {
      return !s.node(l).parent;
    }), f = Fae(o, u);
    f = f.slice(1), J.forEach(f, function(l) {
      var c = o.node(l).parent, h = s.edge(l, c), d = !1;
      h || (h = s.edge(c, l), d = !0), s.node(l).rank = s.node(c).rank + (d ? h.minlen : -h.minlen);
    });
  }(r, t);
}
function TM(r, t, e) {
  return e.low <= t.lim && t.lim <= e.lim;
}
Qs.initLowLimValues = Rx, Qs.initCutValues = Nx, Qs.calcCutValue = PB, Qs.leaveEdge = DB, Qs.enterEdge = kB, Qs.exchangeEdges = LB;
var NB = TB, $ae = function(r) {
  switch (r.graph().ranker) {
    case "network-simplex":
      AM(r);
      break;
    case "tight-tree":
      (function(t) {
        NB(t), IB(t);
      })(r);
      break;
    case "longest-path":
      Wae(r);
      break;
    default:
      AM(r);
  }
}, Wae = NB;
function AM(r) {
  jae(r);
}
var Vae = function(r) {
  var t = function(e) {
    var n = {}, i = 0;
    function a(o) {
      var s = i;
      J.forEach(e.children(o), a), n[o] = { low: s, lim: i++ };
    }
    return J.forEach(e.children(), a), n;
  }(r);
  J.forEach(r.graph().dummyChains, function(e) {
    for (var n = r.node(e), i = n.edgeObj, a = function(c, h, d, v) {
      var p, g, y = [], b = [], m = Math.min(h[d].low, h[v].low), x = Math.max(h[d].lim, h[v].lim);
      p = d;
      do
        p = c.parent(p), y.push(p);
      while (p && (h[p].low > m || x > h[p].lim));
      for (g = p, p = v; (p = c.parent(p)) !== g; )
        b.push(p);
      return { path: y.concat(b.reverse()), lca: g };
    }(r, t, i.v, i.w), o = a.path, s = a.lca, u = 0, f = o[u], l = !0; e !== i.w; ) {
      if (n = r.node(e), l) {
        for (; (f = o[u]) !== s && r.node(f).maxRank < n.rank; )
          u++;
        f === s && (l = !1);
      }
      if (!l) {
        for (; u < o.length - 1 && r.node(f = o[u + 1]).minRank <= n.rank; )
          u++;
        f = o[u];
      }
      r.setParent(e, f), e = r.successors(e)[0];
    }
  });
}, IM = { run: function(r) {
  var t = Gn.addDummyNode(r, "root", {}, "_root"), e = function(o) {
    var s = {};
    function u(f, l) {
      var c = o.children(f);
      c && c.length && J.forEach(c, function(h) {
        u(h, l + 1);
      }), s[f] = l;
    }
    return J.forEach(o.children(), function(f) {
      u(f, 1);
    }), s;
  }(r), n = J.max(J.values(e)) - 1, i = 2 * n + 1;
  r.graph().nestingRoot = t, J.forEach(r.edges(), function(o) {
    r.edge(o).minlen *= i;
  });
  var a = function(o) {
    return J.reduce(o.edges(), function(s, u) {
      return s + o.edge(u).weight;
    }, 0);
  }(r) + 1;
  J.forEach(r.children(), function(o) {
    RB(r, t, i, a, n, e, o);
  }), r.graph().nodeRankFactor = i;
}, cleanup: function(r) {
  var t = r.graph();
  r.removeNode(t.nestingRoot), delete t.nestingRoot, J.forEach(r.edges(), function(e) {
    r.edge(e).nestingEdge && r.removeEdge(e);
  });
} };
function RB(r, t, e, n, i, a, o) {
  var s = r.children(o);
  if (s.length) {
    var u = Gn.addBorderNode(r, "_bt"), f = Gn.addBorderNode(r, "_bb"), l = r.node(o);
    r.setParent(u, o), l.borderTop = u, r.setParent(f, o), l.borderBottom = f, J.forEach(s, function(c) {
      RB(r, t, e, n, i, a, c);
      var h = r.node(c), d = h.borderTop ? h.borderTop : c, v = h.borderBottom ? h.borderBottom : c, p = h.borderTop ? n : 2 * n, g = d !== v ? 1 : i - a[o] + 1;
      r.setEdge(u, d, { weight: p, minlen: g, nestingEdge: !0 }), r.setEdge(v, f, { weight: p, minlen: g, nestingEdge: !0 });
    }), r.parent(o) || r.setEdge(t, u, { weight: 0, minlen: i + a[o] });
  } else
    o !== t && r.setEdge(t, o, { weight: 0, minlen: e });
}
var Xae = function(r) {
  J.forEach(r.children(), function t(e) {
    var n = r.children(e), i = r.node(e);
    if (n.length && J.forEach(n, t), J.has(i, "minRank")) {
      i.borderLeft = [], i.borderRight = [];
      for (var a = i.minRank, o = i.maxRank + 1; a < o; ++a)
        PM(r, "borderLeft", "_bl", e, i, a), PM(r, "borderRight", "_br", e, i, a);
    }
  });
};
function PM(r, t, e, n, i, a) {
  var o = { width: 0, height: 0, rank: a, borderType: t }, s = i[t][a - 1], u = Gn.addDummyNode(r, "border", o, e);
  i[t][a] = u, r.setParent(u, n), s && r.setEdge(s, u, { weight: 1 });
}
var OM = { adjust: function(r) {
  var t = r.graph().rankdir.toLowerCase();
  t !== "lr" && t !== "rl" || DM(r);
}, undo: function(r) {
  var t = r.graph().rankdir.toLowerCase();
  t !== "bt" && t !== "rl" || function(e) {
    J.forEach(e.nodes(), function(n) {
      _y(e.node(n));
    }), J.forEach(e.edges(), function(n) {
      var i = e.edge(n);
      J.forEach(i.points, _y), J.has(i, "y") && _y(i);
    });
  }(r), t !== "lr" && t !== "rl" || (function(e) {
    J.forEach(e.nodes(), function(n) {
      wy(e.node(n));
    }), J.forEach(e.edges(), function(n) {
      var i = e.edge(n);
      J.forEach(i.points, wy), J.has(i, "x") && wy(i);
    });
  }(r), DM(r));
} };
function DM(r) {
  J.forEach(r.nodes(), function(t) {
    kM(r.node(t));
  }), J.forEach(r.edges(), function(t) {
    kM(r.edge(t));
  });
}
function kM(r) {
  var t = r.width;
  r.width = r.height, r.height = t;
}
function _y(r) {
  r.y = -r.y;
}
function wy(r) {
  var t = r.x;
  r.x = r.y, r.y = t;
}
var Yae = function(r) {
  var t = {}, e = J.filter(r.nodes(), function(s) {
    return !r.children(s).length;
  }), n = J.max(J.map(e, function(s) {
    return r.node(s).rank;
  })), i = J.map(J.range(n + 1), function() {
    return [];
  });
  function a(s) {
    if (!J.has(t, s)) {
      t[s] = !0;
      var u = r.node(s);
      i[u.rank].push(s), J.forEach(r.successors(s), a);
    }
  }
  var o = J.sortBy(e, function(s) {
    return r.node(s).rank;
  });
  return J.forEach(o, a), i;
}, Hae = function(r, t) {
  for (var e = 0, n = 1; n < t.length; ++n)
    e += Kae(r, t[n - 1], t[n]);
  return e;
};
function Kae(r, t, e) {
  for (var n = J.zipObject(e, J.map(e, function(f, l) {
    return l;
  })), i = J.flatten(J.map(t, function(f) {
    return J.sortBy(J.map(r.outEdges(f), function(l) {
      return { pos: n[l.w], weight: r.edge(l).weight };
    }), "pos");
  }), !0), a = 1; a < e.length; )
    a <<= 1;
  var o = 2 * a - 1;
  a -= 1;
  var s = J.map(new Array(o), function() {
    return 0;
  }), u = 0;
  return J.forEach(i.forEach(function(f) {
    var l = f.pos + a;
    s[l] += f.weight;
    for (var c = 0; l > 0; )
      l % 2 && (c += s[l + 1]), s[l = l - 1 >> 1] += f.weight;
    u += f.weight * c;
  })), u;
}
var qae = function(r, t) {
  return J.map(t, function(e) {
    var n = r.inEdges(e);
    if (n.length) {
      var i = J.reduce(n, function(a, o) {
        var s = r.edge(o), u = r.node(o.v);
        return { sum: a.sum + s.weight * u.order, weight: a.weight + s.weight };
      }, { sum: 0, weight: 0 });
      return { v: e, barycenter: i.sum / i.weight, weight: i.weight };
    }
    return { v: e };
  });
}, Zae = function(r, t) {
  var e = {};
  return J.forEach(r, function(n, i) {
    var a = e[n.v] = { indegree: 0, in: [], out: [], vs: [n.v], i };
    J.isUndefined(n.barycenter) || (a.barycenter = n.barycenter, a.weight = n.weight);
  }), J.forEach(t.edges(), function(n) {
    var i = e[n.v], a = e[n.w];
    J.isUndefined(i) || J.isUndefined(a) || (a.indegree++, i.out.push(e[n.w]));
  }), function(n) {
    var i = [];
    function a(u) {
      return function(f) {
        f.merged || (J.isUndefined(f.barycenter) || J.isUndefined(u.barycenter) || f.barycenter >= u.barycenter) && function(l, c) {
          var h = 0, d = 0;
          l.weight && (h += l.barycenter * l.weight, d += l.weight), c.weight && (h += c.barycenter * c.weight, d += c.weight), l.vs = c.vs.concat(l.vs), l.barycenter = h / d, l.weight = d, l.i = Math.min(c.i, l.i), c.merged = !0;
        }(u, f);
      };
    }
    function o(u) {
      return function(f) {
        f.in.push(u), --f.indegree == 0 && n.push(f);
      };
    }
    for (; n.length; ) {
      var s = n.pop();
      i.push(s), J.forEach(s.in.reverse(), a(s)), J.forEach(s.out, o(s));
    }
    return J.map(J.filter(i, function(u) {
      return !u.merged;
    }), function(u) {
      return J.pick(u, ["vs", "i", "barycenter", "weight"]);
    });
  }(J.filter(e, function(n) {
    return !n.indegree;
  }));
}, Qae = function(r, t) {
  var e = Gn.partition(r, function(c) {
    return J.has(c, "barycenter");
  }), n = e.lhs, i = J.sortBy(e.rhs, function(c) {
    return -c.i;
  }), a = [], o = 0, s = 0, u = 0;
  n.sort((f = !!t, function(c, h) {
    return c.barycenter < h.barycenter ? -1 : c.barycenter > h.barycenter ? 1 : f ? h.i - c.i : c.i - h.i;
  })), u = LM(a, i, u), J.forEach(n, function(c) {
    u += c.vs.length, a.push(c.vs), o += c.barycenter * c.weight, s += c.weight, u = LM(a, i, u);
  });
  var f, l = { vs: J.flatten(a, !0) };
  return s && (l.barycenter = o / s, l.weight = s), l;
};
function LM(r, t, e) {
  for (var n; t.length && (n = J.last(t)).i <= e; )
    t.pop(), r.push(n.vs), e++;
  return e;
}
var Jae = function r(t, e, n, i) {
  var a = t.children(e), o = t.node(e), s = o ? o.borderLeft : void 0, u = o ? o.borderRight : void 0, f = {};
  s && (a = J.filter(a, function(p) {
    return p !== s && p !== u;
  }));
  var l = qae(t, a);
  J.forEach(l, function(p) {
    if (t.children(p.v).length) {
      var g = r(t, p.v, n, i);
      f[p.v] = g, J.has(g, "barycenter") && (y = p, b = g, J.isUndefined(y.barycenter) ? (y.barycenter = b.barycenter, y.weight = b.weight) : (y.barycenter = (y.barycenter * y.weight + b.barycenter * b.weight) / (y.weight + b.weight), y.weight += b.weight));
    }
    var y, b;
  });
  var c = Zae(l, n);
  (function(p, g) {
    J.forEach(p, function(y) {
      y.vs = J.flatten(y.vs.map(function(b) {
        return g[b] ? g[b].vs : b;
      }), !0);
    });
  })(c, f);
  var h = Qae(c, i);
  if (s && (h.vs = J.flatten([s, h.vs, u], !0), t.predecessors(s).length)) {
    var d = t.node(t.predecessors(s)[0]), v = t.node(t.predecessors(u)[0]);
    J.has(h, "barycenter") || (h.barycenter = 0, h.weight = 0), h.barycenter = (h.barycenter * h.weight + d.order + v.order) / (h.weight + 2), h.weight += 2;
  }
  return h;
}, eoe = ua.Graph, toe = function(r, t, e) {
  var n = function(a) {
    for (var o; a.hasNode(o = J.uniqueId("_root")); )
      ;
    return o;
  }(r), i = new eoe({ compound: !0 }).setGraph({ root: n }).setDefaultNodeLabel(function(a) {
    return r.node(a);
  });
  return J.forEach(r.nodes(), function(a) {
    var o = r.node(a), s = r.parent(a);
    (o.rank === t || o.minRank <= t && t <= o.maxRank) && (i.setNode(a), i.setParent(a, s || n), J.forEach(r[e](a), function(u) {
      var f = u.v === a ? u.w : u.v, l = i.edge(f, a), c = J.isUndefined(l) ? 0 : l.weight;
      i.setEdge(f, a, { weight: r.edge(u).weight + c });
    }), J.has(o, "minRank") && i.setNode(a, { borderLeft: o.borderLeft[t], borderRight: o.borderRight[t] }));
  }), i;
}, roe = function(r, t, e) {
  var n, i = {};
  J.forEach(e, function(a) {
    for (var o, s, u = r.parent(a); u; ) {
      if ((o = r.parent(u)) ? (s = i[o], i[o] = u) : (s = n, n = u), s && s !== u)
        return void t.setEdge(s, u);
      u = o;
    }
  });
}, noe = ua.Graph, ioe = function(r) {
  var t = Gn.maxRank(r), e = NM(r, J.range(1, t + 1), "inEdges"), n = NM(r, J.range(t - 1, -1, -1), "outEdges"), i = Yae(r);
  RM(r, i);
  for (var a, o = Number.POSITIVE_INFINITY, s = 0, u = 0; u < 4; ++s, ++u) {
    aoe(s % 2 ? e : n, s % 4 >= 2), i = Gn.buildLayerMatrix(r);
    var f = Hae(r, i);
    f < o && (u = 0, a = J.cloneDeep(i), o = f);
  }
  RM(r, a);
};
function NM(r, t, e) {
  return J.map(t, function(n) {
    return toe(r, n, e);
  });
}
function aoe(r, t) {
  var e = new noe();
  J.forEach(r, function(n) {
    var i = n.graph().root, a = Jae(n, i, e, t);
    J.forEach(a.vs, function(o, s) {
      n.node(o).order = s;
    }), roe(n, e, a.vs);
  });
}
function RM(r, t) {
  J.forEach(t, function(e) {
    J.forEach(e, function(n, i) {
      r.node(n).order = i;
    });
  });
}
var ooe = ua.Graph, soe = function(r) {
  var t, e = Gn.buildLayerMatrix(r), n = J.merge(uoe(r, e), foe(r, e)), i = {};
  J.forEach(["u", "d"], function(o) {
    t = o === "u" ? e : J.values(e).reverse(), J.forEach(["l", "r"], function(s) {
      s === "r" && (t = J.map(t, function(c) {
        return J.values(c).reverse();
      }));
      var u = (o === "u" ? r.predecessors : r.successors).bind(r), f = coe(r, t, n, u), l = hoe(r, t, f.root, f.align, s === "r");
      s === "r" && (l = J.mapValues(l, function(c) {
        return -c;
      })), i[o + s] = l;
    });
  });
  var a = doe(r, i);
  return voe(i, a), poe(i, r.graph().align);
};
function uoe(r, t) {
  var e = {};
  return J.reduce(t, function(n, i) {
    var a = 0, o = 0, s = n.length, u = J.last(i);
    return J.forEach(i, function(f, l) {
      var c = function(d, v) {
        if (d.node(v).dummy)
          return J.find(d.predecessors(v), function(p) {
            return d.node(p).dummy;
          });
      }(r, f), h = c ? r.node(c).order : s;
      (c || f === u) && (J.forEach(i.slice(o, l + 1), function(d) {
        J.forEach(r.predecessors(d), function(v) {
          var p = r.node(v), g = p.order;
          !(g < a || h < g) || p.dummy && r.node(d).dummy || BB(e, v, d);
        });
      }), o = l + 1, a = h);
    }), i;
  }), e;
}
function foe(r, t) {
  var e = {};
  function n(i, a, o, s, u) {
    var f;
    J.forEach(J.range(a, o), function(l) {
      f = i[l], r.node(f).dummy && J.forEach(r.predecessors(f), function(c) {
        var h = r.node(c);
        h.dummy && (h.order < s || h.order > u) && BB(e, c, f);
      });
    });
  }
  return J.reduce(t, function(i, a) {
    var o, s = -1, u = 0;
    return J.forEach(a, function(f, l) {
      if (r.node(f).dummy === "border") {
        var c = r.predecessors(f);
        c.length && (o = r.node(c[0]).order, n(a, u, l, s, o), u = l, s = o);
      }
      n(a, u, a.length, o, i.length);
    }), a;
  }), e;
}
function BB(r, t, e) {
  if (t > e) {
    var n = t;
    t = e, e = n;
  }
  var i = r[t];
  i || (r[t] = i = {}), i[e] = !0;
}
function loe(r, t, e) {
  if (t > e) {
    var n = t;
    t = e, e = n;
  }
  return J.has(r[t], e);
}
function coe(r, t, e, n) {
  var i = {}, a = {}, o = {};
  return J.forEach(t, function(s) {
    J.forEach(s, function(u, f) {
      i[u] = u, a[u] = u, o[u] = f;
    });
  }), J.forEach(t, function(s) {
    var u = -1;
    J.forEach(s, function(f) {
      var l = n(f);
      if (l.length)
        for (var c = ((l = J.sortBy(l, function(p) {
          return o[p];
        })).length - 1) / 2, h = Math.floor(c), d = Math.ceil(c); h <= d; ++h) {
          var v = l[h];
          a[f] === f && u < o[v] && !loe(e, f, v) && (a[v] = f, a[f] = i[f] = i[v], u = o[v]);
        }
    });
  }), { root: i, align: a };
}
function hoe(r, t, e, n, i) {
  var a = {}, o = function(f, l, c, h) {
    var d = new ooe(), v = f.graph(), p = function(g, y, b) {
      return function(m, x, _) {
        var w, E = m.node(x), M = m.node(_), C = 0;
        if (C += E.width / 2, J.has(E, "labelpos"))
          switch (E.labelpos.toLowerCase()) {
            case "l":
              w = -E.width / 2;
              break;
            case "r":
              w = E.width / 2;
          }
        if (w && (C += b ? w : -w), w = 0, C += (E.dummy ? y : g) / 2, C += (M.dummy ? y : g) / 2, C += M.width / 2, J.has(M, "labelpos"))
          switch (M.labelpos.toLowerCase()) {
            case "l":
              w = M.width / 2;
              break;
            case "r":
              w = -M.width / 2;
          }
        return w && (C += b ? w : -w), w = 0, C;
      };
    }(v.nodesep, v.edgesep, h);
    return J.forEach(l, function(g) {
      var y;
      J.forEach(g, function(b) {
        var m = c[b];
        if (d.setNode(m), y) {
          var x = c[y], _ = d.edge(x, m);
          d.setEdge(x, m, Math.max(p(f, b, y), _ || 0));
        }
        y = b;
      });
    }), d;
  }(r, t, e, i), s = i ? "borderLeft" : "borderRight";
  function u(f, l) {
    for (var c = o.nodes(), h = c.pop(), d = {}; h; )
      d[h] ? f(h) : (d[h] = !0, c.push(h), c = c.concat(l(h))), h = c.pop();
  }
  return u(function(f) {
    a[f] = o.inEdges(f).reduce(function(l, c) {
      return Math.max(l, a[c.v] + o.edge(c));
    }, 0);
  }, o.predecessors.bind(o)), u(function(f) {
    var l = o.outEdges(f).reduce(function(h, d) {
      return Math.min(h, a[d.w] - o.edge(d));
    }, Number.POSITIVE_INFINITY), c = r.node(f);
    l !== Number.POSITIVE_INFINITY && c.borderType !== s && (a[f] = Math.max(a[f], l));
  }, o.successors.bind(o)), J.forEach(n, function(f) {
    a[f] = a[e[f]];
  }), a;
}
function doe(r, t) {
  return J.minBy(J.values(t), function(e) {
    var n = Number.NEGATIVE_INFINITY, i = Number.POSITIVE_INFINITY;
    return J.forIn(e, function(a, o) {
      var s = function(u, f) {
        return u.node(f).width;
      }(r, o) / 2;
      n = Math.max(a + s, n), i = Math.min(a - s, i);
    }), n - i;
  });
}
function voe(r, t) {
  var e = J.values(t), n = J.min(e), i = J.max(e);
  J.forEach(["u", "d"], function(a) {
    J.forEach(["l", "r"], function(o) {
      var s, u = a + o, f = r[u];
      if (f !== t) {
        var l = J.values(f);
        (s = o === "l" ? n - J.min(l) : i - J.max(l)) && (r[u] = J.mapValues(f, function(c) {
          return c + s;
        }));
      }
    });
  });
}
function poe(r, t) {
  return J.mapValues(r.ul, function(e, n) {
    if (t)
      return r[t.toLowerCase()][n];
    var i = J.sortBy(J.map(r, n));
    return (i[1] + i[2]) / 2;
  });
}
var goe = soe, yoe = function(r) {
  (function(t) {
    var e = Gn.buildLayerMatrix(t), n = t.graph().ranksep, i = 0;
    J.forEach(e, function(a) {
      var o = J.max(J.map(a, function(s) {
        return t.node(s).height;
      }));
      J.forEach(a, function(s) {
        t.node(s).y = i + o / 2;
      }), i += o + n;
    });
  })(r = Gn.asNonCompoundGraph(r)), J.forEach(goe(r), function(t, e) {
    r.node(e).x = t;
  });
}, moe = Gn.normalizeRanks, boe = Gn.removeEmptyRanks, $o = Gn, xoe = ua.Graph, _oe = function(r, t) {
  var e = t && t.debugTiming ? $o.time : $o.notime;
  e("layout", function() {
    var n = e("  buildLayoutGraph", function() {
      return function(i) {
        var a = new xoe({ multigraph: !0, compound: !0 }), o = Sy(i.graph());
        return a.setGraph(J.merge({}, Eoe, Ey(o, woe), J.pick(o, Soe))), J.forEach(i.nodes(), function(s) {
          var u = Sy(i.node(s));
          a.setNode(s, J.defaults(Ey(u, Moe), Coe)), a.setParent(s, i.parent(s));
        }), J.forEach(i.edges(), function(s) {
          var u = Sy(i.edge(s));
          a.setEdge(s, J.merge({}, Aoe, Ey(u, Toe), J.pick(u, Ioe)));
        }), a;
      }(r);
    });
    e("  runLayout", function() {
      (function(i, a) {
        a("    makeSpaceForEdgeLabels", function() {
          (function(o) {
            var s = o.graph();
            s.ranksep /= 2, J.forEach(o.edges(), function(u) {
              var f = o.edge(u);
              f.minlen *= 2, f.labelpos.toLowerCase() !== "c" && (s.rankdir === "TB" || s.rankdir === "BT" ? f.width += f.labeloffset : f.height += f.labeloffset);
            });
          })(i);
        }), a("    removeSelfEdges", function() {
          (function(o) {
            J.forEach(o.edges(), function(s) {
              if (s.v === s.w) {
                var u = o.node(s.v);
                u.selfEdges || (u.selfEdges = []), u.selfEdges.push({ e: s, label: o.edge(s) }), o.removeEdge(s);
              }
            });
          })(i);
        }), a("    acyclic", function() {
          wM.run(i);
        }), a("    nestingGraph.run", function() {
          IM.run(i);
        }), a("    rank", function() {
          $ae($o.asNonCompoundGraph(i));
        }), a("    injectEdgeLabelProxies", function() {
          (function(o) {
            J.forEach(o.edges(), function(s) {
              var u = o.edge(s);
              if (u.width && u.height) {
                var f = o.node(s.v), l = { rank: (o.node(s.w).rank - f.rank) / 2 + f.rank, e: s };
                $o.addDummyNode(o, "edge-proxy", l, "_ep");
              }
            });
          })(i);
        }), a("    removeEmptyRanks", function() {
          boe(i);
        }), a("    nestingGraph.cleanup", function() {
          IM.cleanup(i);
        }), a("    normalizeRanks", function() {
          moe(i);
        }), a("    assignRankMinMax", function() {
          (function(o) {
            var s = 0;
            J.forEach(o.nodes(), function(u) {
              var f = o.node(u);
              f.borderTop && (f.minRank = o.node(f.borderTop).rank, f.maxRank = o.node(f.borderBottom).rank, s = J.max(s, f.maxRank));
            }), o.graph().maxRank = s;
          })(i);
        }), a("    removeEdgeLabelProxies", function() {
          (function(o) {
            J.forEach(o.nodes(), function(s) {
              var u = o.node(s);
              u.dummy === "edge-proxy" && (o.edge(u.e).labelRank = u.rank, o.removeNode(s));
            });
          })(i);
        }), a("    normalize.run", function() {
          CM.run(i);
        }), a("    parentDummyChains", function() {
          Vae(i);
        }), a("    addBorderSegments", function() {
          Xae(i);
        }), a("    order", function() {
          ioe(i);
        }), a("    insertSelfEdges", function() {
          (function(o) {
            var s = $o.buildLayerMatrix(o);
            J.forEach(s, function(u) {
              var f = 0;
              J.forEach(u, function(l, c) {
                var h = o.node(l);
                h.order = c + f, J.forEach(h.selfEdges, function(d) {
                  $o.addDummyNode(o, "selfedge", { width: d.label.width, height: d.label.height, rank: h.rank, order: c + ++f, e: d.e, label: d.label }, "_se");
                }), delete h.selfEdges;
              });
            });
          })(i);
        }), a("    adjustCoordinateSystem", function() {
          OM.adjust(i);
        }), a("    position", function() {
          yoe(i);
        }), a("    positionSelfEdges", function() {
          (function(o) {
            J.forEach(o.nodes(), function(s) {
              var u = o.node(s);
              if (u.dummy === "selfedge") {
                var f = o.node(u.e.v), l = f.x + f.width / 2, c = f.y, h = u.x - l, d = f.height / 2;
                o.setEdge(u.e, u.label), o.removeNode(s), u.label.points = [{ x: l + 2 * h / 3, y: c - d }, { x: l + 5 * h / 6, y: c - d }, { x: l + h, y: c }, { x: l + 5 * h / 6, y: c + d }, { x: l + 2 * h / 3, y: c + d }], u.label.x = u.x, u.label.y = u.y;
              }
            });
          })(i);
        }), a("    removeBorderNodes", function() {
          (function(o) {
            J.forEach(o.nodes(), function(s) {
              if (o.children(s).length) {
                var u = o.node(s), f = o.node(u.borderTop), l = o.node(u.borderBottom), c = o.node(J.last(u.borderLeft)), h = o.node(J.last(u.borderRight));
                u.width = Math.abs(h.x - c.x), u.height = Math.abs(l.y - f.y), u.x = c.x + u.width / 2, u.y = f.y + u.height / 2;
              }
            }), J.forEach(o.nodes(), function(s) {
              o.node(s).dummy === "border" && o.removeNode(s);
            });
          })(i);
        }), a("    normalize.undo", function() {
          CM.undo(i);
        }), a("    fixupEdgeLabelCoords", function() {
          (function(o) {
            J.forEach(o.edges(), function(s) {
              var u = o.edge(s);
              if (J.has(u, "x"))
                switch (u.labelpos !== "l" && u.labelpos !== "r" || (u.width -= u.labeloffset), u.labelpos) {
                  case "l":
                    u.x -= u.width / 2 + u.labeloffset;
                    break;
                  case "r":
                    u.x += u.width / 2 + u.labeloffset;
                }
            });
          })(i);
        }), a("    undoCoordinateSystem", function() {
          OM.undo(i);
        }), a("    translateGraph", function() {
          (function(o) {
            var s = Number.POSITIVE_INFINITY, u = 0, f = Number.POSITIVE_INFINITY, l = 0, c = o.graph(), h = c.marginx || 0, d = c.marginy || 0;
            function v(p) {
              var g = p.x, y = p.y, b = p.width, m = p.height;
              s = Math.min(s, g - b / 2), u = Math.max(u, g + b / 2), f = Math.min(f, y - m / 2), l = Math.max(l, y + m / 2);
            }
            J.forEach(o.nodes(), function(p) {
              v(o.node(p));
            }), J.forEach(o.edges(), function(p) {
              var g = o.edge(p);
              J.has(g, "x") && v(g);
            }), s -= h, f -= d, J.forEach(o.nodes(), function(p) {
              var g = o.node(p);
              g.x -= s, g.y -= f;
            }), J.forEach(o.edges(), function(p) {
              var g = o.edge(p);
              J.forEach(g.points, function(y) {
                y.x -= s, y.y -= f;
              }), J.has(g, "x") && (g.x -= s), J.has(g, "y") && (g.y -= f);
            }), c.width = u - s + h, c.height = l - f + d;
          })(i);
        }), a("    assignNodeIntersects", function() {
          (function(o) {
            J.forEach(o.edges(), function(s) {
              var u, f, l = o.edge(s), c = o.node(s.v), h = o.node(s.w);
              l.points ? (u = l.points[0], f = l.points[l.points.length - 1]) : (l.points = [], u = h, f = c), l.points.unshift($o.intersectRect(c, u)), l.points.push($o.intersectRect(h, f));
            });
          })(i);
        }), a("    reversePoints", function() {
          (function(o) {
            J.forEach(o.edges(), function(s) {
              var u = o.edge(s);
              u.reversed && u.points.reverse();
            });
          })(i);
        }), a("    acyclic.undo", function() {
          wM.undo(i);
        });
      })(n, e);
    }), e("  updateInputGraph", function() {
      (function(i, a) {
        J.forEach(i.nodes(), function(o) {
          var s = i.node(o), u = a.node(o);
          s && (s.x = u.x, s.y = u.y, a.children(o).length && (s.width = u.width, s.height = u.height));
        }), J.forEach(i.edges(), function(o) {
          var s = i.edge(o), u = a.edge(o);
          s.points = u.points, J.has(u, "x") && (s.x = u.x, s.y = u.y);
        }), i.graph().width = a.graph().width, i.graph().height = a.graph().height;
      })(r, n);
    });
  });
}, woe = ["nodesep", "edgesep", "ranksep", "marginx", "marginy"], Eoe = { ranksep: 50, edgesep: 20, nodesep: 50, rankdir: "tb" }, Soe = ["acyclicer", "ranker", "rankdir", "align"], Moe = ["width", "height"], Coe = { width: 0, height: 0 }, Toe = ["minlen", "weight", "width", "height", "labeloffset"], Aoe = { minlen: 1, weight: 1, width: 0, height: 0, labeloffset: 10, labelpos: "r" }, Ioe = ["labelpos"];
function Ey(r, t) {
  return J.mapValues(J.pick(r, t), Number);
}
function Sy(r) {
  var t = {};
  return J.forEach(r, function(e, n) {
    t[n.toLowerCase()] = e;
  }), t;
}
var Poe = ua.Graph, GB = { graphlib: ua, layout: _oe, debug: { debugOrdering: function(r) {
  var t = Gn.buildLayerMatrix(r), e = new Poe({ compound: !0, multigraph: !0 }).setGraph({});
  return J.forEach(r.nodes(), function(n) {
    e.setNode(n, { label: n }), e.setParent(n, "layer" + r.node(n).rank);
  }), J.forEach(r.edges(), function(n) {
    e.setEdge(n.v, n.w, {}, n.name);
  }), J.forEach(t, function(n, i) {
    var a = "layer" + i;
    e.setNode(a, { rank: "same" }), J.reduce(n, function(o, s) {
      return e.setEdge(o, s, { style: "invis" }), s;
    });
  }), e;
} }, util: { time: Gn.time, notime: Gn.notime }, version: "0.8.5" }, Ooe = GB.graphlib, Doe = GB.layout;
class koe {
  constructor(t) {
    this.cardinality = 1, this.include = xu.UNSPECIFIED, this.isGroupNode = !1, this.parentNode = null, this.type = ui.NODE, this.name = t.name, this.attr = t.attr || {}, this.inputs = t.inputs, this.path = t.path || [], this.width = t.width, this.height = t.height;
  }
}
class Loe {
  constructor() {
    this.nodes = {}, this.edges = [], this.nodes = {}, this.edges = [];
  }
}
function Noe(r) {
  const t = new Loe();
  return r.nodes.map((e) => new koe(e)).forEach((e) => {
    t.nodes[e.name] = e, e.inputs.forEach((n) => {
      (function(i, a, o) {
        o.name !== a.name && i.edges.push(Object.assign(Object.assign({}, o.attr), { v: o.name, w: a.name }));
      })(t, e, n);
    });
  }), t;
}
class Roe {
  constructor(t, e = {}) {
    this.attr = null, this.bridgeGraph = null, this.cardinality = 0, this.depth = 1, this.include = xu.UNSPECIFIED, this.isGroupNode = !0, this.parentNode = null, this.type = ui.META, this.path = [], this.name = t, this.metaGraph = Bx(t, Kf.META, e);
  }
  getFirstChild() {
    return this.metaGraph.node(this.metaGraph.nodes()[0]);
  }
  getChildren() {
    return this.metaGraph.nodes().map((t) => this.metaGraph.node(t));
  }
  leaves() {
    let t, e = [], n = [this];
    for (; n.length; ) {
      let i = n.shift();
      i.isGroupNode ? (t = i.metaGraph, t.nodes().forEach((a) => n.push(t.node(a)))) : e.push(i.name);
    }
    return e;
  }
}
class Boe {
  constructor(t, e) {
    this.v = t, this.w = e, this.baseEdgeList = [], this.inbound = null, this.name = null;
  }
  addBaseEdge(t, e) {
    this.baseEdgeList.push(t);
  }
}
function FB(r, t = {}) {
  return new Roe(r, t);
}
function zB(r, t) {
  return new Boe(r, t);
}
function Bx(r, t, e) {
  const n = e || {}, i = new Ooe.Graph(n);
  return i.setGraph({ name: r, rankdir: n.rankdir, type: t, align: n.align }), i;
}
class Goe {
  constructor(t = {}) {
    this.graphOptions = t, this.index = {}, this.graphOptions.compound = !0, this.root = FB(Hf, this.graphOptions), this.index[Hf] = this.root;
  }
  getNodeMap() {
    return this.index;
  }
  node(t) {
    return this.index[t];
  }
  setNode(t, e) {
    this.index[t] = e;
  }
  getBridgeGraph(t) {
    const e = this.index[t];
    if (!e)
      throw Error("Could not find node in hierarchy: " + t);
    if (!("metaGraph" in e))
      return null;
    const n = e;
    if (n.bridgeGraph)
      return n.bridgeGraph;
    const i = Bx(I3, Kf.BRIDGE, this.graphOptions);
    if (n.bridgeGraph = i, !e.parentNode || !("metaGraph" in e.parentNode))
      return i;
    const a = e.parentNode;
    return [a.metaGraph, this.getBridgeGraph(a.name)].forEach((o) => {
      o.edges().filter((s) => s.v === t || s.w === t).forEach((s) => {
        const u = s.w === t;
        o.edge(s).baseEdgeList.forEach((f) => {
          const [l, c] = u ? [f.w, s.v] : [f.v, s.w], h = this.getChildName(t, l), d = { v: u ? c : h, w: u ? h : c };
          let v = i.edge(d);
          v || (v = zB(d.v, d.w), v.inbound = u, i.setEdge(d.v, d.w, v)), v.addBaseEdge(f, this);
        });
      });
    }), i;
  }
  getChildName(t, e) {
    let n = this.index[e];
    for (; n; ) {
      if (n.parentNode && n.parentNode.name === t)
        return n.name;
      n = n.parentNode;
    }
    throw Error("Could not find immediate child for descendant: " + e);
  }
  getPredecessors(t) {
    const e = this.index[t];
    if (!e)
      throw Error("Could not find node with name: " + t);
    return this.getOneWayEdges(e, !0);
  }
  getSuccessors(t) {
    const e = this.index[t];
    if (!e)
      throw Error("Could not find node with name: " + t);
    return this.getOneWayEdges(e, !1);
  }
  getOneWayEdges(t, e) {
    const n = [];
    if (!t.parentNode || !t.parentNode.isGroupNode)
      return n;
    const i = t.parentNode, a = i.metaGraph, o = this.getBridgeGraph(i.name);
    return BM(a, t, e, n), BM(o, t, e, n), n;
  }
}
function Foe(r, t) {
  const { rankDirection: e, align: n } = t, i = new Goe({ rankdir: e, align: n });
  return function(a, o) {
    Object.keys(o.nodes).forEach((s) => {
      const u = o.nodes[s], f = u.path;
      let l = a.root;
      l.depth = Math.max(f.length, l.depth);
      for (let c = 0; c < f.length && (l.depth = Math.max(l.depth, f.length - c), l.cardinality += u.cardinality, c !== f.length - 1); c++) {
        const h = f[c];
        let d = a.node(h);
        d || (d = FB(h, a.graphOptions), d.path = u.path.slice(0, c + 1), d.parentNode = l, a.setNode(h, d), l.metaGraph.setNode(h, d)), l = d;
      }
      a.setNode(u.name, u), u.parentNode = l, l.metaGraph.setNode(u.name, u);
    });
  }(i, r), function(a, o) {
    const s = a.getNodeMap();
    let u = [], f = [];
    const l = (c, h) => {
      let d = 0;
      for (; c; )
        h[d++] = c.name, c = c.parentNode;
      return d - 1;
    };
    o.edges.forEach((c) => {
      u = [], f = [];
      let h = l(o.nodes[c.v], u), d = l(o.nodes[c.w], f);
      for (; u[h] === f[d]; )
        if (h--, d--, h < 0 || d < 0)
          throw Error("No difference found between ancestor paths.");
      const v = s[u[h + 1]], p = u[h], g = f[d];
      let y = v.metaGraph.edge(p, g);
      y || (y = zB(p, g), v.metaGraph.setEdge(p, g, y)), y.addBaseEdge(c, a);
    });
  }(i, r), i;
}
function BM(r, t, e, n) {
  (e ? r.inEdges(t.name) : r.outEdges(t.name)).forEach((i) => {
    const a = r.edge(i);
    n.push(a);
  });
}
class zoe {
  constructor(t) {
    this.hierarchy = t, this.index = {}, this.hasSubHierarchy = {}, this.root = new FM(this.hierarchy.root, this.hierarchy.graphOptions), this.index[t.root.name] = this.root, this.buildSubHierarchy(t.root.name), this.root.expanded = !0;
  }
  getRenderInfoNodes() {
    return Object.values(this.index);
  }
  getSubHierarchy() {
    return this.hasSubHierarchy;
  }
  buildSubHierarchy(t) {
    if (t in this.hasSubHierarchy)
      return;
    this.hasSubHierarchy[t] = !0;
    const e = this.index[t];
    if (e.node.type !== ui.META)
      return;
    const n = e, i = n.node.metaGraph, a = n.coreGraph;
    i.nodes().forEach((l) => {
      const c = this.getOrCreateRenderNodeByName(l);
      a.setNode(l, c);
    }), i.edges().forEach((l) => {
      const c = i.edge(l), h = new GM(c);
      a.setEdge(l.v, l.w, h);
    });
    const o = n.node.parentNode;
    if (!o)
      return;
    const s = this.getRenderNodeByName(o.name), u = (l, ...c) => c.concat([l ? "IN" : "OUT"]).join("~~"), f = this.hierarchy.getBridgeGraph(t);
    f.edges().forEach((l) => {
      const c = f.edge(l), h = !!i.node(l.w), [d, v] = h ? [l.w, l.v] : [l.v, l.w], p = (_) => {
        const w = h ? { v: _, w: t } : { v: t, w: _ };
        return s.coreGraph.edge(w);
      };
      let g = p(v);
      g || (g = p(u(h, v, o.name)));
      const y = u(h, t), b = u(h, v, t);
      let m = a.node(b);
      if (!m) {
        let _ = a.node(y);
        if (!_) {
          const E = { name: y, type: ui.BRIDGE, isGroupNode: !1, cardinality: 0, parentNode: null, include: xu.UNSPECIFIED, inbound: h, attr: {} };
          _ = new Tv(E), this.index[y] = _, a.setNode(y, _);
        }
        const w = { name: b, type: ui.BRIDGE, isGroupNode: !1, cardinality: 1, parentNode: null, include: xu.UNSPECIFIED, inbound: h, attr: {} };
        m = new Tv(w), this.index[b] = m, a.setNode(b, m), a.setParent(b, y), _.node.cardinality++;
      }
      const x = new GM(c);
      x.adjoiningMetaEdge = g, h ? a.setEdge(b, d, x) : a.setEdge(d, b, x);
    });
  }
  getOrCreateRenderNodeByName(t) {
    if (!t)
      return null;
    if (t in this.index)
      return this.index[t];
    const e = this.getNodeByName(t);
    return e ? (this.index[t] = e.isGroupNode ? new FM(e, this.hierarchy.graphOptions) : new Tv(e), this.index[t]) : null;
  }
  getRenderNodeByName(t) {
    return this.index[t];
  }
  getNodeByName(t) {
    return this.hierarchy.node(t);
  }
}
class Tv {
  constructor(t) {
    this.node = t, this.expanded = !1, this.x = 0, this.y = 0, this.coreBox = { width: 0, height: 0 }, this.outboxWidth = 0, this.labelOffset = 0, this.radius = 0, this.labelHeight = 0, this.paddingTop = 0, this.paddingLeft = 0, this.paddingRight = 0, this.paddingBottom = 0, this.width = t.width || 0, this.height = t.height || 0, this.displayName = t.name, this.attr = t.attr;
  }
}
class GM {
  constructor(t) {
    this.metaEdge = t, this.adjoiningMetaEdge = null, this.weight = 1, this.points = [];
  }
}
class FM extends Tv {
  constructor(t, e) {
    super(t);
    const n = t.metaGraph.graph();
    e.compound = !0, this.coreGraph = Bx(n.name, Kf.CORE, e);
  }
}
function UB(r, t) {
  r.node.isGroupNode && function(e, n) {
    const i = Jm(n);
    e.coreGraph.nodes().map((a) => e.coreGraph.node(a)).forEach((a) => {
      var o, s, u, f, l, c;
      const { height: h, width: d } = a;
      switch (a.node.type) {
        case ui.NODE:
          Object.assign(a, i.nodeSize.node), a.height = h || i.nodeSize.node.height, a.width = d || i.nodeSize.node.width;
          break;
        case ui.BRIDGE:
          Object.assign(a, i.nodeSize.bridge);
          break;
        case ui.META:
          a.expanded ? UB(a, n) : (Object.assign(a, i.nodeSize.meta), a.height = i.nodeSize.meta.height, a.width = i.nodeSize.meta.width);
          break;
        default:
          throw Error("Unrecognized node type: " + a.node.type);
      }
      if (!a.expanded) {
        const v = a.attr;
        (function(p, g = !1) {
          if (p.coreBox.width = p.width, p.coreBox.height = p.height, !g) {
            const y = `${p.displayName}`.length, b = 3;
            p.width = Math.max(p.coreBox.width, y * b);
          }
        })(a, n && (a.node.type === 0 && !!(!((s = (o = n == null ? void 0 : n.nodeSize) === null || o === void 0 ? void 0 : o.meta) === null || s === void 0) && s.width) || a.node.type === 1 && (!!(!((f = (u = n == null ? void 0 : n.nodeSize) === null || u === void 0 ? void 0 : u.node) === null || f === void 0) && f.width) || !!v.width) || a.node.type === 2 && !!(!((c = (l = n == null ? void 0 : n.nodeSize) === null || l === void 0 ? void 0 : l.bridge) === null || c === void 0) && c.width)));
      }
    });
  }(r, t), r.node.type === ui.META && function(e, n) {
    const i = Jm(n), a = i.subScene.meta;
    Object.assign(e, a);
    const { nodeSep: o, rankSep: s, edgeSep: u, align: f } = i.graph.meta, l = { nodesep: o, ranksep: s, edgesep: u, align: f };
    Object.assign(e.coreBox, function(d, v) {
      const { ranksep: p, nodesep: g, edgesep: y, align: b } = v;
      Object.assign(d.graph(), { ranksep: p, nodesep: g, edgesep: y, align: b });
      const m = [];
      if (d.nodes().forEach((M) => {
        d.node(M).node.type !== ui.BRIDGE && m.push(M);
      }), !m.length)
        return { width: 0, height: 0 };
      Doe(d);
      let x = 1 / 0, _ = 1 / 0, w = -1 / 0, E = -1 / 0;
      return m.forEach((M) => {
        const C = d.node(M), S = 0.5 * C.width, A = C.x - S, T = C.x + S;
        x = A < x ? A : x, w = T > w ? T : w;
        const P = 0.5 * C.height, k = C.y - P, L = C.y + P;
        _ = k < _ ? k : _, E = L > E ? L : E;
      }), d.edges().forEach((M) => {
        const C = d.edge(M), S = d.node(C.metaEdge.v), A = d.node(C.metaEdge.w);
        if (C.points.length === 3 && function(k) {
          let L = zM(k[0], k[1]);
          for (let O = 1; O < k.length - 1; O++) {
            const D = zM(k[O], k[O + 1]);
            if (Math.abs(D - L) > 1)
              return !1;
            L = D;
          }
          return !0;
        }(C.points)) {
          if (S != null) {
            const k = S.expanded ? S.x : l1(S);
            C.points[0].x = k;
          }
          if (A != null) {
            const k = A.expanded ? A.x : l1(A);
            C.points[2].x = k;
          }
          C.points = [C.points[0], C.points[1]];
        }
        const T = C.points[C.points.length - 2];
        A != null && (C.points[C.points.length - 1] = UM(T, A));
        const P = C.points[1];
        S != null && (C.points[0] = UM(P, S)), C.points.forEach((k) => {
          x = k.x < x ? k.x : x, w = k.x > w ? k.x : w, _ = k.y < _ ? k.y : _, E = k.y > E ? k.y : E;
        });
      }), d.nodes().forEach((M) => {
        const C = d.node(M);
        C.x -= x, C.y -= _;
      }), d.edges().forEach((M) => {
        d.edge(M).points.forEach((C) => {
          C.x -= x, C.y -= _;
        });
      }), { width: w - x, height: E - _ };
    }(e.coreGraph, l));
    let c = 0;
    e.coreGraph.nodeCount() > 0 && c++;
    const h = c <= 1 ? 0 : c;
    e.coreBox.width += h + h, e.coreBox.height = a.labelHeight + e.coreBox.height, e.width = e.coreBox.width + a.paddingLeft + a.paddingRight, e.height = e.paddingTop + e.coreBox.height + e.paddingBottom;
  }(r, t);
}
function zM(r, t) {
  const e = t.x - r.x, n = t.y - r.y;
  return 180 * Math.atan(n / e) / Math.PI;
}
function l1(r) {
  return r.expanded ? r.x : r.x - r.width / 2 + 0 + r.coreBox.width / 2;
}
function UM(r, t) {
  const e = t.expanded ? t.x : l1(t), n = t.y, i = r.x - e, a = r.y - n;
  let o, s, u = t.expanded ? t.width : t.coreBox.width, f = t.expanded ? t.height : t.coreBox.height;
  return Math.abs(a) * u / 2 > Math.abs(i) * f / 2 ? (a < 0 && (f = -f), o = a === 0 ? 0 : f / 2 * i / a, s = f / 2) : (i < 0 && (u = -u), o = u / 2, s = i === 0 ? 0 : u / 2 * a / i), { x: e + o, y: n + s };
}
function Uoe(r, t, e) {
  var n, i, a, o;
  const s = r.nodes.filter((c, h, d) => d.findIndex((v) => v.id === c.id) !== h).map((c) => c.id);
  if (s.length)
    throw new Error(`Duplicated ids found: ${s.join(", ")}`);
  const u = function(c) {
    const h = { nodes: [] }, d = c.compound, v = Object.keys(d || {}), p = /* @__PURE__ */ new Map(), g = (b, m = []) => {
      if (p.has(b))
        return p.get(b);
      for (let x = 0; x < v.length; x++) {
        let _ = v[x];
        if (d && d[_].indexOf(b) !== -1)
          return m.unshift(_), g(_, m);
      }
      return m.length === 0 && p.set(b, m), m;
    }, y = (b) => c.edges.filter((m) => m.w === b).map((m) => ({ name: m.v }));
    return c.nodes.forEach((b) => {
      const m = b.id, x = [...g(m), m];
      let _ = y(m);
      h.nodes.push({ name: m, path: x, inputs: _, width: b.width, height: b.height, attr: Object.assign({}, b) });
    }), h;
  }(r), f = function(c, h) {
    const d = (p, g) => {
      for (let y of g.values())
        if (y.includes(p))
          return !0;
      return !1;
    }, v = (p, g = []) => {
      if (Object.keys(p).length === 0)
        return [...new Set(g)];
      const y = new Map(Object.keys(p).map((m) => [m, p[m]])), b = {};
      for (let [m, x] of y)
        d(m, y) ? b[m] = x : g = g.concat(m, x);
      return v(b, g);
    };
    return v(c).filter((p) => h.includes(p));
  }(r.compound || {}, (t == null ? void 0 : t.expanded) || []), l = function(c, h) {
    return function(d) {
      return new zoe(d);
    }(Foe(Noe(c), h));
  }(u, { rankDirection: ((i = (n = e == null ? void 0 : e.graph) === null || n === void 0 ? void 0 : n.meta) === null || i === void 0 ? void 0 : i.rankDir) || (t == null ? void 0 : t.rankDirection) || up.graph.meta.rankDir, align: ((o = (a = e == null ? void 0 : e.graph) === null || a === void 0 ? void 0 : a.meta) === null || o === void 0 ? void 0 : o.align) || up.graph.meta.align });
  return function(c, h) {
    h.forEach((d) => {
      const v = c.getRenderInfoNodes().find((y) => y.displayName === d);
      let p = v && v.node && v.node.name || "";
      const g = c.getRenderNodeByName(p);
      if (!g)
        throw new Error(`No nodes found: ${p}`);
      g.expanded = !0, c.buildSubHierarchy(p);
    });
  }(l, f), UB(l.root, e), jB(l.root);
}
function joe(r, t = !1) {
  const e = JSON.parse(JSON.stringify(r)), n = { nodes: [e], edges: [...e.edges] };
  return e.nodes.forEach(function i(a) {
    (a.type === 0 || a.type === 1) && n.nodes.push(a), a.type === 0 && (n.edges = n.edges.concat(a.edges)), Array.isArray(a.nodes) && a.nodes.forEach(i);
  }), t && n.nodes.forEach((i) => {
    const a = n.nodes.find((o) => o.id === i.parentNodeName);
    if (a) {
      const o = a.x - a.width / 2 + a.paddingLeft, s = a.y - a.height / 2 + a.labelHeight + a.paddingTop;
      a.id !== Hf && (i.x += o, i.y += s), i.type === 0 && i.edges.forEach((u) => {
        u.points.forEach((f) => {
          f.x += i.x - i.width / 2 + i.paddingLeft, f.y += i.y - i.height / 2 + i.labelHeight + i.paddingTop;
        });
      });
    }
  }), n;
}
function $oe(r, t, e, n) {
  var i, a;
  let o = [];
  const s = ((i = e.find((c) => c.id === r)) === null || i === void 0 ? void 0 : i.path) || [], u = ((a = e.find((c) => c.id === t)) === null || a === void 0 ? void 0 : a.path) || [], f = [Hf, ...s].slice(0, s.length).reverse(), l = [Hf, ...u].slice(0, u.length);
  return f.forEach((c) => {
    const h = e.find((d) => d.id === c);
    o = o.concat(h.edges.filter((d) => d.baseEdgeList.some((v) => v.v === ((n == null ? void 0 : n.v) || r) && v.w === ((n == null ? void 0 : n.w) || t))));
  }), l.filter((c) => !f.includes(c)).forEach((c) => {
    const h = e.find((d) => d.id === c);
    o = o.concat(h.edges.filter((d) => d.baseEdgeList.some((v) => v.v === ((n == null ? void 0 : n.v) || r) && v.w === ((n == null ? void 0 : n.w) || t))));
  }), o;
}
function jB(r) {
  const t = r.coreGraph.nodes().map((n) => r.coreGraph.node(n));
  return Object.assign(Object.assign({}, jM(r)), { expanded: r.expanded, nodes: r.expanded ? (e = t, e.map((n) => n.node.type === ui.META ? jB(n) : jM(n))) : [], edges: r.expanded ? Woe(r) : [] });
  var e;
}
function jM(r) {
  return { id: r.node.name, name: r.node.name, type: r.node.type, cardinality: r.node.cardinality, attr: r.attr, parentNodeName: r.node.parentNode ? r.node.parentNode.name : null, coreBox: Object.assign({}, r.coreBox), x: r.x, y: r.y, width: r.width, height: r.height, radius: r.radius, labelHeight: r.labelHeight, labelOffset: r.labelOffset, outboxWidth: r.outboxWidth, paddingLeft: r.paddingLeft, paddingTop: r.paddingTop, paddingRight: r.paddingRight, paddingBottom: r.paddingBottom, path: r.node.path };
}
function Woe(r) {
  return r.coreGraph.edges().map((t) => ({ renderInfoEdge: r.coreGraph.edge(t), edge: t })).filter(({ renderInfoEdge: t }) => t.metaEdge).map(({ edge: t, renderInfoEdge: e }) => {
    const n = function(i, a) {
      const o = a.points.map((s) => Object.assign({}, s));
      if (a.adjoiningMetaEdge) {
        const s = a.adjoiningMetaEdge.points, u = a.metaEdge.inbound, f = u ? s[s.length - 1] : s[0], l = o[u ? 0 : o.length - 1], c = i.x - i.width / 2, h = i.y - i.height / 2, d = f.x - c, v = f.y - h, p = -i.paddingLeft, g = -(i.paddingTop + i.labelHeight);
        l.x = d + p, l.y = v + g;
      }
      return o;
    }(r, e);
    return { adjoiningEdge: e.adjoiningMetaEdge ? { w: e.adjoiningMetaEdge.metaEdge.w, v: e.adjoiningMetaEdge.metaEdge.v } : null, inbound: e.metaEdge.inbound, w: t.w, v: t.v, points: n, weight: e.weight, baseEdgeList: e.metaEdge.baseEdgeList, parentNodeName: r.node.name };
  });
}
const Voe = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  BRIDGE_GRAPH_NAME: I3,
  get GraphType() {
    return Kf;
  },
  get HierarchyNodeType() {
    return e1;
  },
  get InclusionType() {
    return xu;
  },
  LAYOUT_CONFIG: up,
  get NodeType() {
    return ui;
  },
  ROOT_NAME: Hf,
  buildGraph: Uoe,
  flatGraph: joe,
  getEdges: $oe,
  mergeConfig: Jm
}, Symbol.toStringTag, { value: "Module" })), Xoe = /* @__PURE__ */ Ao(Voe);
var Yoe = Oe && Oe.__extends || function() {
  var r = function(t, e) {
    return r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(n, i) {
      n.__proto__ = i;
    } || function(n, i) {
      for (var a in i)
        Object.prototype.hasOwnProperty.call(i, a) && (n[a] = i[a]);
    }, r(t, e);
  };
  return function(t, e) {
    if (typeof e != "function" && e !== null)
      throw new TypeError("Class extends value " + String(e) + " is not a constructor or null");
    r(t, e);
    function n() {
      this.constructor = t;
    }
    t.prototype = e === null ? Object.create(e) : (n.prototype = e.prototype, new n());
  };
}(), Qi = Oe && Oe.__assign || function() {
  return Qi = Object.assign || function(r) {
    for (var t, e = 1, n = arguments.length; e < n; e++) {
      t = arguments[e];
      for (var i in t)
        Object.prototype.hasOwnProperty.call(t, i) && (r[i] = t[i]);
    }
    return r;
  }, Qi.apply(this, arguments);
}, tf = Oe && Oe.__spreadArray || function(r, t, e) {
  if (e || arguments.length === 2)
    for (var n = 0, i = t.length, a; n < i; n++)
      (a || !(n in t)) && (a || (a = Array.prototype.slice.call(t, 0, n)), a[n] = t[n]);
  return r.concat(a || Array.prototype.slice.call(t));
};
Object.defineProperty(dh, "__esModule", { value: !0 });
dh.DagreCompoundLayout = void 0;
var Hoe = an, Ai = Xoe, kd = on(), Koe = function(r) {
  Yoe(t, r);
  function t(e) {
    var n = r.call(this) || this;
    return n.rankdir = "TB", n.nodesep = 50, n.edgesep = 5, n.ranksep = 50, n.controlPoints = !0, n.anchorPoint = !0, n.nodes = [], n.edges = [], n.combos = [], n.onLayoutEnd = function() {
    }, n.updateCfg(e), n;
  }
  return t.prototype.getDefaultCfg = function() {
    return {
      rankdir: "TB",
      align: void 0,
      begin: void 0,
      nodeSize: void 0,
      nodesep: 50,
      ranksep: 50,
      controlPoints: !0,
      anchorPoint: !0
    };
  }, t.prototype.init = function(e) {
    var n = e.hiddenNodes || [], i = e.hiddenEdges || [], a = e.hiddenCombos || [];
    this.nodes = this.getDataByOrder((e.nodes || []).concat(n)), this.edges = this.getDataByOrder((e.edges || []).concat(i)), this.combos = (e.combos || []).concat(a.map(function(o) {
      return Qi(Qi({}, o), { collapsed: !0 });
    }));
  }, t.prototype.execute = function() {
    var e = this, n = e.nodes, i = e.edges;
    if (!!n) {
      var a = e.getLayoutConfig(), o = a.graphDef, s = a.graphOption, u = a.graphSettings, f = (0, Ai.buildGraph)(o, s, u), l = (0, Ai.flatGraph)(f, !0);
      return this.updatePosition(l), e.onLayoutEnd && e.onLayoutEnd(), {
        nodes: n,
        edges: i
      };
    }
  }, t.prototype.getNodePath = function(e) {
    var n = this, i = n.nodes, a = n.combos, o = i.find(function(u) {
      return u.id === e;
    }), s = function(u, f) {
      f === void 0 && (f = []);
      var l = a.find(function(c) {
        return c.id === u;
      });
      return l ? (f.unshift(u), l.parentId ? s(l.parentId, f) : f) : f;
    };
    return o && o.comboId ? s(o.comboId, [e]) : [e];
  }, t.prototype.getLayoutConfig = function() {
    var e, n, i, a = this, o = a.nodes, s = a.edges, u = a.combos, f = a.nodeSize, l = a.rankdir, c = a.align, h = a.edgesep, d = a.nodesep, v = a.ranksep, p = a.settings, g = (u || []).reduce(function(O, D) {
      var G = o.filter(function(F) {
        return F.comboId === D.id;
      }).map(function(F) {
        return F.id;
      }), R = (u || []).filter(function(F) {
        return F.parentId === D.id;
      }).map(function(F) {
        return F.id;
      });
      return (G.length || R.length) && (O[D.id] = tf(tf([], G, !0), R, !0)), O;
    }, {}), y;
    f ? (0, kd.isArray)(f) ? y = function() {
      return f;
    } : y = function() {
      return [f, f];
    } : y = function(O) {
      return O && O.size ? (0, kd.isArray)(O.size) ? O.size : (0, kd.isObject)(O.size) ? [O.size.width || 40, O.size.height || 40] : [O.size, O.size] : [40, 40];
    };
    var b = function(O) {
      return O && O.size ? (0, kd.isArray)(O.size) ? O.size : [O.size, O.size] : [80, 40];
    }, m = b(u == null ? void 0 : u[0]), x = m[0], _ = m[1], w = (n = (e = a.graphSettings) === null || e === void 0 ? void 0 : e.subScene) === null || n === void 0 ? void 0 : n.meta, E = ((i = u.find(function(O) {
      return !O.collapsed;
    })) === null || i === void 0 ? void 0 : i.padding) || [20, 20, 20, 20], M = E[0], C = E[1], S = E[2], A = E[3], T = {
      compound: g,
      nodes: tf([], (o || []).map(function(O) {
        var D = y(O), G = D[0], R = D[1];
        return Qi(Qi({}, O), { width: G, height: R });
      }), !0),
      edges: tf([], (s || []).map(function(O) {
        return Qi(Qi({}, O), { v: O.source, w: O.target });
      }), !0)
    }, P = {
      expanded: (u || []).filter(function(O) {
        return !O.collapsed;
      }).map(function(O) {
        return O.id;
      })
    }, k = {
      graph: {
        meta: {
          align: c,
          rankDir: l,
          nodeSep: d,
          edgeSep: h,
          rankSep: v
        }
      },
      subScene: {
        meta: {
          paddingTop: M || (w == null ? void 0 : w.paddingTop) || 20,
          paddingRight: C || (w == null ? void 0 : w.paddingRight) || 20,
          paddingBottom: S || (w == null ? void 0 : w.paddingBottom) || 20,
          paddingLeft: A || (w == null ? void 0 : w.paddingLeft) || 20,
          labelHeight: 0
        }
      },
      nodeSize: {
        meta: {
          width: x,
          height: _
        }
      }
    }, L = (0, Ai.mergeConfig)(p, Qi({}, (0, Ai.mergeConfig)(k, Ai.LAYOUT_CONFIG)));
    return a.graphSettings = L, {
      graphDef: T,
      graphOption: P,
      graphSettings: L
    };
  }, t.prototype.updatePosition = function(e) {
    var n = e.nodes, i = e.edges;
    this.updateNodePosition(n, i), this.updateEdgePosition(n, i);
  }, t.prototype.getBegin = function(e, n) {
    var i = this, a = i.begin, o = [0, 0];
    if (a) {
      var s = 1 / 0, u = 1 / 0;
      e.forEach(function(f) {
        s > f.x && (s = f.x), u > f.y && (u = f.y);
      }), n.forEach(function(f) {
        f.points.forEach(function(l) {
          s > l.x && (s = l.x), u > l.y && (u = l.y);
        });
      }), o[0] = a[0] - s, o[1] = a[1] - u;
    }
    return o;
  }, t.prototype.updateNodePosition = function(e, n) {
    var i = this, a = i.combos, o = i.nodes, s = i.edges, u = i.anchorPoint, f = i.graphSettings, l = this.getBegin(e, n);
    e.forEach(function(c) {
      var h, d = c.x, v = c.y, p = c.id, g = c.type, y = c.coreBox;
      if (g === Ai.HierarchyNodeType.META && p !== Ai.ROOT_NAME) {
        var b = a.findIndex(function(E) {
          return E.id === p;
        }), m = (h = f == null ? void 0 : f.subScene) === null || h === void 0 ? void 0 : h.meta;
        a[b].offsetX = d + l[0], a[b].offsetY = v + l[1], a[b].fixSize = [y.width, y.height], a[b].fixCollapseSize = [y.width, y.height], c.expanded ? a[b].padding = [
          m == null ? void 0 : m.paddingTop,
          m == null ? void 0 : m.paddingRight,
          m == null ? void 0 : m.paddingBottom,
          m == null ? void 0 : m.paddingLeft
        ] : a[b].padding = [0, 0, 0, 0];
      } else if (g === Ai.HierarchyNodeType.OP) {
        var b = o.findIndex(function(M) {
          return M.id === p;
        });
        if (o[b].x = d + l[0], o[b].y = v + l[1], u) {
          var x = [], _ = n.filter(function(M) {
            return M.v === p;
          }), w = n.filter(function(M) {
            return M.w === p;
          });
          _.length > 0 && _.forEach(function(M) {
            var C = M.points[0], S = (C.x - d) / c.width + 0.5, A = (C.y - v) / c.height + 0.5;
            x.push([S, A]), M.baseEdgeList.forEach(function(T) {
              var P = s.find(function(k) {
                return k.source === T.v && k.target === T.w;
              });
              P && (P.sourceAnchor = x.length - 1);
            });
          }), w.length > 0 && w.forEach(function(M) {
            var C = M.points[M.points.length - 1], S = (C.x - d) / c.width + 0.5, A = (C.y - v) / c.height + 0.5;
            x.push([S, A]), M.baseEdgeList.forEach(function(T) {
              var P = s.find(function(k) {
                return k.source === T.v && k.target === T.w;
              });
              P && (P.targetAnchor = x.length - 1);
            });
          }), o[b].anchorPoints = x.length > 0 ? x : o[b].anchorPoints || [];
        }
      }
    });
  }, t.prototype.updateEdgePosition = function(e, n) {
    var i = this, a = i.combos, o = i.edges, s = i.controlPoints, u = this.getBegin(e, n);
    s && (a.forEach(function(f) {
      f.inEdges = [], f.outEdges = [];
    }), o.forEach(function(f) {
      var l, c, h, d, v = e.find(function(E) {
        return E.id === f.source;
      }), p = e.find(function(E) {
        return E.id === f.target;
      }), g = [], y = [];
      if (v && p)
        y = (0, Ai.getEdges)(v == null ? void 0 : v.id, p == null ? void 0 : p.id, e);
      else if (!v || !p) {
        var b = i.getNodePath(f.source), m = i.getNodePath(f.target), x = b.reverse().slice(v ? 0 : 1).find(function(E) {
          return e.find(function(M) {
            return M.id === E;
          });
        }), _ = m.reverse().slice(p ? 0 : 1).find(function(E) {
          return e.find(function(M) {
            return M.id === E;
          });
        });
        v = e.find(function(E) {
          return E.id === x;
        }), p = e.find(function(E) {
          return E.id === _;
        }), y = (0, Ai.getEdges)(v == null ? void 0 : v.id, p == null ? void 0 : p.id, e, { v: f.source, w: f.target });
      }
      if (g = y.reduce(function(E, M) {
        return tf(tf([], E, !0), M.points.map(function(C) {
          return Qi(Qi({}, C), { x: C.x + u[0], y: C.y + u[1] });
        }), !0);
      }, []), g = g.slice(1, -1), f.controlPoints = g, (p == null ? void 0 : p.type) === Ai.NodeType.META) {
        var w = a.findIndex(function(E) {
          return E.id === (p == null ? void 0 : p.id);
        });
        if (!a[w] || ((l = a[w].inEdges) === null || l === void 0 ? void 0 : l.some(function(E) {
          return E.source === v.id && E.target === p.id;
        })))
          return;
        (c = a[w].inEdges) === null || c === void 0 || c.push({
          source: v.id,
          target: p.id,
          controlPoints: g
        });
      }
      if ((v == null ? void 0 : v.type) === Ai.NodeType.META) {
        var w = a.findIndex(function(M) {
          return M.id === (v == null ? void 0 : v.id);
        });
        if (!a[w] || ((h = a[w].outEdges) === null || h === void 0 ? void 0 : h.some(function(M) {
          return M.source === v.id && M.target === p.id;
        })))
          return;
        (d = a[w].outEdges) === null || d === void 0 || d.push({
          source: v.id,
          target: p.id,
          controlPoints: g
        });
      }
    }));
  }, t.prototype.getType = function() {
    return "dagreCompound";
  }, t.prototype.getDataByOrder = function(e) {
    return e.every(function(n) {
      return n.layoutOrder !== void 0;
    }) || e.forEach(function(n, i) {
      n.layoutOrder = i;
    }), e.sort(function(n, i) {
      return n.layoutOrder - i.layoutOrder;
    });
  }, t;
}(Hoe.Base);
dh.DagreCompoundLayout = Koe;
var Gx = {}, mg = {}, Fx = {};
const qoe = Object.prototype.toString;
function Nn(r) {
  return qoe.call(r).endsWith("Array]");
}
function Zoe(r) {
  var t = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
  if (!Nn(r))
    throw new TypeError("input must be an array");
  if (r.length === 0)
    throw new TypeError("input must not be empty");
  var e = t.fromIndex, n = e === void 0 ? 0 : e, i = t.toIndex, a = i === void 0 ? r.length : i;
  if (n < 0 || n >= r.length || !Number.isInteger(n))
    throw new Error("fromIndex must be a positive integer smaller than length");
  if (a <= n || a > r.length || !Number.isInteger(a))
    throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");
  for (var o = r[n], s = n + 1; s < a; s++)
    r[s] > o && (o = r[s]);
  return o;
}
function Qoe(r) {
  var t = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
  if (!Nn(r))
    throw new TypeError("input must be an array");
  if (r.length === 0)
    throw new TypeError("input must not be empty");
  var e = t.fromIndex, n = e === void 0 ? 0 : e, i = t.toIndex, a = i === void 0 ? r.length : i;
  if (n < 0 || n >= r.length || !Number.isInteger(n))
    throw new Error("fromIndex must be a positive integer smaller than length");
  if (a <= n || a > r.length || !Number.isInteger(a))
    throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");
  for (var o = r[n], s = n + 1; s < a; s++)
    r[s] < o && (o = r[s]);
  return o;
}
function $M(r) {
  var t = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
  if (Nn(r)) {
    if (r.length === 0)
      throw new TypeError("input must not be empty");
  } else
    throw new TypeError("input must be an array");
  var e;
  if (t.output !== void 0) {
    if (!Nn(t.output))
      throw new TypeError("output option must be an array if specified");
    e = t.output;
  } else
    e = new Array(r.length);
  var n = Qoe(r), i = Zoe(r);
  if (n === i)
    throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");
  var a = t.min, o = a === void 0 ? t.autoMinMax ? n : 0 : a, s = t.max, u = s === void 0 ? t.autoMinMax ? i : 1 : s;
  if (o >= u)
    throw new RangeError("min option must be smaller than max option");
  for (var f = (u - o) / (i - n), l = 0; l < r.length; l++)
    e[l] = (r[l] - n) * f + o;
  return e;
}
const Ld = " ".repeat(2), $B = " ".repeat(4);
function Joe() {
  return WB(this);
}
function WB(r, t = {}) {
  const { maxRows: e = 15, maxColumns: n = 10, maxNumSize: i = 8 } = t;
  return `${r.constructor.name} {
${Ld}[
${$B}${ese(r, e, n, i)}
${Ld}]
${Ld}rows: ${r.rows}
${Ld}columns: ${r.columns}
}`;
}
function ese(r, t, e, n) {
  const { rows: i, columns: a } = r, o = Math.min(i, t), s = Math.min(a, e), u = [];
  for (let f = 0; f < o; f++) {
    let l = [];
    for (let c = 0; c < s; c++)
      l.push(tse(r.get(f, c), n));
    u.push(`${l.join(" ")}`);
  }
  return s !== a && (u[u.length - 1] += ` ... ${a - e} more columns`), o !== i && u.push(`... ${i - t} more rows`), u.join(`
${$B}`);
}
function tse(r, t) {
  const e = String(r);
  if (e.length <= t)
    return e.padEnd(t, " ");
  const n = r.toPrecision(t - 2);
  if (n.length <= t)
    return n;
  const i = r.toExponential(t - 2), a = i.indexOf("e"), o = i.slice(a);
  return i.slice(0, t - o.length) + o;
}
function rse(r, t) {
  r.prototype.add = function(n) {
    return typeof n == "number" ? this.addS(n) : this.addM(n);
  }, r.prototype.addS = function(n) {
    for (let i = 0; i < this.rows; i++)
      for (let a = 0; a < this.columns; a++)
        this.set(i, a, this.get(i, a) + n);
    return this;
  }, r.prototype.addM = function(n) {
    if (n = t.checkMatrix(n), this.rows !== n.rows || this.columns !== n.columns)
      throw new RangeError("Matrices dimensions must be equal");
    for (let i = 0; i < this.rows; i++)
      for (let a = 0; a < this.columns; a++)
        this.set(i, a, this.get(i, a) + n.get(i, a));
    return this;
  }, r.add = function(n, i) {
    return new t(n).add(i);
  }, r.prototype.sub = function(n) {
    return typeof n == "number" ? this.subS(n) : this.subM(n);
  }, r.prototype.subS = function(n) {
    for (let i = 0; i < this.rows; i++)
      for (let a = 0; a < this.columns; a++)
        this.set(i, a, this.get(i, a) - n);
    return this;
  }, r.prototype.subM = function(n) {
    if (n = t.checkMatrix(n), this.rows !== n.rows || this.columns !== n.columns)
      throw new RangeError("Matrices dimensions must be equal");
    for (let i = 0; i < this.rows; i++)
      for (let a = 0; a < this.columns; a++)
        this.set(i, a, this.get(i, a) - n.get(i, a));
    return this;
  }, r.sub = function(n, i) {
    return new t(n).sub(i);
  }, r.prototype.subtract = r.prototype.sub, r.prototype.subtractS = r.prototype.subS, r.prototype.subtractM = r.prototype.subM, r.subtract = r.sub, r.prototype.mul = function(n) {
    return typeof n == "number" ? this.mulS(n) : this.mulM(n);
  }, r.prototype.mulS = function(n) {
    for (let i = 0; i < this.rows; i++)
      for (let a = 0; a < this.columns; a++)
        this.set(i, a, this.get(i, a) * n);
    return this;
  }, r.prototype.mulM = function(n) {
    if (n = t.checkMatrix(n), this.rows !== n.rows || this.columns !== n.columns)
      throw new RangeError("Matrices dimensions must be equal");
    for (let i = 0; i < this.rows; i++)
      for (let a = 0; a < this.columns; a++)
        this.set(i, a, this.get(i, a) * n.get(i, a));
    return this;
  }, r.mul = function(n, i) {
    return new t(n).mul(i);
  }, r.prototype.multiply = r.prototype.mul, r.prototype.multiplyS = r.prototype.mulS, r.prototype.multiplyM = r.prototype.mulM, r.multiply = r.mul, r.prototype.div = function(n) {
    return typeof n == "number" ? this.divS(n) : this.divM(n);
  }, r.prototype.divS = function(n) {
    for (let i = 0; i < this.rows; i++)
      for (let a = 0; a < this.columns; a++)
        this.set(i, a, this.get(i, a) / n);
    return this;
  }, r.prototype.divM = function(n) {
    if (n = t.checkMatrix(n), this.rows !== n.rows || this.columns !== n.columns)
      throw new RangeError("Matrices dimensions must be equal");
    for (let i = 0; i < this.rows; i++)
      for (let a = 0; a < this.columns; a++)
        this.set(i, a, this.get(i, a) / n.get(i, a));
    return this;
  }, r.div = function(n, i) {
    return new t(n).div(i);
  }, r.prototype.divide = r.prototype.div, r.prototype.divideS = r.prototype.divS, r.prototype.divideM = r.prototype.divM, r.divide = r.div, r.prototype.mod = function(n) {
    return typeof n == "number" ? this.modS(n) : this.modM(n);
  }, r.prototype.modS = function(n) {
    for (let i = 0; i < this.rows; i++)
      for (let a = 0; a < this.columns; a++)
        this.set(i, a, this.get(i, a) % n);
    return this;
  }, r.prototype.modM = function(n) {
    if (n = t.checkMatrix(n), this.rows !== n.rows || this.columns !== n.columns)
      throw new RangeError("Matrices dimensions must be equal");
    for (let i = 0; i < this.rows; i++)
      for (let a = 0; a < this.columns; a++)
        this.set(i, a, this.get(i, a) % n.get(i, a));
    return this;
  }, r.mod = function(n, i) {
    return new t(n).mod(i);
  }, r.prototype.modulus = r.prototype.mod, r.prototype.modulusS = r.prototype.modS, r.prototype.modulusM = r.prototype.modM, r.modulus = r.mod, r.prototype.and = function(n) {
    return typeof n == "number" ? this.andS(n) : this.andM(n);
  }, r.prototype.andS = function(n) {
    for (let i = 0; i < this.rows; i++)
      for (let a = 0; a < this.columns; a++)
        this.set(i, a, this.get(i, a) & n);
    return this;
  }, r.prototype.andM = function(n) {
    if (n = t.checkMatrix(n), this.rows !== n.rows || this.columns !== n.columns)
      throw new RangeError("Matrices dimensions must be equal");
    for (let i = 0; i < this.rows; i++)
      for (let a = 0; a < this.columns; a++)
        this.set(i, a, this.get(i, a) & n.get(i, a));
    return this;
  }, r.and = function(n, i) {
    return new t(n).and(i);
  }, r.prototype.or = function(n) {
    return typeof n == "number" ? this.orS(n) : this.orM(n);
  }, r.prototype.orS = function(n) {
    for (let i = 0; i < this.rows; i++)
      for (let a = 0; a < this.columns; a++)
        this.set(i, a, this.get(i, a) | n);
    return this;
  }, r.prototype.orM = function(n) {
    if (n = t.checkMatrix(n), this.rows !== n.rows || this.columns !== n.columns)
      throw new RangeError("Matrices dimensions must be equal");
    for (let i = 0; i < this.rows; i++)
      for (let a = 0; a < this.columns; a++)
        this.set(i, a, this.get(i, a) | n.get(i, a));
    return this;
  }, r.or = function(n, i) {
    return new t(n).or(i);
  }, r.prototype.xor = function(n) {
    return typeof n == "number" ? this.xorS(n) : this.xorM(n);
  }, r.prototype.xorS = function(n) {
    for (let i = 0; i < this.rows; i++)
      for (let a = 0; a < this.columns; a++)
        this.set(i, a, this.get(i, a) ^ n);
    return this;
  }, r.prototype.xorM = function(n) {
    if (n = t.checkMatrix(n), this.rows !== n.rows || this.columns !== n.columns)
      throw new RangeError("Matrices dimensions must be equal");
    for (let i = 0; i < this.rows; i++)
      for (let a = 0; a < this.columns; a++)
        this.set(i, a, this.get(i, a) ^ n.get(i, a));
    return this;
  }, r.xor = function(n, i) {
    return new t(n).xor(i);
  }, r.prototype.leftShift = function(n) {
    return typeof n == "number" ? this.leftShiftS(n) : this.leftShiftM(n);
  }, r.prototype.leftShiftS = function(n) {
    for (let i = 0; i < this.rows; i++)
      for (let a = 0; a < this.columns; a++)
        this.set(i, a, this.get(i, a) << n);
    return this;
  }, r.prototype.leftShiftM = function(n) {
    if (n = t.checkMatrix(n), this.rows !== n.rows || this.columns !== n.columns)
      throw new RangeError("Matrices dimensions must be equal");
    for (let i = 0; i < this.rows; i++)
      for (let a = 0; a < this.columns; a++)
        this.set(i, a, this.get(i, a) << n.get(i, a));
    return this;
  }, r.leftShift = function(n, i) {
    return new t(n).leftShift(i);
  }, r.prototype.signPropagatingRightShift = function(n) {
    return typeof n == "number" ? this.signPropagatingRightShiftS(n) : this.signPropagatingRightShiftM(n);
  }, r.prototype.signPropagatingRightShiftS = function(n) {
    for (let i = 0; i < this.rows; i++)
      for (let a = 0; a < this.columns; a++)
        this.set(i, a, this.get(i, a) >> n);
    return this;
  }, r.prototype.signPropagatingRightShiftM = function(n) {
    if (n = t.checkMatrix(n), this.rows !== n.rows || this.columns !== n.columns)
      throw new RangeError("Matrices dimensions must be equal");
    for (let i = 0; i < this.rows; i++)
      for (let a = 0; a < this.columns; a++)
        this.set(i, a, this.get(i, a) >> n.get(i, a));
    return this;
  }, r.signPropagatingRightShift = function(n, i) {
    return new t(n).signPropagatingRightShift(i);
  }, r.prototype.rightShift = function(n) {
    return typeof n == "number" ? this.rightShiftS(n) : this.rightShiftM(n);
  }, r.prototype.rightShiftS = function(n) {
    for (let i = 0; i < this.rows; i++)
      for (let a = 0; a < this.columns; a++)
        this.set(i, a, this.get(i, a) >>> n);
    return this;
  }, r.prototype.rightShiftM = function(n) {
    if (n = t.checkMatrix(n), this.rows !== n.rows || this.columns !== n.columns)
      throw new RangeError("Matrices dimensions must be equal");
    for (let i = 0; i < this.rows; i++)
      for (let a = 0; a < this.columns; a++)
        this.set(i, a, this.get(i, a) >>> n.get(i, a));
    return this;
  }, r.rightShift = function(n, i) {
    return new t(n).rightShift(i);
  }, r.prototype.zeroFillRightShift = r.prototype.rightShift, r.prototype.zeroFillRightShiftS = r.prototype.rightShiftS, r.prototype.zeroFillRightShiftM = r.prototype.rightShiftM, r.zeroFillRightShift = r.rightShift, r.prototype.not = function() {
    for (let n = 0; n < this.rows; n++)
      for (let i = 0; i < this.columns; i++)
        this.set(n, i, ~this.get(n, i));
    return this;
  }, r.not = function(n) {
    return new t(n).not();
  }, r.prototype.abs = function() {
    for (let n = 0; n < this.rows; n++)
      for (let i = 0; i < this.columns; i++)
        this.set(n, i, Math.abs(this.get(n, i)));
    return this;
  }, r.abs = function(n) {
    return new t(n).abs();
  }, r.prototype.acos = function() {
    for (let n = 0; n < this.rows; n++)
      for (let i = 0; i < this.columns; i++)
        this.set(n, i, Math.acos(this.get(n, i)));
    return this;
  }, r.acos = function(n) {
    return new t(n).acos();
  }, r.prototype.acosh = function() {
    for (let n = 0; n < this.rows; n++)
      for (let i = 0; i < this.columns; i++)
        this.set(n, i, Math.acosh(this.get(n, i)));
    return this;
  }, r.acosh = function(n) {
    return new t(n).acosh();
  }, r.prototype.asin = function() {
    for (let n = 0; n < this.rows; n++)
      for (let i = 0; i < this.columns; i++)
        this.set(n, i, Math.asin(this.get(n, i)));
    return this;
  }, r.asin = function(n) {
    return new t(n).asin();
  }, r.prototype.asinh = function() {
    for (let n = 0; n < this.rows; n++)
      for (let i = 0; i < this.columns; i++)
        this.set(n, i, Math.asinh(this.get(n, i)));
    return this;
  }, r.asinh = function(n) {
    return new t(n).asinh();
  }, r.prototype.atan = function() {
    for (let n = 0; n < this.rows; n++)
      for (let i = 0; i < this.columns; i++)
        this.set(n, i, Math.atan(this.get(n, i)));
    return this;
  }, r.atan = function(n) {
    return new t(n).atan();
  }, r.prototype.atanh = function() {
    for (let n = 0; n < this.rows; n++)
      for (let i = 0; i < this.columns; i++)
        this.set(n, i, Math.atanh(this.get(n, i)));
    return this;
  }, r.atanh = function(n) {
    return new t(n).atanh();
  }, r.prototype.cbrt = function() {
    for (let n = 0; n < this.rows; n++)
      for (let i = 0; i < this.columns; i++)
        this.set(n, i, Math.cbrt(this.get(n, i)));
    return this;
  }, r.cbrt = function(n) {
    return new t(n).cbrt();
  }, r.prototype.ceil = function() {
    for (let n = 0; n < this.rows; n++)
      for (let i = 0; i < this.columns; i++)
        this.set(n, i, Math.ceil(this.get(n, i)));
    return this;
  }, r.ceil = function(n) {
    return new t(n).ceil();
  }, r.prototype.clz32 = function() {
    for (let n = 0; n < this.rows; n++)
      for (let i = 0; i < this.columns; i++)
        this.set(n, i, Math.clz32(this.get(n, i)));
    return this;
  }, r.clz32 = function(n) {
    return new t(n).clz32();
  }, r.prototype.cos = function() {
    for (let n = 0; n < this.rows; n++)
      for (let i = 0; i < this.columns; i++)
        this.set(n, i, Math.cos(this.get(n, i)));
    return this;
  }, r.cos = function(n) {
    return new t(n).cos();
  }, r.prototype.cosh = function() {
    for (let n = 0; n < this.rows; n++)
      for (let i = 0; i < this.columns; i++)
        this.set(n, i, Math.cosh(this.get(n, i)));
    return this;
  }, r.cosh = function(n) {
    return new t(n).cosh();
  }, r.prototype.exp = function() {
    for (let n = 0; n < this.rows; n++)
      for (let i = 0; i < this.columns; i++)
        this.set(n, i, Math.exp(this.get(n, i)));
    return this;
  }, r.exp = function(n) {
    return new t(n).exp();
  }, r.prototype.expm1 = function() {
    for (let n = 0; n < this.rows; n++)
      for (let i = 0; i < this.columns; i++)
        this.set(n, i, Math.expm1(this.get(n, i)));
    return this;
  }, r.expm1 = function(n) {
    return new t(n).expm1();
  }, r.prototype.floor = function() {
    for (let n = 0; n < this.rows; n++)
      for (let i = 0; i < this.columns; i++)
        this.set(n, i, Math.floor(this.get(n, i)));
    return this;
  }, r.floor = function(n) {
    return new t(n).floor();
  }, r.prototype.fround = function() {
    for (let n = 0; n < this.rows; n++)
      for (let i = 0; i < this.columns; i++)
        this.set(n, i, Math.fround(this.get(n, i)));
    return this;
  }, r.fround = function(n) {
    return new t(n).fround();
  }, r.prototype.log = function() {
    for (let n = 0; n < this.rows; n++)
      for (let i = 0; i < this.columns; i++)
        this.set(n, i, Math.log(this.get(n, i)));
    return this;
  }, r.log = function(n) {
    return new t(n).log();
  }, r.prototype.log1p = function() {
    for (let n = 0; n < this.rows; n++)
      for (let i = 0; i < this.columns; i++)
        this.set(n, i, Math.log1p(this.get(n, i)));
    return this;
  }, r.log1p = function(n) {
    return new t(n).log1p();
  }, r.prototype.log10 = function() {
    for (let n = 0; n < this.rows; n++)
      for (let i = 0; i < this.columns; i++)
        this.set(n, i, Math.log10(this.get(n, i)));
    return this;
  }, r.log10 = function(n) {
    return new t(n).log10();
  }, r.prototype.log2 = function() {
    for (let n = 0; n < this.rows; n++)
      for (let i = 0; i < this.columns; i++)
        this.set(n, i, Math.log2(this.get(n, i)));
    return this;
  }, r.log2 = function(n) {
    return new t(n).log2();
  }, r.prototype.round = function() {
    for (let n = 0; n < this.rows; n++)
      for (let i = 0; i < this.columns; i++)
        this.set(n, i, Math.round(this.get(n, i)));
    return this;
  }, r.round = function(n) {
    return new t(n).round();
  }, r.prototype.sign = function() {
    for (let n = 0; n < this.rows; n++)
      for (let i = 0; i < this.columns; i++)
        this.set(n, i, Math.sign(this.get(n, i)));
    return this;
  }, r.sign = function(n) {
    return new t(n).sign();
  }, r.prototype.sin = function() {
    for (let n = 0; n < this.rows; n++)
      for (let i = 0; i < this.columns; i++)
        this.set(n, i, Math.sin(this.get(n, i)));
    return this;
  }, r.sin = function(n) {
    return new t(n).sin();
  }, r.prototype.sinh = function() {
    for (let n = 0; n < this.rows; n++)
      for (let i = 0; i < this.columns; i++)
        this.set(n, i, Math.sinh(this.get(n, i)));
    return this;
  }, r.sinh = function(n) {
    return new t(n).sinh();
  }, r.prototype.sqrt = function() {
    for (let n = 0; n < this.rows; n++)
      for (let i = 0; i < this.columns; i++)
        this.set(n, i, Math.sqrt(this.get(n, i)));
    return this;
  }, r.sqrt = function(n) {
    return new t(n).sqrt();
  }, r.prototype.tan = function() {
    for (let n = 0; n < this.rows; n++)
      for (let i = 0; i < this.columns; i++)
        this.set(n, i, Math.tan(this.get(n, i)));
    return this;
  }, r.tan = function(n) {
    return new t(n).tan();
  }, r.prototype.tanh = function() {
    for (let n = 0; n < this.rows; n++)
      for (let i = 0; i < this.columns; i++)
        this.set(n, i, Math.tanh(this.get(n, i)));
    return this;
  }, r.tanh = function(n) {
    return new t(n).tanh();
  }, r.prototype.trunc = function() {
    for (let n = 0; n < this.rows; n++)
      for (let i = 0; i < this.columns; i++)
        this.set(n, i, Math.trunc(this.get(n, i)));
    return this;
  }, r.trunc = function(n) {
    return new t(n).trunc();
  }, r.pow = function(n, i) {
    return new t(n).pow(i);
  }, r.prototype.pow = function(n) {
    return typeof n == "number" ? this.powS(n) : this.powM(n);
  }, r.prototype.powS = function(n) {
    for (let i = 0; i < this.rows; i++)
      for (let a = 0; a < this.columns; a++)
        this.set(i, a, Math.pow(this.get(i, a), n));
    return this;
  }, r.prototype.powM = function(n) {
    if (n = t.checkMatrix(n), this.rows !== n.rows || this.columns !== n.columns)
      throw new RangeError("Matrices dimensions must be equal");
    for (let i = 0; i < this.rows; i++)
      for (let a = 0; a < this.columns; a++)
        this.set(i, a, Math.pow(this.get(i, a), n.get(i, a)));
    return this;
  };
}
function Li(r, t, e) {
  let n = e ? r.rows : r.rows - 1;
  if (t < 0 || t > n)
    throw new RangeError("Row index out of range");
}
function Ni(r, t, e) {
  let n = e ? r.columns : r.columns - 1;
  if (t < 0 || t > n)
    throw new RangeError("Column index out of range");
}
function _f(r, t) {
  if (t.to1DArray && (t = t.to1DArray()), t.length !== r.columns)
    throw new RangeError(
      "vector size must be the same as the number of columns"
    );
  return t;
}
function wf(r, t) {
  if (t.to1DArray && (t = t.to1DArray()), t.length !== r.rows)
    throw new RangeError("vector size must be the same as the number of rows");
  return t;
}
function zx(r, t) {
  if (!Nn(t))
    throw new TypeError("row indices must be an array");
  for (let e = 0; e < t.length; e++)
    if (t[e] < 0 || t[e] >= r.rows)
      throw new RangeError("row indices are out of range");
}
function Ux(r, t) {
  if (!Nn(t))
    throw new TypeError("column indices must be an array");
  for (let e = 0; e < t.length; e++)
    if (t[e] < 0 || t[e] >= r.columns)
      throw new RangeError("column indices are out of range");
}
function c1(r, t, e, n, i) {
  if (arguments.length !== 5)
    throw new RangeError("expected 4 arguments");
  if (Nd("startRow", t), Nd("endRow", e), Nd("startColumn", n), Nd("endColumn", i), t > e || n > i || t < 0 || t >= r.rows || e < 0 || e >= r.rows || n < 0 || n >= r.columns || i < 0 || i >= r.columns)
    throw new RangeError("Submatrix indices are out of range");
}
function bg(r, t = 0) {
  let e = [];
  for (let n = 0; n < r; n++)
    e.push(t);
  return e;
}
function Nd(r, t) {
  if (typeof t != "number")
    throw new TypeError(`${r} must be a number`);
}
function rf(r) {
  if (r.isEmpty())
    throw new Error("Empty matrix has no elements to index");
}
function nse(r) {
  let t = bg(r.rows);
  for (let e = 0; e < r.rows; ++e)
    for (let n = 0; n < r.columns; ++n)
      t[e] += r.get(e, n);
  return t;
}
function ise(r) {
  let t = bg(r.columns);
  for (let e = 0; e < r.rows; ++e)
    for (let n = 0; n < r.columns; ++n)
      t[n] += r.get(e, n);
  return t;
}
function ase(r) {
  let t = 0;
  for (let e = 0; e < r.rows; e++)
    for (let n = 0; n < r.columns; n++)
      t += r.get(e, n);
  return t;
}
function ose(r) {
  let t = bg(r.rows, 1);
  for (let e = 0; e < r.rows; ++e)
    for (let n = 0; n < r.columns; ++n)
      t[e] *= r.get(e, n);
  return t;
}
function sse(r) {
  let t = bg(r.columns, 1);
  for (let e = 0; e < r.rows; ++e)
    for (let n = 0; n < r.columns; ++n)
      t[n] *= r.get(e, n);
  return t;
}
function use(r) {
  let t = 1;
  for (let e = 0; e < r.rows; e++)
    for (let n = 0; n < r.columns; n++)
      t *= r.get(e, n);
  return t;
}
function fse(r, t, e) {
  const n = r.rows, i = r.columns, a = [];
  for (let o = 0; o < n; o++) {
    let s = 0, u = 0, f = 0;
    for (let l = 0; l < i; l++)
      f = r.get(o, l) - e[o], s += f, u += f * f;
    t ? a.push((u - s * s / i) / (i - 1)) : a.push((u - s * s / i) / i);
  }
  return a;
}
function lse(r, t, e) {
  const n = r.rows, i = r.columns, a = [];
  for (let o = 0; o < i; o++) {
    let s = 0, u = 0, f = 0;
    for (let l = 0; l < n; l++)
      f = r.get(l, o) - e[o], s += f, u += f * f;
    t ? a.push((u - s * s / n) / (n - 1)) : a.push((u - s * s / n) / n);
  }
  return a;
}
function cse(r, t, e) {
  const n = r.rows, i = r.columns, a = n * i;
  let o = 0, s = 0, u = 0;
  for (let f = 0; f < n; f++)
    for (let l = 0; l < i; l++)
      u = r.get(f, l) - e, o += u, s += u * u;
  return t ? (s - o * o / a) / (a - 1) : (s - o * o / a) / a;
}
function hse(r, t) {
  for (let e = 0; e < r.rows; e++)
    for (let n = 0; n < r.columns; n++)
      r.set(e, n, r.get(e, n) - t[e]);
}
function dse(r, t) {
  for (let e = 0; e < r.rows; e++)
    for (let n = 0; n < r.columns; n++)
      r.set(e, n, r.get(e, n) - t[n]);
}
function vse(r, t) {
  for (let e = 0; e < r.rows; e++)
    for (let n = 0; n < r.columns; n++)
      r.set(e, n, r.get(e, n) - t);
}
function pse(r) {
  const t = [];
  for (let e = 0; e < r.rows; e++) {
    let n = 0;
    for (let i = 0; i < r.columns; i++)
      n += Math.pow(r.get(e, i), 2) / (r.columns - 1);
    t.push(Math.sqrt(n));
  }
  return t;
}
function gse(r, t) {
  for (let e = 0; e < r.rows; e++)
    for (let n = 0; n < r.columns; n++)
      r.set(e, n, r.get(e, n) / t[e]);
}
function yse(r) {
  const t = [];
  for (let e = 0; e < r.columns; e++) {
    let n = 0;
    for (let i = 0; i < r.rows; i++)
      n += Math.pow(r.get(i, e), 2) / (r.rows - 1);
    t.push(Math.sqrt(n));
  }
  return t;
}
function mse(r, t) {
  for (let e = 0; e < r.rows; e++)
    for (let n = 0; n < r.columns; n++)
      r.set(e, n, r.get(e, n) / t[n]);
}
function bse(r) {
  const t = r.size - 1;
  let e = 0;
  for (let n = 0; n < r.columns; n++)
    for (let i = 0; i < r.rows; i++)
      e += Math.pow(r.get(i, n), 2) / t;
  return Math.sqrt(e);
}
function xse(r, t) {
  for (let e = 0; e < r.rows; e++)
    for (let n = 0; n < r.columns; n++)
      r.set(e, n, r.get(e, n) / t);
}
class ur {
  static from1DArray(t, e, n) {
    if (t * e !== n.length)
      throw new RangeError("data length does not match given dimensions");
    let a = new Ct(t, e);
    for (let o = 0; o < t; o++)
      for (let s = 0; s < e; s++)
        a.set(o, s, n[o * e + s]);
    return a;
  }
  static rowVector(t) {
    let e = new Ct(1, t.length);
    for (let n = 0; n < t.length; n++)
      e.set(0, n, t[n]);
    return e;
  }
  static columnVector(t) {
    let e = new Ct(t.length, 1);
    for (let n = 0; n < t.length; n++)
      e.set(n, 0, t[n]);
    return e;
  }
  static zeros(t, e) {
    return new Ct(t, e);
  }
  static ones(t, e) {
    return new Ct(t, e).fill(1);
  }
  static rand(t, e, n = {}) {
    if (typeof n != "object")
      throw new TypeError("options must be an object");
    const { random: i = Math.random } = n;
    let a = new Ct(t, e);
    for (let o = 0; o < t; o++)
      for (let s = 0; s < e; s++)
        a.set(o, s, i());
    return a;
  }
  static randInt(t, e, n = {}) {
    if (typeof n != "object")
      throw new TypeError("options must be an object");
    const { min: i = 0, max: a = 1e3, random: o = Math.random } = n;
    if (!Number.isInteger(i))
      throw new TypeError("min must be an integer");
    if (!Number.isInteger(a))
      throw new TypeError("max must be an integer");
    if (i >= a)
      throw new RangeError("min must be smaller than max");
    let s = a - i, u = new Ct(t, e);
    for (let f = 0; f < t; f++)
      for (let l = 0; l < e; l++) {
        let c = i + Math.round(o() * s);
        u.set(f, l, c);
      }
    return u;
  }
  static eye(t, e, n) {
    e === void 0 && (e = t), n === void 0 && (n = 1);
    let i = Math.min(t, e), a = this.zeros(t, e);
    for (let o = 0; o < i; o++)
      a.set(o, o, n);
    return a;
  }
  static diag(t, e, n) {
    let i = t.length;
    e === void 0 && (e = i), n === void 0 && (n = e);
    let a = Math.min(i, e, n), o = this.zeros(e, n);
    for (let s = 0; s < a; s++)
      o.set(s, s, t[s]);
    return o;
  }
  static min(t, e) {
    t = this.checkMatrix(t), e = this.checkMatrix(e);
    let n = t.rows, i = t.columns, a = new Ct(n, i);
    for (let o = 0; o < n; o++)
      for (let s = 0; s < i; s++)
        a.set(o, s, Math.min(t.get(o, s), e.get(o, s)));
    return a;
  }
  static max(t, e) {
    t = this.checkMatrix(t), e = this.checkMatrix(e);
    let n = t.rows, i = t.columns, a = new this(n, i);
    for (let o = 0; o < n; o++)
      for (let s = 0; s < i; s++)
        a.set(o, s, Math.max(t.get(o, s), e.get(o, s)));
    return a;
  }
  static checkMatrix(t) {
    return ur.isMatrix(t) ? t : new Ct(t);
  }
  static isMatrix(t) {
    return t != null && t.klass === "Matrix";
  }
  get size() {
    return this.rows * this.columns;
  }
  apply(t) {
    if (typeof t != "function")
      throw new TypeError("callback must be a function");
    for (let e = 0; e < this.rows; e++)
      for (let n = 0; n < this.columns; n++)
        t.call(this, e, n);
    return this;
  }
  to1DArray() {
    let t = [];
    for (let e = 0; e < this.rows; e++)
      for (let n = 0; n < this.columns; n++)
        t.push(this.get(e, n));
    return t;
  }
  to2DArray() {
    let t = [];
    for (let e = 0; e < this.rows; e++) {
      t.push([]);
      for (let n = 0; n < this.columns; n++)
        t[e].push(this.get(e, n));
    }
    return t;
  }
  toJSON() {
    return this.to2DArray();
  }
  isRowVector() {
    return this.rows === 1;
  }
  isColumnVector() {
    return this.columns === 1;
  }
  isVector() {
    return this.rows === 1 || this.columns === 1;
  }
  isSquare() {
    return this.rows === this.columns;
  }
  isEmpty() {
    return this.rows === 0 || this.columns === 0;
  }
  isSymmetric() {
    if (this.isSquare()) {
      for (let t = 0; t < this.rows; t++)
        for (let e = 0; e <= t; e++)
          if (this.get(t, e) !== this.get(e, t))
            return !1;
      return !0;
    }
    return !1;
  }
  isEchelonForm() {
    let t = 0, e = 0, n = -1, i = !0, a = !1;
    for (; t < this.rows && i; ) {
      for (e = 0, a = !1; e < this.columns && a === !1; )
        this.get(t, e) === 0 ? e++ : this.get(t, e) === 1 && e > n ? (a = !0, n = e) : (i = !1, a = !0);
      t++;
    }
    return i;
  }
  isReducedEchelonForm() {
    let t = 0, e = 0, n = -1, i = !0, a = !1;
    for (; t < this.rows && i; ) {
      for (e = 0, a = !1; e < this.columns && a === !1; )
        this.get(t, e) === 0 ? e++ : this.get(t, e) === 1 && e > n ? (a = !0, n = e) : (i = !1, a = !0);
      for (let o = e + 1; o < this.rows; o++)
        this.get(t, o) !== 0 && (i = !1);
      t++;
    }
    return i;
  }
  echelonForm() {
    let t = this.clone(), e = 0, n = 0;
    for (; e < t.rows && n < t.columns; ) {
      let i = e;
      for (let a = e; a < t.rows; a++)
        t.get(a, n) > t.get(i, n) && (i = a);
      if (t.get(i, n) === 0)
        n++;
      else {
        t.swapRows(e, i);
        let a = t.get(e, n);
        for (let o = n; o < t.columns; o++)
          t.set(e, o, t.get(e, o) / a);
        for (let o = e + 1; o < t.rows; o++) {
          let s = t.get(o, n) / t.get(e, n);
          t.set(o, n, 0);
          for (let u = n + 1; u < t.columns; u++)
            t.set(o, u, t.get(o, u) - t.get(e, u) * s);
        }
        e++, n++;
      }
    }
    return t;
  }
  reducedEchelonForm() {
    let t = this.echelonForm(), e = t.columns, n = t.rows, i = n - 1;
    for (; i >= 0; )
      if (t.maxRow(i) === 0)
        i--;
      else {
        let a = 0, o = !1;
        for (; a < n && o === !1; )
          t.get(i, a) === 1 ? o = !0 : a++;
        for (let s = 0; s < i; s++) {
          let u = t.get(s, a);
          for (let f = a; f < e; f++) {
            let l = t.get(s, f) - u * t.get(i, f);
            t.set(s, f, l);
          }
        }
        i--;
      }
    return t;
  }
  set() {
    throw new Error("set method is unimplemented");
  }
  get() {
    throw new Error("get method is unimplemented");
  }
  repeat(t = {}) {
    if (typeof t != "object")
      throw new TypeError("options must be an object");
    const { rows: e = 1, columns: n = 1 } = t;
    if (!Number.isInteger(e) || e <= 0)
      throw new TypeError("rows must be a positive integer");
    if (!Number.isInteger(n) || n <= 0)
      throw new TypeError("columns must be a positive integer");
    let i = new Ct(this.rows * e, this.columns * n);
    for (let a = 0; a < e; a++)
      for (let o = 0; o < n; o++)
        i.setSubMatrix(this, this.rows * a, this.columns * o);
    return i;
  }
  fill(t) {
    for (let e = 0; e < this.rows; e++)
      for (let n = 0; n < this.columns; n++)
        this.set(e, n, t);
    return this;
  }
  neg() {
    return this.mulS(-1);
  }
  getRow(t) {
    Li(this, t);
    let e = [];
    for (let n = 0; n < this.columns; n++)
      e.push(this.get(t, n));
    return e;
  }
  getRowVector(t) {
    return Ct.rowVector(this.getRow(t));
  }
  setRow(t, e) {
    Li(this, t), e = _f(this, e);
    for (let n = 0; n < this.columns; n++)
      this.set(t, n, e[n]);
    return this;
  }
  swapRows(t, e) {
    Li(this, t), Li(this, e);
    for (let n = 0; n < this.columns; n++) {
      let i = this.get(t, n);
      this.set(t, n, this.get(e, n)), this.set(e, n, i);
    }
    return this;
  }
  getColumn(t) {
    Ni(this, t);
    let e = [];
    for (let n = 0; n < this.rows; n++)
      e.push(this.get(n, t));
    return e;
  }
  getColumnVector(t) {
    return Ct.columnVector(this.getColumn(t));
  }
  setColumn(t, e) {
    Ni(this, t), e = wf(this, e);
    for (let n = 0; n < this.rows; n++)
      this.set(n, t, e[n]);
    return this;
  }
  swapColumns(t, e) {
    Ni(this, t), Ni(this, e);
    for (let n = 0; n < this.rows; n++) {
      let i = this.get(n, t);
      this.set(n, t, this.get(n, e)), this.set(n, e, i);
    }
    return this;
  }
  addRowVector(t) {
    t = _f(this, t);
    for (let e = 0; e < this.rows; e++)
      for (let n = 0; n < this.columns; n++)
        this.set(e, n, this.get(e, n) + t[n]);
    return this;
  }
  subRowVector(t) {
    t = _f(this, t);
    for (let e = 0; e < this.rows; e++)
      for (let n = 0; n < this.columns; n++)
        this.set(e, n, this.get(e, n) - t[n]);
    return this;
  }
  mulRowVector(t) {
    t = _f(this, t);
    for (let e = 0; e < this.rows; e++)
      for (let n = 0; n < this.columns; n++)
        this.set(e, n, this.get(e, n) * t[n]);
    return this;
  }
  divRowVector(t) {
    t = _f(this, t);
    for (let e = 0; e < this.rows; e++)
      for (let n = 0; n < this.columns; n++)
        this.set(e, n, this.get(e, n) / t[n]);
    return this;
  }
  addColumnVector(t) {
    t = wf(this, t);
    for (let e = 0; e < this.rows; e++)
      for (let n = 0; n < this.columns; n++)
        this.set(e, n, this.get(e, n) + t[e]);
    return this;
  }
  subColumnVector(t) {
    t = wf(this, t);
    for (let e = 0; e < this.rows; e++)
      for (let n = 0; n < this.columns; n++)
        this.set(e, n, this.get(e, n) - t[e]);
    return this;
  }
  mulColumnVector(t) {
    t = wf(this, t);
    for (let e = 0; e < this.rows; e++)
      for (let n = 0; n < this.columns; n++)
        this.set(e, n, this.get(e, n) * t[e]);
    return this;
  }
  divColumnVector(t) {
    t = wf(this, t);
    for (let e = 0; e < this.rows; e++)
      for (let n = 0; n < this.columns; n++)
        this.set(e, n, this.get(e, n) / t[e]);
    return this;
  }
  mulRow(t, e) {
    Li(this, t);
    for (let n = 0; n < this.columns; n++)
      this.set(t, n, this.get(t, n) * e);
    return this;
  }
  mulColumn(t, e) {
    Ni(this, t);
    for (let n = 0; n < this.rows; n++)
      this.set(n, t, this.get(n, t) * e);
    return this;
  }
  max(t) {
    if (this.isEmpty())
      return NaN;
    switch (t) {
      case "row": {
        const e = new Array(this.rows).fill(Number.NEGATIVE_INFINITY);
        for (let n = 0; n < this.rows; n++)
          for (let i = 0; i < this.columns; i++)
            this.get(n, i) > e[n] && (e[n] = this.get(n, i));
        return e;
      }
      case "column": {
        const e = new Array(this.columns).fill(Number.NEGATIVE_INFINITY);
        for (let n = 0; n < this.rows; n++)
          for (let i = 0; i < this.columns; i++)
            this.get(n, i) > e[i] && (e[i] = this.get(n, i));
        return e;
      }
      case void 0: {
        let e = this.get(0, 0);
        for (let n = 0; n < this.rows; n++)
          for (let i = 0; i < this.columns; i++)
            this.get(n, i) > e && (e = this.get(n, i));
        return e;
      }
      default:
        throw new Error(`invalid option: ${t}`);
    }
  }
  maxIndex() {
    rf(this);
    let t = this.get(0, 0), e = [0, 0];
    for (let n = 0; n < this.rows; n++)
      for (let i = 0; i < this.columns; i++)
        this.get(n, i) > t && (t = this.get(n, i), e[0] = n, e[1] = i);
    return e;
  }
  min(t) {
    if (this.isEmpty())
      return NaN;
    switch (t) {
      case "row": {
        const e = new Array(this.rows).fill(Number.POSITIVE_INFINITY);
        for (let n = 0; n < this.rows; n++)
          for (let i = 0; i < this.columns; i++)
            this.get(n, i) < e[n] && (e[n] = this.get(n, i));
        return e;
      }
      case "column": {
        const e = new Array(this.columns).fill(Number.POSITIVE_INFINITY);
        for (let n = 0; n < this.rows; n++)
          for (let i = 0; i < this.columns; i++)
            this.get(n, i) < e[i] && (e[i] = this.get(n, i));
        return e;
      }
      case void 0: {
        let e = this.get(0, 0);
        for (let n = 0; n < this.rows; n++)
          for (let i = 0; i < this.columns; i++)
            this.get(n, i) < e && (e = this.get(n, i));
        return e;
      }
      default:
        throw new Error(`invalid option: ${t}`);
    }
  }
  minIndex() {
    rf(this);
    let t = this.get(0, 0), e = [0, 0];
    for (let n = 0; n < this.rows; n++)
      for (let i = 0; i < this.columns; i++)
        this.get(n, i) < t && (t = this.get(n, i), e[0] = n, e[1] = i);
    return e;
  }
  maxRow(t) {
    if (Li(this, t), this.isEmpty())
      return NaN;
    let e = this.get(t, 0);
    for (let n = 1; n < this.columns; n++)
      this.get(t, n) > e && (e = this.get(t, n));
    return e;
  }
  maxRowIndex(t) {
    Li(this, t), rf(this);
    let e = this.get(t, 0), n = [t, 0];
    for (let i = 1; i < this.columns; i++)
      this.get(t, i) > e && (e = this.get(t, i), n[1] = i);
    return n;
  }
  minRow(t) {
    if (Li(this, t), this.isEmpty())
      return NaN;
    let e = this.get(t, 0);
    for (let n = 1; n < this.columns; n++)
      this.get(t, n) < e && (e = this.get(t, n));
    return e;
  }
  minRowIndex(t) {
    Li(this, t), rf(this);
    let e = this.get(t, 0), n = [t, 0];
    for (let i = 1; i < this.columns; i++)
      this.get(t, i) < e && (e = this.get(t, i), n[1] = i);
    return n;
  }
  maxColumn(t) {
    if (Ni(this, t), this.isEmpty())
      return NaN;
    let e = this.get(0, t);
    for (let n = 1; n < this.rows; n++)
      this.get(n, t) > e && (e = this.get(n, t));
    return e;
  }
  maxColumnIndex(t) {
    Ni(this, t), rf(this);
    let e = this.get(0, t), n = [0, t];
    for (let i = 1; i < this.rows; i++)
      this.get(i, t) > e && (e = this.get(i, t), n[0] = i);
    return n;
  }
  minColumn(t) {
    if (Ni(this, t), this.isEmpty())
      return NaN;
    let e = this.get(0, t);
    for (let n = 1; n < this.rows; n++)
      this.get(n, t) < e && (e = this.get(n, t));
    return e;
  }
  minColumnIndex(t) {
    Ni(this, t), rf(this);
    let e = this.get(0, t), n = [0, t];
    for (let i = 1; i < this.rows; i++)
      this.get(i, t) < e && (e = this.get(i, t), n[0] = i);
    return n;
  }
  diag() {
    let t = Math.min(this.rows, this.columns), e = [];
    for (let n = 0; n < t; n++)
      e.push(this.get(n, n));
    return e;
  }
  norm(t = "frobenius") {
    let e = 0;
    if (t === "max")
      return this.max();
    if (t === "frobenius") {
      for (let n = 0; n < this.rows; n++)
        for (let i = 0; i < this.columns; i++)
          e = e + this.get(n, i) * this.get(n, i);
      return Math.sqrt(e);
    } else
      throw new RangeError(`unknown norm type: ${t}`);
  }
  cumulativeSum() {
    let t = 0;
    for (let e = 0; e < this.rows; e++)
      for (let n = 0; n < this.columns; n++)
        t += this.get(e, n), this.set(e, n, t);
    return this;
  }
  dot(t) {
    ur.isMatrix(t) && (t = t.to1DArray());
    let e = this.to1DArray();
    if (e.length !== t.length)
      throw new RangeError("vectors do not have the same size");
    let n = 0;
    for (let i = 0; i < e.length; i++)
      n += e[i] * t[i];
    return n;
  }
  mmul(t) {
    t = Ct.checkMatrix(t);
    let e = this.rows, n = this.columns, i = t.columns, a = new Ct(e, i), o = new Float64Array(n);
    for (let s = 0; s < i; s++) {
      for (let u = 0; u < n; u++)
        o[u] = t.get(u, s);
      for (let u = 0; u < e; u++) {
        let f = 0;
        for (let l = 0; l < n; l++)
          f += this.get(u, l) * o[l];
        a.set(u, s, f);
      }
    }
    return a;
  }
  strassen2x2(t) {
    t = Ct.checkMatrix(t);
    let e = new Ct(2, 2);
    const n = this.get(0, 0), i = t.get(0, 0), a = this.get(0, 1), o = t.get(0, 1), s = this.get(1, 0), u = t.get(1, 0), f = this.get(1, 1), l = t.get(1, 1), c = (n + f) * (i + l), h = (s + f) * i, d = n * (o - l), v = f * (u - i), p = (n + a) * l, g = (s - n) * (i + o), y = (a - f) * (u + l), b = c + v - p + y, m = d + p, x = h + v, _ = c - h + d + g;
    return e.set(0, 0, b), e.set(0, 1, m), e.set(1, 0, x), e.set(1, 1, _), e;
  }
  strassen3x3(t) {
    t = Ct.checkMatrix(t);
    let e = new Ct(3, 3);
    const n = this.get(0, 0), i = this.get(0, 1), a = this.get(0, 2), o = this.get(1, 0), s = this.get(1, 1), u = this.get(1, 2), f = this.get(2, 0), l = this.get(2, 1), c = this.get(2, 2), h = t.get(0, 0), d = t.get(0, 1), v = t.get(0, 2), p = t.get(1, 0), g = t.get(1, 1), y = t.get(1, 2), b = t.get(2, 0), m = t.get(2, 1), x = t.get(2, 2), _ = (n + i + a - o - s - l - c) * g, w = (n - o) * (-d + g), E = s * (-h + d + p - g - y - b + x), M = (-n + o + s) * (h - d + g), C = (o + s) * (-h + d), S = n * h, A = (-n + f + l) * (h - v + y), T = (-n + f) * (v - y), P = (f + l) * (-h + v), k = (n + i + a - s - u - f - l) * y, L = l * (-h + v + p - g - y - b + m), O = (-a + l + c) * (g + b - m), D = (a - c) * (g - m), G = a * b, R = (l + c) * (-b + m), F = (-a + s + u) * (y + b - x), q = (a - u) * (y - x), ne = (s + u) * (-b + x), oe = i * p, ie = u * m, Ee = o * v, Xe = f * d, le = c * x, Me = S + G + oe, $e = _ + M + C + S + O + G + R, et = S + A + P + k + G + F + ne, ft = w + E + M + S + G + F + q, pt = w + M + C + S + ie, $ = G + F + q + ne + Ee, te = S + A + T + L + O + D + G, X = O + D + G + R + Xe, De = S + A + T + P + le;
    return e.set(0, 0, Me), e.set(0, 1, $e), e.set(0, 2, et), e.set(1, 0, ft), e.set(1, 1, pt), e.set(1, 2, $), e.set(2, 0, te), e.set(2, 1, X), e.set(2, 2, De), e;
  }
  mmulStrassen(t) {
    t = Ct.checkMatrix(t);
    let e = this.clone(), n = e.rows, i = e.columns, a = t.rows, o = t.columns;
    i !== a && console.warn(
      `Multiplying ${n} x ${i} and ${a} x ${o} matrix: dimensions do not match.`
    );
    function s(c, h, d) {
      let v = c.rows, p = c.columns;
      if (v === h && p === d)
        return c;
      {
        let g = ur.zeros(h, d);
        return g = g.setSubMatrix(c, 0, 0), g;
      }
    }
    let u = Math.max(n, a), f = Math.max(i, o);
    e = s(e, u, f), t = s(t, u, f);
    function l(c, h, d, v) {
      if (d <= 512 || v <= 512)
        return c.mmul(h);
      d % 2 === 1 && v % 2 === 1 ? (c = s(c, d + 1, v + 1), h = s(h, d + 1, v + 1)) : d % 2 === 1 ? (c = s(c, d + 1, v), h = s(h, d + 1, v)) : v % 2 === 1 && (c = s(c, d, v + 1), h = s(h, d, v + 1));
      let p = parseInt(c.rows / 2, 10), g = parseInt(c.columns / 2, 10), y = c.subMatrix(0, p - 1, 0, g - 1), b = h.subMatrix(0, p - 1, 0, g - 1), m = c.subMatrix(0, p - 1, g, c.columns - 1), x = h.subMatrix(0, p - 1, g, h.columns - 1), _ = c.subMatrix(p, c.rows - 1, 0, g - 1), w = h.subMatrix(p, h.rows - 1, 0, g - 1), E = c.subMatrix(p, c.rows - 1, g, c.columns - 1), M = h.subMatrix(p, h.rows - 1, g, h.columns - 1), C = l(
        ur.add(y, E),
        ur.add(b, M),
        p,
        g
      ), S = l(ur.add(_, E), b, p, g), A = l(y, ur.sub(x, M), p, g), T = l(E, ur.sub(w, b), p, g), P = l(ur.add(y, m), M, p, g), k = l(
        ur.sub(_, y),
        ur.add(b, x),
        p,
        g
      ), L = l(
        ur.sub(m, E),
        ur.add(w, M),
        p,
        g
      ), O = ur.add(C, T);
      O.sub(P), O.add(L);
      let D = ur.add(A, P), G = ur.add(S, T), R = ur.sub(C, S);
      R.add(A), R.add(k);
      let F = ur.zeros(2 * O.rows, 2 * O.columns);
      return F = F.setSubMatrix(O, 0, 0), F = F.setSubMatrix(D, O.rows, 0), F = F.setSubMatrix(G, 0, O.columns), F = F.setSubMatrix(R, O.rows, O.columns), F.subMatrix(0, d - 1, 0, v - 1);
    }
    return l(e, t, u, f);
  }
  scaleRows(t = {}) {
    if (typeof t != "object")
      throw new TypeError("options must be an object");
    const { min: e = 0, max: n = 1 } = t;
    if (!Number.isFinite(e))
      throw new TypeError("min must be a number");
    if (!Number.isFinite(n))
      throw new TypeError("max must be a number");
    if (e >= n)
      throw new RangeError("min must be smaller than max");
    let i = new Ct(this.rows, this.columns);
    for (let a = 0; a < this.rows; a++) {
      const o = this.getRow(a);
      o.length > 0 && $M(o, { min: e, max: n, output: o }), i.setRow(a, o);
    }
    return i;
  }
  scaleColumns(t = {}) {
    if (typeof t != "object")
      throw new TypeError("options must be an object");
    const { min: e = 0, max: n = 1 } = t;
    if (!Number.isFinite(e))
      throw new TypeError("min must be a number");
    if (!Number.isFinite(n))
      throw new TypeError("max must be a number");
    if (e >= n)
      throw new RangeError("min must be smaller than max");
    let i = new Ct(this.rows, this.columns);
    for (let a = 0; a < this.columns; a++) {
      const o = this.getColumn(a);
      o.length && $M(o, {
        min: e,
        max: n,
        output: o
      }), i.setColumn(a, o);
    }
    return i;
  }
  flipRows() {
    const t = Math.ceil(this.columns / 2);
    for (let e = 0; e < this.rows; e++)
      for (let n = 0; n < t; n++) {
        let i = this.get(e, n), a = this.get(e, this.columns - 1 - n);
        this.set(e, n, a), this.set(e, this.columns - 1 - n, i);
      }
    return this;
  }
  flipColumns() {
    const t = Math.ceil(this.rows / 2);
    for (let e = 0; e < this.columns; e++)
      for (let n = 0; n < t; n++) {
        let i = this.get(n, e), a = this.get(this.rows - 1 - n, e);
        this.set(n, e, a), this.set(this.rows - 1 - n, e, i);
      }
    return this;
  }
  kroneckerProduct(t) {
    t = Ct.checkMatrix(t);
    let e = this.rows, n = this.columns, i = t.rows, a = t.columns, o = new Ct(e * i, n * a);
    for (let s = 0; s < e; s++)
      for (let u = 0; u < n; u++)
        for (let f = 0; f < i; f++)
          for (let l = 0; l < a; l++)
            o.set(i * s + f, a * u + l, this.get(s, u) * t.get(f, l));
    return o;
  }
  kroneckerSum(t) {
    if (t = Ct.checkMatrix(t), !this.isSquare() || !t.isSquare())
      throw new Error("Kronecker Sum needs two Square Matrices");
    let e = this.rows, n = t.rows, i = this.kroneckerProduct(Ct.eye(n, n)), a = Ct.eye(e, e).kroneckerProduct(t);
    return i.add(a);
  }
  transpose() {
    let t = new Ct(this.columns, this.rows);
    for (let e = 0; e < this.rows; e++)
      for (let n = 0; n < this.columns; n++)
        t.set(n, e, this.get(e, n));
    return t;
  }
  sortRows(t = WM) {
    for (let e = 0; e < this.rows; e++)
      this.setRow(e, this.getRow(e).sort(t));
    return this;
  }
  sortColumns(t = WM) {
    for (let e = 0; e < this.columns; e++)
      this.setColumn(e, this.getColumn(e).sort(t));
    return this;
  }
  subMatrix(t, e, n, i) {
    c1(this, t, e, n, i);
    let a = new Ct(
      e - t + 1,
      i - n + 1
    );
    for (let o = t; o <= e; o++)
      for (let s = n; s <= i; s++)
        a.set(o - t, s - n, this.get(o, s));
    return a;
  }
  subMatrixRow(t, e, n) {
    if (e === void 0 && (e = 0), n === void 0 && (n = this.columns - 1), e > n || e < 0 || e >= this.columns || n < 0 || n >= this.columns)
      throw new RangeError("Argument out of range");
    let i = new Ct(t.length, n - e + 1);
    for (let a = 0; a < t.length; a++)
      for (let o = e; o <= n; o++) {
        if (t[a] < 0 || t[a] >= this.rows)
          throw new RangeError(`Row index out of range: ${t[a]}`);
        i.set(a, o - e, this.get(t[a], o));
      }
    return i;
  }
  subMatrixColumn(t, e, n) {
    if (e === void 0 && (e = 0), n === void 0 && (n = this.rows - 1), e > n || e < 0 || e >= this.rows || n < 0 || n >= this.rows)
      throw new RangeError("Argument out of range");
    let i = new Ct(n - e + 1, t.length);
    for (let a = 0; a < t.length; a++)
      for (let o = e; o <= n; o++) {
        if (t[a] < 0 || t[a] >= this.columns)
          throw new RangeError(`Column index out of range: ${t[a]}`);
        i.set(o - e, a, this.get(o, t[a]));
      }
    return i;
  }
  setSubMatrix(t, e, n) {
    if (t = Ct.checkMatrix(t), t.isEmpty())
      return this;
    let i = e + t.rows - 1, a = n + t.columns - 1;
    c1(this, e, i, n, a);
    for (let o = 0; o < t.rows; o++)
      for (let s = 0; s < t.columns; s++)
        this.set(e + o, n + s, t.get(o, s));
    return this;
  }
  selection(t, e) {
    zx(this, t), Ux(this, e);
    let n = new Ct(t.length, e.length);
    for (let i = 0; i < t.length; i++) {
      let a = t[i];
      for (let o = 0; o < e.length; o++) {
        let s = e[o];
        n.set(i, o, this.get(a, s));
      }
    }
    return n;
  }
  trace() {
    let t = Math.min(this.rows, this.columns), e = 0;
    for (let n = 0; n < t; n++)
      e += this.get(n, n);
    return e;
  }
  clone() {
    let t = new Ct(this.rows, this.columns);
    for (let e = 0; e < this.rows; e++)
      for (let n = 0; n < this.columns; n++)
        t.set(e, n, this.get(e, n));
    return t;
  }
  sum(t) {
    switch (t) {
      case "row":
        return nse(this);
      case "column":
        return ise(this);
      case void 0:
        return ase(this);
      default:
        throw new Error(`invalid option: ${t}`);
    }
  }
  product(t) {
    switch (t) {
      case "row":
        return ose(this);
      case "column":
        return sse(this);
      case void 0:
        return use(this);
      default:
        throw new Error(`invalid option: ${t}`);
    }
  }
  mean(t) {
    const e = this.sum(t);
    switch (t) {
      case "row": {
        for (let n = 0; n < this.rows; n++)
          e[n] /= this.columns;
        return e;
      }
      case "column": {
        for (let n = 0; n < this.columns; n++)
          e[n] /= this.rows;
        return e;
      }
      case void 0:
        return e / this.size;
      default:
        throw new Error(`invalid option: ${t}`);
    }
  }
  variance(t, e = {}) {
    if (typeof t == "object" && (e = t, t = void 0), typeof e != "object")
      throw new TypeError("options must be an object");
    const { unbiased: n = !0, mean: i = this.mean(t) } = e;
    if (typeof n != "boolean")
      throw new TypeError("unbiased must be a boolean");
    switch (t) {
      case "row": {
        if (!Nn(i))
          throw new TypeError("mean must be an array");
        return fse(this, n, i);
      }
      case "column": {
        if (!Nn(i))
          throw new TypeError("mean must be an array");
        return lse(this, n, i);
      }
      case void 0: {
        if (typeof i != "number")
          throw new TypeError("mean must be a number");
        return cse(this, n, i);
      }
      default:
        throw new Error(`invalid option: ${t}`);
    }
  }
  standardDeviation(t, e) {
    typeof t == "object" && (e = t, t = void 0);
    const n = this.variance(t, e);
    if (t === void 0)
      return Math.sqrt(n);
    for (let i = 0; i < n.length; i++)
      n[i] = Math.sqrt(n[i]);
    return n;
  }
  center(t, e = {}) {
    if (typeof t == "object" && (e = t, t = void 0), typeof e != "object")
      throw new TypeError("options must be an object");
    const { center: n = this.mean(t) } = e;
    switch (t) {
      case "row": {
        if (!Nn(n))
          throw new TypeError("center must be an array");
        return hse(this, n), this;
      }
      case "column": {
        if (!Nn(n))
          throw new TypeError("center must be an array");
        return dse(this, n), this;
      }
      case void 0: {
        if (typeof n != "number")
          throw new TypeError("center must be a number");
        return vse(this, n), this;
      }
      default:
        throw new Error(`invalid option: ${t}`);
    }
  }
  scale(t, e = {}) {
    if (typeof t == "object" && (e = t, t = void 0), typeof e != "object")
      throw new TypeError("options must be an object");
    let n = e.scale;
    switch (t) {
      case "row": {
        if (n === void 0)
          n = pse(this);
        else if (!Nn(n))
          throw new TypeError("scale must be an array");
        return gse(this, n), this;
      }
      case "column": {
        if (n === void 0)
          n = yse(this);
        else if (!Nn(n))
          throw new TypeError("scale must be an array");
        return mse(this, n), this;
      }
      case void 0: {
        if (n === void 0)
          n = bse(this);
        else if (typeof n != "number")
          throw new TypeError("scale must be a number");
        return xse(this, n), this;
      }
      default:
        throw new Error(`invalid option: ${t}`);
    }
  }
  toString(t) {
    return WB(this, t);
  }
}
ur.prototype.klass = "Matrix";
typeof Symbol < "u" && (ur.prototype[Symbol.for("nodejs.util.inspect.custom")] = Joe);
function WM(r, t) {
  return r - t;
}
function _se(r) {
  return r.every((t) => typeof t == "number");
}
ur.random = ur.rand;
ur.randomInt = ur.randInt;
ur.diagonal = ur.diag;
ur.prototype.diagonal = ur.prototype.diag;
ur.identity = ur.eye;
ur.prototype.negate = ur.prototype.neg;
ur.prototype.tensorProduct = ur.prototype.kroneckerProduct;
class Ct extends ur {
  constructor(t, e) {
    if (super(), Ct.isMatrix(t))
      return t.clone();
    if (Number.isInteger(t) && t >= 0)
      if (this.data = [], Number.isInteger(e) && e >= 0)
        for (let n = 0; n < t; n++)
          this.data.push(new Float64Array(e));
      else
        throw new TypeError("nColumns must be a positive integer");
    else if (Nn(t)) {
      const n = t;
      if (t = n.length, e = t ? n[0].length : 0, typeof e != "number")
        throw new TypeError(
          "Data must be a 2D array with at least one element"
        );
      this.data = [];
      for (let i = 0; i < t; i++) {
        if (n[i].length !== e)
          throw new RangeError("Inconsistent array dimensions");
        if (!_se(n[i]))
          throw new TypeError("Input data contains non-numeric values");
        this.data.push(Float64Array.from(n[i]));
      }
    } else
      throw new TypeError(
        "First argument must be a positive number or an array"
      );
    this.rows = t, this.columns = e;
  }
  set(t, e, n) {
    return this.data[t][e] = n, this;
  }
  get(t, e) {
    return this.data[t][e];
  }
  removeRow(t) {
    return Li(this, t), this.data.splice(t, 1), this.rows -= 1, this;
  }
  addRow(t, e) {
    return e === void 0 && (e = t, t = this.rows), Li(this, t, !0), e = Float64Array.from(_f(this, e)), this.data.splice(t, 0, e), this.rows += 1, this;
  }
  removeColumn(t) {
    Ni(this, t);
    for (let e = 0; e < this.rows; e++) {
      const n = new Float64Array(this.columns - 1);
      for (let i = 0; i < t; i++)
        n[i] = this.data[e][i];
      for (let i = t + 1; i < this.columns; i++)
        n[i - 1] = this.data[e][i];
      this.data[e] = n;
    }
    return this.columns -= 1, this;
  }
  addColumn(t, e) {
    typeof e > "u" && (e = t, t = this.columns), Ni(this, t, !0), e = wf(this, e);
    for (let n = 0; n < this.rows; n++) {
      const i = new Float64Array(this.columns + 1);
      let a = 0;
      for (; a < t; a++)
        i[a] = this.data[n][a];
      for (i[a++] = e[n]; a < this.columns + 1; a++)
        i[a] = this.data[n][a - 1];
      this.data[n] = i;
    }
    return this.columns += 1, this;
  }
}
rse(ur, Ct);
class ko extends ur {
  constructor(t, e, n) {
    super(), this.matrix = t, this.rows = e, this.columns = n;
  }
}
class wse extends ko {
  constructor(t, e) {
    Ni(t, e), super(t, t.rows, 1), this.column = e;
  }
  set(t, e, n) {
    return this.matrix.set(t, this.column, n), this;
  }
  get(t) {
    return this.matrix.get(t, this.column);
  }
}
class Ese extends ko {
  constructor(t, e) {
    Ux(t, e), super(t, t.rows, e.length), this.columnIndices = e;
  }
  set(t, e, n) {
    return this.matrix.set(t, this.columnIndices[e], n), this;
  }
  get(t, e) {
    return this.matrix.get(t, this.columnIndices[e]);
  }
}
class Sse extends ko {
  constructor(t) {
    super(t, t.rows, t.columns);
  }
  set(t, e, n) {
    return this.matrix.set(t, this.columns - e - 1, n), this;
  }
  get(t, e) {
    return this.matrix.get(t, this.columns - e - 1);
  }
}
class Mse extends ko {
  constructor(t) {
    super(t, t.rows, t.columns);
  }
  set(t, e, n) {
    return this.matrix.set(this.rows - t - 1, e, n), this;
  }
  get(t, e) {
    return this.matrix.get(this.rows - t - 1, e);
  }
}
class Cse extends ko {
  constructor(t, e) {
    Li(t, e), super(t, 1, t.columns), this.row = e;
  }
  set(t, e, n) {
    return this.matrix.set(this.row, e, n), this;
  }
  get(t, e) {
    return this.matrix.get(this.row, e);
  }
}
class Tse extends ko {
  constructor(t, e) {
    zx(t, e), super(t, e.length, t.columns), this.rowIndices = e;
  }
  set(t, e, n) {
    return this.matrix.set(this.rowIndices[t], e, n), this;
  }
  get(t, e) {
    return this.matrix.get(this.rowIndices[t], e);
  }
}
class Av extends ko {
  constructor(t, e, n) {
    zx(t, e), Ux(t, n), super(t, e.length, n.length), this.rowIndices = e, this.columnIndices = n;
  }
  set(t, e, n) {
    return this.matrix.set(
      this.rowIndices[t],
      this.columnIndices[e],
      n
    ), this;
  }
  get(t, e) {
    return this.matrix.get(
      this.rowIndices[t],
      this.columnIndices[e]
    );
  }
}
class Ase extends ko {
  constructor(t, e, n, i, a) {
    c1(t, e, n, i, a), super(t, n - e + 1, a - i + 1), this.startRow = e, this.startColumn = i;
  }
  set(t, e, n) {
    return this.matrix.set(
      this.startRow + t,
      this.startColumn + e,
      n
    ), this;
  }
  get(t, e) {
    return this.matrix.get(
      this.startRow + t,
      this.startColumn + e
    );
  }
}
class Ise extends ko {
  constructor(t) {
    super(t, t.columns, t.rows);
  }
  set(t, e, n) {
    return this.matrix.set(e, t, n), this;
  }
  get(t, e) {
    return this.matrix.get(e, t);
  }
}
class VB extends ur {
  constructor(t, e = {}) {
    const { rows: n = 1 } = e;
    if (t.length % n !== 0)
      throw new Error("the data length is not divisible by the number of rows");
    super(), this.rows = n, this.columns = t.length / n, this.data = t;
  }
  set(t, e, n) {
    let i = this._calculateIndex(t, e);
    return this.data[i] = n, this;
  }
  get(t, e) {
    let n = this._calculateIndex(t, e);
    return this.data[n];
  }
  _calculateIndex(t, e) {
    return t * this.columns + e;
  }
}
class Si extends ur {
  constructor(t) {
    super(), this.data = t, this.rows = t.length, this.columns = t[0].length;
  }
  set(t, e, n) {
    return this.data[t][e] = n, this;
  }
  get(t, e) {
    return this.data[t][e];
  }
}
function Pse(r, t) {
  if (Nn(r))
    return r[0] && Nn(r[0]) ? new Si(r) : new VB(r, t);
  throw new Error("the argument is not an array");
}
class gp {
  constructor(t) {
    t = Si.checkMatrix(t);
    let e = t.clone(), n = e.rows, i = e.columns, a = new Float64Array(n), o = 1, s, u, f, l, c, h, d, v, p;
    for (s = 0; s < n; s++)
      a[s] = s;
    for (v = new Float64Array(n), u = 0; u < i; u++) {
      for (s = 0; s < n; s++)
        v[s] = e.get(s, u);
      for (s = 0; s < n; s++) {
        for (p = Math.min(s, u), c = 0, f = 0; f < p; f++)
          c += e.get(s, f) * v[f];
        v[s] -= c, e.set(s, u, v[s]);
      }
      for (l = u, s = u + 1; s < n; s++)
        Math.abs(v[s]) > Math.abs(v[l]) && (l = s);
      if (l !== u) {
        for (f = 0; f < i; f++)
          h = e.get(l, f), e.set(l, f, e.get(u, f)), e.set(u, f, h);
        d = a[l], a[l] = a[u], a[u] = d, o = -o;
      }
      if (u < n && e.get(u, u) !== 0)
        for (s = u + 1; s < n; s++)
          e.set(s, u, e.get(s, u) / e.get(u, u));
    }
    this.LU = e, this.pivotVector = a, this.pivotSign = o;
  }
  isSingular() {
    let t = this.LU, e = t.columns;
    for (let n = 0; n < e; n++)
      if (t.get(n, n) === 0)
        return !0;
    return !1;
  }
  solve(t) {
    t = Ct.checkMatrix(t);
    let e = this.LU;
    if (e.rows !== t.rows)
      throw new Error("Invalid matrix dimensions");
    if (this.isSingular())
      throw new Error("LU matrix is singular");
    let i = t.columns, a = t.subMatrixRow(this.pivotVector, 0, i - 1), o = e.columns, s, u, f;
    for (f = 0; f < o; f++)
      for (s = f + 1; s < o; s++)
        for (u = 0; u < i; u++)
          a.set(s, u, a.get(s, u) - a.get(f, u) * e.get(s, f));
    for (f = o - 1; f >= 0; f--) {
      for (u = 0; u < i; u++)
        a.set(f, u, a.get(f, u) / e.get(f, f));
      for (s = 0; s < f; s++)
        for (u = 0; u < i; u++)
          a.set(s, u, a.get(s, u) - a.get(f, u) * e.get(s, f));
    }
    return a;
  }
  get determinant() {
    let t = this.LU;
    if (!t.isSquare())
      throw new Error("Matrix must be square");
    let e = this.pivotSign, n = t.columns;
    for (let i = 0; i < n; i++)
      e *= t.get(i, i);
    return e;
  }
  get lowerTriangularMatrix() {
    let t = this.LU, e = t.rows, n = t.columns, i = new Ct(e, n);
    for (let a = 0; a < e; a++)
      for (let o = 0; o < n; o++)
        a > o ? i.set(a, o, t.get(a, o)) : a === o ? i.set(a, o, 1) : i.set(a, o, 0);
    return i;
  }
  get upperTriangularMatrix() {
    let t = this.LU, e = t.rows, n = t.columns, i = new Ct(e, n);
    for (let a = 0; a < e; a++)
      for (let o = 0; o < n; o++)
        a <= o ? i.set(a, o, t.get(a, o)) : i.set(a, o, 0);
    return i;
  }
  get pivotPermutationVector() {
    return Array.from(this.pivotVector);
  }
}
function vo(r, t) {
  let e = 0;
  return Math.abs(r) > Math.abs(t) ? (e = t / r, Math.abs(r) * Math.sqrt(1 + e * e)) : t !== 0 ? (e = r / t, Math.abs(t) * Math.sqrt(1 + e * e)) : 0;
}
class h1 {
  constructor(t) {
    t = Si.checkMatrix(t);
    let e = t.clone(), n = t.rows, i = t.columns, a = new Float64Array(i), o, s, u, f;
    for (u = 0; u < i; u++) {
      let l = 0;
      for (o = u; o < n; o++)
        l = vo(l, e.get(o, u));
      if (l !== 0) {
        for (e.get(u, u) < 0 && (l = -l), o = u; o < n; o++)
          e.set(o, u, e.get(o, u) / l);
        for (e.set(u, u, e.get(u, u) + 1), s = u + 1; s < i; s++) {
          for (f = 0, o = u; o < n; o++)
            f += e.get(o, u) * e.get(o, s);
          for (f = -f / e.get(u, u), o = u; o < n; o++)
            e.set(o, s, e.get(o, s) + f * e.get(o, u));
        }
      }
      a[u] = -l;
    }
    this.QR = e, this.Rdiag = a;
  }
  solve(t) {
    t = Ct.checkMatrix(t);
    let e = this.QR, n = e.rows;
    if (t.rows !== n)
      throw new Error("Matrix row dimensions must agree");
    if (!this.isFullRank())
      throw new Error("Matrix is rank deficient");
    let i = t.columns, a = t.clone(), o = e.columns, s, u, f, l;
    for (f = 0; f < o; f++)
      for (u = 0; u < i; u++) {
        for (l = 0, s = f; s < n; s++)
          l += e.get(s, f) * a.get(s, u);
        for (l = -l / e.get(f, f), s = f; s < n; s++)
          a.set(s, u, a.get(s, u) + l * e.get(s, f));
      }
    for (f = o - 1; f >= 0; f--) {
      for (u = 0; u < i; u++)
        a.set(f, u, a.get(f, u) / this.Rdiag[f]);
      for (s = 0; s < f; s++)
        for (u = 0; u < i; u++)
          a.set(s, u, a.get(s, u) - a.get(f, u) * e.get(s, f));
    }
    return a.subMatrix(0, o - 1, 0, i - 1);
  }
  isFullRank() {
    let t = this.QR.columns;
    for (let e = 0; e < t; e++)
      if (this.Rdiag[e] === 0)
        return !1;
    return !0;
  }
  get upperTriangularMatrix() {
    let t = this.QR, e = t.columns, n = new Ct(e, e), i, a;
    for (i = 0; i < e; i++)
      for (a = 0; a < e; a++)
        i < a ? n.set(i, a, t.get(i, a)) : i === a ? n.set(i, a, this.Rdiag[i]) : n.set(i, a, 0);
    return n;
  }
  get orthogonalMatrix() {
    let t = this.QR, e = t.rows, n = t.columns, i = new Ct(e, n), a, o, s, u;
    for (s = n - 1; s >= 0; s--) {
      for (a = 0; a < e; a++)
        i.set(a, s, 0);
      for (i.set(s, s, 1), o = s; o < n; o++)
        if (t.get(s, s) !== 0) {
          for (u = 0, a = s; a < e; a++)
            u += t.get(a, s) * i.get(a, o);
          for (u = -u / t.get(s, s), a = s; a < e; a++)
            i.set(a, o, i.get(a, o) + u * t.get(a, s));
        }
    }
    return i;
  }
}
class Qf {
  constructor(t, e = {}) {
    if (t = Si.checkMatrix(t), t.isEmpty())
      throw new Error("Matrix must be non-empty");
    let n = t.rows, i = t.columns;
    const {
      computeLeftSingularVectors: a = !0,
      computeRightSingularVectors: o = !0,
      autoTranspose: s = !1
    } = e;
    let u = Boolean(a), f = Boolean(o), l = !1, c;
    if (n < i)
      if (!s)
        c = t.clone(), console.warn(
          "Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose"
        );
      else {
        c = t.transpose(), n = c.rows, i = c.columns, l = !0;
        let S = u;
        u = f, f = S;
      }
    else
      c = t.clone();
    let h = Math.min(n, i), d = Math.min(n + 1, i), v = new Float64Array(d), p = new Ct(n, h), g = new Ct(i, i), y = new Float64Array(i), b = new Float64Array(n), m = new Float64Array(d);
    for (let S = 0; S < d; S++)
      m[S] = S;
    let x = Math.min(n - 1, i), _ = Math.max(0, Math.min(i - 2, n)), w = Math.max(x, _);
    for (let S = 0; S < w; S++) {
      if (S < x) {
        v[S] = 0;
        for (let A = S; A < n; A++)
          v[S] = vo(v[S], c.get(A, S));
        if (v[S] !== 0) {
          c.get(S, S) < 0 && (v[S] = -v[S]);
          for (let A = S; A < n; A++)
            c.set(A, S, c.get(A, S) / v[S]);
          c.set(S, S, c.get(S, S) + 1);
        }
        v[S] = -v[S];
      }
      for (let A = S + 1; A < i; A++) {
        if (S < x && v[S] !== 0) {
          let T = 0;
          for (let P = S; P < n; P++)
            T += c.get(P, S) * c.get(P, A);
          T = -T / c.get(S, S);
          for (let P = S; P < n; P++)
            c.set(P, A, c.get(P, A) + T * c.get(P, S));
        }
        y[A] = c.get(S, A);
      }
      if (u && S < x)
        for (let A = S; A < n; A++)
          p.set(A, S, c.get(A, S));
      if (S < _) {
        y[S] = 0;
        for (let A = S + 1; A < i; A++)
          y[S] = vo(y[S], y[A]);
        if (y[S] !== 0) {
          y[S + 1] < 0 && (y[S] = 0 - y[S]);
          for (let A = S + 1; A < i; A++)
            y[A] /= y[S];
          y[S + 1] += 1;
        }
        if (y[S] = -y[S], S + 1 < n && y[S] !== 0) {
          for (let A = S + 1; A < n; A++)
            b[A] = 0;
          for (let A = S + 1; A < n; A++)
            for (let T = S + 1; T < i; T++)
              b[A] += y[T] * c.get(A, T);
          for (let A = S + 1; A < i; A++) {
            let T = -y[A] / y[S + 1];
            for (let P = S + 1; P < n; P++)
              c.set(P, A, c.get(P, A) + T * b[P]);
          }
        }
        if (f)
          for (let A = S + 1; A < i; A++)
            g.set(A, S, y[A]);
      }
    }
    let E = Math.min(i, n + 1);
    if (x < i && (v[x] = c.get(x, x)), n < E && (v[E - 1] = 0), _ + 1 < E && (y[_] = c.get(_, E - 1)), y[E - 1] = 0, u) {
      for (let S = x; S < h; S++) {
        for (let A = 0; A < n; A++)
          p.set(A, S, 0);
        p.set(S, S, 1);
      }
      for (let S = x - 1; S >= 0; S--)
        if (v[S] !== 0) {
          for (let A = S + 1; A < h; A++) {
            let T = 0;
            for (let P = S; P < n; P++)
              T += p.get(P, S) * p.get(P, A);
            T = -T / p.get(S, S);
            for (let P = S; P < n; P++)
              p.set(P, A, p.get(P, A) + T * p.get(P, S));
          }
          for (let A = S; A < n; A++)
            p.set(A, S, -p.get(A, S));
          p.set(S, S, 1 + p.get(S, S));
          for (let A = 0; A < S - 1; A++)
            p.set(A, S, 0);
        } else {
          for (let A = 0; A < n; A++)
            p.set(A, S, 0);
          p.set(S, S, 1);
        }
    }
    if (f)
      for (let S = i - 1; S >= 0; S--) {
        if (S < _ && y[S] !== 0)
          for (let A = S + 1; A < i; A++) {
            let T = 0;
            for (let P = S + 1; P < i; P++)
              T += g.get(P, S) * g.get(P, A);
            T = -T / g.get(S + 1, S);
            for (let P = S + 1; P < i; P++)
              g.set(P, A, g.get(P, A) + T * g.get(P, S));
          }
        for (let A = 0; A < i; A++)
          g.set(A, S, 0);
        g.set(S, S, 1);
      }
    let M = E - 1, C = Number.EPSILON;
    for (; E > 0; ) {
      let S, A;
      for (S = E - 2; S >= -1 && S !== -1; S--) {
        const T = Number.MIN_VALUE + C * Math.abs(v[S] + Math.abs(v[S + 1]));
        if (Math.abs(y[S]) <= T || Number.isNaN(y[S])) {
          y[S] = 0;
          break;
        }
      }
      if (S === E - 2)
        A = 4;
      else {
        let T;
        for (T = E - 1; T >= S && T !== S; T--) {
          let P = (T !== E ? Math.abs(y[T]) : 0) + (T !== S + 1 ? Math.abs(y[T - 1]) : 0);
          if (Math.abs(v[T]) <= C * P) {
            v[T] = 0;
            break;
          }
        }
        T === S ? A = 3 : T === E - 1 ? A = 1 : (A = 2, S = T);
      }
      switch (S++, A) {
        case 1: {
          let T = y[E - 2];
          y[E - 2] = 0;
          for (let P = E - 2; P >= S; P--) {
            let k = vo(v[P], T), L = v[P] / k, O = T / k;
            if (v[P] = k, P !== S && (T = -O * y[P - 1], y[P - 1] = L * y[P - 1]), f)
              for (let D = 0; D < i; D++)
                k = L * g.get(D, P) + O * g.get(D, E - 1), g.set(D, E - 1, -O * g.get(D, P) + L * g.get(D, E - 1)), g.set(D, P, k);
          }
          break;
        }
        case 2: {
          let T = y[S - 1];
          y[S - 1] = 0;
          for (let P = S; P < E; P++) {
            let k = vo(v[P], T), L = v[P] / k, O = T / k;
            if (v[P] = k, T = -O * y[P], y[P] = L * y[P], u)
              for (let D = 0; D < n; D++)
                k = L * p.get(D, P) + O * p.get(D, S - 1), p.set(D, S - 1, -O * p.get(D, P) + L * p.get(D, S - 1)), p.set(D, P, k);
          }
          break;
        }
        case 3: {
          const T = Math.max(
            Math.abs(v[E - 1]),
            Math.abs(v[E - 2]),
            Math.abs(y[E - 2]),
            Math.abs(v[S]),
            Math.abs(y[S])
          ), P = v[E - 1] / T, k = v[E - 2] / T, L = y[E - 2] / T, O = v[S] / T, D = y[S] / T, G = ((k + P) * (k - P) + L * L) / 2, R = P * L * (P * L);
          let F = 0;
          (G !== 0 || R !== 0) && (G < 0 ? F = 0 - Math.sqrt(G * G + R) : F = Math.sqrt(G * G + R), F = R / (G + F));
          let q = (O + P) * (O - P) + F, ne = O * D;
          for (let oe = S; oe < E - 1; oe++) {
            let ie = vo(q, ne);
            ie === 0 && (ie = Number.MIN_VALUE);
            let Ee = q / ie, Xe = ne / ie;
            if (oe !== S && (y[oe - 1] = ie), q = Ee * v[oe] + Xe * y[oe], y[oe] = Ee * y[oe] - Xe * v[oe], ne = Xe * v[oe + 1], v[oe + 1] = Ee * v[oe + 1], f)
              for (let le = 0; le < i; le++)
                ie = Ee * g.get(le, oe) + Xe * g.get(le, oe + 1), g.set(le, oe + 1, -Xe * g.get(le, oe) + Ee * g.get(le, oe + 1)), g.set(le, oe, ie);
            if (ie = vo(q, ne), ie === 0 && (ie = Number.MIN_VALUE), Ee = q / ie, Xe = ne / ie, v[oe] = ie, q = Ee * y[oe] + Xe * v[oe + 1], v[oe + 1] = -Xe * y[oe] + Ee * v[oe + 1], ne = Xe * y[oe + 1], y[oe + 1] = Ee * y[oe + 1], u && oe < n - 1)
              for (let le = 0; le < n; le++)
                ie = Ee * p.get(le, oe) + Xe * p.get(le, oe + 1), p.set(le, oe + 1, -Xe * p.get(le, oe) + Ee * p.get(le, oe + 1)), p.set(le, oe, ie);
          }
          y[E - 2] = q;
          break;
        }
        case 4: {
          if (v[S] <= 0 && (v[S] = v[S] < 0 ? -v[S] : 0, f))
            for (let T = 0; T <= M; T++)
              g.set(T, S, -g.get(T, S));
          for (; S < M && !(v[S] >= v[S + 1]); ) {
            let T = v[S];
            if (v[S] = v[S + 1], v[S + 1] = T, f && S < i - 1)
              for (let P = 0; P < i; P++)
                T = g.get(P, S + 1), g.set(P, S + 1, g.get(P, S)), g.set(P, S, T);
            if (u && S < n - 1)
              for (let P = 0; P < n; P++)
                T = p.get(P, S + 1), p.set(P, S + 1, p.get(P, S)), p.set(P, S, T);
            S++;
          }
          E--;
          break;
        }
      }
    }
    if (l) {
      let S = g;
      g = p, p = S;
    }
    this.m = n, this.n = i, this.s = v, this.U = p, this.V = g;
  }
  solve(t) {
    let e = t, n = this.threshold, i = this.s.length, a = Ct.zeros(i, i);
    for (let h = 0; h < i; h++)
      Math.abs(this.s[h]) <= n ? a.set(h, h, 0) : a.set(h, h, 1 / this.s[h]);
    let o = this.U, s = this.rightSingularVectors, u = s.mmul(a), f = s.rows, l = o.rows, c = Ct.zeros(f, l);
    for (let h = 0; h < f; h++)
      for (let d = 0; d < l; d++) {
        let v = 0;
        for (let p = 0; p < i; p++)
          v += u.get(h, p) * o.get(d, p);
        c.set(h, d, v);
      }
    return c.mmul(e);
  }
  solveForDiagonal(t) {
    return this.solve(Ct.diag(t));
  }
  inverse() {
    let t = this.V, e = this.threshold, n = t.rows, i = t.columns, a = new Ct(n, this.s.length);
    for (let l = 0; l < n; l++)
      for (let c = 0; c < i; c++)
        Math.abs(this.s[c]) > e && a.set(l, c, t.get(l, c) / this.s[c]);
    let o = this.U, s = o.rows, u = o.columns, f = new Ct(n, s);
    for (let l = 0; l < n; l++)
      for (let c = 0; c < s; c++) {
        let h = 0;
        for (let d = 0; d < u; d++)
          h += a.get(l, d) * o.get(c, d);
        f.set(l, c, h);
      }
    return f;
  }
  get condition() {
    return this.s[0] / this.s[Math.min(this.m, this.n) - 1];
  }
  get norm2() {
    return this.s[0];
  }
  get rank() {
    let t = Math.max(this.m, this.n) * this.s[0] * Number.EPSILON, e = 0, n = this.s;
    for (let i = 0, a = n.length; i < a; i++)
      n[i] > t && e++;
    return e;
  }
  get diagonal() {
    return Array.from(this.s);
  }
  get threshold() {
    return Number.EPSILON / 2 * Math.max(this.m, this.n) * this.s[0];
  }
  get leftSingularVectors() {
    return this.U;
  }
  get rightSingularVectors() {
    return this.V;
  }
  get diagonalMatrix() {
    return Ct.diag(this.s);
  }
}
function Ose(r, t = !1) {
  return r = Si.checkMatrix(r), t ? new Qf(r).inverse() : XB(r, Ct.eye(r.rows));
}
function XB(r, t, e = !1) {
  return r = Si.checkMatrix(r), t = Si.checkMatrix(t), e ? new Qf(r).solve(t) : r.isSquare() ? new gp(r).solve(t) : new h1(r).solve(t);
}
function Iv(r) {
  if (r = Ct.checkMatrix(r), r.isSquare()) {
    if (r.columns === 0)
      return 1;
    let t, e, n, i;
    if (r.columns === 2)
      return t = r.get(0, 0), e = r.get(0, 1), n = r.get(1, 0), i = r.get(1, 1), t * i - e * n;
    if (r.columns === 3) {
      let a, o, s;
      return a = new Av(r, [1, 2], [1, 2]), o = new Av(r, [1, 2], [0, 2]), s = new Av(r, [1, 2], [0, 1]), t = r.get(0, 0), e = r.get(0, 1), n = r.get(0, 2), t * Iv(a) - e * Iv(o) + n * Iv(s);
    } else
      return new gp(r).determinant;
  } else
    throw Error("determinant can only be calculated for a square matrix");
}
function Dse(r, t) {
  let e = [];
  for (let n = 0; n < r; n++)
    n !== t && e.push(n);
  return e;
}
function kse(r, t, e, n = 1e-9, i = 1e-9) {
  if (r > i)
    return new Array(t.rows + 1).fill(0);
  {
    let a = t.addRow(e, [0]);
    for (let o = 0; o < a.rows; o++)
      Math.abs(a.get(o, 0)) < n && a.set(o, 0, 0);
    return a.to1DArray();
  }
}
function Lse(r, t = {}) {
  const { thresholdValue: e = 1e-9, thresholdError: n = 1e-9 } = t;
  r = Ct.checkMatrix(r);
  let i = r.rows, a = new Ct(i, i);
  for (let o = 0; o < i; o++) {
    let s = Ct.columnVector(r.getRow(o)), u = r.subMatrixRow(Dse(i, o)).transpose(), l = new Qf(u).solve(s), c = Ct.sub(s, u.mmul(l)).abs().max();
    a.setRow(
      o,
      kse(c, l, o, e, n)
    );
  }
  return a;
}
function Nse(r, t = Number.EPSILON) {
  if (r = Ct.checkMatrix(r), r.isEmpty())
    return r.transpose();
  let e = new Qf(r, { autoTranspose: !0 }), n = e.leftSingularVectors, i = e.rightSingularVectors, a = e.diagonal;
  for (let o = 0; o < a.length; o++)
    Math.abs(a[o]) > t ? a[o] = 1 / a[o] : a[o] = 0;
  return i.mmul(Ct.diag(a).mmul(n.transpose()));
}
function Rse(r, t = r, e = {}) {
  r = new Ct(r);
  let n = !1;
  if (typeof t == "object" && !Ct.isMatrix(t) && !Nn(t) ? (e = t, t = r, n = !0) : t = new Ct(t), r.rows !== t.rows)
    throw new TypeError("Both matrices must have the same number of rows");
  const { center: i = !0 } = e;
  i && (r = r.center("column"), n || (t = t.center("column")));
  const a = r.transpose().mmul(t);
  for (let o = 0; o < a.rows; o++)
    for (let s = 0; s < a.columns; s++)
      a.set(o, s, a.get(o, s) * (1 / (r.rows - 1)));
  return a;
}
function Bse(r, t = r, e = {}) {
  r = new Ct(r);
  let n = !1;
  if (typeof t == "object" && !Ct.isMatrix(t) && !Nn(t) ? (e = t, t = r, n = !0) : t = new Ct(t), r.rows !== t.rows)
    throw new TypeError("Both matrices must have the same number of rows");
  const { center: i = !0, scale: a = !0 } = e;
  i && (r.center("column"), n || t.center("column")), a && (r.scale("column"), n || t.scale("column"));
  const o = r.standardDeviation("column", { unbiased: !0 }), s = n ? o : t.standardDeviation("column", { unbiased: !0 }), u = r.transpose().mmul(t);
  for (let f = 0; f < u.rows; f++)
    for (let l = 0; l < u.columns; l++)
      u.set(
        f,
        l,
        u.get(f, l) * (1 / (o[f] * s[l])) * (1 / (r.rows - 1))
      );
  return u;
}
class VM {
  constructor(t, e = {}) {
    const { assumeSymmetric: n = !1 } = e;
    if (t = Si.checkMatrix(t), !t.isSquare())
      throw new Error("Matrix is not a square matrix");
    if (t.isEmpty())
      throw new Error("Matrix must be non-empty");
    let i = t.columns, a = new Ct(i, i), o = new Float64Array(i), s = new Float64Array(i), u = t, f, l, c = !1;
    if (n ? c = !0 : c = t.isSymmetric(), c) {
      for (f = 0; f < i; f++)
        for (l = 0; l < i; l++)
          a.set(f, l, u.get(f, l));
      Gse(i, s, o, a), Fse(i, s, o, a);
    } else {
      let h = new Ct(i, i), d = new Float64Array(i);
      for (l = 0; l < i; l++)
        for (f = 0; f < i; f++)
          h.set(f, l, u.get(f, l));
      zse(i, h, d, a), Use(i, s, o, a, h);
    }
    this.n = i, this.e = s, this.d = o, this.V = a;
  }
  get realEigenvalues() {
    return Array.from(this.d);
  }
  get imaginaryEigenvalues() {
    return Array.from(this.e);
  }
  get eigenvectorMatrix() {
    return this.V;
  }
  get diagonalMatrix() {
    let t = this.n, e = this.e, n = this.d, i = new Ct(t, t), a, o;
    for (a = 0; a < t; a++) {
      for (o = 0; o < t; o++)
        i.set(a, o, 0);
      i.set(a, a, n[a]), e[a] > 0 ? i.set(a, a + 1, e[a]) : e[a] < 0 && i.set(a, a - 1, e[a]);
    }
    return i;
  }
}
function Gse(r, t, e, n) {
  let i, a, o, s, u, f, l, c;
  for (u = 0; u < r; u++)
    e[u] = n.get(r - 1, u);
  for (s = r - 1; s > 0; s--) {
    for (c = 0, o = 0, f = 0; f < s; f++)
      c = c + Math.abs(e[f]);
    if (c === 0)
      for (t[s] = e[s - 1], u = 0; u < s; u++)
        e[u] = n.get(s - 1, u), n.set(s, u, 0), n.set(u, s, 0);
    else {
      for (f = 0; f < s; f++)
        e[f] /= c, o += e[f] * e[f];
      for (i = e[s - 1], a = Math.sqrt(o), i > 0 && (a = -a), t[s] = c * a, o = o - i * a, e[s - 1] = i - a, u = 0; u < s; u++)
        t[u] = 0;
      for (u = 0; u < s; u++) {
        for (i = e[u], n.set(u, s, i), a = t[u] + n.get(u, u) * i, f = u + 1; f <= s - 1; f++)
          a += n.get(f, u) * e[f], t[f] += n.get(f, u) * i;
        t[u] = a;
      }
      for (i = 0, u = 0; u < s; u++)
        t[u] /= o, i += t[u] * e[u];
      for (l = i / (o + o), u = 0; u < s; u++)
        t[u] -= l * e[u];
      for (u = 0; u < s; u++) {
        for (i = e[u], a = t[u], f = u; f <= s - 1; f++)
          n.set(f, u, n.get(f, u) - (i * t[f] + a * e[f]));
        e[u] = n.get(s - 1, u), n.set(s, u, 0);
      }
    }
    e[s] = o;
  }
  for (s = 0; s < r - 1; s++) {
    if (n.set(r - 1, s, n.get(s, s)), n.set(s, s, 1), o = e[s + 1], o !== 0) {
      for (f = 0; f <= s; f++)
        e[f] = n.get(f, s + 1) / o;
      for (u = 0; u <= s; u++) {
        for (a = 0, f = 0; f <= s; f++)
          a += n.get(f, s + 1) * n.get(f, u);
        for (f = 0; f <= s; f++)
          n.set(f, u, n.get(f, u) - a * e[f]);
      }
    }
    for (f = 0; f <= s; f++)
      n.set(f, s + 1, 0);
  }
  for (u = 0; u < r; u++)
    e[u] = n.get(r - 1, u), n.set(r - 1, u, 0);
  n.set(r - 1, r - 1, 1), t[0] = 0;
}
function Fse(r, t, e, n) {
  let i, a, o, s, u, f, l, c, h, d, v, p, g, y, b, m;
  for (o = 1; o < r; o++)
    t[o - 1] = t[o];
  t[r - 1] = 0;
  let x = 0, _ = 0, w = Number.EPSILON;
  for (f = 0; f < r; f++) {
    for (_ = Math.max(_, Math.abs(e[f]) + Math.abs(t[f])), l = f; l < r && !(Math.abs(t[l]) <= w * _); )
      l++;
    if (l > f)
      do {
        for (i = e[f], c = (e[f + 1] - i) / (2 * t[f]), h = vo(c, 1), c < 0 && (h = -h), e[f] = t[f] / (c + h), e[f + 1] = t[f] * (c + h), d = e[f + 1], a = i - e[f], o = f + 2; o < r; o++)
          e[o] -= a;
        for (x = x + a, c = e[l], v = 1, p = v, g = v, y = t[f + 1], b = 0, m = 0, o = l - 1; o >= f; o--)
          for (g = p, p = v, m = b, i = v * t[o], a = v * c, h = vo(c, t[o]), t[o + 1] = b * h, b = t[o] / h, v = c / h, c = v * e[o] - b * i, e[o + 1] = a + b * (v * i + b * e[o]), u = 0; u < r; u++)
            a = n.get(u, o + 1), n.set(u, o + 1, b * n.get(u, o) + v * a), n.set(u, o, v * n.get(u, o) - b * a);
        c = -b * m * g * y * t[f] / d, t[f] = b * c, e[f] = v * c;
      } while (Math.abs(t[f]) > w * _);
    e[f] = e[f] + x, t[f] = 0;
  }
  for (o = 0; o < r - 1; o++) {
    for (u = o, c = e[o], s = o + 1; s < r; s++)
      e[s] < c && (u = s, c = e[s]);
    if (u !== o)
      for (e[u] = e[o], e[o] = c, s = 0; s < r; s++)
        c = n.get(s, o), n.set(s, o, n.get(s, u)), n.set(s, u, c);
  }
}
function zse(r, t, e, n) {
  let i = 0, a = r - 1, o, s, u, f, l, c, h;
  for (c = i + 1; c <= a - 1; c++) {
    for (h = 0, f = c; f <= a; f++)
      h = h + Math.abs(t.get(f, c - 1));
    if (h !== 0) {
      for (u = 0, f = a; f >= c; f--)
        e[f] = t.get(f, c - 1) / h, u += e[f] * e[f];
      for (s = Math.sqrt(u), e[c] > 0 && (s = -s), u = u - e[c] * s, e[c] = e[c] - s, l = c; l < r; l++) {
        for (o = 0, f = a; f >= c; f--)
          o += e[f] * t.get(f, l);
        for (o = o / u, f = c; f <= a; f++)
          t.set(f, l, t.get(f, l) - o * e[f]);
      }
      for (f = 0; f <= a; f++) {
        for (o = 0, l = a; l >= c; l--)
          o += e[l] * t.get(f, l);
        for (o = o / u, l = c; l <= a; l++)
          t.set(f, l, t.get(f, l) - o * e[l]);
      }
      e[c] = h * e[c], t.set(c, c - 1, h * s);
    }
  }
  for (f = 0; f < r; f++)
    for (l = 0; l < r; l++)
      n.set(f, l, f === l ? 1 : 0);
  for (c = a - 1; c >= i + 1; c--)
    if (t.get(c, c - 1) !== 0) {
      for (f = c + 1; f <= a; f++)
        e[f] = t.get(f, c - 1);
      for (l = c; l <= a; l++) {
        for (s = 0, f = c; f <= a; f++)
          s += e[f] * n.get(f, l);
        for (s = s / e[c] / t.get(c, c - 1), f = c; f <= a; f++)
          n.set(f, l, n.get(f, l) + s * e[f]);
      }
    }
}
function Use(r, t, e, n, i) {
  let a = r - 1, o = 0, s = r - 1, u = Number.EPSILON, f = 0, l = 0, c = 0, h = 0, d = 0, v = 0, p = 0, g = 0, y, b, m, x, _, w, E, M, C, S, A, T, P, k, L;
  for (y = 0; y < r; y++)
    for ((y < o || y > s) && (e[y] = i.get(y, y), t[y] = 0), b = Math.max(y - 1, 0); b < r; b++)
      l = l + Math.abs(i.get(y, b));
  for (; a >= o; ) {
    for (x = a; x > o && (v = Math.abs(i.get(x - 1, x - 1)) + Math.abs(i.get(x, x)), v === 0 && (v = l), !(Math.abs(i.get(x, x - 1)) < u * v)); )
      x--;
    if (x === a)
      i.set(a, a, i.get(a, a) + f), e[a] = i.get(a, a), t[a] = 0, a--, g = 0;
    else if (x === a - 1) {
      if (E = i.get(a, a - 1) * i.get(a - 1, a), c = (i.get(a - 1, a - 1) - i.get(a, a)) / 2, h = c * c + E, p = Math.sqrt(Math.abs(h)), i.set(a, a, i.get(a, a) + f), i.set(a - 1, a - 1, i.get(a - 1, a - 1) + f), M = i.get(a, a), h >= 0) {
        for (p = c >= 0 ? c + p : c - p, e[a - 1] = M + p, e[a] = e[a - 1], p !== 0 && (e[a] = M - E / p), t[a - 1] = 0, t[a] = 0, M = i.get(a, a - 1), v = Math.abs(M) + Math.abs(p), c = M / v, h = p / v, d = Math.sqrt(c * c + h * h), c = c / d, h = h / d, b = a - 1; b < r; b++)
          p = i.get(a - 1, b), i.set(a - 1, b, h * p + c * i.get(a, b)), i.set(a, b, h * i.get(a, b) - c * p);
        for (y = 0; y <= a; y++)
          p = i.get(y, a - 1), i.set(y, a - 1, h * p + c * i.get(y, a)), i.set(y, a, h * i.get(y, a) - c * p);
        for (y = o; y <= s; y++)
          p = n.get(y, a - 1), n.set(y, a - 1, h * p + c * n.get(y, a)), n.set(y, a, h * n.get(y, a) - c * p);
      } else
        e[a - 1] = M + c, e[a] = M + c, t[a - 1] = p, t[a] = -p;
      a = a - 2, g = 0;
    } else {
      if (M = i.get(a, a), C = 0, E = 0, x < a && (C = i.get(a - 1, a - 1), E = i.get(a, a - 1) * i.get(a - 1, a)), g === 10) {
        for (f += M, y = o; y <= a; y++)
          i.set(y, y, i.get(y, y) - M);
        v = Math.abs(i.get(a, a - 1)) + Math.abs(i.get(a - 1, a - 2)), M = C = 0.75 * v, E = -0.4375 * v * v;
      }
      if (g === 30 && (v = (C - M) / 2, v = v * v + E, v > 0)) {
        for (v = Math.sqrt(v), C < M && (v = -v), v = M - E / ((C - M) / 2 + v), y = o; y <= a; y++)
          i.set(y, y, i.get(y, y) - v);
        f += v, M = C = E = 0.964;
      }
      for (g = g + 1, _ = a - 2; _ >= x && (p = i.get(_, _), d = M - p, v = C - p, c = (d * v - E) / i.get(_ + 1, _) + i.get(_, _ + 1), h = i.get(_ + 1, _ + 1) - p - d - v, d = i.get(_ + 2, _ + 1), v = Math.abs(c) + Math.abs(h) + Math.abs(d), c = c / v, h = h / v, d = d / v, !(_ === x || Math.abs(i.get(_, _ - 1)) * (Math.abs(h) + Math.abs(d)) < u * (Math.abs(c) * (Math.abs(i.get(_ - 1, _ - 1)) + Math.abs(p) + Math.abs(i.get(_ + 1, _ + 1)))))); )
        _--;
      for (y = _ + 2; y <= a; y++)
        i.set(y, y - 2, 0), y > _ + 2 && i.set(y, y - 3, 0);
      for (m = _; m <= a - 1 && (k = m !== a - 1, m !== _ && (c = i.get(m, m - 1), h = i.get(m + 1, m - 1), d = k ? i.get(m + 2, m - 1) : 0, M = Math.abs(c) + Math.abs(h) + Math.abs(d), M !== 0 && (c = c / M, h = h / M, d = d / M)), M !== 0); m++)
        if (v = Math.sqrt(c * c + h * h + d * d), c < 0 && (v = -v), v !== 0) {
          for (m !== _ ? i.set(m, m - 1, -v * M) : x !== _ && i.set(m, m - 1, -i.get(m, m - 1)), c = c + v, M = c / v, C = h / v, p = d / v, h = h / c, d = d / c, b = m; b < r; b++)
            c = i.get(m, b) + h * i.get(m + 1, b), k && (c = c + d * i.get(m + 2, b), i.set(m + 2, b, i.get(m + 2, b) - c * p)), i.set(m, b, i.get(m, b) - c * M), i.set(m + 1, b, i.get(m + 1, b) - c * C);
          for (y = 0; y <= Math.min(a, m + 3); y++)
            c = M * i.get(y, m) + C * i.get(y, m + 1), k && (c = c + p * i.get(y, m + 2), i.set(y, m + 2, i.get(y, m + 2) - c * d)), i.set(y, m, i.get(y, m) - c), i.set(y, m + 1, i.get(y, m + 1) - c * h);
          for (y = o; y <= s; y++)
            c = M * n.get(y, m) + C * n.get(y, m + 1), k && (c = c + p * n.get(y, m + 2), n.set(y, m + 2, n.get(y, m + 2) - c * d)), n.set(y, m, n.get(y, m) - c), n.set(y, m + 1, n.get(y, m + 1) - c * h);
        }
    }
  }
  if (l !== 0) {
    for (a = r - 1; a >= 0; a--)
      if (c = e[a], h = t[a], h === 0)
        for (x = a, i.set(a, a, 1), y = a - 1; y >= 0; y--) {
          for (E = i.get(y, y) - c, d = 0, b = x; b <= a; b++)
            d = d + i.get(y, b) * i.get(b, a);
          if (t[y] < 0)
            p = E, v = d;
          else if (x = y, t[y] === 0 ? i.set(y, a, E !== 0 ? -d / E : -d / (u * l)) : (M = i.get(y, y + 1), C = i.get(y + 1, y), h = (e[y] - c) * (e[y] - c) + t[y] * t[y], w = (M * v - p * d) / h, i.set(y, a, w), i.set(
            y + 1,
            a,
            Math.abs(M) > Math.abs(p) ? (-d - E * w) / M : (-v - C * w) / p
          )), w = Math.abs(i.get(y, a)), u * w * w > 1)
            for (b = y; b <= a; b++)
              i.set(b, a, i.get(b, a) / w);
        }
      else if (h < 0)
        for (x = a - 1, Math.abs(i.get(a, a - 1)) > Math.abs(i.get(a - 1, a)) ? (i.set(a - 1, a - 1, h / i.get(a, a - 1)), i.set(a - 1, a, -(i.get(a, a) - c) / i.get(a, a - 1))) : (L = Rd(0, -i.get(a - 1, a), i.get(a - 1, a - 1) - c, h), i.set(a - 1, a - 1, L[0]), i.set(a - 1, a, L[1])), i.set(a, a - 1, 0), i.set(a, a, 1), y = a - 2; y >= 0; y--) {
          for (S = 0, A = 0, b = x; b <= a; b++)
            S = S + i.get(y, b) * i.get(b, a - 1), A = A + i.get(y, b) * i.get(b, a);
          if (E = i.get(y, y) - c, t[y] < 0)
            p = E, d = S, v = A;
          else if (x = y, t[y] === 0 ? (L = Rd(-S, -A, E, h), i.set(y, a - 1, L[0]), i.set(y, a, L[1])) : (M = i.get(y, y + 1), C = i.get(y + 1, y), T = (e[y] - c) * (e[y] - c) + t[y] * t[y] - h * h, P = (e[y] - c) * 2 * h, T === 0 && P === 0 && (T = u * l * (Math.abs(E) + Math.abs(h) + Math.abs(M) + Math.abs(C) + Math.abs(p))), L = Rd(
            M * d - p * S + h * A,
            M * v - p * A - h * S,
            T,
            P
          ), i.set(y, a - 1, L[0]), i.set(y, a, L[1]), Math.abs(M) > Math.abs(p) + Math.abs(h) ? (i.set(
            y + 1,
            a - 1,
            (-S - E * i.get(y, a - 1) + h * i.get(y, a)) / M
          ), i.set(
            y + 1,
            a,
            (-A - E * i.get(y, a) - h * i.get(y, a - 1)) / M
          )) : (L = Rd(
            -d - C * i.get(y, a - 1),
            -v - C * i.get(y, a),
            p,
            h
          ), i.set(y + 1, a - 1, L[0]), i.set(y + 1, a, L[1]))), w = Math.max(Math.abs(i.get(y, a - 1)), Math.abs(i.get(y, a))), u * w * w > 1)
            for (b = y; b <= a; b++)
              i.set(b, a - 1, i.get(b, a - 1) / w), i.set(b, a, i.get(b, a) / w);
        }
    for (y = 0; y < r; y++)
      if (y < o || y > s)
        for (b = y; b < r; b++)
          n.set(y, b, i.get(y, b));
    for (b = r - 1; b >= o; b--)
      for (y = o; y <= s; y++) {
        for (p = 0, m = o; m <= Math.min(b, s); m++)
          p = p + n.get(y, m) * i.get(m, b);
        n.set(y, b, p);
      }
  }
}
function Rd(r, t, e, n) {
  let i, a;
  return Math.abs(e) > Math.abs(n) ? (i = n / e, a = e + i * n, [(r + i * t) / a, (t - i * r) / a]) : (i = e / n, a = n + i * e, [(i * r + t) / a, (i * t - r) / a]);
}
class XM {
  constructor(t) {
    if (t = Si.checkMatrix(t), !t.isSymmetric())
      throw new Error("Matrix is not symmetric");
    let e = t, n = e.rows, i = new Ct(n, n), a = !0, o, s, u;
    for (s = 0; s < n; s++) {
      let f = 0;
      for (u = 0; u < s; u++) {
        let l = 0;
        for (o = 0; o < u; o++)
          l += i.get(u, o) * i.get(s, o);
        l = (e.get(s, u) - l) / i.get(u, u), i.set(s, u, l), f = f + l * l;
      }
      for (f = e.get(s, s) - f, a &= f > 0, i.set(s, s, Math.sqrt(Math.max(f, 0))), u = s + 1; u < n; u++)
        i.set(s, u, 0);
    }
    this.L = i, this.positiveDefinite = Boolean(a);
  }
  isPositiveDefinite() {
    return this.positiveDefinite;
  }
  solve(t) {
    t = Si.checkMatrix(t);
    let e = this.L, n = e.rows;
    if (t.rows !== n)
      throw new Error("Matrix dimensions do not match");
    if (this.isPositiveDefinite() === !1)
      throw new Error("Matrix is not positive definite");
    let i = t.columns, a = t.clone(), o, s, u;
    for (u = 0; u < n; u++)
      for (s = 0; s < i; s++) {
        for (o = 0; o < u; o++)
          a.set(u, s, a.get(u, s) - a.get(o, s) * e.get(u, o));
        a.set(u, s, a.get(u, s) / e.get(u, u));
      }
    for (u = n - 1; u >= 0; u--)
      for (s = 0; s < i; s++) {
        for (o = u + 1; o < n; o++)
          a.set(u, s, a.get(u, s) - a.get(o, s) * e.get(o, u));
        a.set(u, s, a.get(u, s) / e.get(u, u));
      }
    return a;
  }
  get lowerTriangularMatrix() {
    return this.L;
  }
}
class YM {
  constructor(t, e = {}) {
    t = Si.checkMatrix(t);
    let { Y: n } = e;
    const {
      scaleScores: i = !1,
      maxIterations: a = 1e3,
      terminationCriteria: o = 1e-10
    } = e;
    let s;
    if (n) {
      if (Nn(n) && typeof n[0] == "number" ? n = Ct.columnVector(n) : n = Si.checkMatrix(n), n.rows !== t.rows)
        throw new Error("Y should have the same number of rows as X");
      s = n.getColumnVector(0);
    } else
      s = t.getColumnVector(0);
    let u = 1, f, l, c, h;
    for (let d = 0; d < a && u > o; d++)
      c = t.transpose().mmul(s).div(s.transpose().mmul(s).get(0, 0)), c = c.div(c.norm()), f = t.mmul(c).div(c.transpose().mmul(c).get(0, 0)), d > 0 && (u = f.clone().sub(h).pow(2).sum()), h = f.clone(), n ? (l = n.transpose().mmul(f).div(f.transpose().mmul(f).get(0, 0)), l = l.div(l.norm()), s = n.mmul(l).div(l.transpose().mmul(l).get(0, 0))) : s = f;
    if (n) {
      let d = t.transpose().mmul(f).div(f.transpose().mmul(f).get(0, 0));
      d = d.div(d.norm());
      let v = t.clone().sub(f.clone().mmul(d.transpose())), p = s.transpose().mmul(f).div(f.transpose().mmul(f).get(0, 0)), g = n.clone().sub(
        f.clone().mulS(p.get(0, 0)).mmul(l.transpose())
      );
      this.t = f, this.p = d.transpose(), this.w = c.transpose(), this.q = l, this.u = s, this.s = f.transpose().mmul(f), this.xResidual = v, this.yResidual = g, this.betas = p;
    } else
      this.w = c.transpose(), this.s = f.transpose().mmul(f).sqrt(), i ? this.t = f.clone().div(this.s.get(0, 0)) : this.t = f, this.xResidual = t.sub(f.mmul(c.transpose()));
  }
}
const jse = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  AbstractMatrix: ur,
  default: Ct,
  Matrix: Ct,
  wrap: Pse,
  WrapperMatrix1D: VB,
  WrapperMatrix2D: Si,
  solve: XB,
  inverse: Ose,
  determinant: Iv,
  linearDependencies: Lse,
  pseudoInverse: Nse,
  covariance: Rse,
  correlation: Bse,
  SingularValueDecomposition: Qf,
  SVD: Qf,
  EigenvalueDecomposition: VM,
  EVD: VM,
  CholeskyDecomposition: XM,
  CHO: XM,
  LuDecomposition: gp,
  LU: gp,
  QrDecomposition: h1,
  QR: h1,
  Nipals: YM,
  NIPALS: YM,
  MatrixColumnView: wse,
  MatrixColumnSelectionView: Ese,
  MatrixFlipColumnView: Sse,
  MatrixFlipRowView: Mse,
  MatrixRowView: Cse,
  MatrixRowSelectionView: Tse,
  MatrixSelectionView: Av,
  MatrixSubView: Ase,
  MatrixTransposeView: Ise
}, Symbol.toStringTag, { value: "Module" })), YB = /* @__PURE__ */ Ao(jse);
Object.defineProperty(Fx, "__esModule", { value: !0 });
var kl = YB, $se = function() {
  function r(t) {
    this.distances = t.distances, this.dimension = t.dimension || 2, this.linkDistance = t.linkDistance;
  }
  return r.prototype.layout = function() {
    var t = this, e = t.dimension, n = t.distances, i = t.linkDistance;
    try {
      var a = kl.Matrix.mul(kl.Matrix.pow(n, 2), -0.5), o = a.mean("row"), s = a.mean("column"), u = a.mean();
      a.add(u).subRowVector(o).subColumnVector(s);
      var f = new kl.SingularValueDecomposition(a), l = kl.Matrix.sqrt(f.diagonalMatrix).diagonal();
      return f.leftSingularVectors.toJSON().map(function(p) {
        return kl.Matrix.mul([p], [l]).toJSON()[0].splice(0, e);
      });
    } catch {
      for (var c = [], h = 0; h < n.length; h++) {
        var d = Math.random() * i, v = Math.random() * i;
        c.push([d, v]);
      }
      return c;
    }
  }, r;
}();
Fx.default = $se;
var jx = {};
Object.defineProperty(jx, "__esModule", { value: !0 });
var Wse = 800, Vse = function() {
  function r(t) {
    this.disp = [], this.positions = t.positions, this.adjMatrix = t.adjMatrix, this.focusID = t.focusID, this.radii = t.radii, this.iterations = t.iterations || 10, this.height = t.height || 10, this.width = t.width || 10, this.speed = t.speed || 100, this.gravity = t.gravity || 10, this.nodeSizeFunc = t.nodeSizeFunc, this.k = t.k || 5, this.strictRadial = t.strictRadial, this.nodes = t.nodes;
  }
  return r.prototype.layout = function() {
    var t = this, e = t.positions, n = [], i = t.iterations, a = t.width / 10;
    t.maxDisplace = a, t.disp = n;
    for (var o = 0; o < i; o++)
      e.forEach(function(s, u) {
        n[u] = { x: 0, y: 0 };
      }), t.getRepulsion(), t.updatePositions();
    return e;
  }, r.prototype.getRepulsion = function() {
    var t = this, e = t.positions, n = t.nodes, i = t.disp, a = t.k, o = t.radii || [];
    e.forEach(function(s, u) {
      i[u] = { x: 0, y: 0 }, e.forEach(function(f, l) {
        if (u !== l && o[u] === o[l]) {
          var c = s[0] - f[0], h = s[1] - f[1], d = Math.sqrt(c * c + h * h);
          if (d === 0) {
            d = 1;
            var v = u > l ? 1 : -1;
            c = 0.01 * v, h = 0.01 * v;
          }
          if (d < t.nodeSizeFunc(n[u]) / 2 + t.nodeSizeFunc(n[l]) / 2) {
            var p = a * a / d;
            i[u].x += c / d * p, i[u].y += h / d * p;
          }
        }
      });
    });
  }, r.prototype.updatePositions = function() {
    var t = this, e = t.positions, n = t.disp, i = t.speed, a = t.strictRadial, o = t.focusID, s = t.maxDisplace || t.width / 10;
    a && n.forEach(function(f, l) {
      var c = e[l][0] - e[o][0], h = e[l][1] - e[o][1], d = Math.sqrt(c * c + h * h), v = h / d, p = -c / d, g = Math.sqrt(f.x * f.x + f.y * f.y), y = Math.acos((v * f.x + p * f.y) / g);
      y > Math.PI / 2 && (y -= Math.PI / 2, v *= -1, p *= -1);
      var b = Math.cos(y) * g;
      f.x = v * b, f.y = p * b;
    });
    var u = t.radii;
    e.forEach(function(f, l) {
      if (l !== o) {
        var c = Math.sqrt(n[l].x * n[l].x + n[l].y * n[l].y);
        if (c > 0 && l !== o) {
          var h = Math.min(s * (i / Wse), c);
          if (f[0] += n[l].x / c * h, f[1] += n[l].y / c * h, a) {
            var d = f[0] - e[o][0], v = f[1] - e[o][1], p = Math.sqrt(d * d + v * v);
            d = d / p * u[l], v = v / p * u[l], f[0] = e[o][0] + d, f[1] = e[o][1] + v;
          }
        }
      }
    });
  }, r;
}();
jx.default = Vse;
var Xse = Oe && Oe.__extends || function() {
  var r = function(t, e) {
    return r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(n, i) {
      n.__proto__ = i;
    } || function(n, i) {
      for (var a in i)
        Object.prototype.hasOwnProperty.call(i, a) && (n[a] = i[a]);
    }, r(t, e);
  };
  return function(t, e) {
    if (typeof e != "function" && e !== null)
      throw new TypeError("Class extends value " + String(e) + " is not a constructor or null");
    r(t, e);
    function n() {
      this.constructor = t;
    }
    t.prototype = e === null ? Object.create(e) : (n.prototype = e.prototype, new n());
  };
}(), HB = Oe && Oe.__importDefault || function(r) {
  return r && r.__esModule ? r : { default: r };
};
Object.defineProperty(mg, "__esModule", { value: !0 });
mg.RadialLayout = void 0;
var Ii = on(), Yse = an, Hse = HB(Fx), Kse = HB(jx);
function qse(r) {
  for (var t = r.length, e = r[0].length, n = [], i = 0; i < t; i++) {
    for (var a = [], o = 0; o < e; o++)
      r[i][o] !== 0 ? a.push(1 / (r[i][o] * r[i][o])) : a.push(0);
    n.push(a);
  }
  return n;
}
function Zse(r, t) {
  var e = -1;
  return r.forEach(function(n, i) {
    n.id === t && (e = i);
  }), e;
}
function HM(r, t) {
  return Math.sqrt((r[0] - t[0]) * (r[0] - t[0]) + (r[1] - t[1]) * (r[1] - t[1]));
}
var Qse = function(r) {
  Xse(t, r);
  function t(e) {
    var n = r.call(this) || this;
    return n.maxIteration = 1e3, n.focusNode = null, n.unitRadius = null, n.linkDistance = 50, n.preventOverlap = !1, n.strictRadial = !0, n.maxPreventOverlapIteration = 200, n.sortStrength = 10, n.nodes = [], n.edges = [], n.updateCfg(e), n;
  }
  return t.prototype.getDefaultCfg = function() {
    return {
      maxIteration: 1e3,
      focusNode: null,
      unitRadius: null,
      linkDistance: 50,
      preventOverlap: !1,
      nodeSize: void 0,
      nodeSpacing: void 0,
      strictRadial: !0,
      maxPreventOverlapIteration: 200,
      sortBy: void 0,
      sortStrength: 10
    };
  }, t.prototype.execute = function() {
    var e = this, n = e.nodes, i = e.edges || [];
    if (!n || n.length === 0) {
      e.onLayoutEnd && e.onLayoutEnd();
      return;
    }
    !e.width && typeof window < "u" && (e.width = window.innerWidth), !e.height && typeof window < "u" && (e.height = window.innerHeight), e.center || (e.center = [e.width / 2, e.height / 2]);
    var a = e.center;
    if (n.length === 1) {
      n[0].x = a[0], n[0].y = a[1], e.onLayoutEnd && e.onLayoutEnd();
      return;
    }
    var o = e.linkDistance, s = null;
    if ((0, Ii.isString)(e.focusNode)) {
      for (var u = !1, f = 0; f < n.length; f++)
        n[f].id === e.focusNode && (s = n[f], e.focusNode = s, u = !0, f = n.length);
      u || (s = null);
    } else
      s = e.focusNode;
    s || (s = n[0], e.focusNode = s);
    var l = Zse(n, s.id);
    l < 0 && (l = 0), e.focusIndex = l;
    var c = (0, Ii.getAdjMatrix)({ nodes: n, edges: i }, !1), h = (0, Ii.floydWarshall)(c), d = e.maxToFocus(h, l);
    e.handleInfinity(h, l, d + 1), e.distances = h;
    var v = h[l], p = e.width || 500, g = e.height || 500, y = p - a[0] > a[0] ? a[0] : p - a[0], b = g - a[1] > a[1] ? a[1] : g - a[1];
    y === 0 && (y = p / 2), b === 0 && (b = g / 2);
    var m = b > y ? y : b, x = Math.max.apply(Math, v), _ = [];
    v.forEach(function(G, R) {
      e.unitRadius || (e.unitRadius = m / x), _[R] = G * e.unitRadius;
    }), e.radii = _;
    var w = e.eIdealDisMatrix();
    e.eIdealDistances = w;
    var E = qse(w);
    e.weights = E;
    var M = new Hse.default({ linkDistance: o, distances: w }), C = M.layout();
    C.forEach(function(G) {
      (0, Ii.isNaN)(G[0]) && (G[0] = Math.random() * o), (0, Ii.isNaN)(G[1]) && (G[1] = Math.random() * o);
    }), e.positions = C, C.forEach(function(G, R) {
      n[R].x = G[0] + a[0], n[R].y = G[1] + a[1];
    }), C.forEach(function(G) {
      G[0] -= C[l][0], G[1] -= C[l][1];
    }), e.run();
    var S = e.preventOverlap, A = e.nodeSize, T, P = e.strictRadial;
    if (S) {
      var k = e.nodeSpacing, L;
      (0, Ii.isNumber)(k) ? L = function() {
        return k;
      } : (0, Ii.isFunction)(k) ? L = k : L = function() {
        return 0;
      }, A ? (0, Ii.isArray)(A) ? T = function(G) {
        var R = A[0] > A[1] ? A[0] : A[1];
        return R + L(G);
      } : T = function(G) {
        return A + L(G);
      } : T = function(G) {
        if (G.size) {
          if ((0, Ii.isArray)(G.size)) {
            var R = G.size[0] > G.size[1] ? G.size[0] : G.size[1];
            return R + L(G);
          }
          if ((0, Ii.isObject)(G.size)) {
            var R = G.size.width > G.size.height ? G.size.width : G.size.height;
            return R + L(G);
          }
          return G.size + L(G);
        }
        return 10 + L(G);
      };
      var O = {
        nodes: n,
        nodeSizeFunc: T,
        adjMatrix: c,
        positions: C,
        radii: _,
        height: g,
        width: p,
        strictRadial: P,
        focusID: l,
        iterations: e.maxPreventOverlapIteration || 200,
        k: C.length / 4.5
      }, D = new Kse.default(O);
      C = D.layout();
    }
    return C.forEach(function(G, R) {
      n[R].x = G[0] + a[0], n[R].y = G[1] + a[1];
    }), e.onLayoutEnd && e.onLayoutEnd(), {
      nodes: n,
      edges: i
    };
  }, t.prototype.run = function() {
    for (var e = this, n = e.maxIteration, i = e.positions || [], a = e.weights || [], o = e.eIdealDistances || [], s = e.radii || [], u = 0; u <= n; u++) {
      var f = u / n;
      e.oneIteration(f, i, s, o, a);
    }
  }, t.prototype.oneIteration = function(e, n, i, a, o) {
    var s = this, u = 1 - e, f = s.focusIndex;
    n.forEach(function(l, c) {
      var h = HM(l, [0, 0]), d = h === 0 ? 0 : 1 / h;
      if (c !== f) {
        var v = 0, p = 0, g = 0;
        n.forEach(function(b, m) {
          if (c !== m) {
            var x = HM(l, b), _ = x === 0 ? 0 : 1 / x, w = a[m][c];
            g += o[c][m], v += o[c][m] * (b[0] + w * (l[0] - b[0]) * _), p += o[c][m] * (b[1] + w * (l[1] - b[1]) * _);
          }
        });
        var y = i[c] === 0 ? 0 : 1 / i[c];
        g *= u, g += e * y * y, v *= u, v += e * y * l[0] * d, l[0] = v / g, p *= u, p += e * y * l[1] * d, l[1] = p / g;
      }
    });
  }, t.prototype.eIdealDisMatrix = function() {
    var e = this, n = e.nodes;
    if (!n)
      return [];
    var i = e.distances, a = e.linkDistance, o = e.radii || [], s = e.unitRadius || 50, u = [];
    return i && i.forEach(function(f, l) {
      var c = [];
      f.forEach(function(h, d) {
        if (l === d)
          c.push(0);
        else if (o[l] === o[d])
          if (e.sortBy === "data")
            c.push(h * (Math.abs(l - d) * e.sortStrength) / (o[l] / s));
          else if (e.sortBy) {
            var v = n[l][e.sortBy] || 0, p = n[d][e.sortBy] || 0;
            (0, Ii.isString)(v) && (v = v.charCodeAt(0)), (0, Ii.isString)(p) && (p = p.charCodeAt(0)), c.push(h * (Math.abs(v - p) * e.sortStrength) / (o[l] / s));
          } else
            c.push(h * a / (o[l] / s));
        else {
          var g = (a + s) / 2;
          c.push(h * g);
        }
      }), u.push(c);
    }), u;
  }, t.prototype.handleInfinity = function(e, n, i) {
    for (var a = e.length, o = 0; o < a; o++)
      if (e[n][o] === 1 / 0) {
        e[n][o] = i, e[o][n] = i;
        for (var s = 0; s < a; s++)
          e[o][s] !== 1 / 0 && e[n][s] === 1 / 0 && (e[n][s] = i + e[o][s], e[s][n] = i + e[o][s]);
      }
    for (var o = 0; o < a; o++)
      if (o !== n) {
        for (var s = 0; s < a; s++)
          if (e[o][s] === 1 / 0) {
            var u = Math.abs(e[n][o] - e[n][s]);
            u = u === 0 ? 1 : u, e[o][s] = u;
          }
      }
  }, t.prototype.maxToFocus = function(e, n) {
    for (var i = 0, a = 0; a < e[n].length; a++)
      e[n][a] !== 1 / 0 && (i = e[n][a] > i ? e[n][a] : i);
    return i;
  }, t.prototype.getType = function() {
    return "radial";
  }, t;
}(Yse.Base);
mg.RadialLayout = Qse;
(function(r) {
  var t = Oe && Oe.__createBinding || (Object.create ? function(n, i, a, o) {
    o === void 0 && (o = a);
    var s = Object.getOwnPropertyDescriptor(i, a);
    (!s || ("get" in s ? !i.__esModule : s.writable || s.configurable)) && (s = { enumerable: !0, get: function() {
      return i[a];
    } }), Object.defineProperty(n, o, s);
  } : function(n, i, a, o) {
    o === void 0 && (o = a), n[o] = i[a];
  }), e = Oe && Oe.__exportStar || function(n, i) {
    for (var a in n)
      a !== "default" && !Object.prototype.hasOwnProperty.call(i, a) && t(i, n, a);
  };
  Object.defineProperty(r, "__esModule", { value: !0 }), e(mg, r);
})(Gx);
var mh = {}, Jse = Oe && Oe.__extends || function() {
  var r = function(t, e) {
    return r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(n, i) {
      n.__proto__ = i;
    } || function(n, i) {
      for (var a in i)
        Object.prototype.hasOwnProperty.call(i, a) && (n[a] = i[a]);
    }, r(t, e);
  };
  return function(t, e) {
    if (typeof e != "function" && e !== null)
      throw new TypeError("Class extends value " + String(e) + " is not a constructor or null");
    r(t, e);
    function n() {
      this.constructor = t;
    }
    t.prototype = e === null ? Object.create(e) : (n.prototype = e.prototype, new n());
  };
}();
Object.defineProperty(mh, "__esModule", { value: !0 });
mh.ConcentricLayout = void 0;
var pa = on(), eue = an, tue = function(r) {
  Jse(t, r);
  function t(e) {
    var n = r.call(this) || this;
    return n.nodeSize = 30, n.minNodeSpacing = 10, n.nodeSpacing = 10, n.preventOverlap = !1, n.equidistant = !1, n.startAngle = 3 / 2 * Math.PI, n.clockwise = !0, n.sortBy = "degree", n.nodes = [], n.edges = [], n.width = 300, n.height = 300, n.onLayoutEnd = function() {
    }, n.updateCfg(e), n;
  }
  return t.prototype.getDefaultCfg = function() {
    return {
      nodeSize: 30,
      minNodeSpacing: 10,
      nodeSpacing: 10,
      preventOverlap: !1,
      sweep: void 0,
      equidistant: !1,
      startAngle: 3 / 2 * Math.PI,
      clockwise: !0,
      maxLevelDiff: void 0,
      sortBy: "degree"
    };
  }, t.prototype.execute = function() {
    var e, n, i = this, a = i.nodes, o = i.edges, s = a.length;
    if (s === 0) {
      (e = i.onLayoutEnd) === null || e === void 0 || e.call(i);
      return;
    }
    !i.width && typeof window < "u" && (i.width = window.innerWidth), !i.height && typeof window < "u" && (i.height = window.innerHeight), i.center || (i.center = [i.width / 2, i.height / 2]);
    var u = i.center;
    if (s === 1) {
      a[0].x = u[0], a[0].y = u[1], (n = i.onLayoutEnd) === null || n === void 0 || n.call(i);
      return;
    }
    var f = i.nodeSize, l = i.nodeSpacing, c = [], h, d = 0;
    (0, pa.isArray)(f) ? h = Math.max(f[0], f[1]) : h = f, (0, pa.isArray)(l) ? d = Math.max(l[0], l[1]) : (0, pa.isNumber)(l) && (d = l), a.forEach(function(P) {
      c.push(P);
      var k = h;
      (0, pa.isArray)(P.size) ? k = Math.max(P.size[0], P.size[1]) : (0, pa.isNumber)(P.size) ? k = P.size : (0, pa.isObject)(P.size) && (k = Math.max(P.size.width, P.size.height)), h = Math.max(h, k), (0, pa.isFunction)(l) && (d = Math.max(l(P), d));
    }), i.clockwise = i.counterclockwise !== void 0 ? !i.counterclockwise : i.clockwise;
    var v = {}, p = {};
    if (c.forEach(function(P, k) {
      v[P.id] = P, p[P.id] = k;
    }), (i.sortBy === "degree" || !(0, pa.isString)(i.sortBy) || c[0][i.sortBy] === void 0) && (i.sortBy = "degree", !(0, pa.isNumber)(a[0].degree))) {
      var g = (0, pa.getDegree)(a.length, p, o);
      c.forEach(function(P, k) {
        P.degree = g[k].all;
      });
    }
    c.sort(function(P, k) {
      return k[i.sortBy] - P[i.sortBy];
    }), i.maxValueNode = c[0], i.maxLevelDiff = i.maxLevelDiff || i.maxValueNode[i.sortBy] / 4;
    var y = [[]], b = y[0];
    c.forEach(function(P) {
      if (b.length > 0) {
        var k = Math.abs(b[0][i.sortBy] - P[i.sortBy]);
        i.maxLevelDiff && k >= i.maxLevelDiff && (b = [], y.push(b));
      }
      b.push(P);
    });
    var m = h + (d || i.minNodeSpacing);
    if (!i.preventOverlap) {
      var x = y.length > 0 && y[0].length > 1, _ = Math.min(i.width, i.height) / 2 - m, w = _ / (y.length + (x ? 1 : 0));
      m = Math.min(m, w);
    }
    var E = 0;
    if (y.forEach(function(P) {
      var k = i.sweep;
      k === void 0 && (k = 2 * Math.PI - 2 * Math.PI / P.length);
      var L = P.dTheta = k / Math.max(1, P.length - 1);
      if (P.length > 1 && i.preventOverlap) {
        var O = Math.cos(L) - Math.cos(0), D = Math.sin(L) - Math.sin(0), G = Math.sqrt(m * m / (O * O + D * D));
        E = Math.max(G, E);
      }
      P.r = E, E += m;
    }), i.equidistant) {
      for (var M = 0, C = 0, S = 0; S < y.length; S++) {
        var A = y[S], T = A.r - C;
        M = Math.max(M, T);
      }
      C = 0, y.forEach(function(P, k) {
        k === 0 && (C = P.r), P.r = C, C += M;
      });
    }
    return y.forEach(function(P) {
      var k = P.dTheta, L = P.r;
      P.forEach(function(O, D) {
        var G = i.startAngle + (i.clockwise ? 1 : -1) * k * D;
        O.x = u[0] + L * Math.cos(G), O.y = u[1] + L * Math.sin(G);
      });
    }), i.onLayoutEnd && i.onLayoutEnd(), {
      nodes: a,
      edges: o
    };
  }, t.prototype.getType = function() {
    return "concentric";
  }, t;
}(eue.Base);
mh.ConcentricLayout = tue;
var bh = {}, rue = Oe && Oe.__extends || function() {
  var r = function(t, e) {
    return r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(n, i) {
      n.__proto__ = i;
    } || function(n, i) {
      for (var a in i)
        Object.prototype.hasOwnProperty.call(i, a) && (n[a] = i[a]);
    }, r(t, e);
  };
  return function(t, e) {
    if (typeof e != "function" && e !== null)
      throw new TypeError("Class extends value " + String(e) + " is not a constructor or null");
    r(t, e);
    function n() {
      this.constructor = t;
    }
    t.prototype = e === null ? Object.create(e) : (n.prototype = e.prototype, new n());
  };
}();
Object.defineProperty(bh, "__esModule", { value: !0 });
bh.MDSLayout = void 0;
var Ll = YB, My = on(), nue = an, iue = function(r) {
  rue(t, r);
  function t(e) {
    var n = r.call(this) || this;
    return n.center = [0, 0], n.linkDistance = 50, n.nodes = [], n.edges = [], n.onLayoutEnd = function() {
    }, n.updateCfg(e), n;
  }
  return t.prototype.getDefaultCfg = function() {
    return {
      center: [0, 0],
      linkDistance: 50
    };
  }, t.prototype.execute = function() {
    var e = this, n = e.nodes, i = e.edges, a = i === void 0 ? [] : i, o = e.center;
    if (!n || n.length === 0) {
      e.onLayoutEnd && e.onLayoutEnd();
      return;
    }
    if (n.length === 1) {
      n[0].x = o[0], n[0].y = o[1], e.onLayoutEnd && e.onLayoutEnd();
      return;
    }
    var s = e.linkDistance, u = (0, My.getAdjMatrix)({ nodes: n, edges: a }, !1), f = (0, My.floydWarshall)(u);
    e.handleInfinity(f);
    var l = (0, My.scaleMatrix)(f, s);
    e.scaledDistances = l;
    var c = e.runMDS();
    return e.positions = c, c.forEach(function(h, d) {
      n[d].x = h[0] + o[0], n[d].y = h[1] + o[1];
    }), e.onLayoutEnd && e.onLayoutEnd(), {
      nodes: n,
      edges: a
    };
  }, t.prototype.runMDS = function() {
    var e = this, n = 2, i = e.scaledDistances, a = Ll.Matrix.mul(Ll.Matrix.pow(i, 2), -0.5), o = a.mean("row"), s = a.mean("column"), u = a.mean();
    a.add(u).subRowVector(o).subColumnVector(s);
    var f = new Ll.SingularValueDecomposition(a), l = Ll.Matrix.sqrt(f.diagonalMatrix).diagonal();
    return f.leftSingularVectors.toJSON().map(function(c) {
      return Ll.Matrix.mul([c], [l]).toJSON()[0].splice(0, n);
    });
  }, t.prototype.handleInfinity = function(e) {
    var n = -999999;
    e.forEach(function(i) {
      i.forEach(function(a) {
        a !== 1 / 0 && n < a && (n = a);
      });
    }), e.forEach(function(i, a) {
      i.forEach(function(o, s) {
        o === 1 / 0 && (e[a][s] = n);
      });
    });
  }, t.prototype.getType = function() {
    return "mds";
  }, t;
}(nue.Base);
bh.MDSLayout = iue;
var xh = {}, aue = Oe && Oe.__extends || function() {
  var r = function(t, e) {
    return r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(n, i) {
      n.__proto__ = i;
    } || function(n, i) {
      for (var a in i)
        Object.prototype.hasOwnProperty.call(i, a) && (n[a] = i[a]);
    }, r(t, e);
  };
  return function(t, e) {
    if (typeof e != "function" && e !== null)
      throw new TypeError("Class extends value " + String(e) + " is not a constructor or null");
    r(t, e);
    function n() {
      this.constructor = t;
    }
    t.prototype = e === null ? Object.create(e) : (n.prototype = e.prototype, new n());
  };
}();
Object.defineProperty(xh, "__esModule", { value: !0 });
xh.FruchtermanLayout = void 0;
var oue = an, rn = on(), sue = 800, uue = function(r) {
  aue(t, r);
  function t(e) {
    var n = r.call(this) || this;
    return n.maxIteration = 1e3, n.workerEnabled = !1, n.gravity = 10, n.speed = 5, n.clustering = !1, n.clusterGravity = 10, n.nodes = [], n.edges = [], n.width = 300, n.height = 300, n.nodeMap = {}, n.nodeIdxMap = {}, n.onLayoutEnd = function() {
    }, n.tick = function() {
    }, n.animate = !0, n.updateCfg(e), n;
  }
  return t.prototype.getDefaultCfg = function() {
    return {
      maxIteration: 1e3,
      gravity: 10,
      speed: 1,
      clustering: !1,
      clusterGravity: 10,
      animate: !0
    };
  }, t.prototype.execute = function() {
    var e = this, n, i, a = this, o = a.nodes;
    if (a.timeInterval !== void 0 && typeof window < "u" && window.clearInterval(a.timeInterval), !o || o.length === 0) {
      (n = a.onLayoutEnd) === null || n === void 0 || n.call(a);
      return;
    }
    !a.width && typeof window < "u" && (a.width = window.innerWidth), !a.height && typeof window < "u" && (a.height = window.innerHeight), a.center || (a.center = [a.width / 2, a.height / 2]);
    var s = a.center;
    if (o.length === 1) {
      o[0].x = s[0], o[0].y = s[1], (i = a.onLayoutEnd) === null || i === void 0 || i.call(a);
      return;
    }
    var u = {}, f = {};
    return o.forEach(function(l, c) {
      (0, rn.isNumber)(l.x) || (l.x = Math.random() * e.width), (0, rn.isNumber)(l.y) || (l.y = Math.random() * e.height), u[l.id] = l, f[l.id] = c;
    }), a.nodeMap = u, a.nodeIdxMap = f, a.run();
  }, t.prototype.run = function() {
    var e, n = this, i = n.nodes;
    if (!!i) {
      var a = n.edges, o = n.maxIteration, s = n.workerEnabled, u = n.clustering, f = n.animate, l = {};
      if (u && i.forEach(function(d) {
        l[d.cluster] === void 0 && (l[d.cluster] = {
          name: d.cluster,
          cx: 0,
          cy: 0,
          count: 0
        });
      }), s || !f) {
        for (var c = 0; c < o; c++)
          n.runOneStep(l);
        (e = n.onLayoutEnd) === null || e === void 0 || e.call(n);
      } else {
        if (typeof window > "u")
          return;
        var h = 0;
        this.timeInterval = window.setInterval(function() {
          var d;
          n.runOneStep(l), h++, h >= o && ((d = n.onLayoutEnd) === null || d === void 0 || d.call(n), window.clearInterval(n.timeInterval));
        }, 0);
      }
      return {
        nodes: i,
        edges: a
      };
    }
  }, t.prototype.runOneStep = function(e) {
    var n, i = this, a = i.nodes;
    if (!!a) {
      var o = i.edges, s = i.center, u = i.gravity, f = i.speed, l = i.clustering, c = i.height * i.width, h = Math.sqrt(c) / 10, d = c / (a.length + 1), v = Math.sqrt(d), p = [];
      if (a.forEach(function(b, m) {
        p[m] = { x: 0, y: 0 };
      }), i.applyCalculate(a, o, p, v, d), l) {
        for (var g in e)
          e[g].cx = 0, e[g].cy = 0, e[g].count = 0;
        a.forEach(function(b) {
          var m = e[b.cluster];
          (0, rn.isNumber)(b.x) && (m.cx += b.x), (0, rn.isNumber)(b.y) && (m.cy += b.y), m.count++;
        });
        for (var g in e)
          e[g].cx /= e[g].count, e[g].cy /= e[g].count;
        var y = i.clusterGravity || u;
        a.forEach(function(b, m) {
          if (!(!(0, rn.isNumber)(b.x) || !(0, rn.isNumber)(b.y))) {
            var x = e[b.cluster], _ = Math.sqrt((b.x - x.cx) * (b.x - x.cx) + (b.y - x.cy) * (b.y - x.cy)), w = v * y;
            p[m].x -= w * (b.x - x.cx) / _, p[m].y -= w * (b.y - x.cy) / _;
          }
        });
      }
      a.forEach(function(b, m) {
        if (!(!(0, rn.isNumber)(b.x) || !(0, rn.isNumber)(b.y))) {
          var x = 0.01 * v * u;
          p[m].x -= x * (b.x - s[0]), p[m].y -= x * (b.y - s[1]);
        }
      }), a.forEach(function(b, m) {
        if ((0, rn.isNumber)(b.fx) && (0, rn.isNumber)(b.fy)) {
          b.x = b.fx, b.y = b.fy;
          return;
        }
        if (!(!(0, rn.isNumber)(b.x) || !(0, rn.isNumber)(b.y))) {
          var x = Math.sqrt(p[m].x * p[m].x + p[m].y * p[m].y);
          if (x > 0) {
            var _ = Math.min(h * (f / sue), x);
            b.x += p[m].x / x * _, b.y += p[m].y / x * _;
          }
        }
      }), (n = i.tick) === null || n === void 0 || n.call(i);
    }
  }, t.prototype.applyCalculate = function(e, n, i, a, o) {
    var s = this;
    s.calRepulsive(e, i, o), n && s.calAttractive(n, i, a);
  }, t.prototype.calRepulsive = function(e, n, i) {
    e.forEach(function(a, o) {
      n[o] = { x: 0, y: 0 }, e.forEach(function(s, u) {
        if (o !== u && !(!(0, rn.isNumber)(a.x) || !(0, rn.isNumber)(s.x) || !(0, rn.isNumber)(a.y) || !(0, rn.isNumber)(s.y))) {
          var f = a.x - s.x, l = a.y - s.y, c = f * f + l * l;
          if (c === 0) {
            c = 1;
            var h = o > u ? 1 : -1;
            f = 0.01 * h, l = 0.01 * h;
          }
          var d = i / c;
          n[o].x += f * d, n[o].y += l * d;
        }
      });
    });
  }, t.prototype.calAttractive = function(e, n, i) {
    var a = this;
    e.forEach(function(o) {
      var s = (0, rn.getEdgeTerminal)(o, "source"), u = (0, rn.getEdgeTerminal)(o, "target");
      if (!(!s || !u)) {
        var f = a.nodeIdxMap[s], l = a.nodeIdxMap[u];
        if (f !== l) {
          var c = a.nodeMap[s], h = a.nodeMap[u];
          if (!(!(0, rn.isNumber)(h.x) || !(0, rn.isNumber)(c.x) || !(0, rn.isNumber)(h.y) || !(0, rn.isNumber)(c.y))) {
            var d = h.x - c.x, v = h.y - c.y, p = Math.sqrt(d * d + v * v), g = p * p / i;
            n[l].x -= d / p * g, n[l].y -= v / p * g, n[f].x += d / p * g, n[f].y += v / p * g;
          }
        }
      }
    });
  }, t.prototype.stop = function() {
    this.timeInterval && typeof window < "u" && window.clearInterval(this.timeInterval);
  }, t.prototype.destroy = function() {
    var e = this;
    e.stop(), e.tick = null, e.nodes = null, e.edges = null, e.destroyed = !0;
  }, t.prototype.getType = function() {
    return "fruchterman";
  }, t;
}(oue.Base);
xh.FruchtermanLayout = uue;
var _h = {};
function Ft(r, t, e, n) {
  !e || Object.defineProperty(r, t, {
    enumerable: e.enumerable,
    configurable: e.configurable,
    writable: e.writable,
    value: e.initializer ? e.initializer.call(n) : void 0
  });
}
function Pt(r, t) {
  if (!(r instanceof t))
    throw new TypeError("Cannot call a class as a function");
}
function KM(r, t) {
  for (var e = 0; e < t.length; e++) {
    var n = t[e];
    n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(r, n.key, n);
  }
}
function Wt(r, t, e) {
  return t && KM(r.prototype, t), e && KM(r, e), Object.defineProperty(r, "prototype", {
    writable: !1
  }), r;
}
function zt(r, t, e, n, i) {
  var a = {};
  return Object.keys(n).forEach(function(o) {
    a[o] = n[o];
  }), a.enumerable = !!a.enumerable, a.configurable = !!a.configurable, ("value" in a || a.initializer) && (a.writable = !0), a = e.slice().reverse().reduce(function(o, s) {
    return s(r, t, o) || o;
  }, a), i && a.initializer !== void 0 && (a.value = a.initializer ? a.initializer.call(i) : void 0, a.initializer = void 0), a.initializer === void 0 && (Object.defineProperty(r, t, a), a = null), a;
}
/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var qM;
(function(r) {
  (function(t) {
    var e = typeof Oe == "object" ? Oe : typeof self == "object" ? self : typeof this == "object" ? this : Function("return this;")(), n = i(r);
    typeof e.Reflect > "u" ? e.Reflect = r : n = i(e.Reflect, n), t(n);
    function i(a, o) {
      return function(s, u) {
        typeof a[s] != "function" && Object.defineProperty(a, s, { configurable: !0, writable: !0, value: u }), o && o(s, u);
      };
    }
  })(function(t) {
    var e = Object.prototype.hasOwnProperty, n = typeof Symbol == "function", i = n && typeof Symbol.toPrimitive < "u" ? Symbol.toPrimitive : "@@toPrimitive", a = n && typeof Symbol.iterator < "u" ? Symbol.iterator : "@@iterator", o = typeof Object.create == "function", s = { __proto__: [] } instanceof Array, u = !o && !s, f = {
      create: o ? function() {
        return N(/* @__PURE__ */ Object.create(null));
      } : s ? function() {
        return N({ __proto__: null });
      } : function() {
        return N({});
      },
      has: u ? function(Z, pe) {
        return e.call(Z, pe);
      } : function(Z, pe) {
        return pe in Z;
      },
      get: u ? function(Z, pe) {
        return e.call(Z, pe) ? Z[pe] : void 0;
      } : function(Z, pe) {
        return Z[pe];
      }
    }, l = Object.getPrototypeOf(Function), c = typeof process == "object" && process.env && process.env.REFLECT_METADATA_USE_MAP_POLYFILL === "true", h = !c && typeof Map == "function" && typeof Map.prototype.entries == "function" ? Map : Kt(), d = !c && typeof Set == "function" && typeof Set.prototype.entries == "function" ? Set : Ye(), v = !c && typeof WeakMap == "function" ? WeakMap : vt(), p = new v();
    function g(Z, pe, se, Ce) {
      if (q(se)) {
        if (!et(Z))
          throw new TypeError();
        if (!pt(pe))
          throw new TypeError();
        return S(Z, pe);
      } else {
        if (!et(Z))
          throw new TypeError();
        if (!ie(pe))
          throw new TypeError();
        if (!ie(Ce) && !q(Ce) && !ne(Ce))
          throw new TypeError();
        return ne(Ce) && (Ce = void 0), se = $e(se), A(Z, pe, se, Ce);
      }
    }
    t("decorate", g);
    function y(Z, pe) {
      function se(Ce, ke) {
        if (!ie(Ce))
          throw new TypeError();
        if (!q(ke) && !$(ke))
          throw new TypeError();
        D(Z, pe, Ce, ke);
      }
      return se;
    }
    t("metadata", y);
    function b(Z, pe, se, Ce) {
      if (!ie(se))
        throw new TypeError();
      return q(Ce) || (Ce = $e(Ce)), D(Z, pe, se, Ce);
    }
    t("defineMetadata", b);
    function m(Z, pe, se) {
      if (!ie(pe))
        throw new TypeError();
      return q(se) || (se = $e(se)), P(Z, pe, se);
    }
    t("hasMetadata", m);
    function x(Z, pe, se) {
      if (!ie(pe))
        throw new TypeError();
      return q(se) || (se = $e(se)), k(Z, pe, se);
    }
    t("hasOwnMetadata", x);
    function _(Z, pe, se) {
      if (!ie(pe))
        throw new TypeError();
      return q(se) || (se = $e(se)), L(Z, pe, se);
    }
    t("getMetadata", _);
    function w(Z, pe, se) {
      if (!ie(pe))
        throw new TypeError();
      return q(se) || (se = $e(se)), O(Z, pe, se);
    }
    t("getOwnMetadata", w);
    function E(Z, pe) {
      if (!ie(Z))
        throw new TypeError();
      return q(pe) || (pe = $e(pe)), G(Z, pe);
    }
    t("getMetadataKeys", E);
    function M(Z, pe) {
      if (!ie(Z))
        throw new TypeError();
      return q(pe) || (pe = $e(pe)), R(Z, pe);
    }
    t("getOwnMetadataKeys", M);
    function C(Z, pe, se) {
      if (!ie(pe))
        throw new TypeError();
      q(se) || (se = $e(se));
      var Ce = T(pe, se, !1);
      if (q(Ce) || !Ce.delete(Z))
        return !1;
      if (Ce.size > 0)
        return !0;
      var ke = p.get(pe);
      return ke.delete(se), ke.size > 0 || p.delete(pe), !0;
    }
    t("deleteMetadata", C);
    function S(Z, pe) {
      for (var se = Z.length - 1; se >= 0; --se) {
        var Ce = Z[se], ke = Ce(pe);
        if (!q(ke) && !ne(ke)) {
          if (!pt(ke))
            throw new TypeError();
          pe = ke;
        }
      }
      return pe;
    }
    function A(Z, pe, se, Ce) {
      for (var ke = Z.length - 1; ke >= 0; --ke) {
        var at = Z[ke], je = at(pe, se, Ce);
        if (!q(je) && !ne(je)) {
          if (!ie(je))
            throw new TypeError();
          Ce = je;
        }
      }
      return Ce;
    }
    function T(Z, pe, se) {
      var Ce = p.get(Z);
      if (q(Ce)) {
        if (!se)
          return;
        Ce = new h(), p.set(Z, Ce);
      }
      var ke = Ce.get(pe);
      if (q(ke)) {
        if (!se)
          return;
        ke = new h(), Ce.set(pe, ke);
      }
      return ke;
    }
    function P(Z, pe, se) {
      var Ce = k(Z, pe, se);
      if (Ce)
        return !0;
      var ke = _t(pe);
      return ne(ke) ? !1 : P(Z, ke, se);
    }
    function k(Z, pe, se) {
      var Ce = T(pe, se, !1);
      return q(Ce) ? !1 : le(Ce.has(Z));
    }
    function L(Z, pe, se) {
      var Ce = k(Z, pe, se);
      if (Ce)
        return O(Z, pe, se);
      var ke = _t(pe);
      if (!ne(ke))
        return L(Z, ke, se);
    }
    function O(Z, pe, se) {
      var Ce = T(pe, se, !1);
      if (!q(Ce))
        return Ce.get(Z);
    }
    function D(Z, pe, se, Ce) {
      var ke = T(se, Ce, !0);
      ke.set(Z, pe);
    }
    function G(Z, pe) {
      var se = R(Z, pe), Ce = _t(Z);
      if (Ce === null)
        return se;
      var ke = G(Ce, pe);
      if (ke.length <= 0)
        return se;
      if (se.length <= 0)
        return ke;
      for (var at = new d(), je = [], lt = 0, ct = se; lt < ct.length; lt++) {
        var Ot = ct[lt], mt = at.has(Ot);
        mt || (at.add(Ot), je.push(Ot));
      }
      for (var pr = 0, _r = ke; pr < _r.length; pr++) {
        var Ot = _r[pr], mt = at.has(Ot);
        mt || (at.add(Ot), je.push(Ot));
      }
      return je;
    }
    function R(Z, pe) {
      var se = [], Ce = T(Z, pe, !1);
      if (q(Ce))
        return se;
      for (var ke = Ce.keys(), at = X(ke), je = 0; ; ) {
        var lt = Ke(at);
        if (!lt)
          return se.length = je, se;
        var ct = De(lt);
        try {
          se[je] = ct;
        } catch (Ot) {
          try {
            Fe(at);
          } finally {
            throw Ot;
          }
        }
        je++;
      }
    }
    function F(Z) {
      if (Z === null)
        return 1;
      switch (typeof Z) {
        case "undefined":
          return 0;
        case "boolean":
          return 2;
        case "string":
          return 3;
        case "symbol":
          return 4;
        case "number":
          return 5;
        case "object":
          return Z === null ? 1 : 6;
        default:
          return 6;
      }
    }
    function q(Z) {
      return Z === void 0;
    }
    function ne(Z) {
      return Z === null;
    }
    function oe(Z) {
      return typeof Z == "symbol";
    }
    function ie(Z) {
      return typeof Z == "object" ? Z !== null : typeof Z == "function";
    }
    function Ee(Z, pe) {
      switch (F(Z)) {
        case 0:
          return Z;
        case 1:
          return Z;
        case 2:
          return Z;
        case 3:
          return Z;
        case 4:
          return Z;
        case 5:
          return Z;
      }
      var se = pe === 3 ? "string" : pe === 5 ? "number" : "default", Ce = te(Z, i);
      if (Ce !== void 0) {
        var ke = Ce.call(Z, se);
        if (ie(ke))
          throw new TypeError();
        return ke;
      }
      return Xe(Z, se === "default" ? "number" : se);
    }
    function Xe(Z, pe) {
      if (pe === "string") {
        var se = Z.toString;
        if (ft(se)) {
          var Ce = se.call(Z);
          if (!ie(Ce))
            return Ce;
        }
        var ke = Z.valueOf;
        if (ft(ke)) {
          var Ce = ke.call(Z);
          if (!ie(Ce))
            return Ce;
        }
      } else {
        var ke = Z.valueOf;
        if (ft(ke)) {
          var Ce = ke.call(Z);
          if (!ie(Ce))
            return Ce;
        }
        var at = Z.toString;
        if (ft(at)) {
          var Ce = at.call(Z);
          if (!ie(Ce))
            return Ce;
        }
      }
      throw new TypeError();
    }
    function le(Z) {
      return !!Z;
    }
    function Me(Z) {
      return "" + Z;
    }
    function $e(Z) {
      var pe = Ee(Z, 3);
      return oe(pe) ? pe : Me(pe);
    }
    function et(Z) {
      return Array.isArray ? Array.isArray(Z) : Z instanceof Object ? Z instanceof Array : Object.prototype.toString.call(Z) === "[object Array]";
    }
    function ft(Z) {
      return typeof Z == "function";
    }
    function pt(Z) {
      return typeof Z == "function";
    }
    function $(Z) {
      switch (F(Z)) {
        case 3:
          return !0;
        case 4:
          return !0;
        default:
          return !1;
      }
    }
    function te(Z, pe) {
      var se = Z[pe];
      if (se != null) {
        if (!ft(se))
          throw new TypeError();
        return se;
      }
    }
    function X(Z) {
      var pe = te(Z, a);
      if (!ft(pe))
        throw new TypeError();
      var se = pe.call(Z);
      if (!ie(se))
        throw new TypeError();
      return se;
    }
    function De(Z) {
      return Z.value;
    }
    function Ke(Z) {
      var pe = Z.next();
      return pe.done ? !1 : pe;
    }
    function Fe(Z) {
      var pe = Z.return;
      pe && pe.call(Z);
    }
    function _t(Z) {
      var pe = Object.getPrototypeOf(Z);
      if (typeof Z != "function" || Z === l || pe !== l)
        return pe;
      var se = Z.prototype, Ce = se && Object.getPrototypeOf(se);
      if (Ce == null || Ce === Object.prototype)
        return pe;
      var ke = Ce.constructor;
      return typeof ke != "function" || ke === Z ? pe : ke;
    }
    function Kt() {
      var Z = {}, pe = [], se = function() {
        function je(lt, ct, Ot) {
          this._index = 0, this._keys = lt, this._values = ct, this._selector = Ot;
        }
        return je.prototype["@@iterator"] = function() {
          return this;
        }, je.prototype[a] = function() {
          return this;
        }, je.prototype.next = function() {
          var lt = this._index;
          if (lt >= 0 && lt < this._keys.length) {
            var ct = this._selector(this._keys[lt], this._values[lt]);
            return lt + 1 >= this._keys.length ? (this._index = -1, this._keys = pe, this._values = pe) : this._index++, { value: ct, done: !1 };
          }
          return { value: void 0, done: !0 };
        }, je.prototype.throw = function(lt) {
          throw this._index >= 0 && (this._index = -1, this._keys = pe, this._values = pe), lt;
        }, je.prototype.return = function(lt) {
          return this._index >= 0 && (this._index = -1, this._keys = pe, this._values = pe), { value: lt, done: !0 };
        }, je;
      }();
      return function() {
        function je() {
          this._keys = [], this._values = [], this._cacheKey = Z, this._cacheIndex = -2;
        }
        return Object.defineProperty(je.prototype, "size", {
          get: function() {
            return this._keys.length;
          },
          enumerable: !0,
          configurable: !0
        }), je.prototype.has = function(lt) {
          return this._find(lt, !1) >= 0;
        }, je.prototype.get = function(lt) {
          var ct = this._find(lt, !1);
          return ct >= 0 ? this._values[ct] : void 0;
        }, je.prototype.set = function(lt, ct) {
          var Ot = this._find(lt, !0);
          return this._values[Ot] = ct, this;
        }, je.prototype.delete = function(lt) {
          var ct = this._find(lt, !1);
          if (ct >= 0) {
            for (var Ot = this._keys.length, mt = ct + 1; mt < Ot; mt++)
              this._keys[mt - 1] = this._keys[mt], this._values[mt - 1] = this._values[mt];
            return this._keys.length--, this._values.length--, lt === this._cacheKey && (this._cacheKey = Z, this._cacheIndex = -2), !0;
          }
          return !1;
        }, je.prototype.clear = function() {
          this._keys.length = 0, this._values.length = 0, this._cacheKey = Z, this._cacheIndex = -2;
        }, je.prototype.keys = function() {
          return new se(this._keys, this._values, Ce);
        }, je.prototype.values = function() {
          return new se(this._keys, this._values, ke);
        }, je.prototype.entries = function() {
          return new se(this._keys, this._values, at);
        }, je.prototype["@@iterator"] = function() {
          return this.entries();
        }, je.prototype[a] = function() {
          return this.entries();
        }, je.prototype._find = function(lt, ct) {
          return this._cacheKey !== lt && (this._cacheIndex = this._keys.indexOf(this._cacheKey = lt)), this._cacheIndex < 0 && ct && (this._cacheIndex = this._keys.length, this._keys.push(lt), this._values.push(void 0)), this._cacheIndex;
        }, je;
      }();
      function Ce(je, lt) {
        return je;
      }
      function ke(je, lt) {
        return lt;
      }
      function at(je, lt) {
        return [je, lt];
      }
    }
    function Ye() {
      return function() {
        function Z() {
          this._map = new h();
        }
        return Object.defineProperty(Z.prototype, "size", {
          get: function() {
            return this._map.size;
          },
          enumerable: !0,
          configurable: !0
        }), Z.prototype.has = function(pe) {
          return this._map.has(pe);
        }, Z.prototype.add = function(pe) {
          return this._map.set(pe, pe), this;
        }, Z.prototype.delete = function(pe) {
          return this._map.delete(pe);
        }, Z.prototype.clear = function() {
          this._map.clear();
        }, Z.prototype.keys = function() {
          return this._map.keys();
        }, Z.prototype.values = function() {
          return this._map.values();
        }, Z.prototype.entries = function() {
          return this._map.entries();
        }, Z.prototype["@@iterator"] = function() {
          return this.keys();
        }, Z.prototype[a] = function() {
          return this.keys();
        }, Z;
      }();
    }
    function vt() {
      var Z = 16, pe = f.create(), se = Ce();
      return function() {
        function ct() {
          this._key = Ce();
        }
        return ct.prototype.has = function(Ot) {
          var mt = ke(Ot, !1);
          return mt !== void 0 ? f.has(mt, this._key) : !1;
        }, ct.prototype.get = function(Ot) {
          var mt = ke(Ot, !1);
          return mt !== void 0 ? f.get(mt, this._key) : void 0;
        }, ct.prototype.set = function(Ot, mt) {
          var pr = ke(Ot, !0);
          return pr[this._key] = mt, this;
        }, ct.prototype.delete = function(Ot) {
          var mt = ke(Ot, !1);
          return mt !== void 0 ? delete mt[this._key] : !1;
        }, ct.prototype.clear = function() {
          this._key = Ce();
        }, ct;
      }();
      function Ce() {
        var ct;
        do
          ct = "@@WeakMap@@" + lt();
        while (f.has(pe, ct));
        return pe[ct] = !0, ct;
      }
      function ke(ct, Ot) {
        if (!e.call(ct, se)) {
          if (!Ot)
            return;
          Object.defineProperty(ct, se, { value: f.create() });
        }
        return ct[se];
      }
      function at(ct, Ot) {
        for (var mt = 0; mt < Ot; ++mt)
          ct[mt] = Math.random() * 255 | 0;
        return ct;
      }
      function je(ct) {
        return typeof Uint8Array == "function" ? typeof crypto < "u" ? crypto.getRandomValues(new Uint8Array(ct)) : typeof msCrypto < "u" ? msCrypto.getRandomValues(new Uint8Array(ct)) : at(new Uint8Array(ct), ct) : at(new Array(ct), ct);
      }
      function lt() {
        var ct = je(Z);
        ct[6] = ct[6] & 79 | 64, ct[8] = ct[8] & 191 | 128;
        for (var Ot = "", mt = 0; mt < Z; ++mt) {
          var pr = ct[mt];
          (mt === 4 || mt === 6 || mt === 8) && (Ot += "-"), pr < 16 && (Ot += "0"), Ot += pr.toString(16).toLowerCase();
        }
        return Ot;
      }
    }
    function N(Z) {
      return Z.__ = void 0, delete Z.__, Z;
    }
  });
})(qM || (qM = {}));
var KB = { exports: {} }, qB = { exports: {} };
(function(r) {
  function t(e) {
    return r.exports = t = typeof Symbol == "function" && typeof Symbol.iterator == "symbol" ? function(n) {
      return typeof n;
    } : function(n) {
      return n && typeof Symbol == "function" && n.constructor === Symbol && n !== Symbol.prototype ? "symbol" : typeof n;
    }, r.exports.__esModule = !0, r.exports.default = r.exports, t(e);
  }
  r.exports = t, r.exports.__esModule = !0, r.exports.default = r.exports;
})(qB);
(function(r) {
  var t = qB.exports.default;
  function e() {
    r.exports = e = function() {
      return n;
    }, r.exports.__esModule = !0, r.exports.default = r.exports;
    var n = {}, i = Object.prototype, a = i.hasOwnProperty, o = Object.defineProperty || function(L, O, D) {
      L[O] = D.value;
    }, s = typeof Symbol == "function" ? Symbol : {}, u = s.iterator || "@@iterator", f = s.asyncIterator || "@@asyncIterator", l = s.toStringTag || "@@toStringTag";
    function c(L, O, D) {
      return Object.defineProperty(L, O, {
        value: D,
        enumerable: !0,
        configurable: !0,
        writable: !0
      }), L[O];
    }
    try {
      c({}, "");
    } catch {
      c = function(D, G, R) {
        return D[G] = R;
      };
    }
    function h(L, O, D, G) {
      var R = O && O.prototype instanceof p ? O : p, F = Object.create(R.prototype), q = new T(G || []);
      return o(F, "_invoke", {
        value: M(L, D, q)
      }), F;
    }
    function d(L, O, D) {
      try {
        return {
          type: "normal",
          arg: L.call(O, D)
        };
      } catch (G) {
        return {
          type: "throw",
          arg: G
        };
      }
    }
    n.wrap = h;
    var v = {};
    function p() {
    }
    function g() {
    }
    function y() {
    }
    var b = {};
    c(b, u, function() {
      return this;
    });
    var m = Object.getPrototypeOf, x = m && m(m(P([])));
    x && x !== i && a.call(x, u) && (b = x);
    var _ = y.prototype = p.prototype = Object.create(b);
    function w(L) {
      ["next", "throw", "return"].forEach(function(O) {
        c(L, O, function(D) {
          return this._invoke(O, D);
        });
      });
    }
    function E(L, O) {
      function D(R, F, q, ne) {
        var oe = d(L[R], L, F);
        if (oe.type !== "throw") {
          var ie = oe.arg, Ee = ie.value;
          return Ee && t(Ee) == "object" && a.call(Ee, "__await") ? O.resolve(Ee.__await).then(function(Xe) {
            D("next", Xe, q, ne);
          }, function(Xe) {
            D("throw", Xe, q, ne);
          }) : O.resolve(Ee).then(function(Xe) {
            ie.value = Xe, q(ie);
          }, function(Xe) {
            return D("throw", Xe, q, ne);
          });
        }
        ne(oe.arg);
      }
      var G;
      o(this, "_invoke", {
        value: function(F, q) {
          function ne() {
            return new O(function(oe, ie) {
              D(F, q, oe, ie);
            });
          }
          return G = G ? G.then(ne, ne) : ne();
        }
      });
    }
    function M(L, O, D) {
      var G = "suspendedStart";
      return function(R, F) {
        if (G === "executing")
          throw new Error("Generator is already running");
        if (G === "completed") {
          if (R === "throw")
            throw F;
          return k();
        }
        for (D.method = R, D.arg = F; ; ) {
          var q = D.delegate;
          if (q) {
            var ne = C(q, D);
            if (ne) {
              if (ne === v)
                continue;
              return ne;
            }
          }
          if (D.method === "next")
            D.sent = D._sent = D.arg;
          else if (D.method === "throw") {
            if (G === "suspendedStart")
              throw G = "completed", D.arg;
            D.dispatchException(D.arg);
          } else
            D.method === "return" && D.abrupt("return", D.arg);
          G = "executing";
          var oe = d(L, O, D);
          if (oe.type === "normal") {
            if (G = D.done ? "completed" : "suspendedYield", oe.arg === v)
              continue;
            return {
              value: oe.arg,
              done: D.done
            };
          }
          oe.type === "throw" && (G = "completed", D.method = "throw", D.arg = oe.arg);
        }
      };
    }
    function C(L, O) {
      var D = L.iterator[O.method];
      if (D === void 0) {
        if (O.delegate = null, O.method === "throw") {
          if (L.iterator.return && (O.method = "return", O.arg = void 0, C(L, O), O.method === "throw"))
            return v;
          O.method = "throw", O.arg = new TypeError("The iterator does not provide a 'throw' method");
        }
        return v;
      }
      var G = d(D, L.iterator, O.arg);
      if (G.type === "throw")
        return O.method = "throw", O.arg = G.arg, O.delegate = null, v;
      var R = G.arg;
      return R ? R.done ? (O[L.resultName] = R.value, O.next = L.nextLoc, O.method !== "return" && (O.method = "next", O.arg = void 0), O.delegate = null, v) : R : (O.method = "throw", O.arg = new TypeError("iterator result is not an object"), O.delegate = null, v);
    }
    function S(L) {
      var O = {
        tryLoc: L[0]
      };
      1 in L && (O.catchLoc = L[1]), 2 in L && (O.finallyLoc = L[2], O.afterLoc = L[3]), this.tryEntries.push(O);
    }
    function A(L) {
      var O = L.completion || {};
      O.type = "normal", delete O.arg, L.completion = O;
    }
    function T(L) {
      this.tryEntries = [{
        tryLoc: "root"
      }], L.forEach(S, this), this.reset(!0);
    }
    function P(L) {
      if (L) {
        var O = L[u];
        if (O)
          return O.call(L);
        if (typeof L.next == "function")
          return L;
        if (!isNaN(L.length)) {
          var D = -1, G = function R() {
            for (; ++D < L.length; )
              if (a.call(L, D))
                return R.value = L[D], R.done = !1, R;
            return R.value = void 0, R.done = !0, R;
          };
          return G.next = G;
        }
      }
      return {
        next: k
      };
    }
    function k() {
      return {
        value: void 0,
        done: !0
      };
    }
    return g.prototype = y, o(_, "constructor", {
      value: y,
      configurable: !0
    }), o(y, "constructor", {
      value: g,
      configurable: !0
    }), g.displayName = c(y, l, "GeneratorFunction"), n.isGeneratorFunction = function(L) {
      var O = typeof L == "function" && L.constructor;
      return !!O && (O === g || (O.displayName || O.name) === "GeneratorFunction");
    }, n.mark = function(L) {
      return Object.setPrototypeOf ? Object.setPrototypeOf(L, y) : (L.__proto__ = y, c(L, l, "GeneratorFunction")), L.prototype = Object.create(_), L;
    }, n.awrap = function(L) {
      return {
        __await: L
      };
    }, w(E.prototype), c(E.prototype, f, function() {
      return this;
    }), n.AsyncIterator = E, n.async = function(L, O, D, G, R) {
      R === void 0 && (R = Promise);
      var F = new E(h(L, O, D, G), R);
      return n.isGeneratorFunction(O) ? F : F.next().then(function(q) {
        return q.done ? q.value : F.next();
      });
    }, w(_), c(_, l, "Generator"), c(_, u, function() {
      return this;
    }), c(_, "toString", function() {
      return "[object Generator]";
    }), n.keys = function(L) {
      var O = Object(L), D = [];
      for (var G in O)
        D.push(G);
      return D.reverse(), function R() {
        for (; D.length; ) {
          var F = D.pop();
          if (F in O)
            return R.value = F, R.done = !1, R;
        }
        return R.done = !0, R;
      };
    }, n.values = P, T.prototype = {
      constructor: T,
      reset: function(O) {
        if (this.prev = 0, this.next = 0, this.sent = this._sent = void 0, this.done = !1, this.delegate = null, this.method = "next", this.arg = void 0, this.tryEntries.forEach(A), !O)
          for (var D in this)
            D.charAt(0) === "t" && a.call(this, D) && !isNaN(+D.slice(1)) && (this[D] = void 0);
      },
      stop: function() {
        this.done = !0;
        var O = this.tryEntries[0].completion;
        if (O.type === "throw")
          throw O.arg;
        return this.rval;
      },
      dispatchException: function(O) {
        if (this.done)
          throw O;
        var D = this;
        function G(ie, Ee) {
          return q.type = "throw", q.arg = O, D.next = ie, Ee && (D.method = "next", D.arg = void 0), !!Ee;
        }
        for (var R = this.tryEntries.length - 1; R >= 0; --R) {
          var F = this.tryEntries[R], q = F.completion;
          if (F.tryLoc === "root")
            return G("end");
          if (F.tryLoc <= this.prev) {
            var ne = a.call(F, "catchLoc"), oe = a.call(F, "finallyLoc");
            if (ne && oe) {
              if (this.prev < F.catchLoc)
                return G(F.catchLoc, !0);
              if (this.prev < F.finallyLoc)
                return G(F.finallyLoc);
            } else if (ne) {
              if (this.prev < F.catchLoc)
                return G(F.catchLoc, !0);
            } else {
              if (!oe)
                throw new Error("try statement without catch or finally");
              if (this.prev < F.finallyLoc)
                return G(F.finallyLoc);
            }
          }
        }
      },
      abrupt: function(O, D) {
        for (var G = this.tryEntries.length - 1; G >= 0; --G) {
          var R = this.tryEntries[G];
          if (R.tryLoc <= this.prev && a.call(R, "finallyLoc") && this.prev < R.finallyLoc) {
            var F = R;
            break;
          }
        }
        F && (O === "break" || O === "continue") && F.tryLoc <= D && D <= F.finallyLoc && (F = null);
        var q = F ? F.completion : {};
        return q.type = O, q.arg = D, F ? (this.method = "next", this.next = F.finallyLoc, v) : this.complete(q);
      },
      complete: function(O, D) {
        if (O.type === "throw")
          throw O.arg;
        return O.type === "break" || O.type === "continue" ? this.next = O.arg : O.type === "return" ? (this.rval = this.arg = O.arg, this.method = "return", this.next = "end") : O.type === "normal" && D && (this.next = D), v;
      },
      finish: function(O) {
        for (var D = this.tryEntries.length - 1; D >= 0; --D) {
          var G = this.tryEntries[D];
          if (G.finallyLoc === O)
            return this.complete(G.completion, G.afterLoc), A(G), v;
        }
      },
      catch: function(O) {
        for (var D = this.tryEntries.length - 1; D >= 0; --D) {
          var G = this.tryEntries[D];
          if (G.tryLoc === O) {
            var R = G.completion;
            if (R.type === "throw") {
              var F = R.arg;
              A(G);
            }
            return F;
          }
        }
        throw new Error("illegal catch attempt");
      },
      delegateYield: function(O, D, G) {
        return this.delegate = {
          iterator: P(O),
          resultName: D,
          nextLoc: G
        }, this.method === "next" && (this.arg = void 0), v;
      }
    }, n;
  }
  r.exports = e, r.exports.__esModule = !0, r.exports.default = r.exports;
})(KB);
var Pv = KB.exports(), St = Pv;
try {
  regeneratorRuntime = Pv;
} catch {
  typeof globalThis == "object" ? globalThis.regeneratorRuntime = Pv : Function("r", "regeneratorRuntime = r")(Pv);
}
function ZM(r, t, e, n, i, a, o) {
  try {
    var s = r[a](o), u = s.value;
  } catch (f) {
    e(f);
    return;
  }
  s.done ? t(u) : Promise.resolve(u).then(n, i);
}
function Er(r) {
  return function() {
    var t = this, e = arguments;
    return new Promise(function(n, i) {
      var a = r.apply(t, e);
      function o(u) {
        ZM(a, n, i, o, s, "next", u);
      }
      function s(u) {
        ZM(a, n, i, o, s, "throw", u);
      }
      o(void 0);
    });
  };
}
var fue = -1, lue = 1;
function Na() {
  return lue++;
}
var Du = function r(t) {
  Pt(this, r);
}, ku = /* @__PURE__ */ function() {
  function r(t) {
    Pt(this, r), this.clazz = void 0, this.components = [], this.entities = [], this.lookup = {}, this.clazz = t;
  }
  return Wt(r, [{
    key: "clear",
    value: function() {
      this.components = [], this.entities = [], this.lookup = {};
    }
  }, {
    key: "contains",
    value: function(e) {
      return this.lookup[e] > -1;
    }
  }, {
    key: "create",
    value: function(e, n) {
      this.lookup[e] = this.components.length;
      var i = new this.clazz(n || {});
      return this.components.push(i), this.entities.push(e), i;
    }
  }, {
    key: "remove",
    value: function(e) {
      var n = this.lookup[e];
      n > -1 && n < this.components.length - 1 && (this.components[n] = this.components[this.components.length - 1], this.entities[n] = this.entities[this.entities.length - 1], this.lookup[this.entities[n]] = n), this.components.pop(), this.entities.pop(), delete this.lookup[e];
    }
  }, {
    key: "removeKeepSorted",
    value: function(e) {
      var n = this.lookup[e];
      if (n > -1) {
        var i = this.entities[n];
        if (n < this.components.length - 1) {
          for (var a = n + 1; a < this.components.length; ++a)
            this.components[a - 1] = this.components[a];
          for (var o = n + 1; o < this.entities.length; ++o)
            this.entities[o - 1] = this.entities[o], this.lookup[this.entities[o - 1]] = o - 1;
        }
        this.components.pop(), this.entities.pop(), delete this.lookup[i];
      }
    }
  }, {
    key: "moveItem",
    value: function(e, n) {
      if (e !== n) {
        for (var i = this.components[e], a = this.entities[e], o = e < n ? 1 : -1, s = e; s !== n; s += o) {
          var u = s + o;
          this.components[s] = this.components[u], this.entities[s] = this.entities[u], this.lookup[this.entities[s]] = s;
        }
        this.components[n] = i, this.entities[n] = a, this.lookup[a] = n;
      }
    }
  }, {
    key: "getEntity",
    value: function(e) {
      return this.entities[e];
    }
  }, {
    key: "getComponent",
    value: function(e) {
      return this.components[e];
    }
  }, {
    key: "getComponentByEntity",
    value: function(e) {
      var n = this.lookup[e];
      return n > -1 ? this.components[n] : null;
    }
  }, {
    key: "getCount",
    value: function() {
      return this.components.length;
    }
  }, {
    key: "getEntityByComponentIndex",
    value: function(e) {
      for (var n = 0, i = Object.keys(this.lookup); n < i.length; n++) {
        var a = i[n], o = Number(a);
        if (this.lookup[o] === e)
          return o;
      }
      return fue;
    }
  }, {
    key: "find",
    value: function(e) {
      for (var n = 0; n < this.getCount(); n++) {
        var i = this.getComponent(n);
        if (e(i, n))
          return i;
      }
      return null;
    }
  }, {
    key: "findIndex",
    value: function(e) {
      for (var n = 0; n < this.getCount(); n++) {
        var i = this.getComponent(n);
        if (e(i, n))
          return n;
      }
      return -1;
    }
  }, {
    key: "forEach",
    value: function(e) {
      for (var n = 0, i = Object.keys(this.lookup); n < i.length; n++) {
        var a = i[n], o = Number(a), s = this.lookup[o];
        e(o, this.getComponent(s));
      }
    }
  }, {
    key: "forEachAsync",
    value: function() {
      var t = Er(/* @__PURE__ */ St.mark(function n(i) {
        var a, o, s, u, f;
        return St.wrap(function(c) {
          for (; ; )
            switch (c.prev = c.next) {
              case 0:
                a = 0, o = Object.keys(this.lookup);
              case 1:
                if (!(a < o.length)) {
                  c.next = 10;
                  break;
                }
                return s = o[a], u = Number(s), f = this.lookup[u], c.next = 7, i(u, this.getComponent(f));
              case 7:
                a++, c.next = 1;
                break;
              case 10:
              case "end":
                return c.stop();
            }
        }, n, this);
      }));
      function e(n) {
        return t.apply(this, arguments);
      }
      return e;
    }()
  }, {
    key: "map",
    value: function(e) {
      for (var n = [], i = 0, a = Object.keys(this.lookup); i < a.length; i++) {
        var o = a[i], s = Number(o), u = this.lookup[s];
        n.push(e(s, this.getComponent(u)));
      }
      return n;
    }
  }]), r;
}();
function cue(r) {
  if (Array.isArray(r))
    return r;
}
function hue(r, t) {
  var e = r == null ? null : typeof Symbol < "u" && r[Symbol.iterator] || r["@@iterator"];
  if (e != null) {
    var n = [], i = !0, a = !1, o, s;
    try {
      for (e = e.call(r); !(i = (o = e.next()).done) && (n.push(o.value), !(t && n.length === t)); i = !0)
        ;
    } catch (u) {
      a = !0, s = u;
    } finally {
      try {
        !i && e.return != null && e.return();
      } finally {
        if (a)
          throw s;
      }
    }
    return n;
  }
}
function d1(r, t) {
  (t == null || t > r.length) && (t = r.length);
  for (var e = 0, n = new Array(t); e < t; e++)
    n[e] = r[e];
  return n;
}
function ZB(r, t) {
  if (!!r) {
    if (typeof r == "string")
      return d1(r, t);
    var e = Object.prototype.toString.call(r).slice(8, -1);
    if (e === "Object" && r.constructor && (e = r.constructor.name), e === "Map" || e === "Set")
      return Array.from(r);
    if (e === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))
      return d1(r, t);
  }
}
function due() {
  throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`);
}
function xg(r, t) {
  return cue(r) || hue(r, t) || ZB(r, t) || due();
}
var ra = "named", QB = "name", $x = "unmanaged", JB = "optional", _g = "inject", Yc = "multi_inject", e5 = "inversify:tagged", t5 = "inversify:tagged_props", v1 = "inversify:paramtypes", vue = "design:paramtypes", QM = "post_construct";
function pue() {
  return [
    _g,
    Yc,
    QB,
    $x,
    ra,
    JB
  ];
}
var JM = pue(), $n = {
  Request: "Request",
  Singleton: "Singleton",
  Transient: "Transient"
}, Un = {
  ConstantValue: "ConstantValue",
  Constructor: "Constructor",
  DynamicValue: "DynamicValue",
  Factory: "Factory",
  Function: "Function",
  Instance: "Instance",
  Invalid: "Invalid",
  Provider: "Provider"
}, mo = {
  ClassProperty: "ClassProperty",
  ConstructorArgument: "ConstructorArgument",
  Variable: "Variable"
}, gue = 0;
function wh() {
  return gue++;
}
var yue = function() {
  function r(t, e) {
    this.id = wh(), this.activated = !1, this.serviceIdentifier = t, this.scope = e, this.type = Un.Invalid, this.constraint = function(n) {
      return !0;
    }, this.implementationType = null, this.cache = null, this.factory = null, this.provider = null, this.onActivation = null, this.dynamicValue = null;
  }
  return r.prototype.clone = function() {
    var t = new r(this.serviceIdentifier, this.scope);
    return t.activated = t.scope === $n.Singleton ? this.activated : !1, t.implementationType = this.implementationType, t.dynamicValue = this.dynamicValue, t.scope = this.scope, t.type = this.type, t.factory = this.factory, t.provider = this.provider, t.constraint = this.constraint, t.onActivation = this.onActivation, t.cache = this.cache, t;
  }, r;
}(), mue = "Cannot apply @injectable decorator multiple times.", bue = "Metadata key was used more than once in a parameter:", Nl = "NULL argument", eC = "Key Not Found", xue = "Ambiguous match found for serviceIdentifier:", _ue = "Could not unbind serviceIdentifier:", wue = "No matching bindings found for serviceIdentifier:", Eue = "Missing required @injectable annotation in:", Sue = "Missing required @inject or @multiInject annotation in:", Mue = function(r) {
  return "@inject called with undefined this could mean that the class " + r + " has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation.";
}, Cue = "Circular dependency found:", Tue = "Invalid binding type:", Aue = "No snapshot available to restore.", Iue = "Invalid return type in middleware. Middleware must return!", Pue = "Value provided to function binding must be a function!", Oue = "The toSelf function can only be applied when a constructor is used as service identifier", Due = "The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.", kue = function() {
  for (var r = [], t = 0; t < arguments.length; t++)
    r[t] = arguments[t];
  return "The number of constructor arguments in the derived class " + (r[0] + " must be >= than the number of constructor arguments of its base class.");
}, Lue = "Invalid Container constructor argument. Container options must be an object.", Nue = "Invalid Container option. Default scope must be a string ('singleton' or 'transient').", Rue = "Invalid Container option. Auto bind injectable must be a boolean", Bue = "Invalid Container option. Skip base check must be a boolean", Gue = function() {
  for (var r = [], t = 0; t < arguments.length; t++)
    r[t] = arguments[t];
  return "@postConstruct error in class " + r[0] + ": " + r[1];
}, Fue = function() {
  for (var r = [], t = 0; t < arguments.length; t++)
    r[t] = arguments[t];
  return "It looks like there is a circular dependency " + ("in one of the '" + r[0] + "' bindings. Please investigate bindings with") + ("service identifier '" + r[1] + "'.");
}, zue = "Maximum call stack size exceeded", Uue = function() {
  function r() {
  }
  return r.prototype.getConstructorMetadata = function(t) {
    var e = Reflect.getMetadata(v1, t), n = Reflect.getMetadata(e5, t);
    return {
      compilerGeneratedMetadata: e,
      userGeneratedMetadata: n || {}
    };
  }, r.prototype.getPropertiesMetadata = function(t) {
    var e = Reflect.getMetadata(t5, t) || [];
    return e;
  }, r;
}(), Ov = {
  MultipleBindingsAvailable: 2,
  NoBindingsAvailable: 0,
  OnlyOneBindingAvailable: 1
};
function r5(r) {
  return r instanceof RangeError || r.message === zue;
}
function Hc(r) {
  if (typeof r == "function") {
    var t = r;
    return t.name;
  } else {
    if (typeof r == "symbol")
      return r.toString();
    var t = r;
    return t;
  }
}
function tC(r, t, e) {
  var n = "", i = e(r, t);
  return i.length !== 0 && (n = `
Registered bindings:`, i.forEach(function(a) {
    var o = "Object";
    a.implementationType !== null && (o = wg(a.implementationType)), n = n + `
 ` + o, a.constraint.metaData && (n = n + " - " + a.constraint.metaData);
  })), n;
}
function n5(r, t) {
  return r.parentRequest === null ? !1 : r.parentRequest.serviceIdentifier === t ? !0 : n5(r.parentRequest, t);
}
function jue(r) {
  function t(n, i) {
    i === void 0 && (i = []);
    var a = Hc(n.serviceIdentifier);
    return i.push(a), n.parentRequest !== null ? t(n.parentRequest, i) : i;
  }
  var e = t(r);
  return e.reverse().join(" --> ");
}
function i5(r) {
  r.childRequests.forEach(function(t) {
    if (n5(t, t.serviceIdentifier)) {
      var e = jue(t);
      throw new Error(Cue + " " + e);
    } else
      i5(t);
  });
}
function $ue(r, t) {
  if (t.isTagged() || t.isNamed()) {
    var e = "", n = t.getNamedTag(), i = t.getCustomTags();
    return n !== null && (e += n.toString() + `
`), i !== null && i.forEach(function(a) {
      e += a.toString() + `
`;
    }), " " + r + `
 ` + r + " - " + e;
  } else
    return " " + r;
}
function wg(r) {
  if (r.name)
    return r.name;
  var t = r.toString(), e = t.match(/^function\s*([^\s(]+)/);
  return e ? e[1] : "Anonymous function: " + t;
}
var a5 = function() {
  function r(t) {
    this.id = wh(), this.container = t;
  }
  return r.prototype.addPlan = function(t) {
    this.plan = t;
  }, r.prototype.setCurrentRequest = function(t) {
    this.currentRequest = t;
  }, r;
}(), ys = function() {
  function r(t, e) {
    this.key = t, this.value = e;
  }
  return r.prototype.toString = function() {
    return this.key === ra ? "named: " + this.value.toString() + " " : "tagged: { key:" + this.key.toString() + ", value: " + this.value + " }";
  }, r;
}(), Wue = function() {
  function r(t, e) {
    this.parentContext = t, this.rootRequest = e;
  }
  return r;
}();
function o5(r, t, e, n) {
  var i = e5;
  u5(i, r, t, n, e);
}
function s5(r, t, e) {
  var n = t5;
  u5(n, r.constructor, t, e);
}
function u5(r, t, e, n, i) {
  var a = {}, o = typeof i == "number", s = i !== void 0 && o ? i.toString() : e;
  if (o && e !== void 0)
    throw new Error(Due);
  Reflect.hasOwnMetadata(r, t) && (a = Reflect.getMetadata(r, t));
  var u = a[s];
  if (!Array.isArray(u))
    u = [];
  else
    for (var f = 0, l = u; f < l.length; f++) {
      var c = l[f];
      if (c.key === n.key)
        throw new Error(bue + " " + c.key.toString());
    }
  u.push(n), a[s] = u, Reflect.defineMetadata(r, a, t);
}
var Vue = function() {
  function r(t) {
    this._cb = t;
  }
  return r.prototype.unwrap = function() {
    return this._cb();
  }, r;
}();
function Ut(r) {
  return function(t, e, n) {
    if (r === void 0)
      throw new Error(Mue(t.name));
    var i = new ys(_g, r);
    typeof n == "number" ? o5(t, e, n, i) : s5(t, e, i);
  };
}
var Xue = function() {
  function r(t) {
    this.str = t;
  }
  return r.prototype.startsWith = function(t) {
    return this.str.indexOf(t) === 0;
  }, r.prototype.endsWith = function(t) {
    var e = "", n = t.split("").reverse().join("");
    return e = this.str.split("").reverse().join(""), this.startsWith.call({ str: e }, n);
  }, r.prototype.contains = function(t) {
    return this.str.indexOf(t) !== -1;
  }, r.prototype.equals = function(t) {
    return this.str === t;
  }, r.prototype.value = function() {
    return this.str;
  }, r;
}(), Eg = function() {
  function r(t, e, n, i) {
    this.id = wh(), this.type = t, this.serviceIdentifier = n, this.name = new Xue(e || ""), this.metadata = new Array();
    var a = null;
    typeof i == "string" ? a = new ys(ra, i) : i instanceof ys && (a = i), a !== null && this.metadata.push(a);
  }
  return r.prototype.hasTag = function(t) {
    for (var e = 0, n = this.metadata; e < n.length; e++) {
      var i = n[e];
      if (i.key === t)
        return !0;
    }
    return !1;
  }, r.prototype.isArray = function() {
    return this.hasTag(Yc);
  }, r.prototype.matchesArray = function(t) {
    return this.matchesTag(Yc)(t);
  }, r.prototype.isNamed = function() {
    return this.hasTag(ra);
  }, r.prototype.isTagged = function() {
    return this.metadata.some(function(t) {
      return JM.every(function(e) {
        return t.key !== e;
      });
    });
  }, r.prototype.isOptional = function() {
    return this.matchesTag(JB)(!0);
  }, r.prototype.getNamedTag = function() {
    return this.isNamed() ? this.metadata.filter(function(t) {
      return t.key === ra;
    })[0] : null;
  }, r.prototype.getCustomTags = function() {
    return this.isTagged() ? this.metadata.filter(function(t) {
      return JM.every(function(e) {
        return t.key !== e;
      });
    }) : null;
  }, r.prototype.matchesNamedTag = function(t) {
    return this.matchesTag(ra)(t);
  }, r.prototype.matchesTag = function(t) {
    var e = this;
    return function(n) {
      for (var i = 0, a = e.metadata; i < a.length; i++) {
        var o = a[i];
        if (o.key === t && o.value === n)
          return !0;
      }
      return !1;
    };
  }, r;
}(), yp = globalThis && globalThis.__spreadArray || function(r, t) {
  for (var e = 0, n = t.length, i = r.length; e < n; e++, i++)
    r[i] = t[e];
  return r;
};
function Yue(r, t) {
  var e = wg(t), n = f5(r, e, t, !1);
  return n;
}
function f5(r, t, e, n) {
  var i = r.getConstructorMetadata(e), a = i.compilerGeneratedMetadata;
  if (a === void 0) {
    var o = Eue + " " + t + ".";
    throw new Error(o);
  }
  var s = i.userGeneratedMetadata, u = Object.keys(s), f = e.length === 0 && u.length > 0, l = u.length > e.length, c = f || l ? u.length : e.length, h = Kue(n, t, a, s, c), d = l5(r, e), v = yp(yp([], h), d);
  return v;
}
function Hue(r, t, e, n, i) {
  var a = i[r.toString()] || [], o = h5(a), s = o.unmanaged !== !0, u = n[r], f = o.inject || o.multiInject;
  if (u = f || u, u instanceof Vue && (u = u.unwrap()), s) {
    var l = u === Object, c = u === Function, h = u === void 0, d = l || c || h;
    if (!t && d) {
      var v = Sue + " argument " + r + " in class " + e + ".";
      throw new Error(v);
    }
    var p = new Eg(mo.ConstructorArgument, o.targetName, u);
    return p.metadata = a, p;
  }
  return null;
}
function Kue(r, t, e, n, i) {
  for (var a = [], o = 0; o < i; o++) {
    var s = o, u = Hue(s, r, t, e, n);
    u !== null && a.push(u);
  }
  return a;
}
function l5(r, t) {
  for (var e = r.getPropertiesMetadata(t), n = [], i = Object.keys(e), a = 0, o = i; a < o.length; a++) {
    var s = o[a], u = e[s], f = h5(e[s]), l = f.targetName || s, c = f.inject || f.multiInject, h = new Eg(mo.ClassProperty, l, c);
    h.metadata = u, n.push(h);
  }
  var d = Object.getPrototypeOf(t.prototype).constructor;
  if (d !== Object) {
    var v = l5(r, d);
    n = yp(yp([], n), v);
  }
  return n;
}
function c5(r, t) {
  var e = Object.getPrototypeOf(t.prototype).constructor;
  if (e !== Object) {
    var n = wg(e), i = f5(r, n, e, !0), a = i.map(function(u) {
      return u.metadata.filter(function(f) {
        return f.key === $x;
      });
    }), o = [].concat.apply([], a).length, s = i.length - o;
    return s > 0 ? s : c5(r, e);
  } else
    return 0;
}
function h5(r) {
  var t = {};
  return r.forEach(function(e) {
    t[e.key.toString()] = e.value;
  }), {
    inject: t[_g],
    multiInject: t[Yc],
    targetName: t[QB],
    unmanaged: t[$x]
  };
}
var Wx = function() {
  function r(t, e, n, i, a) {
    this.id = wh(), this.serviceIdentifier = t, this.parentContext = e, this.parentRequest = n, this.target = a, this.childRequests = [], this.bindings = Array.isArray(i) ? i : [i], this.requestScope = n === null ? /* @__PURE__ */ new Map() : null;
  }
  return r.prototype.addChildRequest = function(t, e, n) {
    var i = new r(t, this.parentContext, this, e, n);
    return this.childRequests.push(i), i;
  }, r;
}();
function p1(r) {
  return r._bindingDictionary;
}
function que(r, t, e, n, i, a) {
  var o = r ? Yc : _g, s = new ys(o, e), u = new Eg(t, n, e, s);
  if (i !== void 0) {
    var f = new ys(i, a);
    u.metadata.push(f);
  }
  return u;
}
function rC(r, t, e, n, i) {
  var a = Kc(e.container, i.serviceIdentifier), o = [];
  return a.length === Ov.NoBindingsAvailable && e.container.options.autoBindInjectable && typeof i.serviceIdentifier == "function" && r.getConstructorMetadata(i.serviceIdentifier).compilerGeneratedMetadata && (e.container.bind(i.serviceIdentifier).toSelf(), a = Kc(e.container, i.serviceIdentifier)), t ? o = a : o = a.filter(function(s) {
    var u = new Wx(s.serviceIdentifier, e, n, s, i);
    return s.constraint(u);
  }), Zue(i.serviceIdentifier, o, i, e.container), o;
}
function Zue(r, t, e, n) {
  switch (t.length) {
    case Ov.NoBindingsAvailable:
      if (e.isOptional())
        return t;
      var i = Hc(r), a = wue;
      throw a += $ue(i, e), a += tC(n, i, Kc), new Error(a);
    case Ov.OnlyOneBindingAvailable:
      if (!e.isArray())
        return t;
    case Ov.MultipleBindingsAvailable:
    default:
      if (e.isArray())
        return t;
      var i = Hc(r), a = xue + " " + i;
      throw a += tC(n, i, Kc), new Error(a);
  }
}
function d5(r, t, e, n, i, a) {
  var o, s;
  if (i === null) {
    o = rC(r, t, n, null, a), s = new Wx(e, n, null, o, a);
    var u = new Wue(n, s);
    n.addPlan(u);
  } else
    o = rC(r, t, n, i, a), s = i.addChildRequest(a.serviceIdentifier, o, a);
  o.forEach(function(f) {
    var l = null;
    if (a.isArray())
      l = s.addChildRequest(f.serviceIdentifier, f, a);
    else {
      if (f.cache)
        return;
      l = s;
    }
    if (f.type === Un.Instance && f.implementationType !== null) {
      var c = Yue(r, f.implementationType);
      if (!n.container.options.skipBaseClassChecks) {
        var h = c5(r, f.implementationType);
        if (c.length < h) {
          var d = kue(wg(f.implementationType));
          throw new Error(d);
        }
      }
      c.forEach(function(v) {
        d5(r, !1, v.serviceIdentifier, n, l, v);
      });
    }
  });
}
function Kc(r, t) {
  var e = [], n = p1(r);
  return n.hasKey(t) ? e = n.get(t) : r.parent !== null && (e = Kc(r.parent, t)), e;
}
function Que(r, t, e, n, i, a, o, s) {
  s === void 0 && (s = !1);
  var u = new a5(t), f = que(e, n, i, "", a, o);
  try {
    return d5(r, s, i, u, null, f), u;
  } catch (l) {
    throw r5(l) && u.plan && i5(u.plan.rootRequest), l;
  }
}
function Jue(r, t, e, n) {
  var i = new Eg(mo.Variable, "", t, new ys(e, n)), a = new a5(r), o = new Wx(t, a, null, [], i);
  return o;
}
var efe = globalThis && globalThis.__spreadArray || function(r, t) {
  for (var e = 0, n = t.length, i = r.length; e < n; e++, i++)
    r[i] = t[e];
  return r;
};
function tfe(r, t, e) {
  var n = t.filter(function(a) {
    return a.target !== null && a.target.type === mo.ClassProperty;
  }), i = n.map(e);
  return n.forEach(function(a, o) {
    var s = "";
    s = a.target.name.value();
    var u = i[o];
    r[s] = u;
  }), r;
}
function rfe(r, t) {
  return new (r.bind.apply(r, efe([void 0], t)))();
}
function nfe(r, t) {
  if (Reflect.hasMetadata(QM, r)) {
    var e = Reflect.getMetadata(QM, r);
    try {
      t[e.value]();
    } catch (n) {
      throw new Error(Gue(r.name, n.message));
    }
  }
}
function ife(r, t, e) {
  var n = null;
  if (t.length > 0) {
    var i = t.filter(function(o) {
      return o.target !== null && o.target.type === mo.ConstructorArgument;
    }), a = i.map(e);
    n = rfe(r, a), n = tfe(n, t, e);
  } else
    n = new r();
  return nfe(r, n), n;
}
var Cy = function(r, t, e) {
  try {
    return e();
  } catch (n) {
    throw r5(n) ? new Error(Fue(r, t.toString())) : n;
  }
}, g1 = function(r) {
  return function(t) {
    t.parentContext.setCurrentRequest(t);
    var e = t.bindings, n = t.childRequests, i = t.target && t.target.isArray(), a = !t.parentRequest || !t.parentRequest.target || !t.target || !t.parentRequest.target.matchesArray(t.target.serviceIdentifier);
    if (i && a)
      return n.map(function(c) {
        var h = g1(r);
        return h(c);
      });
    var o = null;
    if (t.target.isOptional() && e.length === 0)
      return;
    var s = e[0], u = s.scope === $n.Singleton, f = s.scope === $n.Request;
    if (u && s.activated)
      return s.cache;
    if (f && r !== null && r.has(s.id))
      return r.get(s.id);
    if (s.type === Un.ConstantValue)
      o = s.cache, s.activated = !0;
    else if (s.type === Un.Function)
      o = s.cache, s.activated = !0;
    else if (s.type === Un.Constructor)
      o = s.implementationType;
    else if (s.type === Un.DynamicValue && s.dynamicValue !== null)
      o = Cy("toDynamicValue", s.serviceIdentifier, function() {
        return s.dynamicValue(t.parentContext);
      });
    else if (s.type === Un.Factory && s.factory !== null)
      o = Cy("toFactory", s.serviceIdentifier, function() {
        return s.factory(t.parentContext);
      });
    else if (s.type === Un.Provider && s.provider !== null)
      o = Cy("toProvider", s.serviceIdentifier, function() {
        return s.provider(t.parentContext);
      });
    else if (s.type === Un.Instance && s.implementationType !== null)
      o = ife(s.implementationType, n, g1(r));
    else {
      var l = Hc(t.serviceIdentifier);
      throw new Error(Tue + " " + l);
    }
    return typeof s.onActivation == "function" && (o = s.onActivation(t.parentContext, o)), u && (s.cache = o, s.activated = !0), f && r !== null && !r.has(s.id) && r.set(s.id, o), o;
  };
};
function afe(r) {
  var t = g1(r.plan.rootRequest.requestScope);
  return t(r.plan.rootRequest);
}
var lo = function(r, t) {
  var e = r.parentRequest;
  return e !== null ? t(e) ? !0 : lo(e, t) : !1;
}, lc = function(r) {
  return function(t) {
    var e = function(n) {
      return n !== null && n.target !== null && n.target.matchesTag(r)(t);
    };
    return e.metaData = new ys(r, t), e;
  };
}, Bd = lc(ra), Ty = function(r) {
  return function(t) {
    var e = null;
    if (t !== null)
      if (e = t.bindings[0], typeof r == "string") {
        var n = e.serviceIdentifier;
        return n === r;
      } else {
        var i = t.bindings[0].implementationType;
        return r === i;
      }
    return !1;
  };
}, Vx = function() {
  function r(t) {
    this._binding = t;
  }
  return r.prototype.when = function(t) {
    return this._binding.constraint = t, new zn(this._binding);
  }, r.prototype.whenTargetNamed = function(t) {
    return this._binding.constraint = Bd(t), new zn(this._binding);
  }, r.prototype.whenTargetIsDefault = function() {
    return this._binding.constraint = function(t) {
      var e = t.target !== null && !t.target.isNamed() && !t.target.isTagged();
      return e;
    }, new zn(this._binding);
  }, r.prototype.whenTargetTagged = function(t, e) {
    return this._binding.constraint = lc(t)(e), new zn(this._binding);
  }, r.prototype.whenInjectedInto = function(t) {
    return this._binding.constraint = function(e) {
      return Ty(t)(e.parentRequest);
    }, new zn(this._binding);
  }, r.prototype.whenParentNamed = function(t) {
    return this._binding.constraint = function(e) {
      return Bd(t)(e.parentRequest);
    }, new zn(this._binding);
  }, r.prototype.whenParentTagged = function(t, e) {
    return this._binding.constraint = function(n) {
      return lc(t)(e)(n.parentRequest);
    }, new zn(this._binding);
  }, r.prototype.whenAnyAncestorIs = function(t) {
    return this._binding.constraint = function(e) {
      return lo(e, Ty(t));
    }, new zn(this._binding);
  }, r.prototype.whenNoAncestorIs = function(t) {
    return this._binding.constraint = function(e) {
      return !lo(e, Ty(t));
    }, new zn(this._binding);
  }, r.prototype.whenAnyAncestorNamed = function(t) {
    return this._binding.constraint = function(e) {
      return lo(e, Bd(t));
    }, new zn(this._binding);
  }, r.prototype.whenNoAncestorNamed = function(t) {
    return this._binding.constraint = function(e) {
      return !lo(e, Bd(t));
    }, new zn(this._binding);
  }, r.prototype.whenAnyAncestorTagged = function(t, e) {
    return this._binding.constraint = function(n) {
      return lo(n, lc(t)(e));
    }, new zn(this._binding);
  }, r.prototype.whenNoAncestorTagged = function(t, e) {
    return this._binding.constraint = function(n) {
      return !lo(n, lc(t)(e));
    }, new zn(this._binding);
  }, r.prototype.whenAnyAncestorMatches = function(t) {
    return this._binding.constraint = function(e) {
      return lo(e, t);
    }, new zn(this._binding);
  }, r.prototype.whenNoAncestorMatches = function(t) {
    return this._binding.constraint = function(e) {
      return !lo(e, t);
    }, new zn(this._binding);
  }, r;
}(), zn = function() {
  function r(t) {
    this._binding = t;
  }
  return r.prototype.onActivation = function(t) {
    return this._binding.onActivation = t, new Vx(this._binding);
  }, r;
}(), ns = function() {
  function r(t) {
    this._binding = t, this._bindingWhenSyntax = new Vx(this._binding), this._bindingOnSyntax = new zn(this._binding);
  }
  return r.prototype.when = function(t) {
    return this._bindingWhenSyntax.when(t);
  }, r.prototype.whenTargetNamed = function(t) {
    return this._bindingWhenSyntax.whenTargetNamed(t);
  }, r.prototype.whenTargetIsDefault = function() {
    return this._bindingWhenSyntax.whenTargetIsDefault();
  }, r.prototype.whenTargetTagged = function(t, e) {
    return this._bindingWhenSyntax.whenTargetTagged(t, e);
  }, r.prototype.whenInjectedInto = function(t) {
    return this._bindingWhenSyntax.whenInjectedInto(t);
  }, r.prototype.whenParentNamed = function(t) {
    return this._bindingWhenSyntax.whenParentNamed(t);
  }, r.prototype.whenParentTagged = function(t, e) {
    return this._bindingWhenSyntax.whenParentTagged(t, e);
  }, r.prototype.whenAnyAncestorIs = function(t) {
    return this._bindingWhenSyntax.whenAnyAncestorIs(t);
  }, r.prototype.whenNoAncestorIs = function(t) {
    return this._bindingWhenSyntax.whenNoAncestorIs(t);
  }, r.prototype.whenAnyAncestorNamed = function(t) {
    return this._bindingWhenSyntax.whenAnyAncestorNamed(t);
  }, r.prototype.whenAnyAncestorTagged = function(t, e) {
    return this._bindingWhenSyntax.whenAnyAncestorTagged(t, e);
  }, r.prototype.whenNoAncestorNamed = function(t) {
    return this._bindingWhenSyntax.whenNoAncestorNamed(t);
  }, r.prototype.whenNoAncestorTagged = function(t, e) {
    return this._bindingWhenSyntax.whenNoAncestorTagged(t, e);
  }, r.prototype.whenAnyAncestorMatches = function(t) {
    return this._bindingWhenSyntax.whenAnyAncestorMatches(t);
  }, r.prototype.whenNoAncestorMatches = function(t) {
    return this._bindingWhenSyntax.whenNoAncestorMatches(t);
  }, r.prototype.onActivation = function(t) {
    return this._bindingOnSyntax.onActivation(t);
  }, r;
}(), ofe = function() {
  function r(t) {
    this._binding = t;
  }
  return r.prototype.inRequestScope = function() {
    return this._binding.scope = $n.Request, new ns(this._binding);
  }, r.prototype.inSingletonScope = function() {
    return this._binding.scope = $n.Singleton, new ns(this._binding);
  }, r.prototype.inTransientScope = function() {
    return this._binding.scope = $n.Transient, new ns(this._binding);
  }, r;
}(), nC = function() {
  function r(t) {
    this._binding = t, this._bindingWhenSyntax = new Vx(this._binding), this._bindingOnSyntax = new zn(this._binding), this._bindingInSyntax = new ofe(t);
  }
  return r.prototype.inRequestScope = function() {
    return this._bindingInSyntax.inRequestScope();
  }, r.prototype.inSingletonScope = function() {
    return this._bindingInSyntax.inSingletonScope();
  }, r.prototype.inTransientScope = function() {
    return this._bindingInSyntax.inTransientScope();
  }, r.prototype.when = function(t) {
    return this._bindingWhenSyntax.when(t);
  }, r.prototype.whenTargetNamed = function(t) {
    return this._bindingWhenSyntax.whenTargetNamed(t);
  }, r.prototype.whenTargetIsDefault = function() {
    return this._bindingWhenSyntax.whenTargetIsDefault();
  }, r.prototype.whenTargetTagged = function(t, e) {
    return this._bindingWhenSyntax.whenTargetTagged(t, e);
  }, r.prototype.whenInjectedInto = function(t) {
    return this._bindingWhenSyntax.whenInjectedInto(t);
  }, r.prototype.whenParentNamed = function(t) {
    return this._bindingWhenSyntax.whenParentNamed(t);
  }, r.prototype.whenParentTagged = function(t, e) {
    return this._bindingWhenSyntax.whenParentTagged(t, e);
  }, r.prototype.whenAnyAncestorIs = function(t) {
    return this._bindingWhenSyntax.whenAnyAncestorIs(t);
  }, r.prototype.whenNoAncestorIs = function(t) {
    return this._bindingWhenSyntax.whenNoAncestorIs(t);
  }, r.prototype.whenAnyAncestorNamed = function(t) {
    return this._bindingWhenSyntax.whenAnyAncestorNamed(t);
  }, r.prototype.whenAnyAncestorTagged = function(t, e) {
    return this._bindingWhenSyntax.whenAnyAncestorTagged(t, e);
  }, r.prototype.whenNoAncestorNamed = function(t) {
    return this._bindingWhenSyntax.whenNoAncestorNamed(t);
  }, r.prototype.whenNoAncestorTagged = function(t, e) {
    return this._bindingWhenSyntax.whenNoAncestorTagged(t, e);
  }, r.prototype.whenAnyAncestorMatches = function(t) {
    return this._bindingWhenSyntax.whenAnyAncestorMatches(t);
  }, r.prototype.whenNoAncestorMatches = function(t) {
    return this._bindingWhenSyntax.whenNoAncestorMatches(t);
  }, r.prototype.onActivation = function(t) {
    return this._bindingOnSyntax.onActivation(t);
  }, r;
}(), sfe = function() {
  function r(t) {
    this._binding = t;
  }
  return r.prototype.to = function(t) {
    return this._binding.type = Un.Instance, this._binding.implementationType = t, new nC(this._binding);
  }, r.prototype.toSelf = function() {
    if (typeof this._binding.serviceIdentifier != "function")
      throw new Error("" + Oue);
    var t = this._binding.serviceIdentifier;
    return this.to(t);
  }, r.prototype.toConstantValue = function(t) {
    return this._binding.type = Un.ConstantValue, this._binding.cache = t, this._binding.dynamicValue = null, this._binding.implementationType = null, this._binding.scope = $n.Singleton, new ns(this._binding);
  }, r.prototype.toDynamicValue = function(t) {
    return this._binding.type = Un.DynamicValue, this._binding.cache = null, this._binding.dynamicValue = t, this._binding.implementationType = null, new nC(this._binding);
  }, r.prototype.toConstructor = function(t) {
    return this._binding.type = Un.Constructor, this._binding.implementationType = t, this._binding.scope = $n.Singleton, new ns(this._binding);
  }, r.prototype.toFactory = function(t) {
    return this._binding.type = Un.Factory, this._binding.factory = t, this._binding.scope = $n.Singleton, new ns(this._binding);
  }, r.prototype.toFunction = function(t) {
    if (typeof t != "function")
      throw new Error(Pue);
    var e = this.toConstantValue(t);
    return this._binding.type = Un.Function, this._binding.scope = $n.Singleton, e;
  }, r.prototype.toAutoFactory = function(t) {
    return this._binding.type = Un.Factory, this._binding.factory = function(e) {
      var n = function() {
        return e.container.get(t);
      };
      return n;
    }, this._binding.scope = $n.Singleton, new ns(this._binding);
  }, r.prototype.toProvider = function(t) {
    return this._binding.type = Un.Provider, this._binding.provider = t, this._binding.scope = $n.Singleton, new ns(this._binding);
  }, r.prototype.toService = function(t) {
    this.toDynamicValue(function(e) {
      return e.container.get(t);
    });
  }, r;
}(), ufe = function() {
  function r() {
  }
  return r.of = function(t, e) {
    var n = new r();
    return n.bindings = t, n.middleware = e, n;
  }, r;
}(), iC = function() {
  function r() {
    this._map = /* @__PURE__ */ new Map();
  }
  return r.prototype.getMap = function() {
    return this._map;
  }, r.prototype.add = function(t, e) {
    if (t == null)
      throw new Error(Nl);
    if (e == null)
      throw new Error(Nl);
    var n = this._map.get(t);
    n !== void 0 ? (n.push(e), this._map.set(t, n)) : this._map.set(t, [e]);
  }, r.prototype.get = function(t) {
    if (t == null)
      throw new Error(Nl);
    var e = this._map.get(t);
    if (e !== void 0)
      return e;
    throw new Error(eC);
  }, r.prototype.remove = function(t) {
    if (t == null)
      throw new Error(Nl);
    if (!this._map.delete(t))
      throw new Error(eC);
  }, r.prototype.removeByCondition = function(t) {
    var e = this;
    this._map.forEach(function(n, i) {
      var a = n.filter(function(o) {
        return !t(o);
      });
      a.length > 0 ? e._map.set(i, a) : e._map.delete(i);
    });
  }, r.prototype.hasKey = function(t) {
    if (t == null)
      throw new Error(Nl);
    return this._map.has(t);
  }, r.prototype.clone = function() {
    var t = new r();
    return this._map.forEach(function(e, n) {
      e.forEach(function(i) {
        return t.add(n, i.clone());
      });
    }), t;
  }, r.prototype.traverse = function(t) {
    this._map.forEach(function(e, n) {
      t(n, e);
    });
  }, r;
}(), ffe = globalThis && globalThis.__awaiter || function(r, t, e, n) {
  function i(a) {
    return a instanceof e ? a : new e(function(o) {
      o(a);
    });
  }
  return new (e || (e = Promise))(function(a, o) {
    function s(l) {
      try {
        f(n.next(l));
      } catch (c) {
        o(c);
      }
    }
    function u(l) {
      try {
        f(n.throw(l));
      } catch (c) {
        o(c);
      }
    }
    function f(l) {
      l.done ? a(l.value) : i(l.value).then(s, u);
    }
    f((n = n.apply(r, t || [])).next());
  });
}, lfe = globalThis && globalThis.__generator || function(r, t) {
  var e = { label: 0, sent: function() {
    if (a[0] & 1)
      throw a[1];
    return a[1];
  }, trys: [], ops: [] }, n, i, a, o;
  return o = { next: s(0), throw: s(1), return: s(2) }, typeof Symbol == "function" && (o[Symbol.iterator] = function() {
    return this;
  }), o;
  function s(f) {
    return function(l) {
      return u([f, l]);
    };
  }
  function u(f) {
    if (n)
      throw new TypeError("Generator is already executing.");
    for (; e; )
      try {
        if (n = 1, i && (a = f[0] & 2 ? i.return : f[0] ? i.throw || ((a = i.return) && a.call(i), 0) : i.next) && !(a = a.call(i, f[1])).done)
          return a;
        switch (i = 0, a && (f = [f[0] & 2, a.value]), f[0]) {
          case 0:
          case 1:
            a = f;
            break;
          case 4:
            return e.label++, { value: f[1], done: !1 };
          case 5:
            e.label++, i = f[1], f = [0];
            continue;
          case 7:
            f = e.ops.pop(), e.trys.pop();
            continue;
          default:
            if (a = e.trys, !(a = a.length > 0 && a[a.length - 1]) && (f[0] === 6 || f[0] === 2)) {
              e = 0;
              continue;
            }
            if (f[0] === 3 && (!a || f[1] > a[0] && f[1] < a[3])) {
              e.label = f[1];
              break;
            }
            if (f[0] === 6 && e.label < a[1]) {
              e.label = a[1], a = f;
              break;
            }
            if (a && e.label < a[2]) {
              e.label = a[2], e.ops.push(f);
              break;
            }
            a[2] && e.ops.pop(), e.trys.pop();
            continue;
        }
        f = t.call(r, e);
      } catch (l) {
        f = [6, l], i = 0;
      } finally {
        n = a = 0;
      }
    if (f[0] & 5)
      throw f[1];
    return { value: f[0] ? f[1] : void 0, done: !0 };
  }
}, cfe = globalThis && globalThis.__spreadArray || function(r, t) {
  for (var e = 0, n = t.length, i = r.length; e < n; e++, i++)
    r[i] = t[e];
  return r;
}, v5 = function() {
  function r(t) {
    this._appliedMiddleware = [];
    var e = t || {};
    if (typeof e != "object")
      throw new Error("" + Lue);
    if (e.defaultScope === void 0)
      e.defaultScope = $n.Transient;
    else if (e.defaultScope !== $n.Singleton && e.defaultScope !== $n.Transient && e.defaultScope !== $n.Request)
      throw new Error("" + Nue);
    if (e.autoBindInjectable === void 0)
      e.autoBindInjectable = !1;
    else if (typeof e.autoBindInjectable != "boolean")
      throw new Error("" + Rue);
    if (e.skipBaseClassChecks === void 0)
      e.skipBaseClassChecks = !1;
    else if (typeof e.skipBaseClassChecks != "boolean")
      throw new Error("" + Bue);
    this.options = {
      autoBindInjectable: e.autoBindInjectable,
      defaultScope: e.defaultScope,
      skipBaseClassChecks: e.skipBaseClassChecks
    }, this.id = wh(), this._bindingDictionary = new iC(), this._snapshots = [], this._middleware = null, this.parent = null, this._metadataReader = new Uue();
  }
  return r.merge = function(t, e) {
    for (var n = [], i = 2; i < arguments.length; i++)
      n[i - 2] = arguments[i];
    var a = new r(), o = cfe([t, e], n).map(function(f) {
      return p1(f);
    }), s = p1(a);
    function u(f, l) {
      f.traverse(function(c, h) {
        h.forEach(function(d) {
          l.add(d.serviceIdentifier, d.clone());
        });
      });
    }
    return o.forEach(function(f) {
      u(f, s);
    }), a;
  }, r.prototype.load = function() {
    for (var t = [], e = 0; e < arguments.length; e++)
      t[e] = arguments[e];
    for (var n = this._getContainerModuleHelpersFactory(), i = 0, a = t; i < a.length; i++) {
      var o = a[i], s = n(o.id);
      o.registry(s.bindFunction, s.unbindFunction, s.isboundFunction, s.rebindFunction);
    }
  }, r.prototype.loadAsync = function() {
    for (var t = [], e = 0; e < arguments.length; e++)
      t[e] = arguments[e];
    return ffe(this, void 0, void 0, function() {
      var n, i, a, o, s;
      return lfe(this, function(u) {
        switch (u.label) {
          case 0:
            n = this._getContainerModuleHelpersFactory(), i = 0, a = t, u.label = 1;
          case 1:
            return i < a.length ? (o = a[i], s = n(o.id), [4, o.registry(s.bindFunction, s.unbindFunction, s.isboundFunction, s.rebindFunction)]) : [3, 4];
          case 2:
            u.sent(), u.label = 3;
          case 3:
            return i++, [3, 1];
          case 4:
            return [2];
        }
      });
    });
  }, r.prototype.unload = function() {
    for (var t = this, e = [], n = 0; n < arguments.length; n++)
      e[n] = arguments[n];
    var i = function(a) {
      return function(o) {
        return o.moduleId === a;
      };
    };
    e.forEach(function(a) {
      var o = i(a.id);
      t._bindingDictionary.removeByCondition(o);
    });
  }, r.prototype.bind = function(t) {
    var e = this.options.defaultScope || $n.Transient, n = new yue(t, e);
    return this._bindingDictionary.add(t, n), new sfe(n);
  }, r.prototype.rebind = function(t) {
    return this.unbind(t), this.bind(t);
  }, r.prototype.unbind = function(t) {
    try {
      this._bindingDictionary.remove(t);
    } catch {
      throw new Error(_ue + " " + Hc(t));
    }
  }, r.prototype.unbindAll = function() {
    this._bindingDictionary = new iC();
  }, r.prototype.isBound = function(t) {
    var e = this._bindingDictionary.hasKey(t);
    return !e && this.parent && (e = this.parent.isBound(t)), e;
  }, r.prototype.isBoundNamed = function(t, e) {
    return this.isBoundTagged(t, ra, e);
  }, r.prototype.isBoundTagged = function(t, e, n) {
    var i = !1;
    if (this._bindingDictionary.hasKey(t)) {
      var a = this._bindingDictionary.get(t), o = Jue(this, t, e, n);
      i = a.some(function(s) {
        return s.constraint(o);
      });
    }
    return !i && this.parent && (i = this.parent.isBoundTagged(t, e, n)), i;
  }, r.prototype.snapshot = function() {
    this._snapshots.push(ufe.of(this._bindingDictionary.clone(), this._middleware));
  }, r.prototype.restore = function() {
    var t = this._snapshots.pop();
    if (t === void 0)
      throw new Error(Aue);
    this._bindingDictionary = t.bindings, this._middleware = t.middleware;
  }, r.prototype.createChild = function(t) {
    var e = new r(t || this.options);
    return e.parent = this, e;
  }, r.prototype.applyMiddleware = function() {
    for (var t = [], e = 0; e < arguments.length; e++)
      t[e] = arguments[e];
    this._appliedMiddleware = this._appliedMiddleware.concat(t);
    var n = this._middleware ? this._middleware : this._planAndResolve();
    this._middleware = t.reduce(function(i, a) {
      return a(i);
    }, n);
  }, r.prototype.applyCustomMetadataReader = function(t) {
    this._metadataReader = t;
  }, r.prototype.get = function(t) {
    return this._get(!1, !1, mo.Variable, t);
  }, r.prototype.getTagged = function(t, e, n) {
    return this._get(!1, !1, mo.Variable, t, e, n);
  }, r.prototype.getNamed = function(t, e) {
    return this.getTagged(t, ra, e);
  }, r.prototype.getAll = function(t) {
    return this._get(!0, !0, mo.Variable, t);
  }, r.prototype.getAllTagged = function(t, e, n) {
    return this._get(!1, !0, mo.Variable, t, e, n);
  }, r.prototype.getAllNamed = function(t, e) {
    return this.getAllTagged(t, ra, e);
  }, r.prototype.resolve = function(t) {
    var e = this.createChild();
    return e.bind(t).toSelf(), this._appliedMiddleware.forEach(function(n) {
      e.applyMiddleware(n);
    }), e.get(t);
  }, r.prototype._getContainerModuleHelpersFactory = function() {
    var t = this, e = function(s, u) {
      s._binding.moduleId = u;
    }, n = function(s) {
      return function(u) {
        var f = t.bind.bind(t), l = f(u);
        return e(l, s), l;
      };
    }, i = function(s) {
      return function(u) {
        var f = t.unbind.bind(t);
        f(u);
      };
    }, a = function(s) {
      return function(u) {
        var f = t.isBound.bind(t);
        return f(u);
      };
    }, o = function(s) {
      return function(u) {
        var f = t.rebind.bind(t), l = f(u);
        return e(l, s), l;
      };
    };
    return function(s) {
      return {
        bindFunction: n(s),
        isboundFunction: a(),
        rebindFunction: o(s),
        unbindFunction: i()
      };
    };
  }, r.prototype._get = function(t, e, n, i, a, o) {
    var s = null, u = {
      avoidConstraints: t,
      contextInterceptor: function(f) {
        return f;
      },
      isMultiInject: e,
      key: a,
      serviceIdentifier: i,
      targetType: n,
      value: o
    };
    if (this._middleware) {
      if (s = this._middleware(u), s == null)
        throw new Error(Iue);
    } else
      s = this._planAndResolve()(u);
    return s;
  }, r.prototype._planAndResolve = function() {
    var t = this;
    return function(e) {
      var n = Que(t._metadataReader, t, e.isMultiInject, e.targetType, e.serviceIdentifier, e.key, e.value, e.avoidConstraints);
      n = e.contextInterceptor(n);
      var i = afe(n);
      return i;
    };
  }, r;
}();
function Mr() {
  return function(r) {
    if (Reflect.hasOwnMetadata(v1, r))
      throw new Error(mue);
    var t = Reflect.getMetadata(vue, r) || [];
    return Reflect.defineMetadata(v1, t, r), r;
  };
}
function $a(r) {
  return function(t, e, n) {
    var i = new ys(ra, r);
    typeof n == "number" ? o5(t, e, n, i) : s5(t, e, i);
  };
}
var Ge = {
  HierarchyComponentManager: Symbol("HierarchyComponentManager"),
  TransformComponentManager: Symbol("TransformComponentManager"),
  NameComponentManager: Symbol("NameComponentManager"),
  SceneGraphSystem: Symbol("SceneGraphSystem"),
  FrameGraphSystem: Symbol("FrameGraphSystem"),
  ResourcePool: Symbol("ResourcePool"),
  ResourceHandleComponentManager: Symbol("ResourceHandleComponentManager"),
  PassNodeComponentManager: Symbol("PassNodeComponentManager"),
  RendererSystem: Symbol("RendererSystem"),
  RenderPass: Symbol("RenderPass"),
  RenderPassFactory: Symbol("Factory<IRenderPass>"),
  Renderable: Symbol("Factory<IRenderPass>"),
  MeshSystem: Symbol("MeshSystem"),
  MeshComponentManager: Symbol("MeshComponentManager"),
  CullableComponentManager: Symbol("CullableComponentManager"),
  Geometry: Symbol("Geometry"),
  GeometrySystem: Symbol("GeometrySystem"),
  GeometryComponentManager: Symbol("GeometryComponentManager"),
  Material: Symbol("Material"),
  MaterialSystem: Symbol("MaterialSystem"),
  MaterialComponentManager: Symbol("MaterialComponentManager"),
  ForwardRenderPath: Symbol("ForwardRenderPath"),
  ComputeSystem: Symbol("ComputeSystem"),
  ComputeComponentManager: Symbol("ComputeComponentManager"),
  ComputeStrategy: Symbol("ComputeStrategy"),
  Systems: Symbol("Systems"),
  World: Symbol("World"),
  RenderEngine: Symbol("RenderEngine"),
  WebGPUEngine: Symbol("WebGPUEngine"),
  WebGLEngine: Symbol("WebGLEngine"),
  ShaderModuleService: Symbol("ShaderModuleService"),
  ConfigService: Symbol("ConfigService"),
  InteractorService: Symbol("InteractorService"),
  IEventEmitter: Symbol("IEventEmitter"),
  Light: Symbol("Light")
}, hfe = function r() {
  Pt(this, r), this.index = void 0;
}, dfe = function r() {
  Pt(this, r), this.name = void 0, this.data = void 0, this.execute = void 0, this.tearDown = void 0;
}, vfe = /* @__PURE__ */ function() {
  function r() {
    Pt(this, r), this.name = void 0, this.refCount = 0, this.hasSideEffect = !1, this.devirtualize = [], this.destroy = [], this.reads = [], this.writes = [];
  }
  return Wt(r, [{
    key: "read",
    value: function(e) {
      return this.reads.find(function(n) {
        return n.index === e.index;
      }) || this.reads.push(e), e;
    }
  }, {
    key: "sample",
    value: function(e) {
      return this.read(e), e;
    }
  }, {
    key: "write",
    value: function(e, n) {
      var i = this.writes.find(function(u) {
        return u.index === n.index;
      });
      if (i)
        return n;
      var a = e.getResourceNode(n);
      a.resource.version++, a.resource.imported && (this.hasSideEffect = !0);
      var o = e.createResourceNode(a.resource), s = e.getResourceNode(o);
      return s.writer = this, this.writes.push(o), o;
    }
  }]), r;
}();
function y1(r, t) {
  return y1 = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function(n, i) {
    return n.__proto__ = i, n;
  }, y1(r, t);
}
function Hn(r, t) {
  if (typeof t != "function" && t !== null)
    throw new TypeError("Super expression must either be null or a function");
  r.prototype = Object.create(t && t.prototype, {
    constructor: {
      value: r,
      writable: !0,
      configurable: !0
    }
  }), Object.defineProperty(r, "prototype", {
    writable: !1
  }), t && y1(r, t);
}
function To(r) {
  return To = typeof Symbol == "function" && typeof Symbol.iterator == "symbol" ? function(t) {
    return typeof t;
  } : function(t) {
    return t && typeof Symbol == "function" && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t;
  }, To(r);
}
function qr(r) {
  if (r === void 0)
    throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
  return r;
}
function Kn(r, t) {
  if (t && (To(t) === "object" || typeof t == "function"))
    return t;
  if (t !== void 0)
    throw new TypeError("Derived constructors may only return object or undefined");
  return qr(r);
}
function Sr(r) {
  return Sr = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function(e) {
    return e.__proto__ || Object.getPrototypeOf(e);
  }, Sr(r);
}
var pfe = function r() {
  Pt(this, r), this.first = void 0, this.last = void 0;
};
function gfe(r) {
  var t = yfe();
  return function() {
    var n = Sr(r), i;
    if (t) {
      var a = Sr(this).constructor;
      i = Reflect.construct(n, arguments, a);
    } else
      i = n.apply(this, arguments);
    return Kn(this, i);
  };
}
function yfe() {
  if (typeof Reflect > "u" || !Reflect.construct || Reflect.construct.sham)
    return !1;
  if (typeof Proxy == "function")
    return !0;
  try {
    return Date.prototype.toString.call(Reflect.construct(Date, [], function() {
    })), !0;
  } catch {
    return !1;
  }
}
var aC = /* @__PURE__ */ function(r) {
  Hn(e, r);
  var t = gfe(e);
  function e() {
    var n;
    Pt(this, e);
    for (var i = arguments.length, a = new Array(i), o = 0; o < i; o++)
      a[o] = arguments[o];
    return n = t.call.apply(t, [this].concat(a)), n.version = 0, n.refs = 0, n.name = void 0, n.imported = void 0, n.priority = void 0, n.discardStart = !0, n.discardEnd = !1, n.descriptor = void 0, n.resource = void 0, n;
  }
  return Wt(e, [{
    key: "preExecuteDestroy",
    value: function() {
      this.discardEnd = !0;
    }
  }, {
    key: "postExecuteDestroy",
    value: function() {
      this.imported;
    }
  }, {
    key: "postExecuteDevirtualize",
    value: function() {
      this.discardStart = !1;
    }
  }, {
    key: "preExecuteDevirtualize",
    value: function() {
      this.imported;
    }
  }]), e;
}(pfe), mfe = function r() {
  Pt(this, r), this.resource = void 0, this.writer = void 0, this.readerCount = 0, this.version = void 0;
}, oC, sC, uC, Ay, fC, lC;
function Pi(r, t) {
  var e;
  if (typeof Symbol > "u" || r[Symbol.iterator] == null) {
    if (Array.isArray(r) || (e = bfe(r)) || t && r && typeof r.length == "number") {
      e && (r = e);
      var n = 0, i = function() {
      };
      return { s: i, n: function() {
        return n >= r.length ? { done: !0 } : { done: !1, value: r[n++] };
      }, e: function(f) {
        throw f;
      }, f: i };
    }
    throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`);
  }
  var a = !0, o = !1, s;
  return { s: function() {
    e = r[Symbol.iterator]();
  }, n: function() {
    var f = e.next();
    return a = f.done, f;
  }, e: function(f) {
    o = !0, s = f;
  }, f: function() {
    try {
      !a && e.return != null && e.return();
    } finally {
      if (o)
        throw s;
    }
  } };
}
function bfe(r, t) {
  if (!!r) {
    if (typeof r == "string")
      return cC(r, t);
    var e = Object.prototype.toString.call(r).slice(8, -1);
    if (e === "Object" && r.constructor && (e = r.constructor.name), e === "Map" || e === "Set")
      return Array.from(r);
    if (e === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))
      return cC(r, t);
  }
}
function cC(r, t) {
  (t == null || t > r.length) && (t = r.length);
  for (var e = 0, n = new Array(t); e < t; e++)
    n[e] = r[e];
  return n;
}
var xfe = (oC = Mr(), sC = Ut(Ge.RenderEngine), oC(uC = (Ay = (lC = /* @__PURE__ */ function() {
  function r() {
    Pt(this, r), this.passNodes = [], this.resourceNodes = [], this.frameGraphPasses = [], Ft(this, "engine", fC, this);
  }
  return Wt(r, [{
    key: "execute",
    value: function() {
      var t = Er(/* @__PURE__ */ St.mark(function n(i) {
        return St.wrap(function(o) {
          for (; ; )
            switch (o.prev = o.next) {
              case 0:
                return this.compile(), o.next = 3, this.executePassNodes(i);
              case 3:
              case "end":
                return o.stop();
            }
        }, n, this);
      }));
      function e(n) {
        return t.apply(this, arguments);
      }
      return e;
    }()
  }, {
    key: "tearDown",
    value: function() {
      this.frameGraphPasses.forEach(function(e) {
        e.tearDown && e.tearDown();
      }), this.reset();
    }
  }, {
    key: "addPass",
    value: function(e, n, i, a) {
      var o = new dfe();
      o.execute = i, a && (o.tearDown = a), o.name = e;
      var s = new vfe();
      return s.name = e, this.passNodes.push(s), this.frameGraphPasses.push(o), n(this, s, o), o;
    }
  }, {
    key: "getPass",
    value: function(e) {
      return this.frameGraphPasses.find(function(n) {
        return n.name === e;
      });
    }
  }, {
    key: "compile",
    value: function() {
      var e = this, n = Pi(this.passNodes), i;
      try {
        for (n.s(); !(i = n.n()).done; ) {
          var a = i.value;
          a.refCount = a.writes.length + (a.hasSideEffect ? 1 : 0), a.reads.forEach(function(G) {
            e.resourceNodes[G.index].readerCount++;
          });
        }
      } catch (G) {
        n.e(G);
      } finally {
        n.f();
      }
      var o = [], s = Pi(this.resourceNodes), u;
      try {
        for (s.s(); !(u = s.n()).done; ) {
          var f = u.value;
          f.readerCount === 0 && o.push(f);
        }
      } catch (G) {
        s.e(G);
      } finally {
        s.f();
      }
      for (; o.length; ) {
        var l = o.pop(), c = l && l.writer;
        if (c && --c.refCount === 0) {
          var h = Pi(c.reads), d;
          try {
            for (h.s(); !(d = h.n()).done; ) {
              var v = d.value, p = this.resourceNodes[v.index];
              --p.readerCount === 0 && o.push(p);
            }
          } catch (G) {
            h.e(G);
          } finally {
            h.f();
          }
        }
      }
      this.resourceNodes.forEach(function(G) {
        G.resource.refs += G.readerCount;
      });
      var g = Pi(this.passNodes), y;
      try {
        for (g.s(); !(y = g.n()).done; ) {
          var b = y.value;
          if (!!b.refCount) {
            var m = Pi(b.reads), x;
            try {
              for (m.s(); !(x = m.n()).done; ) {
                var _ = x.value, w = this.resourceNodes[_.index].resource;
                w.first = w.first ? w.first : b, w.last = b;
              }
            } catch (G) {
              m.e(G);
            } finally {
              m.f();
            }
            var E = Pi(b.writes), M;
            try {
              for (E.s(); !(M = E.n()).done; ) {
                var C = M.value, S = this.resourceNodes[C.index].resource;
                S.first = S.first ? S.first : b, S.last = b;
              }
            } catch (G) {
              E.e(G);
            } finally {
              E.f();
            }
          }
        }
      } catch (G) {
        g.e(G);
      } finally {
        g.f();
      }
      for (var A = 0; A < 2; A++) {
        var T = Pi(this.resourceNodes), P;
        try {
          for (T.s(); !(P = T.n()).done; ) {
            var k = P.value, L = k.resource;
            if (L.priority === A && L.refs) {
              var O = L.first, D = L.last;
              O && D && (O.devirtualize.push(L), D.destroy.push(L));
            }
          }
        } catch (G) {
          T.e(G);
        } finally {
          T.f();
        }
      }
    }
  }, {
    key: "executePassNodes",
    value: function() {
      var t = Er(/* @__PURE__ */ St.mark(function n(i) {
        var a, o, s, u, f, l, c, h, d, v, p, g, y, b, m, x, _;
        return St.wrap(function(E) {
          for (; ; )
            switch (E.prev = E.next) {
              case 0:
                a = Pi(this.passNodes.entries()), E.prev = 1, a.s();
              case 3:
                if ((o = a.n()).done) {
                  E.next = 18;
                  break;
                }
                if (s = xg(o.value, 2), u = s[0], f = s[1], !f.refCount) {
                  E.next = 16;
                  break;
                }
                l = Pi(f.devirtualize);
                try {
                  for (l.s(); !(c = l.n()).done; )
                    h = c.value, h.preExecuteDevirtualize(this.engine);
                } catch (M) {
                  l.e(M);
                } finally {
                  l.f();
                }
                d = Pi(f.destroy);
                try {
                  for (d.s(); !(v = d.n()).done; )
                    p = v.value, p.preExecuteDestroy(this.engine);
                } catch (M) {
                  d.e(M);
                } finally {
                  d.f();
                }
                return E.next = 12, this.frameGraphPasses[u].execute(this, this.frameGraphPasses[u], i);
              case 12:
                g = Pi(f.devirtualize);
                try {
                  for (g.s(); !(y = g.n()).done; )
                    b = y.value, b.postExecuteDevirtualize(this.engine);
                } catch (M) {
                  g.e(M);
                } finally {
                  g.f();
                }
                m = Pi(f.destroy);
                try {
                  for (m.s(); !(x = m.n()).done; )
                    _ = x.value, _.postExecuteDestroy(this.engine);
                } catch (M) {
                  m.e(M);
                } finally {
                  m.f();
                }
              case 16:
                E.next = 3;
                break;
              case 18:
                E.next = 23;
                break;
              case 20:
                E.prev = 20, E.t0 = E.catch(1), a.e(E.t0);
              case 23:
                return E.prev = 23, a.f(), E.finish(23);
              case 26:
                this.reset();
              case 27:
              case "end":
                return E.stop();
            }
        }, n, this, [[1, 20, 23, 26]]);
      }));
      function e(n) {
        return t.apply(this, arguments);
      }
      return e;
    }()
  }, {
    key: "reset",
    value: function() {
      this.passNodes = [], this.resourceNodes = [], this.frameGraphPasses = [];
    }
  }, {
    key: "getResourceNode",
    value: function(e) {
      return this.resourceNodes[e.index];
    }
  }, {
    key: "createResourceNode",
    value: function(e) {
      var n = new mfe();
      n.resource = e, n.version = e.version, this.resourceNodes.push(n);
      var i = new hfe();
      return i.index = this.resourceNodes.length - 1, i;
    }
  }, {
    key: "createTexture",
    value: function(e, n, i) {
      var a = new aC();
      return a.name = n, a.descriptor = i, this.createResourceNode(a);
    }
  }, {
    key: "createRenderTarget",
    value: function(e, n, i) {
      var a = new aC();
      return a.name = n, a.descriptor = i, this.createResourceNode(a);
    }
  }, {
    key: "present",
    value: function(e) {
      this.addPass("Present", function(n, i) {
        i.read(e), i.hasSideEffect = !0;
      }, /* @__PURE__ */ Er(/* @__PURE__ */ St.mark(function n() {
        return St.wrap(function(a) {
          for (; ; )
            switch (a.prev = a.next) {
              case 0:
              case "end":
                return a.stop();
            }
        }, n);
      })));
    }
  }]), r;
}(), lC), fC = zt(Ay.prototype, "engine", [sC], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), Ay)) || uC);
function Ae(r, t, e) {
  return t in r ? Object.defineProperty(r, t, {
    value: e,
    enumerable: !0,
    configurable: !0,
    writable: !0
  }) : r[t] = e, r;
}
var _fe = 9007199254740991, wfe = "[object Arguments]", Efe = "[object Array]", Sfe = "[object Boolean]", Mfe = "[object Date]", Cfe = "[object Error]", Tfe = "[object Function]", Afe = "[object Map]", Ife = "[object Number]", Pfe = "[object Object]", Ofe = "[object RegExp]", Dfe = "[object Set]", kfe = "[object String]", Lfe = "[object WeakMap]", Nfe = "[object ArrayBuffer]", Rfe = "[object DataView]", Bfe = "[object Float32Array]", Gfe = "[object Float64Array]", Ffe = "[object Int8Array]", zfe = "[object Int16Array]", Ufe = "[object Int32Array]", jfe = "[object Uint8Array]", $fe = "[object Uint8ClampedArray]", Wfe = "[object Uint16Array]", Vfe = "[object Uint32Array]", Gr = {};
Gr[Bfe] = Gr[Gfe] = Gr[Ffe] = Gr[zfe] = Gr[Ufe] = Gr[jfe] = Gr[$fe] = Gr[Wfe] = Gr[Vfe] = !0;
Gr[wfe] = Gr[Efe] = Gr[Nfe] = Gr[Sfe] = Gr[Rfe] = Gr[Mfe] = Gr[Cfe] = Gr[Tfe] = Gr[Afe] = Gr[Ife] = Gr[Pfe] = Gr[Ofe] = Gr[Dfe] = Gr[kfe] = Gr[Lfe] = !1;
var Xfe = Object.prototype, Yfe = Xfe.toString;
function Hfe(r) {
  return qfe(r) && Kfe(r.length) && !!Gr[Yfe.call(r)];
}
function Kfe(r) {
  return typeof r == "number" && r > -1 && r % 1 === 0 && r <= _fe;
}
function qfe(r) {
  return !!r && To(r) === "object";
}
var hC = Hfe;
function dC(r, t) {
  var e = Object.keys(r);
  if (Object.getOwnPropertySymbols) {
    var n = Object.getOwnPropertySymbols(r);
    t && (n = n.filter(function(i) {
      return Object.getOwnPropertyDescriptor(r, i).enumerable;
    })), e.push.apply(e, n);
  }
  return e;
}
function vC(r) {
  for (var t = 1; t < arguments.length; t++) {
    var e = arguments[t] != null ? arguments[t] : {};
    t % 2 ? dC(Object(e), !0).forEach(function(n) {
      Ae(r, n, e[n]);
    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(r, Object.getOwnPropertyDescriptors(e)) : dC(Object(e)).forEach(function(n) {
      Object.defineProperty(r, n, Object.getOwnPropertyDescriptor(e, n));
    });
  }
  return r;
}
function Zfe(r) {
  var t = Qfe();
  return function() {
    var n = Sr(r), i;
    if (t) {
      var a = Sr(this).constructor;
      i = Reflect.construct(n, arguments, a);
    } else
      i = n.apply(this, arguments);
    return Kn(this, i);
  };
}
function Qfe() {
  if (typeof Reflect > "u" || !Reflect.construct || Reflect.construct.sham)
    return !1;
  if (typeof Proxy == "function")
    return !0;
  try {
    return Date.prototype.toString.call(Reflect.construct(Date, [], function() {
    })), !0;
  } catch {
    return !1;
  }
}
var Jfe = /* @__PURE__ */ function(r) {
  Hn(e, r);
  var t = Zfe(e);
  function e(n) {
    var i;
    return Pt(this, e), i = t.call(this, n), i.dirty = !0, i.attributes = [], i.indices = void 0, i.indicesBuffer = void 0, i.vertexCount = 0, i.maxInstancedCount = void 0, i.aabb = void 0, i.entity = void 0, Object.assign(qr(i), n), i;
  }
  return Wt(e, [{
    key: "setAttribute",
    value: function(i, a, o, s) {
      var u = this.attributes.find(function(f) {
        return f.name === i;
      });
      return u ? (u.data = a, u.dirty = !0) : this.attributes.push(vC(vC({
        dirty: !0,
        name: i,
        data: a
      }, o), {}, {
        bufferGetter: s
      })), this.dirty = !0, this;
    }
  }, {
    key: "setIndex",
    value: function(i) {
      return this.indices = new Uint32Array(
        i.buffer ? i.buffer : i
      ), this.dirty = !0, this;
    }
  }, {
    key: "applyMatrix",
    value: function(i) {
      var a = this.attributes.find(function(h) {
        var d = h.name;
        return d === "position";
      }), o = this.attributes.find(function(h) {
        var d = h.name;
        return d === "normal";
      });
      if (a && (a.dirty = !0, a.data && a.data.length))
        for (var s = 0; s < a.data.length; s += 3) {
          var u = J1(
            a.data[s],
            a.data[s + 1],
            a.data[s + 2],
            1
          );
          Sf(u, u, i), hC(a.data) ? a.data.set([u[0], u[1], u[2]], s) : (a.data[s] = u[0], a.data[s + 1] = u[1], a.data[s + 2] = u[2]);
        }
      if (o) {
        var f = HD(tl(), i);
        if (o.data && o.data.length)
          for (var l = 0; l < o.data.length; l += 3) {
            var c = rr(
              o.data[l],
              o.data[l + 1],
              o.data[l + 2]
            );
            Mu(c, c, f), Pf(c, c), hC(o.data) ? o.data.set([c[0], c[1], c[2]], l) : (o.data[l] = c[0], o.data[l + 1] = c[1], o.data[l + 2] = c[2]);
          }
      }
    }
  }]), e;
}(Du), he;
(function(r) {
  r[r.DEPTH_BUFFER_BIT = 256] = "DEPTH_BUFFER_BIT", r[r.STENCIL_BUFFER_BIT = 1024] = "STENCIL_BUFFER_BIT", r[r.COLOR_BUFFER_BIT = 16384] = "COLOR_BUFFER_BIT", r[r.POINTS = 0] = "POINTS", r[r.LINES = 1] = "LINES", r[r.LINE_LOOP = 2] = "LINE_LOOP", r[r.LINE_STRIP = 3] = "LINE_STRIP", r[r.TRIANGLES = 4] = "TRIANGLES", r[r.TRIANGLE_STRIP = 5] = "TRIANGLE_STRIP", r[r.TRIANGLE_FAN = 6] = "TRIANGLE_FAN", r[r.ZERO = 0] = "ZERO", r[r.ONE = 1] = "ONE", r[r.SRC_COLOR = 768] = "SRC_COLOR", r[r.ONE_MINUS_SRC_COLOR = 769] = "ONE_MINUS_SRC_COLOR", r[r.SRC_ALPHA = 770] = "SRC_ALPHA", r[r.ONE_MINUS_SRC_ALPHA = 771] = "ONE_MINUS_SRC_ALPHA", r[r.DST_ALPHA = 772] = "DST_ALPHA", r[r.ONE_MINUS_DST_ALPHA = 773] = "ONE_MINUS_DST_ALPHA", r[r.DST_COLOR = 774] = "DST_COLOR", r[r.ONE_MINUS_DST_COLOR = 775] = "ONE_MINUS_DST_COLOR", r[r.SRC_ALPHA_SATURATE = 776] = "SRC_ALPHA_SATURATE", r[r.FUNC_ADD = 32774] = "FUNC_ADD", r[r.BLEND_EQUATION = 32777] = "BLEND_EQUATION", r[r.BLEND_EQUATION_RGB = 32777] = "BLEND_EQUATION_RGB", r[r.BLEND_EQUATION_ALPHA = 34877] = "BLEND_EQUATION_ALPHA", r[r.FUNC_SUBTRACT = 32778] = "FUNC_SUBTRACT", r[r.FUNC_REVERSE_SUBTRACT = 32779] = "FUNC_REVERSE_SUBTRACT", r[r.MAX_EXT = 32776] = "MAX_EXT", r[r.MIN_EXT = 32775] = "MIN_EXT", r[r.BLEND_DST_RGB = 32968] = "BLEND_DST_RGB", r[r.BLEND_SRC_RGB = 32969] = "BLEND_SRC_RGB", r[r.BLEND_DST_ALPHA = 32970] = "BLEND_DST_ALPHA", r[r.BLEND_SRC_ALPHA = 32971] = "BLEND_SRC_ALPHA", r[r.CONSTANT_COLOR = 32769] = "CONSTANT_COLOR", r[r.ONE_MINUS_CONSTANT_COLOR = 32770] = "ONE_MINUS_CONSTANT_COLOR", r[r.CONSTANT_ALPHA = 32771] = "CONSTANT_ALPHA", r[r.ONE_MINUS_CONSTANT_ALPHA = 32772] = "ONE_MINUS_CONSTANT_ALPHA", r[r.BLEND_COLOR = 32773] = "BLEND_COLOR", r[r.ARRAY_BUFFER = 34962] = "ARRAY_BUFFER", r[r.ELEMENT_ARRAY_BUFFER = 34963] = "ELEMENT_ARRAY_BUFFER", r[r.ARRAY_BUFFER_BINDING = 34964] = "ARRAY_BUFFER_BINDING", r[r.ELEMENT_ARRAY_BUFFER_BINDING = 34965] = "ELEMENT_ARRAY_BUFFER_BINDING", r[r.STREAM_DRAW = 35040] = "STREAM_DRAW", r[r.STATIC_DRAW = 35044] = "STATIC_DRAW", r[r.DYNAMIC_DRAW = 35048] = "DYNAMIC_DRAW", r[r.BUFFER_SIZE = 34660] = "BUFFER_SIZE", r[r.BUFFER_USAGE = 34661] = "BUFFER_USAGE", r[r.CURRENT_VERTEX_ATTRIB = 34342] = "CURRENT_VERTEX_ATTRIB", r[r.FRONT = 1028] = "FRONT", r[r.BACK = 1029] = "BACK", r[r.FRONT_AND_BACK = 1032] = "FRONT_AND_BACK", r[r.CULL_FACE = 2884] = "CULL_FACE", r[r.BLEND = 3042] = "BLEND", r[r.DITHER = 3024] = "DITHER", r[r.STENCIL_TEST = 2960] = "STENCIL_TEST", r[r.DEPTH_TEST = 2929] = "DEPTH_TEST", r[r.SCISSOR_TEST = 3089] = "SCISSOR_TEST", r[r.POLYGON_OFFSET_FILL = 32823] = "POLYGON_OFFSET_FILL", r[r.SAMPLE_ALPHA_TO_COVERAGE = 32926] = "SAMPLE_ALPHA_TO_COVERAGE", r[r.SAMPLE_COVERAGE = 32928] = "SAMPLE_COVERAGE", r[r.NO_ERROR = 0] = "NO_ERROR", r[r.INVALID_ENUM = 1280] = "INVALID_ENUM", r[r.INVALID_VALUE = 1281] = "INVALID_VALUE", r[r.INVALID_OPERATION = 1282] = "INVALID_OPERATION", r[r.OUT_OF_MEMORY = 1285] = "OUT_OF_MEMORY", r[r.CW = 2304] = "CW", r[r.CCW = 2305] = "CCW", r[r.LINE_WIDTH = 2849] = "LINE_WIDTH", r[r.ALIASED_POINT_SIZE_RANGE = 33901] = "ALIASED_POINT_SIZE_RANGE", r[r.ALIASED_LINE_WIDTH_RANGE = 33902] = "ALIASED_LINE_WIDTH_RANGE", r[r.CULL_FACE_MODE = 2885] = "CULL_FACE_MODE", r[r.FRONT_FACE = 2886] = "FRONT_FACE", r[r.DEPTH_RANGE = 2928] = "DEPTH_RANGE", r[r.DEPTH_WRITEMASK = 2930] = "DEPTH_WRITEMASK", r[r.DEPTH_CLEAR_VALUE = 2931] = "DEPTH_CLEAR_VALUE", r[r.DEPTH_FUNC = 2932] = "DEPTH_FUNC", r[r.STENCIL_CLEAR_VALUE = 2961] = "STENCIL_CLEAR_VALUE", r[r.STENCIL_FUNC = 2962] = "STENCIL_FUNC", r[r.STENCIL_FAIL = 2964] = "STENCIL_FAIL", r[r.STENCIL_PASS_DEPTH_FAIL = 2965] = "STENCIL_PASS_DEPTH_FAIL", r[r.STENCIL_PASS_DEPTH_PASS = 2966] = "STENCIL_PASS_DEPTH_PASS", r[r.STENCIL_REF = 2967] = "STENCIL_REF", r[r.STENCIL_VALUE_MASK = 2963] = "STENCIL_VALUE_MASK", r[r.STENCIL_WRITEMASK = 2968] = "STENCIL_WRITEMASK", r[r.STENCIL_BACK_FUNC = 34816] = "STENCIL_BACK_FUNC", r[r.STENCIL_BACK_FAIL = 34817] = "STENCIL_BACK_FAIL", r[r.STENCIL_BACK_PASS_DEPTH_FAIL = 34818] = "STENCIL_BACK_PASS_DEPTH_FAIL", r[r.STENCIL_BACK_PASS_DEPTH_PASS = 34819] = "STENCIL_BACK_PASS_DEPTH_PASS", r[r.STENCIL_BACK_REF = 36003] = "STENCIL_BACK_REF", r[r.STENCIL_BACK_VALUE_MASK = 36004] = "STENCIL_BACK_VALUE_MASK", r[r.STENCIL_BACK_WRITEMASK = 36005] = "STENCIL_BACK_WRITEMASK", r[r.VIEWPORT = 2978] = "VIEWPORT", r[r.SCISSOR_BOX = 3088] = "SCISSOR_BOX", r[r.COLOR_CLEAR_VALUE = 3106] = "COLOR_CLEAR_VALUE", r[r.COLOR_WRITEMASK = 3107] = "COLOR_WRITEMASK", r[r.UNPACK_ALIGNMENT = 3317] = "UNPACK_ALIGNMENT", r[r.PACK_ALIGNMENT = 3333] = "PACK_ALIGNMENT", r[r.MAX_TEXTURE_SIZE = 3379] = "MAX_TEXTURE_SIZE", r[r.MAX_VIEWPORT_DIMS = 3386] = "MAX_VIEWPORT_DIMS", r[r.SUBPIXEL_BITS = 3408] = "SUBPIXEL_BITS", r[r.RED_BITS = 3410] = "RED_BITS", r[r.GREEN_BITS = 3411] = "GREEN_BITS", r[r.BLUE_BITS = 3412] = "BLUE_BITS", r[r.ALPHA_BITS = 3413] = "ALPHA_BITS", r[r.DEPTH_BITS = 3414] = "DEPTH_BITS", r[r.STENCIL_BITS = 3415] = "STENCIL_BITS", r[r.POLYGON_OFFSET_UNITS = 10752] = "POLYGON_OFFSET_UNITS", r[r.POLYGON_OFFSET_FACTOR = 32824] = "POLYGON_OFFSET_FACTOR", r[r.TEXTURE_BINDING_2D = 32873] = "TEXTURE_BINDING_2D", r[r.SAMPLE_BUFFERS = 32936] = "SAMPLE_BUFFERS", r[r.SAMPLES = 32937] = "SAMPLES", r[r.SAMPLE_COVERAGE_VALUE = 32938] = "SAMPLE_COVERAGE_VALUE", r[r.SAMPLE_COVERAGE_INVERT = 32939] = "SAMPLE_COVERAGE_INVERT", r[r.COMPRESSED_TEXTURE_FORMATS = 34467] = "COMPRESSED_TEXTURE_FORMATS", r[r.DONT_CARE = 4352] = "DONT_CARE", r[r.FASTEST = 4353] = "FASTEST", r[r.NICEST = 4354] = "NICEST", r[r.GENERATE_MIPMAP_HINT = 33170] = "GENERATE_MIPMAP_HINT", r[r.BYTE = 5120] = "BYTE", r[r.UNSIGNED_BYTE = 5121] = "UNSIGNED_BYTE", r[r.SHORT = 5122] = "SHORT", r[r.UNSIGNED_SHORT = 5123] = "UNSIGNED_SHORT", r[r.INT = 5124] = "INT", r[r.UNSIGNED_INT = 5125] = "UNSIGNED_INT", r[r.FLOAT = 5126] = "FLOAT", r[r.DEPTH_COMPONENT = 6402] = "DEPTH_COMPONENT", r[r.ALPHA = 6406] = "ALPHA", r[r.RGB = 6407] = "RGB", r[r.RGBA = 6408] = "RGBA", r[r.LUMINANCE = 6409] = "LUMINANCE", r[r.LUMINANCE_ALPHA = 6410] = "LUMINANCE_ALPHA", r[r.UNSIGNED_SHORT_4_4_4_4 = 32819] = "UNSIGNED_SHORT_4_4_4_4", r[r.UNSIGNED_SHORT_5_5_5_1 = 32820] = "UNSIGNED_SHORT_5_5_5_1", r[r.UNSIGNED_SHORT_5_6_5 = 33635] = "UNSIGNED_SHORT_5_6_5", r[r.FRAGMENT_SHADER = 35632] = "FRAGMENT_SHADER", r[r.VERTEX_SHADER = 35633] = "VERTEX_SHADER", r[r.MAX_VERTEX_ATTRIBS = 34921] = "MAX_VERTEX_ATTRIBS", r[r.MAX_VERTEX_UNIFORM_VECTORS = 36347] = "MAX_VERTEX_UNIFORM_VECTORS", r[r.MAX_VARYING_VECTORS = 36348] = "MAX_VARYING_VECTORS", r[r.MAX_COMBINED_TEXTURE_IMAGE_UNITS = 35661] = "MAX_COMBINED_TEXTURE_IMAGE_UNITS", r[r.MAX_VERTEX_TEXTURE_IMAGE_UNITS = 35660] = "MAX_VERTEX_TEXTURE_IMAGE_UNITS", r[r.MAX_TEXTURE_IMAGE_UNITS = 34930] = "MAX_TEXTURE_IMAGE_UNITS", r[r.MAX_FRAGMENT_UNIFORM_VECTORS = 36349] = "MAX_FRAGMENT_UNIFORM_VECTORS", r[r.SHADER_TYPE = 35663] = "SHADER_TYPE", r[r.DELETE_STATUS = 35712] = "DELETE_STATUS", r[r.LINK_STATUS = 35714] = "LINK_STATUS", r[r.VALIDATE_STATUS = 35715] = "VALIDATE_STATUS", r[r.ATTACHED_SHADERS = 35717] = "ATTACHED_SHADERS", r[r.ACTIVE_UNIFORMS = 35718] = "ACTIVE_UNIFORMS", r[r.ACTIVE_ATTRIBUTES = 35721] = "ACTIVE_ATTRIBUTES", r[r.SHADING_LANGUAGE_VERSION = 35724] = "SHADING_LANGUAGE_VERSION", r[r.CURRENT_PROGRAM = 35725] = "CURRENT_PROGRAM", r[r.NEVER = 512] = "NEVER", r[r.LESS = 513] = "LESS", r[r.EQUAL = 514] = "EQUAL", r[r.LEQUAL = 515] = "LEQUAL", r[r.GREATER = 516] = "GREATER", r[r.NOTEQUAL = 517] = "NOTEQUAL", r[r.GEQUAL = 518] = "GEQUAL", r[r.ALWAYS = 519] = "ALWAYS", r[r.KEEP = 7680] = "KEEP", r[r.REPLACE = 7681] = "REPLACE", r[r.INCR = 7682] = "INCR", r[r.DECR = 7683] = "DECR", r[r.INVERT = 5386] = "INVERT", r[r.INCR_WRAP = 34055] = "INCR_WRAP", r[r.DECR_WRAP = 34056] = "DECR_WRAP", r[r.VENDOR = 7936] = "VENDOR", r[r.RENDERER = 7937] = "RENDERER", r[r.VERSION = 7938] = "VERSION", r[r.NEAREST = 9728] = "NEAREST", r[r.LINEAR = 9729] = "LINEAR", r[r.NEAREST_MIPMAP_NEAREST = 9984] = "NEAREST_MIPMAP_NEAREST", r[r.LINEAR_MIPMAP_NEAREST = 9985] = "LINEAR_MIPMAP_NEAREST", r[r.NEAREST_MIPMAP_LINEAR = 9986] = "NEAREST_MIPMAP_LINEAR", r[r.LINEAR_MIPMAP_LINEAR = 9987] = "LINEAR_MIPMAP_LINEAR", r[r.TEXTURE_MAG_FILTER = 10240] = "TEXTURE_MAG_FILTER", r[r.TEXTURE_MIN_FILTER = 10241] = "TEXTURE_MIN_FILTER", r[r.TEXTURE_WRAP_S = 10242] = "TEXTURE_WRAP_S", r[r.TEXTURE_WRAP_T = 10243] = "TEXTURE_WRAP_T", r[r.TEXTURE_2D = 3553] = "TEXTURE_2D", r[r.TEXTURE = 5890] = "TEXTURE", r[r.TEXTURE_CUBE_MAP = 34067] = "TEXTURE_CUBE_MAP", r[r.TEXTURE_BINDING_CUBE_MAP = 34068] = "TEXTURE_BINDING_CUBE_MAP", r[r.TEXTURE_CUBE_MAP_POSITIVE_X = 34069] = "TEXTURE_CUBE_MAP_POSITIVE_X", r[r.TEXTURE_CUBE_MAP_NEGATIVE_X = 34070] = "TEXTURE_CUBE_MAP_NEGATIVE_X", r[r.TEXTURE_CUBE_MAP_POSITIVE_Y = 34071] = "TEXTURE_CUBE_MAP_POSITIVE_Y", r[r.TEXTURE_CUBE_MAP_NEGATIVE_Y = 34072] = "TEXTURE_CUBE_MAP_NEGATIVE_Y", r[r.TEXTURE_CUBE_MAP_POSITIVE_Z = 34073] = "TEXTURE_CUBE_MAP_POSITIVE_Z", r[r.TEXTURE_CUBE_MAP_NEGATIVE_Z = 34074] = "TEXTURE_CUBE_MAP_NEGATIVE_Z", r[r.MAX_CUBE_MAP_TEXTURE_SIZE = 34076] = "MAX_CUBE_MAP_TEXTURE_SIZE", r[r.TEXTURE0 = 33984] = "TEXTURE0", r[r.TEXTURE1 = 33985] = "TEXTURE1", r[r.TEXTURE2 = 33986] = "TEXTURE2", r[r.TEXTURE3 = 33987] = "TEXTURE3", r[r.TEXTURE4 = 33988] = "TEXTURE4", r[r.TEXTURE5 = 33989] = "TEXTURE5", r[r.TEXTURE6 = 33990] = "TEXTURE6", r[r.TEXTURE7 = 33991] = "TEXTURE7", r[r.TEXTURE8 = 33992] = "TEXTURE8", r[r.TEXTURE9 = 33993] = "TEXTURE9", r[r.TEXTURE10 = 33994] = "TEXTURE10", r[r.TEXTURE11 = 33995] = "TEXTURE11", r[r.TEXTURE12 = 33996] = "TEXTURE12", r[r.TEXTURE13 = 33997] = "TEXTURE13", r[r.TEXTURE14 = 33998] = "TEXTURE14", r[r.TEXTURE15 = 33999] = "TEXTURE15", r[r.TEXTURE16 = 34e3] = "TEXTURE16", r[r.TEXTURE17 = 34001] = "TEXTURE17", r[r.TEXTURE18 = 34002] = "TEXTURE18", r[r.TEXTURE19 = 34003] = "TEXTURE19", r[r.TEXTURE20 = 34004] = "TEXTURE20", r[r.TEXTURE21 = 34005] = "TEXTURE21", r[r.TEXTURE22 = 34006] = "TEXTURE22", r[r.TEXTURE23 = 34007] = "TEXTURE23", r[r.TEXTURE24 = 34008] = "TEXTURE24", r[r.TEXTURE25 = 34009] = "TEXTURE25", r[r.TEXTURE26 = 34010] = "TEXTURE26", r[r.TEXTURE27 = 34011] = "TEXTURE27", r[r.TEXTURE28 = 34012] = "TEXTURE28", r[r.TEXTURE29 = 34013] = "TEXTURE29", r[r.TEXTURE30 = 34014] = "TEXTURE30", r[r.TEXTURE31 = 34015] = "TEXTURE31", r[r.ACTIVE_TEXTURE = 34016] = "ACTIVE_TEXTURE", r[r.REPEAT = 10497] = "REPEAT", r[r.CLAMP_TO_EDGE = 33071] = "CLAMP_TO_EDGE", r[r.MIRRORED_REPEAT = 33648] = "MIRRORED_REPEAT", r[r.FLOAT_VEC2 = 35664] = "FLOAT_VEC2", r[r.FLOAT_VEC3 = 35665] = "FLOAT_VEC3", r[r.FLOAT_VEC4 = 35666] = "FLOAT_VEC4", r[r.INT_VEC2 = 35667] = "INT_VEC2", r[r.INT_VEC3 = 35668] = "INT_VEC3", r[r.INT_VEC4 = 35669] = "INT_VEC4", r[r.BOOL = 35670] = "BOOL", r[r.BOOL_VEC2 = 35671] = "BOOL_VEC2", r[r.BOOL_VEC3 = 35672] = "BOOL_VEC3", r[r.BOOL_VEC4 = 35673] = "BOOL_VEC4", r[r.FLOAT_MAT2 = 35674] = "FLOAT_MAT2", r[r.FLOAT_MAT3 = 35675] = "FLOAT_MAT3", r[r.FLOAT_MAT4 = 35676] = "FLOAT_MAT4", r[r.SAMPLER_2D = 35678] = "SAMPLER_2D", r[r.SAMPLER_CUBE = 35680] = "SAMPLER_CUBE", r[r.VERTEX_ATTRIB_ARRAY_ENABLED = 34338] = "VERTEX_ATTRIB_ARRAY_ENABLED", r[r.VERTEX_ATTRIB_ARRAY_SIZE = 34339] = "VERTEX_ATTRIB_ARRAY_SIZE", r[r.VERTEX_ATTRIB_ARRAY_STRIDE = 34340] = "VERTEX_ATTRIB_ARRAY_STRIDE", r[r.VERTEX_ATTRIB_ARRAY_TYPE = 34341] = "VERTEX_ATTRIB_ARRAY_TYPE", r[r.VERTEX_ATTRIB_ARRAY_NORMALIZED = 34922] = "VERTEX_ATTRIB_ARRAY_NORMALIZED", r[r.VERTEX_ATTRIB_ARRAY_POINTER = 34373] = "VERTEX_ATTRIB_ARRAY_POINTER", r[r.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING = 34975] = "VERTEX_ATTRIB_ARRAY_BUFFER_BINDING", r[r.COMPILE_STATUS = 35713] = "COMPILE_STATUS", r[r.LOW_FLOAT = 36336] = "LOW_FLOAT", r[r.MEDIUM_FLOAT = 36337] = "MEDIUM_FLOAT", r[r.HIGH_FLOAT = 36338] = "HIGH_FLOAT", r[r.LOW_INT = 36339] = "LOW_INT", r[r.MEDIUM_INT = 36340] = "MEDIUM_INT", r[r.HIGH_INT = 36341] = "HIGH_INT", r[r.FRAMEBUFFER = 36160] = "FRAMEBUFFER", r[r.RENDERBUFFER = 36161] = "RENDERBUFFER", r[r.RGBA4 = 32854] = "RGBA4", r[r.RGB5_A1 = 32855] = "RGB5_A1", r[r.RGB565 = 36194] = "RGB565", r[r.DEPTH_COMPONENT16 = 33189] = "DEPTH_COMPONENT16", r[r.STENCIL_INDEX = 6401] = "STENCIL_INDEX", r[r.STENCIL_INDEX8 = 36168] = "STENCIL_INDEX8", r[r.DEPTH_STENCIL = 34041] = "DEPTH_STENCIL", r[r.RENDERBUFFER_WIDTH = 36162] = "RENDERBUFFER_WIDTH", r[r.RENDERBUFFER_HEIGHT = 36163] = "RENDERBUFFER_HEIGHT", r[r.RENDERBUFFER_INTERNAL_FORMAT = 36164] = "RENDERBUFFER_INTERNAL_FORMAT", r[r.RENDERBUFFER_RED_SIZE = 36176] = "RENDERBUFFER_RED_SIZE", r[r.RENDERBUFFER_GREEN_SIZE = 36177] = "RENDERBUFFER_GREEN_SIZE", r[r.RENDERBUFFER_BLUE_SIZE = 36178] = "RENDERBUFFER_BLUE_SIZE", r[r.RENDERBUFFER_ALPHA_SIZE = 36179] = "RENDERBUFFER_ALPHA_SIZE", r[r.RENDERBUFFER_DEPTH_SIZE = 36180] = "RENDERBUFFER_DEPTH_SIZE", r[r.RENDERBUFFER_STENCIL_SIZE = 36181] = "RENDERBUFFER_STENCIL_SIZE", r[r.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE = 36048] = "FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE", r[r.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME = 36049] = "FRAMEBUFFER_ATTACHMENT_OBJECT_NAME", r[r.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL = 36050] = "FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL", r[r.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE = 36051] = "FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE", r[r.COLOR_ATTACHMENT0 = 36064] = "COLOR_ATTACHMENT0", r[r.DEPTH_ATTACHMENT = 36096] = "DEPTH_ATTACHMENT", r[r.STENCIL_ATTACHMENT = 36128] = "STENCIL_ATTACHMENT", r[r.DEPTH_STENCIL_ATTACHMENT = 33306] = "DEPTH_STENCIL_ATTACHMENT", r[r.NONE = 0] = "NONE", r[r.FRAMEBUFFER_COMPLETE = 36053] = "FRAMEBUFFER_COMPLETE", r[r.FRAMEBUFFER_INCOMPLETE_ATTACHMENT = 36054] = "FRAMEBUFFER_INCOMPLETE_ATTACHMENT", r[r.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT = 36055] = "FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT", r[r.FRAMEBUFFER_INCOMPLETE_DIMENSIONS = 36057] = "FRAMEBUFFER_INCOMPLETE_DIMENSIONS", r[r.FRAMEBUFFER_UNSUPPORTED = 36061] = "FRAMEBUFFER_UNSUPPORTED", r[r.FRAMEBUFFER_BINDING = 36006] = "FRAMEBUFFER_BINDING", r[r.RENDERBUFFER_BINDING = 36007] = "RENDERBUFFER_BINDING", r[r.MAX_RENDERBUFFER_SIZE = 34024] = "MAX_RENDERBUFFER_SIZE", r[r.INVALID_FRAMEBUFFER_OPERATION = 1286] = "INVALID_FRAMEBUFFER_OPERATION", r[r.UNPACK_FLIP_Y_WEBGL = 37440] = "UNPACK_FLIP_Y_WEBGL", r[r.UNPACK_PREMULTIPLY_ALPHA_WEBGL = 37441] = "UNPACK_PREMULTIPLY_ALPHA_WEBGL", r[r.CONTEXT_LOST_WEBGL = 37442] = "CONTEXT_LOST_WEBGL", r[r.UNPACK_COLORSPACE_CONVERSION_WEBGL = 37443] = "UNPACK_COLORSPACE_CONVERSION_WEBGL", r[r.BROWSER_DEFAULT_WEBGL = 37444] = "BROWSER_DEFAULT_WEBGL", r[r.COPY_SRC = 1] = "COPY_SRC", r[r.COPY_DST = 2] = "COPY_DST", r[r.SAMPLED = 4] = "SAMPLED", r[r.STORAGE = 8] = "STORAGE", r[r.RENDER_ATTACHMENT = 16] = "RENDER_ATTACHMENT";
})(he || (he = {}));
var pC, gC, yC, mC, Gd, bC, xC, _C, ele = (pC = Mr(), gC = Ut(Ge.GeometryComponentManager), yC = Ut(Ge.RenderEngine), pC(mC = (Gd = (_C = /* @__PURE__ */ function() {
  function r() {
    Pt(this, r), Ft(this, "geometry", bC, this), Ft(this, "engine", xC, this);
  }
  return Wt(r, [{
    key: "execute",
    value: function() {
      var t = Er(/* @__PURE__ */ St.mark(function n() {
        var i = this;
        return St.wrap(function(o) {
          for (; ; )
            switch (o.prev = o.next) {
              case 0:
                this.geometry.forEach(function(s, u) {
                  u.dirty && (u.attributes.forEach(function(f) {
                    if (f.dirty && f.data) {
                      if (!f.buffer)
                        f.buffer = i.engine.createBuffer({
                          data: f.data,
                          type: he.FLOAT
                        });
                      else {
                        var l;
                        (l = f.buffer) === null || l === void 0 || l.subData({
                          data: f.data,
                          offset: 0
                        });
                      }
                      f.dirty = !1;
                    }
                  }), u.indices && (u.indicesBuffer ? u.indicesBuffer.subData({
                    data: u.indices,
                    offset: 0
                  }) : u.indicesBuffer = i.engine.createElements({
                    data: u.indices,
                    count: u.indices.length,
                    type: he.UNSIGNED_INT,
                    usage: he.STATIC_DRAW
                  })), u.dirty = !1);
                });
              case 1:
              case "end":
                return o.stop();
            }
        }, n, this);
      }));
      function e() {
        return t.apply(this, arguments);
      }
      return e;
    }()
  }, {
    key: "tearDown",
    value: function() {
      this.geometry.forEach(function(e, n) {
        n.indicesBuffer && n.indicesBuffer.destroy(), n.attributes.forEach(function(i) {
          i.buffer && i.buffer.destroy();
        });
      }), this.geometry.clear();
    }
  }, {
    key: "createBufferGeometry",
    value: function() {
      var e = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : {
        vertexCount: 3
      }, n = e.vertexCount, i = Na();
      return this.geometry.create(i, {
        vertexCount: n
      });
    }
  }, {
    key: "createInstancedBufferGeometry",
    value: function(e) {
      var n = e.maxInstancedCount, i = e.vertexCount, a = Na();
      return this.geometry.create(a, {
        maxInstancedCount: n,
        vertexCount: i
      });
    }
  }]), r;
}(), _C), bC = zt(Gd.prototype, "geometry", [gC], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), xC = zt(Gd.prototype, "engine", [yC], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), Gd)) || mC);
function wC(r, t) {
  var e = Object.keys(r);
  if (Object.getOwnPropertySymbols) {
    var n = Object.getOwnPropertySymbols(r);
    t && (n = n.filter(function(i) {
      return Object.getOwnPropertyDescriptor(r, i).enumerable;
    })), e.push.apply(e, n);
  }
  return e;
}
function EC(r) {
  for (var t = 1; t < arguments.length; t++) {
    var e = arguments[t] != null ? arguments[t] : {};
    t % 2 ? wC(Object(e), !0).forEach(function(n) {
      Ae(r, n, e[n]);
    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(r, Object.getOwnPropertyDescriptors(e)) : wC(Object(e)).forEach(function(n) {
      Object.defineProperty(r, n, Object.getOwnPropertyDescriptor(e, n));
    });
  }
  return r;
}
function tle(r) {
  var t = rle();
  return function() {
    var n = Sr(r), i;
    if (t) {
      var a = Sr(this).constructor;
      i = Reflect.construct(n, arguments, a);
    } else
      i = n.apply(this, arguments);
    return Kn(this, i);
  };
}
function rle() {
  if (typeof Reflect > "u" || !Reflect.construct || Reflect.construct.sham)
    return !1;
  if (typeof Proxy == "function")
    return !0;
  try {
    return Date.prototype.toString.call(Reflect.construct(Date, [], function() {
    })), !0;
  } catch {
    return !1;
  }
}
var nle = /* @__PURE__ */ function(r) {
  Hn(e, r);
  var t = tle(e);
  function e(n) {
    var i;
    return Pt(this, e), i = t.call(this, n), i.vertexShaderGLSL = void 0, i.fragmentShaderGLSL = void 0, i.defines = {}, i.dirty = !0, i.uniforms = [], i.cull = {
      enable: !0,
      face: he.BACK
    }, i.depth = {
      enable: !0
    }, i.blend = void 0, i.entity = void 0, i.type = void 0, Object.assign(qr(i), n), i;
  }
  return Wt(e, [{
    key: "setDefines",
    value: function(i) {
      return this.defines = EC(EC({}, this.defines), i), this;
    }
  }, {
    key: "setCull",
    value: function(i) {
      return this.cull = i, this;
    }
  }, {
    key: "setDepth",
    value: function(i) {
      return this.depth = i, this;
    }
  }, {
    key: "setBlend",
    value: function(i) {
      return this.blend = i, this;
    }
  }, {
    key: "setUniform",
    value: function(i, a) {
      var o = this;
      if (typeof i != "string")
        return Object.keys(i).forEach(function(u) {
          return o.setUniform(u, i[u]);
        }), this;
      var s = this.uniforms.find(function(u) {
        return u.name === i;
      });
      return s ? (s.dirty = !0, s.data = a) : this.uniforms.push({
        name: i,
        dirty: !0,
        data: a
      }), this.dirty = !0, this;
    }
  }]), e;
}(Du), SC, MC, CC, TC, AC, Rl, IC, PC, OC, DC;
function kC(r, t) {
  var e = Object.keys(r);
  if (Object.getOwnPropertySymbols) {
    var n = Object.getOwnPropertySymbols(r);
    t && (n = n.filter(function(i) {
      return Object.getOwnPropertyDescriptor(r, i).enumerable;
    })), e.push.apply(e, n);
  }
  return e;
}
function LC(r) {
  for (var t = 1; t < arguments.length; t++) {
    var e = arguments[t] != null ? arguments[t] : {};
    t % 2 ? kC(Object(e), !0).forEach(function(n) {
      Ae(r, n, e[n]);
    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(r, Object.getOwnPropertyDescriptors(e)) : kC(Object(e)).forEach(function(n) {
      Object.defineProperty(r, n, Object.getOwnPropertyDescriptor(e, n));
    });
  }
  return r;
}
var ile = (SC = Mr(), MC = Ut(Ge.MaterialComponentManager), CC = Ut(Ge.RenderEngine), TC = Ut(Ge.ShaderModuleService), SC(AC = (Rl = (DC = /* @__PURE__ */ function() {
  function r() {
    Pt(this, r), Ft(this, "material", IC, this), Ft(this, "engine", PC, this), Ft(this, "shaderModule", OC, this);
  }
  return Wt(r, [{
    key: "execute",
    value: function() {
      var t = Er(/* @__PURE__ */ St.mark(function n() {
        return St.wrap(function(a) {
          for (; ; )
            switch (a.prev = a.next) {
              case 0:
              case "end":
                return a.stop();
            }
        }, n);
      }));
      function e() {
        return t.apply(this, arguments);
      }
      return e;
    }()
  }, {
    key: "tearDown",
    value: function() {
      this.material.clear();
    }
  }, {
    key: "createShaderMaterial",
    value: function(e) {
      var n = Na(), i = e.vertexShader, a = e.fragmentShader, o = [];
      if (!this.engine.supportWebGPU) {
        var s = "material-".concat(n);
        this.shaderModule.registerModule(s, {
          vs: e.vertexShader,
          fs: e.fragmentShader
        });
        var u = this.shaderModule.getModule(s);
        i = u.vs, a = u.fs, u.uniforms && (o = Object.keys(u.uniforms).map(function(f) {
          return {
            dirty: !0,
            name: f,
            data: u.uniforms[f]
          };
        }));
      }
      return this.material.create(n, LC(LC({
        vertexShaderGLSL: i,
        fragmentShaderGLSL: a
      }, e), {}, {
        uniforms: o
      }));
    }
  }]), r;
}(), DC), IC = zt(Rl.prototype, "material", [MC], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), PC = zt(Rl.prototype, "engine", [CC], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), OC = zt(Rl.prototype, "shaderModule", [TC], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), Rl)) || AC);
function ale(r) {
  var t = ole();
  return function() {
    var n = Sr(r), i;
    if (t) {
      var a = Sr(this).constructor;
      i = Reflect.construct(n, arguments, a);
    } else
      i = n.apply(this, arguments);
    return Kn(this, i);
  };
}
function ole() {
  if (typeof Reflect > "u" || !Reflect.construct || Reflect.construct.sham)
    return !1;
  if (typeof Proxy == "function")
    return !0;
  try {
    return Date.prototype.toString.call(Reflect.construct(Date, [], function() {
    })), !0;
  } catch {
    return !1;
  }
}
var m1;
(function(r) {
  r[r.Standard = 0] = "Standard";
})(m1 || (m1 = {}));
var sle = /* @__PURE__ */ function(r) {
  Hn(e, r);
  var t = ale(e);
  function e(n) {
    var i;
    return Pt(this, e), i = t.call(this, n), i.strategy = m1.Standard, i.visibilityPlaneMask = 0, i.visible = !1, Object.assign(qr(i), n), i;
  }
  return e;
}(Du), Xx = /* @__PURE__ */ function() {
  function r(t, e) {
    Pt(this, r), this.center = void 0, this.halfExtents = void 0, this.min = Tr(), this.max = Tr(), this.update(t, e);
  }
  return Wt(r, [{
    key: "update",
    value: function(e, n) {
      this.center = e || Tr(), this.halfExtents = n || rr(0.5, 0.5, 0.5), this.min = zv(this.min, this.center, this.halfExtents), this.max = Ia(this.max, this.center, this.halfExtents);
    }
  }, {
    key: "setMinMax",
    value: function(e, n) {
      Ia(this.center, n, e), Gf(this.center, this.center, 0.5), zv(this.halfExtents, n, e), Gf(this.halfExtents, this.halfExtents, 0.5), Ln(this.min, e), Ln(this.max, n);
    }
  }, {
    key: "getMin",
    value: function() {
      return this.min;
    }
  }, {
    key: "getMax",
    value: function() {
      return this.max;
    }
  }, {
    key: "add",
    value: function(e) {
      var n = this.center, i = n[0], a = n[1], o = n[2], s = this.halfExtents, u = s[0], f = s[1], l = s[2], c = i - u, h = i + u, d = a - f, v = a + f, p = o - l, g = o + l, y = e.center, b = y[0], m = y[1], x = y[2], _ = e.halfExtents, w = _[0], E = _[1], M = _[2], C = b - w, S = b + w, A = m - E, T = m + E, P = x - M, k = x + M;
      C < c && (c = C), S > h && (h = S), A < d && (d = A), T > v && (v = T), P < p && (p = P), k > g && (g = k), n[0] = (c + h) * 0.5, n[1] = (d + v) * 0.5, n[2] = (p + g) * 0.5, s[0] = (h - c) * 0.5, s[1] = (v - d) * 0.5, s[2] = (g - p) * 0.5, this.min[0] = c, this.min[1] = d, this.min[2] = p, this.max[0] = h, this.max[1] = v, this.max[2] = g;
    }
  }, {
    key: "intersects",
    value: function(e) {
      var n = this.getMax(), i = this.getMin(), a = e.getMax(), o = e.getMin();
      return i[0] <= a[0] && n[0] >= o[0] && i[1] <= a[1] && n[1] >= o[1] && i[2] <= a[2] && n[2] >= o[2];
    }
  }, {
    key: "containsPoint",
    value: function(e) {
      var n = this.getMin(), i = this.getMax();
      return !(e[0] < n[0] || e[0] > i[0] || e[1] < n[1] || e[1] > i[1] || e[2] < n[2] || e[2] > i[2]);
    }
  }, {
    key: "getNegativeFarPoint",
    value: function(e) {
      return e.pnVertexFlag === 273 ? Ln(Tr(), this.min) : e.pnVertexFlag === 272 ? rr(this.min[0], this.min[1], this.max[2]) : e.pnVertexFlag === 257 ? rr(this.min[0], this.max[1], this.min[2]) : e.pnVertexFlag === 256 ? rr(this.min[0], this.max[1], this.max[2]) : e.pnVertexFlag === 17 ? rr(this.max[0], this.min[1], this.min[2]) : e.pnVertexFlag === 16 ? rr(this.max[0], this.min[1], this.max[2]) : e.pnVertexFlag === 1 ? rr(this.max[0], this.max[1], this.min[2]) : rr(this.max[0], this.max[1], this.max[2]);
    }
  }, {
    key: "getPositiveFarPoint",
    value: function(e) {
      return e.pnVertexFlag === 273 ? Ln(Tr(), this.max) : e.pnVertexFlag === 272 ? rr(this.max[0], this.max[1], this.min[2]) : e.pnVertexFlag === 257 ? rr(this.max[0], this.min[1], this.max[2]) : e.pnVertexFlag === 256 ? rr(this.max[0], this.min[1], this.min[2]) : e.pnVertexFlag === 17 ? rr(this.min[0], this.max[1], this.max[2]) : e.pnVertexFlag === 16 ? rr(this.min[0], this.max[1], this.min[2]) : e.pnVertexFlag === 1 ? rr(this.min[0], this.min[1], this.max[2]) : rr(this.min[0], this.min[1], this.min[2]);
    }
  }]), r;
}();
function ule(r) {
  var t = fle();
  return function() {
    var n = Sr(r), i;
    if (t) {
      var a = Sr(this).constructor;
      i = Reflect.construct(n, arguments, a);
    } else
      i = n.apply(this, arguments);
    return Kn(this, i);
  };
}
function fle() {
  if (typeof Reflect > "u" || !Reflect.construct || Reflect.construct.sham)
    return !1;
  if (typeof Proxy == "function")
    return !0;
  try {
    return Date.prototype.toString.call(Reflect.construct(Date, [], function() {
    })), !0;
  } catch {
    return !1;
  }
}
var lle = /* @__PURE__ */ function(r) {
  Hn(e, r);
  var t = ule(e);
  function e(n) {
    var i;
    return Pt(this, e), i = t.call(this, n), i.material = void 0, i.geometry = void 0, i.aabb = new Xx(), i.aabbDirty = !0, i.model = void 0, i.visible = !0, i.children = [], Object.assign(qr(i), n), i;
  }
  return e;
}(Du), cle = /* @__PURE__ */ function() {
  function r(t, e) {
    Pt(this, r), this.distance = void 0, this.normal = void 0, this.pnVertexFlag = void 0, this.distance = t || 0, this.normal = e || rr(0, 1, 0), this.updatePNVertexFlag();
  }
  return Wt(r, [{
    key: "updatePNVertexFlag",
    value: function() {
      this.pnVertexFlag = (Number(this.normal[0] >= 0) << 8) + (Number(this.normal[1] >= 0) << 4) + Number(this.normal[2] >= 0);
    }
  }, {
    key: "distanceToPoint",
    value: function(e) {
      return Ff(e, this.normal) - this.distance;
    }
  }, {
    key: "normalize",
    value: function() {
      var e = 1 / Q1(this.normal);
      Gf(this.normal, this.normal, e), this.distance *= e;
    }
  }, {
    key: "intersectsLine",
    value: function(e, n, i) {
      var a = this.distanceToPoint(e), o = this.distanceToPoint(n), s = a / (a - o), u = s >= 0 && s <= 1;
      return u && i && cs(i, e, n, s), u;
    }
  }]), r;
}(), es;
(function(r) {
  r[r.OUTSIDE = 4294967295] = "OUTSIDE", r[r.INSIDE = 0] = "INSIDE", r[r.INDETERMINATE = 2147483647] = "INDETERMINATE";
})(es || (es = {}));
var hle = /* @__PURE__ */ function() {
  function r(t) {
    if (Pt(this, r), this.planes = [], t)
      this.planes = t;
    else
      for (var e = 0; e < 6; e++)
        this.planes.push(new cle());
  }
  return Wt(r, [{
    key: "extractFromVPMatrix",
    value: function(e) {
      var n = xg(e, 16), i = n[0], a = n[1], o = n[2], s = n[3], u = n[4], f = n[5], l = n[6], c = n[7], h = n[8], d = n[9], v = n[10], p = n[11], g = n[12], y = n[13], b = n[14], m = n[15];
      Hs(this.planes[0].normal, s - i, c - u, p - h), this.planes[0].distance = -(m - g), Hs(this.planes[1].normal, s + i, c + u, p + h), this.planes[1].distance = -(m + g), Hs(this.planes[2].normal, s + a, c + f, p + d), this.planes[2].distance = -(m + y), Hs(this.planes[3].normal, s - a, c - f, p - d), this.planes[3].distance = -(m - y), Hs(this.planes[4].normal, s - o, c - l, p - v), this.planes[4].distance = -(m - b), Hs(this.planes[5].normal, s + o, c + l, p + v), this.planes[5].distance = -(m + b), this.planes.forEach(function(x) {
        x.normalize(), x.updatePNVertexFlag();
      });
    }
  }]), r;
}();
function dle(r, t) {
  return t[0] = r[0], t[1] = r[1], t[2] = r[2], t[3] = r[4], t[4] = r[5], t[5] = r[6], t[6] = r[8], t[7] = r[9], t[8] = r[10], t;
}
function vle(r) {
  var t = xg(r, 3), e = t[0], n = t[1], i = t[2], a = e + n * 256 + i * 65536 - 1;
  return a;
}
var NC, RC, BC, GC, FC, zC, UC, js, jC, $C, WC, VC, XC, YC;
function HC(r, t) {
  var e;
  if (typeof Symbol > "u" || r[Symbol.iterator] == null) {
    if (Array.isArray(r) || (e = ple(r)) || t && r && typeof r.length == "number") {
      e && (r = e);
      var n = 0, i = function() {
      };
      return { s: i, n: function() {
        return n >= r.length ? { done: !0 } : { done: !1, value: r[n++] };
      }, e: function(f) {
        throw f;
      }, f: i };
    }
    throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`);
  }
  var a = !0, o = !1, s;
  return { s: function() {
    e = r[Symbol.iterator]();
  }, n: function() {
    var f = e.next();
    return a = f.done, f;
  }, e: function(f) {
    o = !0, s = f;
  }, f: function() {
    try {
      !a && e.return != null && e.return();
    } finally {
      if (o)
        throw s;
    }
  } };
}
function ple(r, t) {
  if (!!r) {
    if (typeof r == "string")
      return KC(r, t);
    var e = Object.prototype.toString.call(r).slice(8, -1);
    if (e === "Object" && r.constructor && (e = r.constructor.name), e === "Map" || e === "Set")
      return Array.from(r);
    if (e === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))
      return KC(r, t);
  }
}
function KC(r, t) {
  (t == null || t > r.length) && (t = r.length);
  for (var e = 0, n = new Array(t); e < t; e++)
    n[e] = r[e];
  return n;
}
var gle = (NC = Mr(), RC = Ut(Ge.MeshComponentManager), BC = Ut(Ge.CullableComponentManager), GC = Ut(Ge.GeometryComponentManager), FC = Ut(Ge.HierarchyComponentManager), zC = Ut(Ge.TransformComponentManager), NC(UC = (js = (YC = /* @__PURE__ */ function() {
  function r() {
    Pt(this, r), Ft(this, "mesh", jC, this), Ft(this, "cullable", $C, this), Ft(this, "geometry", WC, this), Ft(this, "hierarchy", VC, this), Ft(this, "transform", XC, this), this.planes = void 0;
  }
  return Wt(r, [{
    key: "setFrustumPlanes",
    value: function(e) {
      this.planes = e;
    }
  }, {
    key: "execute",
    value: function() {
      var t = Er(/* @__PURE__ */ St.mark(function n(i) {
        var a, o, s, u, f, l, c, h, d, v, p, g, y, b, m, x, _, w, E, M, C;
        return St.wrap(function(A) {
          for (; ; )
            switch (A.prev = A.next) {
              case 0:
                a = HC(i);
                try {
                  for (a.s(); !(o = a.n()).done; ) {
                    s = o.value, u = s.getScene(), f = s.getCamera(), l = HC(u.getEntities());
                    try {
                      for (l.s(); !(c = l.n()).done; )
                        h = c.value, d = this.mesh.getComponentByEntity(h), d && (v = this.hierarchy.getComponentByEntity(h), p = this.cullable.getComponentByEntity(h), g = d.geometry, y = this.transform.getComponentByEntity(h), g && g.aabb && y && d.aabbDirty && (b = y.worldTransform, m = g.aabb, x = m.center, _ = m.halfExtents, w = Dp(Tr(), x, b), E = dle(b, tl()), M = Mu(Tr(), _, E), d.aabb.update(w, M), d.aabbDirty = !1), p && g && (C = this.cullable.getComponentByEntity((v == null ? void 0 : v.parentID) || -1), p.visibilityPlaneMask = this.computeVisibilityWithPlaneMask(d.aabb, (C == null ? void 0 : C.visibilityPlaneMask) || es.INDETERMINATE, this.planes || f.getFrustum().planes), p.visible = p.visibilityPlaneMask !== es.OUTSIDE));
                    } catch (T) {
                      l.e(T);
                    } finally {
                      l.f();
                    }
                  }
                } catch (T) {
                  a.e(T);
                } finally {
                  a.f();
                }
              case 2:
              case "end":
                return A.stop();
            }
        }, n, this);
      }));
      function e(n) {
        return t.apply(this, arguments);
      }
      return e;
    }()
  }, {
    key: "tearDown",
    value: function() {
      this.cullable.clear(), this.mesh.clear();
    }
  }, {
    key: "computeVisibilityWithPlaneMask",
    value: function(e, n, i) {
      if (n === es.OUTSIDE || n === es.INSIDE)
        return n;
      for (var a = es.INSIDE, o = 0, s = i.length; o < s; ++o) {
        var u = o < 31 ? 1 << o : 0;
        if (!(o < 31 && (n & u) === 0)) {
          var f = i[o], l = f.normal, c = f.distance;
          if (Ff(l, e.getNegativeFarPoint(i[o])) + c > 0)
            return es.OUTSIDE;
          Ff(l, e.getPositiveFarPoint(i[o])) + c > 0 && (a |= u);
        }
      }
      return a;
    }
  }]), r;
}(), YC), jC = zt(js.prototype, "mesh", [RC], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), $C = zt(js.prototype, "cullable", [BC], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), WC = zt(js.prototype, "geometry", [GC], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), VC = zt(js.prototype, "hierarchy", [FC], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), XC = zt(js.prototype, "transform", [zC], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), js)) || UC), qC, ZC, QC, JC, eT, tT, rT, nT, iT, aT, oT, sT, qi, uT, fT, lT, cT, hT, dT, vT, pT, gT, yT, mT;
function Fd(r, t) {
  var e;
  if (typeof Symbol > "u" || r[Symbol.iterator] == null) {
    if (Array.isArray(r) || (e = yle(r)) || t && r && typeof r.length == "number") {
      e && (r = e);
      var n = 0, i = function() {
      };
      return { s: i, n: function() {
        return n >= r.length ? { done: !0 } : { done: !1, value: r[n++] };
      }, e: function(f) {
        throw f;
      }, f: i };
    }
    throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`);
  }
  var a = !0, o = !1, s;
  return { s: function() {
    e = r[Symbol.iterator]();
  }, n: function() {
    var f = e.next();
    return a = f.done, f;
  }, e: function(f) {
    o = !0, s = f;
  }, f: function() {
    try {
      !a && e.return != null && e.return();
    } finally {
      if (o)
        throw s;
    }
  } };
}
function yle(r, t) {
  if (!!r) {
    if (typeof r == "string")
      return bT(r, t);
    var e = Object.prototype.toString.call(r).slice(8, -1);
    if (e === "Object" && r.constructor && (e = r.constructor.name), e === "Map" || e === "Set")
      return Array.from(r);
    if (e === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))
      return bT(r, t);
  }
}
function bT(r, t) {
  (t == null || t > r.length) && (t = r.length);
  for (var e = 0, n = new Array(t); e < t; e++)
    n[e] = r[e];
  return n;
}
var Jf = (qC = Mr(), ZC = Ut(Ge.MeshComponentManager), QC = Ut(Ge.GeometryComponentManager), JC = Ut(Ge.MaterialComponentManager), eT = Ut(Ge.CullableComponentManager), tT = Ut(Ge.TransformComponentManager), rT = Ut(Ge.HierarchyComponentManager), nT = Ut(Ge.Systems), iT = $a(Ge.FrameGraphSystem), aT = Ut(Ge.RenderEngine), oT = Ut(Ge.ResourcePool), qC(sT = (qi = (mT = yT = /* @__PURE__ */ function() {
  function r() {
    var t = this;
    Pt(this, r), Ft(this, "mesh", uT, this), Ft(this, "geometry", fT, this), Ft(this, "material", lT, this), Ft(this, "cullable", cT, this), Ft(this, "transform", hT, this), Ft(this, "hierarchy", dT, this), Ft(this, "frameGraphSystem", vT, this), Ft(this, "engine", pT, this), Ft(this, "resourcePool", gT, this), this.modelCache = {}, this.setup = function(e, n, i) {
      var a = e.createRenderTarget(n, "color buffer", {
        width: 1,
        height: 1,
        usage: he.RENDER_ATTACHMENT | he.SAMPLED | he.COPY_SRC
      });
      i.data = {
        output: n.write(e, a)
      };
    }, this.execute = /* @__PURE__ */ function() {
      var e = Er(/* @__PURE__ */ St.mark(function n(i, a, o) {
        var s, u, f, l, c, h;
        return St.wrap(function(v) {
          for (; ; )
            switch (v.prev = v.next) {
              case 0:
                s = i.getResourceNode(a.data.output), u = t.resourcePool.getOrCreateResource(s.resource), f = Fd(o), v.prev = 3, f.s();
              case 5:
                if ((l = f.n()).done) {
                  v.next = 11;
                  break;
                }
                return c = l.value, v.next = 9, t.initView(c);
              case 9:
                v.next = 5;
                break;
              case 11:
                v.next = 16;
                break;
              case 13:
                v.prev = 13, v.t0 = v.catch(3), f.e(v.t0);
              case 16:
                return v.prev = 16, f.f(), v.finish(16);
              case 19:
                h = t.engine.getCanvas(), u.resize({
                  width: h.width,
                  height: h.height
                }), t.engine.setScissor({
                  enable: !1
                }), t.engine.clear({
                  framebuffer: u,
                  color: o[0].getClearColor(),
                  depth: 1
                }), t.engine.useFramebuffer(u, function() {
                  var p = Fd(o), g;
                  try {
                    for (p.s(); !(g = p.n()).done; ) {
                      var y = g.value;
                      t.renderView(y);
                    }
                  } catch (b) {
                    p.e(b);
                  } finally {
                    p.f();
                  }
                });
              case 24:
              case "end":
                return v.stop();
            }
        }, n, null, [[3, 13, 16, 19]]);
      }));
      return function(n, i, a) {
        return e.apply(this, arguments);
      };
    }();
  }
  return Wt(r, [{
    key: "renderView",
    value: function(e) {
      var n = e.getScene(), i = e.getCamera(), a = i.getViewTransform(), o = wo(Jn(), i.getPerspective(), a);
      i.getFrustum().extractFromVPMatrix(o);
      var s = e.getViewport(), u = s.x, f = s.y, l = s.width, c = s.height;
      this.engine.viewport({
        x: u,
        y: f,
        width: l,
        height: c
      });
      var h = Fd(n.getEntities()), d;
      try {
        for (h.s(); !(d = h.n()).done; ) {
          var v = d.value;
          this.renderMesh(v, {
            camera: i,
            view: e,
            viewMatrix: a
          });
        }
      } catch (p) {
        h.e(p);
      } finally {
        h.f();
      }
    }
  }, {
    key: "renderMesh",
    value: function(e, n) {
      var i = n.camera, a = n.view, o = n.viewMatrix, s = this.mesh.getComponentByEntity(e);
      if (!(!s || !s.visible)) {
        var u = s.material, f = s.geometry;
        if (!(!f || f.dirty || !u)) {
          var l = this.transform.getComponentByEntity(e), c = wo(Jn(), o, l.worldTransform), h = a.getViewport(), d = h.width, v = h.height;
          u.setUniform({
            projectionMatrix: i.getPerspective(),
            modelViewMatrix: c,
            modelMatrix: l.worldTransform,
            viewMatrix: o,
            cameraPosition: i.getPosition(),
            u_viewport: [d, v]
          }), s.model && (s.model.draw({
            uniforms: u.uniforms.reduce(function(p, g) {
              return p[g.name] = g.data, p;
            }, {})
          }), u.uniforms.forEach(function(p) {
            p.dirty = !1;
          }), u.dirty = !1);
        }
      }
    }
  }, {
    key: "initMesh",
    value: function() {
      var t = Er(/* @__PURE__ */ St.mark(function n(i, a) {
        var o, s, u, f, l, c, h, d;
        return St.wrap(function(p) {
          for (; ; )
            switch (p.prev = p.next) {
              case 0:
                if (o = this.mesh.getComponentByEntity(i), o) {
                  p.next = 3;
                  break;
                }
                return p.abrupt("return");
              case 3:
                if (s = o.material, u = o.geometry, !(!u || u.dirty || !s)) {
                  p.next = 7;
                  break;
                }
                return p.abrupt("return");
              case 7:
                if (o.model) {
                  p.next = 24;
                  break;
                }
                if (f = "m-".concat(s.entity, "-g-").concat(u.entity), !this.modelCache[f]) {
                  p.next = 12;
                  break;
                }
                return o.model = this.modelCache[f], p.abrupt("return");
              case 12:
                return s.setUniform({
                  projectionMatrix: 1,
                  modelViewMatrix: 1,
                  modelMatrix: 1,
                  viewMatrix: 1,
                  cameraPosition: 1,
                  u_viewport: 1
                }), l = this.engine, c = l.createModel, h = l.createAttribute, d = {
                  vs: s.vertexShaderGLSL,
                  fs: s.fragmentShaderGLSL,
                  defines: s.defines,
                  attributes: u.attributes.reduce(function(g, y) {
                    return y.data && y.buffer && (g[y.name] = h({
                      buffer: y.buffer,
                      attributes: y.attributes,
                      arrayStride: y.arrayStride,
                      stepMode: y.stepMode,
                      divisor: y.stepMode === "vertex" ? 0 : 1
                    })), g;
                  }, {}),
                  uniforms: s.uniforms.reduce(function(g, y) {
                    return g[y.name] = y.data, g;
                  }, {}),
                  scissor: {
                    enable: !0,
                    box: function() {
                      return a.getViewport();
                    }
                  }
                }, s.cull && (d.cull = s.cull), s.depth && (d.depth = s.depth), s.blend && (d.blend = s.blend), u.indicesBuffer && (d.elements = u.indicesBuffer), u.maxInstancedCount && (d.instances = u.maxInstancedCount, d.count = u.vertexCount || 3), p.next = 22, c(d);
              case 22:
                o.model = p.sent, this.modelCache[f] = o.model;
              case 24:
              case "end":
                return p.stop();
            }
        }, n, this);
      }));
      function e(n, i) {
        return t.apply(this, arguments);
      }
      return e;
    }()
  }, {
    key: "initView",
    value: function() {
      var t = Er(/* @__PURE__ */ St.mark(function n(i) {
        var a, o, s, u;
        return St.wrap(function(l) {
          for (; ; )
            switch (l.prev = l.next) {
              case 0:
                a = i.getScene(), o = Fd(a.getEntities()), l.prev = 2, o.s();
              case 4:
                if ((s = o.n()).done) {
                  l.next = 10;
                  break;
                }
                return u = s.value, l.next = 8, this.initMesh(u, i);
              case 8:
                l.next = 4;
                break;
              case 10:
                l.next = 15;
                break;
              case 12:
                l.prev = 12, l.t0 = l.catch(2), o.e(l.t0);
              case 15:
                return l.prev = 15, o.f(), l.finish(15);
              case 18:
              case "end":
                return l.stop();
            }
        }, n, this, [[2, 12, 15, 18]]);
      }));
      function e(n) {
        return t.apply(this, arguments);
      }
      return e;
    }()
  }]), r;
}(), yT.IDENTIFIER = "Render Pass", mT), uT = zt(qi.prototype, "mesh", [ZC], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), fT = zt(qi.prototype, "geometry", [QC], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), lT = zt(qi.prototype, "material", [JC], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), cT = zt(qi.prototype, "cullable", [eT], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), hT = zt(qi.prototype, "transform", [tT], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), dT = zt(qi.prototype, "hierarchy", [rT], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), vT = zt(qi.prototype, "frameGraphSystem", [nT, iT], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), pT = zt(qi.prototype, "engine", [aT], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), gT = zt(qi.prototype, "resourcePool", [oT], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), qi)) || sT), xT, _T, wT, ET, ST, MT, nf, CT, TT, AT, IT, PT, OT;
function Iy(r, t) {
  var e;
  if (typeof Symbol > "u" || r[Symbol.iterator] == null) {
    if (Array.isArray(r) || (e = mle(r)) || t && r && typeof r.length == "number") {
      e && (r = e);
      var n = 0, i = function() {
      };
      return { s: i, n: function() {
        return n >= r.length ? { done: !0 } : { done: !1, value: r[n++] };
      }, e: function(f) {
        throw f;
      }, f: i };
    }
    throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`);
  }
  var a = !0, o = !1, s;
  return { s: function() {
    e = r[Symbol.iterator]();
  }, n: function() {
    var f = e.next();
    return a = f.done, f;
  }, e: function(f) {
    o = !0, s = f;
  }, f: function() {
    try {
      !a && e.return != null && e.return();
    } finally {
      if (o)
        throw s;
    }
  } };
}
function mle(r, t) {
  if (!!r) {
    if (typeof r == "string")
      return DT(r, t);
    var e = Object.prototype.toString.call(r).slice(8, -1);
    if (e === "Object" && r.constructor && (e = r.constructor.name), e === "Map" || e === "Set")
      return Array.from(r);
    if (e === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))
      return DT(r, t);
  }
}
function DT(r, t) {
  (t == null || t > r.length) && (t = r.length);
  for (var e = 0, n = new Array(t); e < t; e++)
    n[e] = r[e];
  return n;
}
var Py = {
  NONE: 0,
  ENCODE: 1,
  HIGHLIGHT: 2
}, b1 = (xT = Mr(), _T = Ut(Ge.RenderEngine), wT = Ut(Ge.ResourcePool), ET = Ut(Ge.RenderPassFactory), ST = Ut(Ge.MeshComponentManager), xT(MT = (nf = (OT = PT = /* @__PURE__ */ function() {
  function r() {
    var t = this;
    Pt(this, r), Ft(this, "engine", CT, this), Ft(this, "resourcePool", TT, this), Ft(this, "renderPassFactory", AT, this), Ft(this, "mesh", IT, this), this.pickingFBO = void 0, this.views = void 0, this.highlightEnabled = !0, this.highlightColor = [255, 0, 0, 255], this.alreadyInRendering = !1, this.setup = function(e, n, i) {
      var a = e.createRenderTarget(n, "picking fbo", {
        width: 1,
        height: 1
      });
      i.data = {
        output: n.write(e, a)
      }, n.hasSideEffect = !0;
    }, this.execute = /* @__PURE__ */ function() {
      var e = Er(/* @__PURE__ */ St.mark(function n(i, a, o) {
        var s, u, f;
        return St.wrap(function(c) {
          for (; ; )
            switch (c.prev = c.next) {
              case 0:
                if (t.views = o, !t.alreadyInRendering) {
                  c.next = 3;
                  break;
                }
                return c.abrupt("return");
              case 3:
                s = Iy(o);
                try {
                  for (f = function() {
                    var d = u.value, v = d.getViewport(), p = v.width, g = v.height;
                    t.alreadyInRendering = !0;
                    var y = i.getResourceNode(a.data.output);
                    t.pickingFBO = t.resourcePool.getOrCreateResource(y.resource), t.pickingFBO.resize({
                      width: p,
                      height: g
                    }), t.engine.useFramebuffer(t.pickingFBO, function() {
                      t.engine.clear({
                        framebuffer: t.pickingFBO,
                        color: [0, 0, 0, 0],
                        stencil: 0,
                        depth: 1
                      });
                      var b = t.renderPassFactory(Jf.IDENTIFIER), m = [], x = d.getScene(), _ = Iy(x.getEntities()), w;
                      try {
                        for (_.s(); !(w = _.n()).done; ) {
                          var E = w.value, M = t.mesh.getComponentByEntity(E), C = M.material;
                          C.setUniform("u_PickingStage", Py.ENCODE), m.push(M);
                        }
                      } catch (S) {
                        _.e(S);
                      } finally {
                        _.f();
                      }
                      b.renderView(d), m.forEach(function(S) {
                        var A = S.material;
                        A.setUniform("u_PickingStage", Py.HIGHLIGHT);
                      }), t.alreadyInRendering = !1;
                    });
                  }, s.s(); !(u = s.n()).done; )
                    f();
                } catch (h) {
                  s.e(h);
                } finally {
                  s.f();
                }
              case 5:
              case "end":
                return c.stop();
            }
        }, n);
      }));
      return function(n, i, a) {
        return e.apply(this, arguments);
      };
    }(), this.pick = function(e, n) {
      var i = e.x, a = e.y, o = t.engine, s = o.readPixels, u = o.useFramebuffer, f = n.getViewport(), l = f.width, c = f.height, h = i * window.devicePixelRatio, d = a * window.devicePixelRatio;
      if (!(h > l || h < 0 || d > c || d < 0)) {
        var v, p;
        return u(t.pickingFBO, function() {
          v = s({
            x: Math.round(h),
            y: Math.round(c - (a + 1) * window.devicePixelRatio),
            width: 1,
            height: 1,
            data: new Uint8Array(1 * 1 * 4),
            framebuffer: t.pickingFBO
          }), (v[0] !== 0 || v[1] !== 0 || v[2] !== 0) && (p = vle(v), t.highlightEnabled && t.highlightPickedFeature(v, n));
        }), p;
      }
    };
  }
  return Wt(r, [{
    key: "enableHighlight",
    value: function(e) {
      this.highlightEnabled = e;
    }
  }, {
    key: "setHighlightColor",
    value: function(e) {
      this.highlightColor = e;
    }
  }, {
    key: "highlightPickedFeature",
    value: function(e, n) {
      if (e) {
        var i = Iy(n.getScene().getEntities()), a;
        try {
          for (i.s(); !(a = i.n()).done; ) {
            var o = a.value, s = this.mesh.getComponentByEntity(o), u = s.material;
            u.setUniform("u_PickingStage", Py.HIGHLIGHT), u.setUniform("u_PickingColor", [e[0], e[1], e[2]]), u.setUniform("u_HighlightColor", this.highlightColor);
          }
        } catch (f) {
          i.e(f);
        } finally {
          i.f();
        }
      }
    }
  }]), r;
}(), PT.IDENTIFIER = "PixelPicking Pass", OT), CT = zt(nf.prototype, "engine", [_T], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), TT = zt(nf.prototype, "resourcePool", [wT], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), AT = zt(nf.prototype, "renderPassFactory", [ET], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), IT = zt(nf.prototype, "mesh", [ST], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), nf)) || MT), kT, LT, NT, RT, zd, BT, GT, FT, zT, ble = `varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`, xle = `attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`, _le = `layout(set = 0, binding = 0) uniform sampler u_TextureSampler;
layout(set = 0, binding = 1) uniform texture2D u_Texture;

layout(location = 0) in vec2 v_UV;
layout(location = 0) out vec4 outColor;

void main() {
  outColor = texture(sampler2D(u_Texture, u_TextureSampler), v_UV);
}`, wle = `layout(location = 0) in vec2 a_Position;
layout(location = 0) out vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`, mp = (kT = Mr(), LT = Ut(Ge.RenderEngine), NT = Ut(Ge.ResourcePool), kT(RT = (zd = (zT = FT = function r() {
  var t = this;
  Pt(this, r), Ft(this, "engine", BT, this), Ft(this, "resourcePool", GT, this), this.model = void 0, this.setup = function(e, n, i) {
    var a = e.getPass(Jf.IDENTIFIER);
    if (a) {
      var o = e.createRenderTarget(n, "render to screen", {
        width: 1,
        height: 1
      });
      i.data = {
        input: n.read(a.data.output),
        output: n.write(e, o)
      };
    }
  }, this.execute = /* @__PURE__ */ function() {
    var e = Er(/* @__PURE__ */ St.mark(function n(i, a) {
      var o, s, u, f, l, c, h;
      return St.wrap(function(v) {
        for (; ; )
          switch (v.prev = v.next) {
            case 0:
              if (o = t.engine, s = o.createModel, u = o.createAttribute, f = o.createBuffer, t.model) {
                v.next = 6;
                break;
              }
              return v.next = 4, s({
                vs: t.engine.supportWebGPU ? wle : xle,
                fs: t.engine.supportWebGPU ? _le : ble,
                attributes: {
                  a_Position: u({
                    buffer: f({
                      data: [-4, -4, 4, -4, 0, 4],
                      type: he.FLOAT
                    }),
                    size: 2,
                    arrayStride: 8,
                    stepMode: "vertex",
                    attributes: [{
                      shaderLocation: 0,
                      offset: 0,
                      format: "float2"
                    }]
                  })
                },
                uniforms: {
                  u_Texture: null
                },
                depth: {
                  enable: !1
                },
                count: 3,
                blend: {
                  enable: !0
                }
              });
            case 4:
              l = v.sent, t.model = l;
            case 6:
              c = i.getResourceNode(a.data.input), h = t.resourcePool.getOrCreateResource(c.resource), t.engine.useFramebuffer(null, function() {
                t.engine.clear({
                  framebuffer: null,
                  color: [0, 0, 0, 0],
                  depth: 1,
                  stencil: 0
                }), t.model.draw({
                  uniforms: {
                    u_Texture: h
                  }
                });
              });
            case 9:
            case "end":
              return v.stop();
          }
      }, n);
    }));
    return function(n, i) {
      return e.apply(this, arguments);
    };
  }(), this.tearDown = function() {
    t.model = void 0;
  };
}, FT.IDENTIFIER = "Copy Pass", zT), BT = zt(zd.prototype, "engine", [LT], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), GT = zt(zd.prototype, "resourcePool", [NT], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), zd)) || RT), UT, jT, $T, WT, VT, XT, YT, af, HT, KT, qT, ZT, QT, Ele = (UT = Mr(), jT = Ut(Ge.Systems), $T = $a(Ge.FrameGraphSystem), WT = Ut(Ge.RenderPassFactory), VT = Ut(Ge.ConfigService), XT = Ut(Ge.ResourcePool), UT(YT = (af = (QT = /* @__PURE__ */ function() {
  function r() {
    Pt(this, r), Ft(this, "frameGraphSystem", HT, this), Ft(this, "renderPassFactory", KT, this), Ft(this, "configService", qT, this), Ft(this, "resourcePool", ZT, this);
  }
  return Wt(r, [{
    key: "execute",
    value: function() {
      var t = Er(/* @__PURE__ */ St.mark(function n(i) {
        var a, o, s, u, f, l, c, h;
        return St.wrap(function(v) {
          for (; ; )
            switch (v.prev = v.next) {
              case 0:
                a = this.renderPassFactory(Jf.IDENTIFIER), o = a.setup, s = a.execute, this.frameGraphSystem.addPass(Jf.IDENTIFIER, o, s), u = this.renderPassFactory(mp.IDENTIFIER), f = u.setup, l = u.execute, c = u.tearDown, h = this.frameGraphSystem.addPass(mp.IDENTIFIER, f, l, c), this.frameGraphSystem.present(h.data.output);
              case 5:
              case "end":
                return v.stop();
            }
        }, n, this);
      }));
      function e(n) {
        return t.apply(this, arguments);
      }
      return e;
    }()
  }, {
    key: "tearDown",
    value: function() {
      this.resourcePool.clean();
    }
  }, {
    key: "pick",
    value: function(e, n) {
      var i = this.renderPassFactory(b1.IDENTIFIER);
      return i.pick(e, n);
    }
  }]), r;
}(), QT), HT = zt(af.prototype, "frameGraphSystem", [jT, $T], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), KT = zt(af.prototype, "renderPassFactory", [WT], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), qT = zt(af.prototype, "configService", [VT], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), ZT = zt(af.prototype, "resourcePool", [XT], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), af)) || YT);
function Sle(r) {
  var t = Mle();
  return function() {
    var n = Sr(r), i;
    if (t) {
      var a = Sr(this).constructor;
      i = Reflect.construct(n, arguments, a);
    } else
      i = n.apply(this, arguments);
    return Kn(this, i);
  };
}
function Mle() {
  if (typeof Reflect > "u" || !Reflect.construct || Reflect.construct.sham)
    return !1;
  if (typeof Proxy == "function")
    return !0;
  try {
    return Date.prototype.toString.call(Reflect.construct(Date, [], function() {
    })), !0;
  } catch {
    return !1;
  }
}
var Cle = /* @__PURE__ */ function(r) {
  Hn(e, r);
  var t = Sle(e);
  function e(n) {
    var i;
    return Pt(this, e), i = t.call(this, n), i.parentID = void 0, Object.assign(qr(i), n), i;
  }
  return e;
}(Du), JT, eA, tA, rA, nA, Bl, iA, aA, oA, sA, Tle = (JT = Mr(), eA = Ut(Ge.HierarchyComponentManager), tA = Ut(Ge.TransformComponentManager), rA = Ut(Ge.MeshComponentManager), JT(nA = (Bl = (sA = /* @__PURE__ */ function() {
  function r() {
    Pt(this, r), Ft(this, "hierarchy", iA, this), Ft(this, "transform", aA, this), Ft(this, "mesh", oA, this);
  }
  return Wt(r, [{
    key: "execute",
    value: function() {
      var t = Er(/* @__PURE__ */ St.mark(function n() {
        return St.wrap(function(a) {
          for (; ; )
            switch (a.prev = a.next) {
              case 0:
                this.runTransformUpdateSystem(), this.runHierarchyUpdateSystem();
              case 2:
              case "end":
                return a.stop();
            }
        }, n, this);
      }));
      function e() {
        return t.apply(this, arguments);
      }
      return e;
    }()
  }, {
    key: "tearDown",
    value: function() {
      this.hierarchy.clear(), this.transform.clear();
    }
  }, {
    key: "getHierarchyComponentManager",
    value: function() {
      return this.hierarchy;
    }
  }, {
    key: "getTransformComponentManager",
    value: function() {
      return this.transform;
    }
  }, {
    key: "runTransformUpdateSystem",
    value: function() {
      var e = this;
      this.transform.forEach(function(n, i) {
        (i.isDirty() || i.isLocalDirty()) && (e.setMeshAABBDirty(e.mesh.getComponentByEntity(n)), i.updateTransform());
      });
    }
  }, {
    key: "runHierarchyUpdateSystem",
    value: function() {
      var e = this;
      this.hierarchy.forEach(function(n, i) {
        var a = e.transform.getComponentByEntity(n), o = e.transform.getComponentByEntity(i.parentID);
        a !== null && o !== null && a.updateTransformWithParent(o);
      });
    }
  }, {
    key: "attach",
    value: function(e, n, i) {
      this.hierarchy.contains(e) && this.detach(e), this.hierarchy.create(e, {
        parentID: n
      });
      var a = this.mesh.getComponentByEntity(n);
      if (this.setMeshAABBDirty(a), a && a.children.indexOf(e) === -1 && a.children.push(e), this.hierarchy.getCount() > 1)
        for (var o = this.hierarchy.getCount() - 1; o > 0; --o)
          for (var s = this.hierarchy.getEntity(o), u = 0; u < o; ++u) {
            var f = this.hierarchy.getComponent(u);
            if (f.parentID === s) {
              this.hierarchy.moveItem(o, u), ++o;
              break;
            }
          }
      this.hierarchy.getComponentByEntity(e);
      var l = this.transform.getComponentByEntity(n);
      l === null && (l = this.transform.create(n));
      var c = this.transform.getComponentByEntity(e);
      c === null && (c = this.transform.create(e), l = this.transform.getComponentByEntity(n)), c.parent = l, !i && l && (c.matrixTransform(Tc(Jn(), l.worldTransform)), c.updateTransform()), l && c.updateTransformWithParent(l);
    }
  }, {
    key: "detach",
    value: function(e) {
      var n = this.hierarchy.getComponentByEntity(e);
      if (n !== null) {
        var i = this.transform.getComponentByEntity(e);
        i !== null && (i.parent = null, i.applyTransform()), this.hierarchy.removeKeepSorted(e);
        var a = this.mesh.getComponentByEntity(n.parentID);
        if (a) {
          var o = a.children.indexOf(e);
          a.children.splice(o, 1);
        }
        this.setMeshAABBDirty(a);
      }
    }
  }, {
    key: "detachChildren",
    value: function(e) {
      var n = this.mesh.getComponentByEntity(e);
      n && (n.children = []);
      for (var i = 0; i < this.hierarchy.getCount(); ) {
        var a;
        if (((a = this.hierarchy.getComponent(i)) === null || a === void 0 ? void 0 : a.parentID) === e) {
          var o = this.hierarchy.getEntity(i);
          this.detach(o);
        } else
          ++i;
      }
    }
  }, {
    key: "setMeshAABBDirty",
    value: function(e) {
      e && (e.aabbDirty = !0);
    }
  }]), r;
}(), sA), iA = zt(Bl.prototype, "hierarchy", [eA], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), aA = zt(Bl.prototype, "transform", [tA], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), oA = zt(Bl.prototype, "mesh", [rA], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), Bl)) || nA);
function Ale(r) {
  var t = Ile();
  return function() {
    var n = Sr(r), i;
    if (t) {
      var a = Sr(this).constructor;
      i = Reflect.construct(n, arguments, a);
    } else
      i = n.apply(this, arguments);
    return Kn(this, i);
  };
}
function Ile() {
  if (typeof Reflect > "u" || !Reflect.construct || Reflect.construct.sham)
    return !1;
  if (typeof Proxy == "function")
    return !0;
  try {
    return Date.prototype.toString.call(Reflect.construct(Date, [], function() {
    })), !0;
  } catch {
    return !1;
  }
}
var p5 = /* @__PURE__ */ function(r) {
  Hn(e, r);
  var t = Ale(e);
  function e(n) {
    var i;
    return Pt(this, e), i = t.call(this, n), i.dirtyFlag = void 0, i.localDirtyFlag = void 0, i.parent = null, i.localPosition = rr(0, 0, 0), i.localRotation = hv(0, 0, 0, 1), i.localScale = rr(1, 1, 1), i.localTransform = Jn(), i.position = rr(0, 0, 0), i.rotation = hv(0, 0, 0, 1), i.scaling = rr(1, 1, 1), i.worldTransform = Jn(), i.matrixTransform = function() {
      var a = Jn();
      return function(o) {
        wo(a, i.getLocalTransform(), o), tu(i.localScale, a), eu(i.localPosition, a), ru(i.localRotation, a);
      };
    }(), i.rotateRollPitchYaw = function() {
      var a = hn(), o = hn(), s = hn();
      return function(u, f, l) {
        i.setDirty(), cv(a, u, 0, 0), cv(o, 0, f, 0), cv(s, 0, 0, l), mi(i.localRotation, a, i.localRotation), mi(i.localRotation, i.localRotation, o), mi(i.localRotation, s, i.localRotation), iu(i.localRotation, i.localRotation);
      };
    }(), i.lerp = function() {
      var a = Tr(), o = hn(), s = Tr(), u = Tr(), f = hn(), l = Tr();
      return function(c, h, d) {
        i.setDirty(), tu(a, c.worldTransform), eu(s, c.worldTransform), ru(o, c.worldTransform), tu(u, h.worldTransform), eu(l, h.worldTransform), ru(f, h.worldTransform), cs(i.localScale, a, u, d), hc(i.localRotation, o, f, d), cs(i.localPosition, s, l, d);
      };
    }(), i.translate = function() {
      var a = Tr();
      return function(o) {
        return Ia(a, i.getPosition(), o), i.setPosition(a), i.setDirty(!0), qr(i);
      };
    }(), i.translateLocal = function() {
      return function(a) {
        return hk(a, a, i.localRotation), Ia(i.localPosition, i.localPosition, a), i.setLocalDirty(!0), qr(i);
      };
    }(), i.setPosition = function() {
      var a = Jn();
      return function(o) {
        return i.position = o, i.setLocalDirty(!0), i.parent === null ? Ln(i.localPosition, o) : (Gv(a, i.parent.worldTransform), Tc(a, a), Dp(i.localPosition, o, a)), qr(i);
      };
    }(), i.rotate = function() {
      var a = hn();
      return function(o) {
        if (i.parent === null)
          mi(i.localRotation, i.localRotation, o), iu(i.localRotation, i.localRotation);
        else {
          var s = i.getRotation(), u = i.parent.getRotation();
          rs(a, u), Zy(a, a), mi(a, a, o), mi(i.localRotation, o, s), iu(i.localRotation, i.localRotation);
        }
        return i.setLocalDirty(), qr(i);
      };
    }(), i.rotateLocal = function() {
      return function(a) {
        return mi(i.localRotation, i.localRotation, a), iu(i.localRotation, i.localRotation), i.setLocalDirty(!0), qr(i);
      };
    }(), i.setRotation = function() {
      var a = hn();
      return function(o) {
        return i.parent === null ? rs(i.localRotation, o) : (rs(a, i.parent.getRotation()), Zy(a, a), rs(i.localRotation, a), Lk(i.localRotation, i.localRotation, o)), i.setLocalDirty(!0), qr(i);
      };
    }(), i;
  }
  return Wt(e, [{
    key: "setLocalPosition",
    value: function(i) {
      Ln(this.localPosition, i), this.setLocalDirty(!0);
    }
  }, {
    key: "setLocalScale",
    value: function(i) {
      Ln(this.localScale, i), this.setLocalDirty(!0);
    }
  }, {
    key: "setLocalRotation",
    value: function(i) {
      return rs(this.localRotation, i), this.setLocalDirty(!0), this;
    }
  }, {
    key: "isDirty",
    value: function() {
      return this.dirtyFlag;
    }
  }, {
    key: "setDirty",
    value: function() {
      var i = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : !0;
      i ? this.dirtyFlag |= e.DIRTY : this.dirtyFlag &= ~e.DIRTY;
    }
  }, {
    key: "isLocalDirty",
    value: function() {
      return this.localDirtyFlag;
    }
  }, {
    key: "setLocalDirty",
    value: function() {
      var i = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : !0;
      i ? (this.localDirtyFlag |= e.DIRTY, this.setDirty(!0)) : this.localDirtyFlag &= ~e.DIRTY;
    }
  }, {
    key: "updateTransform",
    value: function() {
      this.isLocalDirty() && this.getLocalTransform(), this.isDirty() && this.parent === null && (Gv(this.worldTransform, this.getLocalTransform()), this.setDirty(!1));
    }
  }, {
    key: "updateTransformWithParent",
    value: function(i) {
      wo(this.worldTransform, i.worldTransform, this.getLocalTransform());
    }
  }, {
    key: "applyTransform",
    value: function() {
      this.setDirty(), tu(this.localScale, this.worldTransform), eu(this.localPosition, this.worldTransform), ru(this.localRotation, this.worldTransform);
    }
  }, {
    key: "clearTransform",
    value: function() {
      this.setDirty(), this.localPosition = rr(0, 0, 0), this.localRotation = hv(0, 0, 0, 1), this.localScale = rr(1, 1, 1);
    }
  }, {
    key: "scaleLocal",
    value: function(i) {
      return this.setLocalDirty(), Z1(this.localScale, this.localScale, i), this;
    }
  }, {
    key: "getLocalPosition",
    value: function() {
      return this.localPosition;
    }
  }, {
    key: "getLocalRotation",
    value: function() {
      return this.localRotation;
    }
  }, {
    key: "getLocalScale",
    value: function() {
      return this.localScale;
    }
  }, {
    key: "getLocalTransform",
    value: function() {
      return this.localDirtyFlag && (tk(this.localTransform, this.localRotation, this.localPosition, this.localScale), this.setLocalDirty(!1)), this.localTransform;
    }
  }, {
    key: "getWorldTransform",
    value: function() {
      return !this.isLocalDirty() && !this.isDirty() ? this.worldTransform : (this.parent && this.parent.getWorldTransform(), this.updateTransform(), this.worldTransform);
    }
  }, {
    key: "getPosition",
    value: function() {
      return eu(this.position, this.worldTransform), this.position;
    }
  }, {
    key: "getRotation",
    value: function() {
      return ru(this.rotation, this.worldTransform), this.rotation;
    }
  }, {
    key: "getScale",
    value: function() {
      return tu(this.scaling, this.worldTransform), this.scaling;
    }
  }]), e;
}(Du);
p5.DIRTY = 1 << 0;
var uA, fA, lA, Oy, cA, hA, Ple = (uA = Mr(), fA = Ut(Ge.RenderEngine), uA(lA = (Oy = (hA = /* @__PURE__ */ function() {
  function r() {
    Pt(this, r), Ft(this, "engine", cA, this), this.resourcePool = {};
  }
  return Wt(r, [{
    key: "getOrCreateResource",
    value: function(e) {
      if (!this.resourcePool[e.name]) {
        var n = e.descriptor, i = n.width, a = n.height, o = n.usage;
        this.resourcePool[e.name] = this.engine.createFramebuffer({
          color: this.engine.createTexture2D({
            width: i,
            height: a,
            wrapS: he.CLAMP_TO_EDGE,
            wrapT: he.CLAMP_TO_EDGE,
            usage: o
          })
        });
      }
      return this.resourcePool[e.name];
    }
  }, {
    key: "clean",
    value: function() {
      this.resourcePool = {};
    }
  }]), r;
}(), hA), cA = zt(Oy.prototype, "engine", [fA], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), Oy)) || lA);
function Ole(r) {
  var t = Dle();
  return function() {
    var n = Sr(r), i;
    if (t) {
      var a = Sr(this).constructor;
      i = Reflect.construct(n, arguments, a);
    } else
      i = n.apply(this, arguments);
    return Kn(this, i);
  };
}
function Dle() {
  if (typeof Reflect > "u" || !Reflect.construct || Reflect.construct.sham)
    return !1;
  if (typeof Proxy == "function")
    return !0;
  try {
    return Date.prototype.toString.call(Reflect.construct(Date, [], function() {
    })), !0;
  } catch {
    return !1;
  }
}
var kle = /* @__PURE__ */ function(r) {
  Hn(e, r);
  var t = Ole(e);
  function e(n) {
    var i;
    return Pt(this, e), i = t.call(this, n), i.name = void 0, i.name = n.name || "", i;
  }
  return e;
}(Du), dA, vA, pA, Lle = (dA = Mr(), dA(vA = (pA = /* @__PURE__ */ function() {
  function r() {
    Pt(this, r), this.config = void 0;
  }
  return Wt(r, [{
    key: "get",
    value: function() {
      return this.config;
    }
  }, {
    key: "set",
    value: function(e) {
      this.config = e;
    }
  }]), r;
}(), pA)) || vA), gA, yA, mA;
(function(r) {
  r.PANSTART = "PANSTART", r.PANEND = "PANEND", r.PANMOVE = "PANMOVE", r.PINCH = "PINCH", r.KEYDOWN = "KEYDOWN", r.KEYUP = "KEYUP", r.HOVER = "HOVER";
})(mA || (mA = {}));
var Nle = (gA = Mr(), gA(yA = /* @__PURE__ */ function() {
  function r() {
    Pt(this, r);
  }
  return Wt(r, [{
    key: "listen",
    value: function(e) {
    }
  }, {
    key: "on",
    value: function(e, n) {
    }
  }, {
    key: "connect",
    value: function() {
    }
  }, {
    key: "disconnect",
    value: function() {
    }
  }, {
    key: "destroy",
    value: function() {
    }
  }]), r;
}()) || yA);
function Rle(r) {
  var t = 0;
  switch (r) {
    case "vec2":
    case "ivec2":
      t = 2;
      break;
    case "vec3":
    case "ivec3":
      t = 3;
      break;
    case "vec4":
    case "ivec4":
    case "mat2":
      t = 4;
      break;
    case "mat3":
      t = 9;
      break;
    case "mat4":
      t = 16;
      break;
  }
  return t;
}
var Ble = /uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;
function bA(r) {
  var t = {};
  return r = r.replace(Ble, function(e, n, i) {
    var a = i.split(":"), o = a[0].trim(), s = "";
    switch (a.length > 1 && (s = a[1].trim()), n) {
      case "bool":
        s = s === "true";
        break;
      case "float":
      case "int":
        s = Number(s);
        break;
      case "vec2":
      case "vec3":
      case "vec4":
      case "ivec2":
      case "ivec3":
      case "ivec4":
      case "mat2":
      case "mat3":
      case "mat4":
        s ? s = s.replace("[", "").replace("]", "").split(",").reduce(function(u, f) {
          return u.push(Number(f.trim())), u;
        }, []) : s = new Array(Rle(n)).fill(0);
        break;
    }
    return t[o] = s, "uniform ".concat(n, " ").concat(o, `;
`);
  }), {
    content: r,
    uniforms: t
  };
}
function Gle(r) {
  return r.filter(function(t, e, n) {
    return n.indexOf(t) === e;
  });
}
var xA, _A, wA;
function EA(r, t) {
  var e = Object.keys(r);
  if (Object.getOwnPropertySymbols) {
    var n = Object.getOwnPropertySymbols(r);
    t && (n = n.filter(function(i) {
      return Object.getOwnPropertyDescriptor(r, i).enumerable;
    })), e.push.apply(e, n);
  }
  return e;
}
function Gl(r) {
  for (var t = 1; t < arguments.length; t++) {
    var e = arguments[t] != null ? arguments[t] : {};
    t % 2 ? EA(Object(e), !0).forEach(function(n) {
      Ae(r, n, e[n]);
    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(r, Object.getOwnPropertyDescriptors(e)) : EA(Object(e)).forEach(function(n) {
      Object.defineProperty(r, n, Object.getOwnPropertyDescriptor(e, n));
    });
  }
  return r;
}
var Fle = `varying vec4 v_PickingResult;
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;

#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color) {
  bool selected = bool(v_PickingResult.a);

  if (selected) {
    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;

    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));

    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(resultRGB, color.a);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  return filterPickingColor(filterHighlightColor(color));
}
`, zle = `attribute vec3 a_PickingColor;
varying vec4 v_PickingResult;

uniform vec3 u_PickingColor : [0, 0, 0];
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_PickingThreshold : 1.0;
uniform float u_PickingBuffer: 0.0;

#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

bool isVertexPicked(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;
}

void setPickingColor(vec3 pickingColor) {
  // compares only in highlight stage
  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));

  // Stores the picking color so that the fragment shader can render it during picking
  v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}`, Ule = `/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}`, jle = /precision\s+(high|low|medium)p\s+float/, $le = `#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`, Wle = /#pragma include (["^+"]?["\ "[a-zA-Z_0-9](.*)"]*?)/g, Vle = (xA = Mr(), xA(_A = (wA = /* @__PURE__ */ function() {
  function r() {
    Pt(this, r), this.moduleCache = {}, this.rawContentCache = {};
  }
  return Wt(r, [{
    key: "registerBuiltinModules",
    value: function() {
      this.destroy(), this.registerModule("picking", {
        vs: zle,
        fs: Fle
      }), this.registerModule("sdf2d", {
        vs: "",
        fs: Ule
      });
    }
  }, {
    key: "registerModule",
    value: function(e, n) {
      if (!this.rawContentCache[e]) {
        var i = n.vs, a = i === void 0 ? "" : i, o = n.fs, s = o === void 0 ? "" : o, u = n.uniforms, f = bA(a), l = f.content, c = f.uniforms, h = bA(s), d = h.content, v = h.uniforms;
        this.rawContentCache[e] = {
          fs: d,
          uniforms: Gl(Gl(Gl({}, c), v), u),
          vs: l
        };
      }
    }
  }, {
    key: "destroy",
    value: function() {
      this.moduleCache = {}, this.rawContentCache = {};
    }
  }, {
    key: "getModule",
    value: function(e) {
      var n = this;
      if (this.moduleCache[e])
        return this.moduleCache[e];
      var i = this.rawContentCache[e].vs || "", a = this.rawContentCache[e].fs || "", o = this.processModule(i, [], "vs"), s = o.content, u = o.includeList, f = this.processModule(a, [], "fs"), l = f.content, c = f.includeList, h = l, d = Gle(u.concat(c).concat(e)).reduce(function(v, p) {
        return Gl(Gl({}, v), n.rawContentCache[p].uniforms);
      }, {});
      return jle.test(l) || (h = $le + l), this.moduleCache[e] = {
        fs: h.trim(),
        uniforms: d,
        vs: s.trim()
      }, this.moduleCache[e];
    }
  }, {
    key: "processModule",
    value: function(e, n, i) {
      var a = this, o = e.replace(Wle, function(s, u) {
        var f = u.split(" "), l = f[0].replace(/"/g, "");
        if (n.indexOf(l) > -1)
          return "";
        var c = a.rawContentCache[l][i];
        n.push(l);
        var h = a.processModule(c || "", n, i), d = h.content;
        return d;
      });
      return {
        content: o,
        includeList: n
      };
    }
  }]), r;
}(), wA)) || _A), Lo = new v5();
Lo.bind(Ge.ShaderModuleService).to(Vle).inSingletonScope();
Lo.bind(Ge.NameComponentManager).toConstantValue(new ku(kle));
Lo.bind(Ge.HierarchyComponentManager).toConstantValue(new ku(Cle));
Lo.bind(Ge.TransformComponentManager).toConstantValue(new ku(p5));
Lo.bind(Ge.MeshComponentManager).toConstantValue(new ku(lle));
Lo.bind(Ge.CullableComponentManager).toConstantValue(new ku(sle));
Lo.bind(Ge.GeometryComponentManager).toConstantValue(new ku(Jfe));
Lo.bind(Ge.MaterialComponentManager).toConstantValue(new ku(nle));
function Xle() {
  var r = new v5();
  return r.parent = Lo, r.bind(Ge.Systems).to(Tle).inSingletonScope().whenTargetNamed(Ge.SceneGraphSystem), r.bind(Ge.Systems).to(xfe).inSingletonScope().whenTargetNamed(Ge.FrameGraphSystem), r.bind(Ge.Systems).to(gle).inSingletonScope().whenTargetNamed(Ge.MeshSystem), r.bind(Ge.Systems).to(ele).inSingletonScope().whenTargetNamed(Ge.GeometrySystem), r.bind(Ge.Systems).to(ile).inSingletonScope().whenTargetNamed(Ge.MaterialSystem), r.bind(Ge.Systems).to(Ele).inSingletonScope().whenTargetNamed(Ge.RendererSystem), r.bind(Ge.ResourcePool).to(Ple).inSingletonScope(), r.bind(Ge.ConfigService).to(Lle).inSingletonScope(), r.bind(Ge.InteractorService).to(Nle).inSingletonScope(), r.bind(Ge.RenderPass).to(Jf).inSingletonScope().whenTargetNamed(Jf.IDENTIFIER), r.bind(Ge.RenderPass).to(mp).inSingletonScope().whenTargetNamed(mp.IDENTIFIER), r.bind(Ge.RenderPass).to(b1).inSingletonScope().whenTargetNamed(b1.IDENTIFIER), r.bind(Ge.RenderPassFactory).toFactory(function(t) {
    return function(e) {
      return t.container.getNamed(Ge.RenderPass, e);
    };
  }), r;
}
function Yx(r) {
  for (var t = new Xx(), e = rr(r[0], r[1], r[2]), n = rr(r[0], r[1], r[2]), i = 3; i < r.length; ) {
    var a = r[i++], o = r[i++], s = r[i++];
    a < e[0] && (e[0] = a), o < e[1] && (e[1] = o), s < e[2] && (e[2] = s), a > n[0] && (n[0] = a), o > n[1] && (n[1] = o), s > n[2] && (n[2] = s);
  }
  return t.setMinMax(e, n), t;
}
var ai = typeof navigator < "u" && /Version\/[\d\.]+.*Safari/.test(navigator.userAgent);
Tr();
Tr();
Tr();
Tr();
Tr();
Tr();
var SA;
(function(r) {
  r.Normal = "normal", r.PostProcessing = "post-processing";
})(SA || (SA = {}));
var Su;
(function(r) {
  r.Void = "Void", r.Boolean = "Boolean", r.Float = "Float", r.Uint32 = "Uint32", r.Int32 = "Int32", r.Vector = "Vector", r.Vector2Float = "vec2<f32>", r.Vector3Float = "vec3<f32>", r.Vector4Float = "vec4<f32>", r.Vector2Boolean = "vec2<bool>", r.Vector3Boolean = "vec3<bool>", r.Vector4Boolean = "vec4<bool>", r.Vector2Uint = "vec2<u32>", r.Vector3Uint = "vec3<u32>", r.Vector4Uint = "vec4<u32>", r.Vector2Int = "vec2<i32>", r.Vector3Int = "vec3<i32>", r.Vector4Int = "vec4<i32>", r.Matrix = "Matrix", r.Matrix3x3Float = "mat3x3<f32>", r.Matrix4x4Float = "mat4x4<i32>", r.Struct = "Struct", r.FloatArray = "Float[]", r.Vector4FloatArray = "vec4<f32>[]";
})(Su || (Su = {}));
var MA;
(function(r) {
  r.Program = "Program", r.Identifier = "Identifier", r.VariableDeclaration = "VariableDeclaration", r.BlockStatement = "BlockStatement", r.ReturnStatement = "ReturnStatement", r.FunctionDeclaration = "FunctionDeclaration", r.VariableDeclarator = "VariableDeclarator", r.AssignmentExpression = "AssignmentExpression", r.LogicalExpression = "LogicalExpression", r.BinaryExpression = "BinaryExpression", r.ArrayExpression = "ArrayExpression", r.UnaryExpression = "UnaryExpression", r.UpdateExpression = "UpdateExpression", r.FunctionExpression = "FunctionExpression", r.MemberExpression = "MemberExpression", r.ConditionalExpression = "ConditionalExpression", r.ExpressionStatement = "ExpressionStatement", r.CallExpression = "CallExpression", r.NumThreadStatement = "NumThreadStatement", r.StorageStatement = "StorageStatement", r.DoWhileStatement = "DoWhileStatement", r.WhileStatement = "WhileStatement", r.ForStatement = "ForStatement", r.BreakStatement = "BreakStatement", r.ContinueStatement = "ContinueStatement", r.IfStatement = "IfStatement", r.ImportedFunctionStatement = "ImportedFunctionStatement";
})(MA || (MA = {}));
var ms;
(function(r) {
  r.Input = "Input", r.Output = "Output", r.Uniform = "Uniform", r.Workgroup = "Workgroup", r.UniformConstant = "UniformConstant", r.Image = "Image", r.StorageBuffer = "StorageBuffer", r.Private = "Private", r.Function = "Function";
})(ms || (ms = {}));
var bc;
(function(r) {
  r.GLSL100 = "GLSL100", r.GLSL450 = "GLSL450", r.WGSL = "WGSL";
})(bc || (bc = {}));
var Yle = "__DefineValuePlaceholder__";
function Hx(r) {
  return typeof r == "number";
}
function ro(r) {
  return r === void 0 ? 0 : r > 360 || r < -360 ? r % 360 : r;
}
function $s(r, t, e) {
  return Hx(r) ? rr(r, t, e) : r.length === 3 ? Ma(r) : rr(r[0], r[1], r[2]);
}
var CA = /* @__PURE__ */ function() {
  function r(t, e) {
    Pt(this, r), this.name = void 0, this.matrix = void 0, this.right = void 0, this.up = void 0, this.forward = void 0, this.position = void 0, this.focalPoint = void 0, this.distanceVector = void 0, this.distance = void 0, this.dollyingStep = void 0, this.azimuth = 0, this.elevation = 0, this.roll = 0, this.relAzimuth = 0, this.relElevation = 0, this.relRoll = 0, this.name = t, this.matrix = ZD(e.matrix), this.right = Ma(e.right), this.up = Ma(e.up), this.forward = Ma(e.forward), this.position = Ma(e.position), this.focalPoint = Ma(e.focalPoint), this.distanceVector = Ma(e.distanceVector), this.azimuth = e.azimuth, this.elevation = e.elevation, this.roll = e.roll, this.relAzimuth = e.relAzimuth, this.relElevation = e.relElevation, this.relRoll = e.relRoll, this.dollyingStep = e.dollyingStep, this.distance = e.distance;
  }
  return Wt(r, [{
    key: "getPosition",
    value: function() {
      return this.position;
    }
  }, {
    key: "getFocalPoint",
    value: function() {
      return this.focalPoint;
    }
  }, {
    key: "getRoll",
    value: function() {
      return this.roll;
    }
  }, {
    key: "retrieve",
    value: function(e) {
      e.matrix = Gv(e.matrix, this.matrix), e.right = Ln(e.right, this.right), e.up = Ln(e.up, this.up), e.forward = Ln(e.forward, this.forward), e.position = Ln(e.position, this.position), e.focalPoint = Ln(e.focalPoint, this.focalPoint), e.distanceVector = Ln(e.distanceVector, this.distanceVector), e.azimuth = this.azimuth, e.elevation = this.elevation, e.roll = this.roll, e.relAzimuth = this.relAzimuth, e.relElevation = this.relElevation, e.relRoll = this.relRoll, e.dollyingStep = this.dollyingStep, e.distance = this.distance;
    }
  }]), r;
}(), TA, AA, IA, Dy, PA, OA, DA, Ir;
(function(r) {
  r.ORBITING = "ORBITING", r.EXPLORING = "EXPLORING", r.TRACKING = "TRACKING";
})(Ir || (Ir = {}));
var bp;
(function(r) {
  r.DEFAULT = "DEFAULT", r.ROTATIONAL = "ROTATIONAL", r.TRANSLATIONAL = "TRANSLATIONAL", r.CINEMATIC = "CINEMATIC";
})(bp || (bp = {}));
var nu;
(function(r) {
  r.ORTHOGRAPHIC = "ORTHOGRAPHIC", r.PERSPECTIVE = "PERSPECTIVE";
})(nu || (nu = {}));
var no = Math.PI / 180, Wo = 180 / Math.PI, x1 = (TA = Mr(), AA = Ut(Ge.InteractorService), TA(IA = (Dy = (DA = OA = /* @__PURE__ */ function() {
  function r() {
    Pt(this, r), this.matrix = Jn(), this.right = rr(1, 0, 0), this.up = rr(0, 1, 0), this.forward = rr(0, 0, 1), this.position = rr(0, 0, 1), this.focalPoint = rr(0, 0, 0), this.distanceVector = rr(0, 0, 0), this.distance = 1, this.azimuth = 0, this.elevation = 0, this.roll = 0, this.relAzimuth = 0, this.relElevation = 0, this.relRoll = 0, this.dollyingStep = 0, this.maxDistance = 1 / 0, this.minDistance = -1 / 0, this.rotateWorld = !1, Ft(this, "interactor", PA, this), this.fov = 30, this.near = 0.1, this.far = 1e4, this.aspect = 1, this.left = void 0, this.rright = void 0, this.top = void 0, this.bottom = void 0, this.zoom = 1, this.perspective = Jn(), this.view = void 0, this.following = void 0, this.type = Ir.EXPLORING, this.trackingMode = bp.DEFAULT, this.projectionMode = nu.PERSPECTIVE, this.frustum = new hle(), this.landmarks = [], this.landmarkAnimationID = void 0;
  }
  return Wt(r, [{
    key: "clone",
    value: function() {
      var e = new r();
      return e.setType(this.type, void 0), e.interactor = this.interactor, e;
    }
  }, {
    key: "getProjectionMode",
    value: function() {
      return this.projectionMode;
    }
  }, {
    key: "getPerspective",
    value: function() {
      return this.perspective;
    }
  }, {
    key: "getFrustum",
    value: function() {
      return this.frustum;
    }
  }, {
    key: "getPosition",
    value: function() {
      return this.position;
    }
  }, {
    key: "setType",
    value: function(e, n) {
      return this.type = e, this.type === Ir.EXPLORING ? this.setWorldRotation(!0) : this.setWorldRotation(!1), this._getAngles(), this.type === Ir.TRACKING && n !== void 0 && this.setTrackingMode(n), this;
    }
  }, {
    key: "setProjectionMode",
    value: function(e) {
      return this.projectionMode = e, this;
    }
  }, {
    key: "setTrackingMode",
    value: function(e) {
      if (this.type !== Ir.TRACKING)
        throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");
      return this.trackingMode = e, this;
    }
  }, {
    key: "setWorldRotation",
    value: function(e) {
      this.rotateWorld = e, this._getAngles();
    }
  }, {
    key: "getViewTransform",
    value: function() {
      return Tc(Jn(), this.matrix);
    }
  }, {
    key: "getWorldTransform",
    value: function() {
      return this.matrix;
    }
  }, {
    key: "setMatrix",
    value: function(e) {
      return this.matrix = e, this._update(), this;
    }
  }, {
    key: "setAspect",
    value: function(e) {
      return this.setPerspective(this.near, this.far, this.fov, e), this;
    }
  }, {
    key: "setViewOffset",
    value: function(e, n, i, a, o, s) {
      return this.aspect = e / n, this.view === void 0 && (this.view = {
        enabled: !0,
        fullWidth: 1,
        fullHeight: 1,
        offsetX: 0,
        offsetY: 0,
        width: 1,
        height: 1
      }), this.view.enabled = !0, this.view.fullWidth = e, this.view.fullHeight = n, this.view.offsetX = i, this.view.offsetY = a, this.view.width = o, this.view.height = s, this.projectionMode === nu.PERSPECTIVE ? this.setPerspective(this.near, this.far, this.fov, this.aspect) : this.setOrthographic(this.left, this.rright, this.top, this.bottom, this.near, this.far), this;
    }
  }, {
    key: "clearViewOffset",
    value: function() {
      return this.view !== void 0 && (this.view.enabled = !1), this.projectionMode === nu.PERSPECTIVE ? this.setPerspective(this.near, this.far, this.fov, this.aspect) : this.setOrthographic(this.left, this.rright, this.top, this.bottom, this.near, this.far), this;
    }
  }, {
    key: "setPerspective",
    value: function(e, n, i, a) {
      return this.projectionMode = nu.PERSPECTIVE, this.fov = i, this.near = e, this.far = n, this.aspect = a, nk(this.perspective, this.fov * no, this.aspect, this.near, this.far), this;
    }
  }, {
    key: "setOrthographic",
    value: function(e, n, i, a, o, s) {
      this.projectionMode = nu.ORTHOGRAPHIC, this.rright = n, this.left = e, this.top = i, this.bottom = a, this.near = o, this.far = s;
      var u = (this.rright - this.left) / (2 * this.zoom), f = (this.top - this.bottom) / (2 * this.zoom), l = (this.rright + this.left) / 2, c = (this.top + this.bottom) / 2, h = l - u, d = l + u, v = c + f, p = c - f;
      if (this.view !== void 0 && this.view.enabled) {
        var g = (this.rright - this.left) / this.view.fullWidth / this.zoom, y = (this.top - this.bottom) / this.view.fullHeight / this.zoom;
        h += g * this.view.offsetX, d = h + g * this.view.width, v -= y * this.view.offsetY, p = v - y * this.view.height;
      }
      return ak(this.perspective, h, d, v, p, o, s), this;
    }
  }, {
    key: "setPosition",
    value: function(e, n, i) {
      return this._setPosition(e, n, i), this.setFocalPoint(this.focalPoint), this;
    }
  }, {
    key: "setFocalPoint",
    value: function(e, n, i) {
      var a = rr(0, 1, 0);
      if (this.focalPoint = $s(e, n, i), this.trackingMode === bp.CINEMATIC) {
        var o = Fv(Tr(), this.focalPoint, this.position);
        e = o[0], n = o[1], i = o[2];
        var s = cc(o), u = Math.asin(n / s) * Wo, f = 90 + Math.atan2(i, e) * Wo, l = Jn();
        JD(l, l, f * no), QD(l, l, u * no), a = Dp(Tr(), [0, 1, 0], l);
      }
      return Tc(this.matrix, ok(Jn(), this.position, this.focalPoint, a)), this._getAxes(), this._getDistance(), this._getAngles(), this;
    }
  }, {
    key: "setDistance",
    value: function(e) {
      if (!(this.distance === e || e < 0)) {
        this.distance = e, this.distance < 2e-4 && (this.distance = 2e-4), this.dollyingStep = this.distance / 100;
        var n = Tr();
        e = this.distance;
        var i = this.forward, a = this.focalPoint;
        return n[0] = e * i[0] + a[0], n[1] = e * i[1] + a[1], n[2] = e * i[2] + a[2], this._setPosition(n), this;
      }
    }
  }, {
    key: "setMaxDistance",
    value: function(e) {
      return this.maxDistance = e, this;
    }
  }, {
    key: "setMinDistance",
    value: function(e) {
      return this.minDistance = e, this;
    }
  }, {
    key: "changeAzimuth",
    value: function(e) {
      return this.setAzimuth(this.azimuth + e), this;
    }
  }, {
    key: "changeElevation",
    value: function(e) {
      return this.setElevation(this.elevation + e), this;
    }
  }, {
    key: "changeRoll",
    value: function(e) {
      return this.setRoll(this.roll + e), this;
    }
  }, {
    key: "setAzimuth",
    value: function(e) {
      return this.azimuth = ro(e), this.computeMatrix(), this._getAxes(), this.type === Ir.ORBITING || this.type === Ir.EXPLORING ? this._getPosition() : this.type === Ir.TRACKING && this._getFocalPoint(), this;
    }
  }, {
    key: "getAzimuth",
    value: function() {
      return this.azimuth;
    }
  }, {
    key: "setElevation",
    value: function(e) {
      return this.elevation = ro(e), this.computeMatrix(), this._getAxes(), this.type === Ir.ORBITING || this.type === Ir.EXPLORING ? this._getPosition() : this.type === Ir.TRACKING && this._getFocalPoint(), this;
    }
  }, {
    key: "setRoll",
    value: function(e) {
      return this.roll = ro(e), this.computeMatrix(), this._getAxes(), this.type === Ir.ORBITING || this.type === Ir.EXPLORING ? this._getPosition() : this.type === Ir.TRACKING && this._getFocalPoint(), this;
    }
  }, {
    key: "rotate",
    value: function(e, n, i) {
      if (this.type === Ir.EXPLORING) {
        e = ro(e), n = ro(n), i = ro(i);
        var a = Zo(hn(), [1, 0, 0], (this.rotateWorld ? 1 : -1) * n * no), o = Zo(hn(), [0, 1, 0], (this.rotateWorld ? 1 : -1) * e * no), s = Zo(hn(), [0, 0, 1], i * no), u = mi(hn(), o, a);
        u = mi(hn(), u, s);
        var f = Ky(Jn(), u);
        pf(this.matrix, this.matrix, [0, 0, -this.distance]), wo(this.matrix, this.matrix, f), pf(this.matrix, this.matrix, [0, 0, this.distance]);
      } else {
        if (Math.abs(this.elevation + n) > 90)
          return;
        this.relElevation = ro(n), this.relAzimuth = ro(e), this.relRoll = ro(i), this.elevation += this.relElevation, this.azimuth += this.relAzimuth, this.roll += this.relRoll, this.computeMatrix();
      }
      return this._getAxes(), this.type === Ir.ORBITING || this.type === Ir.EXPLORING ? this._getPosition() : this.type === Ir.TRACKING && this._getFocalPoint(), this._update(), this;
    }
  }, {
    key: "pan",
    value: function(e, n) {
      var i = $s(e, n, 0), a = Ma(this.position);
      return Ia(a, a, Gf(Tr(), this.right, i[0])), Ia(a, a, Gf(Tr(), this.up, i[1])), this._setPosition(a), this;
    }
  }, {
    key: "dolly",
    value: function(e) {
      var n = this.forward, i = Ma(this.position), a = e * this.dollyingStep, o = this.distance + e * this.dollyingStep;
      return a = Math.max(Math.min(o, this.maxDistance), this.minDistance) - this.distance, i[0] += a * n[0], i[1] += a * n[1], i[2] += a * n[2], this._setPosition(i), this.type === Ir.ORBITING || this.type === Ir.EXPLORING ? this._getDistance() : this.type === Ir.TRACKING && Ia(this.focalPoint, i, this.distanceVector), this;
    }
  }, {
    key: "createLandmark",
    value: function(e, n) {
      var i = this.clone();
      i.setPosition(n.position), i.setFocalPoint(n.focalPoint), n.roll !== void 0 && i.setRoll(n.roll);
      var a = new CA(e, i);
      return this.landmarks.push(a), a;
    }
  }, {
    key: "setLandmark",
    value: function(e) {
      var n = new CA(e, this);
      return this.landmarks.push(n), this;
    }
  }, {
    key: "gotoLandmark",
    value: function(e) {
      var n = this, i = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : 1e3, a = this.landmarks.find(function(c) {
        return c.name === e;
      });
      if (a) {
        if (i === 0) {
          a.retrieve(this);
          return;
        }
        this.landmarkAnimationID !== void 0 && window.cancelAnimationFrame(this.landmarkAnimationID), this.interactor.disconnect();
        var o = a.getPosition(), s = a.getFocalPoint(), u = a.getRoll(), f, l = function c(h) {
          f === void 0 && (f = h);
          var d = h - f, v = (1 - Math.cos(d / i * Math.PI)) / 2, p = Tr(), g = Tr(), y = 0;
          cs(p, n.focalPoint, s, v), cs(g, n.position, o, v), y = n.roll * (1 - v) + u * v, n.setFocalPoint(p), n.setPosition(g), n.setRoll(y), n.computeMatrix();
          var b = qy(p, s) + qy(g, o);
          if (!(b > 0.01)) {
            n.setFocalPoint(p), n.setPosition(g), n.setRoll(y), n.computeMatrix(), n.interactor.connect();
            return;
          }
          d < i && (n.landmarkAnimationID = window.requestAnimationFrame(c));
        };
        window.requestAnimationFrame(l);
      }
    }
  }, {
    key: "_update",
    value: function() {
      this._getAxes(), this._getPosition(), this._getDistance(), this._getAngles();
    }
  }, {
    key: "computeMatrix",
    value: function() {
      var e, n, i = Zo(hn(), [0, 0, 1], this.roll * no);
      q1(this.matrix), e = Zo(hn(), [1, 0, 0], (this.rotateWorld && this.type !== Ir.TRACKING || this.type === Ir.TRACKING ? 1 : -1) * this.elevation * no), n = Zo(hn(), [0, 1, 0], (this.rotateWorld && this.type !== Ir.TRACKING || this.type === Ir.TRACKING ? 1 : -1) * this.azimuth * no);
      var a = mi(hn(), n, e);
      a = mi(hn(), a, i);
      var o = Ky(Jn(), a);
      this.type === Ir.ORBITING || this.type === Ir.EXPLORING ? (pf(this.matrix, this.matrix, this.focalPoint), wo(this.matrix, this.matrix, o), pf(this.matrix, this.matrix, [0, 0, this.distance])) : this.type === Ir.TRACKING && (pf(this.matrix, this.matrix, this.position), wo(this.matrix, this.matrix, o));
    }
  }, {
    key: "_setPosition",
    value: function(e, n, i) {
      this.position = $s(e, n, i);
      var a = this.matrix;
      a[12] = this.position[0], a[13] = this.position[1], a[14] = this.position[2], a[15] = 1;
    }
  }, {
    key: "_getAxes",
    value: function() {
      Ln(this.right, $s(Sf(Ef(), [1, 0, 0, 0], this.matrix))), Ln(this.up, $s(Sf(Ef(), [0, 1, 0, 0], this.matrix))), Ln(this.forward, $s(Sf(Ef(), [0, 0, 1, 0], this.matrix))), Pf(this.right, this.right), Pf(this.up, this.up), Pf(this.forward, this.forward);
    }
  }, {
    key: "_getAngles",
    value: function() {
      var e = this.distanceVector[0], n = this.distanceVector[1], i = this.distanceVector[2], a = cc(this.distanceVector);
      if (a === 0) {
        this.elevation = 0, this.azimuth = 0;
        return;
      }
      this.type === Ir.TRACKING ? (this.elevation = Math.asin(n / a) * Wo, this.azimuth = Math.atan2(-e, -i) * Wo) : this.rotateWorld ? (this.elevation = Math.asin(n / a) * Wo, this.azimuth = Math.atan2(-e, -i) * Wo) : (this.elevation = -Math.asin(n / a) * Wo, this.azimuth = -Math.atan2(-e, -i) * Wo);
    }
  }, {
    key: "_getPosition",
    value: function() {
      Ln(this.position, $s(Sf(Ef(), [0, 0, 0, 1], this.matrix))), this._getDistance();
    }
  }, {
    key: "_getFocalPoint",
    value: function() {
      Mu(this.distanceVector, [0, 0, -this.distance], WD(tl(), this.matrix)), Ia(this.focalPoint, this.position, this.distanceVector), this._getDistance();
    }
  }, {
    key: "_getDistance",
    value: function() {
      this.distanceVector = Fv(Tr(), this.focalPoint, this.position), this.distance = cc(this.distanceVector), this.dollyingStep = this.distance / 100;
    }
  }]), r;
}(), OA.ProjectionMode = {
  ORTHOGRAPHIC: "ORTHOGRAPHIC",
  PERSPECTIVE: "PERSPECTIVE"
}, DA), PA = zt(Dy.prototype, "interactor", [AA], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), Dy)) || IA), kA, LA, NA, ky, RA, Fl, BA, bo = (kA = Mr(), LA = Ut(Ge.GeometryComponentManager), kA(NA = (ky = (BA = Fl = /* @__PURE__ */ function() {
  function r() {
    Pt(this, r), this.config = void 0, Ft(this, "geometry", RA, this), this.entity = void 0, this.component = void 0;
  }
  return Wt(r, [{
    key: "getEntity",
    value: function() {
      return this.entity;
    }
  }, {
    key: "getComponent",
    value: function() {
      return this.component;
    }
  }, {
    key: "setConfig",
    value: function(e) {
      this.config = e;
    }
  }, {
    key: "setEntity",
    value: function(e) {
      this.entity = e, this.component = this.geometry.create(e), this.component.entity = e, this.onEntityCreated();
    }
  }, {
    key: "onEntityCreated",
    value: function() {
    }
  }]), r;
}(), Fl.BOX = "box", Fl.SPHERE = "sphere", Fl.PLANE = "plane", Fl.MERGED = "merged", BA), RA = zt(ky.prototype, "geometry", [LA], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), ky)) || NA), ut = {};
(function(r) {
  Object.defineProperty(r, "__esModule", { value: !0 }), function(t) {
    t.TextureCompressionBC = "texture-compression-bc";
  }(r.ExtensionName || (r.ExtensionName = {})), function(t) {
    t.ClampToEdge = "clamp-to-edge", t.Repeat = "repeat", t.MirrorRepeat = "mirror-repeat";
  }(r.AddressMode || (r.AddressMode = {})), function(t) {
    t.UniformBuffer = "uniform-buffer", t.StorageBuffer = "storage-buffer", t.ReadonlyStorageBuffer = "readonly-storage-buffer", t.Sampler = "sampler", t.ComparisonSampler = "comparison-sampler", t.SampledTexture = "sampled-texture", t.ReadonlyStorageTexture = "readonly-storage-texture", t.WriteonlyStorageTexture = "writeonly-storage-texture";
  }(r.BindingType || (r.BindingType = {})), function(t) {
    t.Zero = "zero", t.One = "one", t.SrcColor = "src-color", t.OneMinusSrcColor = "one-minus-src-color", t.SrcAlpha = "src-alpha", t.OneMinusSrcAlpha = "one-minus-src-alpha", t.DstColor = "dst-color", t.OneMinusDstColor = "one-minus-dst-color", t.DstAlpha = "dst-alpha", t.OneMinusDstAlpha = "one-minus-dst-alpha", t.SrcAlphaSaturated = "src-alpha-saturated", t.BlendColor = "blend-color", t.OneMinusBlendColor = "one-minus-blend-color";
  }(r.BlendFactor || (r.BlendFactor = {})), function(t) {
    t.Add = "add", t.Subtract = "subtract", t.ReverseSubtract = "reverse-subtract", t.Min = "min", t.Max = "max";
  }(r.BlendOperation || (r.BlendOperation = {})), function(t) {
    t.Never = "never", t.Less = "less", t.Equal = "equal", t.LessEqual = "less-equal", t.Greater = "greater", t.NotEqual = "not-equal", t.GreaterEqual = "greater-equal", t.Always = "always";
  }(r.CompareFunction || (r.CompareFunction = {})), function(t) {
    t.None = "none", t.Front = "front", t.Back = "back";
  }(r.CullMode || (r.CullMode = {})), function(t) {
    t.Nearest = "nearest", t.Linear = "linear";
  }(r.FilterMode || (r.FilterMode = {})), function(t) {
    t.CCW = "ccw", t.CW = "cw";
  }(r.FrontFace || (r.FrontFace = {})), function(t) {
    t.Uint16 = "uint16", t.Uint32 = "uint32";
  }(r.IndexFormat || (r.IndexFormat = {})), function(t) {
    t.Vertex = "vertex", t.Instance = "instance";
  }(r.InputStepMode || (r.InputStepMode = {})), function(t) {
    t.Load = "load";
  }(r.LoadOp || (r.LoadOp = {})), function(t) {
    t.PointList = "point-list", t.LineList = "line-list", t.LineStrip = "line-strip", t.TriangleList = "triangle-list", t.TriangleStrip = "triangle-strip";
  }(r.PrimitiveTopology || (r.PrimitiveTopology = {})), function(t) {
    t.Keep = "keep", t.Zero = "zero", t.Replace = "replace", t.Invert = "invert", t.IncrementClamp = "increment-clamp", t.DecrementClamp = "decrement-clamp", t.IncrementWrap = "increment-wrap", t.DecrementWrap = "decrement-wrap";
  }(r.StencilOperation || (r.StencilOperation = {})), function(t) {
    t.Store = "store", t.Clear = "clear";
  }(r.StoreOp || (r.StoreOp = {})), function(t) {
    t.E1d = "1d", t.E2d = "2d", t.E3d = "3d";
  }(r.TextureDimension || (r.TextureDimension = {})), function(t) {
    t.R8Unorm = "r8unorm", t.R8Snorm = "r8snorm", t.R8Uint = "r8uint", t.R8Sint = "r8sint", t.R16Uint = "r16uint", t.R16Sint = "r16sint", t.R16Float = "r16float", t.RG8Unorm = "rg8unorm", t.RG8Snorm = "rg8snorm", t.RG8Uint = "rg8uint", t.RG8Sint = "rg8sint", t.R32Uint = "r32uint", t.R32Sint = "r32sint", t.R32Float = "r32float", t.RG16Uint = "rg16uint", t.RG16Sint = "rg16sint", t.RG16Float = "rg16float", t.RGBA8Unorm = "rgba8unorm", t.RGBA8UnormSRGB = "rgba8unorm-srgb", t.RGBA8Snorm = "rgba8snorm", t.RGBA8Uint = "rgba8uint", t.RGBA8Sint = "rgba8sint", t.BGRA8Unorm = "bgra8unorm", t.BGRA8UnormSRGB = "bgra8unorm-srgb", t.RGB10A2Unorm = "rgb10a2unorm", t.RG11B10Float = "rg11b10float", t.RG32Uint = "rg32uint", t.RG32Sint = "rg32sint", t.RG32Float = "rg32float", t.RGBA16Uint = "rgba16uint", t.RGBA16Sint = "rgba16sint", t.RGBA16Float = "rgba16float", t.RGBA32Uint = "rgba32uint", t.RGBA32Sint = "rgba32sint", t.RGBA32Float = "rgba32float", t.Depth32Float = "depth32float", t.Depth24Plus = "depth24plus", t.Depth24PlusStencil8 = "depth24plus-stencil8";
  }(r.TextureFormat || (r.TextureFormat = {})), function(t) {
    t.Float = "float", t.Sint = "sint", t.Uint = "uint";
  }(r.TextureComponentType || (r.TextureComponentType = {})), function(t) {
    t.E1d = "1d", t.E2d = "2d", t.E2dArray = "2d-array", t.Cube = "cube", t.CubeArray = "cube-array", t.E3d = "3d";
  }(r.TextureViewDimension || (r.TextureViewDimension = {})), function(t) {
    t.Uchar2 = "uchar2", t.Uchar4 = "uchar4", t.Char2 = "char2", t.Char4 = "char4", t.Uchar2Norm = "uchar2norm", t.Uchar4Norm = "uchar4norm", t.Char2Norm = "char2norm", t.Char4Norm = "char4norm", t.Ushort2 = "ushort2", t.Ushort4 = "ushort4", t.Short2 = "short2", t.Short4 = "short4", t.Ushort2Norm = "ushort2norm", t.Ushort4Norm = "ushort4norm", t.Short2Norm = "short2norm", t.Short4Norm = "short4norm", t.Half2 = "half2", t.Half4 = "half4", t.Float = "float", t.Float2 = "float2", t.Float3 = "float3", t.Float4 = "float4", t.Uint = "uint", t.Uint2 = "uint2", t.Uint3 = "uint3", t.Uint4 = "uint4", t.Int = "int", t.Int2 = "int2", t.Int3 = "int3", t.Int4 = "int4";
  }(r.VertexFormat || (r.VertexFormat = {})), function(t) {
    t.All = "all", t.StencilOnly = "stencil-only", t.DepthOnly = "depth-only";
  }(r.TextureAspect || (r.TextureAspect = {})), function(t) {
    t.Error = "error", t.Warning = "warning", t.Info = "info";
  }(r.CompilationMessageType || (r.CompilationMessageType = {})), function(t) {
    t.Occlusion = "occlusion";
  }(r.QueryType || (r.QueryType = {})), function(t) {
    t[t.MapRead = 1] = "MapRead", t[t.MapWrite = 2] = "MapWrite", t[t.CopySrc = 4] = "CopySrc", t[t.CopyDst = 8] = "CopyDst", t[t.Index = 16] = "Index", t[t.Vertex = 32] = "Vertex", t[t.Uniform = 64] = "Uniform", t[t.Storage = 128] = "Storage", t[t.Indirect = 256] = "Indirect", t[t.QueryResolve = 512] = "QueryResolve";
  }(r.BufferUsage || (r.BufferUsage = {})), function(t) {
    t[t.Red = 1] = "Red", t[t.Green = 2] = "Green", t[t.Blue = 4] = "Blue", t[t.Alpha = 8] = "Alpha", t[t.All = 15] = "All";
  }(r.ColorWrite || (r.ColorWrite = {})), function(t) {
    t[t.Vertex = 1] = "Vertex", t[t.Fragment = 2] = "Fragment", t[t.Compute = 4] = "Compute";
  }(r.ShaderStage || (r.ShaderStage = {})), function(t) {
    t[t.CopySrc = 1] = "CopySrc", t[t.CopyDst = 2] = "CopyDst", t[t.Sampled = 4] = "Sampled", t[t.Storage = 8] = "Storage", t[t.OutputAttachment = 16] = "OutputAttachment";
  }(r.TextureUsage || (r.TextureUsage = {})), function(t) {
    t[t.Read = 1] = "Read", t[t.Write = 2] = "Write";
  }(r.MapMode || (r.MapMode = {}));
})(ut);
function g5() {
  if (typeof document < "u")
    return document.createElement("canvas");
  throw new Error("Cannot create a canvas in this context");
}
var Hle = {}.toString, Kle = function(t, e) {
  return Hle.call(t) === "[object " + e + "]";
};
const qle = function(r) {
  return Array.isArray ? Array.isArray(r) : Kle(r, "Array");
};
var Zle = 9007199254740991, Qle = "[object Arguments]", Jle = "[object Array]", ece = "[object Boolean]", tce = "[object Date]", rce = "[object Error]", nce = "[object Function]", ice = "[object Map]", ace = "[object Number]", oce = "[object Object]", sce = "[object RegExp]", uce = "[object Set]", fce = "[object String]", lce = "[object WeakMap]", cce = "[object ArrayBuffer]", hce = "[object DataView]", dce = "[object Float32Array]", vce = "[object Float64Array]", pce = "[object Int8Array]", gce = "[object Int16Array]", yce = "[object Int32Array]", mce = "[object Uint8Array]", bce = "[object Uint8ClampedArray]", xce = "[object Uint16Array]", _ce = "[object Uint32Array]", Fr = {};
Fr[dce] = Fr[vce] = Fr[pce] = Fr[gce] = Fr[yce] = Fr[mce] = Fr[bce] = Fr[xce] = Fr[_ce] = !0;
Fr[Qle] = Fr[Jle] = Fr[cce] = Fr[ece] = Fr[hce] = Fr[tce] = Fr[rce] = Fr[nce] = Fr[ice] = Fr[ace] = Fr[oce] = Fr[sce] = Fr[uce] = Fr[fce] = Fr[lce] = !1;
var wce = Object.prototype, Ece = wce.toString;
function Sce(r) {
  return Cce(r) && Mce(r.length) && !!Fr[Ece.call(r)];
}
function Mce(r) {
  return typeof r == "number" && r > -1 && r % 1 === 0 && r <= Zle;
}
function Cce(r) {
  return !!r && To(r) === "object";
}
var y5 = Sce, GA, FA, zA, UA, Ud, jA, $A, WA;
function VA(r, t) {
  var e = Object.keys(r);
  if (Object.getOwnPropertySymbols) {
    var n = Object.getOwnPropertySymbols(r);
    t && (n = n.filter(function(i) {
      return Object.getOwnPropertyDescriptor(r, i).enumerable;
    })), e.push.apply(e, n);
  }
  return e;
}
function XA(r) {
  for (var t = 1; t < arguments.length; t++) {
    var e = arguments[t] != null ? arguments[t] : {};
    t % 2 ? VA(Object(e), !0).forEach(function(n) {
      Ae(r, n, e[n]);
    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(r, Object.getOwnPropertyDescriptors(e)) : VA(Object(e)).forEach(function(n) {
      Object.defineProperty(r, n, Object.getOwnPropertyDescriptor(e, n));
    });
  }
  return r;
}
var _1 = (GA = Mr(), FA = Ut(Ge.RenderEngine), zA = Ut(Ge.ConfigService), GA(UA = (Ud = (WA = /* @__PURE__ */ function() {
  function r() {
    Pt(this, r), Ft(this, "engine", jA, this), Ft(this, "configService", $A, this), this.entity = Na(), this.model = void 0, this.dirty = !0, this.compiledBundle = void 0, this.initPromise = void 0;
  }
  return Wt(r, [{
    key: "init",
    value: function() {
      var e = this.configService.get(), n = e.canvas, i = e.engineOptions;
      this.initPromise = this.engine.init(XA({
        canvas: n || g5(),
        swapChainFormat: ut.TextureFormat.BGRA8Unorm,
        antialiasing: !1
      }, i));
    }
  }, {
    key: "setBundle",
    value: function(e) {
      this.compiledBundle = JSON.parse(JSON.stringify(e));
    }
  }, {
    key: "setDispatch",
    value: function(e) {
      return this.compiledBundle.context && (this.compiledBundle.context.dispatch = e), this;
    }
  }, {
    key: "setMaxIteration",
    value: function(e) {
      return this.compiledBundle.context && (this.compiledBundle.context.maxIteration = e), this;
    }
  }, {
    key: "setBinding",
    value: function(e, n) {
      var i = this;
      if (typeof e == "string") {
        var a = Hx(n) || y5(n) || qle(n);
        if (this.compiledBundle && this.compiledBundle.context) {
          var o = this.compiledBundle.context.defines.find(function(u) {
            return u.name === e;
          });
          if (o)
            return o.value = n, this;
          var s = this.compiledBundle.context.uniforms.find(function(u) {
            return u.name === e;
          });
          s && (a ? (s.data = n, s.isReferer = !1, s.storageClass === ms.Uniform ? this.model && this.model.updateUniform(e, n) : this.model && this.model.updateBuffer(e, n)) : (s.isReferer = !0, s.data = n));
        }
      } else
        Object.keys(e).forEach(function(u) {
          i.setBinding(u, e[u]);
        });
      return this;
    }
  }, {
    key: "execute",
    value: function() {
      var t = Er(/* @__PURE__ */ St.mark(function n() {
        var i = this, a, o, s = arguments;
        return St.wrap(function(f) {
          for (; ; )
            switch (f.prev = f.next) {
              case 0:
                if (a = s.length > 0 && s[0] !== void 0 ? s[0] : 1, !this.dirty) {
                  f.next = 6;
                  break;
                }
                return this.compiledBundle.context && (a > 1 ? this.compiledBundle.context.maxIteration = a : this.compiledBundle.context.maxIteration++), f.next = 5, this.compile();
              case 5:
                this.dirty = !1;
              case 6:
                for (this.engine.beginFrame(), this.engine.clear({}), this.compiledBundle.context && this.compiledBundle.context.uniforms.filter(function(l) {
                  var c = l.isReferer;
                  return c;
                }).forEach(function(l) {
                  var c = l.data, h = l.name;
                  i.model.confirmInput(c.model, h);
                }), o = 0; o < a; o++)
                  this.model.run();
                return this.engine.endFrame(), f.abrupt("return", this);
              case 12:
              case "end":
                return f.stop();
            }
        }, n, this);
      }));
      function e() {
        return t.apply(this, arguments);
      }
      return e;
    }()
  }, {
    key: "getOutput",
    value: function() {
      var t = Er(/* @__PURE__ */ St.mark(function n() {
        return St.wrap(function(a) {
          for (; ; )
            switch (a.prev = a.next) {
              case 0:
                return a.abrupt("return", this.model.readData());
              case 1:
              case "end":
                return a.stop();
            }
        }, n, this);
      }));
      function e() {
        return t.apply(this, arguments);
      }
      return e;
    }()
  }, {
    key: "compile",
    value: function() {
      var t = Er(/* @__PURE__ */ St.mark(function n() {
        var i, a, o;
        return St.wrap(function(u) {
          for (; ; )
            switch (u.prev = u.next) {
              case 0:
                return u.next = 2, this.initPromise;
              case 2:
                return i = XA({}, this.compiledBundle.context), a = this.engine.supportWebGPU ? this.engine.useWGSL ? bc.WGSL : bc.GLSL450 : bc.GLSL100, o = this.compiledBundle.shaders[a], i.defines.filter(function(f) {
                  return f.runtime;
                }).forEach(function(f) {
                  var l = "".concat(Yle).concat(f.name);
                  o = o.replace(l, "".concat(f.value));
                }), i.shader = o, i.uniforms.forEach(function(f) {
                  if (!f.data && f.storageClass === ms.StorageBuffer) {
                    var l = 1;
                    f.type === Su.FloatArray ? l = 1 : f.type === Su.Vector4FloatArray && (l = 4), f.data = new Float32Array(i.output.length * l).fill(0);
                  }
                }), this.compiledBundle.context = i, u.next = 11, this.engine.createComputeModel(this.compiledBundle.context);
              case 11:
                this.model = u.sent;
              case 12:
              case "end":
                return u.stop();
            }
        }, n, this);
      }));
      function e() {
        return t.apply(this, arguments);
      }
      return e;
    }()
  }]), r;
}(), WA), jA = zt(Ud.prototype, "engine", [FA], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), $A = zt(Ud.prototype, "configService", [zA], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), Ud)) || UA), YA, HA, KA, Ly, qA, ZA, QA, Kx = (YA = Mr(), HA = Ut(Ge.MaterialComponentManager), YA(KA = (Ly = (QA = ZA = /* @__PURE__ */ function() {
  function r() {
    Pt(this, r), this.config = void 0, Ft(this, "material", qA, this), this.entity = void 0, this.component = void 0;
  }
  return Wt(r, [{
    key: "getEntity",
    value: function() {
      return this.entity;
    }
  }, {
    key: "getComponent",
    value: function() {
      return this.component;
    }
  }, {
    key: "setConfig",
    value: function(e) {
      this.config = e;
    }
  }, {
    key: "setEntity",
    value: function(e, n) {
      this.entity = e, this.component = this.material.create(e), this.component.entity = e, this.component.type = n, this.onEntityCreated();
    }
  }, {
    key: "onEntityCreated",
    value: function() {
    }
  }]), r;
}(), ZA.BASIC = "basic", QA), qA = zt(Ly.prototype, "material", [HA], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), Ly)) || KA), JA, eI, tI, rI, nI, iI, aI, of, oI, sI, uI, fI, jd, lI, go = (JA = Mr(), eI = Ut(Ge.MeshComponentManager), tI = Ut(Ge.CullableComponentManager), rI = Ut(Ge.TransformComponentManager), nI = Ut(Ge.Systems), iI = $a(Ge.SceneGraphSystem), JA(aI = (of = (lI = jd = /* @__PURE__ */ function() {
  function r() {
    Pt(this, r), this.attributes = {}, this.config = void 0, Ft(this, "mesh", oI, this), Ft(this, "cullable", sI, this), Ft(this, "transform", uI, this), Ft(this, "sceneGraphSystem", fI, this), this.meshComponent = void 0, this.transformComponent = void 0, this.entity = void 0;
  }
  return Wt(r, [{
    key: "getEntity",
    value: function() {
      return this.entity;
    }
  }, {
    key: "getTransformComponent",
    value: function() {
      return this.transformComponent;
    }
  }, {
    key: "getMeshComponent",
    value: function() {
      return this.meshComponent;
    }
  }, {
    key: "setConfig",
    value: function(e) {
      this.config = e;
    }
  }, {
    key: "setEntity",
    value: function(e) {
      this.entity = e, this.cullable.create(e), this.meshComponent = this.mesh.create(e), this.transformComponent = this.transform.create(e), this.onEntityCreated();
    }
  }, {
    key: "setMaterial",
    value: function(e) {
      return this.meshComponent.material = e, this;
    }
  }, {
    key: "setGeometry",
    value: function(e) {
      return this.meshComponent.geometry = e, this;
    }
  }, {
    key: "setAttributes",
    value: function(e) {
      var n = this;
      Object.keys(e).forEach(function(i) {
        e[i] !== void 0 && e[i] !== n.attributes[i] && (n.onAttributeChanged({
          name: i,
          data: e[i]
        }), n.attributes[i] = e[i]);
      });
    }
  }, {
    key: "setVisible",
    value: function(e) {
      var n = this;
      return this.meshComponent.visible = e, this.meshComponent.children.forEach(function(i) {
        var a = n.mesh.getComponentByEntity(i);
        a && (a.visible = e);
      }), this;
    }
  }, {
    key: "isVisible",
    value: function() {
      return this.meshComponent.visible;
    }
  }, {
    key: "attach",
    value: function(e) {
      return this.sceneGraphSystem.attach(this.entity, e.entity), this;
    }
  }, {
    key: "detach",
    value: function() {
      return this.sceneGraphSystem.detach(this.entity), this;
    }
  }, {
    key: "detachChildren",
    value: function() {
      return this.sceneGraphSystem.detachChildren(this.entity), this;
    }
  }, {
    key: "onEntityCreated",
    value: function() {
    }
  }, {
    key: "onAttributeChanged",
    value: function(e) {
      var n = e.name, i = e.data;
      this.meshComponent && this.meshComponent.material && this.meshComponent.material.setUniform(this.convertAttributeName2UniformName(n), i);
    }
  }, {
    key: "convertAttributeName2UniformName",
    value: function(e) {
      return e;
    }
  }]), r;
}(), jd.POINT = "point", jd.LINE = "line", jd.GRID = "grid", lI), oI = zt(of.prototype, "mesh", [eI], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), sI = zt(of.prototype, "cullable", [tI], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), uI = zt(of.prototype, "transform", [rI], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), fI = zt(of.prototype, "sceneGraphSystem", [nI, iI], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), of)) || aI), m5 = { exports: {} };
(function(r, t) {
  (function(e, n) {
    r.exports = n();
  })(Oe, function() {
    var e = function(I) {
      return I instanceof Uint8Array || I instanceof Uint16Array || I instanceof Uint32Array || I instanceof Int8Array || I instanceof Int16Array || I instanceof Int32Array || I instanceof Float32Array || I instanceof Float64Array || I instanceof Uint8ClampedArray;
    }, n = function(I, z) {
      for (var H = Object.keys(z), me = 0; me < H.length; ++me)
        I[H[me]] = z[H[me]];
      return I;
    }, i = `
`;
    function a(I) {
      return typeof atob < "u" ? atob(I) : "base64:" + I;
    }
    function o(I) {
      var z = new Error("(regl) " + I);
      throw console.error(z), z;
    }
    function s(I, z) {
      I || o(z);
    }
    function u(I) {
      return I ? ": " + I : "";
    }
    function f(I, z, H) {
      I in z || o("unknown parameter (" + I + ")" + u(H) + ". possible values: " + Object.keys(z).join());
    }
    function l(I, z) {
      e(I) || o(
        "invalid parameter type" + u(z) + ". must be a typed array"
      );
    }
    function c(I, z) {
      switch (z) {
        case "number":
          return typeof I == "number";
        case "object":
          return typeof I == "object";
        case "string":
          return typeof I == "string";
        case "boolean":
          return typeof I == "boolean";
        case "function":
          return typeof I == "function";
        case "undefined":
          return typeof I > "u";
        case "symbol":
          return typeof I == "symbol";
      }
    }
    function h(I, z, H) {
      c(I, z) || o(
        "invalid parameter type" + u(H) + ". expected " + z + ", got " + typeof I
      );
    }
    function d(I, z) {
      I >= 0 && (I | 0) === I || o("invalid parameter type, (" + I + ")" + u(z) + ". must be a nonnegative integer");
    }
    function v(I, z, H) {
      z.indexOf(I) < 0 && o("invalid value" + u(H) + ". must be one of: " + z);
    }
    var p = [
      "gl",
      "canvas",
      "container",
      "attributes",
      "pixelRatio",
      "extensions",
      "optionalExtensions",
      "profile",
      "onDone"
    ];
    function g(I) {
      Object.keys(I).forEach(function(z) {
        p.indexOf(z) < 0 && o('invalid regl constructor argument "' + z + '". must be one of ' + p);
      });
    }
    function y(I, z) {
      for (I = I + ""; I.length < z; )
        I = " " + I;
      return I;
    }
    function b() {
      this.name = "unknown", this.lines = [], this.index = {}, this.hasErrors = !1;
    }
    function m(I, z) {
      this.number = I, this.line = z, this.errors = [];
    }
    function x(I, z, H) {
      this.file = I, this.line = z, this.message = H;
    }
    function _() {
      var I = new Error(), z = (I.stack || I).toString(), H = /compileProcedure.*\n\s*at.*\((.*)\)/.exec(z);
      if (H)
        return H[1];
      var me = /compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(z);
      return me ? me[1] : "unknown";
    }
    function w() {
      var I = new Error(), z = (I.stack || I).toString(), H = /at REGLCommand.*\n\s+at.*\((.*)\)/.exec(z);
      if (H)
        return H[1];
      var me = /at REGLCommand.*\n\s+at\s+(.*)\n/.exec(z);
      return me ? me[1] : "unknown";
    }
    function E(I, z) {
      var H = I.split(`
`), me = 1, Ie = 0, ye = {
        unknown: new b(),
        0: new b()
      };
      ye.unknown.name = ye[0].name = z || _(), ye.unknown.lines.push(new m(0, ""));
      for (var xe = 0; xe < H.length; ++xe) {
        var ze = H[xe], We = /^\s*#\s*(\w+)\s+(.+)\s*$/.exec(ze);
        if (We)
          switch (We[1]) {
            case "line":
              var Ze = /(\d+)(\s+\d+)?/.exec(We[2]);
              Ze && (me = Ze[1] | 0, Ze[2] && (Ie = Ze[2] | 0, Ie in ye || (ye[Ie] = new b())));
              break;
            case "define":
              var Ve = /SHADER_NAME(_B64)?\s+(.*)$/.exec(We[2]);
              Ve && (ye[Ie].name = Ve[1] ? a(Ve[2]) : Ve[2]);
              break;
          }
        ye[Ie].lines.push(new m(me++, ze));
      }
      return Object.keys(ye).forEach(function(tt) {
        var ot = ye[tt];
        ot.lines.forEach(function(Ue) {
          ot.index[Ue.number] = Ue;
        });
      }), ye;
    }
    function M(I) {
      var z = [];
      return I.split(`
`).forEach(function(H) {
        if (!(H.length < 5)) {
          var me = /^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(H);
          me ? z.push(new x(
            me[1] | 0,
            me[2] | 0,
            me[3].trim()
          )) : H.length > 0 && z.push(new x("unknown", 0, H));
        }
      }), z;
    }
    function C(I, z) {
      z.forEach(function(H) {
        var me = I[H.file];
        if (me) {
          var Ie = me.index[H.line];
          if (Ie) {
            Ie.errors.push(H), me.hasErrors = !0;
            return;
          }
        }
        I.unknown.hasErrors = !0, I.unknown.lines[0].errors.push(H);
      });
    }
    function S(I, z, H, me, Ie) {
      if (!I.getShaderParameter(z, I.COMPILE_STATUS)) {
        var ye = I.getShaderInfoLog(z), xe = me === I.FRAGMENT_SHADER ? "fragment" : "vertex";
        D(H, "string", xe + " shader source must be a string", Ie);
        var ze = E(H, Ie), We = M(ye);
        C(ze, We), Object.keys(ze).forEach(function(Ze) {
          var Ve = ze[Ze];
          if (!Ve.hasErrors)
            return;
          var tt = [""], ot = [""];
          function Ue(rt, ce) {
            tt.push(rt), ot.push(ce || "");
          }
          Ue("file number " + Ze + ": " + Ve.name + `
`, "color:red;text-decoration:underline;font-weight:bold"), Ve.lines.forEach(function(rt) {
            if (rt.errors.length > 0) {
              Ue(y(rt.number, 4) + "|  ", "background-color:yellow; font-weight:bold"), Ue(rt.line + i, "color:red; background-color:yellow; font-weight:bold");
              var ce = 0;
              rt.errors.forEach(function(_e) {
                var qe = _e.message, ht = /^\s*'(.*)'\s*:\s*(.*)$/.exec(qe);
                if (ht) {
                  var Ne = ht[1];
                  switch (qe = ht[2], Ne) {
                    case "assign":
                      Ne = "=";
                      break;
                  }
                  ce = Math.max(rt.line.indexOf(Ne, ce), 0);
                } else
                  ce = 0;
                Ue(y("| ", 6)), Ue(y("^^^", ce + 3) + i, "font-weight:bold"), Ue(y("| ", 6)), Ue(qe + i, "font-weight:bold");
              }), Ue(y("| ", 6) + i);
            } else
              Ue(y(rt.number, 4) + "|  "), Ue(rt.line + i, "color:red");
          }), typeof document < "u" && !window.chrome ? (ot[0] = tt.join("%c"), console.log.apply(console, ot)) : console.log(tt.join(""));
        }), s.raise("Error compiling " + xe + " shader, " + ze[0].name);
      }
    }
    function A(I, z, H, me, Ie) {
      if (!I.getProgramParameter(z, I.LINK_STATUS)) {
        var ye = I.getProgramInfoLog(z), xe = E(H, Ie), ze = E(me, Ie), We = 'Error linking program with vertex shader, "' + ze[0].name + '", and fragment shader "' + xe[0].name + '"';
        typeof document < "u" ? console.log(
          "%c" + We + i + "%c" + ye,
          "color:red;text-decoration:underline;font-weight:bold",
          "color:red"
        ) : console.log(We + i + ye), s.raise(We);
      }
    }
    function T(I) {
      I._commandRef = _();
    }
    function P(I, z, H, me) {
      T(I);
      function Ie(We) {
        return We ? me.id(We) : 0;
      }
      I._fragId = Ie(I.static.frag), I._vertId = Ie(I.static.vert);
      function ye(We, Ze) {
        Object.keys(Ze).forEach(function(Ve) {
          We[me.id(Ve)] = !0;
        });
      }
      var xe = I._uniformSet = {};
      ye(xe, z.static), ye(xe, z.dynamic);
      var ze = I._attributeSet = {};
      ye(ze, H.static), ye(ze, H.dynamic), I._hasCount = "count" in I.static || "count" in I.dynamic || "elements" in I.static || "elements" in I.dynamic;
    }
    function k(I, z) {
      var H = w();
      o(I + " in command " + (z || _()) + (H === "unknown" ? "" : " called from " + H));
    }
    function L(I, z, H) {
      I || k(z, H || _());
    }
    function O(I, z, H, me) {
      I in z || k(
        "unknown parameter (" + I + ")" + u(H) + ". possible values: " + Object.keys(z).join(),
        me || _()
      );
    }
    function D(I, z, H, me) {
      c(I, z) || k(
        "invalid parameter type" + u(H) + ". expected " + z + ", got " + typeof I,
        me || _()
      );
    }
    function G(I) {
      I();
    }
    function R(I, z, H) {
      I.texture ? v(
        I.texture._texture.internalformat,
        z,
        "unsupported texture format for attachment"
      ) : v(
        I.renderbuffer._renderbuffer.format,
        H,
        "unsupported renderbuffer format for attachment"
      );
    }
    var F = 33071, q = 9728, ne = 9984, oe = 9985, ie = 9986, Ee = 9987, Xe = 5120, le = 5121, Me = 5122, $e = 5123, et = 5124, ft = 5125, pt = 5126, $ = 32819, te = 32820, X = 33635, De = 34042, Ke = 36193, Fe = {};
    Fe[Xe] = Fe[le] = 1, Fe[Me] = Fe[$e] = Fe[Ke] = Fe[X] = Fe[$] = Fe[te] = 2, Fe[et] = Fe[ft] = Fe[pt] = Fe[De] = 4;
    function _t(I, z) {
      return I === te || I === $ || I === X ? 2 : I === De ? 4 : Fe[I] * z;
    }
    function Kt(I) {
      return !(I & I - 1) && !!I;
    }
    function Ye(I, z, H) {
      var me, Ie = z.width, ye = z.height, xe = z.channels;
      s(
        Ie > 0 && Ie <= H.maxTextureSize && ye > 0 && ye <= H.maxTextureSize,
        "invalid texture shape"
      ), (I.wrapS !== F || I.wrapT !== F) && s(
        Kt(Ie) && Kt(ye),
        "incompatible wrap mode for texture, both width and height must be power of 2"
      ), z.mipmask === 1 ? Ie !== 1 && ye !== 1 && s(
        I.minFilter !== ne && I.minFilter !== ie && I.minFilter !== oe && I.minFilter !== Ee,
        "min filter requires mipmap"
      ) : (s(
        Kt(Ie) && Kt(ye),
        "texture must be a square power of 2 to support mipmapping"
      ), s(
        z.mipmask === (Ie << 1) - 1,
        "missing or incomplete mipmap data"
      )), z.type === pt && (H.extensions.indexOf("oes_texture_float_linear") < 0 && s(
        I.minFilter === q && I.magFilter === q,
        "filter not supported, must enable oes_texture_float_linear"
      ), s(
        !I.genMipmaps,
        "mipmap generation not supported with float textures"
      ));
      var ze = z.images;
      for (me = 0; me < 16; ++me)
        if (ze[me]) {
          var We = Ie >> me, Ze = ye >> me;
          s(z.mipmask & 1 << me, "missing mipmap data");
          var Ve = ze[me];
          if (s(
            Ve.width === We && Ve.height === Ze,
            "invalid shape for mip images"
          ), s(
            Ve.format === z.format && Ve.internalformat === z.internalformat && Ve.type === z.type,
            "incompatible type for mip image"
          ), !Ve.compressed)
            if (Ve.data) {
              var tt = Math.ceil(_t(Ve.type, xe) * We / Ve.unpackAlignment) * Ve.unpackAlignment;
              s(
                Ve.data.byteLength === tt * Ze,
                "invalid data for image, buffer size is inconsistent with image format"
              );
            } else
              Ve.element || Ve.copy;
        } else
          I.genMipmaps || s((z.mipmask & 1 << me) === 0, "extra mipmap data");
      z.compressed && s(
        !I.genMipmaps,
        "mipmap generation for compressed images not supported"
      );
    }
    function vt(I, z, H, me) {
      var Ie = I.width, ye = I.height, xe = I.channels;
      s(
        Ie > 0 && Ie <= me.maxTextureSize && ye > 0 && ye <= me.maxTextureSize,
        "invalid texture shape"
      ), s(
        Ie === ye,
        "cube map must be square"
      ), s(
        z.wrapS === F && z.wrapT === F,
        "wrap mode not supported by cube map"
      );
      for (var ze = 0; ze < H.length; ++ze) {
        var We = H[ze];
        s(
          We.width === Ie && We.height === ye,
          "inconsistent cube map face shape"
        ), z.genMipmaps && (s(
          !We.compressed,
          "can not generate mipmap for compressed textures"
        ), s(
          We.mipmask === 1,
          "can not specify mipmaps and generate mipmaps"
        ));
        for (var Ze = We.images, Ve = 0; Ve < 16; ++Ve) {
          var tt = Ze[Ve];
          if (tt) {
            var ot = Ie >> Ve, Ue = ye >> Ve;
            s(We.mipmask & 1 << Ve, "missing mipmap data"), s(
              tt.width === ot && tt.height === Ue,
              "invalid shape for mip images"
            ), s(
              tt.format === I.format && tt.internalformat === I.internalformat && tt.type === I.type,
              "incompatible type for mip image"
            ), tt.compressed || (tt.data ? s(
              tt.data.byteLength === ot * Ue * Math.max(_t(tt.type, xe), tt.unpackAlignment),
              "invalid data for image, buffer size is inconsistent with image format"
            ) : tt.element || tt.copy);
          }
        }
      }
    }
    var N = n(s, {
      optional: G,
      raise: o,
      commandRaise: k,
      command: L,
      parameter: f,
      commandParameter: O,
      constructor: g,
      type: h,
      commandType: D,
      isTypedArray: l,
      nni: d,
      oneOf: v,
      shaderError: S,
      linkError: A,
      callSite: w,
      saveCommandRef: T,
      saveDrawInfo: P,
      framebufferFormat: R,
      guessCommand: _,
      texture2D: Ye,
      textureCube: vt
    }), Z = 0, pe = 0, se = 5, Ce = 6;
    function ke(I, z) {
      this.id = Z++, this.type = I, this.data = z;
    }
    function at(I) {
      return I.replace(/\\/g, "\\\\").replace(/"/g, '\\"');
    }
    function je(I) {
      if (I.length === 0)
        return [];
      var z = I.charAt(0), H = I.charAt(I.length - 1);
      if (I.length > 1 && z === H && (z === '"' || z === "'"))
        return ['"' + at(I.substr(1, I.length - 2)) + '"'];
      var me = /\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(I);
      if (me)
        return je(I.substr(0, me.index)).concat(je(me[1])).concat(je(I.substr(me.index + me[0].length)));
      var Ie = I.split(".");
      if (Ie.length === 1)
        return ['"' + at(I) + '"'];
      for (var ye = [], xe = 0; xe < Ie.length; ++xe)
        ye = ye.concat(je(Ie[xe]));
      return ye;
    }
    function lt(I) {
      return "[" + je(I).join("][") + "]";
    }
    function ct(I, z) {
      return new ke(I, lt(z + ""));
    }
    function Ot(I) {
      return typeof I == "function" && !I._reglType || I instanceof ke;
    }
    function mt(I, z) {
      if (typeof I == "function")
        return new ke(pe, I);
      if (typeof I == "number" || typeof I == "boolean")
        return new ke(se, I);
      if (Array.isArray(I))
        return new ke(Ce, I.map((H, me) => mt(H, z + "[" + me + "]")));
      if (I instanceof ke)
        return I;
      N(!1, "invalid option type in uniform " + z);
    }
    var pr = {
      DynamicVariable: ke,
      define: ct,
      isDynamic: Ot,
      unbox: mt,
      accessor: lt
    }, _r = {
      next: typeof requestAnimationFrame == "function" ? function(I) {
        return requestAnimationFrame(I);
      } : function(I) {
        return setTimeout(I, 16);
      },
      cancel: typeof cancelAnimationFrame == "function" ? function(I) {
        return cancelAnimationFrame(I);
      } : clearTimeout
    }, jr = typeof performance < "u" && performance.now ? function() {
      return performance.now();
    } : function() {
      return +new Date();
    };
    function Cr() {
      var I = { "": 0 }, z = [""];
      return {
        id: function(H) {
          var me = I[H];
          return me || (me = I[H] = z.length, z.push(H), me);
        },
        str: function(H) {
          return z[H];
        }
      };
    }
    function mn(I, z, H) {
      var me = document.createElement("canvas");
      n(me.style, {
        border: 0,
        margin: 0,
        padding: 0,
        top: 0,
        left: 0
      }), I.appendChild(me), I === document.body && (me.style.position = "absolute", n(I.style, {
        margin: 0,
        padding: 0
      }));
      function Ie() {
        var ze = window.innerWidth, We = window.innerHeight;
        if (I !== document.body) {
          var Ze = I.getBoundingClientRect();
          ze = Ze.right - Ze.left, We = Ze.bottom - Ze.top;
        }
        me.width = H * ze, me.height = H * We, n(me.style, {
          width: ze + "px",
          height: We + "px"
        });
      }
      var ye;
      I !== document.body && typeof ResizeObserver == "function" ? (ye = new ResizeObserver(function() {
        setTimeout(Ie);
      }), ye.observe(I)) : window.addEventListener("resize", Ie, !1);
      function xe() {
        ye ? ye.disconnect() : window.removeEventListener("resize", Ie), I.removeChild(me);
      }
      return Ie(), {
        canvas: me,
        onDestroy: xe
      };
    }
    function hr(I, z) {
      function H(me) {
        try {
          return I.getContext(me, z);
        } catch {
          return null;
        }
      }
      return H("webgl") || H("experimental-webgl") || H("webgl-experimental");
    }
    function Vr(I) {
      return typeof I.nodeName == "string" && typeof I.appendChild == "function" && typeof I.getBoundingClientRect == "function";
    }
    function di(I) {
      return typeof I.drawArrays == "function" || typeof I.drawElements == "function";
    }
    function Zr(I) {
      return typeof I == "string" ? I.split() : (N(Array.isArray(I), "invalid extension array"), I);
    }
    function fa(I) {
      return typeof I == "string" ? (N(typeof document < "u", "not supported outside of DOM"), document.querySelector(I)) : I;
    }
    function Es(I) {
      var z = I || {}, H, me, Ie, ye, xe = {}, ze = [], We = [], Ze = typeof window > "u" ? 1 : window.devicePixelRatio, Ve = !1, tt = function(rt) {
        rt && N.raise(rt);
      }, ot = function() {
      };
      if (typeof z == "string" ? (N(
        typeof document < "u",
        "selector queries only supported in DOM enviroments"
      ), H = document.querySelector(z), N(H, "invalid query string for element")) : typeof z == "object" ? Vr(z) ? H = z : di(z) ? (ye = z, Ie = ye.canvas) : (N.constructor(z), "gl" in z ? ye = z.gl : "canvas" in z ? Ie = fa(z.canvas) : "container" in z && (me = fa(z.container)), "attributes" in z && (xe = z.attributes, N.type(xe, "object", "invalid context attributes")), "extensions" in z && (ze = Zr(z.extensions)), "optionalExtensions" in z && (We = Zr(z.optionalExtensions)), "onDone" in z && (N.type(
        z.onDone,
        "function",
        "invalid or missing onDone callback"
      ), tt = z.onDone), "profile" in z && (Ve = !!z.profile), "pixelRatio" in z && (Ze = +z.pixelRatio, N(Ze > 0, "invalid pixel ratio"))) : N.raise("invalid arguments to regl"), H && (H.nodeName.toLowerCase() === "canvas" ? Ie = H : me = H), !ye) {
        if (!Ie) {
          N(
            typeof document < "u",
            "must manually specify webgl context outside of DOM environments"
          );
          var Ue = mn(me || document.body, tt, Ze);
          if (!Ue)
            return null;
          Ie = Ue.canvas, ot = Ue.onDestroy;
        }
        xe.premultipliedAlpha === void 0 && (xe.premultipliedAlpha = !0), ye = hr(Ie, xe);
      }
      return ye ? {
        gl: ye,
        canvas: Ie,
        container: me,
        extensions: ze,
        optionalExtensions: We,
        pixelRatio: Ze,
        profile: Ve,
        onDone: tt,
        onDestroy: ot
      } : (ot(), tt("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"), null);
    }
    function Ss(I, z) {
      var H = {};
      function me(xe) {
        N.type(xe, "string", "extension name must be string");
        var ze = xe.toLowerCase(), We;
        try {
          We = H[ze] = I.getExtension(ze);
        } catch {
        }
        return !!We;
      }
      for (var Ie = 0; Ie < z.extensions.length; ++Ie) {
        var ye = z.extensions[Ie];
        if (!me(ye))
          return z.onDestroy(), z.onDone('"' + ye + '" extension is not supported by the current WebGL context, try upgrading your system or a different browser'), null;
      }
      return z.optionalExtensions.forEach(me), {
        extensions: H,
        restore: function() {
          Object.keys(H).forEach(function(xe) {
            if (H[xe] && !me(xe))
              throw new Error("(regl): error restoring extension " + xe);
          });
        }
      };
    }
    function dn(I, z) {
      for (var H = Array(I), me = 0; me < I; ++me)
        H[me] = z(me);
      return H;
    }
    var Vi = 5120, Ha = 5121, Ms = 5122, Cs = 5123, Ts = 5124, vi = 5125, Xr = 5126;
    function pi(I) {
      for (var z = 16; z <= 1 << 28; z *= 16)
        if (I <= z)
          return z;
      return 0;
    }
    function $t(I) {
      var z, H;
      return z = (I > 65535) << 4, I >>>= z, H = (I > 255) << 3, I >>>= H, z |= H, H = (I > 15) << 2, I >>>= H, z |= H, H = (I > 3) << 1, I >>>= H, z |= H, z | I >> 1;
    }
    function Ar() {
      var I = dn(8, function() {
        return [];
      });
      function z(ye) {
        var xe = pi(ye), ze = I[$t(xe) >> 2];
        return ze.length > 0 ? ze.pop() : new ArrayBuffer(xe);
      }
      function H(ye) {
        I[$t(ye.byteLength) >> 2].push(ye);
      }
      function me(ye, xe) {
        var ze = null;
        switch (ye) {
          case Vi:
            ze = new Int8Array(z(xe), 0, xe);
            break;
          case Ha:
            ze = new Uint8Array(z(xe), 0, xe);
            break;
          case Ms:
            ze = new Int16Array(z(2 * xe), 0, xe);
            break;
          case Cs:
            ze = new Uint16Array(z(2 * xe), 0, xe);
            break;
          case Ts:
            ze = new Int32Array(z(4 * xe), 0, xe);
            break;
          case vi:
            ze = new Uint32Array(z(4 * xe), 0, xe);
            break;
          case Xr:
            ze = new Float32Array(z(4 * xe), 0, xe);
            break;
          default:
            return null;
        }
        return ze.length !== xe ? ze.subarray(0, xe) : ze;
      }
      function Ie(ye) {
        H(ye.buffer);
      }
      return {
        alloc: z,
        free: H,
        allocType: me,
        freeType: Ie
      };
    }
    var Lt = Ar();
    Lt.zero = Ar();
    var Rr = 3408, bn = 3410, Ka = 3411, la = 3412, Xi = 3413, qa = 3414, Za = 3415, Qa = 33901, Mg = 33902, Cg = 3379, Tg = 3386, Ag = 34921, Ig = 36347, Pg = 36348, Og = 35661, A4 = 35660, I4 = 34930, P4 = 36349, O4 = 34076, D4 = 34024, k4 = 7936, L4 = 7937, N4 = 7938, R4 = 35724, B4 = 34047, G4 = 36063, F4 = 34852, Ih = 3553, c_ = 34067, z4 = 34069, U4 = 33984, ul = 6408, Dg = 5126, h_ = 5121, kg = 36160, j4 = 36053, $4 = 36064, W4 = 16384, V4 = function(I, z) {
      var H = 1;
      z.ext_texture_filter_anisotropic && (H = I.getParameter(B4));
      var me = 1, Ie = 1;
      z.webgl_draw_buffers && (me = I.getParameter(F4), Ie = I.getParameter(G4));
      var ye = !!z.oes_texture_float;
      if (ye) {
        var xe = I.createTexture();
        I.bindTexture(Ih, xe), I.texImage2D(Ih, 0, ul, 1, 1, 0, ul, Dg, null);
        var ze = I.createFramebuffer();
        if (I.bindFramebuffer(kg, ze), I.framebufferTexture2D(kg, $4, Ih, xe, 0), I.bindTexture(Ih, null), I.checkFramebufferStatus(kg) !== j4)
          ye = !1;
        else {
          I.viewport(0, 0, 1, 1), I.clearColor(1, 0, 0, 1), I.clear(W4);
          var We = Lt.allocType(Dg, 4);
          I.readPixels(0, 0, 1, 1, ul, Dg, We), I.getError() ? ye = !1 : (I.deleteFramebuffer(ze), I.deleteTexture(xe), ye = We[0] === 1), Lt.freeType(We);
        }
      }
      var Ze = typeof navigator < "u" && (/MSIE/.test(navigator.userAgent) || /Trident\//.test(navigator.appVersion) || /Edge/.test(navigator.userAgent)), Ve = !0;
      if (!Ze) {
        var tt = I.createTexture(), ot = Lt.allocType(h_, 36);
        I.activeTexture(U4), I.bindTexture(c_, tt), I.texImage2D(z4, 0, ul, 3, 3, 0, ul, h_, ot), Lt.freeType(ot), I.bindTexture(c_, null), I.deleteTexture(tt), Ve = !I.getError();
      }
      return {
        colorBits: [
          I.getParameter(bn),
          I.getParameter(Ka),
          I.getParameter(la),
          I.getParameter(Xi)
        ],
        depthBits: I.getParameter(qa),
        stencilBits: I.getParameter(Za),
        subpixelBits: I.getParameter(Rr),
        extensions: Object.keys(z).filter(function(Ue) {
          return !!z[Ue];
        }),
        maxAnisotropic: H,
        maxDrawbuffers: me,
        maxColorAttachments: Ie,
        pointSizeDims: I.getParameter(Qa),
        lineWidthDims: I.getParameter(Mg),
        maxViewportDims: I.getParameter(Tg),
        maxCombinedTextureUnits: I.getParameter(Og),
        maxCubeMapSize: I.getParameter(O4),
        maxRenderbufferSize: I.getParameter(D4),
        maxTextureUnits: I.getParameter(I4),
        maxTextureSize: I.getParameter(Cg),
        maxAttributes: I.getParameter(Ag),
        maxVertexUniforms: I.getParameter(Ig),
        maxVertexTextureUnits: I.getParameter(A4),
        maxVaryingVectors: I.getParameter(Pg),
        maxFragmentUniforms: I.getParameter(P4),
        glsl: I.getParameter(R4),
        renderer: I.getParameter(L4),
        vendor: I.getParameter(k4),
        version: I.getParameter(N4),
        readFloat: ye,
        npotTextureCube: Ve
      };
    };
    function Yi(I) {
      return !!I && typeof I == "object" && Array.isArray(I.shape) && Array.isArray(I.stride) && typeof I.offset == "number" && I.shape.length === I.stride.length && (Array.isArray(I.data) || e(I.data));
    }
    var gi = function(I) {
      return Object.keys(I).map(function(z) {
        return I[z];
      });
    }, Ph = {
      shape: K4,
      flatten: H4
    };
    function X4(I, z, H) {
      for (var me = 0; me < z; ++me)
        H[me] = I[me];
    }
    function Y4(I, z, H, me) {
      for (var Ie = 0, ye = 0; ye < z; ++ye)
        for (var xe = I[ye], ze = 0; ze < H; ++ze)
          me[Ie++] = xe[ze];
    }
    function d_(I, z, H, me, Ie, ye) {
      for (var xe = ye, ze = 0; ze < z; ++ze)
        for (var We = I[ze], Ze = 0; Ze < H; ++Ze)
          for (var Ve = We[Ze], tt = 0; tt < me; ++tt)
            Ie[xe++] = Ve[tt];
    }
    function v_(I, z, H, me, Ie) {
      for (var ye = 1, xe = H + 1; xe < z.length; ++xe)
        ye *= z[xe];
      var ze = z[H];
      if (z.length - H === 4) {
        var We = z[H + 1], Ze = z[H + 2], Ve = z[H + 3];
        for (xe = 0; xe < ze; ++xe)
          d_(I[xe], We, Ze, Ve, me, Ie), Ie += ye;
      } else
        for (xe = 0; xe < ze; ++xe)
          v_(I[xe], z, H + 1, me, Ie), Ie += ye;
    }
    function H4(I, z, H, me) {
      var Ie = 1;
      if (z.length)
        for (var ye = 0; ye < z.length; ++ye)
          Ie *= z[ye];
      else
        Ie = 0;
      var xe = me || Lt.allocType(H, Ie);
      switch (z.length) {
        case 0:
          break;
        case 1:
          X4(I, z[0], xe);
          break;
        case 2:
          Y4(I, z[0], z[1], xe);
          break;
        case 3:
          d_(I, z[0], z[1], z[2], xe, 0);
          break;
        default:
          v_(I, z, 0, xe, 0);
      }
      return xe;
    }
    function K4(I) {
      for (var z = [], H = I; H.length; H = H[0])
        z.push(H.length);
      return z;
    }
    var Lg = {
      "[object Int8Array]": 5120,
      "[object Int16Array]": 5122,
      "[object Int32Array]": 5124,
      "[object Uint8Array]": 5121,
      "[object Uint8ClampedArray]": 5121,
      "[object Uint16Array]": 5123,
      "[object Uint32Array]": 5125,
      "[object Float32Array]": 5126,
      "[object Float64Array]": 5121,
      "[object ArrayBuffer]": 5121
    }, q4 = 5120, Z4 = 5122, Q4 = 5124, J4 = 5121, eG = 5123, tG = 5125, rG = 5126, nG = 5126, As = {
      int8: q4,
      int16: Z4,
      int32: Q4,
      uint8: J4,
      uint16: eG,
      uint32: tG,
      float: rG,
      float32: nG
    }, iG = 35048, aG = 35040, Oh = {
      dynamic: iG,
      stream: aG,
      static: 35044
    }, Ng = Ph.flatten, p_ = Ph.shape, g_ = 35044, oG = 35040, Rg = 5121, Bg = 5126, Ro = [];
    Ro[5120] = 1, Ro[5122] = 2, Ro[5124] = 4, Ro[5121] = 1, Ro[5123] = 2, Ro[5125] = 4, Ro[5126] = 4;
    function Dh(I) {
      return Lg[Object.prototype.toString.call(I)] | 0;
    }
    function y_(I, z) {
      for (var H = 0; H < z.length; ++H)
        I[H] = z[H];
    }
    function m_(I, z, H, me, Ie, ye, xe) {
      for (var ze = 0, We = 0; We < H; ++We)
        for (var Ze = 0; Ze < me; ++Ze)
          I[ze++] = z[Ie * We + ye * Ze + xe];
    }
    function sG(I, z, H, me) {
      var Ie = 0, ye = {};
      function xe(ce) {
        this.id = Ie++, this.buffer = I.createBuffer(), this.type = ce, this.usage = g_, this.byteLength = 0, this.dimension = 1, this.dtype = Rg, this.persistentData = null, H.profile && (this.stats = { size: 0 });
      }
      xe.prototype.bind = function() {
        I.bindBuffer(this.type, this.buffer);
      }, xe.prototype.destroy = function() {
        ot(this);
      };
      var ze = [];
      function We(ce, _e) {
        var qe = ze.pop();
        return qe || (qe = new xe(ce)), qe.bind(), tt(qe, _e, oG, 0, 1, !1), qe;
      }
      function Ze(ce) {
        ze.push(ce);
      }
      function Ve(ce, _e, qe) {
        ce.byteLength = _e.byteLength, I.bufferData(ce.type, _e, qe);
      }
      function tt(ce, _e, qe, ht, Ne, gt) {
        var Be;
        if (ce.usage = qe, Array.isArray(_e)) {
          if (ce.dtype = ht || Bg, _e.length > 0) {
            var nt;
            if (Array.isArray(_e[0])) {
              Be = p_(_e);
              for (var Re = 1, it = 1; it < Be.length; ++it)
                Re *= Be[it];
              ce.dimension = Re, nt = Ng(_e, Be, ce.dtype), Ve(ce, nt, qe), gt ? ce.persistentData = nt : Lt.freeType(nt);
            } else if (typeof _e[0] == "number") {
              ce.dimension = Ne;
              var It = Lt.allocType(ce.dtype, _e.length);
              y_(It, _e), Ve(ce, It, qe), gt ? ce.persistentData = It : Lt.freeType(It);
            } else
              e(_e[0]) ? (ce.dimension = _e[0].length, ce.dtype = ht || Dh(_e[0]) || Bg, nt = Ng(
                _e,
                [_e.length, _e[0].length],
                ce.dtype
              ), Ve(ce, nt, qe), gt ? ce.persistentData = nt : Lt.freeType(nt)) : N.raise("invalid buffer data");
          }
        } else if (e(_e))
          ce.dtype = ht || Dh(_e), ce.dimension = Ne, Ve(ce, _e, qe), gt && (ce.persistentData = new Uint8Array(new Uint8Array(_e.buffer)));
        else if (Yi(_e)) {
          Be = _e.shape;
          var Vt = _e.stride, st = _e.offset, Je = 0, Le = 0, jt = 0, qt = 0;
          Be.length === 1 ? (Je = Be[0], Le = 1, jt = Vt[0], qt = 0) : Be.length === 2 ? (Je = Be[0], Le = Be[1], jt = Vt[0], qt = Vt[1]) : N.raise("invalid shape"), ce.dtype = ht || Dh(_e.data) || Bg, ce.dimension = Le;
          var bt = Lt.allocType(ce.dtype, Je * Le);
          m_(
            bt,
            _e.data,
            Je,
            Le,
            jt,
            qt,
            st
          ), Ve(ce, bt, qe), gt ? ce.persistentData = bt : Lt.freeType(bt);
        } else
          _e instanceof ArrayBuffer ? (ce.dtype = Rg, ce.dimension = Ne, Ve(ce, _e, qe), gt && (ce.persistentData = new Uint8Array(new Uint8Array(_e)))) : N.raise("invalid buffer data");
      }
      function ot(ce) {
        z.bufferCount--, me(ce);
        var _e = ce.buffer;
        N(_e, "buffer must not be deleted already"), I.deleteBuffer(_e), ce.buffer = null, delete ye[ce.id];
      }
      function Ue(ce, _e, qe, ht) {
        z.bufferCount++;
        var Ne = new xe(_e);
        ye[Ne.id] = Ne;
        function gt(Re) {
          var it = g_, It = null, Vt = 0, st = 0, Je = 1;
          return Array.isArray(Re) || e(Re) || Yi(Re) || Re instanceof ArrayBuffer ? It = Re : typeof Re == "number" ? Vt = Re | 0 : Re && (N.type(
            Re,
            "object",
            "buffer arguments must be an object, a number or an array"
          ), "data" in Re && (N(
            It === null || Array.isArray(It) || e(It) || Yi(It),
            "invalid data for buffer"
          ), It = Re.data), "usage" in Re && (N.parameter(Re.usage, Oh, "invalid buffer usage"), it = Oh[Re.usage]), "type" in Re && (N.parameter(Re.type, As, "invalid buffer type"), st = As[Re.type]), "dimension" in Re && (N.type(Re.dimension, "number", "invalid dimension"), Je = Re.dimension | 0), "length" in Re && (N.nni(Vt, "buffer length must be a nonnegative integer"), Vt = Re.length | 0)), Ne.bind(), It ? tt(Ne, It, it, st, Je, ht) : (Vt && I.bufferData(Ne.type, Vt, it), Ne.dtype = st || Rg, Ne.usage = it, Ne.dimension = Je, Ne.byteLength = Vt), H.profile && (Ne.stats.size = Ne.byteLength * Ro[Ne.dtype]), gt;
        }
        function Be(Re, it) {
          N(
            it + Re.byteLength <= Ne.byteLength,
            "invalid buffer subdata call, buffer is too small.  Can't write data of size " + Re.byteLength + " starting from offset " + it + " to a buffer of size " + Ne.byteLength
          ), I.bufferSubData(Ne.type, it, Re);
        }
        function nt(Re, it) {
          var It = (it || 0) | 0, Vt;
          if (Ne.bind(), e(Re) || Re instanceof ArrayBuffer)
            Be(Re, It);
          else if (Array.isArray(Re)) {
            if (Re.length > 0)
              if (typeof Re[0] == "number") {
                var st = Lt.allocType(Ne.dtype, Re.length);
                y_(st, Re), Be(st, It), Lt.freeType(st);
              } else if (Array.isArray(Re[0]) || e(Re[0])) {
                Vt = p_(Re);
                var Je = Ng(Re, Vt, Ne.dtype);
                Be(Je, It), Lt.freeType(Je);
              } else
                N.raise("invalid buffer data");
          } else if (Yi(Re)) {
            Vt = Re.shape;
            var Le = Re.stride, jt = 0, qt = 0, bt = 0, er = 0;
            Vt.length === 1 ? (jt = Vt[0], qt = 1, bt = Le[0], er = 0) : Vt.length === 2 ? (jt = Vt[0], qt = Vt[1], bt = Le[0], er = Le[1]) : N.raise("invalid shape");
            var Xt = Array.isArray(Re.data) ? Ne.dtype : Dh(Re.data), Jt = Lt.allocType(Xt, jt * qt);
            m_(
              Jt,
              Re.data,
              jt,
              qt,
              bt,
              er,
              Re.offset
            ), Be(Jt, It), Lt.freeType(Jt);
          } else
            N.raise("invalid data for buffer subdata");
          return gt;
        }
        return qe || gt(ce), gt._reglType = "buffer", gt._buffer = Ne, gt.subdata = nt, H.profile && (gt.stats = Ne.stats), gt.destroy = function() {
          ot(Ne);
        }, gt;
      }
      function rt() {
        gi(ye).forEach(function(ce) {
          ce.buffer = I.createBuffer(), I.bindBuffer(ce.type, ce.buffer), I.bufferData(
            ce.type,
            ce.persistentData || ce.byteLength,
            ce.usage
          );
        });
      }
      return H.profile && (z.getTotalBufferSize = function() {
        var ce = 0;
        return Object.keys(ye).forEach(function(_e) {
          ce += ye[_e].stats.size;
        }), ce;
      }), {
        create: Ue,
        createStream: We,
        destroyStream: Ze,
        clear: function() {
          gi(ye).forEach(ot), ze.forEach(ot);
        },
        getBuffer: function(ce) {
          return ce && ce._buffer instanceof xe ? ce._buffer : null;
        },
        restore: rt,
        _initBuffer: tt
      };
    }
    var uG = 0, fG = 0, lG = 1, cG = 1, hG = 4, dG = 4, Lu = {
      points: uG,
      point: fG,
      lines: lG,
      line: cG,
      triangles: hG,
      triangle: dG,
      "line loop": 2,
      "line strip": 3,
      "triangle strip": 5,
      "triangle fan": 6
    }, vG = 0, pG = 1, fl = 4, gG = 5120, Nu = 5121, b_ = 5122, Ru = 5123, x_ = 5124, Is = 5125, Gg = 34963, yG = 35040, mG = 35044;
    function bG(I, z, H, me) {
      var Ie = {}, ye = 0, xe = {
        uint8: Nu,
        uint16: Ru
      };
      z.oes_element_index_uint && (xe.uint32 = Is);
      function ze(rt) {
        this.id = ye++, Ie[this.id] = this, this.buffer = rt, this.primType = fl, this.vertCount = 0, this.type = 0;
      }
      ze.prototype.bind = function() {
        this.buffer.bind();
      };
      var We = [];
      function Ze(rt) {
        var ce = We.pop();
        return ce || (ce = new ze(H.create(
          null,
          Gg,
          !0,
          !1
        )._buffer)), tt(ce, rt, yG, -1, -1, 0, 0), ce;
      }
      function Ve(rt) {
        We.push(rt);
      }
      function tt(rt, ce, _e, qe, ht, Ne, gt) {
        rt.buffer.bind();
        var Be;
        if (ce) {
          var nt = gt;
          !gt && (!e(ce) || Yi(ce) && !e(ce.data)) && (nt = z.oes_element_index_uint ? Is : Ru), H._initBuffer(
            rt.buffer,
            ce,
            _e,
            nt,
            3
          );
        } else
          I.bufferData(Gg, Ne, _e), rt.buffer.dtype = Be || Nu, rt.buffer.usage = _e, rt.buffer.dimension = 3, rt.buffer.byteLength = Ne;
        if (Be = gt, !gt) {
          switch (rt.buffer.dtype) {
            case Nu:
            case gG:
              Be = Nu;
              break;
            case Ru:
            case b_:
              Be = Ru;
              break;
            case Is:
            case x_:
              Be = Is;
              break;
            default:
              N.raise("unsupported type for element array");
          }
          rt.buffer.dtype = Be;
        }
        rt.type = Be, N(
          Be !== Is || !!z.oes_element_index_uint,
          "32 bit element buffers not supported, enable oes_element_index_uint first"
        );
        var Re = ht;
        Re < 0 && (Re = rt.buffer.byteLength, Be === Ru ? Re >>= 1 : Be === Is && (Re >>= 2)), rt.vertCount = Re;
        var it = qe;
        if (qe < 0) {
          it = fl;
          var It = rt.buffer.dimension;
          It === 1 && (it = vG), It === 2 && (it = pG), It === 3 && (it = fl);
        }
        rt.primType = it;
      }
      function ot(rt) {
        me.elementsCount--, N(rt.buffer !== null, "must not double destroy elements"), delete Ie[rt.id], rt.buffer.destroy(), rt.buffer = null;
      }
      function Ue(rt, ce) {
        var _e = H.create(null, Gg, !0), qe = new ze(_e._buffer);
        me.elementsCount++;
        function ht(Ne) {
          if (!Ne)
            _e(), qe.primType = fl, qe.vertCount = 0, qe.type = Nu;
          else if (typeof Ne == "number")
            _e(Ne), qe.primType = fl, qe.vertCount = Ne | 0, qe.type = Nu;
          else {
            var gt = null, Be = mG, nt = -1, Re = -1, it = 0, It = 0;
            Array.isArray(Ne) || e(Ne) || Yi(Ne) ? gt = Ne : (N.type(Ne, "object", "invalid arguments for elements"), "data" in Ne && (gt = Ne.data, N(
              Array.isArray(gt) || e(gt) || Yi(gt),
              "invalid data for element buffer"
            )), "usage" in Ne && (N.parameter(
              Ne.usage,
              Oh,
              "invalid element buffer usage"
            ), Be = Oh[Ne.usage]), "primitive" in Ne && (N.parameter(
              Ne.primitive,
              Lu,
              "invalid element buffer primitive"
            ), nt = Lu[Ne.primitive]), "count" in Ne && (N(
              typeof Ne.count == "number" && Ne.count >= 0,
              "invalid vertex count for elements"
            ), Re = Ne.count | 0), "type" in Ne && (N.parameter(
              Ne.type,
              xe,
              "invalid buffer type"
            ), It = xe[Ne.type]), "length" in Ne ? it = Ne.length | 0 : (it = Re, It === Ru || It === b_ ? it *= 2 : (It === Is || It === x_) && (it *= 4))), tt(
              qe,
              gt,
              Be,
              nt,
              Re,
              it,
              It
            );
          }
          return ht;
        }
        return ht(rt), ht._reglType = "elements", ht._elements = qe, ht.subdata = function(Ne, gt) {
          return _e.subdata(Ne, gt), ht;
        }, ht.destroy = function() {
          ot(qe);
        }, ht;
      }
      return {
        create: Ue,
        createStream: Ze,
        destroyStream: Ve,
        getElements: function(rt) {
          return typeof rt == "function" && rt._elements instanceof ze ? rt._elements : null;
        },
        clear: function() {
          gi(Ie).forEach(ot);
        }
      };
    }
    var __ = new Float32Array(1), xG = new Uint32Array(__.buffer), _G = 5123;
    function w_(I) {
      for (var z = Lt.allocType(_G, I.length), H = 0; H < I.length; ++H)
        if (isNaN(I[H]))
          z[H] = 65535;
        else if (I[H] === 1 / 0)
          z[H] = 31744;
        else if (I[H] === -1 / 0)
          z[H] = 64512;
        else {
          __[0] = I[H];
          var me = xG[0], Ie = me >>> 31 << 15, ye = (me << 1 >>> 24) - 127, xe = me >> 13 & (1 << 10) - 1;
          if (ye < -24)
            z[H] = Ie;
          else if (ye < -14) {
            var ze = -14 - ye;
            z[H] = Ie + (xe + (1 << 10) >> ze);
          } else
            ye > 15 ? z[H] = Ie + 31744 : z[H] = Ie + (ye + 15 << 10) + xe;
        }
      return z;
    }
    function Yr(I) {
      return Array.isArray(I) || e(I);
    }
    var E_ = function(I) {
      return !(I & I - 1) && !!I;
    }, wG = 34467, ca = 3553, Fg = 34067, kh = 34069, Ps = 6408, zg = 6406, Lh = 6407, ll = 6409, Nh = 6410, S_ = 32854, Ug = 32855, M_ = 36194, EG = 32819, SG = 32820, MG = 33635, CG = 34042, jg = 6402, Rh = 34041, $g = 35904, Wg = 35906, Bu = 36193, Vg = 33776, Xg = 33777, Yg = 33778, Hg = 33779, C_ = 35986, T_ = 35987, A_ = 34798, I_ = 35840, P_ = 35841, O_ = 35842, D_ = 35843, k_ = 36196, Gu = 5121, Kg = 5123, qg = 5125, cl = 5126, TG = 10242, AG = 10243, IG = 10497, Zg = 33071, PG = 33648, OG = 10240, DG = 10241, Qg = 9728, kG = 9729, Jg = 9984, L_ = 9985, N_ = 9986, e0 = 9987, LG = 33170, Bh = 4352, NG = 4353, RG = 4354, BG = 34046, GG = 3317, FG = 37440, zG = 37441, UG = 37443, R_ = 37444, hl = 33984, jG = [
      Jg,
      N_,
      L_,
      e0
    ], Gh = [
      0,
      ll,
      Nh,
      Lh,
      Ps
    ], Ci = {};
    Ci[ll] = Ci[zg] = Ci[jg] = 1, Ci[Rh] = Ci[Nh] = 2, Ci[Lh] = Ci[$g] = 3, Ci[Ps] = Ci[Wg] = 4;
    function Fu(I) {
      return "[object " + I + "]";
    }
    var B_ = Fu("HTMLCanvasElement"), G_ = Fu("OffscreenCanvas"), F_ = Fu("CanvasRenderingContext2D"), z_ = Fu("ImageBitmap"), U_ = Fu("HTMLImageElement"), j_ = Fu("HTMLVideoElement"), $G = Object.keys(Lg).concat([
      B_,
      G_,
      F_,
      z_,
      U_,
      j_
    ]), zu = [];
    zu[Gu] = 1, zu[cl] = 4, zu[Bu] = 2, zu[Kg] = 2, zu[qg] = 4;
    var Tn = [];
    Tn[S_] = 2, Tn[Ug] = 2, Tn[M_] = 2, Tn[Rh] = 4, Tn[Vg] = 0.5, Tn[Xg] = 0.5, Tn[Yg] = 1, Tn[Hg] = 1, Tn[C_] = 0.5, Tn[T_] = 1, Tn[A_] = 1, Tn[I_] = 0.5, Tn[P_] = 0.25, Tn[O_] = 0.5, Tn[D_] = 0.25, Tn[k_] = 0.5;
    function $_(I) {
      return Array.isArray(I) && (I.length === 0 || typeof I[0] == "number");
    }
    function W_(I) {
      if (!Array.isArray(I))
        return !1;
      var z = I.length;
      return !(z === 0 || !Yr(I[0]));
    }
    function Os(I) {
      return Object.prototype.toString.call(I);
    }
    function V_(I) {
      return Os(I) === B_;
    }
    function X_(I) {
      return Os(I) === G_;
    }
    function WG(I) {
      return Os(I) === F_;
    }
    function VG(I) {
      return Os(I) === z_;
    }
    function XG(I) {
      return Os(I) === U_;
    }
    function YG(I) {
      return Os(I) === j_;
    }
    function t0(I) {
      if (!I)
        return !1;
      var z = Os(I);
      return $G.indexOf(z) >= 0 ? !0 : $_(I) || W_(I) || Yi(I);
    }
    function Y_(I) {
      return Lg[Object.prototype.toString.call(I)] | 0;
    }
    function HG(I, z) {
      var H = z.length;
      switch (I.type) {
        case Gu:
        case Kg:
        case qg:
        case cl:
          var me = Lt.allocType(I.type, H);
          me.set(z), I.data = me;
          break;
        case Bu:
          I.data = w_(z);
          break;
        default:
          N.raise("unsupported texture type, must specify a typed array");
      }
    }
    function H_(I, z) {
      return Lt.allocType(
        I.type === Bu ? cl : I.type,
        z
      );
    }
    function K_(I, z) {
      I.type === Bu ? (I.data = w_(z), Lt.freeType(z)) : I.data = z;
    }
    function KG(I, z, H, me, Ie, ye) {
      for (var xe = I.width, ze = I.height, We = I.channels, Ze = xe * ze * We, Ve = H_(I, Ze), tt = 0, ot = 0; ot < ze; ++ot)
        for (var Ue = 0; Ue < xe; ++Ue)
          for (var rt = 0; rt < We; ++rt)
            Ve[tt++] = z[H * Ue + me * ot + Ie * rt + ye];
      K_(I, Ve);
    }
    function Fh(I, z, H, me, Ie, ye) {
      var xe;
      if (typeof Tn[I] < "u" ? xe = Tn[I] : xe = Ci[I] * zu[z], ye && (xe *= 6), Ie) {
        for (var ze = 0, We = H; We >= 1; )
          ze += xe * We * We, We /= 2;
        return ze;
      } else
        return xe * H * me;
    }
    function qG(I, z, H, me, Ie, ye, xe) {
      var ze = {
        "don't care": Bh,
        "dont care": Bh,
        nice: RG,
        fast: NG
      }, We = {
        repeat: IG,
        clamp: Zg,
        mirror: PG
      }, Ze = {
        nearest: Qg,
        linear: kG
      }, Ve = n({
        mipmap: e0,
        "nearest mipmap nearest": Jg,
        "linear mipmap nearest": L_,
        "nearest mipmap linear": N_,
        "linear mipmap linear": e0
      }, Ze), tt = {
        none: 0,
        browser: R_
      }, ot = {
        uint8: Gu,
        rgba4: EG,
        rgb565: MG,
        "rgb5 a1": SG
      }, Ue = {
        alpha: zg,
        luminance: ll,
        "luminance alpha": Nh,
        rgb: Lh,
        rgba: Ps,
        rgba4: S_,
        "rgb5 a1": Ug,
        rgb565: M_
      }, rt = {};
      z.ext_srgb && (Ue.srgb = $g, Ue.srgba = Wg), z.oes_texture_float && (ot.float32 = ot.float = cl), z.oes_texture_half_float && (ot.float16 = ot["half float"] = Bu), z.webgl_depth_texture && (n(Ue, {
        depth: jg,
        "depth stencil": Rh
      }), n(ot, {
        uint16: Kg,
        uint32: qg,
        "depth stencil": CG
      })), z.webgl_compressed_texture_s3tc && n(rt, {
        "rgb s3tc dxt1": Vg,
        "rgba s3tc dxt1": Xg,
        "rgba s3tc dxt3": Yg,
        "rgba s3tc dxt5": Hg
      }), z.webgl_compressed_texture_atc && n(rt, {
        "rgb atc": C_,
        "rgba atc explicit alpha": T_,
        "rgba atc interpolated alpha": A_
      }), z.webgl_compressed_texture_pvrtc && n(rt, {
        "rgb pvrtc 4bppv1": I_,
        "rgb pvrtc 2bppv1": P_,
        "rgba pvrtc 4bppv1": O_,
        "rgba pvrtc 2bppv1": D_
      }), z.webgl_compressed_texture_etc1 && (rt["rgb etc1"] = k_);
      var ce = Array.prototype.slice.call(
        I.getParameter(wG)
      );
      Object.keys(rt).forEach(function(Y) {
        var be = rt[Y];
        ce.indexOf(be) >= 0 && (Ue[Y] = be);
      });
      var _e = Object.keys(Ue);
      H.textureFormats = _e;
      var qe = [];
      Object.keys(Ue).forEach(function(Y) {
        var be = Ue[Y];
        qe[be] = Y;
      });
      var ht = [];
      Object.keys(ot).forEach(function(Y) {
        var be = ot[Y];
        ht[be] = Y;
      });
      var Ne = [];
      Object.keys(Ze).forEach(function(Y) {
        var be = Ze[Y];
        Ne[be] = Y;
      });
      var gt = [];
      Object.keys(Ve).forEach(function(Y) {
        var be = Ve[Y];
        gt[be] = Y;
      });
      var Be = [];
      Object.keys(We).forEach(function(Y) {
        var be = We[Y];
        Be[be] = Y;
      });
      var nt = _e.reduce(function(Y, be) {
        var ge = Ue[be];
        return ge === ll || ge === zg || ge === ll || ge === Nh || ge === jg || ge === Rh || z.ext_srgb && (ge === $g || ge === Wg) ? Y[ge] = ge : ge === Ug || be.indexOf("rgba") >= 0 ? Y[ge] = Ps : Y[ge] = Lh, Y;
      }, {});
      function Re() {
        this.internalformat = Ps, this.format = Ps, this.type = Gu, this.compressed = !1, this.premultiplyAlpha = !1, this.flipY = !1, this.unpackAlignment = 1, this.colorSpace = R_, this.width = 0, this.height = 0, this.channels = 0;
      }
      function it(Y, be) {
        Y.internalformat = be.internalformat, Y.format = be.format, Y.type = be.type, Y.compressed = be.compressed, Y.premultiplyAlpha = be.premultiplyAlpha, Y.flipY = be.flipY, Y.unpackAlignment = be.unpackAlignment, Y.colorSpace = be.colorSpace, Y.width = be.width, Y.height = be.height, Y.channels = be.channels;
      }
      function It(Y, be) {
        if (!(typeof be != "object" || !be)) {
          if ("premultiplyAlpha" in be && (N.type(
            be.premultiplyAlpha,
            "boolean",
            "invalid premultiplyAlpha"
          ), Y.premultiplyAlpha = be.premultiplyAlpha), "flipY" in be && (N.type(
            be.flipY,
            "boolean",
            "invalid texture flip"
          ), Y.flipY = be.flipY), "alignment" in be && (N.oneOf(
            be.alignment,
            [1, 2, 4, 8],
            "invalid texture unpack alignment"
          ), Y.unpackAlignment = be.alignment), "colorSpace" in be && (N.parameter(
            be.colorSpace,
            tt,
            "invalid colorSpace"
          ), Y.colorSpace = tt[be.colorSpace]), "type" in be) {
            var ge = be.type;
            N(
              z.oes_texture_float || !(ge === "float" || ge === "float32"),
              "you must enable the OES_texture_float extension in order to use floating point textures."
            ), N(
              z.oes_texture_half_float || !(ge === "half float" || ge === "float16"),
              "you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."
            ), N(
              z.webgl_depth_texture || !(ge === "uint16" || ge === "uint32" || ge === "depth stencil"),
              "you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."
            ), N.parameter(
              ge,
              ot,
              "invalid texture type"
            ), Y.type = ot[ge];
          }
          var yt = Y.width, tr = Y.height, W = Y.channels, B = !1;
          "shape" in be ? (N(
            Array.isArray(be.shape) && be.shape.length >= 2,
            "shape must be an array"
          ), yt = be.shape[0], tr = be.shape[1], be.shape.length === 3 && (W = be.shape[2], N(W > 0 && W <= 4, "invalid number of channels"), B = !0), N(yt >= 0 && yt <= H.maxTextureSize, "invalid width"), N(tr >= 0 && tr <= H.maxTextureSize, "invalid height")) : ("radius" in be && (yt = tr = be.radius, N(yt >= 0 && yt <= H.maxTextureSize, "invalid radius")), "width" in be && (yt = be.width, N(yt >= 0 && yt <= H.maxTextureSize, "invalid width")), "height" in be && (tr = be.height, N(tr >= 0 && tr <= H.maxTextureSize, "invalid height")), "channels" in be && (W = be.channels, N(W > 0 && W <= 4, "invalid number of channels"), B = !0)), Y.width = yt | 0, Y.height = tr | 0, Y.channels = W | 0;
          var Q = !1;
          if ("format" in be) {
            var fe = be.format;
            N(
              z.webgl_depth_texture || !(fe === "depth" || fe === "depth stencil"),
              "you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."
            ), N.parameter(
              fe,
              Ue,
              "invalid texture format"
            );
            var de = Y.internalformat = Ue[fe];
            Y.format = nt[de], fe in ot && ("type" in be || (Y.type = ot[fe])), fe in rt && (Y.compressed = !0), Q = !0;
          }
          !B && Q ? Y.channels = Ci[Y.format] : B && !Q ? Y.channels !== Gh[Y.format] && (Y.format = Y.internalformat = Gh[Y.channels]) : Q && B && N(
            Y.channels === Ci[Y.format],
            "number of channels inconsistent with specified format"
          );
        }
      }
      function Vt(Y) {
        I.pixelStorei(FG, Y.flipY), I.pixelStorei(zG, Y.premultiplyAlpha), I.pixelStorei(UG, Y.colorSpace), I.pixelStorei(GG, Y.unpackAlignment);
      }
      function st() {
        Re.call(this), this.xOffset = 0, this.yOffset = 0, this.data = null, this.needsFree = !1, this.element = null, this.needsCopy = !1;
      }
      function Je(Y, be) {
        var ge = null;
        if (t0(be) ? ge = be : be && (N.type(be, "object", "invalid pixel data type"), It(Y, be), "x" in be && (Y.xOffset = be.x | 0), "y" in be && (Y.yOffset = be.y | 0), t0(be.data) && (ge = be.data)), N(
          !Y.compressed || ge instanceof Uint8Array,
          "compressed texture data must be stored in a uint8array"
        ), be.copy) {
          N(!ge, "can not specify copy and data field for the same texture");
          var yt = Ie.viewportWidth, tr = Ie.viewportHeight;
          Y.width = Y.width || yt - Y.xOffset, Y.height = Y.height || tr - Y.yOffset, Y.needsCopy = !0, N(
            Y.xOffset >= 0 && Y.xOffset < yt && Y.yOffset >= 0 && Y.yOffset < tr && Y.width > 0 && Y.width <= yt && Y.height > 0 && Y.height <= tr,
            "copy texture read out of bounds"
          );
        } else if (!ge)
          Y.width = Y.width || 1, Y.height = Y.height || 1, Y.channels = Y.channels || 4;
        else if (e(ge))
          Y.channels = Y.channels || 4, Y.data = ge, !("type" in be) && Y.type === Gu && (Y.type = Y_(ge));
        else if ($_(ge))
          Y.channels = Y.channels || 4, HG(Y, ge), Y.alignment = 1, Y.needsFree = !0;
        else if (Yi(ge)) {
          var W = ge.data;
          !Array.isArray(W) && Y.type === Gu && (Y.type = Y_(W));
          var B = ge.shape, Q = ge.stride, fe, de, re, ee, ae, V;
          B.length === 3 ? (re = B[2], V = Q[2]) : (N(B.length === 2, "invalid ndarray pixel data, must be 2 or 3D"), re = 1, V = 1), fe = B[0], de = B[1], ee = Q[0], ae = Q[1], Y.alignment = 1, Y.width = fe, Y.height = de, Y.channels = re, Y.format = Y.internalformat = Gh[re], Y.needsFree = !0, KG(Y, W, ee, ae, V, ge.offset);
        } else if (V_(ge) || X_(ge) || WG(ge))
          V_(ge) || X_(ge) ? Y.element = ge : Y.element = ge.canvas, Y.width = Y.element.width, Y.height = Y.element.height, Y.channels = 4;
        else if (VG(ge))
          Y.element = ge, Y.width = ge.width, Y.height = ge.height, Y.channels = 4;
        else if (XG(ge))
          Y.element = ge, Y.width = ge.naturalWidth, Y.height = ge.naturalHeight, Y.channels = 4;
        else if (YG(ge))
          Y.element = ge, Y.width = ge.videoWidth, Y.height = ge.videoHeight, Y.channels = 4;
        else if (W_(ge)) {
          var K = Y.width || ge[0].length, j = Y.height || ge.length, ue = Y.channels;
          Yr(ge[0][0]) ? ue = ue || ge[0][0].length : ue = ue || 1;
          for (var ve = Ph.shape(ge), Te = 1, Pe = 0; Pe < ve.length; ++Pe)
            Te *= ve[Pe];
          var we = H_(Y, Te);
          Ph.flatten(ge, ve, "", we), K_(Y, we), Y.alignment = 1, Y.width = K, Y.height = j, Y.channels = ue, Y.format = Y.internalformat = Gh[ue], Y.needsFree = !0;
        }
        Y.type === cl ? N(
          H.extensions.indexOf("oes_texture_float") >= 0,
          "oes_texture_float extension not enabled"
        ) : Y.type === Bu && N(
          H.extensions.indexOf("oes_texture_half_float") >= 0,
          "oes_texture_half_float extension not enabled"
        );
      }
      function Le(Y, be, ge) {
        var yt = Y.element, tr = Y.data, W = Y.internalformat, B = Y.format, Q = Y.type, fe = Y.width, de = Y.height;
        Vt(Y), yt ? I.texImage2D(be, ge, B, B, Q, yt) : Y.compressed ? I.compressedTexImage2D(be, ge, W, fe, de, 0, tr) : Y.needsCopy ? (me(), I.copyTexImage2D(
          be,
          ge,
          B,
          Y.xOffset,
          Y.yOffset,
          fe,
          de,
          0
        )) : I.texImage2D(be, ge, B, fe, de, 0, B, Q, tr || null);
      }
      function jt(Y, be, ge, yt, tr) {
        var W = Y.element, B = Y.data, Q = Y.internalformat, fe = Y.format, de = Y.type, re = Y.width, ee = Y.height;
        Vt(Y), W ? I.texSubImage2D(
          be,
          tr,
          ge,
          yt,
          fe,
          de,
          W
        ) : Y.compressed ? I.compressedTexSubImage2D(
          be,
          tr,
          ge,
          yt,
          Q,
          re,
          ee,
          B
        ) : Y.needsCopy ? (me(), I.copyTexSubImage2D(
          be,
          tr,
          ge,
          yt,
          Y.xOffset,
          Y.yOffset,
          re,
          ee
        )) : I.texSubImage2D(
          be,
          tr,
          ge,
          yt,
          re,
          ee,
          fe,
          de,
          B
        );
      }
      var qt = [];
      function bt() {
        return qt.pop() || new st();
      }
      function er(Y) {
        Y.needsFree && Lt.freeType(Y.data), st.call(Y), qt.push(Y);
      }
      function Xt() {
        Re.call(this), this.genMipmaps = !1, this.mipmapHint = Bh, this.mipmask = 0, this.images = Array(16);
      }
      function Jt(Y, be, ge) {
        var yt = Y.images[0] = bt();
        Y.mipmask = 1, yt.width = Y.width = be, yt.height = Y.height = ge, yt.channels = Y.channels = 4;
      }
      function gr(Y, be) {
        var ge = null;
        if (t0(be))
          ge = Y.images[0] = bt(), it(ge, Y), Je(ge, be), Y.mipmask = 1;
        else if (It(Y, be), Array.isArray(be.mipmap))
          for (var yt = be.mipmap, tr = 0; tr < yt.length; ++tr)
            ge = Y.images[tr] = bt(), it(ge, Y), ge.width >>= tr, ge.height >>= tr, Je(ge, yt[tr]), Y.mipmask |= 1 << tr;
        else
          ge = Y.images[0] = bt(), it(ge, Y), Je(ge, be), Y.mipmask = 1;
        it(Y, Y.images[0]), Y.compressed && (Y.internalformat === Vg || Y.internalformat === Xg || Y.internalformat === Yg || Y.internalformat === Hg) && N(
          Y.width % 4 === 0 && Y.height % 4 === 0,
          "for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4"
        );
      }
      function Jr(Y, be) {
        for (var ge = Y.images, yt = 0; yt < ge.length; ++yt) {
          if (!ge[yt])
            return;
          Le(ge[yt], be, yt);
        }
      }
      var vn = [];
      function ir() {
        var Y = vn.pop() || new Xt();
        Re.call(Y), Y.mipmask = 0;
        for (var be = 0; be < 16; ++be)
          Y.images[be] = null;
        return Y;
      }
      function sn(Y) {
        for (var be = Y.images, ge = 0; ge < be.length; ++ge)
          be[ge] && er(be[ge]), be[ge] = null;
        vn.push(Y);
      }
      function Pr() {
        this.minFilter = Qg, this.magFilter = Qg, this.wrapS = Zg, this.wrapT = Zg, this.anisotropic = 1, this.genMipmaps = !1, this.mipmapHint = Bh;
      }
      function en(Y, be) {
        if ("min" in be) {
          var ge = be.min;
          N.parameter(ge, Ve), Y.minFilter = Ve[ge], jG.indexOf(Y.minFilter) >= 0 && !("faces" in be) && (Y.genMipmaps = !0);
        }
        if ("mag" in be) {
          var yt = be.mag;
          N.parameter(yt, Ze), Y.magFilter = Ze[yt];
        }
        var tr = Y.wrapS, W = Y.wrapT;
        if ("wrap" in be) {
          var B = be.wrap;
          typeof B == "string" ? (N.parameter(B, We), tr = W = We[B]) : Array.isArray(B) && (N.parameter(B[0], We), N.parameter(B[1], We), tr = We[B[0]], W = We[B[1]]);
        } else {
          if ("wrapS" in be) {
            var Q = be.wrapS;
            N.parameter(Q, We), tr = We[Q];
          }
          if ("wrapT" in be) {
            var fe = be.wrapT;
            N.parameter(fe, We), W = We[fe];
          }
        }
        if (Y.wrapS = tr, Y.wrapT = W, "anisotropic" in be) {
          var de = be.anisotropic;
          N(
            typeof de == "number" && de >= 1 && de <= H.maxAnisotropic,
            "aniso samples must be between 1 and "
          ), Y.anisotropic = be.anisotropic;
        }
        if ("mipmap" in be) {
          var re = !1;
          switch (typeof be.mipmap) {
            case "string":
              N.parameter(
                be.mipmap,
                ze,
                "invalid mipmap hint"
              ), Y.mipmapHint = ze[be.mipmap], Y.genMipmaps = !0, re = !0;
              break;
            case "boolean":
              re = Y.genMipmaps = be.mipmap;
              break;
            case "object":
              N(Array.isArray(be.mipmap), "invalid mipmap type"), Y.genMipmaps = !1, re = !0;
              break;
            default:
              N.raise("invalid mipmap type");
          }
          re && !("min" in be) && (Y.minFilter = Jg);
        }
      }
      function un(Y, be) {
        I.texParameteri(be, DG, Y.minFilter), I.texParameteri(be, OG, Y.magFilter), I.texParameteri(be, TG, Y.wrapS), I.texParameteri(be, AG, Y.wrapT), z.ext_texture_filter_anisotropic && I.texParameteri(be, BG, Y.anisotropic), Y.genMipmaps && (I.hint(LG, Y.mipmapHint), I.generateMipmap(be));
      }
      var fn = 0, xn = {}, An = H.maxTextureUnits, Hr = Array(An).map(function() {
        return null;
      });
      function Zt(Y) {
        Re.call(this), this.mipmask = 0, this.internalformat = Ps, this.id = fn++, this.refCount = 1, this.target = Y, this.texture = I.createTexture(), this.unit = -1, this.bindCount = 0, this.texInfo = new Pr(), xe.profile && (this.stats = { size: 0 });
      }
      function In(Y) {
        I.activeTexture(hl), I.bindTexture(Y.target, Y.texture);
      }
      function wr() {
        var Y = Hr[0];
        Y ? I.bindTexture(Y.target, Y.texture) : I.bindTexture(ca, null);
      }
      function Nt(Y) {
        var be = Y.texture;
        N(be, "must not double destroy texture");
        var ge = Y.unit, yt = Y.target;
        ge >= 0 && (I.activeTexture(hl + ge), I.bindTexture(yt, null), Hr[ge] = null), I.deleteTexture(be), Y.texture = null, Y.params = null, Y.pixels = null, Y.refCount = 0, delete xn[Y.id], ye.textureCount--;
      }
      n(Zt.prototype, {
        bind: function() {
          var Y = this;
          Y.bindCount += 1;
          var be = Y.unit;
          if (be < 0) {
            for (var ge = 0; ge < An; ++ge) {
              var yt = Hr[ge];
              if (yt) {
                if (yt.bindCount > 0)
                  continue;
                yt.unit = -1;
              }
              Hr[ge] = Y, be = ge;
              break;
            }
            be >= An && N.raise("insufficient number of texture units"), xe.profile && ye.maxTextureUnits < be + 1 && (ye.maxTextureUnits = be + 1), Y.unit = be, I.activeTexture(hl + be), I.bindTexture(Y.target, Y.texture);
          }
          return be;
        },
        unbind: function() {
          this.bindCount -= 1;
        },
        decRef: function() {
          --this.refCount <= 0 && Nt(this);
        }
      });
      function nr(Y, be) {
        var ge = new Zt(ca);
        xn[ge.id] = ge, ye.textureCount++;
        function yt(B, Q) {
          var fe = ge.texInfo;
          Pr.call(fe);
          var de = ir();
          return typeof B == "number" ? typeof Q == "number" ? Jt(de, B | 0, Q | 0) : Jt(de, B | 0, B | 0) : B ? (N.type(B, "object", "invalid arguments to regl.texture"), en(fe, B), gr(de, B)) : Jt(de, 1, 1), fe.genMipmaps && (de.mipmask = (de.width << 1) - 1), ge.mipmask = de.mipmask, it(ge, de), N.texture2D(fe, de, H), ge.internalformat = de.internalformat, yt.width = de.width, yt.height = de.height, In(ge), Jr(de, ca), un(fe, ca), wr(), sn(de), xe.profile && (ge.stats.size = Fh(
            ge.internalformat,
            ge.type,
            de.width,
            de.height,
            fe.genMipmaps,
            !1
          )), yt.format = qe[ge.internalformat], yt.type = ht[ge.type], yt.mag = Ne[fe.magFilter], yt.min = gt[fe.minFilter], yt.wrapS = Be[fe.wrapS], yt.wrapT = Be[fe.wrapT], yt;
        }
        function tr(B, Q, fe, de) {
          N(!!B, "must specify image data");
          var re = Q | 0, ee = fe | 0, ae = de | 0, V = bt();
          return it(V, ge), V.width = 0, V.height = 0, Je(V, B), V.width = V.width || (ge.width >> ae) - re, V.height = V.height || (ge.height >> ae) - ee, N(
            ge.type === V.type && ge.format === V.format && ge.internalformat === V.internalformat,
            "incompatible format for texture.subimage"
          ), N(
            re >= 0 && ee >= 0 && re + V.width <= ge.width && ee + V.height <= ge.height,
            "texture.subimage write out of bounds"
          ), N(
            ge.mipmask & 1 << ae,
            "missing mipmap data"
          ), N(
            V.data || V.element || V.needsCopy,
            "missing image data"
          ), In(ge), jt(V, ca, re, ee, ae), wr(), er(V), yt;
        }
        function W(B, Q) {
          var fe = B | 0, de = Q | 0 || fe;
          if (fe === ge.width && de === ge.height)
            return yt;
          yt.width = ge.width = fe, yt.height = ge.height = de, In(ge);
          for (var re = 0; ge.mipmask >> re; ++re) {
            var ee = fe >> re, ae = de >> re;
            if (!ee || !ae)
              break;
            I.texImage2D(
              ca,
              re,
              ge.format,
              ee,
              ae,
              0,
              ge.format,
              ge.type,
              null
            );
          }
          return wr(), xe.profile && (ge.stats.size = Fh(
            ge.internalformat,
            ge.type,
            fe,
            de,
            !1,
            !1
          )), yt;
        }
        return yt(Y, be), yt.subimage = tr, yt.resize = W, yt._reglType = "texture2d", yt._texture = ge, xe.profile && (yt.stats = ge.stats), yt.destroy = function() {
          ge.decRef();
        }, yt;
      }
      function fr(Y, be, ge, yt, tr, W) {
        var B = new Zt(Fg);
        xn[B.id] = B, ye.cubeCount++;
        var Q = new Array(6);
        function fe(ee, ae, V, K, j, ue) {
          var ve, Te = B.texInfo;
          for (Pr.call(Te), ve = 0; ve < 6; ++ve)
            Q[ve] = ir();
          if (typeof ee == "number" || !ee) {
            var Pe = ee | 0 || 1;
            for (ve = 0; ve < 6; ++ve)
              Jt(Q[ve], Pe, Pe);
          } else if (typeof ee == "object")
            if (ae)
              gr(Q[0], ee), gr(Q[1], ae), gr(Q[2], V), gr(Q[3], K), gr(Q[4], j), gr(Q[5], ue);
            else if (en(Te, ee), It(B, ee), "faces" in ee) {
              var we = ee.faces;
              for (N(
                Array.isArray(we) && we.length === 6,
                "cube faces must be a length 6 array"
              ), ve = 0; ve < 6; ++ve)
                N(
                  typeof we[ve] == "object" && !!we[ve],
                  "invalid input for cube map face"
                ), it(Q[ve], B), gr(Q[ve], we[ve]);
            } else
              for (ve = 0; ve < 6; ++ve)
                gr(Q[ve], ee);
          else
            N.raise("invalid arguments to cube map");
          for (it(B, Q[0]), H.npotTextureCube || N(E_(B.width) && E_(B.height), "your browser does not support non power or two texture dimensions"), Te.genMipmaps ? B.mipmask = (Q[0].width << 1) - 1 : B.mipmask = Q[0].mipmask, N.textureCube(B, Te, Q, H), B.internalformat = Q[0].internalformat, fe.width = Q[0].width, fe.height = Q[0].height, In(B), ve = 0; ve < 6; ++ve)
            Jr(Q[ve], kh + ve);
          for (un(Te, Fg), wr(), xe.profile && (B.stats.size = Fh(
            B.internalformat,
            B.type,
            fe.width,
            fe.height,
            Te.genMipmaps,
            !0
          )), fe.format = qe[B.internalformat], fe.type = ht[B.type], fe.mag = Ne[Te.magFilter], fe.min = gt[Te.minFilter], fe.wrapS = Be[Te.wrapS], fe.wrapT = Be[Te.wrapT], ve = 0; ve < 6; ++ve)
            sn(Q[ve]);
          return fe;
        }
        function de(ee, ae, V, K, j) {
          N(!!ae, "must specify image data"), N(typeof ee == "number" && ee === (ee | 0) && ee >= 0 && ee < 6, "invalid face");
          var ue = V | 0, ve = K | 0, Te = j | 0, Pe = bt();
          return it(Pe, B), Pe.width = 0, Pe.height = 0, Je(Pe, ae), Pe.width = Pe.width || (B.width >> Te) - ue, Pe.height = Pe.height || (B.height >> Te) - ve, N(
            B.type === Pe.type && B.format === Pe.format && B.internalformat === Pe.internalformat,
            "incompatible format for texture.subimage"
          ), N(
            ue >= 0 && ve >= 0 && ue + Pe.width <= B.width && ve + Pe.height <= B.height,
            "texture.subimage write out of bounds"
          ), N(
            B.mipmask & 1 << Te,
            "missing mipmap data"
          ), N(
            Pe.data || Pe.element || Pe.needsCopy,
            "missing image data"
          ), In(B), jt(Pe, kh + ee, ue, ve, Te), wr(), er(Pe), fe;
        }
        function re(ee) {
          var ae = ee | 0;
          if (ae !== B.width) {
            fe.width = B.width = ae, fe.height = B.height = ae, In(B);
            for (var V = 0; V < 6; ++V)
              for (var K = 0; B.mipmask >> K; ++K)
                I.texImage2D(
                  kh + V,
                  K,
                  B.format,
                  ae >> K,
                  ae >> K,
                  0,
                  B.format,
                  B.type,
                  null
                );
            return wr(), xe.profile && (B.stats.size = Fh(
              B.internalformat,
              B.type,
              fe.width,
              fe.height,
              !1,
              !0
            )), fe;
          }
        }
        return fe(Y, be, ge, yt, tr, W), fe.subimage = de, fe.resize = re, fe._reglType = "textureCube", fe._texture = B, xe.profile && (fe.stats = B.stats), fe.destroy = function() {
          B.decRef();
        }, fe;
      }
      function Kr() {
        for (var Y = 0; Y < An; ++Y)
          I.activeTexture(hl + Y), I.bindTexture(ca, null), Hr[Y] = null;
        gi(xn).forEach(Nt), ye.cubeCount = 0, ye.textureCount = 0;
      }
      xe.profile && (ye.getTotalTextureSize = function() {
        var Y = 0;
        return Object.keys(xn).forEach(function(be) {
          Y += xn[be].stats.size;
        }), Y;
      });
      function da() {
        for (var Y = 0; Y < An; ++Y) {
          var be = Hr[Y];
          be && (be.bindCount = 0, be.unit = -1, Hr[Y] = null);
        }
        gi(xn).forEach(function(ge) {
          ge.texture = I.createTexture(), I.bindTexture(ge.target, ge.texture);
          for (var yt = 0; yt < 32; ++yt)
            if ((ge.mipmask & 1 << yt) !== 0)
              if (ge.target === ca)
                I.texImage2D(
                  ca,
                  yt,
                  ge.internalformat,
                  ge.width >> yt,
                  ge.height >> yt,
                  0,
                  ge.internalformat,
                  ge.type,
                  null
                );
              else
                for (var tr = 0; tr < 6; ++tr)
                  I.texImage2D(
                    kh + tr,
                    yt,
                    ge.internalformat,
                    ge.width >> yt,
                    ge.height >> yt,
                    0,
                    ge.internalformat,
                    ge.type,
                    null
                  );
          un(ge.texInfo, ge.target);
        });
      }
      function Gs() {
        for (var Y = 0; Y < An; ++Y) {
          var be = Hr[Y];
          be && (be.bindCount = 0, be.unit = -1, Hr[Y] = null), I.activeTexture(hl + Y), I.bindTexture(ca, null), I.bindTexture(Fg, null);
        }
      }
      return {
        create2D: nr,
        createCube: fr,
        clear: Kr,
        getTexture: function(Y) {
          return null;
        },
        restore: da,
        refresh: Gs
      };
    }
    var Bo = 36161, zh = 32854, q_ = 32855, Z_ = 36194, Q_ = 33189, J_ = 36168, ew = 34041, tw = 35907, rw = 34836, nw = 34842, iw = 34843, Hi = [];
    Hi[zh] = 2, Hi[q_] = 2, Hi[Z_] = 2, Hi[Q_] = 2, Hi[J_] = 1, Hi[ew] = 4, Hi[tw] = 4, Hi[rw] = 16, Hi[nw] = 8, Hi[iw] = 6;
    function aw(I, z, H) {
      return Hi[I] * z * H;
    }
    var ZG = function(I, z, H, me, Ie) {
      var ye = {
        rgba4: zh,
        rgb565: Z_,
        "rgb5 a1": q_,
        depth: Q_,
        stencil: J_,
        "depth stencil": ew
      };
      z.ext_srgb && (ye.srgba = tw), z.ext_color_buffer_half_float && (ye.rgba16f = nw, ye.rgb16f = iw), z.webgl_color_buffer_float && (ye.rgba32f = rw);
      var xe = [];
      Object.keys(ye).forEach(function(Ue) {
        var rt = ye[Ue];
        xe[rt] = Ue;
      });
      var ze = 0, We = {};
      function Ze(Ue) {
        this.id = ze++, this.refCount = 1, this.renderbuffer = Ue, this.format = zh, this.width = 0, this.height = 0, Ie.profile && (this.stats = { size: 0 });
      }
      Ze.prototype.decRef = function() {
        --this.refCount <= 0 && Ve(this);
      };
      function Ve(Ue) {
        var rt = Ue.renderbuffer;
        N(rt, "must not double destroy renderbuffer"), I.bindRenderbuffer(Bo, null), I.deleteRenderbuffer(rt), Ue.renderbuffer = null, Ue.refCount = 0, delete We[Ue.id], me.renderbufferCount--;
      }
      function tt(Ue, rt) {
        var ce = new Ze(I.createRenderbuffer());
        We[ce.id] = ce, me.renderbufferCount++;
        function _e(ht, Ne) {
          var gt = 0, Be = 0, nt = zh;
          if (typeof ht == "object" && ht) {
            var Re = ht;
            if ("shape" in Re) {
              var it = Re.shape;
              N(
                Array.isArray(it) && it.length >= 2,
                "invalid renderbuffer shape"
              ), gt = it[0] | 0, Be = it[1] | 0;
            } else
              "radius" in Re && (gt = Be = Re.radius | 0), "width" in Re && (gt = Re.width | 0), "height" in Re && (Be = Re.height | 0);
            "format" in Re && (N.parameter(
              Re.format,
              ye,
              "invalid renderbuffer format"
            ), nt = ye[Re.format]);
          } else
            typeof ht == "number" ? (gt = ht | 0, typeof Ne == "number" ? Be = Ne | 0 : Be = gt) : ht ? N.raise("invalid arguments to renderbuffer constructor") : gt = Be = 1;
          if (N(
            gt > 0 && Be > 0 && gt <= H.maxRenderbufferSize && Be <= H.maxRenderbufferSize,
            "invalid renderbuffer size"
          ), !(gt === ce.width && Be === ce.height && nt === ce.format))
            return _e.width = ce.width = gt, _e.height = ce.height = Be, ce.format = nt, I.bindRenderbuffer(Bo, ce.renderbuffer), I.renderbufferStorage(Bo, nt, gt, Be), N(
              I.getError() === 0,
              "invalid render buffer format"
            ), Ie.profile && (ce.stats.size = aw(ce.format, ce.width, ce.height)), _e.format = xe[ce.format], _e;
        }
        function qe(ht, Ne) {
          var gt = ht | 0, Be = Ne | 0 || gt;
          return gt === ce.width && Be === ce.height || (N(
            gt > 0 && Be > 0 && gt <= H.maxRenderbufferSize && Be <= H.maxRenderbufferSize,
            "invalid renderbuffer size"
          ), _e.width = ce.width = gt, _e.height = ce.height = Be, I.bindRenderbuffer(Bo, ce.renderbuffer), I.renderbufferStorage(Bo, ce.format, gt, Be), N(
            I.getError() === 0,
            "invalid render buffer format"
          ), Ie.profile && (ce.stats.size = aw(
            ce.format,
            ce.width,
            ce.height
          ))), _e;
        }
        return _e(Ue, rt), _e.resize = qe, _e._reglType = "renderbuffer", _e._renderbuffer = ce, Ie.profile && (_e.stats = ce.stats), _e.destroy = function() {
          ce.decRef();
        }, _e;
      }
      Ie.profile && (me.getTotalRenderbufferSize = function() {
        var Ue = 0;
        return Object.keys(We).forEach(function(rt) {
          Ue += We[rt].stats.size;
        }), Ue;
      });
      function ot() {
        gi(We).forEach(function(Ue) {
          Ue.renderbuffer = I.createRenderbuffer(), I.bindRenderbuffer(Bo, Ue.renderbuffer), I.renderbufferStorage(Bo, Ue.format, Ue.width, Ue.height);
        }), I.bindRenderbuffer(Bo, null);
      }
      return {
        create: tt,
        clear: function() {
          gi(We).forEach(Ve);
        },
        restore: ot
      };
    }, Ja = 36160, r0 = 36161, Ds = 3553, Uh = 34069, ow = 36064, sw = 36096, uw = 36128, fw = 33306, lw = 36053, QG = 36054, JG = 36055, eF = 36057, tF = 36061, rF = 36193, nF = 5121, iF = 5126, cw = 6407, hw = 6408, aF = 6402, oF = [
      cw,
      hw
    ], n0 = [];
    n0[hw] = 4, n0[cw] = 3;
    var jh = [];
    jh[nF] = 1, jh[iF] = 4, jh[rF] = 2;
    var sF = 32854, uF = 32855, fF = 36194, lF = 33189, cF = 36168, dw = 34041, hF = 35907, dF = 34836, vF = 34842, pF = 34843, gF = [
      sF,
      uF,
      fF,
      hF,
      vF,
      pF,
      dF
    ], Uu = {};
    Uu[lw] = "complete", Uu[QG] = "incomplete attachment", Uu[eF] = "incomplete dimensions", Uu[JG] = "incomplete, missing attachment", Uu[tF] = "unsupported";
    function yF(I, z, H, me, Ie, ye) {
      var xe = {
        cur: null,
        next: null,
        dirty: !1,
        setFBO: null
      }, ze = ["rgba"], We = ["rgba4", "rgb565", "rgb5 a1"];
      z.ext_srgb && We.push("srgba"), z.ext_color_buffer_half_float && We.push("rgba16f", "rgb16f"), z.webgl_color_buffer_float && We.push("rgba32f");
      var Ze = ["uint8"];
      z.oes_texture_half_float && Ze.push("half float", "float16"), z.oes_texture_float && Ze.push("float", "float32");
      function Ve(st, Je, Le) {
        this.target = st, this.texture = Je, this.renderbuffer = Le;
        var jt = 0, qt = 0;
        Je ? (jt = Je.width, qt = Je.height) : Le && (jt = Le.width, qt = Le.height), this.width = jt, this.height = qt;
      }
      function tt(st) {
        st && (st.texture && st.texture._texture.decRef(), st.renderbuffer && st.renderbuffer._renderbuffer.decRef());
      }
      function ot(st, Je, Le) {
        if (!!st)
          if (st.texture) {
            var jt = st.texture._texture, qt = Math.max(1, jt.width), bt = Math.max(1, jt.height);
            N(
              qt === Je && bt === Le,
              "inconsistent width/height for supplied texture"
            ), jt.refCount += 1;
          } else {
            var er = st.renderbuffer._renderbuffer;
            N(
              er.width === Je && er.height === Le,
              "inconsistent width/height for renderbuffer"
            ), er.refCount += 1;
          }
      }
      function Ue(st, Je) {
        Je && (Je.texture ? I.framebufferTexture2D(
          Ja,
          st,
          Je.target,
          Je.texture._texture.texture,
          0
        ) : I.framebufferRenderbuffer(
          Ja,
          st,
          r0,
          Je.renderbuffer._renderbuffer.renderbuffer
        ));
      }
      function rt(st) {
        var Je = Ds, Le = null, jt = null, qt = st;
        typeof st == "object" && (qt = st.data, "target" in st && (Je = st.target | 0)), N.type(qt, "function", "invalid attachment data");
        var bt = qt._reglType;
        return bt === "texture2d" ? (Le = qt, N(Je === Ds)) : bt === "textureCube" ? (Le = qt, N(
          Je >= Uh && Je < Uh + 6,
          "invalid cube map target"
        )) : bt === "renderbuffer" ? (jt = qt, Je = r0) : N.raise("invalid regl object for attachment"), new Ve(Je, Le, jt);
      }
      function ce(st, Je, Le, jt, qt) {
        if (Le) {
          var bt = me.create2D({
            width: st,
            height: Je,
            format: jt,
            type: qt
          });
          return bt._texture.refCount = 0, new Ve(Ds, bt, null);
        } else {
          var er = Ie.create({
            width: st,
            height: Je,
            format: jt
          });
          return er._renderbuffer.refCount = 0, new Ve(r0, null, er);
        }
      }
      function _e(st) {
        return st && (st.texture || st.renderbuffer);
      }
      function qe(st, Je, Le) {
        st && (st.texture ? st.texture.resize(Je, Le) : st.renderbuffer && st.renderbuffer.resize(Je, Le), st.width = Je, st.height = Le);
      }
      var ht = 0, Ne = {};
      function gt() {
        this.id = ht++, Ne[this.id] = this, this.framebuffer = I.createFramebuffer(), this.width = 0, this.height = 0, this.colorAttachments = [], this.depthAttachment = null, this.stencilAttachment = null, this.depthStencilAttachment = null;
      }
      function Be(st) {
        st.colorAttachments.forEach(tt), tt(st.depthAttachment), tt(st.stencilAttachment), tt(st.depthStencilAttachment);
      }
      function nt(st) {
        var Je = st.framebuffer;
        N(Je, "must not double destroy framebuffer"), I.deleteFramebuffer(Je), st.framebuffer = null, ye.framebufferCount--, delete Ne[st.id];
      }
      function Re(st) {
        var Je;
        I.bindFramebuffer(Ja, st.framebuffer);
        var Le = st.colorAttachments;
        for (Je = 0; Je < Le.length; ++Je)
          Ue(ow + Je, Le[Je]);
        for (Je = Le.length; Je < H.maxColorAttachments; ++Je)
          I.framebufferTexture2D(
            Ja,
            ow + Je,
            Ds,
            null,
            0
          );
        I.framebufferTexture2D(
          Ja,
          fw,
          Ds,
          null,
          0
        ), I.framebufferTexture2D(
          Ja,
          sw,
          Ds,
          null,
          0
        ), I.framebufferTexture2D(
          Ja,
          uw,
          Ds,
          null,
          0
        ), Ue(sw, st.depthAttachment), Ue(uw, st.stencilAttachment), Ue(fw, st.depthStencilAttachment);
        var jt = I.checkFramebufferStatus(Ja);
        !I.isContextLost() && jt !== lw && N.raise("framebuffer configuration not supported, status = " + Uu[jt]), I.bindFramebuffer(Ja, xe.next ? xe.next.framebuffer : null), xe.cur = xe.next, I.getError();
      }
      function it(st, Je) {
        var Le = new gt();
        ye.framebufferCount++;
        function jt(bt, er) {
          var Xt;
          N(
            xe.next !== Le,
            "can not update framebuffer which is currently in use"
          );
          var Jt = 0, gr = 0, Jr = !0, vn = !0, ir = null, sn = !0, Pr = "rgba", en = "uint8", un = 1, fn = null, xn = null, An = null, Hr = !1;
          if (typeof bt == "number")
            Jt = bt | 0, gr = er | 0 || Jt;
          else if (!bt)
            Jt = gr = 1;
          else {
            N.type(bt, "object", "invalid arguments for framebuffer");
            var Zt = bt;
            if ("shape" in Zt) {
              var In = Zt.shape;
              N(
                Array.isArray(In) && In.length >= 2,
                "invalid shape for framebuffer"
              ), Jt = In[0], gr = In[1];
            } else
              "radius" in Zt && (Jt = gr = Zt.radius), "width" in Zt && (Jt = Zt.width), "height" in Zt && (gr = Zt.height);
            ("color" in Zt || "colors" in Zt) && (ir = Zt.color || Zt.colors, Array.isArray(ir) && N(
              ir.length === 1 || z.webgl_draw_buffers,
              "multiple render targets not supported"
            )), ir || ("colorCount" in Zt && (un = Zt.colorCount | 0, N(un > 0, "invalid color buffer count")), "colorTexture" in Zt && (sn = !!Zt.colorTexture, Pr = "rgba4"), "colorType" in Zt && (en = Zt.colorType, sn ? (N(
              z.oes_texture_float || !(en === "float" || en === "float32"),
              "you must enable OES_texture_float in order to use floating point framebuffer objects"
            ), N(
              z.oes_texture_half_float || !(en === "half float" || en === "float16"),
              "you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects"
            )) : en === "half float" || en === "float16" ? (N(
              z.ext_color_buffer_half_float,
              "you must enable EXT_color_buffer_half_float to use 16-bit render buffers"
            ), Pr = "rgba16f") : (en === "float" || en === "float32") && (N(
              z.webgl_color_buffer_float,
              "you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"
            ), Pr = "rgba32f"), N.oneOf(en, Ze, "invalid color type")), "colorFormat" in Zt && (Pr = Zt.colorFormat, ze.indexOf(Pr) >= 0 ? sn = !0 : We.indexOf(Pr) >= 0 ? sn = !1 : sn ? N.oneOf(
              Zt.colorFormat,
              ze,
              "invalid color format for texture"
            ) : N.oneOf(
              Zt.colorFormat,
              We,
              "invalid color format for renderbuffer"
            ))), ("depthTexture" in Zt || "depthStencilTexture" in Zt) && (Hr = !!(Zt.depthTexture || Zt.depthStencilTexture), N(
              !Hr || z.webgl_depth_texture,
              "webgl_depth_texture extension not supported"
            )), "depth" in Zt && (typeof Zt.depth == "boolean" ? Jr = Zt.depth : (fn = Zt.depth, vn = !1)), "stencil" in Zt && (typeof Zt.stencil == "boolean" ? vn = Zt.stencil : (xn = Zt.stencil, Jr = !1)), "depthStencil" in Zt && (typeof Zt.depthStencil == "boolean" ? Jr = vn = Zt.depthStencil : (An = Zt.depthStencil, Jr = !1, vn = !1));
          }
          var wr = null, Nt = null, nr = null, fr = null;
          if (Array.isArray(ir))
            wr = ir.map(rt);
          else if (ir)
            wr = [rt(ir)];
          else
            for (wr = new Array(un), Xt = 0; Xt < un; ++Xt)
              wr[Xt] = ce(
                Jt,
                gr,
                sn,
                Pr,
                en
              );
          N(
            z.webgl_draw_buffers || wr.length <= 1,
            "you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."
          ), N(
            wr.length <= H.maxColorAttachments,
            "too many color attachments, not supported"
          ), Jt = Jt || wr[0].width, gr = gr || wr[0].height, fn ? Nt = rt(fn) : Jr && !vn && (Nt = ce(
            Jt,
            gr,
            Hr,
            "depth",
            "uint32"
          )), xn ? nr = rt(xn) : vn && !Jr && (nr = ce(
            Jt,
            gr,
            !1,
            "stencil",
            "uint8"
          )), An ? fr = rt(An) : !fn && !xn && vn && Jr && (fr = ce(
            Jt,
            gr,
            Hr,
            "depth stencil",
            "depth stencil"
          )), N(
            !!fn + !!xn + !!An <= 1,
            "invalid framebuffer configuration, can specify exactly one depth/stencil attachment"
          );
          var Kr = null;
          for (Xt = 0; Xt < wr.length; ++Xt)
            if (ot(wr[Xt], Jt, gr), N(
              !wr[Xt] || wr[Xt].texture && oF.indexOf(wr[Xt].texture._texture.format) >= 0 || wr[Xt].renderbuffer && gF.indexOf(wr[Xt].renderbuffer._renderbuffer.format) >= 0,
              "framebuffer color attachment " + Xt + " is invalid"
            ), wr[Xt] && wr[Xt].texture) {
              var da = n0[wr[Xt].texture._texture.format] * jh[wr[Xt].texture._texture.type];
              Kr === null ? Kr = da : N(
                Kr === da,
                "all color attachments much have the same number of bits per pixel."
              );
            }
          return ot(Nt, Jt, gr), N(
            !Nt || Nt.texture && Nt.texture._texture.format === aF || Nt.renderbuffer && Nt.renderbuffer._renderbuffer.format === lF,
            "invalid depth attachment for framebuffer object"
          ), ot(nr, Jt, gr), N(
            !nr || nr.renderbuffer && nr.renderbuffer._renderbuffer.format === cF,
            "invalid stencil attachment for framebuffer object"
          ), ot(fr, Jt, gr), N(
            !fr || fr.texture && fr.texture._texture.format === dw || fr.renderbuffer && fr.renderbuffer._renderbuffer.format === dw,
            "invalid depth-stencil attachment for framebuffer object"
          ), Be(Le), Le.width = Jt, Le.height = gr, Le.colorAttachments = wr, Le.depthAttachment = Nt, Le.stencilAttachment = nr, Le.depthStencilAttachment = fr, jt.color = wr.map(_e), jt.depth = _e(Nt), jt.stencil = _e(nr), jt.depthStencil = _e(fr), jt.width = Le.width, jt.height = Le.height, Re(Le), jt;
        }
        function qt(bt, er) {
          N(
            xe.next !== Le,
            "can not resize a framebuffer which is currently in use"
          );
          var Xt = Math.max(bt | 0, 1), Jt = Math.max(er | 0 || Xt, 1);
          if (Xt === Le.width && Jt === Le.height)
            return jt;
          for (var gr = Le.colorAttachments, Jr = 0; Jr < gr.length; ++Jr)
            qe(gr[Jr], Xt, Jt);
          return qe(Le.depthAttachment, Xt, Jt), qe(Le.stencilAttachment, Xt, Jt), qe(Le.depthStencilAttachment, Xt, Jt), Le.width = jt.width = Xt, Le.height = jt.height = Jt, Re(Le), jt;
        }
        return jt(st, Je), n(jt, {
          resize: qt,
          _reglType: "framebuffer",
          _framebuffer: Le,
          destroy: function() {
            nt(Le), Be(Le);
          },
          use: function(bt) {
            xe.setFBO({
              framebuffer: jt
            }, bt);
          }
        });
      }
      function It(st) {
        var Je = Array(6);
        function Le(qt) {
          var bt;
          N(
            Je.indexOf(xe.next) < 0,
            "can not update framebuffer which is currently in use"
          );
          var er = {
            color: null
          }, Xt = 0, Jt = null, gr = "rgba", Jr = "uint8", vn = 1;
          if (typeof qt == "number")
            Xt = qt | 0;
          else if (!qt)
            Xt = 1;
          else {
            N.type(qt, "object", "invalid arguments for framebuffer");
            var ir = qt;
            if ("shape" in ir) {
              var sn = ir.shape;
              N(
                Array.isArray(sn) && sn.length >= 2,
                "invalid shape for framebuffer"
              ), N(
                sn[0] === sn[1],
                "cube framebuffer must be square"
              ), Xt = sn[0];
            } else
              "radius" in ir && (Xt = ir.radius | 0), "width" in ir ? (Xt = ir.width | 0, "height" in ir && N(ir.height === Xt, "must be square")) : "height" in ir && (Xt = ir.height | 0);
            ("color" in ir || "colors" in ir) && (Jt = ir.color || ir.colors, Array.isArray(Jt) && N(
              Jt.length === 1 || z.webgl_draw_buffers,
              "multiple render targets not supported"
            )), Jt || ("colorCount" in ir && (vn = ir.colorCount | 0, N(vn > 0, "invalid color buffer count")), "colorType" in ir && (N.oneOf(
              ir.colorType,
              Ze,
              "invalid color type"
            ), Jr = ir.colorType), "colorFormat" in ir && (gr = ir.colorFormat, N.oneOf(
              ir.colorFormat,
              ze,
              "invalid color format for texture"
            ))), "depth" in ir && (er.depth = ir.depth), "stencil" in ir && (er.stencil = ir.stencil), "depthStencil" in ir && (er.depthStencil = ir.depthStencil);
          }
          var Pr;
          if (Jt)
            if (Array.isArray(Jt))
              for (Pr = [], bt = 0; bt < Jt.length; ++bt)
                Pr[bt] = Jt[bt];
            else
              Pr = [Jt];
          else {
            Pr = Array(vn);
            var en = {
              radius: Xt,
              format: gr,
              type: Jr
            };
            for (bt = 0; bt < vn; ++bt)
              Pr[bt] = me.createCube(en);
          }
          for (er.color = Array(Pr.length), bt = 0; bt < Pr.length; ++bt) {
            var un = Pr[bt];
            N(
              typeof un == "function" && un._reglType === "textureCube",
              "invalid cube map"
            ), Xt = Xt || un.width, N(
              un.width === Xt && un.height === Xt,
              "invalid cube map shape"
            ), er.color[bt] = {
              target: Uh,
              data: Pr[bt]
            };
          }
          for (bt = 0; bt < 6; ++bt) {
            for (var fn = 0; fn < Pr.length; ++fn)
              er.color[fn].target = Uh + bt;
            bt > 0 && (er.depth = Je[0].depth, er.stencil = Je[0].stencil, er.depthStencil = Je[0].depthStencil), Je[bt] ? Je[bt](er) : Je[bt] = it(er);
          }
          return n(Le, {
            width: Xt,
            height: Xt,
            color: Pr
          });
        }
        function jt(qt) {
          var bt, er = qt | 0;
          if (N(
            er > 0 && er <= H.maxCubeMapSize,
            "invalid radius for cube fbo"
          ), er === Le.width)
            return Le;
          var Xt = Le.color;
          for (bt = 0; bt < Xt.length; ++bt)
            Xt[bt].resize(er);
          for (bt = 0; bt < 6; ++bt)
            Je[bt].resize(er);
          return Le.width = Le.height = er, Le;
        }
        return Le(st), n(Le, {
          faces: Je,
          resize: jt,
          _reglType: "framebufferCube",
          destroy: function() {
            Je.forEach(function(qt) {
              qt.destroy();
            });
          }
        });
      }
      function Vt() {
        xe.cur = null, xe.next = null, xe.dirty = !0, gi(Ne).forEach(function(st) {
          st.framebuffer = I.createFramebuffer(), Re(st);
        });
      }
      return n(xe, {
        getFramebuffer: function(st) {
          if (typeof st == "function" && st._reglType === "framebuffer") {
            var Je = st._framebuffer;
            if (Je instanceof gt)
              return Je;
          }
          return null;
        },
        create: it,
        createCube: It,
        clear: function() {
          gi(Ne).forEach(nt);
        },
        restore: Vt
      });
    }
    var mF = 5126, vw = 34962;
    function i0() {
      this.state = 0, this.x = 0, this.y = 0, this.z = 0, this.w = 0, this.buffer = null, this.size = 0, this.normalized = !1, this.type = mF, this.offset = 0, this.stride = 0, this.divisor = 0;
    }
    function bF(I, z, H, me, Ie) {
      for (var ye = H.maxAttributes, xe = new Array(ye), ze = 0; ze < ye; ++ze)
        xe[ze] = new i0();
      var We = 0, Ze = {}, Ve = {
        Record: i0,
        scope: {},
        state: xe,
        currentVAO: null,
        targetVAO: null,
        restore: ot() ? Ne : function() {
        },
        createVAO: gt,
        getVAO: rt,
        destroyBuffer: tt,
        setVAO: ot() ? ce : _e,
        clear: ot() ? qe : function() {
        }
      };
      function tt(Be) {
        for (var nt = 0; nt < xe.length; ++nt) {
          var Re = xe[nt];
          Re.buffer === Be && (I.disableVertexAttribArray(nt), Re.buffer = null);
        }
      }
      function ot() {
        return z.oes_vertex_array_object;
      }
      function Ue() {
        return z.angle_instanced_arrays;
      }
      function rt(Be) {
        return typeof Be == "function" && Be._vao ? Be._vao : null;
      }
      function ce(Be) {
        if (Be !== Ve.currentVAO) {
          var nt = ot();
          Be ? nt.bindVertexArrayOES(Be.vao) : nt.bindVertexArrayOES(null), Ve.currentVAO = Be;
        }
      }
      function _e(Be) {
        if (Be !== Ve.currentVAO) {
          if (Be)
            Be.bindAttrs();
          else
            for (var nt = Ue(), Re = 0; Re < xe.length; ++Re) {
              var it = xe[Re];
              it.buffer ? (I.enableVertexAttribArray(Re), I.vertexAttribPointer(Re, it.size, it.type, it.normalized, it.stride, it.offfset), nt && it.divisor && nt.vertexAttribDivisorANGLE(Re, it.divisor)) : (I.disableVertexAttribArray(Re), I.vertexAttrib4f(Re, it.x, it.y, it.z, it.w));
            }
          Ve.currentVAO = Be;
        }
      }
      function qe() {
        gi(Ze).forEach(function(Be) {
          Be.destroy();
        });
      }
      function ht() {
        this.id = ++We, this.attributes = [];
        var Be = ot();
        Be ? this.vao = Be.createVertexArrayOES() : this.vao = null, Ze[this.id] = this, this.buffers = [];
      }
      ht.prototype.bindAttrs = function() {
        for (var Be = Ue(), nt = this.attributes, Re = 0; Re < nt.length; ++Re) {
          var it = nt[Re];
          it.buffer ? (I.enableVertexAttribArray(Re), I.bindBuffer(vw, it.buffer.buffer), I.vertexAttribPointer(Re, it.size, it.type, it.normalized, it.stride, it.offset), Be && it.divisor && Be.vertexAttribDivisorANGLE(Re, it.divisor)) : (I.disableVertexAttribArray(Re), I.vertexAttrib4f(Re, it.x, it.y, it.z, it.w));
        }
        for (var It = nt.length; It < ye; ++It)
          I.disableVertexAttribArray(It);
      }, ht.prototype.refresh = function() {
        var Be = ot();
        Be && (Be.bindVertexArrayOES(this.vao), this.bindAttrs(), Ve.currentVAO = this);
      }, ht.prototype.destroy = function() {
        if (this.vao) {
          var Be = ot();
          this === Ve.currentVAO && (Ve.currentVAO = null, Be.bindVertexArrayOES(null)), Be.deleteVertexArrayOES(this.vao), this.vao = null;
        }
        Ze[this.id] && (delete Ze[this.id], me.vaoCount -= 1);
      };
      function Ne() {
        var Be = ot();
        Be && gi(Ze).forEach(function(nt) {
          nt.refresh();
        });
      }
      function gt(Be) {
        var nt = new ht();
        me.vaoCount += 1;
        function Re(it) {
          N(Array.isArray(it), "arguments to vertex array constructor must be an array"), N(it.length < ye, "too many attributes"), N(it.length > 0, "must specify at least one attribute");
          var It = {}, Vt = nt.attributes;
          Vt.length = it.length;
          for (var st = 0; st < it.length; ++st) {
            var Je = it[st], Le = Vt[st] = new i0(), jt = Je.data || Je;
            if (Array.isArray(jt) || e(jt) || Yi(jt)) {
              var qt;
              nt.buffers[st] && (qt = nt.buffers[st], e(jt) && qt._buffer.byteLength >= jt.byteLength ? qt.subdata(jt) : (qt.destroy(), nt.buffers[st] = null)), nt.buffers[st] || (qt = nt.buffers[st] = Ie.create(Je, vw, !1, !0)), Le.buffer = Ie.getBuffer(qt), Le.size = Le.buffer.dimension | 0, Le.normalized = !1, Le.type = Le.buffer.dtype, Le.offset = 0, Le.stride = 0, Le.divisor = 0, Le.state = 1, It[st] = 1;
            } else
              Ie.getBuffer(Je) ? (Le.buffer = Ie.getBuffer(Je), Le.size = Le.buffer.dimension | 0, Le.normalized = !1, Le.type = Le.buffer.dtype, Le.offset = 0, Le.stride = 0, Le.divisor = 0, Le.state = 1) : Ie.getBuffer(Je.buffer) ? (Le.buffer = Ie.getBuffer(Je.buffer), Le.size = (+Je.size || Le.buffer.dimension) | 0, Le.normalized = !!Je.normalized || !1, "type" in Je ? (N.parameter(Je.type, As, "invalid buffer type"), Le.type = As[Je.type]) : Le.type = Le.buffer.dtype, Le.offset = (Je.offset || 0) | 0, Le.stride = (Je.stride || 0) | 0, Le.divisor = (Je.divisor || 0) | 0, Le.state = 1, N(Le.size >= 1 && Le.size <= 4, "size must be between 1 and 4"), N(Le.offset >= 0, "invalid offset"), N(Le.stride >= 0 && Le.stride <= 255, "stride must be between 0 and 255"), N(Le.divisor >= 0, "divisor must be positive"), N(!Le.divisor || !!z.angle_instanced_arrays, "ANGLE_instanced_arrays must be enabled to use divisor")) : "x" in Je ? (N(st > 0, "first attribute must not be a constant"), Le.x = +Je.x || 0, Le.y = +Je.y || 0, Le.z = +Je.z || 0, Le.w = +Je.w || 0, Le.state = 2) : N(!1, "invalid attribute spec for location " + st);
          }
          for (var bt = 0; bt < nt.buffers.length; ++bt)
            !It[bt] && nt.buffers[bt] && (nt.buffers[bt].destroy(), nt.buffers[bt] = null);
          return nt.refresh(), Re;
        }
        return Re.destroy = function() {
          for (var it = 0; it < nt.buffers.length; ++it)
            nt.buffers[it] && nt.buffers[it].destroy();
          nt.buffers.length = 0, nt.destroy();
        }, Re._vao = nt, Re._reglType = "vao", Re(Be);
      }
      return Ve;
    }
    var pw = 35632, xF = 35633, _F = 35718, wF = 35721;
    function EF(I, z, H, me) {
      var Ie = {}, ye = {};
      function xe(ce, _e, qe, ht) {
        this.name = ce, this.id = _e, this.location = qe, this.info = ht;
      }
      function ze(ce, _e) {
        for (var qe = 0; qe < ce.length; ++qe)
          if (ce[qe].id === _e.id) {
            ce[qe].location = _e.location;
            return;
          }
        ce.push(_e);
      }
      function We(ce, _e, qe) {
        var ht = ce === pw ? Ie : ye, Ne = ht[_e];
        if (!Ne) {
          var gt = z.str(_e);
          Ne = I.createShader(ce), I.shaderSource(Ne, gt), I.compileShader(Ne), N.shaderError(I, Ne, gt, ce, qe), ht[_e] = Ne;
        }
        return Ne;
      }
      var Ze = {}, Ve = [], tt = 0;
      function ot(ce, _e) {
        this.id = tt++, this.fragId = ce, this.vertId = _e, this.program = null, this.uniforms = [], this.attributes = [], this.refCount = 1, me.profile && (this.stats = {
          uniformsCount: 0,
          attributesCount: 0
        });
      }
      function Ue(ce, _e, qe) {
        var ht, Ne, gt = We(pw, ce.fragId), Be = We(xF, ce.vertId), nt = ce.program = I.createProgram();
        if (I.attachShader(nt, gt), I.attachShader(nt, Be), qe)
          for (ht = 0; ht < qe.length; ++ht) {
            var Re = qe[ht];
            I.bindAttribLocation(nt, Re[0], Re[1]);
          }
        I.linkProgram(nt), N.linkError(
          I,
          nt,
          z.str(ce.fragId),
          z.str(ce.vertId),
          _e
        );
        var it = I.getProgramParameter(nt, _F);
        me.profile && (ce.stats.uniformsCount = it);
        var It = ce.uniforms;
        for (ht = 0; ht < it; ++ht)
          if (Ne = I.getActiveUniform(nt, ht), Ne)
            if (Ne.size > 1)
              for (var Vt = 0; Vt < Ne.size; ++Vt) {
                var st = Ne.name.replace("[0]", "[" + Vt + "]");
                ze(It, new xe(
                  st,
                  z.id(st),
                  I.getUniformLocation(nt, st),
                  Ne
                ));
              }
            else
              ze(It, new xe(
                Ne.name,
                z.id(Ne.name),
                I.getUniformLocation(nt, Ne.name),
                Ne
              ));
        var Je = I.getProgramParameter(nt, wF);
        me.profile && (ce.stats.attributesCount = Je);
        var Le = ce.attributes;
        for (ht = 0; ht < Je; ++ht)
          Ne = I.getActiveAttrib(nt, ht), Ne && ze(Le, new xe(
            Ne.name,
            z.id(Ne.name),
            I.getAttribLocation(nt, Ne.name),
            Ne
          ));
      }
      me.profile && (H.getMaxUniformsCount = function() {
        var ce = 0;
        return Ve.forEach(function(_e) {
          _e.stats.uniformsCount > ce && (ce = _e.stats.uniformsCount);
        }), ce;
      }, H.getMaxAttributesCount = function() {
        var ce = 0;
        return Ve.forEach(function(_e) {
          _e.stats.attributesCount > ce && (ce = _e.stats.attributesCount);
        }), ce;
      });
      function rt() {
        Ie = {}, ye = {};
        for (var ce = 0; ce < Ve.length; ++ce)
          Ue(Ve[ce], null, Ve[ce].attributes.map(function(_e) {
            return [_e.location, _e.name];
          }));
      }
      return {
        clear: function() {
          var ce = I.deleteShader.bind(I);
          gi(Ie).forEach(ce), Ie = {}, gi(ye).forEach(ce), ye = {}, Ve.forEach(function(_e) {
            I.deleteProgram(_e.program);
          }), Ve.length = 0, Ze = {}, H.shaderCount = 0;
        },
        program: function(ce, _e, qe, ht) {
          N.command(ce >= 0, "missing vertex shader", qe), N.command(_e >= 0, "missing fragment shader", qe);
          var Ne = Ze[_e];
          Ne || (Ne = Ze[_e] = {});
          var gt = Ne[ce];
          if (gt && (gt.refCount++, !ht))
            return gt;
          var Be = new ot(_e, ce);
          return H.shaderCount++, Ue(Be, qe, ht), gt || (Ne[ce] = Be), Ve.push(Be), n(Be, {
            destroy: function() {
              if (Be.refCount--, Be.refCount <= 0) {
                I.deleteProgram(Be.program);
                var nt = Ve.indexOf(Be);
                Ve.splice(nt, 1), H.shaderCount--;
              }
              Ne[Be.vertId].refCount <= 0 && (I.deleteShader(ye[Be.vertId]), delete ye[Be.vertId], delete Ze[Be.fragId][Be.vertId]), Object.keys(Ze[Be.fragId]).length || (I.deleteShader(Ie[Be.fragId]), delete Ie[Be.fragId], delete Ze[Be.fragId]);
            }
          });
        },
        restore: rt,
        shader: We,
        frag: -1,
        vert: -1
      };
    }
    var SF = 6408, dl = 5121, MF = 3333, $h = 5126;
    function CF(I, z, H, me, Ie, ye, xe) {
      function ze(Ve) {
        var tt;
        z.next === null ? (N(
          Ie.preserveDrawingBuffer,
          'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'
        ), tt = dl) : (N(
          z.next.colorAttachments[0].texture !== null,
          "You cannot read from a renderbuffer"
        ), tt = z.next.colorAttachments[0].texture._texture.type, ye.oes_texture_float ? (N(
          tt === dl || tt === $h,
          "Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"
        ), tt === $h && N(xe.readFloat, "Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")) : N(
          tt === dl,
          "Reading from a framebuffer is only allowed for the type 'uint8'"
        ));
        var ot = 0, Ue = 0, rt = me.framebufferWidth, ce = me.framebufferHeight, _e = null;
        e(Ve) ? _e = Ve : Ve && (N.type(Ve, "object", "invalid arguments to regl.read()"), ot = Ve.x | 0, Ue = Ve.y | 0, N(
          ot >= 0 && ot < me.framebufferWidth,
          "invalid x offset for regl.read"
        ), N(
          Ue >= 0 && Ue < me.framebufferHeight,
          "invalid y offset for regl.read"
        ), rt = (Ve.width || me.framebufferWidth - ot) | 0, ce = (Ve.height || me.framebufferHeight - Ue) | 0, _e = Ve.data || null), _e && (tt === dl ? N(
          _e instanceof Uint8Array,
          "buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"
        ) : tt === $h && N(
          _e instanceof Float32Array,
          "buffer must be 'Float32Array' when reading from a framebuffer of type 'float'"
        )), N(
          rt > 0 && rt + ot <= me.framebufferWidth,
          "invalid width for read pixels"
        ), N(
          ce > 0 && ce + Ue <= me.framebufferHeight,
          "invalid height for read pixels"
        ), H();
        var qe = rt * ce * 4;
        return _e || (tt === dl ? _e = new Uint8Array(qe) : tt === $h && (_e = _e || new Float32Array(qe))), N.isTypedArray(_e, "data buffer for regl.read() must be a typedarray"), N(_e.byteLength >= qe, "data buffer for regl.read() too small"), I.pixelStorei(MF, 4), I.readPixels(
          ot,
          Ue,
          rt,
          ce,
          SF,
          tt,
          _e
        ), _e;
      }
      function We(Ve) {
        var tt;
        return z.setFBO({
          framebuffer: Ve.framebuffer
        }, function() {
          tt = ze(Ve);
        }), tt;
      }
      function Ze(Ve) {
        return !Ve || !("framebuffer" in Ve) ? ze(Ve) : We(Ve);
      }
      return Ze;
    }
    function ju(I) {
      return Array.prototype.slice.call(I);
    }
    function $u(I) {
      return ju(I).join("");
    }
    function TF() {
      var I = 0, z = [], H = [];
      function me(tt) {
        for (var ot = 0; ot < H.length; ++ot)
          if (H[ot] === tt)
            return z[ot];
        var Ue = "g" + I++;
        return z.push(Ue), H.push(tt), Ue;
      }
      function Ie() {
        var tt = [];
        function ot() {
          tt.push.apply(tt, ju(arguments));
        }
        var Ue = [];
        function rt() {
          var ce = "v" + I++;
          return Ue.push(ce), arguments.length > 0 && (tt.push(ce, "="), tt.push.apply(tt, ju(arguments)), tt.push(";")), ce;
        }
        return n(ot, {
          def: rt,
          toString: function() {
            return $u([
              Ue.length > 0 ? "var " + Ue.join(",") + ";" : "",
              $u(tt)
            ]);
          }
        });
      }
      function ye() {
        var tt = Ie(), ot = Ie(), Ue = tt.toString, rt = ot.toString;
        function ce(_e, qe) {
          ot(_e, qe, "=", tt.def(_e, qe), ";");
        }
        return n(function() {
          tt.apply(tt, ju(arguments));
        }, {
          def: tt.def,
          entry: tt,
          exit: ot,
          save: ce,
          set: function(_e, qe, ht) {
            ce(_e, qe), tt(_e, qe, "=", ht, ";");
          },
          toString: function() {
            return Ue() + rt();
          }
        });
      }
      function xe() {
        var tt = $u(arguments), ot = ye(), Ue = ye(), rt = ot.toString, ce = Ue.toString;
        return n(ot, {
          then: function() {
            return ot.apply(ot, ju(arguments)), this;
          },
          else: function() {
            return Ue.apply(Ue, ju(arguments)), this;
          },
          toString: function() {
            var _e = ce();
            return _e && (_e = "else{" + _e + "}"), $u([
              "if(",
              tt,
              "){",
              rt(),
              "}",
              _e
            ]);
          }
        });
      }
      var ze = Ie(), We = {};
      function Ze(tt, ot) {
        var Ue = [];
        function rt() {
          var Ne = "a" + Ue.length;
          return Ue.push(Ne), Ne;
        }
        ot = ot || 0;
        for (var ce = 0; ce < ot; ++ce)
          rt();
        var _e = ye(), qe = _e.toString, ht = We[tt] = n(_e, {
          arg: rt,
          toString: function() {
            return $u([
              "function(",
              Ue.join(),
              "){",
              qe(),
              "}"
            ]);
          }
        });
        return ht;
      }
      function Ve() {
        var tt = [
          '"use strict";',
          ze,
          "return {"
        ];
        Object.keys(We).forEach(function(rt) {
          tt.push('"', rt, '":', We[rt].toString(), ",");
        }), tt.push("}");
        var ot = $u(tt).replace(/;/g, `;
`).replace(/}/g, `}
`).replace(/{/g, `{
`), Ue = Function.apply(null, z.concat(ot));
        return Ue.apply(null, H);
      }
      return {
        global: ze,
        link: me,
        block: Ie,
        proc: Ze,
        scope: ye,
        cond: xe,
        compile: Ve
      };
    }
    var Wu = "xyzw".split(""), gw = 5121, Vu = 1, a0 = 2, o0 = 0, s0 = 1, u0 = 2, f0 = 3, Wh = 4, yw = 5, mw = 6, bw = "dither", xw = "blend.enable", _w = "blend.color", l0 = "blend.equation", c0 = "blend.func", ww = "depth.enable", Ew = "depth.func", Sw = "depth.range", Mw = "depth.mask", h0 = "colorMask", Cw = "cull.enable", Tw = "cull.face", d0 = "frontFace", v0 = "lineWidth", Aw = "polygonOffset.enable", p0 = "polygonOffset.offset", Iw = "sample.alpha", Pw = "sample.enable", g0 = "sample.coverage", Ow = "stencil.enable", Dw = "stencil.mask", y0 = "stencil.func", m0 = "stencil.opFront", vl = "stencil.opBack", kw = "scissor.enable", Vh = "scissor.box", eo = "viewport", pl = "profile", ks = "framebuffer", gl = "vert", yl = "frag", Ls = "elements", Ns = "primitive", Rs = "count", Xh = "offset", Yh = "instances", ml = "vao", b0 = "Width", x0 = "Height", Xu = ks + b0, Yu = ks + x0, AF = eo + b0, IF = eo + x0, Lw = "drawingBuffer", Nw = Lw + b0, Rw = Lw + x0, PF = [
      c0,
      l0,
      y0,
      m0,
      vl,
      g0,
      eo,
      Vh,
      p0
    ], Hu = 34962, OF = 34963, DF = 35632, kF = 35633, Bw = 3553, LF = 34067, NF = 2884, RF = 3042, BF = 3024, GF = 2960, FF = 2929, zF = 3089, UF = 32823, jF = 32926, $F = 32928, _0 = 5126, Hh = 35664, Kh = 35665, qh = 35666, w0 = 5124, Zh = 35667, Qh = 35668, Jh = 35669, E0 = 35670, ed = 35671, td = 35672, rd = 35673, bl = 35674, xl = 35675, _l = 35676, wl = 35678, El = 35680, Gw = 4, Sl = 1028, Bs = 1029, Fw = 2304, S0 = 2305, WF = 32775, VF = 32776, XF = 519, Go = 7680, zw = 0, Uw = 1, jw = 32774, YF = 513, $w = 36160, HF = 36064, ha = {
      0: 0,
      1: 1,
      zero: 0,
      one: 1,
      "src color": 768,
      "one minus src color": 769,
      "src alpha": 770,
      "one minus src alpha": 771,
      "dst color": 774,
      "one minus dst color": 775,
      "dst alpha": 772,
      "one minus dst alpha": 773,
      "constant color": 32769,
      "one minus constant color": 32770,
      "constant alpha": 32771,
      "one minus constant alpha": 32772,
      "src alpha saturate": 776
    }, Ww = [
      "constant color, constant alpha",
      "one minus constant color, constant alpha",
      "constant color, one minus constant alpha",
      "one minus constant color, one minus constant alpha",
      "constant alpha, constant color",
      "constant alpha, one minus constant color",
      "one minus constant alpha, constant color",
      "one minus constant alpha, one minus constant color"
    ], Ku = {
      never: 512,
      less: 513,
      "<": 513,
      equal: 514,
      "=": 514,
      "==": 514,
      "===": 514,
      lequal: 515,
      "<=": 515,
      greater: 516,
      ">": 516,
      notequal: 517,
      "!=": 517,
      "!==": 517,
      gequal: 518,
      ">=": 518,
      always: 519
    }, Fo = {
      0: 0,
      zero: 0,
      keep: 7680,
      replace: 7681,
      increment: 7682,
      decrement: 7683,
      "increment wrap": 34055,
      "decrement wrap": 34056,
      invert: 5386
    }, Vw = {
      frag: DF,
      vert: kF
    }, M0 = {
      cw: Fw,
      ccw: S0
    };
    function nd(I) {
      return Array.isArray(I) || e(I) || Yi(I);
    }
    function Xw(I) {
      return I.sort(function(z, H) {
        return z === eo ? -1 : H === eo ? 1 : z < H ? -1 : 1;
      });
    }
    function qn(I, z, H, me) {
      this.thisDep = I, this.contextDep = z, this.propDep = H, this.append = me;
    }
    function zo(I) {
      return I && !(I.thisDep || I.contextDep || I.propDep);
    }
    function Qr(I) {
      return new qn(!1, !1, !1, I);
    }
    function ri(I, z) {
      var H = I.type;
      if (H === o0) {
        var me = I.data.length;
        return new qn(
          !0,
          me >= 1,
          me >= 2,
          z
        );
      } else if (H === Wh) {
        var Ie = I.data;
        return new qn(
          Ie.thisDep,
          Ie.contextDep,
          Ie.propDep,
          z
        );
      } else {
        if (H === yw)
          return new qn(
            !1,
            !1,
            !1,
            z
          );
        if (H === mw) {
          for (var ye = !1, xe = !1, ze = !1, We = 0; We < I.data.length; ++We) {
            var Ze = I.data[We];
            if (Ze.type === s0)
              ze = !0;
            else if (Ze.type === u0)
              xe = !0;
            else if (Ze.type === f0)
              ye = !0;
            else if (Ze.type === o0) {
              ye = !0;
              var Ve = Ze.data;
              Ve >= 1 && (xe = !0), Ve >= 2 && (ze = !0);
            } else
              Ze.type === Wh && (ye = ye || Ze.data.thisDep, xe = xe || Ze.data.contextDep, ze = ze || Ze.data.propDep);
          }
          return new qn(
            ye,
            xe,
            ze,
            z
          );
        } else
          return new qn(
            H === f0,
            H === u0,
            H === s0,
            z
          );
      }
    }
    var Yw = new qn(!1, !1, !1, function() {
    });
    function KF(I, z, H, me, Ie, ye, xe, ze, We, Ze, Ve, tt, ot, Ue, rt) {
      var ce = Ze.Record, _e = {
        add: 32774,
        subtract: 32778,
        "reverse subtract": 32779
      };
      H.ext_blend_minmax && (_e.min = WF, _e.max = VF);
      var qe = H.angle_instanced_arrays, ht = H.webgl_draw_buffers, Ne = {
        dirty: !0,
        profile: rt.profile
      }, gt = {}, Be = [], nt = {}, Re = {};
      function it(W) {
        return W.replace(".", "_");
      }
      function It(W, B, Q) {
        var fe = it(W);
        Be.push(W), gt[fe] = Ne[fe] = !!Q, nt[fe] = B;
      }
      function Vt(W, B, Q) {
        var fe = it(W);
        Be.push(W), Array.isArray(Q) ? (Ne[fe] = Q.slice(), gt[fe] = Q.slice()) : Ne[fe] = gt[fe] = Q, Re[fe] = B;
      }
      It(bw, BF), It(xw, RF), Vt(_w, "blendColor", [0, 0, 0, 0]), Vt(
        l0,
        "blendEquationSeparate",
        [jw, jw]
      ), Vt(
        c0,
        "blendFuncSeparate",
        [Uw, zw, Uw, zw]
      ), It(ww, FF, !0), Vt(Ew, "depthFunc", YF), Vt(Sw, "depthRange", [0, 1]), Vt(Mw, "depthMask", !0), Vt(h0, h0, [!0, !0, !0, !0]), It(Cw, NF), Vt(Tw, "cullFace", Bs), Vt(d0, d0, S0), Vt(v0, v0, 1), It(Aw, UF), Vt(p0, "polygonOffset", [0, 0]), It(Iw, jF), It(Pw, $F), Vt(g0, "sampleCoverage", [1, !1]), It(Ow, GF), Vt(Dw, "stencilMask", -1), Vt(y0, "stencilFunc", [XF, 0, -1]), Vt(
        m0,
        "stencilOpSeparate",
        [Sl, Go, Go, Go]
      ), Vt(
        vl,
        "stencilOpSeparate",
        [Bs, Go, Go, Go]
      ), It(kw, zF), Vt(
        Vh,
        "scissor",
        [0, 0, I.drawingBufferWidth, I.drawingBufferHeight]
      ), Vt(
        eo,
        eo,
        [0, 0, I.drawingBufferWidth, I.drawingBufferHeight]
      );
      var st = {
        gl: I,
        context: ot,
        strings: z,
        next: gt,
        current: Ne,
        draw: tt,
        elements: ye,
        buffer: Ie,
        shader: Ve,
        attributes: Ze.state,
        vao: Ze,
        uniforms: We,
        framebuffer: ze,
        extensions: H,
        timer: Ue,
        isBufferArgs: nd
      }, Je = {
        primTypes: Lu,
        compareFuncs: Ku,
        blendFuncs: ha,
        blendEquations: _e,
        stencilOps: Fo,
        glTypes: As,
        orientationType: M0
      };
      N.optional(function() {
        st.isArrayLike = Yr;
      }), ht && (Je.backBuffer = [Bs], Je.drawBuffer = dn(me.maxDrawbuffers, function(W) {
        return W === 0 ? [0] : dn(W, function(B) {
          return HF + B;
        });
      }));
      var Le = 0;
      function jt() {
        var W = TF(), B = W.link, Q = W.global;
        W.id = Le++, W.batchId = "0";
        var fe = B(st), de = W.shared = {
          props: "a0"
        };
        Object.keys(st).forEach(function(K) {
          de[K] = Q.def(fe, ".", K);
        }), N.optional(function() {
          W.CHECK = B(N), W.commandStr = N.guessCommand(), W.command = B(W.commandStr), W.assert = function(K, j, ue) {
            K(
              "if(!(",
              j,
              "))",
              this.CHECK,
              ".commandRaise(",
              B(ue),
              ",",
              this.command,
              ");"
            );
          }, Je.invalidBlendCombinations = Ww;
        });
        var re = W.next = {}, ee = W.current = {};
        Object.keys(Re).forEach(function(K) {
          Array.isArray(Ne[K]) && (re[K] = Q.def(de.next, ".", K), ee[K] = Q.def(de.current, ".", K));
        });
        var ae = W.constants = {};
        Object.keys(Je).forEach(function(K) {
          ae[K] = Q.def(JSON.stringify(Je[K]));
        }), W.invoke = function(K, j) {
          switch (j.type) {
            case o0:
              var ue = [
                "this",
                de.context,
                de.props,
                W.batchId
              ];
              return K.def(
                B(j.data),
                ".call(",
                ue.slice(0, Math.max(j.data.length + 1, 4)),
                ")"
              );
            case s0:
              return K.def(de.props, j.data);
            case u0:
              return K.def(de.context, j.data);
            case f0:
              return K.def("this", j.data);
            case Wh:
              return j.data.append(W, K), j.data.ref;
            case yw:
              return j.data.toString();
            case mw:
              return j.data.map(function(ve) {
                return W.invoke(K, ve);
              });
          }
        }, W.attribCache = {};
        var V = {};
        return W.scopeAttrib = function(K) {
          var j = z.id(K);
          if (j in V)
            return V[j];
          var ue = Ze.scope[j];
          ue || (ue = Ze.scope[j] = new ce());
          var ve = V[j] = B(ue);
          return ve;
        }, W;
      }
      function qt(W) {
        var B = W.static, Q = W.dynamic, fe;
        if (pl in B) {
          var de = !!B[pl];
          fe = Qr(function(ee, ae) {
            return de;
          }), fe.enable = de;
        } else if (pl in Q) {
          var re = Q[pl];
          fe = ri(re, function(ee, ae) {
            return ee.invoke(ae, re);
          });
        }
        return fe;
      }
      function bt(W, B) {
        var Q = W.static, fe = W.dynamic;
        if (ks in Q) {
          var de = Q[ks];
          return de ? (de = ze.getFramebuffer(de), N.command(de, "invalid framebuffer object"), Qr(function(ee, ae) {
            var V = ee.link(de), K = ee.shared;
            ae.set(
              K.framebuffer,
              ".next",
              V
            );
            var j = K.context;
            return ae.set(
              j,
              "." + Xu,
              V + ".width"
            ), ae.set(
              j,
              "." + Yu,
              V + ".height"
            ), V;
          })) : Qr(function(ee, ae) {
            var V = ee.shared;
            ae.set(
              V.framebuffer,
              ".next",
              "null"
            );
            var K = V.context;
            return ae.set(
              K,
              "." + Xu,
              K + "." + Nw
            ), ae.set(
              K,
              "." + Yu,
              K + "." + Rw
            ), "null";
          });
        } else if (ks in fe) {
          var re = fe[ks];
          return ri(re, function(ee, ae) {
            var V = ee.invoke(ae, re), K = ee.shared, j = K.framebuffer, ue = ae.def(
              j,
              ".getFramebuffer(",
              V,
              ")"
            );
            N.optional(function() {
              ee.assert(
                ae,
                "!" + V + "||" + ue,
                "invalid framebuffer object"
              );
            }), ae.set(
              j,
              ".next",
              ue
            );
            var ve = K.context;
            return ae.set(
              ve,
              "." + Xu,
              ue + "?" + ue + ".width:" + ve + "." + Nw
            ), ae.set(
              ve,
              "." + Yu,
              ue + "?" + ue + ".height:" + ve + "." + Rw
            ), ue;
          });
        } else
          return null;
      }
      function er(W, B, Q) {
        var fe = W.static, de = W.dynamic;
        function re(V) {
          if (V in fe) {
            var K = fe[V];
            N.commandType(K, "object", "invalid " + V, Q.commandStr);
            var j = !0, ue = K.x | 0, ve = K.y | 0, Te, Pe;
            return "width" in K ? (Te = K.width | 0, N.command(Te >= 0, "invalid " + V, Q.commandStr)) : j = !1, "height" in K ? (Pe = K.height | 0, N.command(Pe >= 0, "invalid " + V, Q.commandStr)) : j = !1, new qn(
              !j && B && B.thisDep,
              !j && B && B.contextDep,
              !j && B && B.propDep,
              function(Mt, Qt) {
                var xt = Mt.shared.context, Rt = Te;
                "width" in K || (Rt = Qt.def(xt, ".", Xu, "-", ue));
                var Yt = Pe;
                return "height" in K || (Yt = Qt.def(xt, ".", Yu, "-", ve)), [ue, ve, Rt, Yt];
              }
            );
          } else if (V in de) {
            var we = de[V], He = ri(we, function(Mt, Qt) {
              var xt = Mt.invoke(Qt, we);
              N.optional(function() {
                Mt.assert(
                  Qt,
                  xt + "&&typeof " + xt + '==="object"',
                  "invalid " + V
                );
              });
              var Rt = Mt.shared.context, Yt = Qt.def(xt, ".x|0"), yr = Qt.def(xt, ".y|0"), $r = Qt.def(
                '"width" in ',
                xt,
                "?",
                xt,
                ".width|0:",
                "(",
                Rt,
                ".",
                Xu,
                "-",
                Yt,
                ")"
              ), Zn = Qt.def(
                '"height" in ',
                xt,
                "?",
                xt,
                ".height|0:",
                "(",
                Rt,
                ".",
                Yu,
                "-",
                yr,
                ")"
              );
              return N.optional(function() {
                Mt.assert(
                  Qt,
                  $r + ">=0&&" + Zn + ">=0",
                  "invalid " + V
                );
              }), [Yt, yr, $r, Zn];
            });
            return B && (He.thisDep = He.thisDep || B.thisDep, He.contextDep = He.contextDep || B.contextDep, He.propDep = He.propDep || B.propDep), He;
          } else
            return B ? new qn(
              B.thisDep,
              B.contextDep,
              B.propDep,
              function(Mt, Qt) {
                var xt = Mt.shared.context;
                return [
                  0,
                  0,
                  Qt.def(xt, ".", Xu),
                  Qt.def(xt, ".", Yu)
                ];
              }
            ) : null;
        }
        var ee = re(eo);
        if (ee) {
          var ae = ee;
          ee = new qn(
            ee.thisDep,
            ee.contextDep,
            ee.propDep,
            function(V, K) {
              var j = ae.append(V, K), ue = V.shared.context;
              return K.set(
                ue,
                "." + AF,
                j[2]
              ), K.set(
                ue,
                "." + IF,
                j[3]
              ), j;
            }
          );
        }
        return {
          viewport: ee,
          scissor_box: re(Vh)
        };
      }
      function Xt(W, B) {
        var Q = W.static, fe = typeof Q[yl] == "string" && typeof Q[gl] == "string";
        if (fe) {
          if (Object.keys(B.dynamic).length > 0)
            return null;
          var de = B.static, re = Object.keys(de);
          if (re.length > 0 && typeof de[re[0]] == "number") {
            for (var ee = [], ae = 0; ae < re.length; ++ae)
              N(typeof de[re[ae]] == "number", "must specify all vertex attribute locations when using vaos"), ee.push([de[re[ae]] | 0, re[ae]]);
            return ee;
          }
        }
        return null;
      }
      function Jt(W, B, Q) {
        var fe = W.static, de = W.dynamic;
        function re(j) {
          if (j in fe) {
            var ue = z.id(fe[j]);
            N.optional(function() {
              Ve.shader(Vw[j], ue, N.guessCommand());
            });
            var ve = Qr(function() {
              return ue;
            });
            return ve.id = ue, ve;
          } else if (j in de) {
            var Te = de[j];
            return ri(Te, function(Pe, we) {
              var He = Pe.invoke(we, Te), Mt = we.def(Pe.shared.strings, ".id(", He, ")");
              return N.optional(function() {
                we(
                  Pe.shared.shader,
                  ".shader(",
                  Vw[j],
                  ",",
                  Mt,
                  ",",
                  Pe.command,
                  ");"
                );
              }), Mt;
            });
          }
          return null;
        }
        var ee = re(yl), ae = re(gl), V = null, K;
        return zo(ee) && zo(ae) ? (V = Ve.program(ae.id, ee.id, null, Q), K = Qr(function(j, ue) {
          return j.link(V);
        })) : K = new qn(
          ee && ee.thisDep || ae && ae.thisDep,
          ee && ee.contextDep || ae && ae.contextDep,
          ee && ee.propDep || ae && ae.propDep,
          function(j, ue) {
            var ve = j.shared.shader, Te;
            ee ? Te = ee.append(j, ue) : Te = ue.def(ve, ".", yl);
            var Pe;
            ae ? Pe = ae.append(j, ue) : Pe = ue.def(ve, ".", gl);
            var we = ve + ".program(" + Pe + "," + Te;
            return N.optional(function() {
              we += "," + j.command;
            }), ue.def(we + ")");
          }
        ), {
          frag: ee,
          vert: ae,
          progVar: K,
          program: V
        };
      }
      function gr(W, B) {
        var Q = W.static, fe = W.dynamic;
        function de() {
          if (Ls in Q) {
            var j = Q[Ls];
            nd(j) ? j = ye.getElements(ye.create(j, !0)) : j && (j = ye.getElements(j), N.command(j, "invalid elements", B.commandStr));
            var ue = Qr(function(Te, Pe) {
              if (j) {
                var we = Te.link(j);
                return Te.ELEMENTS = we, we;
              }
              return Te.ELEMENTS = null, null;
            });
            return ue.value = j, ue;
          } else if (Ls in fe) {
            var ve = fe[Ls];
            return ri(ve, function(Te, Pe) {
              var we = Te.shared, He = we.isBufferArgs, Mt = we.elements, Qt = Te.invoke(Pe, ve), xt = Pe.def("null"), Rt = Pe.def(He, "(", Qt, ")"), Yt = Te.cond(Rt).then(xt, "=", Mt, ".createStream(", Qt, ");").else(xt, "=", Mt, ".getElements(", Qt, ");");
              return N.optional(function() {
                Te.assert(
                  Yt.else,
                  "!" + Qt + "||" + xt,
                  "invalid elements"
                );
              }), Pe.entry(Yt), Pe.exit(
                Te.cond(Rt).then(Mt, ".destroyStream(", xt, ");")
              ), Te.ELEMENTS = xt, xt;
            });
          }
          return null;
        }
        var re = de();
        function ee() {
          if (Ns in Q) {
            var j = Q[Ns];
            return N.commandParameter(j, Lu, "invalid primitve", B.commandStr), Qr(function(ve, Te) {
              return Lu[j];
            });
          } else if (Ns in fe) {
            var ue = fe[Ns];
            return ri(ue, function(ve, Te) {
              var Pe = ve.constants.primTypes, we = ve.invoke(Te, ue);
              return N.optional(function() {
                ve.assert(
                  Te,
                  we + " in " + Pe,
                  "invalid primitive, must be one of " + Object.keys(Lu)
                );
              }), Te.def(Pe, "[", we, "]");
            });
          } else if (re)
            return zo(re) ? re.value ? Qr(function(ve, Te) {
              return Te.def(ve.ELEMENTS, ".primType");
            }) : Qr(function() {
              return Gw;
            }) : new qn(
              re.thisDep,
              re.contextDep,
              re.propDep,
              function(ve, Te) {
                var Pe = ve.ELEMENTS;
                return Te.def(Pe, "?", Pe, ".primType:", Gw);
              }
            );
          return null;
        }
        function ae(j, ue) {
          if (j in Q) {
            var ve = Q[j] | 0;
            return N.command(!ue || ve >= 0, "invalid " + j, B.commandStr), Qr(function(Pe, we) {
              return ue && (Pe.OFFSET = ve), ve;
            });
          } else if (j in fe) {
            var Te = fe[j];
            return ri(Te, function(Pe, we) {
              var He = Pe.invoke(we, Te);
              return ue && (Pe.OFFSET = He, N.optional(function() {
                Pe.assert(
                  we,
                  He + ">=0",
                  "invalid " + j
                );
              })), He;
            });
          } else if (ue && re)
            return Qr(function(Pe, we) {
              return Pe.OFFSET = "0", 0;
            });
          return null;
        }
        var V = ae(Xh, !0);
        function K() {
          if (Rs in Q) {
            var j = Q[Rs] | 0;
            return N.command(
              typeof j == "number" && j >= 0,
              "invalid vertex count",
              B.commandStr
            ), Qr(function() {
              return j;
            });
          } else if (Rs in fe) {
            var ue = fe[Rs];
            return ri(ue, function(Pe, we) {
              var He = Pe.invoke(we, ue);
              return N.optional(function() {
                Pe.assert(
                  we,
                  "typeof " + He + '==="number"&&' + He + ">=0&&" + He + "===(" + He + "|0)",
                  "invalid vertex count"
                );
              }), He;
            });
          } else if (re)
            if (zo(re)) {
              if (re)
                return V ? new qn(
                  V.thisDep,
                  V.contextDep,
                  V.propDep,
                  function(Pe, we) {
                    var He = we.def(
                      Pe.ELEMENTS,
                      ".vertCount-",
                      Pe.OFFSET
                    );
                    return N.optional(function() {
                      Pe.assert(
                        we,
                        He + ">=0",
                        "invalid vertex offset/element buffer too small"
                      );
                    }), He;
                  }
                ) : Qr(function(Pe, we) {
                  return we.def(Pe.ELEMENTS, ".vertCount");
                });
              var ve = Qr(function() {
                return -1;
              });
              return N.optional(function() {
                ve.MISSING = !0;
              }), ve;
            } else {
              var Te = new qn(
                re.thisDep || V.thisDep,
                re.contextDep || V.contextDep,
                re.propDep || V.propDep,
                function(Pe, we) {
                  var He = Pe.ELEMENTS;
                  return Pe.OFFSET ? we.def(
                    He,
                    "?",
                    He,
                    ".vertCount-",
                    Pe.OFFSET,
                    ":-1"
                  ) : we.def(He, "?", He, ".vertCount:-1");
                }
              );
              return N.optional(function() {
                Te.DYNAMIC = !0;
              }), Te;
            }
          return null;
        }
        return {
          elements: re,
          primitive: ee(),
          count: K(),
          instances: ae(Yh, !1),
          offset: V
        };
      }
      function Jr(W, B) {
        var Q = W.static, fe = W.dynamic, de = {};
        return Be.forEach(function(re) {
          var ee = it(re);
          function ae(V, K) {
            if (re in Q) {
              var j = V(Q[re]);
              de[ee] = Qr(function() {
                return j;
              });
            } else if (re in fe) {
              var ue = fe[re];
              de[ee] = ri(ue, function(ve, Te) {
                return K(ve, Te, ve.invoke(Te, ue));
              });
            }
          }
          switch (re) {
            case Cw:
            case xw:
            case bw:
            case Ow:
            case ww:
            case kw:
            case Aw:
            case Iw:
            case Pw:
            case Mw:
              return ae(
                function(V) {
                  return N.commandType(V, "boolean", re, B.commandStr), V;
                },
                function(V, K, j) {
                  return N.optional(function() {
                    V.assert(
                      K,
                      "typeof " + j + '==="boolean"',
                      "invalid flag " + re,
                      V.commandStr
                    );
                  }), j;
                }
              );
            case Ew:
              return ae(
                function(V) {
                  return N.commandParameter(V, Ku, "invalid " + re, B.commandStr), Ku[V];
                },
                function(V, K, j) {
                  var ue = V.constants.compareFuncs;
                  return N.optional(function() {
                    V.assert(
                      K,
                      j + " in " + ue,
                      "invalid " + re + ", must be one of " + Object.keys(Ku)
                    );
                  }), K.def(ue, "[", j, "]");
                }
              );
            case Sw:
              return ae(
                function(V) {
                  return N.command(
                    Yr(V) && V.length === 2 && typeof V[0] == "number" && typeof V[1] == "number" && V[0] <= V[1],
                    "depth range is 2d array",
                    B.commandStr
                  ), V;
                },
                function(V, K, j) {
                  N.optional(function() {
                    V.assert(
                      K,
                      V.shared.isArrayLike + "(" + j + ")&&" + j + ".length===2&&typeof " + j + '[0]==="number"&&typeof ' + j + '[1]==="number"&&' + j + "[0]<=" + j + "[1]",
                      "depth range must be a 2d array"
                    );
                  });
                  var ue = K.def("+", j, "[0]"), ve = K.def("+", j, "[1]");
                  return [ue, ve];
                }
              );
            case c0:
              return ae(
                function(V) {
                  N.commandType(V, "object", "blend.func", B.commandStr);
                  var K = "srcRGB" in V ? V.srcRGB : V.src, j = "srcAlpha" in V ? V.srcAlpha : V.src, ue = "dstRGB" in V ? V.dstRGB : V.dst, ve = "dstAlpha" in V ? V.dstAlpha : V.dst;
                  return N.commandParameter(K, ha, ee + ".srcRGB", B.commandStr), N.commandParameter(j, ha, ee + ".srcAlpha", B.commandStr), N.commandParameter(ue, ha, ee + ".dstRGB", B.commandStr), N.commandParameter(ve, ha, ee + ".dstAlpha", B.commandStr), N.command(
                    Ww.indexOf(K + ", " + ue) === -1,
                    "unallowed blending combination (srcRGB, dstRGB) = (" + K + ", " + ue + ")",
                    B.commandStr
                  ), [
                    ha[K],
                    ha[ue],
                    ha[j],
                    ha[ve]
                  ];
                },
                function(V, K, j) {
                  var ue = V.constants.blendFuncs;
                  N.optional(function() {
                    V.assert(
                      K,
                      j + "&&typeof " + j + '==="object"',
                      "invalid blend func, must be an object"
                    );
                  });
                  function ve(xt, Rt) {
                    var Yt = K.def(
                      '"',
                      xt,
                      Rt,
                      '" in ',
                      j,
                      "?",
                      j,
                      ".",
                      xt,
                      Rt,
                      ":",
                      j,
                      ".",
                      xt
                    );
                    return N.optional(function() {
                      V.assert(
                        K,
                        Yt + " in " + ue,
                        "invalid " + re + "." + xt + Rt + ", must be one of " + Object.keys(ha)
                      );
                    }), Yt;
                  }
                  var Te = ve("src", "RGB"), Pe = ve("dst", "RGB");
                  N.optional(function() {
                    var xt = V.constants.invalidBlendCombinations;
                    V.assert(
                      K,
                      xt + ".indexOf(" + Te + '+", "+' + Pe + ") === -1 ",
                      "unallowed blending combination for (srcRGB, dstRGB)"
                    );
                  });
                  var we = K.def(ue, "[", Te, "]"), He = K.def(ue, "[", ve("src", "Alpha"), "]"), Mt = K.def(ue, "[", Pe, "]"), Qt = K.def(ue, "[", ve("dst", "Alpha"), "]");
                  return [we, Mt, He, Qt];
                }
              );
            case l0:
              return ae(
                function(V) {
                  if (typeof V == "string")
                    return N.commandParameter(V, _e, "invalid " + re, B.commandStr), [
                      _e[V],
                      _e[V]
                    ];
                  if (typeof V == "object")
                    return N.commandParameter(
                      V.rgb,
                      _e,
                      re + ".rgb",
                      B.commandStr
                    ), N.commandParameter(
                      V.alpha,
                      _e,
                      re + ".alpha",
                      B.commandStr
                    ), [
                      _e[V.rgb],
                      _e[V.alpha]
                    ];
                  N.commandRaise("invalid blend.equation", B.commandStr);
                },
                function(V, K, j) {
                  var ue = V.constants.blendEquations, ve = K.def(), Te = K.def(), Pe = V.cond("typeof ", j, '==="string"');
                  return N.optional(function() {
                    function we(He, Mt, Qt) {
                      V.assert(
                        He,
                        Qt + " in " + ue,
                        "invalid " + Mt + ", must be one of " + Object.keys(_e)
                      );
                    }
                    we(Pe.then, re, j), V.assert(
                      Pe.else,
                      j + "&&typeof " + j + '==="object"',
                      "invalid " + re
                    ), we(Pe.else, re + ".rgb", j + ".rgb"), we(Pe.else, re + ".alpha", j + ".alpha");
                  }), Pe.then(
                    ve,
                    "=",
                    Te,
                    "=",
                    ue,
                    "[",
                    j,
                    "];"
                  ), Pe.else(
                    ve,
                    "=",
                    ue,
                    "[",
                    j,
                    ".rgb];",
                    Te,
                    "=",
                    ue,
                    "[",
                    j,
                    ".alpha];"
                  ), K(Pe), [ve, Te];
                }
              );
            case _w:
              return ae(
                function(V) {
                  return N.command(
                    Yr(V) && V.length === 4,
                    "blend.color must be a 4d array",
                    B.commandStr
                  ), dn(4, function(K) {
                    return +V[K];
                  });
                },
                function(V, K, j) {
                  return N.optional(function() {
                    V.assert(
                      K,
                      V.shared.isArrayLike + "(" + j + ")&&" + j + ".length===4",
                      "blend.color must be a 4d array"
                    );
                  }), dn(4, function(ue) {
                    return K.def("+", j, "[", ue, "]");
                  });
                }
              );
            case Dw:
              return ae(
                function(V) {
                  return N.commandType(V, "number", ee, B.commandStr), V | 0;
                },
                function(V, K, j) {
                  return N.optional(function() {
                    V.assert(
                      K,
                      "typeof " + j + '==="number"',
                      "invalid stencil.mask"
                    );
                  }), K.def(j, "|0");
                }
              );
            case y0:
              return ae(
                function(V) {
                  N.commandType(V, "object", ee, B.commandStr);
                  var K = V.cmp || "keep", j = V.ref || 0, ue = "mask" in V ? V.mask : -1;
                  return N.commandParameter(K, Ku, re + ".cmp", B.commandStr), N.commandType(j, "number", re + ".ref", B.commandStr), N.commandType(ue, "number", re + ".mask", B.commandStr), [
                    Ku[K],
                    j,
                    ue
                  ];
                },
                function(V, K, j) {
                  var ue = V.constants.compareFuncs;
                  N.optional(function() {
                    function we() {
                      V.assert(
                        K,
                        Array.prototype.join.call(arguments, ""),
                        "invalid stencil.func"
                      );
                    }
                    we(j + "&&typeof ", j, '==="object"'), we(
                      '!("cmp" in ',
                      j,
                      ")||(",
                      j,
                      ".cmp in ",
                      ue,
                      ")"
                    );
                  });
                  var ve = K.def(
                    '"cmp" in ',
                    j,
                    "?",
                    ue,
                    "[",
                    j,
                    ".cmp]",
                    ":",
                    Go
                  ), Te = K.def(j, ".ref|0"), Pe = K.def(
                    '"mask" in ',
                    j,
                    "?",
                    j,
                    ".mask|0:-1"
                  );
                  return [ve, Te, Pe];
                }
              );
            case m0:
            case vl:
              return ae(
                function(V) {
                  N.commandType(V, "object", ee, B.commandStr);
                  var K = V.fail || "keep", j = V.zfail || "keep", ue = V.zpass || "keep";
                  return N.commandParameter(K, Fo, re + ".fail", B.commandStr), N.commandParameter(j, Fo, re + ".zfail", B.commandStr), N.commandParameter(ue, Fo, re + ".zpass", B.commandStr), [
                    re === vl ? Bs : Sl,
                    Fo[K],
                    Fo[j],
                    Fo[ue]
                  ];
                },
                function(V, K, j) {
                  var ue = V.constants.stencilOps;
                  N.optional(function() {
                    V.assert(
                      K,
                      j + "&&typeof " + j + '==="object"',
                      "invalid " + re
                    );
                  });
                  function ve(Te) {
                    return N.optional(function() {
                      V.assert(
                        K,
                        '!("' + Te + '" in ' + j + ")||(" + j + "." + Te + " in " + ue + ")",
                        "invalid " + re + "." + Te + ", must be one of " + Object.keys(Fo)
                      );
                    }), K.def(
                      '"',
                      Te,
                      '" in ',
                      j,
                      "?",
                      ue,
                      "[",
                      j,
                      ".",
                      Te,
                      "]:",
                      Go
                    );
                  }
                  return [
                    re === vl ? Bs : Sl,
                    ve("fail"),
                    ve("zfail"),
                    ve("zpass")
                  ];
                }
              );
            case p0:
              return ae(
                function(V) {
                  N.commandType(V, "object", ee, B.commandStr);
                  var K = V.factor | 0, j = V.units | 0;
                  return N.commandType(K, "number", ee + ".factor", B.commandStr), N.commandType(j, "number", ee + ".units", B.commandStr), [K, j];
                },
                function(V, K, j) {
                  N.optional(function() {
                    V.assert(
                      K,
                      j + "&&typeof " + j + '==="object"',
                      "invalid " + re
                    );
                  });
                  var ue = K.def(j, ".factor|0"), ve = K.def(j, ".units|0");
                  return [ue, ve];
                }
              );
            case Tw:
              return ae(
                function(V) {
                  var K = 0;
                  return V === "front" ? K = Sl : V === "back" && (K = Bs), N.command(!!K, ee, B.commandStr), K;
                },
                function(V, K, j) {
                  return N.optional(function() {
                    V.assert(
                      K,
                      j + '==="front"||' + j + '==="back"',
                      "invalid cull.face"
                    );
                  }), K.def(j, '==="front"?', Sl, ":", Bs);
                }
              );
            case v0:
              return ae(
                function(V) {
                  return N.command(
                    typeof V == "number" && V >= me.lineWidthDims[0] && V <= me.lineWidthDims[1],
                    "invalid line width, must be a positive number between " + me.lineWidthDims[0] + " and " + me.lineWidthDims[1],
                    B.commandStr
                  ), V;
                },
                function(V, K, j) {
                  return N.optional(function() {
                    V.assert(
                      K,
                      "typeof " + j + '==="number"&&' + j + ">=" + me.lineWidthDims[0] + "&&" + j + "<=" + me.lineWidthDims[1],
                      "invalid line width"
                    );
                  }), j;
                }
              );
            case d0:
              return ae(
                function(V) {
                  return N.commandParameter(V, M0, ee, B.commandStr), M0[V];
                },
                function(V, K, j) {
                  return N.optional(function() {
                    V.assert(
                      K,
                      j + '==="cw"||' + j + '==="ccw"',
                      "invalid frontFace, must be one of cw,ccw"
                    );
                  }), K.def(j + '==="cw"?' + Fw + ":" + S0);
                }
              );
            case h0:
              return ae(
                function(V) {
                  return N.command(
                    Yr(V) && V.length === 4,
                    "color.mask must be length 4 array",
                    B.commandStr
                  ), V.map(function(K) {
                    return !!K;
                  });
                },
                function(V, K, j) {
                  return N.optional(function() {
                    V.assert(
                      K,
                      V.shared.isArrayLike + "(" + j + ")&&" + j + ".length===4",
                      "invalid color.mask"
                    );
                  }), dn(4, function(ue) {
                    return "!!" + j + "[" + ue + "]";
                  });
                }
              );
            case g0:
              return ae(
                function(V) {
                  N.command(typeof V == "object" && V, ee, B.commandStr);
                  var K = "value" in V ? V.value : 1, j = !!V.invert;
                  return N.command(
                    typeof K == "number" && K >= 0 && K <= 1,
                    "sample.coverage.value must be a number between 0 and 1",
                    B.commandStr
                  ), [K, j];
                },
                function(V, K, j) {
                  N.optional(function() {
                    V.assert(
                      K,
                      j + "&&typeof " + j + '==="object"',
                      "invalid sample.coverage"
                    );
                  });
                  var ue = K.def(
                    '"value" in ',
                    j,
                    "?+",
                    j,
                    ".value:1"
                  ), ve = K.def("!!", j, ".invert");
                  return [ue, ve];
                }
              );
          }
        }), de;
      }
      function vn(W, B) {
        var Q = W.static, fe = W.dynamic, de = {};
        return Object.keys(Q).forEach(function(re) {
          var ee = Q[re], ae;
          if (typeof ee == "number" || typeof ee == "boolean")
            ae = Qr(function() {
              return ee;
            });
          else if (typeof ee == "function") {
            var V = ee._reglType;
            V === "texture2d" || V === "textureCube" ? ae = Qr(function(K) {
              return K.link(ee);
            }) : V === "framebuffer" || V === "framebufferCube" ? (N.command(
              ee.color.length > 0,
              'missing color attachment for framebuffer sent to uniform "' + re + '"',
              B.commandStr
            ), ae = Qr(function(K) {
              return K.link(ee.color[0]);
            })) : N.commandRaise('invalid data for uniform "' + re + '"', B.commandStr);
          } else
            Yr(ee) ? ae = Qr(function(K) {
              var j = K.global.def(
                "[",
                dn(ee.length, function(ue) {
                  return N.command(
                    typeof ee[ue] == "number" || typeof ee[ue] == "boolean",
                    "invalid uniform " + re,
                    K.commandStr
                  ), ee[ue];
                }),
                "]"
              );
              return j;
            }) : N.commandRaise('invalid or missing data for uniform "' + re + '"', B.commandStr);
          ae.value = ee, de[re] = ae;
        }), Object.keys(fe).forEach(function(re) {
          var ee = fe[re];
          de[re] = ri(ee, function(ae, V) {
            return ae.invoke(V, ee);
          });
        }), de;
      }
      function ir(W, B) {
        var Q = W.static, fe = W.dynamic, de = {};
        return Object.keys(Q).forEach(function(re) {
          var ee = Q[re], ae = z.id(re), V = new ce();
          if (nd(ee))
            V.state = Vu, V.buffer = Ie.getBuffer(
              Ie.create(ee, Hu, !1, !0)
            ), V.type = 0;
          else {
            var K = Ie.getBuffer(ee);
            if (K)
              V.state = Vu, V.buffer = K, V.type = 0;
            else if (N.command(
              typeof ee == "object" && ee,
              "invalid data for attribute " + re,
              B.commandStr
            ), "constant" in ee) {
              var j = ee.constant;
              V.buffer = "null", V.state = a0, typeof j == "number" ? V.x = j : (N.command(
                Yr(j) && j.length > 0 && j.length <= 4,
                "invalid constant for attribute " + re,
                B.commandStr
              ), Wu.forEach(function(Mt, Qt) {
                Qt < j.length && (V[Mt] = j[Qt]);
              }));
            } else {
              nd(ee.buffer) ? K = Ie.getBuffer(
                Ie.create(ee.buffer, Hu, !1, !0)
              ) : K = Ie.getBuffer(ee.buffer), N.command(!!K, 'missing buffer for attribute "' + re + '"', B.commandStr);
              var ue = ee.offset | 0;
              N.command(
                ue >= 0,
                'invalid offset for attribute "' + re + '"',
                B.commandStr
              );
              var ve = ee.stride | 0;
              N.command(
                ve >= 0 && ve < 256,
                'invalid stride for attribute "' + re + '", must be integer betweeen [0, 255]',
                B.commandStr
              );
              var Te = ee.size | 0;
              N.command(
                !("size" in ee) || Te > 0 && Te <= 4,
                'invalid size for attribute "' + re + '", must be 1,2,3,4',
                B.commandStr
              );
              var Pe = !!ee.normalized, we = 0;
              "type" in ee && (N.commandParameter(
                ee.type,
                As,
                "invalid type for attribute " + re,
                B.commandStr
              ), we = As[ee.type]);
              var He = ee.divisor | 0;
              "divisor" in ee && (N.command(
                He === 0 || qe,
                'cannot specify divisor for attribute "' + re + '", instancing not supported',
                B.commandStr
              ), N.command(
                He >= 0,
                'invalid divisor for attribute "' + re + '"',
                B.commandStr
              )), N.optional(function() {
                var Mt = B.commandStr, Qt = [
                  "buffer",
                  "offset",
                  "divisor",
                  "normalized",
                  "type",
                  "size",
                  "stride"
                ];
                Object.keys(ee).forEach(function(xt) {
                  N.command(
                    Qt.indexOf(xt) >= 0,
                    'unknown parameter "' + xt + '" for attribute pointer "' + re + '" (valid parameters are ' + Qt + ")",
                    Mt
                  );
                });
              }), V.buffer = K, V.state = Vu, V.size = Te, V.normalized = Pe, V.type = we || K.dtype, V.offset = ue, V.stride = ve, V.divisor = He;
            }
          }
          de[re] = Qr(function(Mt, Qt) {
            var xt = Mt.attribCache;
            if (ae in xt)
              return xt[ae];
            var Rt = {
              isStream: !1
            };
            return Object.keys(V).forEach(function(Yt) {
              Rt[Yt] = V[Yt];
            }), V.buffer && (Rt.buffer = Mt.link(V.buffer), Rt.type = Rt.type || Rt.buffer + ".dtype"), xt[ae] = Rt, Rt;
          });
        }), Object.keys(fe).forEach(function(re) {
          var ee = fe[re];
          function ae(V, K) {
            var j = V.invoke(K, ee), ue = V.shared, ve = V.constants, Te = ue.isBufferArgs, Pe = ue.buffer;
            N.optional(function() {
              V.assert(
                K,
                j + "&&(typeof " + j + '==="object"||typeof ' + j + '==="function")&&(' + Te + "(" + j + ")||" + Pe + ".getBuffer(" + j + ")||" + Pe + ".getBuffer(" + j + ".buffer)||" + Te + "(" + j + '.buffer)||("constant" in ' + j + "&&(typeof " + j + '.constant==="number"||' + ue.isArrayLike + "(" + j + ".constant))))",
                'invalid dynamic attribute "' + re + '"'
              );
            });
            var we = {
              isStream: K.def(!1)
            }, He = new ce();
            He.state = Vu, Object.keys(He).forEach(function(Rt) {
              we[Rt] = K.def("" + He[Rt]);
            });
            var Mt = we.buffer, Qt = we.type;
            K(
              "if(",
              Te,
              "(",
              j,
              ")){",
              we.isStream,
              "=true;",
              Mt,
              "=",
              Pe,
              ".createStream(",
              Hu,
              ",",
              j,
              ");",
              Qt,
              "=",
              Mt,
              ".dtype;",
              "}else{",
              Mt,
              "=",
              Pe,
              ".getBuffer(",
              j,
              ");",
              "if(",
              Mt,
              "){",
              Qt,
              "=",
              Mt,
              ".dtype;",
              '}else if("constant" in ',
              j,
              "){",
              we.state,
              "=",
              a0,
              ";",
              "if(typeof " + j + '.constant === "number"){',
              we[Wu[0]],
              "=",
              j,
              ".constant;",
              Wu.slice(1).map(function(Rt) {
                return we[Rt];
              }).join("="),
              "=0;",
              "}else{",
              Wu.map(function(Rt, Yt) {
                return we[Rt] + "=" + j + ".constant.length>" + Yt + "?" + j + ".constant[" + Yt + "]:0;";
              }).join(""),
              "}}else{",
              "if(",
              Te,
              "(",
              j,
              ".buffer)){",
              Mt,
              "=",
              Pe,
              ".createStream(",
              Hu,
              ",",
              j,
              ".buffer);",
              "}else{",
              Mt,
              "=",
              Pe,
              ".getBuffer(",
              j,
              ".buffer);",
              "}",
              Qt,
              '="type" in ',
              j,
              "?",
              ve.glTypes,
              "[",
              j,
              ".type]:",
              Mt,
              ".dtype;",
              we.normalized,
              "=!!",
              j,
              ".normalized;"
            );
            function xt(Rt) {
              K(we[Rt], "=", j, ".", Rt, "|0;");
            }
            return xt("size"), xt("offset"), xt("stride"), xt("divisor"), K("}}"), K.exit(
              "if(",
              we.isStream,
              "){",
              Pe,
              ".destroyStream(",
              Mt,
              ");",
              "}"
            ), we;
          }
          de[re] = ri(ee, ae);
        }), de;
      }
      function sn(W, B) {
        var Q = W.static, fe = W.dynamic;
        if (ml in Q) {
          var de = Q[ml];
          return de !== null && Ze.getVAO(de) === null && (de = Ze.createVAO(de)), Qr(function(ee) {
            return ee.link(Ze.getVAO(de));
          });
        } else if (ml in fe) {
          var re = fe[ml];
          return ri(re, function(ee, ae) {
            var V = ee.invoke(ae, re);
            return ae.def(ee.shared.vao + ".getVAO(" + V + ")");
          });
        }
        return null;
      }
      function Pr(W) {
        var B = W.static, Q = W.dynamic, fe = {};
        return Object.keys(B).forEach(function(de) {
          var re = B[de];
          fe[de] = Qr(function(ee, ae) {
            return typeof re == "number" || typeof re == "boolean" ? "" + re : ee.link(re);
          });
        }), Object.keys(Q).forEach(function(de) {
          var re = Q[de];
          fe[de] = ri(re, function(ee, ae) {
            return ee.invoke(ae, re);
          });
        }), fe;
      }
      function en(W, B, Q, fe, de) {
        var re = W.static, ee = W.dynamic;
        N.optional(function() {
          var xt = [
            ks,
            gl,
            yl,
            Ls,
            Ns,
            Xh,
            Rs,
            Yh,
            pl,
            ml
          ].concat(Be);
          function Rt(Yt) {
            Object.keys(Yt).forEach(function(yr) {
              N.command(
                xt.indexOf(yr) >= 0,
                'unknown parameter "' + yr + '"',
                de.commandStr
              );
            });
          }
          Rt(re), Rt(ee);
        });
        var ae = Xt(W, B), V = bt(W), K = er(W, V, de), j = gr(W, de), ue = Jr(W, de), ve = Jt(W, de, ae);
        function Te(xt) {
          var Rt = K[xt];
          Rt && (ue[xt] = Rt);
        }
        Te(eo), Te(it(Vh));
        var Pe = Object.keys(ue).length > 0, we = {
          framebuffer: V,
          draw: j,
          shader: ve,
          state: ue,
          dirty: Pe,
          scopeVAO: null,
          drawVAO: null,
          useVAO: !1,
          attributes: {}
        };
        if (we.profile = qt(W), we.uniforms = vn(Q, de), we.drawVAO = we.scopeVAO = sn(W), !we.drawVAO && ve.program && !ae && H.angle_instanced_arrays) {
          var He = !0, Mt = ve.program.attributes.map(function(xt) {
            var Rt = B.static[xt];
            return He = He && !!Rt, Rt;
          });
          if (He && Mt.length > 0) {
            var Qt = Ze.getVAO(Ze.createVAO(Mt));
            we.drawVAO = new qn(null, null, null, function(xt, Rt) {
              return xt.link(Qt);
            }), we.useVAO = !0;
          }
        }
        return ae ? we.useVAO = !0 : we.attributes = ir(B, de), we.context = Pr(fe), we;
      }
      function un(W, B, Q) {
        var fe = W.shared, de = fe.context, re = W.scope();
        Object.keys(Q).forEach(function(ee) {
          B.save(de, "." + ee);
          var ae = Q[ee], V = ae.append(W, B);
          Array.isArray(V) ? re(de, ".", ee, "=[", V.join(), "];") : re(de, ".", ee, "=", V, ";");
        }), B(re);
      }
      function fn(W, B, Q, fe) {
        var de = W.shared, re = de.gl, ee = de.framebuffer, ae;
        ht && (ae = B.def(de.extensions, ".webgl_draw_buffers"));
        var V = W.constants, K = V.drawBuffer, j = V.backBuffer, ue;
        Q ? ue = Q.append(W, B) : ue = B.def(ee, ".next"), fe || B("if(", ue, "!==", ee, ".cur){"), B(
          "if(",
          ue,
          "){",
          re,
          ".bindFramebuffer(",
          $w,
          ",",
          ue,
          ".framebuffer);"
        ), ht && B(
          ae,
          ".drawBuffersWEBGL(",
          K,
          "[",
          ue,
          ".colorAttachments.length]);"
        ), B(
          "}else{",
          re,
          ".bindFramebuffer(",
          $w,
          ",null);"
        ), ht && B(ae, ".drawBuffersWEBGL(", j, ");"), B(
          "}",
          ee,
          ".cur=",
          ue,
          ";"
        ), fe || B("}");
      }
      function xn(W, B, Q) {
        var fe = W.shared, de = fe.gl, re = W.current, ee = W.next, ae = fe.current, V = fe.next, K = W.cond(ae, ".dirty");
        Be.forEach(function(j) {
          var ue = it(j);
          if (!(ue in Q.state)) {
            var ve, Te;
            if (ue in ee) {
              ve = ee[ue], Te = re[ue];
              var Pe = dn(Ne[ue].length, function(He) {
                return K.def(ve, "[", He, "]");
              });
              K(W.cond(Pe.map(function(He, Mt) {
                return He + "!==" + Te + "[" + Mt + "]";
              }).join("||")).then(
                de,
                ".",
                Re[ue],
                "(",
                Pe,
                ");",
                Pe.map(function(He, Mt) {
                  return Te + "[" + Mt + "]=" + He;
                }).join(";"),
                ";"
              ));
            } else {
              ve = K.def(V, ".", ue);
              var we = W.cond(ve, "!==", ae, ".", ue);
              K(we), ue in nt ? we(
                W.cond(ve).then(de, ".enable(", nt[ue], ");").else(de, ".disable(", nt[ue], ");"),
                ae,
                ".",
                ue,
                "=",
                ve,
                ";"
              ) : we(
                de,
                ".",
                Re[ue],
                "(",
                ve,
                ");",
                ae,
                ".",
                ue,
                "=",
                ve,
                ";"
              );
            }
          }
        }), Object.keys(Q.state).length === 0 && K(ae, ".dirty=false;"), B(K);
      }
      function An(W, B, Q, fe) {
        var de = W.shared, re = W.current, ee = de.current, ae = de.gl;
        Xw(Object.keys(Q)).forEach(function(V) {
          var K = Q[V];
          if (!(fe && !fe(K))) {
            var j = K.append(W, B);
            if (nt[V]) {
              var ue = nt[V];
              zo(K) ? j ? B(ae, ".enable(", ue, ");") : B(ae, ".disable(", ue, ");") : B(W.cond(j).then(ae, ".enable(", ue, ");").else(ae, ".disable(", ue, ");")), B(ee, ".", V, "=", j, ";");
            } else if (Yr(j)) {
              var ve = re[V];
              B(
                ae,
                ".",
                Re[V],
                "(",
                j,
                ");",
                j.map(function(Te, Pe) {
                  return ve + "[" + Pe + "]=" + Te;
                }).join(";"),
                ";"
              );
            } else
              B(
                ae,
                ".",
                Re[V],
                "(",
                j,
                ");",
                ee,
                ".",
                V,
                "=",
                j,
                ";"
              );
          }
        });
      }
      function Hr(W, B) {
        qe && (W.instancing = B.def(
          W.shared.extensions,
          ".angle_instanced_arrays"
        ));
      }
      function Zt(W, B, Q, fe, de) {
        var re = W.shared, ee = W.stats, ae = re.current, V = re.timer, K = Q.profile;
        function j() {
          return typeof performance > "u" ? "Date.now()" : "performance.now()";
        }
        var ue, ve;
        function Te(xt) {
          ue = B.def(), xt(ue, "=", j(), ";"), typeof de == "string" ? xt(ee, ".count+=", de, ";") : xt(ee, ".count++;"), Ue && (fe ? (ve = B.def(), xt(ve, "=", V, ".getNumPendingQueries();")) : xt(V, ".beginQuery(", ee, ");"));
        }
        function Pe(xt) {
          xt(ee, ".cpuTime+=", j(), "-", ue, ";"), Ue && (fe ? xt(
            V,
            ".pushScopeStats(",
            ve,
            ",",
            V,
            ".getNumPendingQueries(),",
            ee,
            ");"
          ) : xt(V, ".endQuery();"));
        }
        function we(xt) {
          var Rt = B.def(ae, ".profile");
          B(ae, ".profile=", xt, ";"), B.exit(ae, ".profile=", Rt, ";");
        }
        var He;
        if (K) {
          if (zo(K)) {
            K.enable ? (Te(B), Pe(B.exit), we("true")) : we("false");
            return;
          }
          He = K.append(W, B), we(He);
        } else
          He = B.def(ae, ".profile");
        var Mt = W.block();
        Te(Mt), B("if(", He, "){", Mt, "}");
        var Qt = W.block();
        Pe(Qt), B.exit("if(", He, "){", Qt, "}");
      }
      function In(W, B, Q, fe, de) {
        var re = W.shared;
        function ee(V) {
          switch (V) {
            case Hh:
            case Zh:
            case ed:
              return 2;
            case Kh:
            case Qh:
            case td:
              return 3;
            case qh:
            case Jh:
            case rd:
              return 4;
            default:
              return 1;
          }
        }
        function ae(V, K, j) {
          var ue = re.gl, ve = B.def(V, ".location"), Te = B.def(re.attributes, "[", ve, "]"), Pe = j.state, we = j.buffer, He = [
            j.x,
            j.y,
            j.z,
            j.w
          ], Mt = [
            "buffer",
            "normalized",
            "offset",
            "stride"
          ];
          function Qt() {
            B(
              "if(!",
              Te,
              ".buffer){",
              ue,
              ".enableVertexAttribArray(",
              ve,
              ");}"
            );
            var Rt = j.type, Yt;
            if (j.size ? Yt = B.def(j.size, "||", K) : Yt = K, B(
              "if(",
              Te,
              ".type!==",
              Rt,
              "||",
              Te,
              ".size!==",
              Yt,
              "||",
              Mt.map(function($r) {
                return Te + "." + $r + "!==" + j[$r];
              }).join("||"),
              "){",
              ue,
              ".bindBuffer(",
              Hu,
              ",",
              we,
              ".buffer);",
              ue,
              ".vertexAttribPointer(",
              [
                ve,
                Yt,
                Rt,
                j.normalized,
                j.stride,
                j.offset
              ],
              ");",
              Te,
              ".type=",
              Rt,
              ";",
              Te,
              ".size=",
              Yt,
              ";",
              Mt.map(function($r) {
                return Te + "." + $r + "=" + j[$r] + ";";
              }).join(""),
              "}"
            ), qe) {
              var yr = j.divisor;
              B(
                "if(",
                Te,
                ".divisor!==",
                yr,
                "){",
                W.instancing,
                ".vertexAttribDivisorANGLE(",
                [ve, yr],
                ");",
                Te,
                ".divisor=",
                yr,
                ";}"
              );
            }
          }
          function xt() {
            B(
              "if(",
              Te,
              ".buffer){",
              ue,
              ".disableVertexAttribArray(",
              ve,
              ");",
              Te,
              ".buffer=null;",
              "}if(",
              Wu.map(function(Rt, Yt) {
                return Te + "." + Rt + "!==" + He[Yt];
              }).join("||"),
              "){",
              ue,
              ".vertexAttrib4f(",
              ve,
              ",",
              He,
              ");",
              Wu.map(function(Rt, Yt) {
                return Te + "." + Rt + "=" + He[Yt] + ";";
              }).join(""),
              "}"
            );
          }
          Pe === Vu ? Qt() : Pe === a0 ? xt() : (B("if(", Pe, "===", Vu, "){"), Qt(), B("}else{"), xt(), B("}"));
        }
        fe.forEach(function(V) {
          var K = V.name, j = Q.attributes[K], ue;
          if (j) {
            if (!de(j))
              return;
            ue = j.append(W, B);
          } else {
            if (!de(Yw))
              return;
            var ve = W.scopeAttrib(K);
            N.optional(function() {
              W.assert(
                B,
                ve + ".state",
                "missing attribute " + K
              );
            }), ue = {}, Object.keys(new ce()).forEach(function(Te) {
              ue[Te] = B.def(ve, ".", Te);
            });
          }
          ae(
            W.link(V),
            ee(V.info.type),
            ue
          );
        });
      }
      function wr(W, B, Q, fe, de) {
        for (var re = W.shared, ee = re.gl, ae, V = 0; V < fe.length; ++V) {
          var K = fe[V], j = K.name, ue = K.info.type, ve = Q.uniforms[j], Te = W.link(K), Pe = Te + ".location", we;
          if (ve) {
            if (!de(ve))
              continue;
            if (zo(ve)) {
              var He = ve.value;
              if (N.command(
                He !== null && typeof He < "u",
                'missing uniform "' + j + '"',
                W.commandStr
              ), ue === wl || ue === El) {
                N.command(
                  typeof He == "function" && (ue === wl && (He._reglType === "texture2d" || He._reglType === "framebuffer") || ue === El && (He._reglType === "textureCube" || He._reglType === "framebufferCube")),
                  "invalid texture for uniform " + j,
                  W.commandStr
                );
                var Mt = W.link(He._texture || He.color[0]._texture);
                B(ee, ".uniform1i(", Pe, ",", Mt + ".bind());"), B.exit(Mt, ".unbind();");
              } else if (ue === bl || ue === xl || ue === _l) {
                N.optional(function() {
                  N.command(
                    Yr(He),
                    "invalid matrix for uniform " + j,
                    W.commandStr
                  ), N.command(
                    ue === bl && He.length === 4 || ue === xl && He.length === 9 || ue === _l && He.length === 16,
                    "invalid length for matrix uniform " + j,
                    W.commandStr
                  );
                });
                var Qt = W.global.def("new Float32Array([" + Array.prototype.slice.call(He) + "])"), xt = 2;
                ue === xl ? xt = 3 : ue === _l && (xt = 4), B(
                  ee,
                  ".uniformMatrix",
                  xt,
                  "fv(",
                  Pe,
                  ",false,",
                  Qt,
                  ");"
                );
              } else {
                switch (ue) {
                  case _0:
                    N.commandType(He, "number", "uniform " + j, W.commandStr), ae = "1f";
                    break;
                  case Hh:
                    N.command(
                      Yr(He) && He.length === 2,
                      "uniform " + j,
                      W.commandStr
                    ), ae = "2f";
                    break;
                  case Kh:
                    N.command(
                      Yr(He) && He.length === 3,
                      "uniform " + j,
                      W.commandStr
                    ), ae = "3f";
                    break;
                  case qh:
                    N.command(
                      Yr(He) && He.length === 4,
                      "uniform " + j,
                      W.commandStr
                    ), ae = "4f";
                    break;
                  case E0:
                    N.commandType(He, "boolean", "uniform " + j, W.commandStr), ae = "1i";
                    break;
                  case w0:
                    N.commandType(He, "number", "uniform " + j, W.commandStr), ae = "1i";
                    break;
                  case ed:
                    N.command(
                      Yr(He) && He.length === 2,
                      "uniform " + j,
                      W.commandStr
                    ), ae = "2i";
                    break;
                  case Zh:
                    N.command(
                      Yr(He) && He.length === 2,
                      "uniform " + j,
                      W.commandStr
                    ), ae = "2i";
                    break;
                  case td:
                    N.command(
                      Yr(He) && He.length === 3,
                      "uniform " + j,
                      W.commandStr
                    ), ae = "3i";
                    break;
                  case Qh:
                    N.command(
                      Yr(He) && He.length === 3,
                      "uniform " + j,
                      W.commandStr
                    ), ae = "3i";
                    break;
                  case rd:
                    N.command(
                      Yr(He) && He.length === 4,
                      "uniform " + j,
                      W.commandStr
                    ), ae = "4i";
                    break;
                  case Jh:
                    N.command(
                      Yr(He) && He.length === 4,
                      "uniform " + j,
                      W.commandStr
                    ), ae = "4i";
                    break;
                }
                B(
                  ee,
                  ".uniform",
                  ae,
                  "(",
                  Pe,
                  ",",
                  Yr(He) ? Array.prototype.slice.call(He) : He,
                  ");"
                );
              }
              continue;
            } else
              we = ve.append(W, B);
          } else {
            if (!de(Yw))
              continue;
            we = B.def(re.uniforms, "[", z.id(j), "]");
          }
          ue === wl ? (N(!Array.isArray(we), "must specify a scalar prop for textures"), B(
            "if(",
            we,
            "&&",
            we,
            '._reglType==="framebuffer"){',
            we,
            "=",
            we,
            ".color[0];",
            "}"
          )) : ue === El && (N(!Array.isArray(we), "must specify a scalar prop for cube maps"), B(
            "if(",
            we,
            "&&",
            we,
            '._reglType==="framebufferCube"){',
            we,
            "=",
            we,
            ".color[0];",
            "}"
          )), N.optional(function() {
            function Zn(Ki, eE) {
              W.assert(
                B,
                Ki,
                'bad data or missing for uniform "' + j + '".  ' + eE
              );
            }
            function C0(Ki) {
              N(!Array.isArray(we), "must not specify an array type for uniform"), Zn(
                "typeof " + we + '==="' + Ki + '"',
                "invalid type, expected " + Ki
              );
            }
            function Ti(Ki, eE) {
              Array.isArray(we) ? N(we.length === Ki, "must have length " + Ki) : Zn(
                re.isArrayLike + "(" + we + ")&&" + we + ".length===" + Ki,
                "invalid vector, should have length " + Ki,
                W.commandStr
              );
            }
            function Jw(Ki) {
              N(!Array.isArray(we), "must not specify a value type"), Zn(
                "typeof " + we + '==="function"&&' + we + '._reglType==="texture' + (Ki === Bw ? "2d" : "Cube") + '"',
                "invalid texture type",
                W.commandStr
              );
            }
            switch (ue) {
              case w0:
                C0("number");
                break;
              case Zh:
                Ti(2);
                break;
              case Qh:
                Ti(3);
                break;
              case Jh:
                Ti(4);
                break;
              case _0:
                C0("number");
                break;
              case Hh:
                Ti(2);
                break;
              case Kh:
                Ti(3);
                break;
              case qh:
                Ti(4);
                break;
              case E0:
                C0("boolean");
                break;
              case ed:
                Ti(2);
                break;
              case td:
                Ti(3);
                break;
              case rd:
                Ti(4);
                break;
              case bl:
                Ti(4);
                break;
              case xl:
                Ti(9);
                break;
              case _l:
                Ti(16);
                break;
              case wl:
                Jw(Bw);
                break;
              case El:
                Jw(LF);
                break;
            }
          });
          var Rt = 1;
          switch (ue) {
            case wl:
            case El:
              var Yt = B.def(we, "._texture");
              B(ee, ".uniform1i(", Pe, ",", Yt, ".bind());"), B.exit(Yt, ".unbind();");
              continue;
            case w0:
            case E0:
              ae = "1i";
              break;
            case Zh:
            case ed:
              ae = "2i", Rt = 2;
              break;
            case Qh:
            case td:
              ae = "3i", Rt = 3;
              break;
            case Jh:
            case rd:
              ae = "4i", Rt = 4;
              break;
            case _0:
              ae = "1f";
              break;
            case Hh:
              ae = "2f", Rt = 2;
              break;
            case Kh:
              ae = "3f", Rt = 3;
              break;
            case qh:
              ae = "4f", Rt = 4;
              break;
            case bl:
              ae = "Matrix2fv";
              break;
            case xl:
              ae = "Matrix3fv";
              break;
            case _l:
              ae = "Matrix4fv";
              break;
          }
          if (B(ee, ".uniform", ae, "(", Pe, ","), ae.charAt(0) === "M") {
            var yr = Math.pow(ue - bl + 2, 2), $r = W.global.def("new Float32Array(", yr, ")");
            Array.isArray(we) ? B(
              "false,(",
              dn(yr, function(Zn) {
                return $r + "[" + Zn + "]=" + we[Zn];
              }),
              ",",
              $r,
              ")"
            ) : B(
              "false,(Array.isArray(",
              we,
              ")||",
              we,
              " instanceof Float32Array)?",
              we,
              ":(",
              dn(yr, function(Zn) {
                return $r + "[" + Zn + "]=" + we + "[" + Zn + "]";
              }),
              ",",
              $r,
              ")"
            );
          } else
            Rt > 1 ? B(dn(Rt, function(Zn) {
              return Array.isArray(we) ? we[Zn] : we + "[" + Zn + "]";
            })) : (N(!Array.isArray(we), "uniform value must not be an array"), B(we));
          B(");");
        }
      }
      function Nt(W, B, Q, fe) {
        var de = W.shared, re = de.gl, ee = de.draw, ae = fe.draw;
        function V() {
          var Yt = ae.elements, yr, $r = B;
          return Yt ? ((Yt.contextDep && fe.contextDynamic || Yt.propDep) && ($r = Q), yr = Yt.append(W, $r)) : yr = $r.def(ee, ".", Ls), yr && $r(
            "if(" + yr + ")" + re + ".bindBuffer(" + OF + "," + yr + ".buffer.buffer);"
          ), yr;
        }
        function K() {
          var Yt = ae.count, yr, $r = B;
          return Yt ? ((Yt.contextDep && fe.contextDynamic || Yt.propDep) && ($r = Q), yr = Yt.append(W, $r), N.optional(function() {
            Yt.MISSING && W.assert(B, "false", "missing vertex count"), Yt.DYNAMIC && W.assert($r, yr + ">=0", "missing vertex count");
          })) : (yr = $r.def(ee, ".", Rs), N.optional(function() {
            W.assert($r, yr + ">=0", "missing vertex count");
          })), yr;
        }
        var j = V();
        function ue(Yt) {
          var yr = ae[Yt];
          return yr ? yr.contextDep && fe.contextDynamic || yr.propDep ? yr.append(W, Q) : yr.append(W, B) : B.def(ee, ".", Yt);
        }
        var ve = ue(Ns), Te = ue(Xh), Pe = K();
        if (typeof Pe == "number") {
          if (Pe === 0)
            return;
        } else
          Q("if(", Pe, "){"), Q.exit("}");
        var we, He;
        qe && (we = ue(Yh), He = W.instancing);
        var Mt = j + ".type", Qt = ae.elements && zo(ae.elements);
        function xt() {
          function Yt() {
            Q(He, ".drawElementsInstancedANGLE(", [
              ve,
              Pe,
              Mt,
              Te + "<<((" + Mt + "-" + gw + ")>>1)",
              we
            ], ");");
          }
          function yr() {
            Q(
              He,
              ".drawArraysInstancedANGLE(",
              [ve, Te, Pe, we],
              ");"
            );
          }
          j ? Qt ? Yt() : (Q("if(", j, "){"), Yt(), Q("}else{"), yr(), Q("}")) : yr();
        }
        function Rt() {
          function Yt() {
            Q(re + ".drawElements(" + [
              ve,
              Pe,
              Mt,
              Te + "<<((" + Mt + "-" + gw + ")>>1)"
            ] + ");");
          }
          function yr() {
            Q(re + ".drawArrays(" + [ve, Te, Pe] + ");");
          }
          j ? Qt ? Yt() : (Q("if(", j, "){"), Yt(), Q("}else{"), yr(), Q("}")) : yr();
        }
        qe && (typeof we != "number" || we >= 0) ? typeof we == "string" ? (Q("if(", we, ">0){"), xt(), Q("}else if(", we, "<0){"), Rt(), Q("}")) : xt() : Rt();
      }
      function nr(W, B, Q, fe, de) {
        var re = jt(), ee = re.proc("body", de);
        return N.optional(function() {
          re.commandStr = B.commandStr, re.command = re.link(B.commandStr);
        }), qe && (re.instancing = ee.def(
          re.shared.extensions,
          ".angle_instanced_arrays"
        )), W(re, ee, Q, fe), re.compile().body;
      }
      function fr(W, B, Q, fe) {
        Hr(W, B), Q.useVAO ? Q.drawVAO ? B(W.shared.vao, ".setVAO(", Q.drawVAO.append(W, B), ");") : B(W.shared.vao, ".setVAO(", W.shared.vao, ".targetVAO);") : (B(W.shared.vao, ".setVAO(null);"), In(W, B, Q, fe.attributes, function() {
          return !0;
        })), wr(W, B, Q, fe.uniforms, function() {
          return !0;
        }), Nt(W, B, B, Q);
      }
      function Kr(W, B) {
        var Q = W.proc("draw", 1);
        Hr(W, Q), un(W, Q, B.context), fn(W, Q, B.framebuffer), xn(W, Q, B), An(W, Q, B.state), Zt(W, Q, B, !1, !0);
        var fe = B.shader.progVar.append(W, Q);
        if (Q(W.shared.gl, ".useProgram(", fe, ".program);"), B.shader.program)
          fr(W, Q, B, B.shader.program);
        else {
          Q(W.shared.vao, ".setVAO(null);");
          var de = W.global.def("{}"), re = Q.def(fe, ".id"), ee = Q.def(de, "[", re, "]");
          Q(
            W.cond(ee).then(ee, ".call(this,a0);").else(
              ee,
              "=",
              de,
              "[",
              re,
              "]=",
              W.link(function(ae) {
                return nr(fr, W, B, ae, 1);
              }),
              "(",
              fe,
              ");",
              ee,
              ".call(this,a0);"
            )
          );
        }
        Object.keys(B.state).length > 0 && Q(W.shared.current, ".dirty=true;");
      }
      function da(W, B, Q, fe) {
        W.batchId = "a1", Hr(W, B);
        function de() {
          return !0;
        }
        In(W, B, Q, fe.attributes, de), wr(W, B, Q, fe.uniforms, de), Nt(W, B, B, Q);
      }
      function Gs(W, B, Q, fe) {
        Hr(W, B);
        var de = Q.contextDep, re = B.def(), ee = "a0", ae = "a1", V = B.def();
        W.shared.props = V, W.batchId = re;
        var K = W.scope(), j = W.scope();
        B(
          K.entry,
          "for(",
          re,
          "=0;",
          re,
          "<",
          ae,
          ";++",
          re,
          "){",
          V,
          "=",
          ee,
          "[",
          re,
          "];",
          j,
          "}",
          K.exit
        );
        function ue(Mt) {
          return Mt.contextDep && de || Mt.propDep;
        }
        function ve(Mt) {
          return !ue(Mt);
        }
        if (Q.needsContext && un(W, j, Q.context), Q.needsFramebuffer && fn(W, j, Q.framebuffer), An(W, j, Q.state, ue), Q.profile && ue(Q.profile) && Zt(W, j, Q, !1, !0), fe)
          Q.useVAO ? Q.drawVAO ? ue(Q.drawVAO) ? j(W.shared.vao, ".setVAO(", Q.drawVAO.append(W, j), ");") : K(W.shared.vao, ".setVAO(", Q.drawVAO.append(W, K), ");") : K(W.shared.vao, ".setVAO(", W.shared.vao, ".targetVAO);") : (K(W.shared.vao, ".setVAO(null);"), In(W, K, Q, fe.attributes, ve), In(W, j, Q, fe.attributes, ue)), wr(W, K, Q, fe.uniforms, ve), wr(W, j, Q, fe.uniforms, ue), Nt(W, K, j, Q);
        else {
          var Te = W.global.def("{}"), Pe = Q.shader.progVar.append(W, j), we = j.def(Pe, ".id"), He = j.def(Te, "[", we, "]");
          j(
            W.shared.gl,
            ".useProgram(",
            Pe,
            ".program);",
            "if(!",
            He,
            "){",
            He,
            "=",
            Te,
            "[",
            we,
            "]=",
            W.link(function(Mt) {
              return nr(
                da,
                W,
                Q,
                Mt,
                2
              );
            }),
            "(",
            Pe,
            ");}",
            He,
            ".call(this,a0[",
            re,
            "],",
            re,
            ");"
          );
        }
      }
      function Y(W, B) {
        var Q = W.proc("batch", 2);
        W.batchId = "0", Hr(W, Q);
        var fe = !1, de = !0;
        Object.keys(B.context).forEach(function(Te) {
          fe = fe || B.context[Te].propDep;
        }), fe || (un(W, Q, B.context), de = !1);
        var re = B.framebuffer, ee = !1;
        re ? (re.propDep ? fe = ee = !0 : re.contextDep && fe && (ee = !0), ee || fn(W, Q, re)) : fn(W, Q, null), B.state.viewport && B.state.viewport.propDep && (fe = !0);
        function ae(Te) {
          return Te.contextDep && fe || Te.propDep;
        }
        xn(W, Q, B), An(W, Q, B.state, function(Te) {
          return !ae(Te);
        }), (!B.profile || !ae(B.profile)) && Zt(W, Q, B, !1, "a1"), B.contextDep = fe, B.needsContext = de, B.needsFramebuffer = ee;
        var V = B.shader.progVar;
        if (V.contextDep && fe || V.propDep)
          Gs(
            W,
            Q,
            B,
            null
          );
        else {
          var K = V.append(W, Q);
          if (Q(W.shared.gl, ".useProgram(", K, ".program);"), B.shader.program)
            Gs(
              W,
              Q,
              B,
              B.shader.program
            );
          else {
            Q(W.shared.vao, ".setVAO(null);");
            var j = W.global.def("{}"), ue = Q.def(K, ".id"), ve = Q.def(j, "[", ue, "]");
            Q(
              W.cond(ve).then(ve, ".call(this,a0,a1);").else(
                ve,
                "=",
                j,
                "[",
                ue,
                "]=",
                W.link(function(Te) {
                  return nr(Gs, W, B, Te, 2);
                }),
                "(",
                K,
                ");",
                ve,
                ".call(this,a0,a1);"
              )
            );
          }
        }
        Object.keys(B.state).length > 0 && Q(W.shared.current, ".dirty=true;");
      }
      function be(W, B) {
        var Q = W.proc("scope", 3);
        W.batchId = "a2";
        var fe = W.shared, de = fe.current;
        un(W, Q, B.context), B.framebuffer && B.framebuffer.append(W, Q), Xw(Object.keys(B.state)).forEach(function(ee) {
          var ae = B.state[ee], V = ae.append(W, Q);
          Yr(V) ? V.forEach(function(K, j) {
            Q.set(W.next[ee], "[" + j + "]", K);
          }) : Q.set(fe.next, "." + ee, V);
        }), Zt(W, Q, B, !0, !0), [Ls, Xh, Rs, Yh, Ns].forEach(
          function(ee) {
            var ae = B.draw[ee];
            !ae || Q.set(fe.draw, "." + ee, "" + ae.append(W, Q));
          }
        ), Object.keys(B.uniforms).forEach(function(ee) {
          var ae = B.uniforms[ee].append(W, Q);
          Array.isArray(ae) && (ae = "[" + ae.join() + "]"), Q.set(
            fe.uniforms,
            "[" + z.id(ee) + "]",
            ae
          );
        }), Object.keys(B.attributes).forEach(function(ee) {
          var ae = B.attributes[ee].append(W, Q), V = W.scopeAttrib(ee);
          Object.keys(new ce()).forEach(function(K) {
            Q.set(V, "." + K, ae[K]);
          });
        }), B.scopeVAO && Q.set(fe.vao, ".targetVAO", B.scopeVAO.append(W, Q));
        function re(ee) {
          var ae = B.shader[ee];
          ae && Q.set(fe.shader, "." + ee, ae.append(W, Q));
        }
        re(gl), re(yl), Object.keys(B.state).length > 0 && (Q(de, ".dirty=true;"), Q.exit(de, ".dirty=true;")), Q("a1(", W.shared.context, ",a0,", W.batchId, ");");
      }
      function ge(W) {
        if (!(typeof W != "object" || Yr(W))) {
          for (var B = Object.keys(W), Q = 0; Q < B.length; ++Q)
            if (pr.isDynamic(W[B[Q]]))
              return !0;
          return !1;
        }
      }
      function yt(W, B, Q) {
        var fe = B.static[Q];
        if (!fe || !ge(fe))
          return;
        var de = W.global, re = Object.keys(fe), ee = !1, ae = !1, V = !1, K = W.global.def("{}");
        re.forEach(function(ue) {
          var ve = fe[ue];
          if (pr.isDynamic(ve)) {
            typeof ve == "function" && (ve = fe[ue] = pr.unbox(ve));
            var Te = ri(ve, null);
            ee = ee || Te.thisDep, V = V || Te.propDep, ae = ae || Te.contextDep;
          } else {
            switch (de(K, ".", ue, "="), typeof ve) {
              case "number":
                de(ve);
                break;
              case "string":
                de('"', ve, '"');
                break;
              case "object":
                Array.isArray(ve) && de("[", ve.join(), "]");
                break;
              default:
                de(W.link(ve));
                break;
            }
            de(";");
          }
        });
        function j(ue, ve) {
          re.forEach(function(Te) {
            var Pe = fe[Te];
            if (!!pr.isDynamic(Pe)) {
              var we = ue.invoke(ve, Pe);
              ve(K, ".", Te, "=", we, ";");
            }
          });
        }
        B.dynamic[Q] = new pr.DynamicVariable(Wh, {
          thisDep: ee,
          contextDep: ae,
          propDep: V,
          ref: K,
          append: j
        }), delete B.static[Q];
      }
      function tr(W, B, Q, fe, de) {
        var re = jt();
        re.stats = re.link(de), Object.keys(B.static).forEach(function(ae) {
          yt(re, B, ae);
        }), PF.forEach(function(ae) {
          yt(re, W, ae);
        });
        var ee = en(W, B, Q, fe, re);
        return Kr(re, ee), be(re, ee), Y(re, ee), n(re.compile(), {
          destroy: function() {
            ee.shader.program.destroy();
          }
        });
      }
      return {
        next: gt,
        current: Ne,
        procs: function() {
          var W = jt(), B = W.proc("poll"), Q = W.proc("refresh"), fe = W.block();
          B(fe), Q(fe);
          var de = W.shared, re = de.gl, ee = de.next, ae = de.current;
          fe(ae, ".dirty=false;"), fn(W, B), fn(W, Q, null, !0);
          var V;
          qe && (V = W.link(qe)), H.oes_vertex_array_object && Q(W.link(H.oes_vertex_array_object), ".bindVertexArrayOES(null);");
          for (var K = 0; K < me.maxAttributes; ++K) {
            var j = Q.def(de.attributes, "[", K, "]"), ue = W.cond(j, ".buffer");
            ue.then(
              re,
              ".enableVertexAttribArray(",
              K,
              ");",
              re,
              ".bindBuffer(",
              Hu,
              ",",
              j,
              ".buffer.buffer);",
              re,
              ".vertexAttribPointer(",
              K,
              ",",
              j,
              ".size,",
              j,
              ".type,",
              j,
              ".normalized,",
              j,
              ".stride,",
              j,
              ".offset);"
            ).else(
              re,
              ".disableVertexAttribArray(",
              K,
              ");",
              re,
              ".vertexAttrib4f(",
              K,
              ",",
              j,
              ".x,",
              j,
              ".y,",
              j,
              ".z,",
              j,
              ".w);",
              j,
              ".buffer=null;"
            ), Q(ue), qe && Q(
              V,
              ".vertexAttribDivisorANGLE(",
              K,
              ",",
              j,
              ".divisor);"
            );
          }
          return Q(
            W.shared.vao,
            ".currentVAO=null;",
            W.shared.vao,
            ".setVAO(",
            W.shared.vao,
            ".targetVAO);"
          ), Object.keys(nt).forEach(function(ve) {
            var Te = nt[ve], Pe = fe.def(ee, ".", ve), we = W.block();
            we(
              "if(",
              Pe,
              "){",
              re,
              ".enable(",
              Te,
              ")}else{",
              re,
              ".disable(",
              Te,
              ")}",
              ae,
              ".",
              ve,
              "=",
              Pe,
              ";"
            ), Q(we), B(
              "if(",
              Pe,
              "!==",
              ae,
              ".",
              ve,
              "){",
              we,
              "}"
            );
          }), Object.keys(Re).forEach(function(ve) {
            var Te = Re[ve], Pe = Ne[ve], we, He, Mt = W.block();
            if (Mt(re, ".", Te, "("), Yr(Pe)) {
              var Qt = Pe.length;
              we = W.global.def(ee, ".", ve), He = W.global.def(ae, ".", ve), Mt(
                dn(Qt, function(xt) {
                  return we + "[" + xt + "]";
                }),
                ");",
                dn(Qt, function(xt) {
                  return He + "[" + xt + "]=" + we + "[" + xt + "];";
                }).join("")
              ), B(
                "if(",
                dn(Qt, function(xt) {
                  return we + "[" + xt + "]!==" + He + "[" + xt + "]";
                }).join("||"),
                "){",
                Mt,
                "}"
              );
            } else
              we = fe.def(ee, ".", ve), He = fe.def(ae, ".", ve), Mt(
                we,
                ");",
                ae,
                ".",
                ve,
                "=",
                we,
                ";"
              ), B(
                "if(",
                we,
                "!==",
                He,
                "){",
                Mt,
                "}"
              );
            Q(Mt);
          }), W.compile();
        }(),
        compile: tr
      };
    }
    function qF() {
      return {
        vaoCount: 0,
        bufferCount: 0,
        elementsCount: 0,
        framebufferCount: 0,
        shaderCount: 0,
        textureCount: 0,
        cubeCount: 0,
        renderbufferCount: 0,
        maxTextureUnits: 0
      };
    }
    var ZF = 34918, QF = 34919, Hw = 35007, JF = function(I, z) {
      if (!z.ext_disjoint_timer_query)
        return null;
      var H = [];
      function me() {
        return H.pop() || z.ext_disjoint_timer_query.createQueryEXT();
      }
      function Ie(qe) {
        H.push(qe);
      }
      var ye = [];
      function xe(qe) {
        var ht = me();
        z.ext_disjoint_timer_query.beginQueryEXT(Hw, ht), ye.push(ht), Ue(ye.length - 1, ye.length, qe);
      }
      function ze() {
        z.ext_disjoint_timer_query.endQueryEXT(Hw);
      }
      function We() {
        this.startQueryIndex = -1, this.endQueryIndex = -1, this.sum = 0, this.stats = null;
      }
      var Ze = [];
      function Ve() {
        return Ze.pop() || new We();
      }
      function tt(qe) {
        Ze.push(qe);
      }
      var ot = [];
      function Ue(qe, ht, Ne) {
        var gt = Ve();
        gt.startQueryIndex = qe, gt.endQueryIndex = ht, gt.sum = 0, gt.stats = Ne, ot.push(gt);
      }
      var rt = [], ce = [];
      function _e() {
        var qe, ht, Ne = ye.length;
        if (Ne !== 0) {
          ce.length = Math.max(ce.length, Ne + 1), rt.length = Math.max(rt.length, Ne + 1), rt[0] = 0, ce[0] = 0;
          var gt = 0;
          for (qe = 0, ht = 0; ht < ye.length; ++ht) {
            var Be = ye[ht];
            z.ext_disjoint_timer_query.getQueryObjectEXT(Be, QF) ? (gt += z.ext_disjoint_timer_query.getQueryObjectEXT(Be, ZF), Ie(Be)) : ye[qe++] = Be, rt[ht + 1] = gt, ce[ht + 1] = qe;
          }
          for (ye.length = qe, qe = 0, ht = 0; ht < ot.length; ++ht) {
            var nt = ot[ht], Re = nt.startQueryIndex, it = nt.endQueryIndex;
            nt.sum += rt[it] - rt[Re];
            var It = ce[Re], Vt = ce[it];
            Vt === It ? (nt.stats.gpuTime += nt.sum / 1e6, tt(nt)) : (nt.startQueryIndex = It, nt.endQueryIndex = Vt, ot[qe++] = nt);
          }
          ot.length = qe;
        }
      }
      return {
        beginQuery: xe,
        endQuery: ze,
        pushScopeStats: Ue,
        update: _e,
        getNumPendingQueries: function() {
          return ye.length;
        },
        clear: function() {
          H.push.apply(H, ye);
          for (var qe = 0; qe < H.length; qe++)
            z.ext_disjoint_timer_query.deleteQueryEXT(H[qe]);
          ye.length = 0, H.length = 0;
        },
        restore: function() {
          ye.length = 0, H.length = 0;
        }
      };
    }, e6 = 16384, t6 = 256, r6 = 1024, n6 = 34962, Kw = "webglcontextlost", qw = "webglcontextrestored", Zw = 1, i6 = 2, a6 = 3;
    function Qw(I, z) {
      for (var H = 0; H < I.length; ++H)
        if (I[H] === z)
          return H;
      return -1;
    }
    function o6(I) {
      var z = Es(I);
      if (!z)
        return null;
      var H = z.gl, me = H.getContextAttributes(), Ie = H.isContextLost(), ye = Ss(H, z);
      if (!ye)
        return null;
      var xe = Cr(), ze = qF(), We = ye.extensions, Ze = JF(H, We), Ve = jr(), tt = H.drawingBufferWidth, ot = H.drawingBufferHeight, Ue = {
        tick: 0,
        time: 0,
        viewportWidth: tt,
        viewportHeight: ot,
        framebufferWidth: tt,
        framebufferHeight: ot,
        drawingBufferWidth: tt,
        drawingBufferHeight: ot,
        pixelRatio: z.pixelRatio
      }, rt = {}, ce = {
        elements: null,
        primitive: 4,
        count: -1,
        offset: 0,
        instances: -1
      }, _e = V4(H, We), qe = sG(
        H,
        ze,
        z,
        Ne
      ), ht = bF(
        H,
        We,
        _e,
        ze,
        qe
      );
      function Ne(Nt) {
        return ht.destroyBuffer(Nt);
      }
      var gt = bG(H, We, qe, ze), Be = EF(H, xe, ze, z), nt = qG(
        H,
        We,
        _e,
        function() {
          It.procs.poll();
        },
        Ue,
        ze,
        z
      ), Re = ZG(H, We, _e, ze, z), it = yF(
        H,
        We,
        _e,
        nt,
        Re,
        ze
      ), It = KF(
        H,
        xe,
        We,
        _e,
        qe,
        gt,
        nt,
        it,
        rt,
        ht,
        Be,
        ce,
        Ue,
        Ze,
        z
      ), Vt = CF(
        H,
        it,
        It.procs.poll,
        Ue,
        me,
        We,
        _e
      ), st = It.next, Je = H.canvas, Le = [], jt = [], qt = [], bt = [z.onDestroy], er = null;
      function Xt() {
        if (Le.length === 0) {
          Ze && Ze.update(), er = null;
          return;
        }
        er = _r.next(Xt), An();
        for (var Nt = Le.length - 1; Nt >= 0; --Nt) {
          var nr = Le[Nt];
          nr && nr(Ue, null, 0);
        }
        H.flush(), Ze && Ze.update();
      }
      function Jt() {
        !er && Le.length > 0 && (er = _r.next(Xt));
      }
      function gr() {
        er && (_r.cancel(Xt), er = null);
      }
      function Jr(Nt) {
        Nt.preventDefault(), Ie = !0, gr(), jt.forEach(function(nr) {
          nr();
        });
      }
      function vn(Nt) {
        H.getError(), Ie = !1, ye.restore(), Be.restore(), qe.restore(), nt.restore(), Re.restore(), it.restore(), ht.restore(), Ze && Ze.restore(), It.procs.refresh(), Jt(), qt.forEach(function(nr) {
          nr();
        });
      }
      Je && (Je.addEventListener(Kw, Jr, !1), Je.addEventListener(qw, vn, !1));
      function ir() {
        Le.length = 0, gr(), Je && (Je.removeEventListener(Kw, Jr), Je.removeEventListener(qw, vn)), Be.clear(), it.clear(), Re.clear(), nt.clear(), gt.clear(), qe.clear(), ht.clear(), Ze && Ze.clear(), bt.forEach(function(Nt) {
          Nt();
        });
      }
      function sn(Nt) {
        N(!!Nt, "invalid args to regl({...})"), N.type(Nt, "object", "invalid args to regl({...})");
        function nr(de) {
          var re = n({}, de);
          delete re.uniforms, delete re.attributes, delete re.context, delete re.vao, "stencil" in re && re.stencil.op && (re.stencil.opBack = re.stencil.opFront = re.stencil.op, delete re.stencil.op);
          function ee(ae) {
            if (ae in re) {
              var V = re[ae];
              delete re[ae], Object.keys(V).forEach(function(K) {
                re[ae + "." + K] = V[K];
              });
            }
          }
          return ee("blend"), ee("depth"), ee("cull"), ee("stencil"), ee("polygonOffset"), ee("scissor"), ee("sample"), "vao" in de && (re.vao = de.vao), re;
        }
        function fr(de, re) {
          var ee = {}, ae = {};
          return Object.keys(de).forEach(function(V) {
            var K = de[V];
            if (pr.isDynamic(K)) {
              ae[V] = pr.unbox(K, V);
              return;
            } else if (re && Array.isArray(K)) {
              for (var j = 0; j < K.length; ++j)
                if (pr.isDynamic(K[j])) {
                  ae[V] = pr.unbox(K, V);
                  return;
                }
            }
            ee[V] = K;
          }), {
            dynamic: ae,
            static: ee
          };
        }
        var Kr = fr(Nt.context || {}, !0), da = fr(Nt.uniforms || {}, !0), Gs = fr(Nt.attributes || {}, !1), Y = fr(nr(Nt), !1), be = {
          gpuTime: 0,
          cpuTime: 0,
          count: 0
        }, ge = It.compile(Y, Gs, da, Kr, be), yt = ge.draw, tr = ge.batch, W = ge.scope, B = [];
        function Q(de) {
          for (; B.length < de; )
            B.push(null);
          return B;
        }
        function fe(de, re) {
          var ee;
          if (Ie && N.raise("context lost"), typeof de == "function")
            return W.call(this, null, de, 0);
          if (typeof re == "function")
            if (typeof de == "number")
              for (ee = 0; ee < de; ++ee)
                W.call(this, null, re, ee);
            else if (Array.isArray(de))
              for (ee = 0; ee < de.length; ++ee)
                W.call(this, de[ee], re, ee);
            else
              return W.call(this, de, re, 0);
          else if (typeof de == "number") {
            if (de > 0)
              return tr.call(this, Q(de | 0), de | 0);
          } else if (Array.isArray(de)) {
            if (de.length)
              return tr.call(this, de, de.length);
          } else
            return yt.call(this, de);
        }
        return n(fe, {
          stats: be,
          destroy: function() {
            ge.destroy();
          }
        });
      }
      var Pr = it.setFBO = sn({
        framebuffer: pr.define.call(null, Zw, "framebuffer")
      });
      function en(Nt, nr) {
        var fr = 0;
        It.procs.poll();
        var Kr = nr.color;
        Kr && (H.clearColor(+Kr[0] || 0, +Kr[1] || 0, +Kr[2] || 0, +Kr[3] || 0), fr |= e6), "depth" in nr && (H.clearDepth(+nr.depth), fr |= t6), "stencil" in nr && (H.clearStencil(nr.stencil | 0), fr |= r6), N(!!fr, "called regl.clear with no buffer specified"), H.clear(fr);
      }
      function un(Nt) {
        if (N(
          typeof Nt == "object" && Nt,
          "regl.clear() takes an object as input"
        ), "framebuffer" in Nt)
          if (Nt.framebuffer && Nt.framebuffer_reglType === "framebufferCube")
            for (var nr = 0; nr < 6; ++nr)
              Pr(n({
                framebuffer: Nt.framebuffer.faces[nr]
              }, Nt), en);
          else
            Pr(Nt, en);
        else
          en(null, Nt);
      }
      function fn(Nt) {
        N.type(Nt, "function", "regl.frame() callback must be a function"), Le.push(Nt);
        function nr() {
          var fr = Qw(Le, Nt);
          N(fr >= 0, "cannot cancel a frame twice");
          function Kr() {
            var da = Qw(Le, Kr);
            Le[da] = Le[Le.length - 1], Le.length -= 1, Le.length <= 0 && gr();
          }
          Le[fr] = Kr;
        }
        return Jt(), {
          cancel: nr
        };
      }
      function xn() {
        var Nt = st.viewport, nr = st.scissor_box;
        Nt[0] = Nt[1] = nr[0] = nr[1] = 0, Ue.viewportWidth = Ue.framebufferWidth = Ue.drawingBufferWidth = Nt[2] = nr[2] = H.drawingBufferWidth, Ue.viewportHeight = Ue.framebufferHeight = Ue.drawingBufferHeight = Nt[3] = nr[3] = H.drawingBufferHeight;
      }
      function An() {
        Ue.tick += 1, Ue.time = Zt(), xn(), It.procs.poll();
      }
      function Hr() {
        nt.refresh(), xn(), It.procs.refresh(), Ze && Ze.update();
      }
      function Zt() {
        return (jr() - Ve) / 1e3;
      }
      Hr();
      function In(Nt, nr) {
        N.type(nr, "function", "listener callback must be a function");
        var fr;
        switch (Nt) {
          case "frame":
            return fn(nr);
          case "lost":
            fr = jt;
            break;
          case "restore":
            fr = qt;
            break;
          case "destroy":
            fr = bt;
            break;
          default:
            N.raise("invalid event, must be one of frame,lost,restore,destroy");
        }
        return fr.push(nr), {
          cancel: function() {
            for (var Kr = 0; Kr < fr.length; ++Kr)
              if (fr[Kr] === nr) {
                fr[Kr] = fr[fr.length - 1], fr.pop();
                return;
              }
          }
        };
      }
      var wr = n(sn, {
        clear: un,
        prop: pr.define.bind(null, Zw),
        context: pr.define.bind(null, i6),
        this: pr.define.bind(null, a6),
        draw: sn({}),
        buffer: function(Nt) {
          return qe.create(Nt, n6, !1, !1);
        },
        elements: function(Nt) {
          return gt.create(Nt, !1);
        },
        texture: nt.create2D,
        cube: nt.createCube,
        renderbuffer: Re.create,
        framebuffer: it.create,
        framebufferCube: it.createCube,
        vao: ht.createVAO,
        attributes: me,
        frame: fn,
        on: In,
        limits: _e,
        hasExtension: function(Nt) {
          return _e.extensions.indexOf(Nt.toLowerCase()) >= 0;
        },
        read: Vt,
        destroy: ir,
        _gl: H,
        _refresh: Hr,
        poll: function() {
          An(), Ze && Ze.update();
        },
        now: Zt,
        stats: ze
      });
      return z.onDone(null, wr), wr;
    }
    return o6;
  });
})(m5);
const Tce = m5.exports;
var Ace = /* @__PURE__ */ function() {
  function r(t, e) {
    Pt(this, r), this.attribute = void 0, this.buffer = void 0;
    var n = e.buffer, i = e.offset, a = e.stride, o = e.normalized, s = e.size, u = e.divisor;
    this.buffer = n, this.attribute = {
      buffer: n.get(),
      offset: i || 0,
      stride: a || 0,
      normalized: o || !1,
      divisor: u || 0
    }, s && (this.attribute.size = s);
  }
  return Wt(r, [{
    key: "get",
    value: function() {
      return this.attribute;
    }
  }, {
    key: "updateBuffer",
    value: function(e) {
      this.buffer.subData(e);
    }
  }, {
    key: "destroy",
    value: function() {
      this.buffer.destroy();
    }
  }]), r;
}(), io, zl, ao, Oi, Ul, Vo, jl, $d, ga, Ws, Fn, ya, ma, Wd, Ice = (io = {}, Ae(io, he.POINTS, "points"), Ae(io, he.LINES, "lines"), Ae(io, he.LINE_LOOP, "line loop"), Ae(io, he.LINE_STRIP, "line strip"), Ae(io, he.TRIANGLES, "triangles"), Ae(io, he.TRIANGLE_FAN, "triangle fan"), Ae(io, he.TRIANGLE_STRIP, "triangle strip"), io), b5 = (zl = {}, Ae(zl, he.STATIC_DRAW, "static"), Ae(zl, he.DYNAMIC_DRAW, "dynamic"), Ae(zl, he.STREAM_DRAW, "stream"), zl), qx = (ao = {}, Ae(ao, he.BYTE, "int8"), Ae(ao, he.UNSIGNED_INT, "int16"), Ae(ao, he.INT, "int32"), Ae(ao, he.UNSIGNED_BYTE, "uint8"), Ae(ao, he.UNSIGNED_SHORT, "uint16"), Ae(ao, he.UNSIGNED_INT, "uint32"), Ae(ao, he.FLOAT, "float"), ao), Pce = (Oi = {}, Ae(Oi, he.ALPHA, "alpha"), Ae(Oi, he.LUMINANCE, "luminance"), Ae(Oi, he.LUMINANCE_ALPHA, "luminance alpha"), Ae(Oi, he.RGB, "rgb"), Ae(Oi, he.RGBA, "rgba"), Ae(Oi, he.RGBA4, "rgba4"), Ae(Oi, he.RGB5_A1, "rgb5 a1"), Ae(Oi, he.RGB565, "rgb565"), Ae(Oi, he.DEPTH_COMPONENT, "depth"), Ae(Oi, he.DEPTH_STENCIL, "depth stencil"), Oi), Oce = (Ul = {}, Ae(Ul, he.DONT_CARE, "dont care"), Ae(Ul, he.NICEST, "nice"), Ae(Ul, he.FASTEST, "fast"), Ul), cI = (Vo = {}, Ae(Vo, he.NEAREST, "nearest"), Ae(Vo, he.LINEAR, "linear"), Ae(Vo, he.LINEAR_MIPMAP_LINEAR, "mipmap"), Ae(Vo, he.NEAREST_MIPMAP_LINEAR, "nearest mipmap linear"), Ae(Vo, he.LINEAR_MIPMAP_NEAREST, "linear mipmap nearest"), Ae(Vo, he.NEAREST_MIPMAP_NEAREST, "nearest mipmap nearest"), Vo), hI = (jl = {}, Ae(jl, he.REPEAT, "repeat"), Ae(jl, he.CLAMP_TO_EDGE, "clamp"), Ae(jl, he.MIRRORED_REPEAT, "mirror"), jl), Dce = ($d = {}, Ae($d, he.NONE, "none"), Ae($d, he.BROWSER_DEFAULT_WEBGL, "browser"), $d), kce = (ga = {}, Ae(ga, he.NEVER, "never"), Ae(ga, he.ALWAYS, "always"), Ae(ga, he.LESS, "less"), Ae(ga, he.LEQUAL, "lequal"), Ae(ga, he.GREATER, "greater"), Ae(ga, he.GEQUAL, "gequal"), Ae(ga, he.EQUAL, "equal"), Ae(ga, he.NOTEQUAL, "notequal"), ga), dI = (Ws = {}, Ae(Ws, he.FUNC_ADD, "add"), Ae(Ws, he.MIN_EXT, "min"), Ae(Ws, he.MAX_EXT, "max"), Ae(Ws, he.FUNC_SUBTRACT, "subtract"), Ae(Ws, he.FUNC_REVERSE_SUBTRACT, "reverse subtract"), Ws), Vd = (Fn = {}, Ae(Fn, he.ZERO, "zero"), Ae(Fn, he.ONE, "one"), Ae(Fn, he.SRC_COLOR, "src color"), Ae(Fn, he.ONE_MINUS_SRC_COLOR, "one minus src color"), Ae(Fn, he.SRC_ALPHA, "src alpha"), Ae(Fn, he.ONE_MINUS_SRC_ALPHA, "one minus src alpha"), Ae(Fn, he.DST_COLOR, "dst color"), Ae(Fn, he.ONE_MINUS_DST_COLOR, "one minus dst color"), Ae(Fn, he.DST_ALPHA, "dst alpha"), Ae(Fn, he.ONE_MINUS_DST_ALPHA, "one minus dst alpha"), Ae(Fn, he.CONSTANT_COLOR, "constant color"), Ae(Fn, he.ONE_MINUS_CONSTANT_COLOR, "one minus constant color"), Ae(Fn, he.CONSTANT_ALPHA, "constant alpha"), Ae(Fn, he.ONE_MINUS_CONSTANT_ALPHA, "one minus constant alpha"), Ae(Fn, he.SRC_ALPHA_SATURATE, "src alpha saturate"), Fn), Lce = (ya = {}, Ae(ya, he.NEVER, "never"), Ae(ya, he.ALWAYS, "always"), Ae(ya, he.LESS, "less"), Ae(ya, he.LEQUAL, "lequal"), Ae(ya, he.GREATER, "greater"), Ae(ya, he.GEQUAL, "gequal"), Ae(ya, he.EQUAL, "equal"), Ae(ya, he.NOTEQUAL, "notequal"), ya), sf = (ma = {}, Ae(ma, he.ZERO, "zero"), Ae(ma, he.KEEP, "keep"), Ae(ma, he.REPLACE, "replace"), Ae(ma, he.INVERT, "invert"), Ae(ma, he.INCR, "increment"), Ae(ma, he.DECR, "decrement"), Ae(ma, he.INCR_WRAP, "increment wrap"), Ae(ma, he.DECR_WRAP, "decrement wrap"), ma), Nce = (Wd = {}, Ae(Wd, he.FRONT, "front"), Ae(Wd, he.BACK, "back"), Wd), Rce = /* @__PURE__ */ function() {
  function r(t, e) {
    Pt(this, r), this.buffer = void 0;
    var n = e.data, i = e.usage, a = e.type;
    this.buffer = t.buffer({
      data: n,
      usage: b5[i || he.STATIC_DRAW],
      type: qx[a || he.UNSIGNED_BYTE]
    });
  }
  return Wt(r, [{
    key: "get",
    value: function() {
      return this.buffer;
    }
  }, {
    key: "destroy",
    value: function() {
    }
  }, {
    key: "subData",
    value: function(e) {
      var n = e.data, i = e.offset;
      this.buffer.subdata(n, i);
    }
  }]), r;
}();
function Bce(r) {
  if (Array.isArray(r))
    return d1(r);
}
function Gce(r) {
  if (typeof Symbol < "u" && r[Symbol.iterator] != null || r["@@iterator"] != null)
    return Array.from(r);
}
function Fce() {
  throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`);
}
function cn(r) {
  return Bce(r) || Gce(r) || ZB(r) || Fce();
}
var zce = 9007199254740991, Uce = "[object Arguments]", jce = "[object Array]", $ce = "[object Boolean]", Wce = "[object Date]", Vce = "[object Error]", Xce = "[object Function]", Yce = "[object Map]", Hce = "[object Number]", Kce = "[object Object]", qce = "[object RegExp]", Zce = "[object Set]", Qce = "[object String]", Jce = "[object WeakMap]", ehe = "[object ArrayBuffer]", the = "[object DataView]", rhe = "[object Float32Array]", nhe = "[object Float64Array]", ihe = "[object Int8Array]", ahe = "[object Int16Array]", ohe = "[object Int32Array]", she = "[object Uint8Array]", uhe = "[object Uint8ClampedArray]", fhe = "[object Uint16Array]", lhe = "[object Uint32Array]", zr = {};
zr[rhe] = zr[nhe] = zr[ihe] = zr[ahe] = zr[ohe] = zr[she] = zr[uhe] = zr[fhe] = zr[lhe] = !0;
zr[Uce] = zr[jce] = zr[ehe] = zr[$ce] = zr[the] = zr[Wce] = zr[Vce] = zr[Xce] = zr[Yce] = zr[Hce] = zr[Kce] = zr[qce] = zr[Zce] = zr[Qce] = zr[Jce] = !1;
var che = Object.prototype, hhe = che.toString;
function dhe(r) {
  return phe(r) && vhe(r.length) && !!zr[hhe.call(r)];
}
function vhe(r) {
  return typeof r == "number" && r > -1 && r % 1 === 0 && r <= zce;
}
function phe(r) {
  return !!r && To(r) === "object";
}
var w1 = dhe;
function vI(r, t) {
  var e = Object.keys(r);
  if (Object.getOwnPropertySymbols) {
    var n = Object.getOwnPropertySymbols(r);
    t && (n = n.filter(function(i) {
      return Object.getOwnPropertyDescriptor(r, i).enumerable;
    })), e.push.apply(e, n);
  }
  return e;
}
function pI(r) {
  for (var t = 1; t < arguments.length; t++) {
    var e = arguments[t] != null ? arguments[t] : {};
    t % 2 ? vI(Object(e), !0).forEach(function(n) {
      Ae(r, n, e[n]);
    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(r, Object.getOwnPropertyDescriptors(e)) : vI(Object(e)).forEach(function(n) {
      Object.defineProperty(r, n, Object.getOwnPropertyDescriptor(e, n));
    });
  }
  return r;
}
var ghe = `attribute vec3 a_Position;
attribute vec2 a_TexCoord;

varying vec2 v_TexCoord;

void main() {
  gl_Position = vec4(a_Position, 1.0);
  v_TexCoord = a_TexCoord;
}`, gI = 0, yhe = /* @__PURE__ */ function() {
  function r(t, e) {
    var n = this;
    Pt(this, r), this.reGl = t, this.context = e, this.entity = Na(), this.texFBO = void 0, this.computeCommand = void 0, this.textureCache = {}, this.outputTextureName = void 0, this.swapOutputTextureName = void 0, this.compiledPingpong = void 0, this.dynamicPingpong = void 0;
    var i = {};
    this.context.uniforms.forEach(function(f) {
      var l = f.name, c = f.type, h = f.data, d = f.isReferer, v = f.storageClass;
      if (v === ms.StorageBuffer) {
        if (d)
          n.textureCache[l] = {
            data: void 0
          }, i["".concat(l, "Size")] = function() {
            return h.compiledBundle.context.output.textureSize;
          };
        else {
          n.textureCache[l] = n.calcDataTexture(l, c, h);
          var p = n.textureCache[l], g = p.textureWidth, y = p.isOutput;
          i["".concat(l, "Size")] = [g, g], y && (n.outputTextureName = l, n.context.needPingpong && (n.outputTextureName = "".concat(l, "Output"), n.textureCache[n.outputTextureName] = n.calcDataTexture(l, c, h)));
        }
        i[l] = function() {
          return n.textureCache[l].texture;
        };
      } else if (v === ms.Uniform) {
        if (h && (Array.isArray(h) || w1(h)) && h.length > 16)
          throw new Error("invalid data type ".concat(c));
        i[l] = function() {
          return f.data;
        };
      }
    });
    var a = this.getOuputDataTexture(), o = a.textureWidth, s = a.texelCount;
    i.u_OutputTextureSize = [o, o], i.u_OutputTexelCount = s, this.context.output.textureSize = [o, o];
    var u = {
      attributes: {
        a_Position: [[-1, 1, 0], [-1, -1, 0], [1, 1, 0], [1, -1, 0]],
        a_TexCoord: [[0, 1], [0, 0], [1, 1], [1, 0]]
      },
      frag: `#ifdef GL_FRAGMENT_PRECISION_HIGH
  precision highp float;
#else
  precision mediump float;
#endif
`.concat(this.context.shader),
      uniforms: i,
      vert: ghe,
      primitive: "triangle strip",
      count: 4
    };
    this.computeCommand = this.reGl(u);
  }
  return Wt(r, [{
    key: "run",
    value: function() {
      var e = this;
      this.context.maxIteration > 1 && this.context.needPingpong && (this.compiledPingpong = !0), (this.compiledPingpong || this.dynamicPingpong) && this.swap(), this.texFBO = this.reGl.framebuffer({
        color: this.getOuputDataTexture().texture
      }), this.texFBO.use(function() {
        e.computeCommand();
      });
    }
  }, {
    key: "readData",
    value: function() {
      var t = Er(/* @__PURE__ */ St.mark(function n() {
        var i = this, a, o, s, u, f, l, c, h;
        return St.wrap(function(v) {
          for (; ; )
            switch (v.prev = v.next) {
              case 0:
                if (this.reGl({
                  framebuffer: this.texFBO
                })(function() {
                  a = i.reGl.read();
                }), !a) {
                  v.next = 6;
                  break;
                }
                if (o = this.getOuputDataTexture(), s = o.originalDataLength, u = o.elementsPerTexel, f = o.typedArrayConstructor, l = f === void 0 ? Float32Array : f, c = [], u !== 4)
                  for (h = 0; h < a.length; h += 4)
                    u === 1 ? c.push(a[h]) : u === 2 ? c.push(a[h], a[h + 1]) : c.push(a[h], a[h + 1], a[h + 2]);
                else
                  c = a;
                return v.abrupt("return", new l(c.slice(0, s)));
              case 6:
                return v.abrupt("return", new Float32Array());
              case 7:
              case "end":
                return v.stop();
            }
        }, n, this);
      }));
      function e() {
        return t.apply(this, arguments);
      }
      return e;
    }()
  }, {
    key: "confirmInput",
    value: function(e, n) {
      var i;
      this.entity === e.entity ? (this.dynamicPingpong = !0, i = this) : i = e, this.textureCache[n].id = i.getOuputDataTexture().id, this.textureCache[n].texture = i.getOuputDataTexture().texture;
    }
  }, {
    key: "updateUniform",
    value: function() {
    }
  }, {
    key: "updateBuffer",
    value: function(e, n) {
      var i = this.context.uniforms.find(function(u) {
        var f = u.name;
        return f === e;
      });
      if (i) {
        var a = this.calcDataTexture(e, i.type, n), o = a.texture, s = a.data;
        this.textureCache[e].data = s, this.textureCache[e].texture = o;
      }
    }
  }, {
    key: "destroy",
    value: function() {
    }
  }, {
    key: "swap",
    value: function() {
      if (this.swapOutputTextureName || this.createSwapOutputDataTexture(), this.compiledPingpong) {
        var e = this.context.output.name;
        this.textureCache[e].id = this.getOuputDataTexture().id, this.textureCache[e].texture = this.getOuputDataTexture().texture;
      }
      var n = this.outputTextureName;
      this.outputTextureName = this.swapOutputTextureName, this.swapOutputTextureName = n;
    }
  }, {
    key: "getOuputDataTexture",
    value: function() {
      return this.textureCache[this.outputTextureName];
    }
  }, {
    key: "createSwapOutputDataTexture",
    value: function() {
      var e = this.cloneDataTexture(this.getOuputDataTexture());
      this.swapOutputTextureName = "".concat(this.entity, "-swap"), this.textureCache[this.swapOutputTextureName] = e;
    }
  }, {
    key: "cloneDataTexture",
    value: function(e) {
      var n = e.data, i = e.textureWidth;
      return pI(pI({}, e), {}, {
        id: gI++,
        texture: this.reGl.texture({
          width: i,
          height: i,
          data: n,
          type: "float"
        })
      });
    }
  }, {
    key: "calcDataTexture",
    value: function(e, n, i) {
      var a = 1;
      n === Su.Vector4FloatArray && (a = 4);
      for (var o = [], s = 0; s < i.length; s += a)
        a === 1 ? o.push(i[s], 0, 0, 0) : a === 2 ? o.push(i[s], i[s + 1], 0, 0) : a === 3 ? o.push(i[s], i[s + 1], i[s + 2], 0) : a === 4 && o.push(i[s], i[s + 1], i[s + 2], i[s + 3]);
      var u = i.length, f = Math.ceil(u / a), l = Math.ceil(Math.sqrt(f)), c = l * l;
      f < c && o.push.apply(o, cn(new Array((c - f) * 4).fill(0)));
      var h = this.reGl.texture({
        width: l,
        height: l,
        data: o,
        type: "float"
      });
      return {
        id: gI++,
        data: o,
        originalDataLength: u,
        typedArrayConstructor: w1(i) ? i.constructor : void 0,
        textureWidth: l,
        texture: h,
        texelCount: f,
        elementsPerTexel: a,
        isOutput: e === this.context.output.name
      };
    }
  }]), r;
}(), mhe = /* @__PURE__ */ function() {
  function r(t, e) {
    Pt(this, r), this.elements = void 0;
    var n = e.data, i = e.usage, a = e.type, o = e.count;
    this.elements = t.elements({
      data: n,
      usage: b5[i || he.STATIC_DRAW],
      type: qx[a || he.UNSIGNED_BYTE],
      count: o
    });
  }
  return Wt(r, [{
    key: "get",
    value: function() {
      return this.elements;
    }
  }, {
    key: "subData",
    value: function(e) {
      var n = e.data;
      this.elements.subdata(n);
    }
  }, {
    key: "destroy",
    value: function() {
      this.elements.destroy();
    }
  }]), r;
}(), bhe = /* @__PURE__ */ function() {
  function r(t, e) {
    Pt(this, r), this.framebuffer = void 0;
    var n = e.width, i = e.height, a = e.color, o = e.colors;
    e.depth, e.stencil;
    var s = {
      width: n,
      height: i
    };
    Array.isArray(o) && (s.colors = o.map(function(u) {
      return u.get();
    })), a && typeof a != "boolean" && (s.color = a.get()), this.framebuffer = t.framebuffer(s);
  }
  return Wt(r, [{
    key: "get",
    value: function() {
      return this.framebuffer;
    }
  }, {
    key: "destroy",
    value: function() {
      this.framebuffer.destroy();
    }
  }, {
    key: "resize",
    value: function(e) {
      var n = e.width, i = e.height;
      this.framebuffer.resize(n, i);
    }
  }]), r;
}();
function xhe(r) {
  var t = To(r);
  return r != null && (t === "object" || t === "function");
}
function xc(r) {
  var t = {};
  return Object.keys(r).forEach(function(e) {
    E1(e, r[e], t, "");
  }), t;
}
function E1(r, t, e, n) {
  if (t === null || typeof t == "number" || typeof t == "boolean" || Array.isArray(t) && typeof t[0] == "number" || w1(t) || t === "" || t.resize !== void 0) {
    e["".concat(n && n + ".").concat(r)] = t;
    return;
  }
  xhe(t) && Object.keys(t).forEach(function(i) {
    E1(
      i,
      t[i],
      e,
      "".concat(n && n + ".").concat(r)
    );
  }), Array.isArray(t) && t.forEach(function(i, a) {
    Object.keys(i).forEach(function(o) {
      E1(
        o,
        i[o],
        e,
        "".concat(n && n + ".").concat(r, "[").concat(a, "]")
      );
    });
  });
}
function yI(r, t) {
  var e = Object.keys(r);
  if (Object.getOwnPropertySymbols) {
    var n = Object.getOwnPropertySymbols(r);
    t && (n = n.filter(function(i) {
      return Object.getOwnPropertyDescriptor(r, i).enumerable;
    })), e.push.apply(e, n);
  }
  return e;
}
function uf(r) {
  for (var t = 1; t < arguments.length; t++) {
    var e = arguments[t] != null ? arguments[t] : {};
    t % 2 ? yI(Object(e), !0).forEach(function(n) {
      Ae(r, n, e[n]);
    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(r, Object.getOwnPropertyDescriptors(e)) : yI(Object(e)).forEach(function(n) {
      Object.defineProperty(r, n, Object.getOwnPropertyDescriptor(e, n));
    });
  }
  return r;
}
var _he = /* @__PURE__ */ function() {
  function r(t, e) {
    Pt(this, r), this.reGl = void 0, this.drawCommand = void 0, this.uniforms = {}, this.reGl = t;
    var n = e.vs, i = e.fs, a = e.defines, o = e.attributes, s = e.uniforms, u = e.primitive, f = e.count, l = e.elements, c = e.depth, h = e.blend, d = e.stencil, v = e.cull, p = e.instances, g = e.scissor, y = e.viewport, b = {};
    s && (this.uniforms = xc(s), Object.keys(s).forEach(function(w) {
      b[w] = t.prop(w);
    }));
    var m = {};
    Object.keys(o).forEach(function(w) {
      m[w] = o[w].get();
    });
    var x = a && this.generateDefines(a) || "", _ = {
      attributes: m,
      frag: `#ifdef GL_FRAGMENT_PRECISION_HIGH
  precision highp float;
#else
  precision mediump float;
#endif
`.concat(x, `
`).concat(i),
      uniforms: b,
      vert: `
`.concat(x, `
`).concat(n),
      primitive: Ice[u === void 0 ? he.TRIANGLES : u]
    };
    p && (_.instances = p), f && (_.count = f), l && (_.elements = l.get()), g && (_.scissor = g), y && (_.viewport = y), this.initDepthDrawParams({
      depth: c
    }, _), this.initBlendDrawParams({
      blend: h
    }, _), this.initStencilDrawParams({
      stencil: d
    }, _), this.initCullDrawParams({
      cull: v
    }, _), this.drawCommand = t(_);
  }
  return Wt(r, [{
    key: "addUniforms",
    value: function(e) {
      this.uniforms = uf(uf({}, this.uniforms), xc(e));
    }
  }, {
    key: "draw",
    value: function(e) {
      var n = uf(uf({}, this.uniforms), xc(e.uniforms || {})), i = {};
      Object.keys(n).forEach(function(a) {
        var o = To(n[a]);
        o === "boolean" || o === "number" || Array.isArray(n[a]) || n[a].BYTES_PER_ELEMENT ? i[a] = n[a] : o === "string" || (i[a] = n[a].get());
      }), this.drawCommand(i);
    }
  }, {
    key: "destroy",
    value: function() {
    }
  }, {
    key: "initDepthDrawParams",
    value: function(e, n) {
      var i = e.depth;
      i && (n.depth = {
        enable: i.enable === void 0 ? !0 : !!i.enable,
        mask: i.mask === void 0 ? !0 : !!i.mask,
        func: kce[i.func || he.LESS],
        range: i.range || [0, 1]
      });
    }
  }, {
    key: "initBlendDrawParams",
    value: function(e, n) {
      var i = e.blend;
      if (i) {
        var a = i.enable, o = i.func, s = i.equation, u = i.color, f = u === void 0 ? [0, 0, 0, 0] : u;
        n.blend = {
          enable: !!a,
          func: {
            srcRGB: Vd[o && o.srcRGB || he.SRC_ALPHA],
            srcAlpha: Vd[o && o.srcAlpha || he.SRC_ALPHA],
            dstRGB: Vd[o && o.dstRGB || he.ONE_MINUS_SRC_ALPHA],
            dstAlpha: Vd[o && o.dstAlpha || he.ONE_MINUS_SRC_ALPHA]
          },
          equation: {
            rgb: dI[s && s.rgb || he.FUNC_ADD],
            alpha: dI[s && s.alpha || he.FUNC_ADD]
          },
          color: f
        };
      }
    }
  }, {
    key: "initStencilDrawParams",
    value: function(e, n) {
      var i = e.stencil;
      if (i) {
        var a = i.enable, o = i.mask, s = o === void 0 ? -1 : o, u = i.func, f = u === void 0 ? {
          cmp: he.ALWAYS,
          ref: 0,
          mask: -1
        } : u, l = i.opFront, c = l === void 0 ? {
          fail: he.KEEP,
          zfail: he.KEEP,
          zpass: he.KEEP
        } : l, h = i.opBack, d = h === void 0 ? {
          fail: he.KEEP,
          zfail: he.KEEP,
          zpass: he.KEEP
        } : h;
        n.stencil = {
          enable: !!a,
          mask: s,
          func: uf(uf({}, f), {}, {
            cmp: Lce[f.cmp]
          }),
          opFront: {
            fail: sf[c.fail],
            zfail: sf[c.zfail],
            zpass: sf[c.zpass]
          },
          opBack: {
            fail: sf[d.fail],
            zfail: sf[d.zfail],
            zpass: sf[d.zpass]
          }
        };
      }
    }
  }, {
    key: "initCullDrawParams",
    value: function(e, n) {
      var i = e.cull;
      if (i) {
        var a = i.enable, o = i.face, s = o === void 0 ? he.BACK : o;
        n.cull = {
          enable: !!a,
          face: Nce[s]
        };
      }
    }
  }, {
    key: "generateDefines",
    value: function(e) {
      return Object.keys(e).map(function(n) {
        return "#define ".concat(n, " ").concat(Number(e[n]));
      }).join(`
`);
    }
  }]), r;
}(), whe = /* @__PURE__ */ function() {
  function r(t, e) {
    Pt(this, r), this.texture = void 0, this.width = void 0, this.height = void 0;
    var n = e.data, i = e.type, a = i === void 0 ? he.UNSIGNED_BYTE : i, o = e.width, s = e.height, u = e.flipY, f = u === void 0 ? !1 : u, l = e.format, c = l === void 0 ? he.RGBA : l, h = e.mipmap, d = h === void 0 ? !1 : h, v = e.wrapS, p = v === void 0 ? he.CLAMP_TO_EDGE : v, g = e.wrapT, y = g === void 0 ? he.CLAMP_TO_EDGE : g, b = e.aniso, m = b === void 0 ? 0 : b, x = e.alignment, _ = x === void 0 ? 1 : x, w = e.premultiplyAlpha, E = w === void 0 ? !1 : w, M = e.mag, C = M === void 0 ? he.NEAREST : M, S = e.min, A = S === void 0 ? he.NEAREST : S, T = e.colorSpace, P = T === void 0 ? he.BROWSER_DEFAULT_WEBGL : T;
    this.width = o, this.height = s;
    var k = {
      width: o,
      height: s,
      type: qx[a],
      format: Pce[c],
      wrapS: hI[p],
      wrapT: hI[y],
      mag: cI[C],
      min: cI[A],
      alignment: _,
      flipY: f,
      colorSpace: Dce[P],
      premultiplyAlpha: E,
      aniso: m
    };
    n && (k.data = n), typeof d == "number" ? k.mipmap = Oce[d] : typeof d == "boolean" && (k.mipmap = d), this.texture = t.texture(k);
  }
  return Wt(r, [{
    key: "get",
    value: function() {
      return this.texture;
    }
  }, {
    key: "update",
    value: function() {
      this.texture._texture.bind();
    }
  }, {
    key: "resize",
    value: function(e) {
      var n = e.width, i = e.height;
      this.texture.resize(n, i), this.width = n, this.height = i;
    }
  }, {
    key: "destroy",
    value: function() {
      this.texture.destroy();
    }
  }]), r;
}(), mI, bI, xI, Ehe = (mI = Mr(), mI(bI = (xI = /* @__PURE__ */ function() {
  function r() {
    var t = this;
    Pt(this, r), this.supportWebGPU = !1, this.useWGSL = !1, this.$canvas = void 0, this.gl = void 0, this.inited = void 0, this.createModel = /* @__PURE__ */ function() {
      var e = Er(/* @__PURE__ */ St.mark(function n(i) {
        return St.wrap(function(o) {
          for (; ; )
            switch (o.prev = o.next) {
              case 0:
                if (!i.uniforms) {
                  o.next = 3;
                  break;
                }
                return o.next = 3, Promise.all(Object.keys(i.uniforms).map(/* @__PURE__ */ function() {
                  var s = Er(/* @__PURE__ */ St.mark(function u(f) {
                    var l;
                    return St.wrap(function(h) {
                      for (; ; )
                        switch (h.prev = h.next) {
                          case 0:
                            if (!(i.uniforms[f] && i.uniforms[f].load !== void 0)) {
                              h.next = 5;
                              break;
                            }
                            return h.next = 3, i.uniforms[f].load();
                          case 3:
                            l = h.sent, i.uniforms[f] = l;
                          case 5:
                          case "end":
                            return h.stop();
                        }
                    }, u);
                  }));
                  return function(u) {
                    return s.apply(this, arguments);
                  };
                }()));
              case 3:
                return o.abrupt("return", new _he(t.gl, i));
              case 4:
              case "end":
                return o.stop();
            }
        }, n);
      }));
      return function(n) {
        return e.apply(this, arguments);
      };
    }(), this.createAttribute = function(e) {
      return new Ace(t.gl, e);
    }, this.createBuffer = function(e) {
      return new Rce(t.gl, e);
    }, this.createElements = function(e) {
      return new mhe(t.gl, e);
    }, this.createTexture2D = function(e) {
      return new whe(t.gl, e);
    }, this.createFramebuffer = function(e) {
      return new bhe(t.gl, e);
    }, this.useFramebuffer = function(e, n) {
      t.gl({
        framebuffer: e ? e.get() : null
      })(n);
    }, this.createComputeModel = /* @__PURE__ */ function() {
      var e = Er(/* @__PURE__ */ St.mark(function n(i) {
        return St.wrap(function(o) {
          for (; ; )
            switch (o.prev = o.next) {
              case 0:
                return o.abrupt("return", new yhe(t.gl, i));
              case 1:
              case "end":
                return o.stop();
            }
        }, n);
      }));
      return function(n) {
        return e.apply(this, arguments);
      };
    }(), this.clear = function(e) {
      var n = e.color, i = e.depth, a = e.stencil, o = e.framebuffer, s = o === void 0 ? null : o, u = {
        color: n,
        depth: i,
        stencil: a
      };
      u.framebuffer = s === null ? s : s.get(), t.gl.clear(u);
    }, this.setScissor = function(e) {
      t.gl && t.gl._gl && (e.enable && e.box ? (t.gl._gl.enable(he.SCISSOR_TEST), t.gl._gl.scissor(e.box.x, e.box.y, e.box.width, e.box.height)) : t.gl._gl.disable(he.SCISSOR_TEST), t.gl._refresh());
    }, this.viewport = function(e) {
      var n = e.x, i = e.y, a = e.width, o = e.height;
      t.gl && t.gl._gl && (t.gl._gl.viewport(n, i, a, o), t.gl._refresh());
    }, this.readPixels = function(e) {
      var n = e.framebuffer, i = e.x, a = e.y, o = e.width, s = e.height, u = {
        x: i,
        y: a,
        width: o,
        height: s
      };
      return n && (u.framebuffer = n.get()), t.gl.read(u);
    }, this.getCanvas = function() {
      return t.$canvas;
    }, this.getGLContext = function() {
      return t.gl._gl;
    }, this.destroy = function() {
      t.gl && (t.gl.destroy(), t.inited = !1);
    };
  }
  return Wt(r, [{
    key: "init",
    value: function() {
      var t = Er(/* @__PURE__ */ St.mark(function n(i) {
        return St.wrap(function(o) {
          for (; ; )
            switch (o.prev = o.next) {
              case 0:
                if (!this.inited) {
                  o.next = 2;
                  break;
                }
                return o.abrupt("return");
              case 2:
                return this.$canvas = i.canvas, o.next = 5, new Promise(function(s, u) {
                  Tce({
                    canvas: i.canvas,
                    attributes: {
                      alpha: !0,
                      antialias: i.antialias,
                      premultipliedAlpha: !0
                    },
                    pixelRatio: 1,
                    extensions: [
                      "OES_element_index_uint",
                      "OES_texture_float",
                      "OES_standard_derivatives",
                      "angle_instanced_arrays"
                    ],
                    optionalExtensions: ["EXT_texture_filter_anisotropic", "EXT_blend_minmax", "WEBGL_depth_texture"],
                    profile: !0,
                    onDone: function(l, c) {
                      (l || !c) && u(l), s(c);
                    }
                  });
                });
              case 5:
                this.gl = o.sent, this.inited = !0;
              case 7:
              case "end":
                return o.stop();
            }
        }, n, this);
      }));
      function e(n) {
        return t.apply(this, arguments);
      }
      return e;
    }()
  }, {
    key: "isFloatSupported",
    value: function() {
      return this.gl.limits.readFloat;
    }
  }, {
    key: "beginFrame",
    value: function() {
    }
  }, {
    key: "endFrame",
    value: function() {
    }
  }]), r;
}(), xI)) || bI);
function She() {
  return typeof window < "u";
}
function Mhe(r, t, e, n) {
  if (!!She()) {
    var i = document.getElementsByTagName("head")[0], a = document.createElement("script");
    a.setAttribute("type", "text/javascript"), a.setAttribute("src", r), n && (a.id = n), a.onload = function() {
      t && t();
    }, a.onerror = function(o) {
      e && e("Unable to load script '".concat(r, "'"), o);
    }, i.appendChild(a);
  }
}
function Che(r, t) {
  return new Promise(function(e, n) {
    Mhe(r, function() {
      e();
    }, function(i, a) {
      n(a);
    });
  });
}
var Xd;
function The() {
  return S1.apply(this, arguments);
}
function S1() {
  return S1 = Er(/* @__PURE__ */ St.mark(function r() {
    return St.wrap(function(e) {
      for (; ; )
        switch (e.prev = e.next) {
          case 0:
            if (!Xd) {
              e.next = 2;
              break;
            }
            return e.abrupt("return", Xd);
          case 2:
            return e.next = 4, Che("https://preview.babylonjs.com/glslang/glslang.js");
          case 4:
            return Xd = window.glslang("https://preview.babylonjs.com/glslang/glslang.wasm"), e.abrupt("return", Xd);
          case 6:
          case "end":
            return e.stop();
        }
    }, r);
  })), S1.apply(this, arguments);
}
var Ahe = /* @__PURE__ */ function() {
  function r(t, e) {
    Pt(this, r), this.engine = t, this.options = e, this.attribute = void 0, this.buffer = void 0;
    var n = e, i = n.buffer, a = n.offset, o = n.stride, s = n.normalized, u = n.size, f = n.divisor, l = n.arrayStride, c = n.attributes, h = n.stepMode;
    this.buffer = i, this.attribute = {
      buffer: i.get(),
      offset: a || 0,
      stride: o || 0,
      normalized: s || !1,
      divisor: f || 0,
      arrayStride: l || 0,
      attributes: c,
      stepMode: h || "vertex"
    }, u && (this.attribute.size = u);
  }
  return Wt(r, [{
    key: "get",
    value: function() {
      return this.attribute;
    }
  }, {
    key: "updateBuffer",
    value: function(e) {
      this.buffer.subData(e);
    }
  }, {
    key: "destroy",
    value: function() {
      this.buffer.destroy();
    }
  }]), r;
}(), Rf = /* @__PURE__ */ function() {
  function r(t, e) {
    Pt(this, r), this.engine = t, this.options = e, this.buffer = void 0;
    var n = e, i = n.data, a = n.usage;
    n.type, this.buffer = this.createBuffer(
      i instanceof Array ? new Float32Array(i) : i,
      a || ut.BufferUsage.Vertex | ut.BufferUsage.CopyDst
    );
  }
  return Wt(r, [{
    key: "get",
    value: function() {
      return this.buffer;
    }
  }, {
    key: "destroy",
    value: function() {
      this.buffer.destroy();
    }
  }, {
    key: "subData",
    value: function(e) {
      var n = e.data, i = e.offset;
      this.setSubData(this.buffer, i, n instanceof Array ? new Float32Array(n) : n);
    }
  }, {
    key: "createBuffer",
    value: function(e, n) {
      var i = e.byteLength % 4, a = {
        size: e.byteLength + i,
        usage: n
      }, o = this.engine.device.createBuffer(a);
      return this.setSubData(o, 0, e), o;
    }
  }, {
    key: "setSubData",
    value: function(e, n, i) {
      var a = ai ? this.engine.device.getQueue() : this.engine.device.defaultQueue;
      a.writeBuffer(e, n, i);
    }
  }]), r;
}();
function Ihe(r) {
  return typeof r == "number";
}
var Phe = /* @__PURE__ */ function() {
  function r(t, e) {
    Pt(this, r), this.engine = t, this.context = e, this.entity = Na(), this.uniformGPUBufferLayout = [], this.uniformBuffer = void 0, this.vertexBuffers = {}, this.outputBuffer = void 0, this.bindGroupEntries = void 0, this.bindGroup = void 0, this.computePipeline = void 0;
  }
  return Wt(r, [{
    key: "init",
    value: function() {
      var t = Er(/* @__PURE__ */ St.mark(function n() {
        var i = this, a, o, s, u, f, l, c;
        return St.wrap(function(d) {
          for (; ; )
            switch (d.prev = d.next) {
              case 0:
                return d.next = 2, this.compileComputePipelineStageDescriptor(this.context.shader);
              case 2:
                a = d.sent, o = a.computeStage, s = this.context.uniforms.filter(function(v) {
                  return v.storageClass === ms.StorageBuffer;
                }), u = this.context.uniforms.filter(function(v) {
                  return v.storageClass === ms.Uniform;
                }), f = u.length ? 1 : 0, this.bindGroupEntries = [], f && (l = 0, c = [], u.forEach(function(v) {
                  if (Ihe(v.data))
                    i.uniformGPUBufferLayout.push({
                      name: v.name,
                      offset: l
                    }), l += 4, c.push(v.data);
                  else {
                    var p, g = ((p = v.data) === null || p === void 0 ? void 0 : p.length) || 1;
                    g === 3 && (g = 4, v.data.push(0));
                    var y = l / 4 % 4;
                    if (y > 0) {
                      var b = 4 - y;
                      if (g > 1 && g <= b)
                        g === 2 && (b === 3 && (l += 4, c.push(0)), c.push.apply(c, cn(v.data)), i.uniformGPUBufferLayout.push({
                          name: v.name,
                          offset: l
                        }));
                      else {
                        for (var m = 0; m < b; m++)
                          l += 4, c.push(0);
                        c.push.apply(c, cn(v.data)), i.uniformGPUBufferLayout.push({
                          name: v.name,
                          offset: l
                        });
                      }
                    }
                    l += 4 * g;
                  }
                }), this.uniformBuffer = new Rf(this.engine, {
                  data: c instanceof Array ? new Float32Array(c) : c,
                  usage: ut.BufferUsage.Uniform | ut.BufferUsage.CopyDst
                }), this.bindGroupEntries.push({
                  binding: 0,
                  resource: {
                    buffer: this.uniformBuffer.get()
                  }
                })), s.forEach(function(v) {
                  if (v.data !== null && (v.type === Su.Vector4FloatArray || v.type === Su.FloatArray)) {
                    var p;
                    v.name === i.context.output.name ? (p = new Rf(i.engine, {
                      data: isFinite(Number(v.data)) ? [v.data] : v.data,
                      usage: ut.BufferUsage.Storage | ut.BufferUsage.CopyDst | ut.BufferUsage.CopySrc
                    }), i.outputBuffer = p, i.context.output = {
                      name: v.name,
                      length: isFinite(Number(v.data)) ? 1 : v.data.length,
                      typedArrayConstructor: Float32Array,
                      gpuBuffer: p.get()
                    }) : v.isReferer ? v.data.model && v.data.model.outputBuffer && (p = v.data.model.outputBuffer) : p = new Rf(i.engine, {
                      data: isFinite(Number(v.data)) ? [v.data] : v.data,
                      usage: ut.BufferUsage.Storage | ut.BufferUsage.CopyDst | ut.BufferUsage.CopySrc
                    }), i.vertexBuffers[v.name] = p, i.bindGroupEntries.push({
                      binding: f,
                      resource: {
                        name: v.name,
                        refer: p ? void 0 : v.data,
                        buffer: p ? p.get() : void 0
                      }
                    }), f++;
                  }
                }), this.computePipeline = this.engine.device.createComputePipeline({
                  computeStage: o
                }), console.log(this.bindGroupEntries), this.bindGroup = this.engine.device.createBindGroup({
                  layout: this.computePipeline.getBindGroupLayout(0),
                  entries: this.bindGroupEntries
                });
              case 13:
              case "end":
                return d.stop();
            }
        }, n, this);
      }));
      function e() {
        return t.apply(this, arguments);
      }
      return e;
    }()
  }, {
    key: "destroy",
    value: function() {
      var e = this;
      this.uniformBuffer && this.uniformBuffer.destroy(), Object.keys(this.vertexBuffers).forEach(function(n) {
        return e.vertexBuffers[n].destroy();
      });
    }
  }, {
    key: "readData",
    value: function() {
      var t = Er(/* @__PURE__ */ St.mark(function n() {
        var i, a, o, s, u, f, l, c, h, d;
        return St.wrap(function(p) {
          for (; ; )
            switch (p.prev = p.next) {
              case 0:
                if (i = this.context.output, !i) {
                  p.next = 16;
                  break;
                }
                if (a = i.length, o = i.typedArrayConstructor, s = i.gpuBuffer, !s) {
                  p.next = 16;
                  break;
                }
                return u = a * o.BYTES_PER_ELEMENT, f = this.engine.device.createBuffer({
                  size: u,
                  usage: GPUBufferUsage.COPY_DST | GPUBufferUsage.MAP_READ
                }), l = this.engine.device.createCommandEncoder(), l.copyBufferToBuffer(s, 0, f, 0, u), c = ai ? this.engine.device.getQueue() : this.engine.device.defaultQueue, c.submit([l.finish()]), p.next = 12, f.mapAsync(ut.MapMode.Read);
              case 12:
                return h = f.getMappedRange(), d = new o(h.slice(0)), f.unmap(), p.abrupt("return", d);
              case 16:
                return p.abrupt("return", new Float32Array());
              case 17:
              case "end":
                return p.stop();
            }
        }, n, this);
      }));
      function e() {
        return t.apply(this, arguments);
      }
      return e;
    }()
  }, {
    key: "run",
    value: function() {
      if (this.engine.currentComputePass) {
        var e;
        this.engine.currentComputePass.setPipeline(this.computePipeline), this.engine.currentComputePass.setBindGroup(0, this.bindGroup), (e = this.engine.currentComputePass).dispatch.apply(e, cn(this.context.dispatch));
      }
    }
  }, {
    key: "updateBuffer",
    value: function(e, n) {
      var i = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : 0, a = this.vertexBuffers[e];
      a && a.subData({
        data: n,
        offset: i
      });
    }
  }, {
    key: "updateUniform",
    value: function(e, n) {
      var i = this.uniformGPUBufferLayout.find(function(a) {
        return a.name === e;
      });
      i && this.uniformBuffer.subData({
        data: Number.isFinite(n) ? new Float32Array([n]) : new Float32Array(n),
        offset: i.offset
      });
    }
  }, {
    key: "confirmInput",
    value: function(e, n) {
      var i = this.vertexBuffers[n], a = e.outputBuffer;
      if (i && a && i !== a) {
        var o = this.engine.device.createCommandEncoder(), s = e.context.output, u = s.length, f = s.typedArrayConstructor, l = u * f.BYTES_PER_ELEMENT;
        o.copyBufferToBuffer(a.get(), 0, i.get(), 0, l);
        var c = ai ? this.engine.device.getQueue() : this.engine.device.defaultQueue;
        c.submit([o.finish()]);
      }
    }
  }, {
    key: "compileShaderToSpirV",
    value: function(e, n, i) {
      return this.compileRawShaderToSpirV(i + e, n);
    }
  }, {
    key: "compileRawShaderToSpirV",
    value: function(e, n) {
      return this.engine.glslang.compileGLSL(e, n);
    }
  }, {
    key: "compileComputePipelineStageDescriptor",
    value: function() {
      var t = Er(/* @__PURE__ */ St.mark(function n(i) {
        var a, o;
        return St.wrap(function(u) {
          for (; ; )
            switch (u.prev = u.next) {
              case 0:
                if (a = i, o = `#version 450
`, this.engine.options.useWGSL) {
                  u.next = 6;
                  break;
                }
                return u.next = 5, this.compileShaderToSpirV(i, "compute", o);
              case 5:
                a = u.sent;
              case 6:
                return u.abrupt("return", {
                  computeStage: {
                    module: this.engine.device.createShaderModule({
                      code: a,
                      isWHLSL: ai
                    }),
                    entryPoint: "main"
                  }
                });
              case 7:
              case "end":
                return u.stop();
            }
        }, n, this);
      }));
      function e(n) {
        return t.apply(this, arguments);
      }
      return e;
    }()
  }]), r;
}(), Ohe = /* @__PURE__ */ function() {
  function r(t, e) {
    Pt(this, r), this.engine = t, this.options = e, this.indexCount = void 0, this.buffer = void 0;
    var n = e, i = n.data;
    n.usage, n.type;
    var a = n.count;
    this.indexCount = a || 0, this.buffer = new Rf(t, {
      data: i instanceof Array ? new Uint16Array(i) : i,
      usage: ut.BufferUsage.Index | ut.BufferUsage.CopyDst
    });
  }
  return Wt(r, [{
    key: "get",
    value: function() {
      return this.buffer;
    }
  }, {
    key: "subData",
    value: function(e) {
      this.buffer.subData(e);
    }
  }, {
    key: "destroy",
    value: function() {
      this.buffer.destroy();
    }
  }]), r;
}(), Dhe = /* @__PURE__ */ function() {
  function r(t, e) {
    Pt(this, r), this.engine = t, this.options = e, this.colorTexture = void 0, this.depthTexture = void 0, this.width = 0, this.height = 0;
    var n = e;
    n.width, n.height;
    var i = n.color;
    n.colors;
    var a = n.depth;
    n.stencil, i && (this.colorTexture = i), a && (this.depthTexture = a);
  }
  return Wt(r, [{
    key: "get",
    value: function() {
      var e, n;
      return {
        color: (e = this.colorTexture) === null || e === void 0 ? void 0 : e.get(),
        depth: (n = this.depthTexture) === null || n === void 0 ? void 0 : n.get()
      };
    }
  }, {
    key: "destroy",
    value: function() {
      var e, n;
      (e = this.colorTexture) === null || e === void 0 || e.destroy(), (n = this.depthTexture) === null || n === void 0 || n.destroy();
    }
  }, {
    key: "resize",
    value: function(e) {
      var n = e.width, i = e.height;
      if (n !== this.width || i !== this.height) {
        var a, o;
        (a = this.colorTexture) === null || a === void 0 || a.resize({
          width: n,
          height: i
        }), (o = this.depthTexture) === null || o === void 0 || o.resize({
          width: n,
          height: i
        });
      }
      this.width = n, this.height = i;
    }
  }]), r;
}(), oo, ba, Vs, Qn, ff, Yd, $l, khe = (oo = {}, Ae(oo, he.POINTS, ut.PrimitiveTopology.PointList), Ae(oo, he.LINES, ut.PrimitiveTopology.LineList), Ae(oo, he.LINE_LOOP, ut.PrimitiveTopology.LineList), Ae(oo, he.LINE_STRIP, ut.PrimitiveTopology.LineStrip), Ae(oo, he.TRIANGLES, ut.PrimitiveTopology.TriangleList), Ae(oo, he.TRIANGLE_FAN, ut.PrimitiveTopology.TriangleList), Ae(oo, he.TRIANGLE_STRIP, ut.PrimitiveTopology.TriangleStrip), oo), Lhe = (ba = {}, Ae(ba, he.NEVER, ut.CompareFunction.Never), Ae(ba, he.ALWAYS, ut.CompareFunction.Always), Ae(ba, he.LESS, ut.CompareFunction.Less), Ae(ba, he.LEQUAL, ut.CompareFunction.LessEqual), Ae(ba, he.GREATER, ut.CompareFunction.Greater), Ae(ba, he.GEQUAL, ut.CompareFunction.GreaterEqual), Ae(ba, he.EQUAL, ut.CompareFunction.Equal), Ae(ba, he.NOTEQUAL, ut.CompareFunction.NotEqual), ba), _I = (Vs = {}, Ae(Vs, he.FUNC_ADD, ut.BlendOperation.Add), Ae(Vs, he.MIN_EXT, ut.BlendOperation.Min), Ae(Vs, he.MAX_EXT, ut.BlendOperation.Max), Ae(Vs, he.FUNC_SUBTRACT, ut.BlendOperation.Subtract), Ae(Vs, he.FUNC_REVERSE_SUBTRACT, ut.BlendOperation.ReverseSubtract), Vs), Hd = (Qn = {}, Ae(Qn, he.ZERO, ut.BlendFactor.Zero), Ae(Qn, he.ONE, ut.BlendFactor.One), Ae(Qn, he.SRC_COLOR, ut.BlendFactor.SrcColor), Ae(Qn, he.ONE_MINUS_SRC_COLOR, ut.BlendFactor.OneMinusSrcColor), Ae(Qn, he.SRC_ALPHA, ut.BlendFactor.SrcAlpha), Ae(Qn, he.ONE_MINUS_SRC_ALPHA, ut.BlendFactor.OneMinusSrcAlpha), Ae(Qn, he.DST_COLOR, ut.BlendFactor.DstColor), Ae(Qn, he.ONE_MINUS_DST_COLOR, ut.BlendFactor.OneMinusDstColor), Ae(Qn, he.DST_ALPHA, ut.BlendFactor.DstAlpha), Ae(Qn, he.ONE_MINUS_DST_ALPHA, ut.BlendFactor.OneMinusDstAlpha), Ae(Qn, he.CONSTANT_COLOR, ut.BlendFactor.BlendColor), Ae(Qn, he.ONE_MINUS_CONSTANT_COLOR, ut.BlendFactor.OneMinusBlendColor), Ae(Qn, he.SRC_ALPHA_SATURATE, ut.BlendFactor.SrcAlphaSaturated), Qn), Nhe = (ff = {}, Ae(ff, he.ALPHA, "r8unorm"), Ae(ff, he.RGBA, "rgba8unorm"), Ae(ff, he.DEPTH_COMPONENT, "depth32float"), Ae(ff, he.DEPTH_STENCIL, "depth24plus-stencil8"), ff), wI = (Yd = {}, Ae(Yd, he.NEAREST, "nearest"), Ae(Yd, he.LINEAR, "linear"), Yd), Ny = ($l = {}, Ae($l, he.REPEAT, "repeat"), Ae($l, he.CLAMP_TO_EDGE, "clamp-to-edge"), Ae($l, he.MIRRORED_REPEAT, "mirror-repeat"), $l);
function Rhe(r) {
  var t = r.cull;
  if (!t || !t.enable)
    return ut.CullMode.None;
  if (t.face)
    return t.face === he.FRONT ? ut.CullMode.Front : ut.CullMode.Back;
}
function Bhe(r) {
  var t = r.depth;
  r.stencil;
  var e = {
    compare: ut.CompareFunction.Always,
    depthFailOp: ut.StencilOperation.Keep,
    failOp: ut.StencilOperation.Keep,
    passOp: ut.StencilOperation.Keep
  };
  return {
    depthWriteEnabled: t && t.enable,
    depthCompare: Lhe[(t == null ? void 0 : t.func) || he.ALWAYS],
    format: ut.TextureFormat.Depth24PlusStencil8,
    stencilFront: e,
    stencilBack: e,
    stencilReadMask: 4294967295,
    stencilWriteMask: 4294967295
  };
}
function Ghe(r, t) {
  var e = r.blend;
  return [{
    format: t,
    alphaBlend: {
      srcFactor: Hd[e && e.func && e.func.srcAlpha || he.ONE],
      dstFactor: Hd[e && e.func && e.func.dstAlpha || he.ZERO],
      operation: _I[e && e.equation && e.equation.alpha || he.FUNC_ADD]
    },
    colorBlend: {
      srcFactor: Hd[e && e.func && e.func.srcRGB || he.ONE],
      dstFactor: Hd[e && e.func && e.func.dstRGB || he.ZERO],
      operation: _I[e && e.equation && e.equation.rgb || he.FUNC_ADD]
    },
    writeMask: ut.ColorWrite.All
  }];
}
function EI(r, t) {
  var e = Object.keys(r);
  if (Object.getOwnPropertySymbols) {
    var n = Object.getOwnPropertySymbols(r);
    t && (n = n.filter(function(i) {
      return Object.getOwnPropertyDescriptor(r, i).enumerable;
    })), e.push.apply(e, n);
  }
  return e;
}
function lf(r) {
  for (var t = 1; t < arguments.length; t++) {
    var e = arguments[t] != null ? arguments[t] : {};
    t % 2 ? EI(Object(e), !0).forEach(function(n) {
      Ae(r, n, e[n]);
    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(r, Object.getOwnPropertyDescriptors(e)) : EI(Object(e)).forEach(function(n) {
      Object.defineProperty(r, n, Object.getOwnPropertyDescriptor(e, n));
    });
  }
  return r;
}
function Fhe(r) {
  for (var t = 0, e = arguments.length, n = new Array(e > 1 ? e - 1 : 0), i = 1; i < e; i++)
    n[i - 1] = arguments[i];
  for (var a = 0, o = n; a < o.length; a++) {
    var s = o[a];
    t += s.length;
  }
  for (var u = new r(t), f = 0, l = 0, c = n; l < c.length; l++) {
    var h = c[l];
    u.set(h, f), f += h.length;
  }
  return u;
}
var zhe = /* @__PURE__ */ function() {
  function r(t, e) {
    Pt(this, r), this.engine = t, this.options = e, this.pipelineLayout = void 0, this.renderPipeline = void 0, this.uniformsBindGroupLayout = void 0, this.uniformBindGroup = void 0, this.uniformBuffer = void 0, this.uniforms = {}, this.uniformGPUBufferLayout = [], this.attributeCache = {}, this.indexBuffer = void 0, this.indexCount = void 0;
  }
  return Wt(r, [{
    key: "init",
    value: function() {
      var t = Er(/* @__PURE__ */ St.mark(function n() {
        var i = this, a, o, s, u, f, l, c, h, d, v, p, g, y, b, m, x;
        return St.wrap(function(w) {
          for (; ; )
            switch (w.prev = w.next) {
              case 0:
                return a = this.options, o = a.vs, s = a.fs, u = a.attributes, f = a.uniforms, l = a.primitive, a.count, c = a.elements, h = a.depth, d = a.blend, v = a.stencil, p = a.cull, a.instances, w.next = 3, this.compilePipelineStageDescriptor(o, s, null);
              case 3:
                g = w.sent, y = g.vertexStage, b = g.fragmentStage, f && this.buildUniformBindGroup(f), c && (this.indexBuffer = c.get(), this.indexCount = c.indexCount), m = {
                  vertexBuffers: Object.keys(u).map(function(E, M) {
                    var C = u[E], S = C.get(), A = S.arrayStride, T = S.stepMode, P = S.attributes;
                    return i.attributeCache[E] = C, {
                      arrayStride: A,
                      stepMode: T,
                      attributes: P
                    };
                  })
                }, x = {
                  sampleCount: this.engine.mainPassSampleCount,
                  primitiveTopology: khe[l || he.TRIANGLES],
                  rasterizationState: lf(lf({}, this.getDefaultRasterizationStateDescriptor()), {}, {
                    cullMode: Rhe({
                      cull: p
                    })
                  }),
                  depthStencilState: Bhe({
                    depth: h,
                    stencil: v
                  }),
                  colorStates: Ghe({
                    blend: d
                  }, this.engine.options.swapChainFormat),
                  layout: this.pipelineLayout,
                  vertexStage: y,
                  fragmentStage: b,
                  vertexState: m
                }, this.renderPipeline = this.engine.device.createRenderPipeline(x);
              case 11:
              case "end":
                return w.stop();
            }
        }, n, this);
      }));
      function e() {
        return t.apply(this, arguments);
      }
      return e;
    }()
  }, {
    key: "addUniforms",
    value: function(e) {
      this.uniforms = lf(lf({}, this.uniforms), xc(e));
    }
  }, {
    key: "draw",
    value: function(e) {
      var n = this, i = this.engine.getCurrentRenderPass(), a = lf(lf({}, this.uniforms), xc(e.uniforms || {})), o = [];
      Object.keys(a).forEach(function(s) {
        var u = To(a[s]);
        if (u === "boolean" || u === "number" || Array.isArray(a[s]) || a[s].BYTES_PER_ELEMENT) {
          var f, l = (f = n.uniformGPUBufferLayout.find(function(y) {
            var b = y.name;
            return b === s;
          })) === null || f === void 0 ? void 0 : f.offset;
          l !== null && n.uniformBuffer.subData({
            data: a[s],
            offset: l
          });
        } else {
          var c, h = (c = n.uniformGPUBufferLayout.find(function(y) {
            var b = y.name;
            return b === s;
          })) === null || c === void 0 ? void 0 : c.offset;
          if (h !== null) {
            var d = a[s].get(), v = d.color || d, p = v.texture, g = v.sampler;
            g && (o.push({
              binding: h,
              resource: g
            }), h++), o.push({
              binding: h,
              resource: p.createView()
            });
          }
        }
      }), this.uniformBuffer && (o[0] = {
        binding: 0,
        resource: {
          buffer: this.uniformBuffer.get()
        }
      }), this.uniformBindGroup = this.engine.device.createBindGroup({
        layout: this.uniformsBindGroupLayout,
        entries: o
      }), this.renderPipeline && i.setPipeline(this.renderPipeline), i.setBindGroup(0, this.uniformBindGroup), this.indexBuffer && i.setIndexBuffer(this.indexBuffer.get(), ut.IndexFormat.Uint32, 0), Object.keys(this.attributeCache).forEach(function(s, u) {
        i.setVertexBuffer(0 + u, n.attributeCache[s].get().buffer, 0);
      }), this.indexBuffer ? i.drawIndexed(this.indexCount, this.options.instances || 1, 0, 0, 0) : i.draw(this.options.count || 0, this.options.instances || 0, 0, 0);
    }
  }, {
    key: "destroy",
    value: function() {
      throw new Error("Method not implemented.");
    }
  }, {
    key: "compilePipelineStageDescriptor",
    value: function() {
      var t = Er(/* @__PURE__ */ St.mark(function n(i, a, o) {
        var s, u, f;
        return St.wrap(function(c) {
          for (; ; )
            switch (c.prev = c.next) {
              case 0:
                if (s = `#version 450
`, u = i, f = a, this.engine.options.useWGSL) {
                  c.next = 10;
                  break;
                }
                return c.next = 6, this.compileShaderToSpirV(i, "vertex", s);
              case 6:
                return u = c.sent, c.next = 9, this.compileShaderToSpirV(a, "fragment", s);
              case 9:
                f = c.sent;
              case 10:
                return c.abrupt("return", this.createPipelineStageDescriptor(u, f));
              case 11:
              case "end":
                return c.stop();
            }
        }, n, this);
      }));
      function e(n, i, a) {
        return t.apply(this, arguments);
      }
      return e;
    }()
  }, {
    key: "compileShaderToSpirV",
    value: function(e, n, i) {
      return this.compileRawShaderToSpirV(i + e, n);
    }
  }, {
    key: "compileRawShaderToSpirV",
    value: function(e, n) {
      return this.engine.glslang.compileGLSL(e, n);
    }
  }, {
    key: "createPipelineStageDescriptor",
    value: function(e, n) {
      return {
        vertexStage: {
          module: this.engine.device.createShaderModule({
            code: e,
            isWHLSL: ai
          }),
          entryPoint: "main"
        },
        fragmentStage: {
          module: this.engine.device.createShaderModule({
            code: n,
            isWHLSL: ai
          }),
          entryPoint: "main"
        }
      };
    }
  }, {
    key: "getDefaultRasterizationStateDescriptor",
    value: function() {
      return {
        frontFace: ut.FrontFace.CCW,
        cullMode: ut.CullMode.None,
        depthBias: 0,
        depthBiasSlopeScale: 0,
        depthBiasClamp: 0
      };
    }
  }, {
    key: "buildUniformBindGroup",
    value: function(e) {
      var n = this, i = 0, a = Fhe.apply(void 0, [Float32Array].concat(cn(Object.keys(e).map(function(u) {
        return e[u] ? (n.uniformGPUBufferLayout.push({
          name: u,
          offset: i
        }), i += (e[u].length || 1) * 4, e[u]) : [];
      })))), o = [], s = !1;
      a.length && (s = !0, o.push({
        binding: 0,
        visibility: ut.ShaderStage.Fragment | ut.ShaderStage.Vertex,
        type: ut.BindingType.UniformBuffer
      })), Object.keys(e).filter(function(u) {
        return e[u] === null;
      }).forEach(function(u, f) {
        n.uniformGPUBufferLayout.push({
          name: u,
          offset: f * 2 + (s ? 1 : 0)
        }), o.push({
          binding: f * 2 + (s ? 1 : 0),
          visibility: ut.ShaderStage.Fragment,
          type: ut.BindingType.Sampler
        }, {
          binding: f * 2 + (s ? 1 : 0) + 1,
          visibility: ut.ShaderStage.Fragment,
          type: ut.BindingType.SampledTexture
        });
      }), this.uniformsBindGroupLayout = this.engine.device.createBindGroupLayout({
        entries: o
      }), this.pipelineLayout = this.engine.device.createPipelineLayout({
        bindGroupLayouts: [this.uniformsBindGroupLayout]
      }), s && (this.uniformBuffer = new Rf(this.engine, {
        data: a instanceof Array ? new Float32Array(a) : a,
        usage: ut.BufferUsage.Uniform | ut.BufferUsage.CopyDst
      }));
    }
  }]), r;
}(), Uhe = /* @__PURE__ */ function() {
  function r(t, e) {
    Pt(this, r), this.engine = t, this.options = e, this.texture = void 0, this.sampler = void 0, this.width = void 0, this.height = void 0, this.createTexture();
  }
  return Wt(r, [{
    key: "get",
    value: function() {
      return {
        texture: this.texture,
        sampler: this.sampler
      };
    }
  }, {
    key: "update",
    value: function() {
    }
  }, {
    key: "resize",
    value: function(e) {
      var n = e.width, i = e.height;
      (n !== this.width || i !== this.height) && (this.destroy(), this.createTexture()), this.width = n, this.height = i;
    }
  }, {
    key: "destroy",
    value: function() {
      this.texture && this.texture.destroy();
    }
  }, {
    key: "createTexture",
    value: function() {
      var e = this.options;
      e.data;
      var n = e.type;
      n === void 0 && he.UNSIGNED_BYTE;
      var i = e.width, a = e.height;
      e.flipY;
      var o = e.format, s = o === void 0 ? he.RGBA : o;
      e.mipmap;
      var u = e.wrapS, f = u === void 0 ? he.CLAMP_TO_EDGE : u, l = e.wrapT, c = l === void 0 ? he.CLAMP_TO_EDGE : l, h = e.aniso, d = h === void 0 ? 0 : h;
      e.alignment, e.premultiplyAlpha;
      var v = e.mag, p = v === void 0 ? he.NEAREST : v, g = e.min, y = g === void 0 ? he.NEAREST : g, b = e.colorSpace;
      b === void 0 && he.BROWSER_DEFAULT_WEBGL;
      var m = e.usage;
      this.width = i, this.height = a, this.texture = this.engine.device.createTexture({
        size: [i, a, 1],
        mipLevelCount: 1,
        sampleCount: 1,
        dimension: ut.TextureDimension.E2d,
        format: Nhe[s],
        usage: m || ut.TextureUsage.Sampled | ut.TextureUsage.CopyDst
      }), (!m || m & ut.TextureUsage.Sampled) && (this.sampler = this.engine.device.createSampler({
        addressModeU: Ny[f],
        addressModeV: Ny[c],
        addressModeW: Ny[f],
        magFilter: wI[p],
        minFilter: wI[y],
        maxAnisotropy: d
      }));
    }
  }]), r;
}(), SI, MI, CI, jhe = (SI = Mr(), SI(MI = (CI = /* @__PURE__ */ function() {
  function r() {
    var t = this;
    Pt(this, r), this.supportWebGPU = !0, this.useWGSL = !1, this.options = void 0, this.canvas = void 0, this.context = void 0, this.glslang = void 0, this.adapter = void 0, this.device = void 0, this.swapChain = void 0, this.mainPassSampleCount = void 0, this.mainTexture = void 0, this.depthTexture = void 0, this.mainColorAttachments = void 0, this.mainTextureExtends = void 0, this.mainDepthAttachment = void 0, this.uploadEncoder = void 0, this.renderEncoder = void 0, this.computeEncoder = void 0, this.renderTargetEncoder = void 0, this.commandBuffers = new Array(4).fill(void 0), this.currentRenderPass = null, this.mainRenderPass = null, this.currentRenderTargetViewDescriptor = void 0, this.currentComputePass = null, this.bundleEncoder = void 0, this.tempBuffers = [], this.currentRenderTarget = null, this.uploadEncoderDescriptor = {
      label: "upload"
    }, this.renderEncoderDescriptor = {
      label: "render"
    }, this.renderTargetEncoderDescriptor = {
      label: "renderTarget"
    }, this.computeEncoderDescriptor = {
      label: "compute"
    }, this.pipelines = {}, this.computePipelines = {}, this.defaultSampleCount = 4, this.clearDepthValue = 1, this.clearStencilValue = 0, this.transientViewport = {
      x: 1 / 0,
      y: 0,
      width: 0,
      height: 0
    }, this.cachedViewport = {
      x: 0,
      y: 0,
      width: 0,
      height: 0
    }, this.clear = function(e) {
      e.framebuffer;
      var n = e.color, i = e.depth, a = e.stencil;
      t.options.supportCompute && t.startComputePass(), t.currentRenderTarget ? (t.currentRenderPass && t.endRenderTargetRenderPass(), t.startRenderTargetRenderPass(t.currentRenderTarget, n || null, !!i, !!a)) : (t.mainColorAttachments[0].loadValue = n || ut.LoadOp.Load, t.mainDepthAttachment.depthLoadValue = i || ut.LoadOp.Load, t.mainDepthAttachment.stencilLoadValue = a ? t.clearStencilValue : ut.LoadOp.Load, t.mainRenderPass && t.endMainRenderPass(), t.startMainRenderPass());
    }, this.createModel = /* @__PURE__ */ function() {
      var e = Er(/* @__PURE__ */ St.mark(function n(i) {
        var a;
        return St.wrap(function(s) {
          for (; ; )
            switch (s.prev = s.next) {
              case 0:
                return a = new zhe(t, i), s.next = 3, a.init();
              case 3:
                return s.abrupt("return", a);
              case 4:
              case "end":
                return s.stop();
            }
        }, n);
      }));
      return function(n) {
        return e.apply(this, arguments);
      };
    }(), this.createAttribute = function(e) {
      return new Ahe(t, e);
    }, this.createBuffer = function(e) {
      return new Rf(t, e);
    }, this.createElements = function(e) {
      return new Ohe(t, e);
    }, this.createTexture2D = function(e) {
      return new Uhe(t, e);
    }, this.createFramebuffer = function(e) {
      return new Dhe(t, e);
    }, this.useFramebuffer = function(e, n) {
      t.currentRenderTarget && t.unbindFramebuffer(t.currentRenderTarget), t.currentRenderTarget = e, t.currentRenderTargetViewDescriptor = {
        dimension: ut.TextureViewDimension.E2d,
        arrayLayerCount: 1,
        aspect: ut.TextureAspect.All
      }, t.currentRenderPass = null, n();
    }, this.createComputeModel = /* @__PURE__ */ function() {
      var e = Er(/* @__PURE__ */ St.mark(function n(i) {
        var a;
        return St.wrap(function(s) {
          for (; ; )
            switch (s.prev = s.next) {
              case 0:
                return a = new Phe(t, i), s.next = 3, a.init();
              case 3:
                return s.abrupt("return", a);
              case 4:
              case "end":
                return s.stop();
            }
        }, n);
      }));
      return function(n) {
        return e.apply(this, arguments);
      };
    }(), this.getCanvas = function() {
      return t.canvas;
    }, this.getGLContext = function() {
      throw new Error("Method not implemented.");
    }, this.viewport = function(e) {
      var n = e.x, i = e.y, a = e.width, o = e.height;
      if (!t.currentRenderPass)
        t.transientViewport = {
          x: n,
          y: i,
          width: a,
          height: o
        };
      else if (t.transientViewport.x !== 1 / 0) {
        var s = t.getCurrentRenderPass();
        s.setViewport(t.transientViewport.x, t.transientViewport.y, t.transientViewport.width, t.transientViewport.height, 0, 1);
      } else if (n !== t.cachedViewport.x || i !== t.cachedViewport.y || a !== t.cachedViewport.width || o !== t.cachedViewport.height) {
        t.cachedViewport = {
          x: n,
          y: i,
          width: a,
          height: o
        };
        var u = t.getCurrentRenderPass();
        u.setViewport(n, i, a, o, 0, 1);
      }
    }, this.readPixels = function(e) {
      throw new Error("Method not implemented.");
    };
  }
  return Wt(r, [{
    key: "isFloatSupported",
    value: function() {
      return !0;
    }
  }, {
    key: "init",
    value: function() {
      var t = Er(/* @__PURE__ */ St.mark(function n(i) {
        return St.wrap(function(o) {
          for (; ; )
            switch (o.prev = o.next) {
              case 0:
                return this.canvas = i.canvas, this.options = i, this.useWGSL = !!i.useWGSL, this.mainPassSampleCount = i.antialiasing ? this.defaultSampleCount : 1, o.next = 6, this.initGlslang();
              case 6:
                this.initContextAndSwapChain(), this.initMainAttachments();
              case 8:
              case "end":
                return o.stop();
            }
        }, n, this);
      }));
      function e(n) {
        return t.apply(this, arguments);
      }
      return e;
    }()
  }, {
    key: "setScissor",
    value: function(e) {
      throw new Error("Method not implemented.");
    }
  }, {
    key: "destroy",
    value: function() {
      this.mainTexture && this.mainTexture.destroy(), this.depthTexture && this.depthTexture.destroy(), this.tempBuffers.forEach(function(e) {
        return e.destroy();
      }), this.tempBuffers = [];
    }
  }, {
    key: "beginFrame",
    value: function() {
      this.uploadEncoder = this.device.createCommandEncoder(this.uploadEncoderDescriptor), this.renderEncoder = this.device.createCommandEncoder(this.renderEncoderDescriptor), this.renderTargetEncoder = this.device.createCommandEncoder(this.renderTargetEncoderDescriptor), this.options.supportCompute && (this.computeEncoder = this.device.createCommandEncoder(this.computeEncoderDescriptor));
    }
  }, {
    key: "endFrame",
    value: function() {
      this.options.supportCompute && this.endComputePass(), this.endMainRenderPass(), this.commandBuffers[0] = this.uploadEncoder.finish(), this.commandBuffers[1] = this.renderEncoder.finish(), this.options.supportCompute && (this.commandBuffers[2] = this.computeEncoder.finish()), this.commandBuffers[3] = this.renderTargetEncoder.finish(), ai ? this.device.getQueue().submit(this.commandBuffers.filter(function(e) {
        return e;
      })) : this.device.defaultQueue.submit(this.commandBuffers.filter(function(e) {
        return e;
      }));
    }
  }, {
    key: "getCurrentRenderPass",
    value: function() {
      return this.currentRenderTarget && !this.currentRenderPass ? this.startRenderTargetRenderPass(this.currentRenderTarget, null, !1, !1) : this.currentRenderPass || this.startMainRenderPass(), this.currentRenderPass;
    }
  }, {
    key: "initGlslang",
    value: function() {
      var t = Er(/* @__PURE__ */ St.mark(function n() {
        var i, a;
        return St.wrap(function(s) {
          for (; ; )
            switch (s.prev = s.next) {
              case 0:
                return s.next = 2, The();
              case 2:
                return this.glslang = s.sent, s.next = 5, (i = navigator) === null || i === void 0 || (a = i.gpu) === null || a === void 0 ? void 0 : a.requestAdapter();
              case 5:
                return this.adapter = s.sent, s.next = 8, this.adapter.requestDevice();
              case 8:
                this.device = s.sent;
              case 9:
              case "end":
                return s.stop();
            }
        }, n, this);
      }));
      function e() {
        return t.apply(this, arguments);
      }
      return e;
    }()
  }, {
    key: "initContextAndSwapChain",
    value: function() {
      this.context = this.canvas.getContext(ai ? "gpu" : "gpupresent"), this.swapChain = this.context.configureSwapChain({
        device: this.device,
        format: this.options.swapChainFormat,
        usage: ut.TextureUsage.OutputAttachment | ut.TextureUsage.CopySrc
      });
    }
  }, {
    key: "initMainAttachments",
    value: function() {
      if (this.mainTextureExtends = {
        width: this.canvas.width,
        height: this.canvas.height,
        depth: 1
      }, this.options.antialiasing) {
        var e = {
          size: this.mainTextureExtends,
          mipLevelCount: 1,
          sampleCount: this.mainPassSampleCount,
          dimension: ut.TextureDimension.E2d,
          format: ut.TextureFormat.BGRA8Unorm,
          usage: ut.TextureUsage.OutputAttachment
        };
        this.mainTexture && this.mainTexture.destroy(), this.mainTexture = this.device.createTexture(e), this.mainColorAttachments = [{
          attachment: ai ? this.mainTexture.createDefaultView() : this.mainTexture.createView(),
          loadValue: [0, 0, 0, 1],
          storeOp: ut.StoreOp.Store
        }];
      } else
        this.mainColorAttachments = [{
          attachment: ai ? this.swapChain.getCurrentTexture().createDefaultView() : this.swapChain.getCurrentTexture().createView(),
          loadValue: [0, 0, 0, 1],
          storeOp: ut.StoreOp.Store
        }];
      var n = {
        size: this.mainTextureExtends,
        mipLevelCount: 1,
        sampleCount: this.mainPassSampleCount,
        dimension: ut.TextureDimension.E2d,
        format: ai ? "depth32float-stencil8" : ut.TextureFormat.Depth24PlusStencil8,
        usage: ut.TextureUsage.OutputAttachment
      };
      this.depthTexture && this.depthTexture.destroy(), this.depthTexture = this.device.createTexture(
        n
      ), this.mainDepthAttachment = {
        attachment: ai ? this.depthTexture.createDefaultView() : this.depthTexture.createView(),
        depthLoadValue: this.clearDepthValue,
        depthStoreOp: ut.StoreOp.Store,
        stencilLoadValue: this.clearStencilValue,
        stencilStoreOp: ut.StoreOp.Store
      };
    }
  }, {
    key: "startComputePass",
    value: function() {
      this.currentComputePass && this.endComputePass(), this.currentComputePass = this.computeEncoder.beginComputePass();
    }
  }, {
    key: "startMainRenderPass",
    value: function() {
      this.currentRenderPass && !this.currentRenderTarget && this.endMainRenderPass(), this.options.antialiasing ? this.mainColorAttachments[0].resolveTarget = ai ? this.swapChain.getCurrentTexture().createDefaultView() : this.swapChain.getCurrentTexture().createView() : this.mainColorAttachments[0].attachment = ai ? this.swapChain.getCurrentTexture().createDefaultView() : this.swapChain.getCurrentTexture().createView(), this.currentRenderPass = this.renderEncoder.beginRenderPass({
        colorAttachments: this.mainColorAttachments,
        depthStencilAttachment: this.mainDepthAttachment
      }), this.mainRenderPass = this.currentRenderPass, this.cachedViewport && this.viewport(this.cachedViewport);
    }
  }, {
    key: "startRenderTargetRenderPass",
    value: function(e, n, i) {
      var a, o, s = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : !1, u = (a = e.get().color) === null || a === void 0 ? void 0 : a.texture, f;
      u && (f = u.createView(this.currentRenderTargetViewDescriptor));
      var l = (o = e.get().depth) === null || o === void 0 ? void 0 : o.texture, c;
      l && (c = l.createView());
      var h = this.renderTargetEncoder.beginRenderPass({
        colorAttachments: [{
          attachment: f,
          loadValue: n !== null ? n : ut.LoadOp.Load,
          storeOp: ut.StoreOp.Store
        }],
        depthStencilAttachment: l && c ? {
          attachment: c,
          depthLoadValue: i ? this.clearDepthValue : ut.LoadOp.Load,
          depthStoreOp: ut.StoreOp.Store,
          stencilLoadValue: s ? this.clearStencilValue : ut.LoadOp.Load,
          stencilStoreOp: ut.StoreOp.Store
        } : void 0
      });
      this.currentRenderPass = h, this.cachedViewport && this.viewport(this.cachedViewport);
    }
  }, {
    key: "endMainRenderPass",
    value: function() {
      this.currentRenderPass === this.mainRenderPass && this.currentRenderPass !== null && (this.currentRenderPass.endPass(), this.resetCachedViewport(), this.currentRenderPass = null, this.mainRenderPass = null);
    }
  }, {
    key: "endComputePass",
    value: function() {
      this.currentComputePass && (this.currentComputePass.endPass(), this.currentComputePass = null);
    }
  }, {
    key: "endRenderTargetRenderPass",
    value: function() {
      this.currentRenderPass && (this.currentRenderPass.endPass(), this.resetCachedViewport());
    }
  }, {
    key: "resetCachedViewport",
    value: function() {
      this.cachedViewport = {
        x: 0,
        y: 0,
        width: 0,
        height: 0
      };
    }
  }, {
    key: "unbindFramebuffer",
    value: function(e) {
      this.currentRenderPass && this.currentRenderPass !== this.mainRenderPass && this.endRenderTargetRenderPass(), this.transientViewport.x = 1 / 0, this.currentRenderTarget = null, this.currentRenderPass = this.mainRenderPass;
    }
  }]), r;
}(), CI)) || MI), TI, AI;
function $he(r) {
  var t = Whe();
  return function() {
    var n = Sr(r), i;
    if (t) {
      var a = Sr(this).constructor;
      i = Reflect.construct(n, arguments, a);
    } else
      i = n.apply(this, arguments);
    return Kn(this, i);
  };
}
function Whe() {
  if (typeof Reflect > "u" || !Reflect.construct || Reflect.construct.sham)
    return !1;
  if (typeof Proxy == "function")
    return !0;
  try {
    return Date.prototype.toString.call(Reflect.construct(Date, [], function() {
    })), !0;
  } catch {
    return !1;
  }
}
var M1 = 4 / 64, II = 1 - M1 * 2, Vhe = (TI = Mr(), TI(AI = /* @__PURE__ */ function(r) {
  Hn(e, r);
  var t = $he(e);
  function e() {
    return Pt(this, e), t.apply(this, arguments);
  }
  return Wt(e, [{
    key: "onEntityCreated",
    value: function() {
      var i = this.config, a = i.widthSegments, o = a === void 0 ? 1 : a, s = i.heightSegments, u = s === void 0 ? 1 : s, f = i.depthSegments, l = f === void 0 ? 1 : f, c = i.halfExtents, h = c === void 0 ? rr(0.5, 0.5, 0.5) : c, d = o, v = u, p = l, g = xg(h, 3), y = g[0], b = g[1], m = g[2], x = [rr(-y, -b, m), rr(y, -b, m), rr(y, b, m), rr(-y, b, m), rr(y, -b, -m), rr(-y, -b, -m), rr(-y, b, -m), rr(y, b, -m)], _ = [
        [0, 1, 3],
        [4, 5, 7],
        [3, 2, 6],
        [1, 0, 4],
        [1, 4, 2],
        [5, 0, 6]
      ], w = [
        [0, 0, 1],
        [0, 0, -1],
        [0, 1, 0],
        [0, -1, 0],
        [1, 0, 0],
        [-1, 0, 0]
      ], E = {
        FRONT: 0,
        BACK: 1,
        TOP: 2,
        BOTTOM: 3,
        RIGHT: 4,
        LEFT: 5
      }, M = [], C = [], S = [], A = [], T = 0, P = function(D, G, R) {
        var F, q, ne, oe;
        for (ne = 0; ne <= G; ne++)
          for (oe = 0; oe <= R; oe++) {
            var ie = Tr(), Ee = Tr(), Xe = Tr(), le = Tr();
            cs(ie, x[_[D][0]], x[_[D][1]], ne / G), cs(Ee, x[_[D][0]], x[_[D][2]], oe / R), zv(Xe, Ee, x[_[D][0]]), Ia(le, ie, Xe), F = ne / G, q = oe / R, M.push(le[0], le[1], le[2]), C.push(w[D][0], w[D][1], w[D][2]), S.push(F, q), F /= 3, q /= 3, F = F * II + M1, q = q * II + M1, F += D % 3 / 3, q += Math.floor(D / 3) / 3, ne < G && oe < R && (A.push(T + R + 1, T + 1, T), A.push(T + R + 1, T + R + 2, T + 1)), T++;
          }
      };
      P(E.FRONT, d, v), P(E.BACK, d, v), P(E.TOP, d, p), P(E.BOTTOM, d, p), P(E.RIGHT, p, v), P(E.LEFT, p, v);
      var k = Yx(M), L = this.getComponent();
      L.indices = Uint32Array.from(A), L.aabb = k, L.vertexCount = T, L.attributes = [{
        dirty: !0,
        name: "position",
        data: Float32Array.from(M),
        arrayStride: 4 * 3,
        stepMode: "vertex",
        attributes: [{
          shaderLocation: 0,
          offset: 0,
          format: "float3"
        }]
      }, {
        dirty: !0,
        name: "normal",
        data: Float32Array.from(C),
        arrayStride: 4 * 3,
        stepMode: "vertex",
        attributes: [{
          shaderLocation: 1,
          offset: 0,
          format: "float3"
        }]
      }, {
        dirty: !0,
        name: "uv",
        data: Float32Array.from(S),
        arrayStride: 4 * 2,
        stepMode: "vertex",
        attributes: [{
          shaderLocation: 2,
          offset: 0,
          format: "float2"
        }]
      }];
    }
  }]), e;
}(bo)) || AI);
function Xhe(r, t) {
  if (!r && !t)
    throw new Error("Please specify valid arguments for parameters a and b.");
  if (!t || t.length === 0)
    return r;
  if (!r || r.length === 0)
    return t;
  if (Object.prototype.toString.call(r) !== Object.prototype.toString.call(t))
    throw new Error("The types of the two arguments passed for parameters a and b do not match.");
  var e = new r.constructor(r.length + t.length);
  return e.set(r), e.set(t, r.length), e;
}
var PI, OI;
function Yhe(r) {
  var t = Hhe();
  return function() {
    var n = Sr(r), i;
    if (t) {
      var a = Sr(this).constructor;
      i = Reflect.construct(n, arguments, a);
    } else
      i = n.apply(this, arguments);
    return Kn(this, i);
  };
}
function Hhe() {
  if (typeof Reflect > "u" || !Reflect.construct || Reflect.construct.sham)
    return !1;
  if (typeof Proxy == "function")
    return !0;
  try {
    return Date.prototype.toString.call(Reflect.construct(Date, [], function() {
    })), !0;
  } catch {
    return !1;
  }
}
var Khe = (PI = Mr(), PI(OI = /* @__PURE__ */ function(r) {
  Hn(e, r);
  var t = Yhe(e);
  function e() {
    return Pt(this, e), t.apply(this, arguments);
  }
  return Wt(e, [{
    key: "onEntityCreated",
    value: function() {
      var i = this.config.geometries, a = i === void 0 ? [] : i, o = this.getComponent();
      o.aabb = new Xx();
      var s = [], u = [], f = 0;
      a.forEach(function(l) {
        var c = l.aabb, h = l.indices, d = l.vertexCount, v = l.attributes;
        o.aabb.add(c), o.vertexCount += d, h && u.push.apply(u, cn(h.map(function(p) {
          return p + f;
        }))), f += d, v.forEach(function(p, g) {
          s[g] ? p.data && (Hx(p.data) ? s[g].push(p.data) : y5(p.data) ? s[g].data = Xhe(
            s[g].data,
            p.data
          ) : s[g].data = s[g].data.concat(p.data)) : (s[g] = p, s[g].dirty = !0);
        });
      }), o.attributes = s, o.indices = Uint32Array.from(u), o.dirty = !0;
    }
  }]), e;
}(bo)) || OI), DI, kI;
function qhe(r) {
  var t = Zhe();
  return function() {
    var n = Sr(r), i;
    if (t) {
      var a = Sr(this).constructor;
      i = Reflect.construct(n, arguments, a);
    } else
      i = n.apply(this, arguments);
    return Kn(this, i);
  };
}
function Zhe() {
  if (typeof Reflect > "u" || !Reflect.construct || Reflect.construct.sham)
    return !1;
  if (typeof Proxy == "function")
    return !0;
  try {
    return Date.prototype.toString.call(Reflect.construct(Date, [], function() {
    })), !0;
  } catch {
    return !1;
  }
}
var Qhe = (DI = Mr(), DI(kI = /* @__PURE__ */ function(r) {
  Hn(e, r);
  var t = qhe(e);
  function e() {
    return Pt(this, e), t.apply(this, arguments);
  }
  return Wt(e, [{
    key: "onEntityCreated",
    value: function() {
      for (var i = this.config, a = i.halfExtents, o = a === void 0 ? [0.5, 0.5] : a, s = i.widthSegments, u = s === void 0 ? 5 : s, f = i.lengthSegments, l = f === void 0 ? 5 : f, c = [], h = [], d = [], v = [], p = 0, g = 0; g <= u; g++)
        for (var y = 0; y <= l; y++) {
          var b = -o[0] + 2 * o[0] * g / u, m = 0, x = -(-o[1] + 2 * o[1] * y / l), _ = g / u, w = y / l;
          c.push(b, m, x), h.push(0, 1, 0), d.push(_, w), g < u && y < l && (v.push(p + l + 1, p + 1, p), v.push(p + l + 1, p + l + 2, p + 1)), p++;
        }
      var E = Yx(c), M = this.getComponent();
      M.indices = Uint32Array.from(v), M.aabb = E, M.vertexCount = p, M.attributes = [{
        dirty: !0,
        name: "position",
        data: Float32Array.from(c),
        arrayStride: 4 * 3,
        stepMode: "vertex",
        attributes: [{
          shaderLocation: 0,
          offset: 0,
          format: "float3"
        }]
      }, {
        dirty: !0,
        name: "normal",
        data: Float32Array.from(h),
        arrayStride: 4 * 3,
        stepMode: "vertex",
        attributes: [{
          shaderLocation: 1,
          offset: 0,
          format: "float3"
        }]
      }, {
        dirty: !0,
        name: "uv",
        data: Float32Array.from(d),
        arrayStride: 4 * 2,
        stepMode: "vertex",
        attributes: [{
          shaderLocation: 2,
          offset: 0,
          format: "float2"
        }]
      }];
    }
  }]), e;
}(bo)) || kI), LI, NI;
function Jhe(r) {
  var t = ede();
  return function() {
    var n = Sr(r), i;
    if (t) {
      var a = Sr(this).constructor;
      i = Reflect.construct(n, arguments, a);
    } else
      i = n.apply(this, arguments);
    return Kn(this, i);
  };
}
function ede() {
  if (typeof Reflect > "u" || !Reflect.construct || Reflect.construct.sham)
    return !1;
  if (typeof Proxy == "function")
    return !0;
  try {
    return Date.prototype.toString.call(Reflect.construct(Date, [], function() {
    })), !0;
  } catch {
    return !1;
  }
}
var tde = (LI = Mr(), LI(NI = /* @__PURE__ */ function(r) {
  Hn(e, r);
  var t = Jhe(e);
  function e() {
    return Pt(this, e), t.apply(this, arguments);
  }
  return Wt(e, [{
    key: "onEntityCreated",
    value: function() {
      for (var i = this.config, a = i.radius, o = a === void 0 ? 0.5 : a, s = i.latitudeBands, u = s === void 0 ? 16 : s, f = i.longitudeBands, l = f === void 0 ? 16 : f, c = [], h = [], d = [], v = [], p = 0; p <= u; p++)
        for (var g = p * Math.PI / u, y = Math.sin(g), b = Math.cos(g), m = 0; m <= l; m++) {
          var x = m * 2 * Math.PI / l - Math.PI / 2, _ = Math.sin(x), w = Math.cos(x), E = w * y, M = b, C = _ * y, S = 1 - m / l, A = 1 - p / u;
          c.push(E * o, M * o, C * o), h.push(E, M, C), d.push(S, A);
        }
      for (var T = 0; T < u; ++T)
        for (var P = 0; P < l; ++P) {
          var k = T * (l + 1) + P, L = k + l + 1;
          v.push(k + 1, L, k), v.push(k + 1, L + 1, L);
        }
      var O = Yx(c), D = this.getComponent();
      D.indices = Uint32Array.from(v), D.aabb = O, D.vertexCount = c.length / 3, D.attributes = [{
        dirty: !0,
        name: "position",
        data: Float32Array.from(c),
        arrayStride: 4 * 3,
        stepMode: "vertex",
        attributes: [{
          shaderLocation: 0,
          offset: 0,
          format: "float3"
        }]
      }, {
        dirty: !0,
        name: "normal",
        data: Float32Array.from(h),
        arrayStride: 4 * 3,
        stepMode: "vertex",
        attributes: [{
          shaderLocation: 1,
          offset: 0,
          format: "float3"
        }]
      }, {
        dirty: !0,
        name: "uv",
        data: Float32Array.from(d),
        arrayStride: 4 * 2,
        stepMode: "vertex",
        attributes: [{
          shaderLocation: 2,
          offset: 0,
          format: "float2"
        }]
      }];
    }
  }]), e;
}(bo)) || NI), RI, BI, GI, FI, Kd, zI, UI, jI;
function rde(r) {
  var t = nde();
  return function() {
    var n = Sr(r), i;
    if (t) {
      var a = Sr(this).constructor;
      i = Reflect.construct(n, arguments, a);
    } else
      i = n.apply(this, arguments);
    return Kn(this, i);
  };
}
function nde() {
  if (typeof Reflect > "u" || !Reflect.construct || Reflect.construct.sham)
    return !1;
  if (typeof Proxy == "function")
    return !0;
  try {
    return Date.prototype.toString.call(Reflect.construct(Date, [], function() {
    })), !0;
  } catch {
    return !1;
  }
}
var ide = `varying vec4 fragColor;

#pragma include "uv.frag.declaration"
#pragma include "map.frag.declaration"

void main() {
  vec4 diffuseColor = fragColor;

  #pragma include "map.frag.main"

  gl_FragColor = diffuseColor;
}`, ade = `attribute vec3 position;
attribute vec3 normal;

uniform mat4 projectionMatrix;
uniform mat4 modelViewMatrix;
uniform vec4 color;

varying vec4 fragColor;

#pragma include "uv.vert.declaration"

void main() {
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
  fragColor = color;

  #pragma include "uv.vert.main"
}`, ode = `// layout(set = 0, binding = 1) uniform WireframeUniforms {
//   float lineWidth;
//   vec4 lineColor;
// } wireframe;

layout(location = 0) in vec4 fragColor;
// layout(location = 1) in vec3 v_Barycentric;

layout(location = 0) out vec4 outColor;

// wireframe
// float edgeFactor() {
//   vec3 d = fwidth(v_Barycentric);
//   vec3 a3 = smoothstep(vec3(0.0), d * wireframe.lineWidth, v_Barycentric);
//   return min(min(a3.x, a3.y), a3.z);
// }

void main() {
  // outColor = mix(fragColor, wireframe.lineColor, (1.0 - edgeFactor()));
  outColor = fragColor;
}`, sde = `layout(set = 0, binding = 0) uniform Uniforms {
  vec4 color;
  mat4 projectionMatrix;
  mat4 modelViewMatrix;
} uniforms;

layout(location = 0) in vec3 position;
// layout(location = 1) in vec3 barycentric;

layout(location = 0) out vec4 fragColor;
// layout(location = 1) out vec3 v_Barycentric;

void main() {
  gl_Position = uniforms.projectionMatrix * uniforms.modelViewMatrix * vec4(position, 1.0);
  fragColor = uniforms.color;
  // v_Barycentric = barycentric;
}`, ude = (RI = Mr(), BI = Ut(Ge.RenderEngine), GI = Ut(Ge.ShaderModuleService), RI(FI = (Kd = (jI = /* @__PURE__ */ function(r) {
  Hn(e, r);
  var t = rde(e);
  function e() {
    var n;
    Pt(this, e);
    for (var i = arguments.length, a = new Array(i), o = 0; o < i; o++)
      a[o] = arguments[o];
    return n = t.call.apply(t, [this].concat(a)), Ft(n, "engine", zI, qr(n)), Ft(n, "shaderModuleService", UI, qr(n)), n;
  }
  return Wt(e, [{
    key: "onEntityCreated",
    value: function() {
      var i = this.getComponent(), a = this.engine.supportWebGPU ? sde : ade, o = this.engine.supportWebGPU ? ode : ide;
      this.shaderModuleService.registerModule("material-basic", {
        vs: a,
        fs: o
      });
      var s = this.shaderModuleService.getModule("material-basic"), u = s.vs, f = s.fs, l = s.uniforms;
      i.vertexShaderGLSL = u, i.fragmentShaderGLSL = f, i.setUniform(l), this.config.map && (i.setDefines({
        USE_UV: 1,
        USE_MAP: 1
      }), i.setUniform({
        map: this.config.map,
        uvTransform: tl()
      }));
    }
  }]), e;
}(Kx), jI), zI = zt(Kd.prototype, "engine", [BI], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), UI = zt(Kd.prototype, "shaderModuleService", [GI], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), Kd)) || FI), $I, WI, VI, XI, YI, HI, KI, Wl, qI, ZI, QI, JI;
function fde(r) {
  var t = lde();
  return function() {
    var n = Sr(r), i;
    if (t) {
      var a = Sr(this).constructor;
      i = Reflect.construct(n, arguments, a);
    } else
      i = n.apply(this, arguments);
    return Kn(this, i);
  };
}
function lde() {
  if (typeof Reflect > "u" || !Reflect.construct || Reflect.construct.sham)
    return !1;
  if (typeof Proxy == "function")
    return !0;
  try {
    return Date.prototype.toString.call(Reflect.construct(Date, [], function() {
    })), !0;
  } catch {
    return !1;
  }
}
var cde = `// generate grid, borrow from clay.gl viewer
// @see https://github.com/pissang/clay-viewer/blob/master/src/graphic/ground.glsl
#extension GL_OES_standard_derivatives : enable

varying vec3 v_Position;
// varying vec3 v_Normal;

uniform float u_GridSize : 5;
uniform float u_GridSize2 : .5;
uniform vec4 u_GridColor : [0, 0, 0, 1];
uniform vec4 u_GridColor2 : [0.3, 0.3, 0.3, 1];
uniform bool u_GridEnabled : true;

// uniform vec3 u_LightDirection;
// uniform vec3 u_LightColor;
// uniform vec3 u_Camera;

void main() {
  // vec3 n = v_Normal;
  // vec3 l = normalize(u_LightDirection);
  // float NdotL = clamp(dot(n, l), 0.001, 1.0);

  gl_FragColor = vec4(1.);

  if (u_GridEnabled) {
    float wx = v_Position.x;
    float wz = v_Position.z;
    // float x0 = abs(fract(wx / u_GridSize - 0.5) - 0.5) / fwidth(wx) * u_GridSize / 2.0;
    // float z0 = abs(fract(wz / u_GridSize - 0.5) - 0.5) / fwidth(wz) * u_GridSize / 2.0;

    float x1 = abs(fract(wx / u_GridSize2 - 0.5) - 0.5) / fwidth(wx) * u_GridSize2;
    float z1 = abs(fract(wz / u_GridSize2 - 0.5) - 0.5) / fwidth(wz) * u_GridSize2;

    // float v0 = 1.0 - clamp(min(x0, z0), 0.0, 1.0);
    float v1 = 1.0 - clamp(min(x1, z1), 0.0, 1.0);
    // if (v0 > 0.1) {
        // gl_FragColor = mix(gl_FragColor, u_GridColor, v0);
    // }
    // else {
        gl_FragColor = mix(gl_FragColor, u_GridColor2, v1);
    // }
  }

  // float shadowFactor = calcShadow(u_ShadowMap, v_PositionFromLight, l, n);
  // vec3 diffuseColor = u_LightColor * NdotL * shadowFactor;

  // gl_FragColor.rgb *= diffuseColor;
}`, hde = `attribute vec3 a_Position;

varying vec3 v_Position;

uniform mat4 projectionMatrix;
uniform mat4 modelViewMatrix;

void main() {
  v_Position = a_Position;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(a_Position, 1.);
}`, dde = ($I = Mr(), WI = Ut(Ge.Systems), VI = $a(Ge.MaterialSystem), XI = Ut(Ge.Systems), YI = $a(Ge.GeometrySystem), HI = Ut(Ge.ShaderModuleService), $I(KI = (Wl = (JI = /* @__PURE__ */ function(r) {
  Hn(e, r);
  var t = fde(e);
  function e() {
    var n;
    Pt(this, e);
    for (var i = arguments.length, a = new Array(i), o = 0; o < i; o++)
      a[o] = arguments[o];
    return n = t.call.apply(t, [this].concat(a)), Ft(n, "materialSystem", qI, qr(n)), Ft(n, "geometrySystem", ZI, qr(n)), Ft(n, "shaderModuleService", QI, qr(n)), n;
  }
  return Wt(e, [{
    key: "onAttributeChanged",
    value: function(i) {
      var a = i.name, o = i.data, s = this.getMeshComponent();
      s && s.material && (a === "gridColor" ? (s.material.setUniform("u_GridColor", o), s.material.setUniform("u_GridColor2", o)) : a === "gridSize" && (s.material.setUniform("u_GridSize", o), s.material.setUniform("u_GridSize2", o)));
    }
  }, {
    key: "onEntityCreated",
    value: function() {
      this.shaderModuleService.registerModule("grid", {
        vs: hde,
        fs: cde
      });
      var i = this.shaderModuleService.getModule("grid"), a = i.vs, o = i.fs, s = i.uniforms, u = this.materialSystem.createShaderMaterial({
        vertexShader: a,
        fragmentShader: o
      });
      this.setMaterial(u);
      var f = this.geometrySystem.createBufferGeometry({
        vertexCount: 4
      });
      this.setGeometry(f), u.setCull({
        enable: !1,
        face: he.BACK
      }).setDepth({
        enable: !0,
        func: he.LESS
      }), u.setUniform(s), this.setAttributes({
        gridColor: this.config.gridColor,
        gridSize: this.config.gridSize
      }), f.setIndex([0, 3, 2, 2, 1, 0]), f.setAttribute("a_Position", Float32Array.from([-4, -1, -4, 4, -1, -4, 4, -1, 4, -4, -1, 4]), {
        arrayStride: 4 * 2,
        stepMode: "vertex",
        attributes: [{
          shaderLocation: 0,
          offset: 0,
          format: "float2"
        }]
      });
    }
  }]), e;
}(go), JI), qI = zt(Wl.prototype, "materialSystem", [WI, VI], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), ZI = zt(Wl.prototype, "geometrySystem", [XI, YI], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), QI = zt(Wl.prototype, "shaderModuleService", [HI], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), Wl)) || KI), x5 = 1e-6, _5 = vde;
function vde() {
  var r = new Float32Array(2);
  return r[0] = 0, r[1] = 0, r;
}
var pde = gde;
function gde(r) {
  var t = new Float32Array(2);
  return t[0] = r[0], t[1] = r[1], t;
}
var yde = mde;
function mde(r, t) {
  var e = new Float32Array(2);
  return e[0] = r, e[1] = t, e;
}
var bde = xde;
function xde(r, t) {
  return r[0] = t[0], r[1] = t[1], r;
}
var w5 = _de;
function _de(r, t, e) {
  return r[0] = t, r[1] = e, r;
}
var wde = Ede, eP = x5;
function Ede(r, t) {
  var e = r[0], n = r[1], i = t[0], a = t[1];
  return Math.abs(e - i) <= eP * Math.max(1, Math.abs(e), Math.abs(i)) && Math.abs(n - a) <= eP * Math.max(1, Math.abs(n), Math.abs(a));
}
var Sde = Mde;
function Mde(r, t) {
  return r[0] === t[0] && r[1] === t[1];
}
var E5 = Cde;
function Cde(r, t, e) {
  return r[0] = t[0] + e[0], r[1] = t[1] + e[1], r;
}
var Zx = Tde;
function Tde(r, t, e) {
  return r[0] = t[0] - e[0], r[1] = t[1] - e[1], r;
}
var S5 = { exports: {} };
(function(r) {
  r.exports = Zx;
})(S5);
var M5 = Ade;
function Ade(r, t, e) {
  return r[0] = t[0] * e[0], r[1] = t[1] * e[1], r;
}
var C5 = { exports: {} };
(function(r) {
  r.exports = M5;
})(C5);
var T5 = Ide;
function Ide(r, t, e) {
  return r[0] = t[0] / e[0], r[1] = t[1] / e[1], r;
}
var A5 = { exports: {} };
(function(r) {
  r.exports = T5;
})(A5);
var Pde = Ode;
function Ode(r, t) {
  return r[0] = 1 / t[0], r[1] = 1 / t[1], r;
}
var Dde = kde;
function kde(r, t, e) {
  return r[0] = Math.min(t[0], e[0]), r[1] = Math.min(t[1], e[1]), r;
}
var Lde = Nde;
function Nde(r, t, e) {
  return r[0] = Math.max(t[0], e[0]), r[1] = Math.max(t[1], e[1]), r;
}
var Rde = Bde;
function Bde(r, t, e) {
  var n = Math.cos(e), i = Math.sin(e), a = t[0], o = t[1];
  return r[0] = a * n - o * i, r[1] = a * i + o * n, r;
}
var Gde = Fde;
function Fde(r, t) {
  return r[0] = Math.floor(t[0]), r[1] = Math.floor(t[1]), r;
}
var zde = Ude;
function Ude(r, t) {
  return r[0] = Math.ceil(t[0]), r[1] = Math.ceil(t[1]), r;
}
var jde = $de;
function $de(r, t) {
  return r[0] = Math.round(t[0]), r[1] = Math.round(t[1]), r;
}
var Wde = Vde;
function Vde(r, t, e) {
  return r[0] = t[0] * e, r[1] = t[1] * e, r;
}
var Xde = Yde;
function Yde(r, t, e, n) {
  return r[0] = t[0] + e[0] * n, r[1] = t[1] + e[1] * n, r;
}
var I5 = Hde;
function Hde(r, t) {
  var e = t[0] - r[0], n = t[1] - r[1];
  return Math.sqrt(e * e + n * n);
}
var P5 = { exports: {} };
(function(r) {
  r.exports = I5;
})(P5);
var O5 = Kde;
function Kde(r, t) {
  var e = t[0] - r[0], n = t[1] - r[1];
  return e * e + n * n;
}
var D5 = { exports: {} };
(function(r) {
  r.exports = O5;
})(D5);
var k5 = qde;
function qde(r) {
  var t = r[0], e = r[1];
  return Math.sqrt(t * t + e * e);
}
var L5 = { exports: {} };
(function(r) {
  r.exports = k5;
})(L5);
var N5 = Zde;
function Zde(r) {
  var t = r[0], e = r[1];
  return t * t + e * e;
}
var R5 = { exports: {} };
(function(r) {
  r.exports = N5;
})(R5);
var Qde = Jde;
function Jde(r, t) {
  return r[0] = -t[0], r[1] = -t[1], r;
}
var B5 = eve;
function eve(r, t) {
  var e = t[0], n = t[1], i = e * e + n * n;
  return i > 0 && (i = 1 / Math.sqrt(i), r[0] = t[0] * i, r[1] = t[1] * i), r;
}
var G5 = tve;
function tve(r, t) {
  return r[0] * t[0] + r[1] * t[1];
}
var rve = nve;
function nve(r, t, e) {
  var n = t[0] * e[1] - t[1] * e[0];
  return r[0] = r[1] = 0, r[2] = n, r;
}
var ive = ave;
function ave(r, t, e, n) {
  var i = t[0], a = t[1];
  return r[0] = i + n * (e[0] - i), r[1] = a + n * (e[1] - a), r;
}
var ove = sve;
function sve(r, t) {
  t = t || 1;
  var e = Math.random() * 2 * Math.PI;
  return r[0] = Math.cos(e) * t, r[1] = Math.sin(e) * t, r;
}
var uve = fve;
function fve(r, t, e) {
  var n = t[0], i = t[1];
  return r[0] = e[0] * n + e[2] * i, r[1] = e[1] * n + e[3] * i, r;
}
var lve = cve;
function cve(r, t, e) {
  var n = t[0], i = t[1];
  return r[0] = e[0] * n + e[2] * i + e[4], r[1] = e[1] * n + e[3] * i + e[5], r;
}
var hve = dve;
function dve(r, t, e) {
  var n = t[0], i = t[1];
  return r[0] = e[0] * n + e[3] * i + e[6], r[1] = e[1] * n + e[4] * i + e[7], r;
}
var vve = pve;
function pve(r, t, e) {
  var n = t[0], i = t[1];
  return r[0] = e[0] * n + e[4] * i + e[12], r[1] = e[1] * n + e[5] * i + e[13], r;
}
var gve = yve, cf = _5();
function yve(r, t, e, n, i, a) {
  var o, s;
  for (t || (t = 2), e || (e = 0), n ? s = Math.min(n * t + e, r.length) : s = r.length, o = e; o < s; o += t)
    cf[0] = r[o], cf[1] = r[o + 1], i(cf, cf, a), r[o] = cf[0], r[o + 1] = cf[1];
  return r;
}
var mve = bve;
function bve(r, t, e) {
  var n = t[0] * t[0] + t[1] * t[1];
  if (n > e * e) {
    var i = Math.sqrt(n);
    r[0] = t[0] / i * e, r[1] = t[1] / i * e;
  } else
    r[0] = t[0], r[1] = t[1];
  return r;
}
var qd = {
  EPSILON: x5,
  create: _5,
  clone: pde,
  fromValues: yde,
  copy: bde,
  set: w5,
  equals: wde,
  exactEquals: Sde,
  add: E5,
  subtract: Zx,
  sub: S5.exports,
  multiply: M5,
  mul: C5.exports,
  divide: T5,
  div: A5.exports,
  inverse: Pde,
  min: Dde,
  max: Lde,
  rotate: Rde,
  floor: Gde,
  ceil: zde,
  round: jde,
  scale: Wde,
  scaleAndAdd: Xde,
  distance: I5,
  dist: P5.exports,
  squaredDistance: O5,
  sqrDist: D5.exports,
  length: k5,
  len: L5.exports,
  squaredLength: N5,
  sqrLen: R5.exports,
  negate: Qde,
  normalize: B5,
  dot: G5,
  cross: rve,
  lerp: ive,
  random: ove,
  transformMat2: uve,
  transformMat2d: lve,
  transformMat3: hve,
  transformMat4: vve,
  forEach: gve,
  limit: mve
}, xve = E5, C1 = w5, F5 = B5, _ve = Zx, wve = G5, tP = [0, 0], Eve = function(t, e, n, i, a) {
  return xve(t, n, i), F5(t, t), C1(e, -t[1], t[0]), C1(tP, -n[1], n[0]), a / wve(e, tP);
}, Zd = function(t, e) {
  return C1(t, -e[1], e[0]), t;
}, rP = function(t, e, n) {
  return _ve(t, e, n), F5(t, t), t;
};
function Qd(r, t, e, n, i) {
  _c(t, n, -i), _c(t, n, i), r.push(e), r.push(e);
}
function _c(r, t, e) {
  r.push([[t[0], t[1]], e]);
}
function Sve(r, t, e) {
  var n = [0, 0], i = [0, 0], a = [0, 0], o = [0, 0], s = -1, u = !1, f = null, l = qd.create(), c = e || 0, h = 3, d = [], v = [], p = [], g = [0, 0];
  t && (r = r.slice(), r.push(r[0]));
  for (var y = r.length, b = 1; b < y; b++) {
    var m = c, x = r[b - 1], _ = r[b], w = b < r.length - 1 ? r[b + 1] : null;
    if (g.push(b / y, b / y), rP(n, _, x), f || (f = [0, 0], Zd(f, n)), u || (u = !0, Qd(v, d, x, f, 1)), p.push([m + 0, m + 1, m + 2]), !w)
      Zd(f, n), Qd(v, d, _, f, 1), p.push(s === 1 ? [m, m + 2, m + 3] : [m + 2, m + 1, m + 3]), c += 2;
    else {
      rP(i, w, _);
      var E = Eve(a, o, n, i, 1), M = qd.dot(a, f) < 0 ? -1 : 1, C = E > h;
      if (!isFinite(E)) {
        Zd(f, n), Qd(v, d, _, f, 1), p.push(s === 1 ? [m, m + 2, m + 3] : [m + 2, m + 1, m + 3]), c += 2, s = M;
        continue;
      }
      C ? (E = h, g.push(b / y), _c(d, f, -M), v.push(_), _c(d, o, E * M), v.push(_), p.push(s !== -M ? [m, m + 2, m + 3] : [m + 2, m + 1, m + 3]), p.push([m + 2, m + 3, m + 4]), Zd(l, i), qd.copy(f, l), _c(d, f, -M), v.push(_), c += 3) : (Qd(v, d, _, o, E), p.push(s === 1 ? [m, m + 2, m + 3] : [m + 2, m + 1, m + 3]), M = -1, qd.copy(f, o), c += 2), s = M;
    }
  }
  return {
    normals: d,
    attrIndex: p,
    attrPos: v,
    attrCounters: g
  };
}
var nP, iP, aP, oP, sP, uP, fP, Vl, lP, cP, hP, dP;
function Mve(r) {
  var t = Cve();
  return function() {
    var n = Sr(r), i;
    if (t) {
      var a = Sr(this).constructor;
      i = Reflect.construct(n, arguments, a);
    } else
      i = n.apply(this, arguments);
    return Kn(this, i);
  };
}
function Cve() {
  if (typeof Reflect > "u" || !Reflect.construct || Reflect.construct.sham)
    return !1;
  if (typeof Proxy == "function")
    return !0;
  try {
    return Date.prototype.toString.call(Reflect.construct(Date, [], function() {
    })), !0;
  } catch {
    return !1;
  }
}
var Tve = `uniform float u_dash_array : 0.02;
uniform float u_dash_offset : 0;
uniform float u_dash_ratio : 0;
uniform float u_thickness : 0.02;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_counters;

void main() {
    float blur = 1. - smoothstep(0.98, 1., length(v_normal));

    gl_FragColor = v_color;
    gl_FragColor.a *= blur * ceil(mod(v_counters + u_dash_offset, u_dash_array) - (u_dash_array * u_dash_ratio));
}`, Ave = `attribute vec2 a_pos;
attribute vec4 a_color;
attribute float a_line_miter;
attribute vec2 a_line_normal;
attribute float a_counters;

uniform mat4 projectionMatrix;
uniform mat4 modelViewMatrix;
uniform float u_thickness : 0.02;
uniform vec2 u_viewport;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_counters;

void main() {
  v_color = a_color;
  v_counters = a_counters;

  vec3 normal = normalize(vec3(a_line_normal, 0.0));

  vec4 offset = vec4(normal * u_thickness / 2.0 * a_line_miter, 0.0);

  v_normal = vec2(normal * sign(a_line_miter));

  gl_Position = projectionMatrix * modelViewMatrix * vec4(a_pos, 0.0, 1.0) + offset;
}
`, Ive = (nP = Mr(), iP = Ut(Ge.Systems), aP = $a(Ge.MaterialSystem), oP = Ut(Ge.Systems), sP = $a(Ge.GeometrySystem), uP = Ut(Ge.ShaderModuleService), nP(fP = (Vl = (dP = /* @__PURE__ */ function(r) {
  Hn(e, r);
  var t = Mve(e);
  function e() {
    var n;
    Pt(this, e);
    for (var i = arguments.length, a = new Array(i), o = 0; o < i; o++)
      a[o] = arguments[o];
    return n = t.call.apply(t, [this].concat(a)), Ft(n, "materialSystem", lP, qr(n)), Ft(n, "geometrySystem", cP, qr(n)), Ft(n, "shaderModuleService", hP, qr(n)), n.vertexCount = void 0, n;
  }
  return Wt(e, [{
    key: "onAttributeChanged",
    value: function(i) {
      var a = i.name, o = i.data, s = this.getMeshComponent();
      if (s && s.material)
        switch (a) {
          case "dashArray":
            s.material.setUniform("u_dash_array", o);
            break;
          case "dashOffset":
            s.material.setUniform("u_dash_offset", o);
            break;
          case "dashRatio":
            s.material.setUniform("u_dash_ratio", o);
            break;
          case "thickness":
            s.material.setUniform("u_thickness", o);
            break;
          case "color":
            var u = new Array(this.vertexCount).fill(void 0).map(function() {
              return o;
            }).reduce(function(f, l) {
              return [].concat(cn(f), cn(l));
            }, []);
            s.geometry.setAttribute("a_color", Float32Array.from(u), {
              arrayStride: 4 * 4,
              stepMode: "vertex",
              attributes: [{
                shaderLocation: 1,
                offset: 0,
                format: "float4"
              }]
            });
            break;
        }
    }
  }, {
    key: "onEntityCreated",
    value: function() {
      var i = this;
      this.shaderModuleService.registerModule("line", {
        vs: Ave,
        fs: Tve
      });
      var a = this.shaderModuleService.getModule("line"), o = a.vs, s = a.fs, u = a.uniforms, f = this.materialSystem.createShaderMaterial({
        vertexShader: o,
        fragmentShader: s
      }), l = Sve(this.config.points, !1), c = l.normals, h = l.attrIndex, d = l.attrPos, v = l.attrCounters, p = d.length;
      this.vertexCount = p;
      var g = this.geometrySystem.createBufferGeometry({
        vertexCount: p
      });
      this.setMaterial(f), this.setGeometry(g), f.setCull({
        enable: !1,
        face: he.BACK
      }).setUniform(u), this.setAttributes({
        dashArray: this.config.dashArray,
        dashOffset: this.config.dashOffset,
        dashRatio: this.config.dashRatio,
        thickness: this.config.thickness
      });
      var y = [], b = [];
      c.forEach(function(x) {
        var _ = x[0], w = x[1];
        y.push([_[0], _[1]]), b.push(w);
      }), g.setIndex(h.reduce(function(x, _) {
        return [].concat(cn(x), cn(_));
      }, [])), g.setAttribute("a_pos", Float32Array.from(d.reduce(function(x, _) {
        return [].concat(cn(x), cn(_));
      }, [])), {
        arrayStride: 4 * 2,
        stepMode: "vertex",
        attributes: [{
          shaderLocation: 0,
          offset: 0,
          format: "float2"
        }]
      });
      var m = new Array(p).fill(void 0).map(function() {
        return cn(i.config.color);
      }).reduce(function(x, _) {
        return [].concat(cn(x), cn(_));
      }, []);
      g.setAttribute("a_color", Float32Array.from(m), {
        arrayStride: 4 * 4,
        stepMode: "vertex",
        attributes: [{
          shaderLocation: 1,
          offset: 0,
          format: "float4"
        }]
      }), g.setAttribute("a_line_miter", Float32Array.from(b), {
        arrayStride: 4 * 1,
        stepMode: "vertex",
        attributes: [{
          shaderLocation: 2,
          offset: 0,
          format: "float"
        }]
      }), g.setAttribute("a_line_normal", Float32Array.from(y.reduce(function(x, _) {
        return [].concat(cn(x), cn(_));
      }, [])), {
        arrayStride: 4 * 2,
        stepMode: "vertex",
        attributes: [{
          shaderLocation: 3,
          offset: 0,
          format: "float2"
        }]
      }), g.setAttribute("a_counters", Float32Array.from(v), {
        arrayStride: 4 * 1,
        stepMode: "vertex",
        attributes: [{
          shaderLocation: 4,
          offset: 0,
          format: "float"
        }]
      });
    }
  }]), e;
}(go), dP), lP = zt(Vl.prototype, "materialSystem", [iP, aP], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), cP = zt(Vl.prototype, "geometrySystem", [oP, sP], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), hP = zt(Vl.prototype, "shaderModuleService", [uP], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), Vl)) || fP);
function Pve(r) {
  return [r + 1 & 255, r + 1 >> 8 & 255, r + 1 >> 8 >> 8 & 255];
}
var vP, pP, gP, yP, mP, bP, xP, Xl, _P, wP, EP, SP;
function MP(r, t) {
  var e = Object.keys(r);
  if (Object.getOwnPropertySymbols) {
    var n = Object.getOwnPropertySymbols(r);
    t && (n = n.filter(function(i) {
      return Object.getOwnPropertyDescriptor(r, i).enumerable;
    })), e.push.apply(e, n);
  }
  return e;
}
function Ove(r) {
  for (var t = 1; t < arguments.length; t++) {
    var e = arguments[t] != null ? arguments[t] : {};
    t % 2 ? MP(Object(e), !0).forEach(function(n) {
      Ae(r, n, e[n]);
    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(r, Object.getOwnPropertyDescriptors(e)) : MP(Object(e)).forEach(function(n) {
      Object.defineProperty(r, n, Object.getOwnPropertyDescriptor(e, n));
    });
  }
  return r;
}
function Dve(r) {
  var t = kve();
  return function() {
    var n = Sr(r), i;
    if (t) {
      var a = Sr(this).constructor;
      i = Reflect.construct(n, arguments, a);
    } else
      i = n.apply(this, arguments);
    return Kn(this, i);
  };
}
function kve() {
  if (typeof Reflect > "u" || !Reflect.construct || Reflect.construct.sham)
    return !1;
  if (typeof Proxy == "function")
    return !0;
  try {
    return Date.prototype.toString.call(Reflect.construct(Date, [], function() {
    })), !0;
  } catch {
    return !1;
  }
}
var Lve = `uniform float u_blur : 0.05;
uniform float u_opacity : 0.7;
uniform float u_stroke_width : 0.01;
uniform vec4 u_stroke_color : [0, 0, 0, 0];
uniform float u_stroke_opacity : 1;

varying vec4 v_color;
varying vec4 v_data;
varying float v_radius;

#pragma include "sdf2d"
#pragma include "picking"

void main() {
  int shape = int(floor(v_data.w + 0.5));

  float antialiasblur = v_data.z;
  float antialiased_blur = -max(u_blur, antialiasblur);
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  // if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  // } else if (shape == 1) {
  //   outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
  //   inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  // } else if (shape == 2) {
  //   outer_df = sdBox(v_data.xy, vec2(1.));
  //   inner_df = sdBox(v_data.xy, vec2(r));
  // } else if (shape == 3) {
  //   outer_df = sdPentagon(v_data.xy, 0.8);
  //   inner_df = sdPentagon(v_data.xy, r * 0.8);
  // } else if (shape == 4) {
  //   outer_df = sdHexagon(v_data.xy, 0.8);
  //   inner_df = sdHexagon(v_data.xy, r * 0.8);
  // } else if (shape == 5) {
  //   outer_df = sdOctogon(v_data.xy, 1.0);
  //   inner_df = sdOctogon(v_data.xy, r);
  // } else if (shape == 6) {
  //   outer_df = sdHexagram(v_data.xy, 0.52);
  //   inner_df = sdHexagram(v_data.xy, r * 0.52);
  // } else if (shape == 7) {
  //   outer_df = sdRhombus(v_data.xy, vec2(1.0));
  //   inner_df = sdRhombus(v_data.xy, vec2(r));
  // } else if (shape == 8) {
  //   outer_df = sdVesica(v_data.xy, 1.1, 0.8);
  //   inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  // }

  float opacity_t = smoothstep(0.0, antialiased_blur, outer_df);

  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiased_blur,
    0.0,
    inner_df
  );
  vec4 strokeColor = u_stroke_color == vec4(0) ? v_color : u_stroke_color;

  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);
  gl_FragColor.a = gl_FragColor.a * opacity_t;

  gl_FragColor = filterColor(gl_FragColor);
}`, Nve = `attribute vec2 position;
attribute vec4 color;
attribute float shape;
attribute vec2 offset;
attribute float size;

uniform mat4 projectionMatrix;
uniform mat4 modelViewMatrix;

uniform float u_stroke_width : 0.01;
uniform float u_device_pixel_ratio;
uniform vec2 u_viewport;

varying vec4 v_color;
varying vec4 v_data;
varying float v_radius;

#pragma include "picking"

void main() {
  v_color = color;
  v_radius = size;

  lowp float antialiasblur = 1.0 / u_device_pixel_ratio * (size + u_stroke_width);

  // construct point coords
  v_data = vec4(position, antialiasblur, shape);

  gl_Position = projectionMatrix * modelViewMatrix
    * vec4(position * size + offset, 0.0, 1.0);

  setPickingColor(a_PickingColor);
}`, Rve = ["circle", "triangle", "square", "pentagon", "hexagon", "octogon", "hexagram", "rhombus", "vesica"], Bve = (vP = Mr(), pP = Ut(Ge.Systems), gP = $a(Ge.MaterialSystem), yP = Ut(Ge.Systems), mP = $a(Ge.GeometrySystem), bP = Ut(Ge.ShaderModuleService), vP(xP = (Xl = (SP = /* @__PURE__ */ function(r) {
  Hn(e, r);
  var t = Dve(e);
  function e() {
    var n;
    Pt(this, e);
    for (var i = arguments.length, a = new Array(i), o = 0; o < i; o++)
      a[o] = arguments[o];
    return n = t.call.apply(t, [this].concat(a)), Ft(n, "materialSystem", _P, qr(n)), Ft(n, "geometrySystem", wP, qr(n)), Ft(n, "shaderModuleService", EP, qr(n)), n;
  }
  return Wt(e, [{
    key: "onAttributeChanged",
    value: function(i) {
      var a = i.name, o = i.data, s = this.getMeshComponent();
      s && s.material && (a === "strokeWidth" ? s.material.setUniform("u_stroke_width", o) : a === "strokeColor" ? s.material.setUniform("u_stroke_color", o) : a === "strokeOpacity" ? s.material.setUniform("u_stroke_opacity", o) : a === "opacity" ? s.material.setUniform("u_opacity", o) : a === "blur" && s.material.setUniform("u_blur", o));
    }
  }, {
    key: "onEntityCreated",
    value: function() {
      this.shaderModuleService.registerModule("grid", {
        vs: Nve,
        fs: Lve
      });
      var i = this.shaderModuleService.getModule("grid"), a = i.vs, o = i.fs, s = i.uniforms, u = this.materialSystem.createShaderMaterial({
        vertexShader: a,
        fragmentShader: o,
        cull: {
          enable: !1
        },
        depth: {
          enable: !1
        },
        blend: {
          enable: !0,
          func: {
            srcRGB: he.SRC_ALPHA,
            dstRGB: he.ONE_MINUS_SRC_ALPHA,
            srcAlpha: 1,
            dstAlpha: 1
          }
        }
      });
      u.setUniform(Ove({
        u_device_pixel_ratio: window.devicePixelRatio
      }, s));
      var f = this.buildAttributes(), l = this.geometrySystem.createInstancedBufferGeometry({
        maxInstancedCount: f.instancedOffsets.length / 2,
        vertexCount: 6
      });
      l.setIndex([0, 2, 1, 0, 3, 2]), l.setAttribute("position", Float32Array.from(f.positions), {
        arrayStride: 4 * 2,
        stepMode: "vertex",
        attributes: [{
          shaderLocation: 0,
          offset: 0,
          format: "float2"
        }]
      }), l.setAttribute("offset", Float32Array.from(f.instancedOffsets), {
        arrayStride: 4 * 2,
        stepMode: "instance",
        attributes: [{
          shaderLocation: 1,
          offset: 0,
          format: "float2"
        }]
      }), l.setAttribute("color", Float32Array.from(f.instancedColors), {
        arrayStride: 4 * 4,
        stepMode: "instance",
        attributes: [{
          shaderLocation: 2,
          offset: 0,
          format: "float4"
        }]
      }), l.setAttribute("size", Float32Array.from(f.instancedSizes), {
        arrayStride: 4,
        stepMode: "instance",
        attributes: [{
          shaderLocation: 3,
          offset: 0,
          format: "float"
        }]
      }), l.setAttribute("shape", Float32Array.from(f.instancedShapes), {
        arrayStride: 4,
        stepMode: "instance",
        attributes: [{
          shaderLocation: 4,
          offset: 0,
          format: "float"
        }]
      }), l.setAttribute("a_PickingColor", Float32Array.from(f.instancedPickingColors), {
        arrayStride: 4 * 3,
        stepMode: "instance",
        attributes: [{
          shaderLocation: 6,
          offset: 0,
          format: "float3"
        }]
      }), this.setMaterial(u), this.setGeometry(l);
    }
  }, {
    key: "buildAttribute",
    value: function(i, a, o) {
      var s, u, f, l;
      (s = a.instancedPickingColors).push.apply(s, cn(Pve(i.id || o))), a.instancedShapes.push(Rve.indexOf(i.shape || "circle")), (u = a.instancedColors).push.apply(u, cn(i.color || [1, 0, 0, 1])), (f = a.instancedOffsets).push.apply(f, cn(i.position || [0, 0])), (l = a.instancedSizes).push.apply(l, cn(i.size || [0.2, 0.2]));
    }
  }, {
    key: "buildAttributes",
    value: function() {
      var i = this, a = {
        positions: [1, 1, 1, -1, -1, -1, -1, 1],
        instancedOffsets: [],
        instancedColors: [],
        instancedSizes: [],
        instancedShapes: [],
        instancedPickingColors: []
      };
      return Array.isArray(this.config) ? this.config.forEach(function(o, s) {
        i.buildAttribute(o, a, s);
      }) : this.buildAttribute(this.config, a, 0), a;
    }
  }]), e;
}(go), SP), _P = zt(Xl.prototype, "materialSystem", [pP, gP], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), wP = zt(Xl.prototype, "geometrySystem", [yP, mP], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), EP = zt(Xl.prototype, "shaderModuleService", [bP], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), Xl)) || xP), CP, TP, AP, IP, PP, Yl, OP, DP, kP, LP;
function NP(r, t) {
  var e;
  if (typeof Symbol > "u" || r[Symbol.iterator] == null) {
    if (Array.isArray(r) || (e = Gve(r)) || t && r && typeof r.length == "number") {
      e && (r = e);
      var n = 0, i = function() {
      };
      return { s: i, n: function() {
        return n >= r.length ? { done: !0 } : { done: !1, value: r[n++] };
      }, e: function(f) {
        throw f;
      }, f: i };
    }
    throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`);
  }
  var a = !0, o = !1, s;
  return { s: function() {
    e = r[Symbol.iterator]();
  }, n: function() {
    var f = e.next();
    return a = f.done, f;
  }, e: function(f) {
    o = !0, s = f;
  }, f: function() {
    try {
      !a && e.return != null && e.return();
    } finally {
      if (o)
        throw s;
    }
  } };
}
function Gve(r, t) {
  if (!!r) {
    if (typeof r == "string")
      return RP(r, t);
    var e = Object.prototype.toString.call(r).slice(8, -1);
    if (e === "Object" && r.constructor && (e = r.constructor.name), e === "Map" || e === "Set")
      return Array.from(r);
    if (e === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))
      return RP(r, t);
  }
}
function RP(r, t) {
  (t == null || t > r.length) && (t = r.length);
  for (var e = 0, n = new Array(t); e < t; e++)
    n[e] = r[e];
  return n;
}
var Fve = `#ifdef USE_MAP
  uniform sampler2D map;
#endif`, zve = `#ifdef USE_MAP
  vec4 texelColor = texture2D(map, vUv);
  // texelColor = mapTexelToLinear(texelColor);
  diffuseColor *= texelColor;
#endif`, Uve = `#if (defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ))
  varying vec2 vUv;
#endif`, jve = `#ifdef USE_UV
  attribute vec2 uv;
	#ifdef UVS_VERTEX_ONLY
    vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`, $ve = `#ifdef USE_UV
  vUv = (uvTransform * vec3(uv, 1)).xy;
#endif`, BP = (CP = Mr(), TP = Ut(Ge.RenderEngine), AP = Ut(Ge.ShaderModuleService), IP = Ut(Ge.ConfigService), CP(PP = (Yl = (LP = /* @__PURE__ */ function() {
  function r() {
    Pt(this, r), this.container = void 0, Ft(this, "engine", OP, this), Ft(this, "shaderModule", DP, this), Ft(this, "configService", kP, this), this.inited = !1, this.rendering = !1, this.pendings = [], this.views = [], this.size = void 0;
  }
  return Wt(r, [{
    key: "init",
    value: function() {
      var t = Er(/* @__PURE__ */ St.mark(function n() {
        var i, a, o, s, u;
        return St.wrap(function(l) {
          for (; ; )
            switch (l.prev = l.next) {
              case 0:
                if (this.shaderModule.registerBuiltinModules(), this.shaderModule.registerModule("uv.vert.declaration", {
                  vs: jve
                }), this.shaderModule.registerModule("uv.vert.main", {
                  vs: $ve
                }), this.shaderModule.registerModule("uv.frag.declaration", {
                  fs: Uve
                }), this.shaderModule.registerModule("map.frag.declaration", {
                  fs: Fve
                }), this.shaderModule.registerModule("map.frag.main", {
                  fs: zve
                }), i = this.container.getAll(Ge.Systems), a = this.configService.get(), !a.canvas) {
                  l.next = 30;
                  break;
                }
                return l.next = 11, this.engine.init({
                  canvas: a.canvas,
                  swapChainFormat: ut.TextureFormat.BGRA8Unorm,
                  antialiasing: !1
                });
              case 11:
                o = NP(i), l.prev = 12, o.s();
              case 14:
                if ((s = o.n()).done) {
                  l.next = 21;
                  break;
                }
                if (u = s.value, !u.initialize) {
                  l.next = 19;
                  break;
                }
                return l.next = 19, u.initialize();
              case 19:
                l.next = 14;
                break;
              case 21:
                l.next = 26;
                break;
              case 23:
                l.prev = 23, l.t0 = l.catch(12), o.e(l.t0);
              case 26:
                return l.prev = 26, o.f(), l.finish(26);
              case 29:
                this.inited = !0;
              case 30:
              case "end":
                return l.stop();
            }
        }, n, this, [[12, 23, 26, 29]]);
      }));
      function e() {
        return t.apply(this, arguments);
      }
      return e;
    }()
  }, {
    key: "render",
    value: function() {
      var t = Er(/* @__PURE__ */ St.mark(function n() {
        var i, a, o, s, u, f, l, c = arguments;
        return St.wrap(function(d) {
          for (; ; )
            switch (d.prev = d.next) {
              case 0:
                if (!(!this.inited || this.rendering)) {
                  d.next = 2;
                  break;
                }
                return d.abrupt("return");
              case 2:
                for (this.pendings.length && this.pendings.forEach(function(v) {
                  v();
                }), this.rendering = !0, this.engine.beginFrame(), i = this.container.getAll(Ge.Systems), a = c.length, o = new Array(a), s = 0; s < a; s++)
                  o[s] = c[s];
                u = NP(i), d.prev = 8, u.s();
              case 10:
                if ((f = u.n()).done) {
                  d.next = 17;
                  break;
                }
                if (l = f.value, !l.execute) {
                  d.next = 15;
                  break;
                }
                return d.next = 15, l.execute(o);
              case 15:
                d.next = 10;
                break;
              case 17:
                d.next = 22;
                break;
              case 19:
                d.prev = 19, d.t0 = d.catch(8), u.e(d.t0);
              case 22:
                return d.prev = 22, u.f(), d.finish(22);
              case 25:
                this.engine.endFrame(), this.rendering = !1;
              case 27:
              case "end":
                return d.stop();
            }
        }, n, this, [[8, 19, 22, 25]]);
      }));
      function e() {
        return t.apply(this, arguments);
      }
      return e;
    }()
  }, {
    key: "clear",
    value: function(e) {
      var n = this;
      return this.inited ? this.engine.clear(e) : this.pendings.unshift(function() {
        n.engine.clear(e), n.pendings.shift();
      }), this;
    }
  }, {
    key: "setSize",
    value: function(e) {
      var n = e.width, i = e.height, a = this.engine.getCanvas();
      return this.size = {
        width: n,
        height: i
      }, a.width = n, a.height = i, this;
    }
  }, {
    key: "getSize",
    value: function() {
      return this.size;
    }
  }]), r;
}(), LP), OP = zt(Yl.prototype, "engine", [TP], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), DP = zt(Yl.prototype, "shaderModule", [AP], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), kP = zt(Yl.prototype, "configService", [IP], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), Yl)) || PP), GP, FP, zP, UP = (GP = Mr(), GP(FP = (zP = /* @__PURE__ */ function() {
  function r() {
    Pt(this, r), this.entities = [];
  }
  return Wt(r, [{
    key: "getEntities",
    value: function() {
      return this.entities;
    }
  }, {
    key: "addRenderable",
    value: function(e) {
      return this.addEntity(e.getEntity()), this;
    }
  }, {
    key: "removeRenderable",
    value: function(e) {
      return this.removeEntity(e.getEntity()), this;
    }
  }, {
    key: "addLight",
    value: function() {
    }
  }, {
    key: "addEntity",
    value: function(e) {
      return this.entities.indexOf(e) === -1 && this.entities.push(e), this;
    }
  }, {
    key: "removeEntity",
    value: function(e) {
      var n = this.entities.indexOf(e);
      return this.entities.splice(n, 1), this;
    }
  }]), r;
}(), zP)) || FP), jP, $P, WP, z5 = (jP = Mr(), jP($P = (WP = /* @__PURE__ */ function() {
  function r() {
    Pt(this, r), this.cache = {};
  }
  return Wt(r, [{
    key: "get",
    value: function(e) {
      return this.cache[e];
    }
  }, {
    key: "set",
    value: function(e, n) {
      this.cache[e] = n;
    }
  }]), r;
}(), WP)) || $P), VP, XP, YP, HP, Jd, KP, qP, ZP;
function QP(r, t) {
  var e = Object.keys(r);
  if (Object.getOwnPropertySymbols) {
    var n = Object.getOwnPropertySymbols(r);
    t && (n = n.filter(function(i) {
      return Object.getOwnPropertyDescriptor(r, i).enumerable;
    })), e.push.apply(e, n);
  }
  return e;
}
function JP(r) {
  for (var t = 1; t < arguments.length; t++) {
    var e = arguments[t] != null ? arguments[t] : {};
    t % 2 ? QP(Object(e), !0).forEach(function(n) {
      Ae(r, n, e[n]);
    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(r, Object.getOwnPropertyDescriptors(e)) : QP(Object(e)).forEach(function(n) {
      Object.defineProperty(r, n, Object.getOwnPropertyDescriptor(e, n));
    });
  }
  return r;
}
var eO = (VP = Mr(), XP = Ut(z5), YP = Ut(Ge.RenderEngine), VP(HP = (Jd = (ZP = /* @__PURE__ */ function() {
  function r() {
    Pt(this, r), Ft(this, "textureCache", KP, this), Ft(this, "engine", qP, this), this.config = void 0, this.loaded = !1, this.texture = void 0;
  }
  return Wt(r, [{
    key: "setConfig",
    value: function(e) {
      this.config = e;
    }
  }, {
    key: "isLoaded",
    value: function() {
      return this.loaded;
    }
  }, {
    key: "load",
    value: function() {
      var t = Er(/* @__PURE__ */ St.mark(function n() {
        var i = this;
        return St.wrap(function(o) {
          for (; ; )
            switch (o.prev = o.next) {
              case 0:
                if (!this.config.url) {
                  o.next = 4;
                  break;
                }
                return o.abrupt("return", new Promise(function(s, u) {
                  var f = i.textureCache.get(i.config.url);
                  if (f)
                    s(f);
                  else {
                    var l = new Image();
                    l.crossOrigin = "Anonymous", l.src = i.config.url, l.onload = function() {
                      var c = i.engine.createTexture2D(JP(JP({}, i.config), {}, {
                        data: l,
                        width: l.width,
                        height: l.height,
                        flipY: !0
                      }));
                      i.textureCache.set(i.config.url, c), i.texture = c, i.loaded = !0, s(c);
                    }, l.onerror = function() {
                      u();
                    };
                  }
                }));
              case 4:
                return this.loaded = !0, this.texture = this.engine.createTexture2D(this.config), o.abrupt("return", this.texture);
              case 7:
              case "end":
                return o.stop();
            }
        }, n, this);
      }));
      function e() {
        return t.apply(this, arguments);
      }
      return e;
    }()
  }]), r;
}(), ZP), KP = zt(Jd.prototype, "textureCache", [XP], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), qP = zt(Jd.prototype, "engine", [YP], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), Jd)) || HP), tO, rO, nO, iO, Ry, aO, oO, sO = (tO = Mr(), rO = Ut(Ge.Systems), nO = $a(Ge.RendererSystem), tO(iO = (Ry = (oO = /* @__PURE__ */ function() {
  function r() {
    Pt(this, r), Ft(this, "rendererSystem", aO, this), this.camera = void 0, this.scene = void 0, this.viewport = {
      x: 0,
      y: 0,
      width: 0,
      height: 0
    }, this.clearColor = [1, 1, 1, 1];
  }
  return Wt(r, [{
    key: "getCamera",
    value: function() {
      return this.camera;
    }
  }, {
    key: "getScene",
    value: function() {
      return this.scene;
    }
  }, {
    key: "getViewport",
    value: function() {
      return this.viewport;
    }
  }, {
    key: "getClearColor",
    value: function() {
      return this.clearColor;
    }
  }, {
    key: "setCamera",
    value: function(e) {
      return this.camera = e, this;
    }
  }, {
    key: "setScene",
    value: function(e) {
      return this.scene = e, this;
    }
  }, {
    key: "setViewport",
    value: function(e) {
      return this.viewport = e, this;
    }
  }, {
    key: "setClearColor",
    value: function(e) {
      return this.clearColor = e, this;
    }
  }, {
    key: "pick",
    value: function(e) {
      return this.rendererSystem.pick(e, this);
    }
  }]), r;
}(), oO), aO = zt(Ry.prototype, "rendererSystem", [rO, nO], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), Ry)) || iO), uO, fO, lO, By, cO, hO;
function dO(r, t) {
  var e = Object.keys(r);
  if (Object.getOwnPropertySymbols) {
    var n = Object.getOwnPropertySymbols(r);
    t && (n = n.filter(function(i) {
      return Object.getOwnPropertyDescriptor(r, i).enumerable;
    })), e.push.apply(e, n);
  }
  return e;
}
function Wve(r) {
  for (var t = 1; t < arguments.length; t++) {
    var e = arguments[t] != null ? arguments[t] : {};
    t % 2 ? dO(Object(e), !0).forEach(function(n) {
      Ae(r, n, e[n]);
    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(r, Object.getOwnPropertyDescriptors(e)) : dO(Object(e)).forEach(function(n) {
      Object.defineProperty(r, n, Object.getOwnPropertyDescriptor(e, n));
    });
  }
  return r;
}
var Vve = (uO = Mr(), fO = Ut(Ge.ConfigService), uO(lO = (By = (hO = /* @__PURE__ */ function() {
  function r() {
    Pt(this, r), Ft(this, "configService", cO, this), this.container = void 0;
  }
  return Wt(r, [{
    key: "getEngine",
    value: function() {
      var t = Er(/* @__PURE__ */ St.mark(function n() {
        var i, a, o, s;
        return St.wrap(function(f) {
          for (; ; )
            switch (f.prev = f.next) {
              case 0:
                return i = this.container.get(Ge.RenderEngine), a = this.configService.get(), o = a.canvas, s = a.engineOptions, f.next = 4, i.init(Wve({
                  canvas: o || g5(),
                  swapChainFormat: ut.TextureFormat.BGRA8Unorm,
                  antialiasing: !1
                }, s));
              case 4:
                return f.abrupt("return", i);
              case 5:
              case "end":
                return f.stop();
            }
        }, n, this);
      }));
      function e() {
        return t.apply(this, arguments);
      }
      return e;
    }()
  }, {
    key: "getTransformComponent",
    value: function(e) {
      var n = this.container.get(Ge.TransformComponentManager);
      return n.getComponentByEntity(e);
    }
  }, {
    key: "getMeshComponent",
    value: function(e) {
      var n = this.container.get(Ge.MeshComponentManager);
      return n.getComponentByEntity(e);
    }
  }, {
    key: "setConfig",
    value: function(e) {
      this.configService.set(e);
    }
  }, {
    key: "setContainer",
    value: function(e) {
      this.container = e;
    }
  }, {
    key: "getContainer",
    value: function() {
      return this.container;
    }
  }, {
    key: "createEntity",
    value: function() {
      return Na();
    }
  }, {
    key: "createScene",
    value: function() {
      return this.container.get(UP);
    }
  }, {
    key: "createCamera",
    value: function() {
      return this.container.get(x1);
    }
  }, {
    key: "createView",
    value: function() {
      return this.container.get(sO);
    }
  }, {
    key: "createRenderable",
    value: function(e, n) {
      var i = e ? this.container.getNamed(Ge.Renderable, e) : this.container.get(go), a = Na();
      return i.setConfig(n || {}), i.setEntity(a), i;
    }
  }, {
    key: "createGeometry",
    value: function(e, n) {
      var i = this.container.getNamed(Ge.Geometry, e), a = Na();
      return i.setConfig(n || {}), i.setEntity(a), i.getComponent();
    }
  }, {
    key: "createMaterial",
    value: function(e, n) {
      var i = this.container.getNamed(Ge.Material, e), a = Na();
      return i.setConfig(n || {}), i.setEntity(a, e), i.getComponent();
    }
  }, {
    key: "createTexture2D",
    value: function(e) {
      var n = this.container.get(eO);
      return n.setConfig(e), n;
    }
  }, {
    key: "createBufferGeometry",
    value: function(e) {
      var n = this.container.getNamed(Ge.Systems, Ge.GeometrySystem);
      return n.createBufferGeometry(e);
    }
  }, {
    key: "createInstancedBufferGeometry",
    value: function(e) {
      var n = this.container.getNamed(Ge.Systems, Ge.GeometrySystem);
      return n.createInstancedBufferGeometry(e);
    }
  }, {
    key: "createShaderMaterial",
    value: function(e) {
      var n = this.container.getNamed(Ge.Systems, Ge.MaterialSystem);
      return n.createShaderMaterial(e);
    }
  }, {
    key: "createKernel",
    value: function(e) {
      var n = this.container.get(_1);
      return typeof e == "string" ? n.setBundle(JSON.parse(e)) : n.setBundle(e), n.init(), n;
    }
  }, {
    key: "createRenderer",
    value: function() {
      var e = this.container.get(BP);
      return e.container = this.container, e.init(), e;
    }
  }, {
    key: "destroy",
    value: function() {
      var e = this.container.getAll(Ge.Systems);
      e.forEach(function(a) {
        a.tearDown && a.tearDown();
      });
      var n = this.container.get(Ge.RenderEngine);
      n.destroy();
      var i = this.container.get(Ge.InteractorService);
      i.destroy();
    }
  }], [{
    key: "create",
    value: function() {
      var e = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : {}, n = Xle(), i = navigator.gpu ? jhe : Ehe;
      n.isBound(Ge.RenderEngine) || n.bind(Ge.RenderEngine).to(i).inSingletonScope(), n.bind(BP).toSelf(), n.bind(_1).toSelf(), n.bind(go).toSelf(), n.bind(sO).toSelf(), n.bind(x1).toSelf(), n.bind(UP).toSelf(), n.bind(r).toSelf(), n.bind(z5).toSelf(), n.bind(eO).toSelf(), n.bind(Ge.Geometry).to(Vhe).whenTargetNamed(bo.BOX), n.bind(Ge.Geometry).to(tde).whenTargetNamed(bo.SPHERE), n.bind(Ge.Geometry).to(Qhe).whenTargetNamed(bo.PLANE), n.bind(Ge.Geometry).to(Khe).whenTargetNamed(bo.MERGED), n.bind(Ge.Material).to(ude).whenTargetNamed(Kx.BASIC), n.bind(Ge.Renderable).to(Bve).whenTargetNamed(go.POINT), n.bind(Ge.Renderable).to(Ive).whenTargetNamed(go.LINE), n.bind(Ge.Renderable).to(dde).whenTargetNamed(go.GRID);
      var a = n.get(r);
      return a.setContainer(n), a.setConfig(e), a;
    }
  }]), r;
}(), hO), cO = zt(By.prototype, "configService", [fO], {
  configurable: !0,
  enumerable: !0,
  writable: !0,
  initializer: null
}), By)) || lO);
const Xve = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  World: Vve,
  Kernel: _1,
  Camera: x1,
  Renderable: go,
  Geometry: bo,
  Material: Kx
}, Symbol.toStringTag, { value: "Module" })), U5 = /* @__PURE__ */ Ao(Xve);
var xi = {};
Object.defineProperty(xi, "__esModule", { value: !0 });
xi.arrayToTextureData = xi.attributesToTextureData = xi.buildTextureDataWithTwoEdgeAttr = xi.buildTextureData = xi.proccessToFunc = void 0;
var Yve = on(), xp = Zp, Hve = function(r, t) {
  var e;
  return r ? (0, Yve.isNumber)(r) ? e = function() {
    return r;
  } : e = r : e = function() {
    return t || 1;
  }, e;
};
xi.proccessToFunc = Hve;
var Kve = function(r, t) {
  var e = [], n = [], i = {}, a = 0;
  for (a = 0; a < r.length; a++) {
    var o = r[a];
    i[o.id] = a, e.push(o.x), e.push(o.y), e.push(0), e.push(0), n.push([]);
  }
  for (a = 0; a < t.length; a++) {
    var s = t[a], u = (0, xp.getEdgeTerminal)(s, "source"), f = (0, xp.getEdgeTerminal)(s, "target");
    !isNaN(i[u]) && !isNaN(i[f]) && (n[i[u]].push(i[f]), n[i[f]].push(i[u]));
  }
  var l = 0;
  for (a = 0; a < r.length; a++) {
    var c = e.length, h = n[a], d = h.length;
    e[a * 4 + 2] = c, e[a * 4 + 3] = d, l = Math.max(l, d);
    for (var v = 0; v < d; ++v) {
      var p = h[v];
      e.push(+p);
    }
  }
  for (; e.length % 4 !== 0; )
    e.push(0);
  return {
    maxEdgePerVetex: l,
    array: new Float32Array(e)
  };
};
xi.buildTextureData = Kve;
var qve = function(r, t, e, n) {
  var i = [], a = [], o = {}, s = 0;
  for (s = 0; s < r.length; s++) {
    var u = r[s];
    o[u.id] = s, i.push(u.x), i.push(u.y), i.push(0), i.push(0), a.push([]);
  }
  for (s = 0; s < t.length; s++) {
    var f = t[s], l = (0, xp.getEdgeTerminal)(f, "source"), c = (0, xp.getEdgeTerminal)(f, "target");
    a[o[l]].push(o[c]), a[o[l]].push(e(f)), a[o[l]].push(n(f)), a[o[l]].push(0), a[o[c]].push(o[l]), a[o[c]].push(e(f)), a[o[c]].push(n(f)), a[o[c]].push(0);
  }
  var h = 0;
  for (s = 0; s < r.length; s++) {
    var d = i.length, v = a[s], p = v.length;
    i[s * 4 + 2] = d + 1048576 * p / 4, i[s * 4 + 3] = 0, h = Math.max(h, p / 4);
    for (var g = 0; g < p; ++g) {
      var y = v[g];
      i.push(+y);
    }
  }
  for (; i.length % 4 !== 0; )
    i.push(0);
  return {
    maxEdgePerVetex: h,
    array: new Float32Array(i)
  };
};
xi.buildTextureDataWithTwoEdgeAttr = qve;
var Zve = function(r, t) {
  var e = [], n = r.length, i = {};
  return t.forEach(function(a) {
    r.forEach(function(o, s) {
      if (i[a[o]] === void 0 && (i[a[o]] = Object.keys(i).length), e.push(i[a[o]]), s === n - 1)
        for (; e.length % 4 !== 0; )
          e.push(0);
    });
  }), {
    array: new Float32Array(e),
    count: Object.keys(i).length
  };
};
xi.attributesToTextureData = Zve;
var Qve = function(r) {
  for (var t = [], e = r.length, n = r[0].length, i = function(o) {
    r.forEach(function(s, u) {
      if (t.push(s[o]), u === e - 1)
        for (; t.length % 4 !== 0; )
          t.push(0);
    });
  }, a = 0; a < n; a++)
    i(a);
  return new Float32Array(t);
};
xi.arrayToTextureData = Qve;
var Ra = {};
Object.defineProperty(Ra, "__esModule", { value: !0 });
Ra.clusterBundle = Ra.clusterCode = Ra.fruchtermanBundle = Ra.fruchtermanCode = void 0;
Ra.fruchtermanCode = `
import { globalInvocationID } from 'g-webgpu';
const MAX_EDGE_PER_VERTEX;
const VERTEX_COUNT;
@numthreads(1, 1, 1)
class Fruchterman {
  @in @out
  u_Data: vec4[];
  @in
  u_K: float;
  @in
  u_K2: float;
  
  @in
  u_Center: vec2;
  @in
  u_Gravity: float;
  @in
  u_ClusterGravity: float;
  @in
  u_Speed: float;
  @in
  u_MaxDisplace: float;
  @in
  u_Clustering: float;
  @in
  u_AttributeArray: vec4[];
  @in
  u_ClusterCenters: vec4[];
  calcRepulsive(i: int, currentNode: vec4): vec2 {
    let dx = 0, dy = 0;
    for (let j = 0; j < VERTEX_COUNT; j++) {
      if (i != j) {
        const nextNode = this.u_Data[j];
        const xDist = currentNode[0] - nextNode[0];
        const yDist = currentNode[1] - nextNode[1];
        const dist = (xDist * xDist + yDist * yDist) + 0.01;
        let param = this.u_K2 / dist;
        
        if (dist > 0.0) {
          dx += param * xDist;
          dy += param * yDist;
          if (xDist == 0 && yDist == 0) {
            const sign = i < j ? 1 : -1;
            dx += param * sign;
            dy += param * sign;
          }
        }
      }
    }
    return [dx, dy];
  }
  calcGravity(currentNode: vec4, nodeAttributes: vec4): vec2 { // 
    let dx = 0, dy = 0;
    const vx = currentNode[0] - this.u_Center[0];
    const vy = currentNode[1] - this.u_Center[1];
    const gf = 0.01 * this.u_K * this.u_Gravity;
    dx = gf * vx;
    dy = gf * vy;
    if (this.u_Clustering == 1) {
      const clusterIdx = int(nodeAttributes[0]);
      const center = this.u_ClusterCenters[clusterIdx];
      const cvx = currentNode[0] - center[0];
      const cvy = currentNode[1] - center[1];
      const dist = sqrt(cvx * cvx + cvy * cvy) + 0.01;
      const parma = this.u_K * this.u_ClusterGravity / dist;
      dx += parma * cvx;
      dy += parma * cvy;
    }
    return [dx, dy];
  }
  calcAttractive(i: int, currentNode: vec4): vec2 {
    let dx = 0, dy = 0;
    const arr_offset = int(floor(currentNode[2] + 0.5));
    const length = int(floor(currentNode[3] + 0.5));
    const node_buffer: vec4;
    for (let p = 0; p < MAX_EDGE_PER_VERTEX; p++) {
      if (p >= length) break;
      const arr_idx = arr_offset + p;
      // when arr_idx % 4 == 0 update currentNodedx_buffer
      const buf_offset = arr_idx - arr_idx / 4 * 4;
      if (p == 0 || buf_offset == 0) {
        node_buffer = this.u_Data[int(arr_idx / 4)];
      }
      const float_j = buf_offset == 0 ? node_buffer[0] :
                      buf_offset == 1 ? node_buffer[1] :
                      buf_offset == 2 ? node_buffer[2] :
                                        node_buffer[3];
      const nextNode = this.u_Data[int(float_j)];
      const xDist = currentNode[0] - nextNode[0];
      const yDist = currentNode[1] - nextNode[1];
      const dist = sqrt(xDist * xDist + yDist * yDist) + 0.01;
      let attractiveF = dist / this.u_K;
    
      if (dist > 0.0) {
        dx -= xDist * attractiveF;
        dy -= yDist * attractiveF;
        if (xDist == 0 && yDist == 0) {
          const sign = i < int(float_j) ? 1 : -1;
          dx -= sign * attractiveF;
          dy -= sign * attractiveF;
        }
      }
    }
    return [dx, dy];
  }
  @main
  compute() {
    const i = globalInvocationID.x;
    const currentNode = this.u_Data[i];
    let dx = 0, dy = 0;
    if (i >= VERTEX_COUNT) {
      this.u_Data[i] = currentNode;
      return;
    }

    // [gravity, fx, fy, 0]
    const nodeAttributes = this.u_AttributeArray[i];

    if (nodeAttributes[1] != 0 && nodeAttributes[2] != 0) {
      // the node is fixed
      this.u_Data[i] = [
        nodeAttributes[1],
        nodeAttributes[2],
        currentNode[2],
        currentNode[3]
      ];
      return;
    }

    // repulsive
    const repulsive = this.calcRepulsive(i, currentNode);
    dx += repulsive[0];
    dy += repulsive[1];
    // attractive
    const attractive = this.calcAttractive(i, currentNode);
    dx += attractive[0];
    dy += attractive[1];
    // gravity
    const gravity = this.calcGravity(currentNode, nodeAttributes);
    dx -= gravity[0];
    dy -= gravity[1];
    // speed
    dx *= this.u_Speed;
    dy *= this.u_Speed;

    // move
    const distLength = sqrt(dx * dx + dy * dy);
    if (distLength > 0.0) {
      const limitedDist = min(this.u_MaxDisplace * this.u_Speed, distLength);
      this.u_Data[i] = [
        currentNode[0] + dx / distLength * limitedDist,
        currentNode[1] + dy / distLength * limitedDist,
        currentNode[2],
        currentNode[3]
      ];
    }
  }
}
`;
Ra.fruchtermanBundle = '{"shaders":{"WGSL":"import \\"GLSL.std.450\\" as std;\\n\\n\\n# var gWebGPUDebug : bool = false;\\n# var gWebGPUDebugOutput : vec4<f32> = vec4<f32>(0.0);\\n\\n[[builtin global_invocation_id]] var<in> globalInvocationID : vec3<u32>;\\n# [[builtin work_group_size]] var<in> workGroupSize : vec3<u32>;\\n# [[builtin work_group_id]] var<in> workGroupID : vec3<u32>;\\n[[builtin local_invocation_id]] var<in> localInvocationID : vec3<u32>;\\n# [[builtin num_work_groups]] var<in> numWorkGroups : vec3<u32>;\\n[[builtin local_invocation_idx]] var<in> localInvocationIndex : u32;\\n\\ntype GWebGPUParams = [[block]] struct {\\n  [[offset 0]] u_K : f32;\\n  [[offset 4]] u_K2 : f32;\\n  [[offset 8]] u_Center : vec2<f32>;\\n  [[offset 16]] u_Gravity : f32;\\n  [[offset 20]] u_ClusterGravity : f32;\\n  [[offset 24]] u_Speed : f32;\\n  [[offset 28]] u_MaxDisplace : f32;\\n  [[offset 32]] u_Clustering : f32;\\n};\\n[[binding 0, set 0]] var<uniform> gWebGPUUniformParams : GWebGPUParams;\\ntype GWebGPUBuffer0 = [[block]] struct {\\n  [[offset 0]] u_Data : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 1, set 0]] var<storage_buffer> gWebGPUBuffer0 : GWebGPUBuffer0;\\ntype GWebGPUBuffer1 = [[block]] struct {\\n  [[offset 0]] u_AttributeArray : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 2, set 0]] var<storage_buffer> gWebGPUBuffer1 : GWebGPUBuffer1;\\ntype GWebGPUBuffer2 = [[block]] struct {\\n  [[offset 0]] u_ClusterCenters : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 3, set 0]] var<storage_buffer> gWebGPUBuffer2 : GWebGPUBuffer2;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nfn calcRepulsive(i : i32, currentNode : vec4<f32>) -> vec2<f32> {var dx : f32 = 0.0;\\nvar dy : f32 = 0.0;\\nfor (var j : i32 = 0; j < __DefineValuePlaceholder__VERTEX_COUNT; j = j + 1) {if (i != j) {var nextNode : vec4<f32> = gWebGPUBuffer0.u_Data[j];\\nvar xDist : f32 = currentNode.x - nextNode.x;\\nvar yDist : f32 = currentNode.y - nextNode.y;\\nvar dist : f32 = ((xDist * xDist) + (yDist * yDist)) + 0.01;\\nvar param : f32 = gWebGPUUniformParams.u_K2 / dist;\\nif (dist > 0.0) {dx = dx + param * xDist;\\ndy = dy + param * yDist;\\nif ((xDist == 0.0) && (yDist == 0.0)) {var sign : f32 = select(1.0, -1.0, i < j);\\ndx = dx + param * std::sign;\\ndy = dy + param * std::sign;}}}}\\nreturn vec2<f32>(dx, dy);}\\nfn calcGravity(currentNode : vec4<f32>, nodeAttributes : vec4<f32>) -> vec2<f32> {var dx : f32 = 0.0;\\nvar dy : f32 = 0.0;\\nvar vx : f32 = currentNode.x - gWebGPUUniformParams.u_Center.x;\\nvar vy : f32 = currentNode.y - gWebGPUUniformParams.u_Center.y;\\nvar gf : f32 = (0.01 * gWebGPUUniformParams.u_K) * gWebGPUUniformParams.u_Gravity;\\ndx = gf * vx;\\ndy = gf * vy;\\nif (gWebGPUUniformParams.u_Clustering == 1.0) {var clusterIdx : i32 = i32(nodeAttributes.x);\\nvar center : vec4<f32> = gWebGPUBuffer2.u_ClusterCenters[clusterIdx];\\nvar cvx : f32 = currentNode.x - center.x;\\nvar cvy : f32 = currentNode.y - center.y;\\nvar dist : f32 = std::sqrt((cvx * cvx) + (cvy * cvy)) + 0.01;\\nvar parma : f32 = (gWebGPUUniformParams.u_K * gWebGPUUniformParams.u_ClusterGravity) / dist;\\ndx = dx + parma * cvx;\\ndy = dy + parma * cvy;}\\nreturn vec2<f32>(dx, dy);}\\nfn calcAttractive(i : i32, currentNode : vec4<f32>) -> vec2<f32> {var dx : f32 = 0.0;\\nvar dy : f32 = 0.0;\\nvar arr_offset : i32 = i32(std::floor(currentNode.z + 0.5));\\nvar length : i32 = i32(std::floor(currentNode.w + 0.5));\\nvar node_buffer : vec4<f32>;\\nfor (var p : i32 = 0; p < __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX; p = p + 1) {if (p >= length) {break;}\\nvar arr_idx : i32 = arr_offset + i32(p);\\nvar buf_offset : i32 = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = gWebGPUBuffer0.u_Data[i32(arr_idx / 4)];}\\nvar float_j : f32 = select(node_buffer.x, select(node_buffer.y, select(node_buffer.z, node_buffer.w, buf_offset == 2), buf_offset == 1), buf_offset == 0);\\nvar nextNode : vec4<f32> = gWebGPUBuffer0.u_Data[i32(float_j)];\\nvar xDist : f32 = currentNode.x - nextNode.x;\\nvar yDist : f32 = currentNode.y - nextNode.y;\\nvar dist : f32 = std::sqrt((xDist * xDist) + (yDist * yDist)) + 0.01;\\nvar attractiveF : f32 = dist / gWebGPUUniformParams.u_K;\\nif (dist > 0.0) {dx = dx - xDist * attractiveF;\\ndy = dy - yDist * attractiveF;\\nif ((xDist == 0.0) && (yDist == 0.0)) {var sign : f32 = select(1.0, -1.0, i < i32(float_j));\\ndx = dx - std::sign * attractiveF;\\ndy = dy - std::sign * attractiveF;}}}\\nreturn vec2<f32>(dx, dy);}\\nfn main() -> void {var i : i32 = globalInvocationID.x;\\nvar currentNode : vec4<f32> = gWebGPUBuffer0.u_Data[i];\\nvar dx : f32 = 0.0;\\nvar dy : f32 = 0.0;\\nif (i >= __DefineValuePlaceholder__VERTEX_COUNT) {gWebGPUBuffer0.u_Data[i] = currentNode;\\nreturn ;}\\nvar nodeAttributes : vec4<f32> = gWebGPUBuffer1.u_AttributeArray[i];\\nif ((nodeAttributes.y != 0.0) && (nodeAttributes.z != 0.0)) {gWebGPUBuffer0.u_Data[i] = vec4<f32>(nodeAttributes.y, nodeAttributes.z, currentNode.z, currentNode.w);\\nreturn ;}\\nvar repulsive : vec2<f32> = calcRepulsive(i, currentNode);\\ndx = dx + repulsive.x;\\ndy = dy + repulsive.y;\\nvar attractive : vec2<f32> = calcAttractive(i, currentNode);\\ndx = dx + attractive.x;\\ndy = dy + attractive.y;\\nvar gravity : vec2<f32> = calcGravity(currentNode, nodeAttributes);\\ndx = dx - gravity.x;\\ndy = dy - gravity.y;\\ndx = dx * gWebGPUUniformParams.u_Speed;\\ndy = dy * gWebGPUUniformParams.u_Speed;\\nvar distLength : f32 = std::sqrt((dx * dx) + (dy * dy));\\nif (distLength > 0.0) {var limitedDist : f32 = std::min(gWebGPUUniformParams.u_MaxDisplace * gWebGPUUniformParams.u_Speed, distLength);\\ngWebGPUBuffer0.u_Data[i] = vec4<f32>(currentNode.x + ((dx / distLength) * limitedDist), currentNode.y + ((dy / distLength) * limitedDist), currentNode.z, currentNode.w);}\\nreturn;}\\n\\nentry_point compute as \\"main\\" = main;\\n","GLSL450":"\\n\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\nivec3 globalInvocationID = ivec3(gl_GlobalInvocationID);\\nivec3 workGroupSize = ivec3(1,1,1);\\nivec3 workGroupID = ivec3(gl_WorkGroupID);\\nivec3 localInvocationID = ivec3(gl_LocalInvocationID);\\nivec3 numWorkGroups = ivec3(gl_NumWorkGroups);\\nint localInvocationIndex = int(gl_LocalInvocationIndex);\\n\\nlayout(std140, set = 0, binding = 0) uniform GWebGPUParams {\\n  float u_K;\\n  float u_K2;\\n  vec2 u_Center;\\n  float u_Gravity;\\n  float u_ClusterGravity;\\n  float u_Speed;\\n  float u_MaxDisplace;\\n  float u_Clustering;\\n} gWebGPUUniformParams;\\nlayout(std430, set = 0, binding = 1) buffer   GWebGPUBuffer0 {\\n  vec4 u_Data[];\\n} gWebGPUBuffer0;\\n\\nlayout(std430, set = 0, binding = 2) buffer readonly  GWebGPUBuffer1 {\\n  vec4 u_AttributeArray[];\\n} gWebGPUBuffer1;\\n\\nlayout(std430, set = 0, binding = 3) buffer readonly  GWebGPUBuffer2 {\\n  vec4 u_ClusterCenters[];\\n} gWebGPUBuffer2;\\n\\n\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\nlayout (\\n  local_size_x = 1,\\n  local_size_y = 1,\\n  local_size_z = 1\\n) in;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nvec2 calcRepulsive(int i, vec4 currentNode) {float dx = 0.0;\\nfloat dy = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = gWebGPUBuffer0.u_Data[j];\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = ((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat param = gWebGPUUniformParams.u_K2 / dist;\\nif (dist > 0.0) {dx += param * xDist;\\ndy += param * yDist;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < j) ? (1.0) : (-1.0);\\ndx += param * sign;\\ndy += param * sign;}}}}\\nreturn vec2(dx, dy);}\\nvec2 calcGravity(vec4 currentNode, vec4 nodeAttributes) {float dx = 0.0;\\nfloat dy = 0.0;\\nfloat vx = currentNode.x - gWebGPUUniformParams.u_Center.x;\\nfloat vy = currentNode.y - gWebGPUUniformParams.u_Center.y;\\nfloat gf = (0.01 * gWebGPUUniformParams.u_K) * gWebGPUUniformParams.u_Gravity;\\ndx = gf * vx;\\ndy = gf * vy;\\nif (gWebGPUUniformParams.u_Clustering == 1.0) {int clusterIdx = int(nodeAttributes.x);\\nvec4 center = gWebGPUBuffer2.u_ClusterCenters[clusterIdx];\\nfloat cvx = currentNode.x - center.x;\\nfloat cvy = currentNode.y - center.y;\\nfloat dist = sqrt((cvx * cvx) + (cvy * cvy)) + 0.01;\\nfloat parma = (gWebGPUUniformParams.u_K * gWebGPUUniformParams.u_ClusterGravity) / dist;\\ndx += parma * cvx;\\ndy += parma * cvy;}\\nreturn vec2(dx, dy);}\\nvec2 calcAttractive(int i, vec4 currentNode) {float dx = 0.0;\\nfloat dy = 0.0;\\nint arr_offset = int(floor(currentNode.z + 0.5));\\nint length = int(floor(currentNode.w + 0.5));\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + int(p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = gWebGPUBuffer0.u_Data[int(arr_idx / 4)];}\\nfloat float_j = (buf_offset == 0) ? (node_buffer.x) : ((buf_offset == 1) ? (node_buffer.y) : ((buf_offset == 2) ? (node_buffer.z) : (node_buffer.w)));\\nvec4 nextNode = gWebGPUBuffer0.u_Data[int(float_j)];\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = sqrt((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat attractiveF = dist / gWebGPUUniformParams.u_K;\\nif (dist > 0.0) {dx -= xDist * attractiveF;\\ndy -= yDist * attractiveF;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < int(float_j)) ? (1.0) : (-1.0);\\ndx -= sign * attractiveF;\\ndy -= sign * attractiveF;}}}\\nreturn vec2(dx, dy);}\\nvoid main() {int i = globalInvocationID.x;\\nvec4 currentNode = gWebGPUBuffer0.u_Data[i];\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nif (i >= VERTEX_COUNT) {gWebGPUBuffer0.u_Data[i] = currentNode;\\nreturn ;}\\nvec4 nodeAttributes = gWebGPUBuffer1.u_AttributeArray[i];\\nif ((nodeAttributes.y != 0.0) && (nodeAttributes.z != 0.0)) {gWebGPUBuffer0.u_Data[i] = vec4(nodeAttributes.y, nodeAttributes.z, currentNode.z, currentNode.w);\\nreturn ;}\\nvec2 repulsive = calcRepulsive(i, currentNode);\\ndx += repulsive.x;\\ndy += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode);\\ndx += attractive.x;\\ndy += attractive.y;\\nvec2 gravity = calcGravity(currentNode, nodeAttributes);\\ndx -= gravity.x;\\ndy -= gravity.y;\\ndx *= gWebGPUUniformParams.u_Speed;\\ndy *= gWebGPUUniformParams.u_Speed;\\nfloat distLength = sqrt((dx * dx) + (dy * dy));\\nif (distLength > 0.0) {float limitedDist = min(gWebGPUUniformParams.u_MaxDisplace * gWebGPUUniformParams.u_Speed, distLength);\\ngWebGPUBuffer0.u_Data[i] = vec4(currentNode.x + ((dx / distLength) * limitedDist), currentNode.y + ((dy / distLength) * limitedDist), currentNode.z, currentNode.w);}}\\n","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_K;\\nuniform float u_K2;\\nuniform vec2 u_Center;\\nuniform float u_Gravity;\\nuniform float u_ClusterGravity;\\nuniform float u_Speed;\\nuniform float u_MaxDisplace;\\nuniform float u_Clustering;\\nuniform sampler2D u_AttributeArray;\\nuniform vec2 u_AttributeArraySize;\\nvec4 getDatau_AttributeArray(vec2 address2D) {\\n  return vec4(texture2D(u_AttributeArray, address2D).rgba);\\n}\\nvec4 getDatau_AttributeArray(float address1D) {\\n  return getDatau_AttributeArray(addrTranslation_1Dto2D(address1D, u_AttributeArraySize));\\n}\\nvec4 getDatau_AttributeArray(int address1D) {\\n  return getDatau_AttributeArray(float(address1D));\\n}\\nuniform sampler2D u_ClusterCenters;\\nuniform vec2 u_ClusterCentersSize;\\nvec4 getDatau_ClusterCenters(vec2 address2D) {\\n  return vec4(texture2D(u_ClusterCenters, address2D).rgba);\\n}\\nvec4 getDatau_ClusterCenters(float address1D) {\\n  return getDatau_ClusterCenters(addrTranslation_1Dto2D(address1D, u_ClusterCentersSize));\\n}\\nvec4 getDatau_ClusterCenters(int address1D) {\\n  return getDatau_ClusterCenters(float(address1D));\\n}\\nvec2 calcRepulsive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = getDatau_Data(j);\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = ((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat param = u_K2 / dist;\\nif (dist > 0.0) {dx += param * xDist;\\ndy += param * yDist;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < j) ? (1.0) : (-1.0);\\ndx += param * sign;\\ndy += param * sign;}}}}\\nreturn vec2(dx, dy);}\\nvec2 calcGravity(vec4 currentNode, vec4 nodeAttributes) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nfloat vx = currentNode.x - u_Center.x;\\nfloat vy = currentNode.y - u_Center.y;\\nfloat gf = (0.01 * u_K) * u_Gravity;\\ndx = gf * vx;\\ndy = gf * vy;\\nif (u_Clustering == 1.0) {int clusterIdx = int(nodeAttributes.x);\\nvec4 center = getDatau_ClusterCenters(clusterIdx);\\nfloat cvx = currentNode.x - center.x;\\nfloat cvy = currentNode.y - center.y;\\nfloat dist = sqrt((cvx * cvx) + (cvy * cvy)) + 0.01;\\nfloat parma = (u_K * u_ClusterGravity) / dist;\\ndx += parma * cvx;\\ndy += parma * cvy;}\\nreturn vec2(dx, dy);}\\nvec2 calcAttractive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nint arr_offset = int(floor(currentNode.z + 0.5));\\nint length = int(floor(currentNode.w + 0.5));\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + int(p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = getDatau_Data(int(arr_idx / 4));}\\nfloat float_j = (buf_offset == 0) ? (node_buffer.x) : ((buf_offset == 1) ? (node_buffer.y) : ((buf_offset == 2) ? (node_buffer.z) : (node_buffer.w)));\\nvec4 nextNode = getDatau_Data(int(float_j));\\nfloat xDist = currentNode.x - nextNode.x;\\nfloat yDist = currentNode.y - nextNode.y;\\nfloat dist = sqrt((xDist * xDist) + (yDist * yDist)) + 0.01;\\nfloat attractiveF = dist / u_K;\\nif (dist > 0.0) {dx -= xDist * attractiveF;\\ndy -= yDist * attractiveF;\\nif ((xDist == 0.0) && (yDist == 0.0)) {float sign = (i < int(float_j)) ? (1.0) : (-1.0);\\ndx -= sign * attractiveF;\\ndy -= sign * attractiveF;}}}\\nreturn vec2(dx, dy);}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 currentNode = getDatau_Data(i);\\nfloat dx = 0.0;\\nfloat dy = 0.0;\\nif (i >= VERTEX_COUNT) {gl_FragColor = vec4(currentNode);\\nreturn ;}\\nvec4 nodeAttributes = getDatau_AttributeArray(i);\\nif ((nodeAttributes.y != 0.0) && (nodeAttributes.z != 0.0)) {gl_FragColor = vec4(vec4(nodeAttributes.y, nodeAttributes.z, currentNode.z, currentNode.w));\\nreturn ;}\\nvec2 repulsive = calcRepulsive(i, currentNode);\\ndx += repulsive.x;\\ndy += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode);\\ndx += attractive.x;\\ndy += attractive.y;\\nvec2 gravity = calcGravity(currentNode, nodeAttributes);\\ndx -= gravity.x;\\ndy -= gravity.y;\\ndx *= u_Speed;\\ndy *= u_Speed;\\nfloat distLength = sqrt((dx * dx) + (dy * dy));\\nif (distLength > 0.0) {float limitedDist = min(u_MaxDisplace * u_Speed, distLength);\\ngl_FragColor = vec4(vec4(currentNode.x + ((dx / distLength) * limitedDist), currentNode.y + ((dy / distLength) * limitedDist), currentNode.z, currentNode.w));}if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"MAX_EDGE_PER_VERTEX","type":"Float","runtime":true},{"name":"VERTEX_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]},{"name":"u_K","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_K2","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Center","type":"vec2<f32>","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Gravity","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterGravity","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Speed","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_MaxDisplace","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_Clustering","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AttributeArray","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterCenters","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_Data","size":[1,1],"length":1},"needPingpong":true}}';
Ra.clusterCode = `
import { globalInvocationID } from 'g-webgpu';
const VERTEX_COUNT;
const CLUSTER_COUNT;
@numthreads(1, 1, 1)
class CalcCenter {
  @in
  u_Data: vec4[];
  @in
  u_NodeAttributes: vec4[]; // [[clusterIdx, 0, 0, 0], ...]
  @in @out
  u_ClusterCenters: vec4[]; // [[cx, cy, nodeCount, clusterIdx], ...]
  @main
  compute() {
    const i = globalInvocationID.x;
    const center = this.u_ClusterCenters[i];
    let sumx = 0;
    let sumy = 0;
    let count = 0;
    for (let j = 0; j < VERTEX_COUNT; j++) {
      const attributes = this.u_NodeAttributes[j];
      const clusterIdx = int(attributes[0]);
      const vertex = this.u_Data[j];
      if (clusterIdx == i) {
        sumx += vertex.x;
        sumy += vertex.y;
        count += 1;
      }
    }
    this.u_ClusterCenters[i] = [
      sumx / count,
      sumy / count,
      count,
      i
    ];
  }
}
`;
Ra.clusterBundle = '{"shaders":{"WGSL":"import \\"GLSL.std.450\\" as std;\\n\\n\\n# var gWebGPUDebug : bool = false;\\n# var gWebGPUDebugOutput : vec4<f32> = vec4<f32>(0.0);\\n\\n[[builtin global_invocation_id]] var<in> globalInvocationID : vec3<u32>;\\n# [[builtin work_group_size]] var<in> workGroupSize : vec3<u32>;\\n# [[builtin work_group_id]] var<in> workGroupID : vec3<u32>;\\n[[builtin local_invocation_id]] var<in> localInvocationID : vec3<u32>;\\n# [[builtin num_work_groups]] var<in> numWorkGroups : vec3<u32>;\\n[[builtin local_invocation_idx]] var<in> localInvocationIndex : u32;\\n\\n\\ntype GWebGPUBuffer0 = [[block]] struct {\\n  [[offset 0]] u_Data : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 0, set 0]] var<storage_buffer> gWebGPUBuffer0 : GWebGPUBuffer0;\\ntype GWebGPUBuffer1 = [[block]] struct {\\n  [[offset 0]] u_NodeAttributes : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 1, set 0]] var<storage_buffer> gWebGPUBuffer1 : GWebGPUBuffer1;\\ntype GWebGPUBuffer2 = [[block]] struct {\\n  [[offset 0]] u_ClusterCenters : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 2, set 0]] var<storage_buffer> gWebGPUBuffer2 : GWebGPUBuffer2;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nfn main() -> void {var i : i32 = globalInvocationID.x;\\nvar center : vec4<f32> = gWebGPUBuffer2.u_ClusterCenters[i];\\nvar sumx : f32 = 0.0;\\nvar sumy : f32 = 0.0;\\nvar count : f32 = 0.0;\\nfor (var j : i32 = 0; j < __DefineValuePlaceholder__VERTEX_COUNT; j = j + 1) {var attributes : vec4<f32> = gWebGPUBuffer1.u_NodeAttributes[j];\\nvar clusterIdx : i32 = i32(attributes.x);\\nvar vertex : vec4<f32> = gWebGPUBuffer0.u_Data[j];\\nif (clusterIdx == i) {sumx = sumx + vertex.x;\\nsumy = sumy + vertex.y;\\ncount = count + 1.0;}}\\ngWebGPUBuffer2.u_ClusterCenters[i] = vec4<f32>(sumx / count, sumy / count, count, i);\\nreturn;}\\n\\nentry_point compute as \\"main\\" = main;\\n","GLSL450":"\\n\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\nivec3 globalInvocationID = ivec3(gl_GlobalInvocationID);\\nivec3 workGroupSize = ivec3(1,1,1);\\nivec3 workGroupID = ivec3(gl_WorkGroupID);\\nivec3 localInvocationID = ivec3(gl_LocalInvocationID);\\nivec3 numWorkGroups = ivec3(gl_NumWorkGroups);\\nint localInvocationIndex = int(gl_LocalInvocationIndex);\\n\\n\\nlayout(std430, set = 0, binding = 0) buffer readonly  GWebGPUBuffer0 {\\n  vec4 u_Data[];\\n} gWebGPUBuffer0;\\n\\nlayout(std430, set = 0, binding = 1) buffer readonly  GWebGPUBuffer1 {\\n  vec4 u_NodeAttributes[];\\n} gWebGPUBuffer1;\\n\\nlayout(std430, set = 0, binding = 2) buffer   GWebGPUBuffer2 {\\n  vec4 u_ClusterCenters[];\\n} gWebGPUBuffer2;\\n\\n\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define CLUSTER_COUNT __DefineValuePlaceholder__CLUSTER_COUNT\\nlayout (\\n  local_size_x = 1,\\n  local_size_y = 1,\\n  local_size_z = 1\\n) in;\\n\\n\\n\\nvoid main() {int i = globalInvocationID.x;\\nvec4 center = gWebGPUBuffer2.u_ClusterCenters[i];\\nfloat sumx = 0.0;\\nfloat sumy = 0.0;\\nfloat count = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 attributes = gWebGPUBuffer1.u_NodeAttributes[j];\\nint clusterIdx = int(attributes.x);\\nvec4 vertex = gWebGPUBuffer0.u_Data[j];\\nif (clusterIdx == i) {sumx += vertex.x;\\nsumy += vertex.y;\\ncount += 1.0;}}\\ngWebGPUBuffer2.u_ClusterCenters[i] = vec4(sumx / count, sumy / count, count, i);}\\n","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define CLUSTER_COUNT __DefineValuePlaceholder__CLUSTER_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform sampler2D u_NodeAttributes;\\nuniform vec2 u_NodeAttributesSize;\\nvec4 getDatau_NodeAttributes(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributes, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributes(float address1D) {\\n  return getDatau_NodeAttributes(addrTranslation_1Dto2D(address1D, u_NodeAttributesSize));\\n}\\nvec4 getDatau_NodeAttributes(int address1D) {\\n  return getDatau_NodeAttributes(float(address1D));\\n}\\nuniform sampler2D u_ClusterCenters;\\nuniform vec2 u_ClusterCentersSize;\\nvec4 getDatau_ClusterCenters(vec2 address2D) {\\n  return vec4(texture2D(u_ClusterCenters, address2D).rgba);\\n}\\nvec4 getDatau_ClusterCenters(float address1D) {\\n  return getDatau_ClusterCenters(addrTranslation_1Dto2D(address1D, u_ClusterCentersSize));\\n}\\nvec4 getDatau_ClusterCenters(int address1D) {\\n  return getDatau_ClusterCenters(float(address1D));\\n}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 center = getDatau_ClusterCenters(i);\\nfloat sumx = 0.0;\\nfloat sumy = 0.0;\\nfloat count = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 attributes = getDatau_NodeAttributes(j);\\nint clusterIdx = int(attributes.x);\\nvec4 vertex = getDatau_Data(j);\\nif (clusterIdx == i) {sumx += vertex.x;\\nsumy += vertex.y;\\ncount += 1.0;}}\\ngl_FragColor = vec4(vec4(sumx / count, sumy / count, count, i));if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"VERTEX_COUNT","type":"Float","runtime":true},{"name":"CLUSTER_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributes","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_ClusterCenters","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_ClusterCenters","size":[1,1],"length":1},"needPingpong":true}}';
var Jve = Oe && Oe.__extends || function() {
  var r = function(t, e) {
    return r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(n, i) {
      n.__proto__ = i;
    } || function(n, i) {
      for (var a in i)
        Object.prototype.hasOwnProperty.call(i, a) && (n[a] = i[a]);
    }, r(t, e);
  };
  return function(t, e) {
    if (typeof e != "function" && e !== null)
      throw new TypeError("Class extends value " + String(e) + " is not a constructor or null");
    r(t, e);
    function n() {
      this.constructor = t;
    }
    t.prototype = e === null ? Object.create(e) : (n.prototype = e.prototype, new n());
  };
}(), ev = Oe && Oe.__awaiter || function(r, t, e, n) {
  function i(a) {
    return a instanceof e ? a : new e(function(o) {
      o(a);
    });
  }
  return new (e || (e = Promise))(function(a, o) {
    function s(l) {
      try {
        f(n.next(l));
      } catch (c) {
        o(c);
      }
    }
    function u(l) {
      try {
        f(n.throw(l));
      } catch (c) {
        o(c);
      }
    }
    function f(l) {
      l.done ? a(l.value) : i(l.value).then(s, u);
    }
    f((n = n.apply(r, t || [])).next());
  });
}, tv = Oe && Oe.__generator || function(r, t) {
  var e = { label: 0, sent: function() {
    if (a[0] & 1)
      throw a[1];
    return a[1];
  }, trys: [], ops: [] }, n, i, a, o;
  return o = { next: s(0), throw: s(1), return: s(2) }, typeof Symbol == "function" && (o[Symbol.iterator] = function() {
    return this;
  }), o;
  function s(f) {
    return function(l) {
      return u([f, l]);
    };
  }
  function u(f) {
    if (n)
      throw new TypeError("Generator is already executing.");
    for (; e; )
      try {
        if (n = 1, i && (a = f[0] & 2 ? i.return : f[0] ? i.throw || ((a = i.return) && a.call(i), 0) : i.next) && !(a = a.call(i, f[1])).done)
          return a;
        switch (i = 0, a && (f = [f[0] & 2, a.value]), f[0]) {
          case 0:
          case 1:
            a = f;
            break;
          case 4:
            return e.label++, { value: f[1], done: !1 };
          case 5:
            e.label++, i = f[1], f = [0];
            continue;
          case 7:
            f = e.ops.pop(), e.trys.pop();
            continue;
          default:
            if (a = e.trys, !(a = a.length > 0 && a[a.length - 1]) && (f[0] === 6 || f[0] === 2)) {
              e = 0;
              continue;
            }
            if (f[0] === 3 && (!a || f[1] > a[0] && f[1] < a[3])) {
              e.label = f[1];
              break;
            }
            if (f[0] === 6 && e.label < a[1]) {
              e.label = a[1], a = f;
              break;
            }
            if (a && e.label < a[2]) {
              e.label = a[2], e.ops.push(f);
              break;
            }
            a[2] && e.ops.pop(), e.trys.pop();
            continue;
        }
        f = t.call(r, e);
      } catch (l) {
        f = [6, l], i = 0;
      } finally {
        n = a = 0;
      }
    if (f[0] & 5)
      throw f[1];
    return { value: f[0] ? f[1] : void 0, done: !0 };
  }
};
Object.defineProperty(_h, "__esModule", { value: !0 });
_h.FruchtermanGPULayout = void 0;
var epe = an, hf = on(), vO = U5, pO = xi, gO = Ra, tpe = Co, rpe = function(r) {
  Jve(t, r);
  function t(e) {
    var n = r.call(this) || this;
    return n.maxIteration = 1e3, n.gravity = 10, n.speed = 1, n.clustering = !1, n.clusterField = "cluster", n.clusterGravity = 10, n.workerEnabled = !1, n.nodes = [], n.edges = [], n.width = 300, n.height = 300, n.nodeMap = {}, n.nodeIdxMap = {}, n.updateCfg(e), n;
  }
  return t.prototype.getDefaultCfg = function() {
    return {
      maxIteration: 1e3,
      gravity: 10,
      speed: 1,
      clustering: !1,
      clusterGravity: 10
    };
  }, t.prototype.execute = function() {
    return ev(this, void 0, void 0, function() {
      var e, n, i, a, o, s = this;
      return tv(this, function(u) {
        switch (u.label) {
          case 0:
            return e = this, n = e.nodes, !n || n.length === 0 ? (e.onLayoutEnd && e.onLayoutEnd(), [2]) : (!e.width && typeof window < "u" && (e.width = window.innerWidth), !e.height && typeof window < "u" && (e.height = window.innerHeight), e.center || (e.center = [e.width / 2, e.height / 2]), i = e.center, n.length === 1 ? (n[0].x = i[0], n[0].y = i[1], e.onLayoutEnd && e.onLayoutEnd(), [2]) : (a = {}, o = {}, n.forEach(function(f, l) {
              (0, hf.isNumber)(f.x) || (f.x = Math.random() * s.width), (0, hf.isNumber)(f.y) || (f.y = Math.random() * s.height), a[f.id] = f, o[f.id] = l;
            }), e.nodeMap = a, e.nodeIdxMap = o, [4, e.run()]));
          case 1:
            return u.sent(), [2];
        }
      });
    });
  }, t.prototype.executeWithWorker = function(e, n) {
    return ev(this, void 0, void 0, function() {
      var i, a, o, s, u, f = this;
      return tv(this, function(l) {
        switch (l.label) {
          case 0:
            return i = this, a = i.nodes, o = i.center, !a || a.length === 0 ? [2] : a.length === 1 ? (a[0].x = o[0], a[0].y = o[1], [2]) : (s = {}, u = {}, a.forEach(function(c, h) {
              (0, hf.isNumber)(c.x) || (c.x = Math.random() * f.width), (0, hf.isNumber)(c.y) || (c.y = Math.random() * f.height), s[c.id] = c, u[c.id] = h;
            }), i.nodeMap = s, i.nodeIdxMap = u, [4, i.run(e, n)]);
          case 1:
            return l.sent(), [2];
        }
      });
    });
  }, t.prototype.run = function(e, n) {
    return ev(this, void 0, void 0, function() {
      var i, a, o, s, u, f, l, c, h, d, v, p, g, y, b, m, x, _, w, E, M, C, S, A, T, P, k = this;
      return tv(this, function(L) {
        switch (L.label) {
          case 0:
            for (i = this, a = i.nodes, o = i.edges, s = i.maxIteration, u = i.center, f = i.height * i.width, l = Math.sqrt(f) / 10, c = f / (a.length + 1), h = Math.sqrt(c), d = i.speed, v = i.clustering, p = (0, pO.attributesToTextureData)([i.clusterField], a), g = p.array, y = p.count, a.forEach(function(O, D) {
              var G = 0, R = 0;
              (0, hf.isNumber)(O.fx) && (0, hf.isNumber)(O.fy) && (G = O.fx || 1e-3, R = O.fy || 1e-3), g[4 * D + 1] = G, g[4 * D + 2] = R;
            }), b = a.length, m = (0, pO.buildTextureData)(a, o), x = m.maxEdgePerVetex, _ = m.array, w = i.workerEnabled, w ? E = vO.World.create({
              canvas: e,
              engineOptions: {
                supportCompute: !0
              }
            }) : E = vO.World.create({
              engineOptions: {
                supportCompute: !0
              }
            }), M = i.onLayoutEnd, C = [], S = 0; S < y; S++)
              C.push(0, 0, 0, 0);
            return A = E.createKernel(gO.fruchtermanBundle).setDispatch([b, 1, 1]).setBinding({
              u_Data: _,
              u_K: h,
              u_K2: c,
              u_Gravity: i.gravity,
              u_ClusterGravity: i.clusterGravity || i.gravity || 1,
              u_Speed: d,
              u_MaxDisplace: l,
              u_Clustering: v ? 1 : 0,
              u_Center: u,
              u_AttributeArray: g,
              u_ClusterCenters: C,
              MAX_EDGE_PER_VERTEX: x,
              VERTEX_COUNT: b
            }), v && (T = E.createKernel(gO.clusterBundle).setDispatch([y, 1, 1]).setBinding({
              u_Data: _,
              u_NodeAttributes: g,
              u_ClusterCenters: C,
              VERTEX_COUNT: b,
              CLUSTER_COUNT: y
            })), P = function() {
              return ev(k, void 0, void 0, function() {
                var O, D;
                return tv(this, function(G) {
                  switch (G.label) {
                    case 0:
                      O = 0, G.label = 1;
                    case 1:
                      return O < s ? [4, A.execute()] : [3, 6];
                    case 2:
                      return G.sent(), v ? (T.setBinding({
                        u_Data: A
                      }), [4, T.execute()]) : [3, 4];
                    case 3:
                      G.sent(), A.setBinding({
                        u_ClusterCenters: T
                      }), G.label = 4;
                    case 4:
                      A.setBinding({
                        u_MaxDisplace: l *= 0.99
                      }), G.label = 5;
                    case 5:
                      return O++, [3, 1];
                    case 6:
                      return [4, A.getOutput()];
                    case 7:
                      return D = G.sent(), e ? n.postMessage({
                        type: tpe.LAYOUT_MESSAGE.GPUEND,
                        vertexEdgeData: D
                      }) : a.forEach(function(R, F) {
                        var q = D[4 * F], ne = D[4 * F + 1];
                        R.x = q, R.y = ne;
                      }), M && M(), [2];
                  }
                });
              });
            }, [4, P()];
          case 1:
            return L.sent(), [2];
        }
      });
    });
  }, t.prototype.getType = function() {
    return "fruchterman-gpu";
  }, t;
}(epe.Base);
_h.FruchtermanGPULayout = rpe;
var Eh = {}, Ba = {};
Object.defineProperty(Ba, "__esModule", { value: !0 });
Ba.aveMovementBundle = Ba.aveMovementCode = Ba.gForceBundle = Ba.gForceCode = void 0;
Ba.gForceCode = `
import { globalInvocationID } from 'g-webgpu';

const MAX_EDGE_PER_VERTEX;
const VERTEX_COUNT;
const SHIFT_20 = 1048576;

@numthreads(1, 1, 1)
class GGForce {
  @in @out
  u_Data: vec4[];

  @in
  u_damping: float;
  
  @in
  u_maxSpeed: float;

  @in
  u_minMovement: float;

  @in
  u_AveMovement: vec4[];

  @in
  u_coulombDisScale: float;

  @in
  u_factor: float;

  @in
  u_NodeAttributeArray1: vec4[];

  @in
  u_NodeAttributeArray2: vec4[];

  @in
  u_interval: float;

  unpack_float(packedValue: float): ivec2 {
    const packedIntValue = int(packedValue);
    const v0 = packedIntValue / SHIFT_20;
    return [v0, packedIntValue - v0 * SHIFT_20];
  }

  calcRepulsive(i: int, currentNode: vec4): vec2 {
    let ax = 0, ay = 0;
    for (let j: int = 0; j < VERTEX_COUNT; j++) {
      if (i != j) {
        const nextNode = this.u_Data[j];
        const vx = currentNode[0] - nextNode[0];
        const vy = currentNode[1] - nextNode[1];
        const dist = sqrt(vx * vx + vy * vy) + 0.01;
        const n_dist = (dist + 0.1) * this.u_coulombDisScale;
        const direx = vx / dist;
        const direy = vy / dist;
        const attributesi = this.u_NodeAttributeArray1[i];
        const attributesj = this.u_NodeAttributeArray1[j];
        const massi = attributesi[0];
        const nodeStrengthi = attributesi[2];
        const nodeStrengthj = attributesj[2];
        const nodeStrength = (nodeStrengthi + nodeStrengthj) / 2;
        // const param = nodeStrength * this.u_factor / (n_dist * n_dist * massi);
        const param = nodeStrength * this.u_factor / (n_dist * n_dist);
        ax += direx * param;
        ay += direy * param;
      }
    }
    return [ax, ay];
  }

  calcGravity(i: int, currentNode: vec4, attributes2: vec4): vec2 {
    // note: attributes2 = [centerX, centerY, gravity, 0]

    const vx = currentNode[0] - attributes2[0];
    const vy = currentNode[1] - attributes2[1];
    
    const ax = vx * attributes2[2];
    const ay = vy * attributes2[2];
    
    return [ax, ay];
  }

  calcAttractive(i: int, currentNode: vec4, attributes1: vec4): vec2 {
    // note: attributes1 = [mass, degree, nodeSterngth, 0]

    const mass = attributes1[0];
    let ax = 0, ay = 0;
    // const arr_offset = int(floor(currentNode[2] + 0.5));
    // const length = int(floor(currentNode[3] + 0.5));

    const compressed = this.unpack_float(currentNode[2]);
    const length = compressed[0];
    const arr_offset = compressed[1];

    const node_buffer: vec4;
    for (let p: int = 0; p < MAX_EDGE_PER_VERTEX; p++) {
      if (p >= length) break;
      const arr_idx = arr_offset + 4 * p; // i \u8282\u70B9\u7684\u7B2C p \u6761\u8FB9\u5F00\u59CB\u7684\u5C0F\u683C\u5B50\u4F4D\u7F6E
      const buf_offset = arr_idx - arr_idx / 4 * 4;
      if (p == 0 || buf_offset == 0) {
        node_buffer = this.u_Data[int(arr_idx / 4)]; // \u5927\u683C\u5B50\uFF0C\u5927\u683C\u5B50\u4F4D\u7F6E=\u5C0F\u4E2A\u5B50\u4F4D\u7F6E / 4\uFF0C
      }

      let float_j: float = node_buffer[0];

      const nextNode = this.u_Data[int(float_j)];
      const vx = nextNode[0] - currentNode[0];
      const vy = nextNode[1] - currentNode[1];
      const dist = sqrt(vx * vx + vy * vy) + 0.01;
      const direx = vx / dist;
      const direy = vy / dist;
      const edgeLength = node_buffer[1];
      const edgeStrength = node_buffer[2];
      const diff: float = edgeLength - dist;//edgeLength
      // const param = diff * this.u_stiffness / mass; //
      const param = diff * edgeStrength / mass; // 
      ax -= direx * param;
      ay -= direy * param;
    }
    return [ax, ay];
  }

  @main
  compute() {
    const i = globalInvocationID.x;
    const currentNode = this.u_Data[i];
    const movement = u_AveMovement[0];
    let ax = 0, ay = 0;

    if (i >= VERTEX_COUNT || movement.x < u_minMovement) {
      this.u_Data[i] = currentNode;
      return;
    }

    // \u6BCF\u4E2A\u8282\u70B9\u5C5E\u6027\u5360\u4E24\u4E2A\u6570\u7EC4\u4E2D\u5404\u4E00\u683C
    // [mass, degree, nodeStrength, fx]
    const nodeAttributes1 = this.u_NodeAttributeArray1[i];
    // [centerX, centerY, centerGravity, fy]
    const nodeAttributes2 = this.u_NodeAttributeArray2[i];

    // repulsive
    const repulsive = this.calcRepulsive(i, currentNode);
    ax += repulsive[0];
    ay += repulsive[1];

    // attractive
    const attractive = this.calcAttractive(i, currentNode, nodeAttributes1);
    ax += attractive[0];
    ay += attractive[1];

    // gravity
    const gravity = this.calcGravity(i, currentNode, nodeAttributes2);
    ax -= gravity[0];
    ay -= gravity[1];

    // speed
    const param = this.u_interval * this.u_damping;
    let vx = ax * param;
    let vy = ay * param;
    const vlength = sqrt(vx * vx + vy * vy) + 0.0001;
    if (vlength > this.u_maxSpeed) {
      const param2 = this.u_maxSpeed / vlength;
      vx = param2 * vx;
      vy = param2 * vy;
    }

    // move
    if (nodeAttributes1[3] != 0 && nodeAttributes2[3] != 0) {
      this.u_Data[i] = [
        nodeAttributes1[3],
        nodeAttributes2[3],
        currentNode[2],
        0
      ];
    } else {
      const distx = vx * this.u_interval;
      const disty = vy * this.u_interval;
      const distLength = sqrt(distx * distx + disty * disty);
      this.u_Data[i] = [
        currentNode[0] + distx,
        currentNode[1] + disty,
        currentNode[2],
        distLength
      ];
    }
    
    // the avarage move distance
    // need to share memory
    
  }
}
`;
Ba.gForceBundle = '{"shaders":{"WGSL":"import \\"GLSL.std.450\\" as std;\\n\\n\\n# var gWebGPUDebug : bool = false;\\n# var gWebGPUDebugOutput : vec4<f32> = vec4<f32>(0.0);\\n\\n[[builtin global_invocation_id]] var<in> globalInvocationID : vec3<u32>;\\n# [[builtin work_group_size]] var<in> workGroupSize : vec3<u32>;\\n# [[builtin work_group_id]] var<in> workGroupID : vec3<u32>;\\n[[builtin local_invocation_id]] var<in> localInvocationID : vec3<u32>;\\n# [[builtin num_work_groups]] var<in> numWorkGroups : vec3<u32>;\\n[[builtin local_invocation_idx]] var<in> localInvocationIndex : u32;\\n\\ntype GWebGPUParams = [[block]] struct {\\n  [[offset 0]] u_damping : f32;\\n  [[offset 4]] u_maxSpeed : f32;\\n  [[offset 8]] u_minMovement : f32;\\n  \\n  [[offset 12]] u_coulombDisScale : f32;\\n  [[offset 16]] u_factor : f32;\\n  \\n  \\n  [[offset 20]] u_interval : f32;\\n};\\n[[binding 0, set 0]] var<uniform> gWebGPUUniformParams : GWebGPUParams;\\ntype GWebGPUBuffer0 = [[block]] struct {\\n  [[offset 0]] u_Data : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 1, set 0]] var<storage_buffer> gWebGPUBuffer0 : GWebGPUBuffer0;\\ntype GWebGPUBuffer1 = [[block]] struct {\\n  [[offset 0]] u_AveMovement : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 2, set 0]] var<storage_buffer> gWebGPUBuffer1 : GWebGPUBuffer1;\\ntype GWebGPUBuffer2 = [[block]] struct {\\n  [[offset 0]] u_NodeAttributeArray1 : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 3, set 0]] var<storage_buffer> gWebGPUBuffer2 : GWebGPUBuffer2;\\ntype GWebGPUBuffer3 = [[block]] struct {\\n  [[offset 0]] u_NodeAttributeArray2 : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 4, set 0]] var<storage_buffer> gWebGPUBuffer3 : GWebGPUBuffer3;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nfn unpack_float(packedValue : f32) -> vec2<i32> {var packedIntValue : i32 = i32(packedValue);\\nvar v0 : i32 = packedIntValue / 1048576;\\nreturn vec2<i32>(v0, packedIntValue - (v0 * 1048576));}\\nfn calcRepulsive(i : i32, currentNode : vec4<f32>) -> vec2<f32> {var ax : f32 = 0.0;\\nvar ay : f32 = 0.0;\\nfor (var j : i32 = 0; j < __DefineValuePlaceholder__VERTEX_COUNT; j = j + 1) {if (i != j) {var nextNode : vec4<f32> = gWebGPUBuffer0.u_Data[j];\\nvar vx : f32 = currentNode.x - nextNode.x;\\nvar vy : f32 = currentNode.y - nextNode.y;\\nvar dist : f32 = std::sqrt((vx * vx) + (vy * vy)) + 0.01;\\nvar n_dist : f32 = (dist + 0.1) * gWebGPUUniformParams.u_coulombDisScale;\\nvar direx : f32 = vx / dist;\\nvar direy : f32 = vy / dist;\\nvar attributesi : vec4<f32> = gWebGPUBuffer2.u_NodeAttributeArray1[i];\\nvar attributesj : vec4<f32> = gWebGPUBuffer2.u_NodeAttributeArray1[j];\\nvar massi : f32 = attributesi.x;\\nvar nodeStrengthi : f32 = attributesi.z;\\nvar nodeStrengthj : f32 = attributesj.z;\\nvar nodeStrength : f32 = (nodeStrengthi + nodeStrengthj) / 2.0;\\nvar param : f32 = (nodeStrength * gWebGPUUniformParams.u_factor) / (n_dist * n_dist);\\nax = ax + direx * param;\\nay = ay + direy * param;}}\\nreturn vec2<f32>(ax, ay);}\\nfn calcGravity(i : i32, currentNode : vec4<f32>, attributes2 : vec4<f32>) -> vec2<f32> {var vx : f32 = currentNode.x - attributes2.x;\\nvar vy : f32 = currentNode.y - attributes2.y;\\nvar ax : f32 = vx * attributes2.z;\\nvar ay : f32 = vy * attributes2.z;\\nreturn vec2<f32>(ax, ay);}\\nfn calcAttractive(i : i32, currentNode : vec4<f32>, attributes1 : vec4<f32>) -> vec2<f32> {var mass : f32 = attributes1.x;\\nvar ax : f32 = 0.0;\\nvar ay : f32 = 0.0;\\nvar compressed : vec2<i32> = unpack_float(currentNode.z);\\nvar length : i32 = compressed.x;\\nvar arr_offset : i32 = compressed.y;\\nvar node_buffer : vec4<f32>;\\nfor (var p : i32 = 0; p < __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX; p = p + 1) {if (p >= length) {break;}\\nvar arr_idx : i32 = arr_offset + (4 * p);\\nvar buf_offset : i32 = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = gWebGPUBuffer0.u_Data[i32(arr_idx / 4)];}\\nvar float_j : f32 = node_buffer.x;\\nvar nextNode : vec4<f32> = gWebGPUBuffer0.u_Data[i32(float_j)];\\nvar vx : f32 = nextNode.x - currentNode.x;\\nvar vy : f32 = nextNode.y - currentNode.y;\\nvar dist : f32 = std::sqrt((vx * vx) + (vy * vy)) + 0.01;\\nvar direx : f32 = vx / dist;\\nvar direy : f32 = vy / dist;\\nvar edgeLength : f32 = node_buffer.y;\\nvar edgeStrength : f32 = node_buffer.z;\\nvar diff : f32 = edgeLength - dist;\\nvar param : f32 = (diff * edgeStrength) / mass;\\nax = ax - direx * param;\\nay = ay - direy * param;}\\nreturn vec2<f32>(ax, ay);}\\nfn main() -> void {var i : i32 = globalInvocationID.x;\\nvar currentNode : vec4<f32> = gWebGPUBuffer0.u_Data[i];\\nvar movement : vec4<f32> = gWebGPUBuffer1.u_AveMovement[0];\\nvar ax : f32 = 0.0;\\nvar ay : f32 = 0.0;\\nif ((i >= __DefineValuePlaceholder__VERTEX_COUNT) || (movement.x < gWebGPUUniformParams.u_minMovement)) {gWebGPUBuffer0.u_Data[i] = currentNode;\\nreturn ;}\\nvar nodeAttributes1 : vec4<f32> = gWebGPUBuffer2.u_NodeAttributeArray1[i];\\nvar nodeAttributes2 : vec4<f32> = gWebGPUBuffer3.u_NodeAttributeArray2[i];\\nvar repulsive : vec2<f32> = calcRepulsive(i, currentNode);\\nax = ax + repulsive.x;\\nay = ay + repulsive.y;\\nvar attractive : vec2<f32> = calcAttractive(i, currentNode, nodeAttributes1);\\nax = ax + attractive.x;\\nay = ay + attractive.y;\\nvar gravity : vec2<f32> = calcGravity(i, currentNode, nodeAttributes2);\\nax = ax - gravity.x;\\nay = ay - gravity.y;\\nvar param : f32 = gWebGPUUniformParams.u_interval * gWebGPUUniformParams.u_damping;\\nvar vx : f32 = ax * param;\\nvar vy : f32 = ay * param;\\nvar vlength : f32 = std::sqrt((vx * vx) + (vy * vy)) + 0.0001;\\nif (vlength > gWebGPUUniformParams.u_maxSpeed) {var param2 : f32 = gWebGPUUniformParams.u_maxSpeed / vlength;\\nvx = param2 * vx;\\nvy = param2 * vy;}\\nvar distx : f32 = vx * gWebGPUUniformParams.u_interval;\\nvar disty : f32 = vy * gWebGPUUniformParams.u_interval;\\nvar distLength : f32 = std::sqrt((distx * distx) + (disty * disty));\\nif ((nodeAttributes1.w != 0.0) && (nodeAttributes2.w != 0.0)) {gWebGPUBuffer0.u_Data[i] = vec4<f32>(nodeAttributes1.w, nodeAttributes2.w, currentNode.z, 0.0);}else {gWebGPUBuffer0.u_Data[i] = vec4<f32>(currentNode.x + distx, currentNode.y + disty, currentNode.z, distLength);}\\nreturn;}\\n\\nentry_point compute as \\"main\\" = main;\\n","GLSL450":"\\n\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\nivec3 globalInvocationID = ivec3(gl_GlobalInvocationID);\\nivec3 workGroupSize = ivec3(1,1,1);\\nivec3 workGroupID = ivec3(gl_WorkGroupID);\\nivec3 localInvocationID = ivec3(gl_LocalInvocationID);\\nivec3 numWorkGroups = ivec3(gl_NumWorkGroups);\\nint localInvocationIndex = int(gl_LocalInvocationIndex);\\n\\nlayout(std140, set = 0, binding = 0) uniform GWebGPUParams {\\n  float u_damping;\\n  float u_maxSpeed;\\n  float u_minMovement;\\n  \\n  float u_coulombDisScale;\\n  float u_factor;\\n  \\n  \\n  float u_interval;\\n} gWebGPUUniformParams;\\nlayout(std430, set = 0, binding = 1) buffer   GWebGPUBuffer0 {\\n  vec4 u_Data[];\\n} gWebGPUBuffer0;\\n\\nlayout(std430, set = 0, binding = 2) buffer readonly  GWebGPUBuffer1 {\\n  vec4 u_AveMovement[];\\n} gWebGPUBuffer1;\\n\\nlayout(std430, set = 0, binding = 3) buffer readonly  GWebGPUBuffer2 {\\n  vec4 u_NodeAttributeArray1[];\\n} gWebGPUBuffer2;\\n\\nlayout(std430, set = 0, binding = 4) buffer readonly  GWebGPUBuffer3 {\\n  vec4 u_NodeAttributeArray2[];\\n} gWebGPUBuffer3;\\n\\n\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define SHIFT_20 1048576.0\\nlayout (\\n  local_size_x = 1,\\n  local_size_y = 1,\\n  local_size_z = 1\\n) in;\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nivec2 unpack_float(float packedValue) {int packedIntValue = int(packedValue);\\nint v0 = packedIntValue / int(SHIFT_20);\\nreturn ivec2(v0, packedIntValue - (v0 * int(SHIFT_20)));}\\nvec2 calcRepulsive(int i, vec4 currentNode) {float ax = 0.0;\\nfloat ay = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = gWebGPUBuffer0.u_Data[j];\\nfloat vx = currentNode.x - nextNode.x;\\nfloat vy = currentNode.y - nextNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat n_dist = (dist + 0.1) * gWebGPUUniformParams.u_coulombDisScale;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nvec4 attributesi = gWebGPUBuffer2.u_NodeAttributeArray1[i];\\nvec4 attributesj = gWebGPUBuffer2.u_NodeAttributeArray1[j];\\nfloat massi = attributesi.x;\\nfloat nodeStrengthi = attributesi.z;\\nfloat nodeStrengthj = attributesj.z;\\nfloat nodeStrength = (nodeStrengthi + nodeStrengthj) / 2.0;\\nfloat param = (nodeStrength * gWebGPUUniformParams.u_factor) / (n_dist * n_dist);\\nax += direx * param;\\nay += direy * param;}}\\nreturn vec2(ax, ay);}\\nvec2 calcGravity(int i, vec4 currentNode, vec4 attributes2) {float vx = currentNode.x - attributes2.x;\\nfloat vy = currentNode.y - attributes2.y;\\nfloat ax = vx * attributes2.z;\\nfloat ay = vy * attributes2.z;\\nreturn vec2(ax, ay);}\\nvec2 calcAttractive(int i, vec4 currentNode, vec4 attributes1) {float mass = attributes1.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nivec2 compressed = unpack_float(currentNode.z);\\nint length = compressed.x;\\nint arr_offset = compressed.y;\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + (4 * p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = gWebGPUBuffer0.u_Data[int(arr_idx / 4)];}\\nfloat float_j = node_buffer.x;\\nvec4 nextNode = gWebGPUBuffer0.u_Data[int(float_j)];\\nfloat vx = nextNode.x - currentNode.x;\\nfloat vy = nextNode.y - currentNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nfloat edgeLength = node_buffer.y;\\nfloat edgeStrength = node_buffer.z;\\nfloat diff = edgeLength - dist;\\nfloat param = (diff * edgeStrength) / mass;\\nax -= direx * param;\\nay -= direy * param;}\\nreturn vec2(ax, ay);}\\nvoid main() {int i = globalInvocationID.x;\\nvec4 currentNode = gWebGPUBuffer0.u_Data[i];\\nvec4 movement = gWebGPUBuffer1.u_AveMovement[0];\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nif ((i >= VERTEX_COUNT) || (movement.x < gWebGPUUniformParams.u_minMovement)) {gWebGPUBuffer0.u_Data[i] = currentNode;\\nreturn ;}\\nvec4 nodeAttributes1 = gWebGPUBuffer2.u_NodeAttributeArray1[i];\\nvec4 nodeAttributes2 = gWebGPUBuffer3.u_NodeAttributeArray2[i];\\nvec2 repulsive = calcRepulsive(i, currentNode);\\nax += repulsive.x;\\nay += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode, nodeAttributes1);\\nax += attractive.x;\\nay += attractive.y;\\nvec2 gravity = calcGravity(i, currentNode, nodeAttributes2);\\nax -= gravity.x;\\nay -= gravity.y;\\nfloat param = gWebGPUUniformParams.u_interval * gWebGPUUniformParams.u_damping;\\nfloat vx = ax * param;\\nfloat vy = ay * param;\\nfloat vlength = sqrt((vx * vx) + (vy * vy)) + 0.0001;\\nif (vlength > gWebGPUUniformParams.u_maxSpeed) {float param2 = gWebGPUUniformParams.u_maxSpeed / vlength;\\nvx = param2 * vx;\\nvy = param2 * vy;}\\nfloat distx = vx * gWebGPUUniformParams.u_interval;\\nfloat disty = vy * gWebGPUUniformParams.u_interval;\\nfloat distLength = sqrt((distx * distx) + (disty * disty));\\nif ((nodeAttributes1.w != 0.0) && (nodeAttributes2.w != 0.0)) {gWebGPUBuffer0.u_Data[i] = vec4(nodeAttributes1.w, nodeAttributes2.w, currentNode.z, 0.0);}else {gWebGPUBuffer0.u_Data[i] = vec4(currentNode.x + distx, currentNode.y + disty, currentNode.z, distLength);}}\\n","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define MAX_EDGE_PER_VERTEX __DefineValuePlaceholder__MAX_EDGE_PER_VERTEX\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n#define SHIFT_20 1048576.0\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_damping;\\nuniform float u_maxSpeed;\\nuniform float u_minMovement;\\nuniform sampler2D u_AveMovement;\\nuniform vec2 u_AveMovementSize;\\nvec4 getDatau_AveMovement(vec2 address2D) {\\n  return vec4(texture2D(u_AveMovement, address2D).rgba);\\n}\\nvec4 getDatau_AveMovement(float address1D) {\\n  return getDatau_AveMovement(addrTranslation_1Dto2D(address1D, u_AveMovementSize));\\n}\\nvec4 getDatau_AveMovement(int address1D) {\\n  return getDatau_AveMovement(float(address1D));\\n}\\nuniform float u_coulombDisScale;\\nuniform float u_factor;\\nuniform sampler2D u_NodeAttributeArray1;\\nuniform vec2 u_NodeAttributeArray1Size;\\nvec4 getDatau_NodeAttributeArray1(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributeArray1, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributeArray1(float address1D) {\\n  return getDatau_NodeAttributeArray1(addrTranslation_1Dto2D(address1D, u_NodeAttributeArray1Size));\\n}\\nvec4 getDatau_NodeAttributeArray1(int address1D) {\\n  return getDatau_NodeAttributeArray1(float(address1D));\\n}\\nuniform sampler2D u_NodeAttributeArray2;\\nuniform vec2 u_NodeAttributeArray2Size;\\nvec4 getDatau_NodeAttributeArray2(vec2 address2D) {\\n  return vec4(texture2D(u_NodeAttributeArray2, address2D).rgba);\\n}\\nvec4 getDatau_NodeAttributeArray2(float address1D) {\\n  return getDatau_NodeAttributeArray2(addrTranslation_1Dto2D(address1D, u_NodeAttributeArray2Size));\\n}\\nvec4 getDatau_NodeAttributeArray2(int address1D) {\\n  return getDatau_NodeAttributeArray2(float(address1D));\\n}\\nuniform float u_interval;\\nivec2 unpack_float(float packedValue) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint packedIntValue = int(packedValue);\\nint v0 = packedIntValue / int(SHIFT_20);\\nreturn ivec2(v0, packedIntValue - (v0 * int(SHIFT_20)));}\\nvec2 calcRepulsive(int i, vec4 currentNode) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {if (i != j) {vec4 nextNode = getDatau_Data(j);\\nfloat vx = currentNode.x - nextNode.x;\\nfloat vy = currentNode.y - nextNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat n_dist = (dist + 0.1) * u_coulombDisScale;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nvec4 attributesi = getDatau_NodeAttributeArray1(i);\\nvec4 attributesj = getDatau_NodeAttributeArray1(j);\\nfloat massi = attributesi.x;\\nfloat nodeStrengthi = attributesi.z;\\nfloat nodeStrengthj = attributesj.z;\\nfloat nodeStrength = (nodeStrengthi + nodeStrengthj) / 2.0;\\nfloat param = (nodeStrength * u_factor) / (n_dist * n_dist);\\nax += direx * param;\\nay += direy * param;}}\\nreturn vec2(ax, ay);}\\nvec2 calcGravity(int i, vec4 currentNode, vec4 attributes2) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat vx = currentNode.x - attributes2.x;\\nfloat vy = currentNode.y - attributes2.y;\\nfloat ax = vx * attributes2.z;\\nfloat ay = vy * attributes2.z;\\nreturn vec2(ax, ay);}\\nvec2 calcAttractive(int i, vec4 currentNode, vec4 attributes1) {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat mass = attributes1.x;\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nivec2 compressed = unpack_float(currentNode.z);\\nint length = compressed.x;\\nint arr_offset = compressed.y;\\nvec4 node_buffer;\\nfor (int p = 0; p < MAX_EDGE_PER_VERTEX; p++) {if (p >= length) {break;}\\nint arr_idx = arr_offset + (4 * p);\\nint buf_offset = arr_idx - ((arr_idx / 4) * 4);\\nif ((p == 0) || (buf_offset == 0)) {node_buffer = getDatau_Data(int(arr_idx / 4));}\\nfloat float_j = node_buffer.x;\\nvec4 nextNode = getDatau_Data(int(float_j));\\nfloat vx = nextNode.x - currentNode.x;\\nfloat vy = nextNode.y - currentNode.y;\\nfloat dist = sqrt((vx * vx) + (vy * vy)) + 0.01;\\nfloat direx = vx / dist;\\nfloat direy = vy / dist;\\nfloat edgeLength = node_buffer.y;\\nfloat edgeStrength = node_buffer.z;\\nfloat diff = edgeLength - dist;\\nfloat param = (diff * edgeStrength) / mass;\\nax -= direx * param;\\nay -= direy * param;}\\nreturn vec2(ax, ay);}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nint i = globalInvocationID.x;\\nvec4 currentNode = getDatau_Data(i);\\nvec4 movement = getDatau_AveMovement(0.0);\\nfloat ax = 0.0;\\nfloat ay = 0.0;\\nif ((i >= VERTEX_COUNT) || (movement.x < u_minMovement)) {gl_FragColor = vec4(currentNode);\\nreturn ;}\\nvec4 nodeAttributes1 = getDatau_NodeAttributeArray1(i);\\nvec4 nodeAttributes2 = getDatau_NodeAttributeArray2(i);\\nvec2 repulsive = calcRepulsive(i, currentNode);\\nax += repulsive.x;\\nay += repulsive.y;\\nvec2 attractive = calcAttractive(i, currentNode, nodeAttributes1);\\nax += attractive.x;\\nay += attractive.y;\\nvec2 gravity = calcGravity(i, currentNode, nodeAttributes2);\\nax -= gravity.x;\\nay -= gravity.y;\\nfloat param = u_interval * u_damping;\\nfloat vx = ax * param;\\nfloat vy = ay * param;\\nfloat vlength = sqrt((vx * vx) + (vy * vy)) + 0.0001;\\nif (vlength > u_maxSpeed) {float param2 = u_maxSpeed / vlength;\\nvx = param2 * vx;\\nvy = param2 * vy;}\\nfloat distx = vx * u_interval;\\nfloat disty = vy * u_interval;\\nfloat distLength = sqrt((distx * distx) + (disty * disty));\\nif ((nodeAttributes1.w != 0.0) && (nodeAttributes2.w != 0.0)) {gl_FragColor = vec4(vec4(nodeAttributes1.w, nodeAttributes2.w, currentNode.z, 0.0));}else {gl_FragColor = vec4(vec4(currentNode.x + distx, currentNode.y + disty, currentNode.z, distLength));}if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"MAX_EDGE_PER_VERTEX","type":"Float","runtime":true},{"name":"VERTEX_COUNT","type":"Float","runtime":true},{"name":"SHIFT_20","type":"Float","value":1048576,"runtime":false}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]},{"name":"u_damping","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_maxSpeed","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_minMovement","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AveMovement","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_coulombDisScale","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_factor","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributeArray1","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_NodeAttributeArray2","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_interval","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_Data","size":[1,1],"length":1},"needPingpong":true}}';
Ba.aveMovementCode = `
const VERTEX_COUNT;
@numthreads(1, 1, 1)
class CalcAveMovement {
  @in
  u_Data: vec4[];
  @in
  u_iter: float;
  @in @out
  u_AveMovement: vec4[];
  @main
  compute() {
    let movement = 0;
    for (let j: int = 0; j < VERTEX_COUNT; j++) {
      const vertex = this.u_Data[j];
      movement += vertex[3];
    }
    movement = movement / float(VERTEX_COUNT);
    this.u_AveMovement[0] = [movement, 0, 0, 0];
  }
}
`;
Ba.aveMovementBundle = '{"shaders":{"WGSL":"import \\"GLSL.std.450\\" as std;\\n\\n\\n# var gWebGPUDebug : bool = false;\\n# var gWebGPUDebugOutput : vec4<f32> = vec4<f32>(0.0);\\n\\n[[builtin global_invocation_id]] var<in> globalInvocationID : vec3<u32>;\\n# [[builtin work_group_size]] var<in> workGroupSize : vec3<u32>;\\n# [[builtin work_group_id]] var<in> workGroupID : vec3<u32>;\\n[[builtin local_invocation_id]] var<in> localInvocationID : vec3<u32>;\\n# [[builtin num_work_groups]] var<in> numWorkGroups : vec3<u32>;\\n[[builtin local_invocation_idx]] var<in> localInvocationIndex : u32;\\n\\ntype GWebGPUParams = [[block]] struct {\\n  [[offset 0]] u_iter : f32;\\n};\\n[[binding 0, set 0]] var<uniform> gWebGPUUniformParams : GWebGPUParams;\\ntype GWebGPUBuffer0 = [[block]] struct {\\n  [[offset 0]] u_Data : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 1, set 0]] var<storage_buffer> gWebGPUBuffer0 : GWebGPUBuffer0;\\ntype GWebGPUBuffer1 = [[block]] struct {\\n  [[offset 0]] u_AveMovement : [[stride 16]] array<vec4<f32>>;\\n};\\n[[binding 2, set 0]] var<storage_buffer> gWebGPUBuffer1 : GWebGPUBuffer1;\\n\\n\\n\\n\\n\\n\\n\\n\\nfn main() -> void {var movement : f32 = 0.0;\\nfor (var j : i32 = 0; j < __DefineValuePlaceholder__VERTEX_COUNT; j = j + 1) {var vertex : vec4<f32> = gWebGPUBuffer0.u_Data[j];\\nmovement = movement + vertex.w;}\\nmovement = movement / f32(__DefineValuePlaceholder__VERTEX_COUNT);\\ngWebGPUBuffer1.u_AveMovement[0] = vec4<f32>(movement, 0.0, 0.0, 0.0);\\nreturn;}\\n\\nentry_point compute as \\"main\\" = main;\\n","GLSL450":"\\n\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\nivec3 globalInvocationID = ivec3(gl_GlobalInvocationID);\\nivec3 workGroupSize = ivec3(1,1,1);\\nivec3 workGroupID = ivec3(gl_WorkGroupID);\\nivec3 localInvocationID = ivec3(gl_LocalInvocationID);\\nivec3 numWorkGroups = ivec3(gl_NumWorkGroups);\\nint localInvocationIndex = int(gl_LocalInvocationIndex);\\n\\nlayout(std140, set = 0, binding = 0) uniform GWebGPUParams {\\n  float u_iter;\\n} gWebGPUUniformParams;\\nlayout(std430, set = 0, binding = 1) buffer readonly  GWebGPUBuffer0 {\\n  vec4 u_Data[];\\n} gWebGPUBuffer0;\\n\\nlayout(std430, set = 0, binding = 2) buffer   GWebGPUBuffer1 {\\n  vec4 u_AveMovement[];\\n} gWebGPUBuffer1;\\n\\n\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\nlayout (\\n  local_size_x = 1,\\n  local_size_y = 1,\\n  local_size_z = 1\\n) in;\\n\\n\\n\\nvoid main() {float movement = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 vertex = gWebGPUBuffer0.u_Data[j];\\nmovement += vertex.w;}\\nmovement = movement / float(VERTEX_COUNT);\\ngWebGPUBuffer1.u_AveMovement[0] = vec4(movement, 0.0, 0.0, 0.0);}\\n","GLSL100":"\\n\\nfloat epsilon = 0.00001;\\nvec2 addrTranslation_1Dto2D(float address1D, vec2 texSize) {\\n  vec2 conv_const = vec2(1.0 / texSize.x, 1.0 / (texSize.x * texSize.y));\\n  vec2 normAddr2D = float(address1D) * conv_const;\\n  return vec2(fract(normAddr2D.x + epsilon), normAddr2D.y);\\n}\\n\\nvoid barrier() {}\\n  \\n\\nuniform vec2 u_OutputTextureSize;\\nuniform int u_OutputTexelCount;\\nvarying vec2 v_TexCoord;\\n\\nbool gWebGPUDebug = false;\\nvec4 gWebGPUDebugOutput = vec4(0.0);\\n\\n#define VERTEX_COUNT __DefineValuePlaceholder__VERTEX_COUNT\\n\\nuniform sampler2D u_Data;\\nuniform vec2 u_DataSize;\\nvec4 getDatau_Data(vec2 address2D) {\\n  return vec4(texture2D(u_Data, address2D).rgba);\\n}\\nvec4 getDatau_Data(float address1D) {\\n  return getDatau_Data(addrTranslation_1Dto2D(address1D, u_DataSize));\\n}\\nvec4 getDatau_Data(int address1D) {\\n  return getDatau_Data(float(address1D));\\n}\\nuniform float u_iter;\\nuniform sampler2D u_AveMovement;\\nuniform vec2 u_AveMovementSize;\\nvec4 getDatau_AveMovement(vec2 address2D) {\\n  return vec4(texture2D(u_AveMovement, address2D).rgba);\\n}\\nvec4 getDatau_AveMovement(float address1D) {\\n  return getDatau_AveMovement(addrTranslation_1Dto2D(address1D, u_AveMovementSize));\\n}\\nvec4 getDatau_AveMovement(int address1D) {\\n  return getDatau_AveMovement(float(address1D));\\n}\\nvoid main() {\\nivec3 workGroupSize = ivec3(1, 1, 1);\\nivec3 numWorkGroups = ivec3(1, 1, 1);     \\nint globalInvocationIndex = int(floor(v_TexCoord.x * u_OutputTextureSize.x))\\n  + int(floor(v_TexCoord.y * u_OutputTextureSize.y)) * int(u_OutputTextureSize.x);\\nint workGroupIDLength = globalInvocationIndex / (workGroupSize.x * workGroupSize.y * workGroupSize.z);\\nivec3 workGroupID = ivec3(workGroupIDLength / numWorkGroups.y / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.z, workGroupIDLength / numWorkGroups.x / numWorkGroups.y);\\nint localInvocationIDZ = globalInvocationIndex / (workGroupSize.x * workGroupSize.y);\\nint localInvocationIDY = (globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y) / workGroupSize.x;\\nint localInvocationIDX = globalInvocationIndex - localInvocationIDZ * workGroupSize.x * workGroupSize.y - localInvocationIDY * workGroupSize.x;\\nivec3 localInvocationID = ivec3(localInvocationIDX, localInvocationIDY, localInvocationIDZ);\\nivec3 globalInvocationID = workGroupID * workGroupSize + localInvocationID;\\nint localInvocationIndex = localInvocationID.z * workGroupSize.x * workGroupSize.y\\n                + localInvocationID.y * workGroupSize.x + localInvocationID.x;\\nfloat movement = 0.0;\\nfor (int j = 0; j < VERTEX_COUNT; j++) {vec4 vertex = getDatau_Data(j);\\nmovement += vertex.w;}\\nmovement = movement / float(VERTEX_COUNT);\\ngl_FragColor = vec4(vec4(movement, 0.0, 0.0, 0.0));if (gWebGPUDebug) {\\n  gl_FragColor = gWebGPUDebugOutput;\\n}}\\n"},"context":{"name":"","dispatch":[1,1,1],"threadGroupSize":[1,1,1],"maxIteration":1,"defines":[{"name":"VERTEX_COUNT","type":"Float","runtime":true}],"uniforms":[{"name":"u_Data","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_iter","type":"Float","storageClass":"Uniform","readonly":true,"writeonly":false,"size":[1,1]},{"name":"u_AveMovement","type":"vec4<f32>[]","storageClass":"StorageBuffer","readonly":false,"writeonly":false,"size":[1,1]}],"globalDeclarations":[],"output":{"name":"u_AveMovement","size":[1,1],"length":1},"needPingpong":true}}';
var npe = Oe && Oe.__extends || function() {
  var r = function(t, e) {
    return r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(n, i) {
      n.__proto__ = i;
    } || function(n, i) {
      for (var a in i)
        Object.prototype.hasOwnProperty.call(i, a) && (n[a] = i[a]);
    }, r(t, e);
  };
  return function(t, e) {
    if (typeof e != "function" && e !== null)
      throw new TypeError("Class extends value " + String(e) + " is not a constructor or null");
    r(t, e);
    function n() {
      this.constructor = t;
    }
    t.prototype = e === null ? Object.create(e) : (n.prototype = e.prototype, new n());
  };
}(), Gy = Oe && Oe.__awaiter || function(r, t, e, n) {
  function i(a) {
    return a instanceof e ? a : new e(function(o) {
      o(a);
    });
  }
  return new (e || (e = Promise))(function(a, o) {
    function s(l) {
      try {
        f(n.next(l));
      } catch (c) {
        o(c);
      }
    }
    function u(l) {
      try {
        f(n.throw(l));
      } catch (c) {
        o(c);
      }
    }
    function f(l) {
      l.done ? a(l.value) : i(l.value).then(s, u);
    }
    f((n = n.apply(r, t || [])).next());
  });
}, Fy = Oe && Oe.__generator || function(r, t) {
  var e = { label: 0, sent: function() {
    if (a[0] & 1)
      throw a[1];
    return a[1];
  }, trys: [], ops: [] }, n, i, a, o;
  return o = { next: s(0), throw: s(1), return: s(2) }, typeof Symbol == "function" && (o[Symbol.iterator] = function() {
    return this;
  }), o;
  function s(f) {
    return function(l) {
      return u([f, l]);
    };
  }
  function u(f) {
    if (n)
      throw new TypeError("Generator is already executing.");
    for (; e; )
      try {
        if (n = 1, i && (a = f[0] & 2 ? i.return : f[0] ? i.throw || ((a = i.return) && a.call(i), 0) : i.next) && !(a = a.call(i, f[1])).done)
          return a;
        switch (i = 0, a && (f = [f[0] & 2, a.value]), f[0]) {
          case 0:
          case 1:
            a = f;
            break;
          case 4:
            return e.label++, { value: f[1], done: !1 };
          case 5:
            e.label++, i = f[1], f = [0];
            continue;
          case 7:
            f = e.ops.pop(), e.trys.pop();
            continue;
          default:
            if (a = e.trys, !(a = a.length > 0 && a[a.length - 1]) && (f[0] === 6 || f[0] === 2)) {
              e = 0;
              continue;
            }
            if (f[0] === 3 && (!a || f[1] > a[0] && f[1] < a[3])) {
              e.label = f[1];
              break;
            }
            if (f[0] === 6 && e.label < a[1]) {
              e.label = a[1], a = f;
              break;
            }
            if (a && e.label < a[2]) {
              e.label = a[2], e.ops.push(f);
              break;
            }
            a[2] && e.ops.pop(), e.trys.pop();
            continue;
        }
        f = t.call(r, e);
      } catch (l) {
        f = [6, l], i = 0;
      } finally {
        n = a = 0;
      }
    if (f[0] & 5)
      throw f[1];
    return { value: f[0] ? f[1] : void 0, done: !0 };
  }
};
Object.defineProperty(Eh, "__esModule", { value: !0 });
Eh.GForceGPULayout = void 0;
var ipe = an, so = on(), yO = U5, uo = xi, ape = Zp, mO = Ba, ope = Co, spe = function(r) {
  npe(t, r);
  function t(e) {
    var n = r.call(this) || this;
    return n.maxIteration = 1e3, n.edgeStrength = 200, n.nodeStrength = 1e3, n.coulombDisScale = 5e-3, n.damping = 0.9, n.maxSpeed = 1e3, n.minMovement = 0.5, n.interval = 0.02, n.factor = 1, n.linkDistance = 1, n.gravity = 10, n.workerEnabled = !1, n.nodes = [], n.edges = [], n.width = 300, n.height = 300, n.nodeMap = {}, n.nodeIdxMap = {}, n.updateCfg(e), n;
  }
  return t.prototype.getDefaultCfg = function() {
    return {
      maxIteration: 2e3,
      gravity: 10,
      clustering: !1,
      clusterGravity: 10
    };
  }, t.prototype.execute = function() {
    return Gy(this, void 0, void 0, function() {
      var e, n, i, a, o;
      return Fy(this, function(s) {
        switch (s.label) {
          case 0:
            return e = this, n = e.nodes, !n || n.length === 0 ? (e.onLayoutEnd && e.onLayoutEnd(), [2]) : (!e.width && typeof window < "u" && (e.width = window.innerWidth), !e.height && typeof window < "u" && (e.height = window.innerHeight), e.center || (e.center = [e.width / 2, e.height / 2]), i = e.center, n.length === 1 ? (n[0].x = i[0], n[0].y = i[1], e.onLayoutEnd && e.onLayoutEnd(), [2]) : (a = {}, o = {}, n.forEach(function(u, f) {
              (0, so.isNumber)(u.x) || (u.x = Math.random() * e.width), (0, so.isNumber)(u.y) || (u.y = Math.random() * e.height), a[u.id] = u, o[u.id] = f;
            }), e.nodeMap = a, e.nodeIdxMap = o, e.nodeStrength = (0, uo.proccessToFunc)(e.nodeStrength, 1), e.edgeStrength = (0, uo.proccessToFunc)(e.edgeStrength, 1), [4, e.run()]));
          case 1:
            return s.sent(), [2];
        }
      });
    });
  }, t.prototype.executeWithWorker = function(e, n) {
    var i = this, a = i.nodes, o = i.center;
    if (!(!a || a.length === 0)) {
      if (a.length === 1) {
        a[0].x = o[0], a[0].y = o[1];
        return;
      }
      var s = {}, u = {};
      a.forEach(function(f, l) {
        (0, so.isNumber)(f.x) || (f.x = Math.random() * i.width), (0, so.isNumber)(f.y) || (f.y = Math.random() * i.height), s[f.id] = f, u[f.id] = l;
      }), i.nodeMap = s, i.nodeIdxMap = u, i.nodeStrength = (0, uo.proccessToFunc)(i.nodeStrength, 1), i.edgeStrength = (0, uo.proccessToFunc)(i.edgeStrength, 1), i.run(e, n);
    }
  }, t.prototype.run = function(e, n) {
    return Gy(this, void 0, void 0, function() {
      var i, a, o, s, u, f, l, c, h, d, v, p, g, y, b, m, x, _, w, E, M, C, S, A, T, P, k, L = this;
      return Fy(this, function(O) {
        switch (O.label) {
          case 0:
            for (i = this, a = i.nodes, o = i.edges, s = i.maxIteration, !i.width && typeof window < "u" && (i.width = window.innerWidth), !i.height && typeof window < "u" && (i.height = window.innerHeight), u = a.length, i.linkDistance = (0, uo.proccessToFunc)(i.linkDistance), i.edgeStrength = (0, uo.proccessToFunc)(i.edgeStrength), f = (0, uo.buildTextureDataWithTwoEdgeAttr)(a, o, i.linkDistance, i.edgeStrength), l = f.maxEdgePerVetex, c = f.array, i.degrees = (0, ape.getDegree)(a.length, i.nodeIdxMap, o).map(function(D) {
              return D.all;
            }), h = [], d = [], v = [], p = [], g = [], y = [], b = [], i.getMass || (i.getMass = function(D) {
              return i.degrees[i.nodeIdxMap[D.id]] || 1;
            }), m = i.gravity, x = i.center, a.forEach(function(D, G) {
              h.push(i.getMass(D)), d.push(i.nodeStrength(D)), i.degrees[G] || (i.degrees[G] = 0);
              var R = [x[0], x[1], m];
              if (i.getCenter) {
                var F = i.getCenter(D, i.degrees[G]);
                F && (0, so.isNumber)(F[0]) && (0, so.isNumber)(F[1]) && (0, so.isNumber)(F[2]) && (R = F);
              }
              v.push(R[0]), p.push(R[1]), g.push(R[2]), (0, so.isNumber)(D.fx) && (0, so.isNumber)(D.fy) ? (y.push(D.fx || 1e-3), b.push(D.fy || 1e-3)) : (y.push(0), b.push(0));
            }), _ = (0, uo.arrayToTextureData)([
              h,
              i.degrees,
              d,
              y
            ]), w = (0, uo.arrayToTextureData)([
              v,
              p,
              g,
              b
            ]), E = i.workerEnabled, E ? M = yO.World.create({
              canvas: e,
              engineOptions: {
                supportCompute: !0
              }
            }) : M = yO.World.create({
              engineOptions: {
                supportCompute: !0
              }
            }), C = i.onLayoutEnd, S = [], c.forEach(function(D) {
              S.push(D);
            }), A = 0; A < 4; A++)
              S.push(0);
            return T = M.createKernel(mO.gForceBundle).setDispatch([u, 1, 1]).setBinding({
              u_Data: c,
              u_damping: i.damping,
              u_maxSpeed: i.maxSpeed,
              u_minMovement: i.minMovement,
              u_coulombDisScale: i.coulombDisScale,
              u_factor: i.factor,
              u_NodeAttributeArray1: _,
              u_NodeAttributeArray2: w,
              MAX_EDGE_PER_VERTEX: l,
              VERTEX_COUNT: u,
              u_AveMovement: S,
              u_interval: i.interval
            }), P = M.createKernel(mO.aveMovementBundle).setDispatch([1, 1, 1]).setBinding({
              u_Data: c,
              VERTEX_COUNT: u,
              u_AveMovement: [0, 0, 0, 0]
            }), k = function() {
              return Gy(L, void 0, void 0, function() {
                var D, G, R;
                return Fy(this, function(F) {
                  switch (F.label) {
                    case 0:
                      D = 0, F.label = 1;
                    case 1:
                      return D < s ? [4, T.execute()] : [3, 5];
                    case 2:
                      return F.sent(), P.setBinding({
                        u_Data: T
                      }), [4, P.execute()];
                    case 3:
                      F.sent(), G = Math.max(0.02, i.interval - D * 2e-3), T.setBinding({
                        u_interval: G,
                        u_AveMovement: P
                      }), F.label = 4;
                    case 4:
                      return D++, [3, 1];
                    case 5:
                      return [4, T.getOutput()];
                    case 6:
                      return R = F.sent(), e ? n.postMessage({
                        type: ope.LAYOUT_MESSAGE.GPUEND,
                        vertexEdgeData: R
                      }) : a.forEach(function(q, ne) {
                        var oe = R[4 * ne], ie = R[4 * ne + 1];
                        q.x = oe, q.y = ie;
                      }), C && C(), [2];
                  }
                });
              });
            }, [4, k()];
          case 1:
            return O.sent(), [2];
        }
      });
    });
  }, t.prototype.getType = function() {
    return "gForce-gpu";
  }, t;
}(ipe.Base);
Eh.GForceGPULayout = spe;
var Sh = {}, upe = Oe && Oe.__extends || function() {
  var r = function(t, e) {
    return r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(n, i) {
      n.__proto__ = i;
    } || function(n, i) {
      for (var a in i)
        Object.prototype.hasOwnProperty.call(i, a) && (n[a] = i[a]);
    }, r(t, e);
  };
  return function(t, e) {
    if (typeof e != "function" && e !== null)
      throw new TypeError("Class extends value " + String(e) + " is not a constructor or null");
    r(t, e);
    function n() {
      this.constructor = t;
    }
    t.prototype = e === null ? Object.create(e) : (n.prototype = e.prototype, new n());
  };
}();
Object.defineProperty(Sh, "__esModule", { value: !0 });
Sh.ComboForceLayout = void 0;
var fpe = an, or = on(), lpe = function(r) {
  upe(t, r);
  function t(e) {
    var n = r.call(this) || this;
    return n.center = [0, 0], n.maxIteration = 100, n.gravity = 10, n.comboGravity = 10, n.linkDistance = 10, n.alpha = 1, n.alphaMin = 1e-3, n.alphaDecay = 1 - Math.pow(n.alphaMin, 1 / 300), n.alphaTarget = 0, n.velocityDecay = 0.6, n.edgeStrength = 0.6, n.nodeStrength = 30, n.preventOverlap = !1, n.preventNodeOverlap = !1, n.preventComboOverlap = !1, n.collideStrength = void 0, n.nodeCollideStrength = 0.5, n.comboCollideStrength = 0.5, n.comboSpacing = 20, n.comboPadding = 10, n.optimizeRangeFactor = 1, n.onTick = function() {
    }, n.onLayoutEnd = function() {
    }, n.depthAttractiveForceScale = 1, n.depthRepulsiveForceScale = 2, n.nodes = [], n.edges = [], n.combos = [], n.comboTrees = [], n.width = 300, n.height = 300, n.bias = [], n.nodeMap = {}, n.oriComboMap = {}, n.indexMap = {}, n.comboMap = {}, n.previousLayouted = !1, n.updateCfg(e), n;
  }
  return t.prototype.getDefaultCfg = function() {
    return {
      maxIteration: 100,
      center: [0, 0],
      gravity: 10,
      speed: 1,
      comboGravity: 30,
      preventOverlap: !1,
      preventComboOverlap: !0,
      preventNodeOverlap: !0,
      nodeSpacing: void 0,
      collideStrength: void 0,
      nodeCollideStrength: 0.5,
      comboCollideStrength: 0.5,
      comboSpacing: 20,
      comboPadding: 10,
      edgeStrength: 0.6,
      nodeStrength: 30,
      linkDistance: 10
    };
  }, t.prototype.execute = function() {
    var e = this, n = e.nodes, i = e.center;
    if (e.comboTree = {
      id: "comboTreeRoot",
      depth: -1,
      children: e.comboTrees
    }, !n || n.length === 0) {
      e.onLayoutEnd && e.onLayoutEnd();
      return;
    }
    if (n.length === 1) {
      n[0].x = i[0], n[0].y = i[1], e.onLayoutEnd && e.onLayoutEnd();
      return;
    }
    e.initVals(), e.run(), e.onLayoutEnd && e.onLayoutEnd();
  }, t.prototype.run = function() {
    var e = this, n = e.nodes, i = e.previousLayouted ? e.maxIteration / 5 : e.maxIteration;
    !e.width && typeof window < "u" && (e.width = window.innerWidth), !e.height && typeof window < "u" && (e.height = window.innerHeight);
    var a = e.center, o = e.velocityDecay, s = e.comboMap;
    e.previousLayouted || e.initPos(s);
    for (var u = function(h) {
      var d = [];
      n.forEach(function(v, p) {
        d[p] = { x: 0, y: 0 };
      }), e.applyCalculate(d), e.applyComboCenterForce(d), n.forEach(function(v, p) {
        !(0, or.isNumber)(v.x) || !(0, or.isNumber)(v.y) || (v.x += d[p].x * o, v.y += d[p].y * o);
      }), e.alpha += (e.alphaTarget - e.alpha) * e.alphaDecay, e.onTick();
    }, f = 0; f < i; f++)
      u();
    var l = [0, 0];
    n.forEach(function(h) {
      !(0, or.isNumber)(h.x) || !(0, or.isNumber)(h.y) || (l[0] += h.x, l[1] += h.y);
    }), l[0] /= n.length, l[1] /= n.length;
    var c = [a[0] - l[0], a[1] - l[1]];
    n.forEach(function(h, d) {
      !(0, or.isNumber)(h.x) || !(0, or.isNumber)(h.y) || (h.x += c[0], h.y += c[1]);
    }), e.combos.forEach(function(h) {
      var d = s[h.id];
      d && d.empty && (h.x = d.cx || h.x, h.y = d.cy || h.y);
    }), e.previousLayouted = !0;
  }, t.prototype.initVals = function() {
    var e = this, n = e.edges, i = e.nodes, a = e.combos, o = {}, s = {}, u = {};
    i.forEach(function(D, G) {
      s[D.id] = D, u[D.id] = G;
    }), e.nodeMap = s, e.indexMap = u;
    var f = {};
    a.forEach(function(D) {
      f[D.id] = D;
    }), e.oriComboMap = f, e.comboMap = e.getComboMap();
    var l = e.preventOverlap;
    e.preventComboOverlap = e.preventComboOverlap || l, e.preventNodeOverlap = e.preventNodeOverlap || l;
    var c = e.collideStrength;
    c && (e.comboCollideStrength = c, e.nodeCollideStrength = c), e.comboCollideStrength = e.comboCollideStrength ? e.comboCollideStrength : 0, e.nodeCollideStrength = e.nodeCollideStrength ? e.nodeCollideStrength : 0;
    for (var h = 0; h < n.length; ++h) {
      var d = (0, or.getEdgeTerminal)(n[h], "source"), v = (0, or.getEdgeTerminal)(n[h], "target");
      o[d] ? o[d]++ : o[d] = 1, o[v] ? o[v]++ : o[v] = 1;
    }
    for (var p = [], h = 0; h < n.length; ++h) {
      var d = (0, or.getEdgeTerminal)(n[h], "source"), v = (0, or.getEdgeTerminal)(n[h], "target");
      p[h] = o[d] / (o[d] + o[v]);
    }
    this.bias = p;
    var g = e.nodeSize, y = e.nodeSpacing, b, m;
    if ((0, or.isNumber)(y) ? m = function() {
      return y;
    } : (0, or.isFunction)(y) ? m = y : m = function() {
      return 0;
    }, this.nodeSpacing = m, !g)
      b = function(D) {
        if (D.size) {
          if ((0, or.isArray)(D.size)) {
            var G = D.size[0] > D.size[1] ? D.size[0] : D.size[1];
            return G / 2;
          }
          if ((0, or.isObject)(D.size)) {
            var G = D.size.width > D.size.height ? D.size.width : D.size.height;
            return G / 2;
          }
          return D.size / 2;
        }
        return 10;
      };
    else if ((0, or.isFunction)(g))
      b = function(D) {
        return g(D);
      };
    else if ((0, or.isArray)(g)) {
      var x = g[0] > g[1] ? g[0] : g[1], _ = x / 2;
      b = function(D) {
        return _;
      };
    } else {
      var w = g / 2;
      b = function(D) {
        return w;
      };
    }
    this.nodeSize = b;
    var E = e.comboSpacing, M;
    (0, or.isNumber)(E) ? M = function() {
      return E;
    } : (0, or.isFunction)(E) ? M = E : M = function() {
      return 0;
    }, this.comboSpacing = M;
    var C = e.comboPadding, S;
    (0, or.isNumber)(C) ? S = function() {
      return C;
    } : (0, or.isArray)(C) ? S = function() {
      return Math.max.apply(null, C);
    } : (0, or.isFunction)(C) ? S = C : S = function() {
      return 0;
    }, this.comboPadding = S;
    var A = this.linkDistance, T;
    A || (A = 10), (0, or.isNumber)(A) ? T = function(D) {
      return A;
    } : T = A, this.linkDistance = T;
    var P = this.edgeStrength, k;
    P || (P = 1), (0, or.isNumber)(P) ? k = function(D) {
      return P;
    } : k = P, this.edgeStrength = k;
    var L = this.nodeStrength, O;
    L || (L = 30), (0, or.isNumber)(L) ? O = function(D) {
      return L;
    } : O = L, this.nodeStrength = O;
  }, t.prototype.initPos = function(e) {
    var n = this, i = n.nodes;
    i.forEach(function(a, o) {
      var s = a.comboId, u = e[s];
      s && u ? (a.x = u.cx + 100 / (o + 1), a.y = u.cy + 100 / (o + 1)) : (a.x = 100 / (o + 1), a.y = 100 / (o + 1));
    });
  }, t.prototype.getComboMap = function() {
    var e = this, n = e.nodeMap, i = e.comboTrees, a = e.oriComboMap, o = {};
    return (i || []).forEach(function(s) {
      var u = [];
      (0, or.traverseTreeUp)(s, function(f) {
        if (f.itemType === "node" || !a[f.id])
          return !0;
        if (o[f.id] === void 0) {
          var l = {
            id: f.id,
            name: f.id,
            cx: 0,
            cy: 0,
            count: 0,
            depth: e.oriComboMap[f.id].depth || 0,
            children: []
          };
          o[f.id] = l;
        }
        var c = f.children;
        c && c.forEach(function(v) {
          if (!o[v.id] && !n[v.id])
            return !0;
          u.push(v);
        });
        var h = o[f.id];
        if (h.cx = 0, h.cy = 0, u.length === 0) {
          h.empty = !0;
          var d = a[f.id];
          h.cx = d.x, h.cy = d.y;
        }
        return u.forEach(function(v) {
          if (h.count++, v.itemType !== "node") {
            var p = o[v.id];
            (0, or.isNumber)(p.cx) && (h.cx += p.cx), (0, or.isNumber)(p.cy) && (h.cy += p.cy);
            return;
          }
          var g = n[v.id];
          !g || ((0, or.isNumber)(g.x) && (h.cx += g.x), (0, or.isNumber)(g.y) && (h.cy += g.y));
        }), h.cx /= h.count || 1, h.cy /= h.count || 1, h.children = u, !0;
      });
    }), o;
  }, t.prototype.applyComboCenterForce = function(e) {
    var n = this, i = n.gravity, a = n.comboGravity || i, o = this.alpha, s = n.comboTrees, u = n.indexMap, f = n.nodeMap, l = n.comboMap;
    (s || []).forEach(function(c) {
      (0, or.traverseTreeUp)(c, function(h) {
        if (h.itemType === "node")
          return !0;
        var d = l[h.id];
        if (!d)
          return !0;
        var v = l[h.id], p = (v.depth + 1) / 10 * 0.5, g = v.cx, y = v.cy;
        return v.cx = 0, v.cy = 0, v.children.forEach(function(b) {
          if (b.itemType !== "node") {
            var m = l[b.id];
            m && (0, or.isNumber)(m.cx) && (v.cx += m.cx), m && (0, or.isNumber)(m.cy) && (v.cy += m.cy);
            return;
          }
          var x = f[b.id], _ = x.x - g || 5e-3, w = x.y - y || 5e-3, E = Math.sqrt(_ * _ + w * w), M = u[x.id], C = a * o / E * p;
          e[M].x -= _ * C, e[M].y -= w * C, (0, or.isNumber)(x.x) && (v.cx += x.x), (0, or.isNumber)(x.y) && (v.cy += x.y);
        }), v.cx /= v.count || 1, v.cy /= v.count || 1, !0;
      });
    });
  }, t.prototype.applyCalculate = function(e) {
    var n = this, i = n.comboMap, a = n.nodes, o = {};
    a.forEach(function(u, f) {
      a.forEach(function(l, c) {
        if (!(f < c)) {
          var h = u.x - l.x || 5e-3, d = u.y - l.y || 5e-3, v = h * h + d * d, p = Math.sqrt(v);
          v < 1 && (v = p), o["".concat(u.id, "-").concat(l.id)] = { vx: h, vy: d, vl2: v, vl: p }, o["".concat(l.id, "-").concat(u.id)] = { vl2: v, vl: p, vx: -h, vy: -d };
        }
      });
    }), n.updateComboSizes(i), n.calRepulsive(e, o), n.calAttractive(e, o);
    var s = n.preventComboOverlap;
    s && n.comboNonOverlapping(e, i);
  }, t.prototype.updateComboSizes = function(e) {
    var n = this, i = n.comboTrees, a = n.nodeMap, o = n.nodeSize, s = n.comboSpacing, u = n.comboPadding;
    (i || []).forEach(function(f) {
      var l = [];
      (0, or.traverseTreeUp)(f, function(c) {
        if (c.itemType === "node")
          return !0;
        var h = e[c.id];
        if (!h)
          return !1;
        var d = c.children;
        d && d.forEach(function(g) {
          !e[g.id] && !a[g.id] || l.push(g);
        }), h.minX = 1 / 0, h.minY = 1 / 0, h.maxX = -1 / 0, h.maxY = -1 / 0, l.forEach(function(g) {
          if (g.itemType !== "node")
            return !0;
          var y = a[g.id];
          if (!y)
            return !0;
          var b = o(y), m = y.x - b, x = y.y - b, _ = y.x + b, w = y.y + b;
          h.minX > m && (h.minX = m), h.minY > x && (h.minY = x), h.maxX < _ && (h.maxX = _), h.maxY < w && (h.maxY = w);
        });
        var v = n.oriComboMap[c.id].size || 10;
        (0, or.isArray)(v) && (v = v[0]);
        var p = Math.max(h.maxX - h.minX, h.maxY - h.minY, v);
        return h.r = p / 2 + s(h) / 2 + u(h), !0;
      });
    });
  }, t.prototype.comboNonOverlapping = function(e, n) {
    var i = this, a = i.comboTree, o = i.comboCollideStrength, s = i.indexMap, u = i.nodeMap;
    (0, or.traverseTreeUp)(a, function(f) {
      if (!n[f.id] && !u[f.id] && f.id !== "comboTreeRoot")
        return !1;
      var l = f.children;
      return l && l.length > 1 && l.forEach(function(c, h) {
        if (c.itemType === "node")
          return !1;
        var d = n[c.id];
        !d || l.forEach(function(v, p) {
          if (h <= p || v.itemType === "node")
            return !1;
          var g = n[v.id];
          if (!g)
            return !1;
          var y = d.cx - g.cx || 5e-3, b = d.cy - g.cy || 5e-3, m = y * y + b * b, x = d.r || 1, _ = g.r || 1, w = x + _, E = _ * _, M = x * x;
          if (m < w * w) {
            var C = c.children;
            if (!C || C.length === 0)
              return !1;
            var S = v.children;
            if (!S || S.length === 0)
              return !1;
            var A = Math.sqrt(m), T = (w - A) / A * o, P = y * T, k = b * T, L = E / (M + E), O = 1 - L;
            C.forEach(function(D) {
              if (D.itemType !== "node")
                return !1;
              if (!!u[D.id]) {
                var G = s[D.id];
                S.forEach(function(R) {
                  if (R.itemType !== "node" || !u[R.id])
                    return !1;
                  var F = s[R.id];
                  e[G].x += P * L, e[G].y += k * L, e[F].x -= P * O, e[F].y -= k * O;
                });
              }
            });
          }
        });
      }), !0;
    });
  }, t.prototype.calRepulsive = function(e, n) {
    var i = this, a = i.nodes, o = i.width * i.optimizeRangeFactor, s = i.nodeStrength, u = i.alpha, f = i.nodeCollideStrength, l = i.preventNodeOverlap, c = i.nodeSize, h = i.nodeSpacing, d = i.depthRepulsiveForceScale, v = i.center;
    a.forEach(function(p, g) {
      if (!(!p.x || !p.y)) {
        if (v) {
          var y = i.gravity, b = p.x - v[0] || 5e-3, m = p.y - v[1] || 5e-3, x = Math.sqrt(b * b + m * m);
          e[g].x -= b * y * u / x, e[g].y -= m * y * u / x;
        }
        a.forEach(function(_, w) {
          if (g !== w && !(!_.x || !_.y)) {
            var E = n["".concat(p.id, "-").concat(_.id)], M = E.vl2, C = E.vl;
            if (!(C > o)) {
              var S = n["".concat(p.id, "-").concat(_.id)], A = S.vx, T = S.vy, P = Math.log(Math.abs(_.depth - p.depth) / 10) + 1 || 1;
              P = P < 1 ? 1 : P, _.comboId !== p.comboId && (P += 1);
              var k = P ? Math.pow(d, P) : 1, L = s(_) * u / M * k;
              if (e[g].x += A * L, e[g].y += T * L, g < w && l) {
                var O = c(p) + h(p) || 1, D = c(_) + h(_) || 1, G = O + D;
                if (M < G * G) {
                  var R = (G - C) / C * f, F = D * D, q = F / (O * O + F), ne = A * R, oe = T * R;
                  e[g].x += ne * q, e[g].y += oe * q, q = 1 - q, e[w].x -= ne * q, e[w].y -= oe * q;
                }
              }
            }
          }
        });
      }
    });
  }, t.prototype.calAttractive = function(e, n) {
    var i = this, a = i.edges, o = i.linkDistance, s = i.alpha, u = i.edgeStrength, f = i.bias, l = i.depthAttractiveForceScale;
    a.forEach(function(c, h) {
      var d = (0, or.getEdgeTerminal)(c, "source"), v = (0, or.getEdgeTerminal)(c, "target");
      if (!(!d || !v || d === v)) {
        var p = i.indexMap[d], g = i.indexMap[v], y = i.nodeMap[d], b = i.nodeMap[v];
        if (!(!y || !b)) {
          var m = y.depth === b.depth ? 0 : Math.log(Math.abs(y.depth - b.depth) / 10);
          y.comboId === b.comboId && (m = m / 2);
          var x = m ? Math.pow(l, m) : 1;
          if (y.comboId !== b.comboId && x === 1 ? x = l / 2 : y.comboId === b.comboId && (x = 2), !(!(0, or.isNumber)(b.x) || !(0, or.isNumber)(y.x) || !(0, or.isNumber)(b.y) || !(0, or.isNumber)(y.y))) {
            var _ = n["".concat(v, "-").concat(d)], w = _.vl, E = _.vx, M = _.vy, C = (w - o(c)) / w * s * u(c) * x, S = E * C, A = M * C, T = f[h];
            e[g].x -= S * T, e[g].y -= A * T, e[p].x += S * (1 - T), e[p].y += A * (1 - T);
          }
        }
      }
    });
  }, t.prototype.getType = function() {
    return "comboForce";
  }, t;
}(fpe.Base);
Sh.ComboForceLayout = lpe;
var Hl = {}, bO;
function j5() {
  if (bO)
    return Hl;
  bO = 1;
  var r = Oe && Oe.__extends || function() {
    var s = function(u, f) {
      return s = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(l, c) {
        l.__proto__ = c;
      } || function(l, c) {
        for (var h in c)
          Object.prototype.hasOwnProperty.call(c, h) && (l[h] = c[h]);
      }, s(u, f);
    };
    return function(u, f) {
      if (typeof f != "function" && f !== null)
        throw new TypeError("Class extends value " + String(f) + " is not a constructor or null");
      s(u, f);
      function l() {
        this.constructor = u;
      }
      u.prototype = f === null ? Object.create(f) : (l.prototype = f.prototype, new l());
    };
  }(), t = Oe && Oe.__assign || function() {
    return t = Object.assign || function(s) {
      for (var u, f = 1, l = arguments.length; f < l; f++) {
        u = arguments[f];
        for (var c in u)
          Object.prototype.hasOwnProperty.call(u, c) && (s[c] = u[c]);
      }
      return s;
    }, t.apply(this, arguments);
  };
  Object.defineProperty(Hl, "__esModule", { value: !0 }), Hl.ComboCombinedLayout = void 0;
  var e = Co, n = an, i = on(), a = q5(), o = function(s) {
    r(u, s);
    function u(f) {
      var l = s.call(this) || this;
      return l.center = [0, 0], l.nodes = [], l.edges = [], l.combos = [], l.comboEdges = [], l.comboPadding = 10, l.comboTrees = [], l.updateCfg(f), l;
    }
    return u.prototype.getDefaultCfg = function() {
      return {};
    }, u.prototype.execute = function() {
      var f = this, l = f.nodes, c = f.center;
      if (!l || l.length === 0) {
        f.onLayoutEnd && f.onLayoutEnd();
        return;
      }
      if (l.length === 1) {
        l[0].x = c[0], l[0].y = c[1], f.onLayoutEnd && f.onLayoutEnd();
        return;
      }
      f.initVals(), f.run(), f.onLayoutEnd && f.onLayoutEnd();
    }, u.prototype.run = function() {
      var f, l = this, c = l.nodes, h = l.edges, d = l.combos, v = l.comboEdges, p = l.center, g = {};
      c.forEach(function(L) {
        g[L.id] = L;
      });
      var y = {};
      d.forEach(function(L) {
        y[L.id] = L;
      });
      var b = l.getInnerGraphs(g), m = [], x = [], _ = {}, w = !0;
      this.comboTrees.forEach(function(L) {
        var O = b[L.id], D = t(t({}, L), { x: O.x || y[L.id].x, y: O.y || y[L.id].y, fx: O.fx || y[L.id].fx, fy: O.fy || y[L.id].fy, mass: O.mass || y[L.id].mass, size: O.size });
        x.push(D), !isNaN(D.x) && D.x !== 0 && !isNaN(D.y) && D.y !== 0 ? w = !1 : (D.x = Math.random() * 100, D.y = Math.random() * 100), m.push(L.id), (0, i.traverseTreeUp)(L, function(G) {
          return G.id !== L.id && (_[G.id] = L.id), !0;
        });
      }), c.forEach(function(L) {
        if (!(L.comboId && y[L.comboId])) {
          var O = t({}, L);
          x.push(O), !isNaN(O.x) && O.x !== 0 && !isNaN(O.y) && O.y !== 0 ? w = !1 : (O.x = Math.random() * 100, O.y = Math.random() * 100), m.push(L.id);
        }
      });
      var E = [];
      if (h.concat(v).forEach(function(L) {
        var O = _[L.source] || L.source, D = _[L.target] || L.target;
        O !== D && m.includes(O) && m.includes(D) && E.push({
          source: O,
          target: D
        });
      }), x != null && x.length) {
        if (x.length === 1)
          x[0].x = p[0], x[0].y = p[1];
        else {
          var M = {
            nodes: x,
            edges: E
          }, C = this.outerLayout || new a.GForceLayout({
            gravity: 1,
            factor: 2,
            linkDistance: function(L, O, D) {
              var G, R, F = ((((G = O.size) === null || G === void 0 ? void 0 : G[0]) || 30) + (((R = D.size) === null || R === void 0 ? void 0 : R[0]) || 30)) / 2;
              return Math.min(F * 1.5, 700);
            }
          }), S = (f = C.getType) === null || f === void 0 ? void 0 : f.call(C);
          if (C.updateCfg({
            center: p,
            kg: 5,
            preventOverlap: !0,
            animate: !1
          }), w && e.FORCE_LAYOUT_TYPE_MAP[S]) {
            var A = x.length < 100 ? new a.MDSLayout() : new a.GridLayout();
            A.layout(M);
          }
          C.layout(M);
        }
        x.forEach(function(L) {
          var O = b[L.id];
          if (!O) {
            var D = g[L.id];
            D && (D.x = L.x, D.y = L.y);
            return;
          }
          O.visited = !0, O.x = L.x, O.y = L.y, O.nodes.forEach(function(G) {
            G.x += L.x, G.y += L.y;
          });
        });
      }
      for (var T = Object.keys(b), P = function(L) {
        var O = T[L], D = b[O];
        if (!D)
          return "continue";
        D.nodes.forEach(function(G) {
          D.visited || (G.x += D.x || 0, G.y += D.y || 0), g[G.id] && (g[G.id].x = G.x, g[G.id].y = G.y);
        }), y[O] && (y[O].x = D.x, y[O].y = D.y);
      }, k = T.length - 1; k >= 0; k--)
        P(k);
      return { nodes: c, edges: h, combos: d, comboEdges: v };
    }, u.prototype.getInnerGraphs = function(f) {
      var l = this, c = l.comboTrees, h = l.nodeSize, d = l.edges, v = l.comboPadding, p = l.spacing, g = {}, y = this.innerLayout || new a.ConcentricLayout({ sortBy: "id" });
      return y.center = [0, 0], y.preventOverlap = !0, y.nodeSpacing = p, (c || []).forEach(function(b) {
        (0, i.traverseTreeUp)(b, function(m) {
          var x, _ = (v == null ? void 0 : v(m)) || 10;
          if ((0, i.isArray)(_) && (_ = Math.max.apply(Math, _)), !((x = m.children) === null || x === void 0) && x.length) {
            var E = m.children.map(function(D) {
              if (D.itemType === "combo")
                return g[D.id];
              var G = f[D.id] || {};
              return t(t({}, G), D);
            }), M = E.map(function(D) {
              return D.id;
            }), C = {
              nodes: E,
              edges: d.filter(function(D) {
                return M.includes(D.source) && M.includes(D.target);
              })
            }, S = 1 / 0;
            E.forEach(function(D) {
              var G;
              D.size || (D.size = ((G = g[D.id]) === null || G === void 0 ? void 0 : G.size) || (h == null ? void 0 : h(D)) || [30, 30]), (0, i.isNumber)(D.size) && (D.size = [D.size, D.size]), S > D.size[0] && (S = D.size[0]), S > D.size[1] && (S = D.size[1]);
            }), y.layout(C);
            var A = (0, i.findMinMaxNodeXY)(E), T = A.minX, P = A.minY, k = A.maxX, L = A.maxY, O = Math.max(k - T, L - P, S) + _ * 2;
            g[m.id] = {
              id: m.id,
              nodes: E,
              size: [O, O]
            };
          } else if (m.itemType === "combo") {
            var w = _ ? [_ * 2, _ * 2] : [30, 30];
            g[m.id] = {
              id: m.id,
              nodes: [],
              size: w
            };
          }
          return !0;
        });
      }), g;
    }, u.prototype.initVals = function() {
      var f = this, l = f.nodeSize, c = f.spacing, h, d;
      if ((0, i.isNumber)(c) ? d = function() {
        return c;
      } : (0, i.isFunction)(c) ? d = c : d = function() {
        return 0;
      }, this.spacing = d, !l)
        h = function(m) {
          var x = d(m);
          if (m.size) {
            if ((0, i.isArray)(m.size)) {
              var _ = m.size[0] > m.size[1] ? m.size[0] : m.size[1];
              return (_ + x) / 2;
            }
            if ((0, i.isObject)(m.size)) {
              var _ = m.size.width > m.size.height ? m.size.width : m.size.height;
              return (_ + x) / 2;
            }
            return (m.size + x) / 2;
          }
          return 10 + x / 2;
        };
      else if ((0, i.isFunction)(l))
        h = function(m) {
          var x = l(m), _ = d(m);
          if ((0, i.isArray)(m.size)) {
            var w = m.size[0] > m.size[1] ? m.size[0] : m.size[1];
            return (w + _) / 2;
          }
          return ((x || 10) + _) / 2;
        };
      else if ((0, i.isArray)(l)) {
        var v = l[0] > l[1] ? l[0] : l[1], p = v / 2;
        h = function(m) {
          return p + d(m) / 2;
        };
      } else {
        var g = l / 2;
        h = function(m) {
          return g + d(m) / 2;
        };
      }
      this.nodeSize = h;
      var y = f.comboPadding, b;
      (0, i.isNumber)(y) ? b = function() {
        return y;
      } : (0, i.isArray)(y) ? b = function() {
        return Math.max.apply(null, y);
      } : (0, i.isFunction)(y) ? b = y : b = function() {
        return 0;
      }, this.comboPadding = b;
    }, u.prototype.getType = function() {
      return "comboCombined";
    }, u;
  }(n.Base);
  return Hl.ComboCombinedLayout = o, Hl;
}
var Mh = {}, Qx = {};
Object.defineProperty(Qx, "__esModule", { value: !0 });
var cpe = function() {
  function r(t) {
    this.id = t.id || 0, this.rx = t.rx, this.ry = t.ry, this.fx = 0, this.fy = 0, this.mass = t.mass, this.degree = t.degree, this.g = t.g || 0;
  }
  return r.prototype.distanceTo = function(t) {
    var e = this.rx - t.rx, n = this.ry - t.ry;
    return Math.hypot(e, n);
  }, r.prototype.setPos = function(t, e) {
    this.rx = t, this.ry = e;
  }, r.prototype.resetForce = function() {
    this.fx = 0, this.fy = 0;
  }, r.prototype.addForce = function(t) {
    var e = t.rx - this.rx, n = t.ry - this.ry, i = Math.hypot(e, n);
    i = i < 1e-4 ? 1e-4 : i;
    var a = this.g * (this.degree + 1) * (t.degree + 1) / i;
    this.fx += a * e / i, this.fy += a * n / i;
  }, r.prototype.in = function(t) {
    return t.contains(this.rx, this.ry);
  }, r.prototype.add = function(t) {
    var e = this.mass + t.mass, n = (this.rx * this.mass + t.rx * t.mass) / e, i = (this.ry * this.mass + t.ry * t.mass) / e, a = this.degree + t.degree, o = {
      rx: n,
      ry: i,
      mass: e,
      degree: a
    };
    return new r(o);
  }, r;
}();
Qx.default = cpe;
var Jx = {};
Object.defineProperty(Jx, "__esModule", { value: !0 });
var hpe = function() {
  function r(t) {
    this.xmid = t.xmid, this.ymid = t.ymid, this.length = t.length, this.massCenter = t.massCenter || [0, 0], this.mass = t.mass || 1;
  }
  return r.prototype.getLength = function() {
    return this.length;
  }, r.prototype.contains = function(t, e) {
    var n = this.length / 2;
    return t <= this.xmid + n && t >= this.xmid - n && e <= this.ymid + n && e >= this.ymid - n;
  }, r.prototype.NW = function() {
    var t = this.xmid - this.length / 4, e = this.ymid + this.length / 4, n = this.length / 2, i = {
      xmid: t,
      ymid: e,
      length: n
    }, a = new r(i);
    return a;
  }, r.prototype.NE = function() {
    var t = this.xmid + this.length / 4, e = this.ymid + this.length / 4, n = this.length / 2, i = {
      xmid: t,
      ymid: e,
      length: n
    }, a = new r(i);
    return a;
  }, r.prototype.SW = function() {
    var t = this.xmid - this.length / 4, e = this.ymid - this.length / 4, n = this.length / 2, i = {
      xmid: t,
      ymid: e,
      length: n
    }, a = new r(i);
    return a;
  }, r.prototype.SE = function() {
    var t = this.xmid + this.length / 4, e = this.ymid - this.length / 4, n = this.length / 2, i = {
      xmid: t,
      ymid: e,
      length: n
    }, a = new r(i);
    return a;
  }, r;
}();
Jx.default = hpe;
var e_ = {};
Object.defineProperty(e_, "__esModule", { value: !0 });
var dpe = function() {
  function r(t) {
    this.body = null, this.quad = null, this.NW = null, this.NE = null, this.SW = null, this.SE = null, this.theta = 0.5, t != null && (this.quad = t);
  }
  return r.prototype.insert = function(t) {
    if (this.body == null) {
      this.body = t;
      return;
    }
    this._isExternal() ? (this.quad && (this.NW = new r(this.quad.NW()), this.NE = new r(this.quad.NE()), this.SW = new r(this.quad.SW()), this.SE = new r(this.quad.SE())), this._putBody(this.body), this._putBody(t), this.body = this.body.add(t)) : (this.body = this.body.add(t), this._putBody(t));
  }, r.prototype._putBody = function(t) {
    !this.quad || (t.in(this.quad.NW()) && this.NW ? this.NW.insert(t) : t.in(this.quad.NE()) && this.NE ? this.NE.insert(t) : t.in(this.quad.SW()) && this.SW ? this.SW.insert(t) : t.in(this.quad.SE()) && this.SE && this.SE.insert(t));
  }, r.prototype._isExternal = function() {
    return this.NW == null && this.NE == null && this.SW == null && this.SE == null;
  }, r.prototype.updateForce = function(t) {
    if (!(this.body == null || t === this.body))
      if (this._isExternal())
        t.addForce(this.body);
      else {
        var e = this.quad ? this.quad.getLength() : 0, n = this.body.distanceTo(t);
        e / n < this.theta ? t.addForce(this.body) : (this.NW && this.NW.updateForce(t), this.NE && this.NE.updateForce(t), this.SW && this.SW.updateForce(t), this.SE && this.SE.updateForce(t));
      }
  }, r;
}();
e_.default = dpe;
var vpe = Oe && Oe.__extends || function() {
  var r = function(t, e) {
    return r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(n, i) {
      n.__proto__ = i;
    } || function(n, i) {
      for (var a in i)
        Object.prototype.hasOwnProperty.call(i, a) && (n[a] = i[a]);
    }, r(t, e);
  };
  return function(t, e) {
    if (typeof e != "function" && e !== null)
      throw new TypeError("Class extends value " + String(e) + " is not a constructor or null");
    r(t, e);
    function n() {
      this.constructor = t;
    }
    t.prototype = e === null ? Object.create(e) : (n.prototype = e.prototype, new n());
  };
}(), t_ = Oe && Oe.__importDefault || function(r) {
  return r && r.__esModule ? r : { default: r };
};
Object.defineProperty(Mh, "__esModule", { value: !0 });
Mh.ForceAtlas2Layout = void 0;
var ppe = an, fo = on(), gpe = t_(Qx), ype = t_(Jx), mpe = t_(e_), bpe = function(r) {
  vpe(t, r);
  function t(e) {
    var n = r.call(this) || this;
    return n.center = [0, 0], n.width = 300, n.height = 300, n.nodes = [], n.edges = [], n.kr = 5, n.kg = 1, n.mode = "normal", n.preventOverlap = !1, n.dissuadeHubs = !1, n.barnesHut = void 0, n.maxIteration = 0, n.ks = 0.1, n.ksmax = 10, n.tao = 0.1, n.onLayoutEnd = function() {
    }, n.prune = void 0, n.updateCfg(e), n;
  }
  return t.prototype.getDefaultCfg = function() {
    return {};
  }, t.prototype.execute = function() {
    var e = this, n = e.nodes, i = e.onLayoutEnd, a = e.prune, o = e.maxIteration;
    !e.width && typeof window < "u" && (e.width = window.innerWidth), !e.height && typeof window < "u" && (e.height = window.innerHeight);
    for (var s = [], u = n.length, f = 0; f < u; f += 1) {
      var l = n[f], c = 10, h = 10;
      (0, fo.isNumber)(l.size) && (c = l.size, h = l.size), (0, fo.isArray)(l.size) ? (isNaN(l.size[0]) || (c = l.size[0]), isNaN(l.size[1]) || (h = l.size[1])) : (0, fo.isObject)(l.size) && (c = l.size.width, h = l.size.height), e.getWidth && !isNaN(e.getWidth(l)) && (h = e.getWidth(l)), e.getHeight && !isNaN(e.getHeight(l)) && (c = e.getHeight(l));
      var d = Math.max(c, h);
      s.push(d);
    }
    e.barnesHut === void 0 && u > 250 && (e.barnesHut = !0), e.prune === void 0 && u > 100 && (e.prune = !0), this.maxIteration === 0 && !e.prune ? (o = 250, u <= 200 && u > 100 ? o = 1e3 : u > 200 && (o = 1200), this.maxIteration = o) : this.maxIteration === 0 && a && (o = 100, u <= 200 && u > 100 ? o = 500 : u > 200 && (o = 950), this.maxIteration = o), e.kr || (e.kr = 50, u > 100 && u <= 500 ? e.kr = 20 : u > 500 && (e.kr = 1)), e.kg || (e.kg = 20, u > 100 && u <= 500 ? e.kg = 10 : u > 500 && (e.kg = 1)), this.nodes = e.updateNodesByForces(s), i();
  }, t.prototype.updateNodesByForces = function(e) {
    for (var n = this, i = n.edges, a = n.maxIteration, o = n.nodes, s = i.filter(function(E) {
      var M = (0, fo.getEdgeTerminal)(E, "source"), C = (0, fo.getEdgeTerminal)(E, "target");
      return M !== C;
    }), u = o.length, f = s.length, l = [], c = {}, h = {}, d = [], v = 0; v < u; v += 1)
      c[o[v].id] = v, l[v] = 0, (o[v].x === void 0 || isNaN(o[v].x)) && (o[v].x = Math.random() * 1e3), (o[v].y === void 0 || isNaN(o[v].y)) && (o[v].y = Math.random() * 1e3), d.push({ x: o[v].x, y: o[v].y });
    for (var v = 0; v < f; v += 1) {
      for (var p = void 0, g = void 0, y = 0, b = 0, m = 0; m < u; m += 1) {
        var x = (0, fo.getEdgeTerminal)(s[v], "source"), _ = (0, fo.getEdgeTerminal)(s[v], "target");
        o[m].id === x ? (p = o[m], y = m) : o[m].id === _ && (g = o[m], b = m), h[v] = { sourceIdx: y, targetIdx: b };
      }
      p && (l[c[p.id]] += 1), g && (l[c[g.id]] += 1);
    }
    var w = a;
    if (o = this.iterate(w, c, h, f, l, e), n.prune) {
      for (var m = 0; m < f; m += 1)
        l[h[m].sourceIdx] <= 1 ? (o[h[m].sourceIdx].x = o[h[m].targetIdx].x, o[h[m].sourceIdx].y = o[h[m].targetIdx].y) : l[h[m].targetIdx] <= 1 && (o[h[m].targetIdx].x = o[h[m].sourceIdx].x, o[h[m].targetIdx].y = o[h[m].sourceIdx].y);
      n.prune = !1, n.barnesHut = !1, w = 100, o = this.iterate(w, c, h, f, l, e);
    }
    return o;
  }, t.prototype.iterate = function(e, n, i, a, o, s) {
    for (var u = this, f = u.nodes, l = u.kr, c = u.preventOverlap, h = u.barnesHut, d = f.length, v = 0, p = 100, g = e, y = 50, b = [], m = [], x = [], _ = 0; _ < d; _ += 1)
      if (b[2 * _] = 0, b[2 * _ + 1] = 0, h) {
        var w = {
          id: _,
          rx: f[_].x,
          ry: f[_].y,
          mass: 1,
          g: l,
          degree: o[_]
        };
        x[_] = new gpe.default(w);
      }
    for (; g > 0; ) {
      for (var _ = 0; _ < d; _ += 1)
        m[2 * _] = b[2 * _], m[2 * _ + 1] = b[2 * _ + 1], b[2 * _] = 0, b[2 * _ + 1] = 0;
      b = this.getAttrForces(g, y, a, n, i, o, s, b), h && (c && g > y || !c) ? b = this.getOptRepGraForces(b, x, o) : b = this.getRepGraForces(g, y, b, p, s, o);
      var E = this.updatePos(b, m, v, o);
      f = E.nodes, v = E.sg, g--, u.tick && u.tick();
    }
    return f;
  }, t.prototype.getAttrForces = function(e, n, i, a, o, s, u, f) {
    for (var l = this, c = l.nodes, h = l.preventOverlap, d = l.dissuadeHubs, v = l.mode, p = l.prune, g = 0; g < i; g += 1) {
      var y = c[o[g].sourceIdx], b = o[g].sourceIdx, m = c[o[g].targetIdx], x = o[g].targetIdx;
      if (!(p && (s[b] <= 1 || s[x] <= 1))) {
        var _ = [m.x - y.x, m.y - y.y], w = Math.hypot(_[0], _[1]);
        w = w < 1e-4 ? 1e-4 : w, _[0] = _[0] / w, _[1] = _[1] / w, h && e < n && (w = w - u[b] - u[x]);
        var E = w, M = E;
        v === "linlog" && (E = Math.log(1 + w), M = E), d && (E = w / s[b], M = w / s[x]), h && e < n && w <= 0 ? (E = 0, M = 0) : h && e < n && w > 0 && (E = w, M = w), f[2 * a[y.id]] += E * _[0], f[2 * a[m.id]] -= M * _[0], f[2 * a[y.id] + 1] += E * _[1], f[2 * a[m.id] + 1] -= M * _[1];
      }
    }
    return f;
  }, t.prototype.getRepGraForces = function(e, n, i, a, o, s) {
    for (var u = this, f = u.nodes, l = u.preventOverlap, c = u.kr, h = u.kg, d = u.center, v = u.prune, p = f.length, g = 0; g < p; g += 1) {
      for (var y = g + 1; y < p; y += 1)
        if (!(v && (s[g] <= 1 || s[y] <= 1))) {
          var b = [f[y].x - f[g].x, f[y].y - f[g].y], m = Math.hypot(b[0], b[1]);
          m = m < 1e-4 ? 1e-4 : m, b[0] = b[0] / m, b[1] = b[1] / m, l && e < n && (m = m - o[g] - o[y]);
          var x = c * (s[g] + 1) * (s[y] + 1) / m;
          l && e < n && m < 0 ? x = a * (s[g] + 1) * (s[y] + 1) : l && e < n && m === 0 ? x = 0 : l && e < n && m > 0 && (x = c * (s[g] + 1) * (s[y] + 1) / m), i[2 * g] -= x * b[0], i[2 * y] += x * b[0], i[2 * g + 1] -= x * b[1], i[2 * y + 1] += x * b[1];
        }
      var _ = [f[g].x - d[0], f[g].y - d[1]], w = Math.hypot(_[0], _[1]);
      _[0] = _[0] / w, _[1] = _[1] / w;
      var E = h * (s[g] + 1);
      i[2 * g] -= E * _[0], i[2 * g + 1] -= E * _[1];
    }
    return i;
  }, t.prototype.getOptRepGraForces = function(e, n, i) {
    for (var a = this, o = a.nodes, s = a.kg, u = a.center, f = a.prune, l = o.length, c = 9e10, h = -9e10, d = 9e10, v = -9e10, p = 0; p < l; p += 1)
      f && i[p] <= 1 || (n[p].setPos(o[p].x, o[p].y), o[p].x >= h && (h = o[p].x), o[p].x <= c && (c = o[p].x), o[p].y >= v && (v = o[p].y), o[p].y <= d && (d = o[p].y));
    for (var g = Math.max(h - c, v - d), y = {
      xmid: (h + c) / 2,
      ymid: (v + d) / 2,
      length: g,
      massCenter: u,
      mass: l
    }, b = new ype.default(y), m = new mpe.default(b), p = 0; p < l; p += 1)
      f && i[p] <= 1 || n[p].in(b) && m.insert(n[p]);
    for (var p = 0; p < l; p += 1)
      if (!(f && i[p] <= 1)) {
        n[p].resetForce(), m.updateForce(n[p]), e[2 * p] -= n[p].fx, e[2 * p + 1] -= n[p].fy;
        var x = [o[p].x - u[0], o[p].y - u[1]], _ = Math.hypot(x[0], x[1]);
        _ = _ < 1e-4 ? 1e-4 : _, x[0] = x[0] / _, x[1] = x[1] / _;
        var w = s * (i[p] + 1);
        e[2 * p] -= w * x[0], e[2 * p + 1] -= w * x[1];
      }
    return e;
  }, t.prototype.updatePos = function(e, n, i, a) {
    for (var o = this, s = o.nodes, u = o.ks, f = o.tao, l = o.prune, c = o.ksmax, h = s.length, d = [], v = [], p = 0, g = 0, y = 0; y < h; y += 1)
      if (!(l && a[y] <= 1)) {
        var b = [
          e[2 * y] - n[2 * y],
          e[2 * y + 1] - n[2 * y + 1]
        ], m = Math.hypot(b[0], b[1]), x = [
          e[2 * y] + n[2 * y],
          e[2 * y + 1] + n[2 * y + 1]
        ], _ = Math.hypot(x[0], x[1]);
        d[y] = m, v[y] = _ / 2, p += (a[y] + 1) * d[y], g += (a[y] + 1) * v[y];
      }
    var w = i;
    i = f * g / p, w !== 0 && (i = i > 1.5 * w ? 1.5 * w : i);
    for (var y = 0; y < h; y += 1)
      if (!(l && a[y] <= 1) && !((0, fo.isNumber)(s[y].fx) && (0, fo.isNumber)(s[y].fy))) {
        var E = u * i / (1 + i * Math.sqrt(d[y])), M = Math.hypot(e[2 * y], e[2 * y + 1]);
        M = M < 1e-4 ? 1e-4 : M;
        var C = c / M;
        E = E > C ? C : E;
        var S = E * e[2 * y], A = E * e[2 * y + 1];
        s[y].x += S, s[y].y += A;
      }
    return { nodes: s, sg: i };
  }, t;
}(ppe.Base);
Mh.ForceAtlas2Layout = bpe;
var Ch = {}, r_ = {}, n_ = {}, i_ = {}, Tf = Oe && Oe.__assign || function() {
  return Tf = Object.assign || function(r) {
    for (var t, e = 1, n = arguments.length; e < n; e++) {
      t = arguments[e];
      for (var i in t)
        Object.prototype.hasOwnProperty.call(t, i) && (r[i] = t[i]);
    }
    return r;
  }, Tf.apply(this, arguments);
};
Object.defineProperty(i_, "__esModule", { value: !0 });
var xpe = function() {
  function r() {
    this.cells = [], this.columnNum = 0, this.rowNum = 0, this.additionColumn = [], this.additionRow = [];
  }
  return r.prototype.init = function(t, e, n) {
    this.cells = [], this.CELL_W = n.CELL_W || r.DEFAULT_CELL_W, this.CELL_H = n.CELL_H || r.DEFAULT_CELL_H, this.columnNum = Math.ceil(t / this.CELL_W), this.rowNum = Math.ceil(e / this.CELL_H), r.MIN_DIST = Math.pow(t, 2) + Math.pow(e, 2);
    for (var i = 0; i < this.columnNum; i++) {
      for (var a = [], o = 0; o < this.rowNum; o++) {
        var s = {
          dx: i,
          dy: o,
          x: i * this.CELL_W,
          y: o * this.CELL_H,
          occupied: !1
        };
        a.push(s);
      }
      this.cells.push(a);
    }
  }, r.prototype.findGridByNodeId = function(t) {
    for (var e, n, i = 0; i < this.columnNum; i++)
      for (var a = 0; a < this.rowNum; a++)
        if (this.cells[i][a].node && ((n = (e = this.cells[i][a]) === null || e === void 0 ? void 0 : e.node) === null || n === void 0 ? void 0 : n.id) === t)
          return { column: i, row: a };
    return null;
  }, r.prototype.sqdist = function(t, e) {
    return Math.pow(t.x - e.x, 2) + Math.pow(t.y - e.y, 2);
  }, r.prototype.occupyNearest = function(t) {
    for (var e = r.MIN_DIST, n, i = null, a = 0; a < this.columnNum; a++)
      for (var o = 0; o < this.rowNum; o++)
        !this.cells[a][o].occupied && (n = this.sqdist(t, this.cells[a][o])) < e && (e = n, i = this.cells[a][o]);
    return i && (i.occupied = !0), i;
  }, r.prototype.insertColumn = function(t, e) {
    if (!(e <= 0)) {
      for (var n = 0; n < e; n++) {
        this.cells[n + this.columnNum] = [];
        for (var i = 0; i < this.rowNum; i++)
          this.cells[n + this.columnNum][i] = {
            dx: n,
            dy: i,
            x: n * this.CELL_W,
            y: i * this.CELL_H,
            occupied: !1,
            node: null
          };
      }
      for (var n = this.columnNum - 1; n > t; n--)
        for (var i = 0; i < this.rowNum; i++)
          this.cells[n + e][i] = Tf(Tf({}, this.cells[n][i]), { x: (n + e) * this.CELL_W, y: i * this.CELL_H }), this.cells[n][i] = {
            x: n * this.CELL_W,
            y: i * this.CELL_H,
            occupied: !0,
            node: null
          };
      for (var i = 0; i < this.additionColumn.length; i++)
        this.additionColumn[i] >= t && (this.additionColumn[i] += e);
      for (var n = 0; n < e; n++)
        this.additionColumn.push(t + n + 1);
      this.columnNum += e;
    }
  }, r.prototype.insertRow = function(t, e) {
    if (!(e <= 0)) {
      for (var n = 0; n < e; n++)
        for (var i = 0; i < this.columnNum; i++)
          this.cells[i][n + this.rowNum] = {
            dx: i,
            dy: n,
            x: i * this.CELL_W,
            y: n * this.CELL_H,
            occupied: !1,
            node: null
          };
      for (var i = 0; i < this.columnNum; i++)
        for (var n = this.rowNum - 1; n > t; n--)
          this.cells[i][n + e] = Tf(Tf({}, this.cells[i][n]), { dx: i, dy: n + e, x: i * this.CELL_W, y: (n + e) * this.CELL_H }), this.cells[i][n] = {
            dx: i,
            dy: n,
            x: i * this.CELL_W,
            y: n * this.CELL_H,
            occupied: !1,
            node: null
          };
      for (var n = 0; n < this.additionRow.length; n++)
        this.additionRow[n] >= t && (this.additionRow[n] += e);
      for (var i = 0; i < e; i++)
        this.additionRow.push(t + i + 1);
      this.rowNum += e;
    }
  }, r.prototype.getNodes = function() {
    for (var t = [], e = 0; e < this.columnNum; e++)
      for (var n = 0; n < this.rowNum; n++)
        this.cells[e][n].node && t.push(this.cells[e][n]);
    return t;
  }, r.MIN_DIST = 50, r.DEFAULT_CELL_W = 80, r.DEFAULT_CELL_H = 80, r;
}();
i_.default = xpe;
var _pe = Oe && Oe.__importDefault || function(r) {
  return r && r.__esModule ? r : { default: r };
};
Object.defineProperty(n_, "__esModule", { value: !0 });
var wpe = _pe(i_);
function Epe(r, t) {
  if (!r.nodes || r.nodes.length === 0)
    return r;
  var e = t.width, n = t.height, i = t.nodeMinGap, a = 1e4, o = 1e4;
  r.nodes.forEach(function(b) {
    var m = b.size[0] || 50, x = b.size[1] || 50;
    a = Math.min(m, a), o = Math.min(x, o);
  });
  var s = new wpe.default();
  s.init(e, n, {
    CELL_H: o,
    CELL_W: a
  }), r.nodes.forEach(function(b) {
    var m = s.occupyNearest(b);
    m && (m.node = {
      id: b.id,
      size: b.size
    }, b.x = m.x, b.y = m.y, b.dx = m.dx, b.dy = m.dy);
  });
  for (var u = 0; u < r.nodes.length; u++) {
    var f = r.nodes[u], l = s.findGridByNodeId(f.id);
    if (!l)
      throw new Error("can not find node cell");
    var c = l.column, h = l.row;
    if (f.size[0] + i > a) {
      for (var d = Math.ceil((f.size[0] + i) / a) - 1, v = d, p = 0; p < d; p++) {
        var g = s.additionColumn.indexOf(c + p + 1) > -1;
        if (g && !s.cells[c + p + 1][h].node)
          v--;
        else
          break;
      }
      s.insertColumn(c, v);
    }
    if (f.size[1] + i > o) {
      for (var d = Math.ceil((f.size[1] + i) / o) - 1, v = d, p = 0; p < d; p++) {
        var g = s.additionRow.indexOf(h + p + 1) > -1;
        if (g && !s.cells[c][h + p + 1].node)
          v--;
        else
          break;
      }
      s.insertRow(h, v);
    }
  }
  for (var u = 0; u < s.columnNum; u++)
    for (var y = function(m) {
      var x = s.cells[u][m];
      if (x.node) {
        var _ = r.nodes.find(function(w) {
          var E;
          return w.id === ((E = x == null ? void 0 : x.node) === null || E === void 0 ? void 0 : E.id);
        });
        _ && (_.x = x.x + _.size[0] / 2, _.y = x.y + _.size[1] / 2);
      }
    }, p = 0; p < s.rowNum; p++)
      y(p);
}
n_.default = Epe;
var a_ = {};
Object.defineProperty(a_, "__esModule", { value: !0 });
var $5 = 1200, W5 = 800, rv = 1e7, Kl = 10, V5 = 3.141592653589793, zy = 1.5707963267948966, Spe = V5 * 0.375, Mpe = V5 * 0.625, Dv = /* @__PURE__ */ new Map(), Cpe = 10, Tpe = 10, Uy = 0.8, xO = 0.1, Ape = 0.5;
function Ipe(r, t, e) {
  var n = r.x - r.size[0] / 2, i = r.y - r.size[1] / 2, a = r.x + r.size[0] / 2, o = r.y + r.size[1] / 2, s = t.x - t.size[0] / 2, u = t.y - t.size[1] / 2, f = t.x + t.size[0] / 2, l = t.y + t.size[1] / 2, c = r.x, h = r.y, d = t.x, v = t.y, p = d - c, g = Math.atan2(p, v - h), y = 0, b = 0, m = 0, x = 0;
  g > zy ? (b = i - l, y = s - a, m = parseFloat(b ? (b / Math.cos(g)).toFixed(2) : y.toFixed(2)), x = parseFloat(y ? (y / Math.sin(g)).toFixed(2) : b.toFixed(2))) : 0 < g && g <= zy ? (b = u - o, y = s - a, b > y ? m = x = parseFloat(b ? (b / Math.cos(g)).toFixed(2) : y.toFixed(2)) : m = x = parseFloat(y ? (y / Math.sin(g)).toFixed(2) : b.toFixed(2))) : g < -zy ? (b = i - l, y = -(f - n), b > y ? m = x = parseFloat(b ? (b / Math.cos(g)).toFixed(2) : y.toFixed(2)) : m = x = parseFloat(y ? (y / Math.sin(g)).toFixed(2) : b.toFixed(2))) : (b = u - o, Math.abs(p) > (a - n) / 2 ? y = n - f : y = p, b > y ? m = x = parseFloat(b ? (b / Math.cos(g)).toFixed(2) : y.toFixed(2)) : m = x = parseFloat(y && g !== 0 ? (y / Math.sin(g)).toFixed(2) : b.toFixed(2)));
  var _ = parseFloat(g.toFixed(2)), w = e;
  return e && (w = Spe < _ && _ < Mpe), {
    distance: Math.abs(m < x ? m : x),
    isHoriz: w
  };
}
function X5(r, t) {
  var e = Dv.get(r.id) || [], n = e.find(function(O) {
    return O.source === t.id || O.target === t.id;
  }), i = r.size[0] * r.size[1], a = t.size[0] * t.size[1], o = i > a ? t : r, s = i > a ? r : t, u = o.x - o.size[0] / 2, f = o.y - o.size[1] / 2, l = o.x + o.size[0] / 2, c = o.y + o.size[1] / 2, h = s.x - s.size[0] / 2, d = s.y - s.size[1] / 2, v = s.x + s.size[0] / 2, p = s.y + s.size[1] / 2, g = o.x, y = o.y, b = s.x, m = s.y, x = l >= h && v >= u && c >= d && p >= f, _ = 0, w = 0;
  if (x) {
    w = Math.sqrt(Math.pow(b - g, 2) + Math.pow(m - y, 2));
    var E = u > h ? u : h, M = f > d ? f : d, C = l < v ? l : v, S = c < p ? c : p, A = C - E, T = S - M, P = A * T;
    w === 0 && (w = 1e-7), _ = Kl * 1 / w * 100 + P, _ *= rv;
  } else {
    var k = !1, L = Ipe(o, s, k);
    w = L.distance, k = L.isHoriz, w <= Kl ? w !== 0 ? n ? _ += Kl + rv * 1 / w : _ += Kl + rv * Kl / w : _ += rv : (_ += w, n && (_ += w * w));
  }
  return _;
}
function Y5(r) {
  for (var t = 0, e = 0; e < r.length; e++) {
    var n = r[e];
    (n.x < 0 || n.y < 0 || n.x > $5 || n.y > W5) && (t += 1e12);
    for (var i = e + 1; i < r.length; i++)
      t += X5(n, r[i]);
  }
  return t;
}
function Ppe(r, t, e, n) {
  var i = /* @__PURE__ */ new Map();
  e.forEach(function(g, y) {
    i.set(g.id, g);
  });
  var a = n.filter(function(g) {
    return g.source === r.id || g.target === r.id;
  }) || [], o = [];
  a.forEach(function(g) {
    var y = g.source === r.id ? g.target : g.source, b = i.get(y);
    b && o.push(b);
  });
  for (var s = !0, u = 0; u < o.length; u++) {
    var f = o[u], l = Math.atan((r.y - f.y) / (f.x - r.y)) * 180, c = Math.atan((t.y - f.y) / (f.x - t.y)) * 180, h = l < 30 || l > 150, d = c < 30 || c > 150, v = l > 70 && l < 110, p = c > 70 && c < 110;
    if (h && !d || l * c < 0) {
      s = !1;
      break;
    } else if (v && !p || l * c < 0) {
      s = !1;
      break;
    } else if ((f.x - r.x) * (f.x - t.x) < 0) {
      s = !1;
      break;
    } else if ((f.y - r.y) * (f.y - t.y) < 0) {
      s = !1;
      break;
    }
  }
  return s;
}
function Ope(r, t) {
  for (var e = !1, n = 1, i = Cpe * n, a = Tpe * n, o = [i, -i, 0, 0], s = [0, 0, a, -a], u = 0; u < r.length; ++u)
    for (var f = r[u], l = _O(f, r), c = 0; c < o.length; c++) {
      var h = Ppe(f, { x: f.x + o[c], y: f.y + s[c] }, r, t);
      if (h) {
        f.x += o[c], f.y += s[c];
        var d = _O(f, r), v = Math.random();
        d < l || v < Uy && v > xO ? (l = d, e = !0) : (f.x -= o[c], f.y -= s[c]);
      }
    }
  return Uy > xO && (Uy *= Ape), e ? Y5(r) : 0;
}
function _O(r, t) {
  var e = 0;
  (r.x < 0 || r.y < 0 || r.x + r.size[0] + 20 > $5 || r.y + r.size[1] + 20 > W5) && (e += 1e12);
  for (var n = 0; n < t.length; ++n)
    r.id !== t[n].id && (e += X5(r, t[n]));
  return e;
}
function Dpe(r, t) {
  if (r.length === 0)
    return { nodes: r, edges: t };
  r.forEach(function(f) {
    var l = t.filter(function(c) {
      return c.source === f.id || c.target === f.id;
    });
    Dv.set(f, l);
  }), r.sort(function(f, l) {
    var c, h;
    return ((c = Dv.get(f.id)) === null || c === void 0 ? void 0 : c.length) - ((h = Dv.get(l.id)) === null || h === void 0 ? void 0 : h.length);
  });
  for (var e = Y5(r), n = 20, i = 1, a = 0, o = 50, s = 0; n > 0 && (s++, !(s >= o)); ) {
    var u = Ope(r, t);
    u !== 0 && (a = u), i = a - e, e = a, i === 0 ? --n : n = 20;
  }
  return r.forEach(function(f) {
    f.x = f.x - f.size[0] / 2, f.y = f.y - f.size[1] / 2;
  }), {
    nodes: r,
    edges: t
  };
}
a_.default = Dpe;
var T1 = Oe && Oe.__assign || function() {
  return T1 = Object.assign || function(r) {
    for (var t, e = 1, n = arguments.length; e < n; e++) {
      t = arguments[e];
      for (var i in t)
        Object.prototype.hasOwnProperty.call(t, i) && (r[i] = t[i]);
    }
    return r;
  }, T1.apply(this, arguments);
}, kpe = Oe && Oe.__createBinding || (Object.create ? function(r, t, e, n) {
  n === void 0 && (n = e);
  var i = Object.getOwnPropertyDescriptor(t, e);
  (!i || ("get" in i ? !t.__esModule : i.writable || i.configurable)) && (i = { enumerable: !0, get: function() {
    return t[e];
  } }), Object.defineProperty(r, n, i);
} : function(r, t, e, n) {
  n === void 0 && (n = e), r[n] = t[e];
}), Lpe = Oe && Oe.__setModuleDefault || (Object.create ? function(r, t) {
  Object.defineProperty(r, "default", { enumerable: !0, value: t });
} : function(r, t) {
  r.default = t;
}), Npe = Oe && Oe.__importStar || function(r) {
  if (r && r.__esModule)
    return r;
  var t = {};
  if (r != null)
    for (var e in r)
      e !== "default" && Object.prototype.hasOwnProperty.call(r, e) && kpe(t, r, e);
  return Lpe(t, r), t;
}, H5 = Oe && Oe.__importDefault || function(r) {
  return r && r.__esModule ? r : { default: r };
};
Object.defineProperty(r_, "__esModule", { value: !0 });
var df = Npe(Vb), Rpe = H5(n_), Bpe = H5(a_), Gpe = al;
function Fpe(r, t) {
  var e = r.nodes, n = r.edges, i = t.width, a = t.height;
  if (!(e != null && e.length))
    return Promise.resolve();
  var o = [];
  e.forEach(function(v) {
    var p = n.filter(function(y) {
      return y.source === v.id || y.target === v.id;
    });
    if (p.length > 1) {
      var g = T1({}, v);
      delete g.size, o.push(g);
    }
  });
  var s = [];
  n.forEach(function(v) {
    var p = o.find(function(y) {
      return y.id === v.source;
    }), g = o.find(function(y) {
      return y.id === v.target;
    });
    p && g && s.push(v);
  });
  var u = new Gpe.DagreLayout({
    type: "dagre",
    ranksep: t.nodeMinGap,
    nodesep: t.nodeMinGap
  }), f = u.layout({
    nodes: o,
    edges: s
  }).nodes;
  e.forEach(function(v) {
    var p = (f || []).find(function(g) {
      return g.id === v.id;
    });
    v.x = (p == null ? void 0 : p.x) || i / 2, v.y = (p == null ? void 0 : p.y) || a / 2;
  });
  var l = JSON.parse(JSON.stringify(e)), c = JSON.parse(JSON.stringify(n)), h = df.forceSimulation().nodes(l).force("link", df.forceLink(c).id(function(v) {
    return v.id;
  }).distance(function(v) {
    var p = s.find(function(g) {
      return g.source === v.source && g.target === v.target;
    });
    return p ? 30 : 20;
  })).force("charge", df.forceManyBody()).force("center", df.forceCenter(i / 2, a / 2)).force("x", df.forceX(i / 2)).force("y", df.forceY(a / 2)).alpha(0.3).alphaDecay(0.08).alphaMin(1e-3), d = new Promise(function(v) {
    h.on("end", function() {
      e.forEach(function(_) {
        var w = l.find(function(E) {
          return E.id === _.id;
        });
        w && (_.x = w.x, _.y = w.y);
      });
      var p = Math.min.apply(Math, e.map(function(_) {
        return _.x;
      })), g = Math.max.apply(Math, e.map(function(_) {
        return _.x;
      })), y = Math.min.apply(Math, e.map(function(_) {
        return _.y;
      })), b = Math.max.apply(Math, e.map(function(_) {
        return _.y;
      })), m = i / (g - p), x = a / (b - y);
      e.forEach(function(_) {
        _.x !== void 0 && m < 1 && (_.x = (_.x - p) * m), _.y !== void 0 && x < 1 && (_.y = (_.y - y) * x);
      }), e.forEach(function(_) {
        _.sizeTemp = _.size, _.size = [10, 10];
      }), (0, Bpe.default)(e, n), e.forEach(function(_) {
        _.size = _.sizeTemp || [], delete _.sizeTemp;
      }), (0, Rpe.default)({
        nodes: e,
        edges: n
      }, t), v();
    });
  });
  return d;
}
r_.default = Fpe;
var zpe = Oe && Oe.__extends || function() {
  var r = function(t, e) {
    return r = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function(n, i) {
      n.__proto__ = i;
    } || function(n, i) {
      for (var a in i)
        Object.prototype.hasOwnProperty.call(i, a) && (n[a] = i[a]);
    }, r(t, e);
  };
  return function(t, e) {
    if (typeof e != "function" && e !== null)
      throw new TypeError("Class extends value " + String(e) + " is not a constructor or null");
    r(t, e);
    function n() {
      this.constructor = t;
    }
    t.prototype = e === null ? Object.create(e) : (n.prototype = e.prototype, new n());
  };
}(), Upe = Oe && Oe.__importDefault || function(r) {
  return r && r.__esModule ? r : { default: r };
};
Object.defineProperty(Ch, "__esModule", { value: !0 });
Ch.ERLayout = void 0;
var jpe = an, $pe = Upe(r_), Wpe = function(r) {
  zpe(t, r);
  function t(e) {
    var n = r.call(this) || this;
    return n.width = 300, n.height = 300, n.nodeMinGap = 50, n.onLayoutEnd = function() {
    }, e && n.updateCfg(e), n;
  }
  return t.prototype.getDefaultCfg = function() {
    return {
      width: 300,
      height: 300,
      nodeMinGap: 50
    };
  }, t.prototype.execute = function() {
    var e = this, n = e.nodes, i = e.edges;
    return n == null || n.forEach(function(a) {
      a.size || (a.size = [50, 50]);
    }), (0, $pe.default)({
      nodes: n,
      edges: i
    }, {
      width: this.width,
      height: this.height,
      nodeMinGap: this.nodeMinGap
    }).then(function() {
      e.onLayoutEnd && e.onLayoutEnd();
    });
  }, t.prototype.getType = function() {
    return "er";
  }, t;
}(jpe.Base);
Ch.ERLayout = Wpe;
var Xs = {}, wO;
function Vpe() {
  if (wO)
    return Xs;
  wO = 1, Object.defineProperty(Xs, "__esModule", { value: !0 }), Xs.Layouts = Xs.Layout = void 0;
  var r = So, t = sh, e = uh, n = lh, i = fh, a = Wb, o = ch, s = al, u = Gx, f = mh, l = bh, c = xh, h = _h, d = Eh, v = Sh, p = j5(), g = Mh, y = Ch, b = dh, m = function() {
    function x(_) {
      var w = (0, r.getLayoutByName)(_.type);
      this.layoutInstance = new w(_);
    }
    return x.prototype.layout = function(_) {
      return this.layoutInstance.layout(_);
    }, x.prototype.updateCfg = function(_) {
      this.layoutInstance.updateCfg(_);
    }, x.prototype.init = function(_) {
      this.layoutInstance.init(_);
    }, x.prototype.execute = function() {
      this.layoutInstance.execute();
    }, x.prototype.getDefaultCfg = function() {
      return this.layoutInstance.getDefaultCfg();
    }, x.prototype.destroy = function() {
      return this.layoutInstance.destroy();
    }, x;
  }();
  return Xs.Layout = m, Xs.Layouts = {
    force: a.ForceLayout,
    fruchterman: c.FruchtermanLayout,
    forceAtlas2: g.ForceAtlas2Layout,
    gForce: i.GForceLayout,
    force2: n.Force2Layout,
    dagre: s.DagreLayout,
    dagreCompound: b.DagreCompoundLayout,
    circular: o.CircularLayout,
    radial: u.RadialLayout,
    concentric: f.ConcentricLayout,
    grid: t.GridLayout,
    mds: l.MDSLayout,
    comboForce: v.ComboForceLayout,
    comboCombined: p.ComboCombinedLayout,
    random: e.RandomLayout,
    "gForce-gpu": d.GForceGPULayout,
    "fruchterman-gpu": h.FruchtermanGPULayout,
    er: y.ERLayout
  }, Xs;
}
var K5 = {};
Object.defineProperty(K5, "__esModule", { value: !0 });
var EO;
function q5() {
  return EO || (EO = 1, function(r) {
    var t = Oe && Oe.__createBinding || (Object.create ? function(w, E, M, C) {
      C === void 0 && (C = M);
      var S = Object.getOwnPropertyDescriptor(E, M);
      (!S || ("get" in S ? !E.__esModule : S.writable || S.configurable)) && (S = { enumerable: !0, get: function() {
        return E[M];
      } }), Object.defineProperty(w, C, S);
    } : function(w, E, M, C) {
      C === void 0 && (C = M), w[C] = E[M];
    }), e = Oe && Oe.__exportStar || function(w, E) {
      for (var M in w)
        M !== "default" && !Object.prototype.hasOwnProperty.call(E, M) && t(E, w, M);
    };
    Object.defineProperty(r, "__esModule", { value: !0 }), r.ERLayout = r.ForceAtlas2Layout = r.ComboCombinedLayout = r.ComboForceLayout = r.GForceGPULayout = r.FruchtermanGPULayout = r.FruchtermanLayout = r.MDSLayout = r.ConcentricLayout = r.RadialLayout = r.DagreCompoundLayout = r.DagreLayout = r.CircularLayout = r.ForceLayout = r.Force2Layout = r.GForceLayout = r.RandomLayout = r.GridLayout = r.Layouts = r.Layout = void 0;
    var n = sh;
    Object.defineProperty(r, "GridLayout", { enumerable: !0, get: function() {
      return n.GridLayout;
    } });
    var i = uh;
    Object.defineProperty(r, "RandomLayout", { enumerable: !0, get: function() {
      return i.RandomLayout;
    } });
    var a = fh;
    Object.defineProperty(r, "GForceLayout", { enumerable: !0, get: function() {
      return a.GForceLayout;
    } });
    var o = lh;
    Object.defineProperty(r, "Force2Layout", { enumerable: !0, get: function() {
      return o.Force2Layout;
    } });
    var s = Wb;
    Object.defineProperty(r, "ForceLayout", { enumerable: !0, get: function() {
      return s.ForceLayout;
    } });
    var u = ch;
    Object.defineProperty(r, "CircularLayout", { enumerable: !0, get: function() {
      return u.CircularLayout;
    } });
    var f = al;
    Object.defineProperty(r, "DagreLayout", { enumerable: !0, get: function() {
      return f.DagreLayout;
    } });
    var l = dh;
    Object.defineProperty(r, "DagreCompoundLayout", { enumerable: !0, get: function() {
      return l.DagreCompoundLayout;
    } });
    var c = Gx;
    Object.defineProperty(r, "RadialLayout", { enumerable: !0, get: function() {
      return c.RadialLayout;
    } });
    var h = mh;
    Object.defineProperty(r, "ConcentricLayout", { enumerable: !0, get: function() {
      return h.ConcentricLayout;
    } });
    var d = bh;
    Object.defineProperty(r, "MDSLayout", { enumerable: !0, get: function() {
      return d.MDSLayout;
    } });
    var v = xh;
    Object.defineProperty(r, "FruchtermanLayout", { enumerable: !0, get: function() {
      return v.FruchtermanLayout;
    } });
    var p = _h;
    Object.defineProperty(r, "FruchtermanGPULayout", { enumerable: !0, get: function() {
      return p.FruchtermanGPULayout;
    } });
    var g = Eh;
    Object.defineProperty(r, "GForceGPULayout", { enumerable: !0, get: function() {
      return g.GForceGPULayout;
    } });
    var y = Sh;
    Object.defineProperty(r, "ComboForceLayout", { enumerable: !0, get: function() {
      return y.ComboForceLayout;
    } });
    var b = j5();
    Object.defineProperty(r, "ComboCombinedLayout", { enumerable: !0, get: function() {
      return b.ComboCombinedLayout;
    } });
    var m = Mh;
    Object.defineProperty(r, "ForceAtlas2Layout", { enumerable: !0, get: function() {
      return m.ForceAtlas2Layout;
    } });
    var x = Ch;
    Object.defineProperty(r, "ERLayout", { enumerable: !0, get: function() {
      return x.ERLayout;
    } });
    var _ = Vpe();
    Object.defineProperty(r, "Layout", { enumerable: !0, get: function() {
      return _.Layout;
    } }), Object.defineProperty(r, "Layouts", { enumerable: !0, get: function() {
      return _.Layouts;
    } }), e(K5, r);
  }(ny)), ny;
}
(function(r) {
  var t = Oe && Oe.__createBinding || (Object.create ? function(i, a, o, s) {
    s === void 0 && (s = o);
    var u = Object.getOwnPropertyDescriptor(a, o);
    (!u || ("get" in u ? !a.__esModule : u.writable || u.configurable)) && (u = { enumerable: !0, get: function() {
      return a[o];
    } }), Object.defineProperty(i, s, u);
  } : function(i, a, o, s) {
    s === void 0 && (s = o), i[s] = a[o];
  }), e = Oe && Oe.__exportStar || function(i, a) {
    for (var o in i)
      o !== "default" && !Object.prototype.hasOwnProperty.call(a, o) && t(a, i, o);
  };
  Object.defineProperty(r, "__esModule", { value: !0 }), r.getLayoutByName = r.unRegisterLayout = r.registerLayout = void 0;
  var n = So;
  Object.defineProperty(r, "registerLayout", { enumerable: !0, get: function() {
    return n.registerLayout;
  } }), Object.defineProperty(r, "unRegisterLayout", { enumerable: !0, get: function() {
    return n.unRegisterLayout;
  } }), Object.defineProperty(r, "getLayoutByName", { enumerable: !0, get: function() {
    return n.getLayoutByName;
  } }), e(q5(), r);
})(sr);
var Z5 = { exports: {} };
(function(r, t) {
  (function(n, i) {
    r.exports = i();
  })(typeof self < "u" ? self : Oe, function() {
    return function(e) {
      var n = {};
      function i(a) {
        if (n[a])
          return n[a].exports;
        var o = n[a] = {
          i: a,
          l: !1,
          exports: {}
        };
        return e[a].call(o.exports, o, o.exports, i), o.l = !0, o.exports;
      }
      return i.m = e, i.c = n, i.d = function(a, o, s) {
        i.o(a, o) || Object.defineProperty(a, o, {
          configurable: !1,
          enumerable: !0,
          get: s
        });
      }, i.n = function(a) {
        var o = a && a.__esModule ? function() {
          return a.default;
        } : function() {
          return a;
        };
        return i.d(o, "a", o), o;
      }, i.o = function(a, o) {
        return Object.prototype.hasOwnProperty.call(a, o);
      }, i.p = "", i(i.s = 31);
    }([
      function(e, n, i) {
        var a = i(4);
        n.a = function(o) {
          return Array.isArray ? Array.isArray(o) : Object(a.a)(o, "Array");
        };
      },
      function(e, n, i) {
        var a = function(o) {
          return o !== null && typeof o != "function" && isFinite(o.length);
        };
        n.a = a;
      },
      function(e, n, i) {
        var a = i(0), o = i(13);
        function s(u, f) {
          if (!!u) {
            var l;
            if (Object(a.a)(u))
              for (var c = 0, h = u.length; c < h && (l = f(u[c], c), l !== !1); c++)
                ;
            else if (Object(o.a)(u)) {
              for (var d in u)
                if (u.hasOwnProperty(d) && (l = f(u[d], d), l === !1))
                  break;
            }
          }
        }
        n.a = s;
      },
      function(e, n, i) {
        var a = i(4);
        n.a = function(o) {
          return Object(a.a)(o, "Function");
        };
      },
      function(e, n, i) {
        var a = {}.toString, o = function(s, u) {
          return a.call(s) === "[object " + u + "]";
        };
        n.a = o;
      },
      function(e, n, i) {
        var a = i(4), o = function(s) {
          return Object(a.a)(s, "Number");
        };
        n.a = o;
      },
      function(e, n, i) {
        var a = function(o) {
          return o == null;
        };
        n.a = a;
      },
      function(e, n, i) {
        var a = i(33), o = a.mix;
        e.exports = {
          assign: o
        };
      },
      function(e, n, i) {
        var a = i(4);
        n.a = function(o) {
          return Object(a.a)(o, "String");
        };
      },
      function(e, n, i) {
        var a = i(15), o = i(4), s = function(u) {
          if (!Object(a.a)(u) || !Object(o.a)(u, "Object"))
            return !1;
          if (Object.getPrototypeOf(u) === null)
            return !0;
          for (var f = u; Object.getPrototypeOf(f) !== null; )
            f = Object.getPrototypeOf(f);
          return Object.getPrototypeOf(u) === f;
        };
        n.a = s;
      },
      function(e, n, i) {
        var a = i(6);
        n.a = function(o) {
          return Object(a.a)(o) ? "" : o.toString();
        };
      },
      function(e, n, i) {
        var a = i(18), o = /* @__PURE__ */ function() {
          function s(f, l) {
            l === void 0 && (l = {});
            var c = this;
            c.options = l, c.rootNode = a(f, l);
          }
          var u = s.prototype;
          return u.execute = function() {
            throw new Error("please override this method");
          }, s;
        }();
        e.exports = o;
      },
      function(e, n, i) {
        var a = i(1), o = function(s, u) {
          return Object(a.a)(s) ? s.indexOf(u) > -1 : !1;
        };
        n.a = o;
      },
      function(e, n, i) {
        n.a = function(a) {
          var o = typeof a;
          return a !== null && o === "object" || o === "function";
        };
      },
      function(e, n, i) {
        var a = i(2), o = i(1), s = function(u, f) {
          if (!Object(o.a)(u))
            return u;
          var l = [];
          return Object(a.a)(u, function(c, h) {
            f(c, h) && l.push(c);
          }), l;
        };
        n.a = s;
      },
      function(e, n, i) {
        var a = function(o) {
          return typeof o == "object" && o !== null;
        };
        n.a = a;
      },
      function(e, n, i) {
        n.a = o;
        function a(s, u) {
          for (var f in u)
            u.hasOwnProperty(f) && f !== "constructor" && u[f] !== void 0 && (s[f] = u[f]);
        }
        function o(s, u, f, l) {
          return u && a(s, u), f && a(s, f), l && a(s, l), s;
        }
      },
      function(e, n, i) {
        var a = i(30), o = [
          "LR",
          "RL",
          "TB",
          "BT",
          "H",
          "V"
        ], s = ["LR", "RL", "H"], u = function(c) {
          return s.indexOf(c) > -1;
        }, f = o[0];
        e.exports = function(l, c, h) {
          var d = c.direction || f;
          if (c.isHorizontal = u(d), d && o.indexOf(d) === -1)
            throw new TypeError("Invalid direction: " + d);
          if (d === o[0])
            h(l, c);
          else if (d === o[1])
            h(l, c), l.right2left();
          else if (d === o[2])
            h(l, c);
          else if (d === o[3])
            h(l, c), l.bottom2top();
          else if (d === o[4] || d === o[5]) {
            var v = a(l, c), p = v.left, g = v.right;
            h(p, c), h(g, c), c.isHorizontal ? p.right2left() : p.bottom2top(), g.translate(p.x - g.x, p.y - g.y), l.x = p.x, l.y = g.y;
            var y = l.getBoundingBox();
            c.isHorizontal ? y.top < 0 && l.translate(0, -y.top) : y.left < 0 && l.translate(-y.left, 0);
          }
          var b = c.fixedRoot;
          return b === void 0 && (b = !0), b && l.translate(-(l.x + l.width / 2 + l.hgap), -(l.y + l.height / 2 + l.vgap)), l;
        };
      },
      function(e, n, i) {
        var a = i(7), o = 18, s = o * 2, u = o, f = {
          getId: function(d) {
            return d.id || d.name;
          },
          getPreH: function(d) {
            return d.preH || 0;
          },
          getPreV: function(d) {
            return d.preV || 0;
          },
          getHGap: function(d) {
            return d.hgap || u;
          },
          getVGap: function(d) {
            return d.vgap || u;
          },
          getChildren: function(d) {
            return d.children;
          },
          getHeight: function(d) {
            return d.height || s;
          },
          getWidth: function(d) {
            var v = d.label || " ";
            return d.width || v.split("").length * o;
          }
        };
        function l(h, d) {
          var v = this;
          if (v.vgap = v.hgap = 0, h instanceof l)
            return h;
          v.data = h;
          var p = d.getHGap(h), g = d.getVGap(h);
          return v.preH = d.getPreH(h), v.preV = d.getPreV(h), v.width = d.getWidth(h), v.height = d.getHeight(h), v.width += v.preH, v.height += v.preV, v.id = d.getId(h), v.x = v.y = 0, v.depth = 0, v.children || (v.children = []), v.addGap(p, g), v;
        }
        a.assign(l.prototype, {
          isRoot: function() {
            return this.depth === 0;
          },
          isLeaf: function() {
            return this.children.length === 0;
          },
          addGap: function(d, v) {
            var p = this;
            p.hgap += d, p.vgap += v, p.width += 2 * d, p.height += 2 * v;
          },
          eachNode: function(d) {
            for (var v = this, p = [v], g; g = p.shift(); )
              d(g), p = g.children.concat(p);
          },
          DFTraverse: function(d) {
            this.eachNode(d);
          },
          BFTraverse: function(d) {
            for (var v = this, p = [v], g; g = p.shift(); )
              d(g), p = p.concat(g.children);
          },
          getBoundingBox: function() {
            var d = {
              left: Number.MAX_VALUE,
              top: Number.MAX_VALUE,
              width: 0,
              height: 0
            };
            return this.eachNode(function(v) {
              d.left = Math.min(d.left, v.x), d.top = Math.min(d.top, v.y), d.width = Math.max(d.width, v.x + v.width), d.height = Math.max(d.height, v.y + v.height);
            }), d;
          },
          translate: function(d, v) {
            d === void 0 && (d = 0), v === void 0 && (v = 0), this.eachNode(function(p) {
              p.x += d, p.y += v, p.x += p.preH, p.y += p.preV;
            });
          },
          right2left: function() {
            var d = this, v = d.getBoundingBox();
            d.eachNode(function(p) {
              p.x = p.x - (p.x - v.left) * 2 - p.width;
            }), d.translate(v.width, 0);
          },
          bottom2top: function() {
            var d = this, v = d.getBoundingBox();
            d.eachNode(function(p) {
              p.y = p.y - (p.y - v.top) * 2 - p.height;
            }), d.translate(0, v.height);
          }
        });
        function c(h, d, v) {
          d === void 0 && (d = {}), d = a.assign({}, f, d);
          var p = new l(h, d), g = [p], y;
          if (!v && !h.collapsed) {
            for (; y = g.shift(); )
              if (!y.data.collapsed) {
                var b = d.getChildren(y.data), m = b ? b.length : 0;
                if (y.children = new Array(m), b && m)
                  for (var x = 0; x < m; x++) {
                    var _ = new l(b[x], d);
                    y.children[x] = _, g.push(_), _.parent = y, _.depth = y.depth + 1;
                  }
              }
          }
          return p;
        }
        e.exports = c;
      },
      function(e, n, i) {
        var a = i(6), o = i(20);
        function s(u, f) {
          var l = Object(o.a)(f), c = l.length;
          if (Object(a.a)(u))
            return !c;
          for (var h = 0; h < c; h += 1) {
            var d = l[h];
            if (f[d] !== u[d] || !(d in u))
              return !1;
          }
          return !0;
        }
        n.a = s;
      },
      function(e, n, i) {
        var a = i(2), o = i(3), s = Object.keys ? function(u) {
          return Object.keys(u);
        } : function(u) {
          var f = [];
          return Object(a.a)(u, function(l, c) {
            Object(o.a)(u) && c === "prototype" || f.push(c);
          }), f;
        };
        n.a = s;
      },
      function(e, n, i) {
        var a = i(1), o = Array.prototype.splice, s = function(f, l) {
          if (!Object(a.a)(f))
            return [];
          for (var c = f ? l.length : 0, h = c - 1; c--; ) {
            var d = void 0, v = l[c];
            (c === h || v !== d) && (d = v, o.call(f, v, 1));
          }
          return f;
        };
        n.a = s;
      },
      function(e, n, i) {
        var a = i(12), o = i(2), s = function(u) {
          var f = [];
          return Object(o.a)(u, function(l) {
            Object(a.a)(f, l) || f.push(l);
          }), f;
        };
        n.a = s;
      },
      function(e, n, i) {
        var a = i(0), o = i(3), s = i(24), u = function(f, l) {
          if (!l)
            return {
              0: f
            };
          if (!Object(o.a)(l)) {
            var c = Object(a.a)(l) ? l : l.replace(/\s+/g, "").split("*");
            l = function(d) {
              for (var v = "_", p = 0, g = c.length; p < g; p++)
                v += d[c[p]] && d[c[p]].toString();
              return v;
            };
          }
          var h = Object(s.a)(f, l);
          return h;
        };
        n.a = u;
      },
      function(e, n, i) {
        var a = i(2), o = i(0), s = i(3), u = Object.prototype.hasOwnProperty;
        function f(l, c) {
          if (!c || !Object(o.a)(l))
            return {};
          var h = {}, d = Object(s.a)(c) ? c : function(p) {
            return p[c];
          }, v;
          return Object(a.a)(l, function(p) {
            v = d(p), u.call(h, v) ? h[v].push(p) : h[v] = [p];
          }), h;
        }
        n.a = f;
      },
      function(e, n, i) {
        n.a = function(a, o) {
          return a.hasOwnProperty(o);
        };
      },
      function(e, n, i) {
        var a = i(2), o = i(3), s = Object.values ? function(u) {
          return Object.values(u);
        } : function(u) {
          var f = [];
          return Object(a.a)(u, function(l, c) {
            Object(o.a)(u) && c === "prototype" || f.push(l);
          }), f;
        };
        n.a = s;
      },
      function(e, n, i) {
        var a = {}.toString, o = function(s) {
          return a.call(s).replace(/^\[object /, "").replace(/]$/, "");
        };
        n.a = o;
      },
      function(e, n, i) {
        var a = Object.prototype, o = function(s) {
          var u = s && s.constructor, f = typeof u == "function" && u.prototype || a;
          return s === f;
        };
        n.a = o;
      },
      function(e, n, i) {
        var a = i(15), o = i(1), s = i(8), u = function(f, l) {
          if (f === l)
            return !0;
          if (!f || !l || Object(s.a)(f) || Object(s.a)(l))
            return !1;
          if (Object(o.a)(f) || Object(o.a)(l)) {
            if (f.length !== l.length)
              return !1;
            for (var c = !0, h = 0; h < f.length && (c = u(f[h], l[h]), !!c); h++)
              ;
            return c;
          }
          if (Object(a.a)(f) || Object(a.a)(l)) {
            var d = Object.keys(f), v = Object.keys(l);
            if (d.length !== v.length)
              return !1;
            for (var c = !0, h = 0; h < d.length && (c = u(f[d[h]], l[d[h]]), !!c); h++)
              ;
            return c;
          }
          return !1;
        };
        n.a = u;
      },
      function(e, n, i) {
        var a = i(18);
        e.exports = function(o, s) {
          for (var u = a(o.data, s, !0), f = a(o.data, s, !0), l = o.children.length, c = Math.round(l / 2), h = s.getSide || function(g, y) {
            return y < c ? "right" : "left";
          }, d = 0; d < l; d++) {
            var v = o.children[d], p = h(v, d);
            p === "right" ? f.children.push(v) : u.children.push(v);
          }
          return u.eachNode(function(g) {
            g.isRoot() || (g.side = "left");
          }), f.eachNode(function(g) {
            g.isRoot() || (g.side = "right");
          }), {
            left: u,
            right: f
          };
        };
      },
      function(e, n, i) {
        var a = {
          compactBox: i(32),
          dendrogram: i(114),
          indented: i(116),
          mindmap: i(118)
        };
        e.exports = a;
      },
      function(e, n, i) {
        function a(d, v) {
          d.prototype = Object.create(v.prototype), d.prototype.constructor = d, d.__proto__ = v;
        }
        var o = i(11), s = i(113), u = i(17), f = i(7), l = /* @__PURE__ */ function(d) {
          a(v, d);
          function v() {
            return d.apply(this, arguments) || this;
          }
          var p = v.prototype;
          return p.execute = function() {
            var y = this;
            return u(y.rootNode, y.options, s);
          }, v;
        }(o), c = {};
        function h(d, v) {
          return v = f.assign({}, c, v), new l(d, v).execute();
        }
        e.exports = h;
      },
      function(e, n, i) {
        Object.defineProperty(n, "__esModule", { value: !0 });
        var a = i(12);
        i.d(n, "contains", function() {
          return a.a;
        }), i.d(n, "includes", function() {
          return a.a;
        });
        var o = i(34);
        i.d(n, "difference", function() {
          return o.a;
        });
        var s = i(35);
        i.d(n, "find", function() {
          return s.a;
        });
        var u = i(36);
        i.d(n, "findIndex", function() {
          return u.a;
        });
        var f = i(37);
        i.d(n, "firstValue", function() {
          return f.a;
        });
        var l = i(38);
        i.d(n, "flatten", function() {
          return l.a;
        });
        var c = i(39);
        i.d(n, "flattenDeep", function() {
          return c.a;
        });
        var h = i(40);
        i.d(n, "getRange", function() {
          return h.a;
        });
        var d = i(41);
        i.d(n, "pull", function() {
          return d.a;
        });
        var v = i(21);
        i.d(n, "pullAt", function() {
          return v.a;
        });
        var p = i(42);
        i.d(n, "reduce", function() {
          return p.a;
        });
        var g = i(43);
        i.d(n, "remove", function() {
          return g.a;
        });
        var y = i(44);
        i.d(n, "sortBy", function() {
          return y.a;
        });
        var b = i(45);
        i.d(n, "union", function() {
          return b.a;
        });
        var m = i(22);
        i.d(n, "uniq", function() {
          return m.a;
        });
        var x = i(46);
        i.d(n, "valuesOfKey", function() {
          return x.a;
        });
        var _ = i(47);
        i.d(n, "head", function() {
          return _.a;
        });
        var w = i(48);
        i.d(n, "last", function() {
          return w.a;
        });
        var E = i(49);
        i.d(n, "startsWith", function() {
          return E.a;
        });
        var M = i(50);
        i.d(n, "endsWith", function() {
          return M.a;
        });
        var C = i(14);
        i.d(n, "filter", function() {
          return C.a;
        });
        var S = i(51);
        i.d(n, "every", function() {
          return S.a;
        });
        var A = i(52);
        i.d(n, "some", function() {
          return A.a;
        });
        var T = i(53);
        i.d(n, "group", function() {
          return T.a;
        });
        var P = i(24);
        i.d(n, "groupBy", function() {
          return P.a;
        });
        var k = i(23);
        i.d(n, "groupToMap", function() {
          return k.a;
        });
        var L = i(54);
        i.d(n, "getWrapBehavior", function() {
          return L.a;
        });
        var O = i(55);
        i.d(n, "wrapBehavior", function() {
          return O.a;
        });
        var D = i(56);
        i.d(n, "number2color", function() {
          return D.a;
        });
        var G = i(57);
        i.d(n, "parseRadius", function() {
          return G.a;
        });
        var R = i(58);
        i.d(n, "clamp", function() {
          return R.a;
        });
        var F = i(59);
        i.d(n, "fixedBase", function() {
          return F.a;
        });
        var q = i(60);
        i.d(n, "isDecimal", function() {
          return q.a;
        });
        var ne = i(61);
        i.d(n, "isEven", function() {
          return ne.a;
        });
        var oe = i(62);
        i.d(n, "isInteger", function() {
          return oe.a;
        });
        var ie = i(63);
        i.d(n, "isNegative", function() {
          return ie.a;
        });
        var Ee = i(64);
        i.d(n, "isNumberEqual", function() {
          return Ee.a;
        });
        var Xe = i(65);
        i.d(n, "isOdd", function() {
          return Xe.a;
        });
        var le = i(66);
        i.d(n, "isPositive", function() {
          return le.a;
        });
        var Me = i(67);
        i.d(n, "maxBy", function() {
          return Me.a;
        });
        var $e = i(68);
        i.d(n, "minBy", function() {
          return $e.a;
        });
        var et = i(69);
        i.d(n, "mod", function() {
          return et.a;
        });
        var ft = i(70);
        i.d(n, "toDegree", function() {
          return ft.a;
        });
        var pt = i(71);
        i.d(n, "toInteger", function() {
          return pt.a;
        });
        var $ = i(72);
        i.d(n, "toRadian", function() {
          return $.a;
        });
        var te = i(73);
        i.d(n, "forIn", function() {
          return te.a;
        });
        var X = i(25);
        i.d(n, "has", function() {
          return X.a;
        });
        var De = i(74);
        i.d(n, "hasKey", function() {
          return De.a;
        });
        var Ke = i(75);
        i.d(n, "hasValue", function() {
          return Ke.a;
        });
        var Fe = i(20);
        i.d(n, "keys", function() {
          return Fe.a;
        });
        var _t = i(19);
        i.d(n, "isMatch", function() {
          return _t.a;
        });
        var Kt = i(26);
        i.d(n, "values", function() {
          return Kt.a;
        });
        var Ye = i(76);
        i.d(n, "lowerCase", function() {
          return Ye.a;
        });
        var vt = i(77);
        i.d(n, "lowerFirst", function() {
          return vt.a;
        });
        var N = i(78);
        i.d(n, "substitute", function() {
          return N.a;
        });
        var Z = i(79);
        i.d(n, "upperCase", function() {
          return Z.a;
        });
        var pe = i(80);
        i.d(n, "upperFirst", function() {
          return pe.a;
        });
        var se = i(27);
        i.d(n, "getType", function() {
          return se.a;
        });
        var Ce = i(81);
        i.d(n, "isArguments", function() {
          return Ce.a;
        });
        var ke = i(0);
        i.d(n, "isArray", function() {
          return ke.a;
        });
        var at = i(1);
        i.d(n, "isArrayLike", function() {
          return at.a;
        });
        var je = i(82);
        i.d(n, "isBoolean", function() {
          return je.a;
        });
        var lt = i(83);
        i.d(n, "isDate", function() {
          return lt.a;
        });
        var ct = i(84);
        i.d(n, "isError", function() {
          return ct.a;
        });
        var Ot = i(3);
        i.d(n, "isFunction", function() {
          return Ot.a;
        });
        var mt = i(85);
        i.d(n, "isFinite", function() {
          return mt.a;
        });
        var pr = i(6);
        i.d(n, "isNil", function() {
          return pr.a;
        });
        var _r = i(86);
        i.d(n, "isNull", function() {
          return _r.a;
        });
        var jr = i(5);
        i.d(n, "isNumber", function() {
          return jr.a;
        });
        var Cr = i(13);
        i.d(n, "isObject", function() {
          return Cr.a;
        });
        var mn = i(15);
        i.d(n, "isObjectLike", function() {
          return mn.a;
        });
        var hr = i(9);
        i.d(n, "isPlainObject", function() {
          return hr.a;
        });
        var Vr = i(28);
        i.d(n, "isPrototype", function() {
          return Vr.a;
        });
        var di = i(87);
        i.d(n, "isRegExp", function() {
          return di.a;
        });
        var Zr = i(8);
        i.d(n, "isString", function() {
          return Zr.a;
        });
        var fa = i(4);
        i.d(n, "isType", function() {
          return fa.a;
        });
        var Es = i(88);
        i.d(n, "isUndefined", function() {
          return Es.a;
        });
        var Ss = i(89);
        i.d(n, "isElement", function() {
          return Ss.a;
        });
        var dn = i(90);
        i.d(n, "requestAnimationFrame", function() {
          return dn.a;
        });
        var Vi = i(91);
        i.d(n, "clearAnimationFrame", function() {
          return Vi.a;
        });
        var Ha = i(92);
        i.d(n, "augment", function() {
          return Ha.a;
        });
        var Ms = i(93);
        i.d(n, "clone", function() {
          return Ms.a;
        });
        var Cs = i(94);
        i.d(n, "debounce", function() {
          return Cs.a;
        });
        var Ts = i(95);
        i.d(n, "memoize", function() {
          return Ts.a;
        });
        var vi = i(96);
        i.d(n, "deepMix", function() {
          return vi.a;
        });
        var Xr = i(2);
        i.d(n, "each", function() {
          return Xr.a;
        });
        var pi = i(97);
        i.d(n, "extend", function() {
          return pi.a;
        });
        var $t = i(98);
        i.d(n, "indexOf", function() {
          return $t.a;
        });
        var Ar = i(99);
        i.d(n, "isEmpty", function() {
          return Ar.a;
        });
        var Lt = i(29);
        i.d(n, "isEqual", function() {
          return Lt.a;
        });
        var Rr = i(100);
        i.d(n, "isEqualWith", function() {
          return Rr.a;
        });
        var bn = i(101);
        i.d(n, "map", function() {
          return bn.a;
        });
        var Ka = i(102);
        i.d(n, "mapValues", function() {
          return Ka.a;
        });
        var la = i(16);
        i.d(n, "mix", function() {
          return la.a;
        }), i.d(n, "assign", function() {
          return la.a;
        });
        var Xi = i(103);
        i.d(n, "get", function() {
          return Xi.a;
        });
        var qa = i(104);
        i.d(n, "set", function() {
          return qa.a;
        });
        var Za = i(105);
        i.d(n, "pick", function() {
          return Za.a;
        });
        var Qa = i(106);
        i.d(n, "throttle", function() {
          return Qa.a;
        });
        var Mg = i(107);
        i.d(n, "toArray", function() {
          return Mg.a;
        });
        var Cg = i(10);
        i.d(n, "toString", function() {
          return Cg.a;
        });
        var Tg = i(108);
        i.d(n, "uniqueId", function() {
          return Tg.a;
        });
        var Ag = i(109);
        i.d(n, "noop", function() {
          return Ag.a;
        });
        var Ig = i(110);
        i.d(n, "identity", function() {
          return Ig.a;
        });
        var Pg = i(111);
        i.d(n, "size", function() {
          return Pg.a;
        });
        var Og = i(112);
        i.d(n, "Cache", function() {
          return Og.a;
        });
      },
      function(e, n, i) {
        var a = i(14), o = i(12), s = function(u, f) {
          return f === void 0 && (f = []), Object(a.a)(u, function(l) {
            return !Object(o.a)(f, l);
          });
        };
        n.a = s;
      },
      function(e, n, i) {
        var a = i(3), o = i(19), s = i(0), u = i(9);
        function f(l, c) {
          if (!Object(s.a)(l))
            return null;
          var h;
          if (Object(a.a)(c) && (h = c), Object(u.a)(c) && (h = function(v) {
            return Object(o.a)(v, c);
          }), h) {
            for (var d = 0; d < l.length; d += 1)
              if (h(l[d]))
                return l[d];
          }
          return null;
        }
        n.a = f;
      },
      function(e, n, i) {
        function a(o, s, u) {
          u === void 0 && (u = 0);
          for (var f = u; f < o.length; f++)
            if (s(o[f], f))
              return f;
          return -1;
        }
        n.a = a;
      },
      function(e, n, i) {
        var a = i(6), o = i(0), s = function(u, f) {
          for (var l = null, c = 0; c < u.length; c++) {
            var h = u[c], d = h[f];
            if (!Object(a.a)(d)) {
              Object(o.a)(d) ? l = d[0] : l = d;
              break;
            }
          }
          return l;
        };
        n.a = s;
      },
      function(e, n, i) {
        var a = i(0), o = function(s) {
          if (!Object(a.a)(s))
            return [];
          for (var u = [], f = 0; f < s.length; f++)
            u = u.concat(s[f]);
          return u;
        };
        n.a = o;
      },
      function(e, n, i) {
        var a = i(0), o = function(s, u) {
          if (u === void 0 && (u = []), !Object(a.a)(s))
            u.push(s);
          else
            for (var f = 0; f < s.length; f += 1)
              o(s[f], u);
          return u;
        };
        n.a = o;
      },
      function(e, n, i) {
        var a = i(0), o = i(14), s = function(u) {
          if (u = Object(o.a)(u, function(d) {
            return !isNaN(d);
          }), !u.length)
            return {
              min: 0,
              max: 0
            };
          if (Object(a.a)(u[0])) {
            for (var f = [], l = 0; l < u.length; l++)
              f = f.concat(u[l]);
            u = f;
          }
          var c = Math.max.apply(null, u), h = Math.min.apply(null, u);
          return {
            min: h,
            max: c
          };
        };
        n.a = s;
      },
      function(e, n, i) {
        var a = Array.prototype, o = a.splice, s = a.indexOf, u = function(f) {
          for (var l = [], c = 1; c < arguments.length; c++)
            l[c - 1] = arguments[c];
          for (var h = 0; h < l.length; h++)
            for (var d = l[h], v = -1; (v = s.call(f, d)) > -1; )
              o.call(f, v, 1);
          return f;
        };
        n.a = u;
      },
      function(e, n, i) {
        var a = i(2), o = i(0), s = i(9), u = function(f, l, c) {
          if (!Object(o.a)(f) && !Object(s.a)(f))
            return f;
          var h = c;
          return Object(a.a)(f, function(d, v) {
            h = l(h, d, v);
          }), h;
        };
        n.a = u;
      },
      function(e, n, i) {
        var a = i(1), o = i(21), s = function(u, f) {
          var l = [];
          if (!Object(a.a)(u))
            return l;
          for (var c = -1, h = [], d = u.length; ++c < d; ) {
            var v = u[c];
            f(v, c, u) && (l.push(v), h.push(c));
          }
          return Object(o.a)(u, h), l;
        };
        n.a = s;
      },
      function(e, n, i) {
        var a = i(0), o = i(8), s = i(3);
        function u(f, l) {
          var c;
          if (Object(s.a)(l))
            c = function(d, v) {
              return l(d) - l(v);
            };
          else {
            var h = [];
            Object(o.a)(l) ? h.push(l) : Object(a.a)(l) && (h = l), c = function(d, v) {
              for (var p = 0; p < h.length; p += 1) {
                var g = h[p];
                if (d[g] > v[g])
                  return 1;
                if (d[g] < v[g])
                  return -1;
              }
              return 0;
            };
          }
          return f.sort(c), f;
        }
        n.a = u;
      },
      function(e, n, i) {
        var a = i(22), o = function() {
          for (var s = [], u = 0; u < arguments.length; u++)
            s[u] = arguments[u];
          return Object(a.a)([].concat.apply([], s));
        };
        n.a = o;
      },
      function(e, n, i) {
        var a = i(2), o = i(0), s = i(6);
        n.a = function(u, f) {
          var l = [], c = {};
          return u.forEach(function(h) {
            var d = h[f];
            Object(s.a)(d) || (Object(o.a)(d) || (d = [d]), Object(a.a)(d, function(v) {
              c[v] || (l.push(v), c[v] = !0);
            }));
          }), l;
        };
      },
      function(e, n, i) {
        n.a = o;
        var a = i(1);
        function o(s) {
          if (Object(a.a)(s))
            return s[0];
        }
      },
      function(e, n, i) {
        n.a = o;
        var a = i(1);
        function o(s) {
          if (Object(a.a)(s)) {
            var u = s;
            return u[u.length - 1];
          }
        }
      },
      function(e, n, i) {
        var a = i(0), o = i(8);
        function s(u, f) {
          return Object(a.a)(u) || Object(o.a)(u) ? u[0] === f : !1;
        }
        n.a = s;
      },
      function(e, n, i) {
        var a = i(0), o = i(8);
        function s(u, f) {
          return Object(a.a)(u) || Object(o.a)(u) ? u[u.length - 1] === f : !1;
        }
        n.a = s;
      },
      function(e, n, i) {
        var a = function(o, s) {
          for (var u = 0; u < o.length; u++)
            if (!s(o[u], u))
              return !1;
          return !0;
        };
        n.a = a;
      },
      function(e, n, i) {
        var a = function(o, s) {
          for (var u = 0; u < o.length; u++)
            if (s(o[u], u))
              return !0;
          return !1;
        };
        n.a = a;
      },
      function(e, n, i) {
        var a = i(23);
        n.a = function(o, s) {
          if (!s)
            return [o];
          var u = Object(a.a)(o, s), f = [];
          for (var l in u)
            f.push(u[l]);
          return f;
        };
      },
      function(e, n, i) {
        function a(o, s) {
          return o["_wrap_" + s];
        }
        n.a = a;
      },
      function(e, n, i) {
        function a(o, s) {
          if (o["_wrap_" + s])
            return o["_wrap_" + s];
          var u = function(f) {
            o[s](f);
          };
          return o["_wrap_" + s] = u, u;
        }
        n.a = a;
      },
      function(e, n, i) {
        var a = {};
        function o(s) {
          var u = a[s];
          if (!u) {
            for (var f = s.toString(16), l = f.length; l < 6; l++)
              f = "0" + f;
            u = "#" + f, a[s] = u;
          }
          return u;
        }
        n.a = o;
      },
      function(e, n, i) {
        var a = i(0);
        function o(s) {
          var u = 0, f = 0, l = 0, c = 0;
          return Object(a.a)(s) ? s.length === 1 ? u = f = l = c = s[0] : s.length === 2 ? (u = l = s[0], f = c = s[1]) : s.length === 3 ? (u = s[0], f = c = s[1], l = s[2]) : (u = s[0], f = s[1], l = s[2], c = s[3]) : u = f = l = c = s, {
            r1: u,
            r2: f,
            r3: l,
            r4: c
          };
        }
        n.a = o;
      },
      function(e, n, i) {
        var a = function(o, s, u) {
          return o < s ? s : o > u ? u : o;
        };
        n.a = a;
      },
      function(e, n, i) {
        var a = function(o, s) {
          var u = s.toString(), f = u.indexOf(".");
          if (f === -1)
            return Math.round(o);
          var l = u.substr(f + 1).length;
          return l > 20 && (l = 20), parseFloat(o.toFixed(l));
        };
        n.a = a;
      },
      function(e, n, i) {
        var a = i(5), o = function(s) {
          return Object(a.a)(s) && s % 1 !== 0;
        };
        n.a = o;
      },
      function(e, n, i) {
        var a = i(5), o = function(s) {
          return Object(a.a)(s) && s % 2 === 0;
        };
        n.a = o;
      },
      function(e, n, i) {
        var a = i(5), o = Number.isInteger ? Number.isInteger : function(s) {
          return Object(a.a)(s) && s % 1 === 0;
        };
        n.a = o;
      },
      function(e, n, i) {
        var a = i(5), o = function(s) {
          return Object(a.a)(s) && s < 0;
        };
        n.a = o;
      },
      function(e, n, i) {
        n.a = o;
        var a = 1e-5;
        function o(s, u, f) {
          return f === void 0 && (f = a), Math.abs(s - u) < f;
        }
      },
      function(e, n, i) {
        var a = i(5), o = function(s) {
          return Object(a.a)(s) && s % 2 !== 0;
        };
        n.a = o;
      },
      function(e, n, i) {
        var a = i(5), o = function(s) {
          return Object(a.a)(s) && s > 0;
        };
        n.a = o;
      },
      function(e, n, i) {
        var a = i(2), o = i(0), s = i(3);
        n.a = function(u, f) {
          if (!!Object(o.a)(u)) {
            var l = u[0], c;
            Object(s.a)(f) ? c = f(u[0]) : c = u[0][f];
            var h;
            return Object(a.a)(u, function(d) {
              Object(s.a)(f) ? h = f(d) : h = d[f], h > c && (l = d, c = h);
            }), l;
          }
        };
      },
      function(e, n, i) {
        var a = i(2), o = i(0), s = i(3);
        n.a = function(u, f) {
          if (!!Object(o.a)(u)) {
            var l = u[0], c;
            Object(s.a)(f) ? c = f(u[0]) : c = u[0][f];
            var h;
            return Object(a.a)(u, function(d) {
              Object(s.a)(f) ? h = f(d) : h = d[f], h < c && (l = d, c = h);
            }), l;
          }
        };
      },
      function(e, n, i) {
        var a = function(o, s) {
          return (o % s + s) % s;
        };
        n.a = a;
      },
      function(e, n, i) {
        var a = 180 / Math.PI, o = function(s) {
          return a * s;
        };
        n.a = o;
      },
      function(e, n, i) {
        n.a = parseInt;
      },
      function(e, n, i) {
        var a = Math.PI / 180, o = function(s) {
          return a * s;
        };
        n.a = o;
      },
      function(e, n, i) {
        var a = i(2);
        n.a = a.a;
      },
      function(e, n, i) {
        var a = i(25);
        n.a = a.a;
      },
      function(e, n, i) {
        var a = i(12), o = i(26);
        n.a = function(s, u) {
          return Object(a.a)(Object(o.a)(s), u);
        };
      },
      function(e, n, i) {
        var a = i(10), o = function(s) {
          return Object(a.a)(s).toLowerCase();
        };
        n.a = o;
      },
      function(e, n, i) {
        var a = i(10), o = function(s) {
          var u = Object(a.a)(s);
          return u.charAt(0).toLowerCase() + u.substring(1);
        };
        n.a = o;
      },
      function(e, n, i) {
        function a(o, s) {
          return !o || !s ? o : o.replace(/\\?\{([^{}]+)\}/g, function(u, f) {
            return u.charAt(0) === "\\" ? u.slice(1) : s[f] === void 0 ? "" : s[f];
          });
        }
        n.a = a;
      },
      function(e, n, i) {
        var a = i(10), o = function(s) {
          return Object(a.a)(s).toUpperCase();
        };
        n.a = o;
      },
      function(e, n, i) {
        var a = i(10), o = function(s) {
          var u = Object(a.a)(s);
          return u.charAt(0).toUpperCase() + u.substring(1);
        };
        n.a = o;
      },
      function(e, n, i) {
        var a = i(4), o = function(s) {
          return Object(a.a)(s, "Arguments");
        };
        n.a = o;
      },
      function(e, n, i) {
        var a = i(4), o = function(s) {
          return Object(a.a)(s, "Boolean");
        };
        n.a = o;
      },
      function(e, n, i) {
        var a = i(4), o = function(s) {
          return Object(a.a)(s, "Date");
        };
        n.a = o;
      },
      function(e, n, i) {
        var a = i(4), o = function(s) {
          return Object(a.a)(s, "Error");
        };
        n.a = o;
      },
      function(e, n, i) {
        var a = i(5);
        n.a = function(o) {
          return Object(a.a)(o) && isFinite(o);
        };
      },
      function(e, n, i) {
        var a = function(o) {
          return o === null;
        };
        n.a = a;
      },
      function(e, n, i) {
        var a = i(4), o = function(s) {
          return Object(a.a)(s, "RegExp");
        };
        n.a = o;
      },
      function(e, n, i) {
        var a = function(o) {
          return o === void 0;
        };
        n.a = a;
      },
      function(e, n, i) {
        var a = function(o) {
          return o instanceof Element || o instanceof HTMLDocument;
        };
        n.a = a;
      },
      function(e, n, i) {
        n.a = a;
        function a(o) {
          var s = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.msRequestAnimationFrame || function(u) {
            return setTimeout(u, 16);
          };
          return s(o);
        }
      },
      function(e, n, i) {
        n.a = a;
        function a(o) {
          var s = window.cancelAnimationFrame || window.webkitCancelAnimationFrame || window.mozCancelAnimationFrame || window.msCancelAnimationFrame || clearTimeout;
          s(o);
        }
      },
      function(e, n, i) {
        var a = i(16), o = i(3), s = function() {
          for (var u = [], f = 0; f < arguments.length; f++)
            u[f] = arguments[f];
          for (var l = u[0], c = 1; c < u.length; c++) {
            var h = u[c];
            Object(o.a)(h) && (h = h.prototype), Object(a.a)(l.prototype, h);
          }
        };
        n.a = s;
      },
      function(e, n, i) {
        var a = i(0), o = function(s) {
          if (typeof s != "object" || s === null)
            return s;
          var u;
          if (Object(a.a)(s)) {
            u = [];
            for (var f = 0, l = s.length; f < l; f++)
              typeof s[f] == "object" && s[f] != null ? u[f] = o(s[f]) : u[f] = s[f];
          } else {
            u = {};
            for (var c in s)
              typeof s[c] == "object" && s[c] != null ? u[c] = o(s[c]) : u[c] = s[c];
          }
          return u;
        };
        n.a = o;
      },
      function(e, n, i) {
        function a(o, s, u) {
          var f;
          return function() {
            var l = this, c = arguments, h = function() {
              f = null, u || o.apply(l, c);
            }, d = u && !f;
            clearTimeout(f), f = setTimeout(h, s), d && o.apply(l, c);
          };
        }
        n.a = a;
      },
      function(e, n, i) {
        var a = i(3);
        n.a = function(o, s) {
          if (!Object(a.a)(o))
            throw new TypeError("Expected a function");
          var u = function() {
            for (var f = [], l = 0; l < arguments.length; l++)
              f[l] = arguments[l];
            var c = s ? s.apply(this, f) : f[0], h = u.cache;
            if (h.has(c))
              return h.get(c);
            var d = o.apply(this, f);
            return h.set(c, d), d;
          };
          return u.cache = /* @__PURE__ */ new Map(), u;
        };
      },
      function(e, n, i) {
        var a = i(0), o = i(9), s = 5;
        function u(l, c, h, d) {
          h = h || 0, d = d || s;
          for (var v in c)
            if (c.hasOwnProperty(v)) {
              var p = c[v];
              p !== null && Object(o.a)(p) ? (Object(o.a)(l[v]) || (l[v] = {}), h < d ? u(l[v], p, h + 1, d) : l[v] = c[v]) : Object(a.a)(p) ? (l[v] = [], l[v] = l[v].concat(p)) : p !== void 0 && (l[v] = p);
            }
        }
        var f = function(l) {
          for (var c = [], h = 1; h < arguments.length; h++)
            c[h - 1] = arguments[h];
          for (var d = 0; d < c.length; d += 1)
            u(l, c[d]);
          return l;
        };
        n.a = f;
      },
      function(e, n, i) {
        var a = i(16), o = i(3), s = function(u, f, l, c) {
          Object(o.a)(f) || (l = f, f = u, u = function() {
          });
          var h = Object.create ? function(v, p) {
            return Object.create(v, {
              constructor: {
                value: p
              }
            });
          } : function(v, p) {
            function g() {
            }
            g.prototype = v;
            var y = new g();
            return y.constructor = p, y;
          }, d = h(f.prototype, u);
          return u.prototype = Object(a.a)(d, u.prototype), u.superclass = h(f.prototype, f), Object(a.a)(d, l), Object(a.a)(u, c), u;
        };
        n.a = s;
      },
      function(e, n, i) {
        var a = i(1), o = function(s, u) {
          if (!Object(a.a)(s))
            return -1;
          var f = Array.prototype.indexOf;
          if (f)
            return f.call(s, u);
          for (var l = -1, c = 0; c < s.length; c++)
            if (s[c] === u) {
              l = c;
              break;
            }
          return l;
        };
        n.a = o;
      },
      function(e, n, i) {
        var a = i(6), o = i(1), s = i(27), u = i(28), f = Object.prototype.hasOwnProperty;
        function l(c) {
          if (Object(a.a)(c))
            return !0;
          if (Object(o.a)(c))
            return !c.length;
          var h = Object(s.a)(c);
          if (h === "Map" || h === "Set")
            return !c.size;
          if (Object(u.a)(c))
            return !Object.keys(c).length;
          for (var d in c)
            if (f.call(c, d))
              return !1;
          return !0;
        }
        n.a = l;
      },
      function(e, n, i) {
        var a = i(3), o = i(29);
        n.a = function(s, u, f) {
          return Object(a.a)(f) ? !!f(s, u) : Object(o.a)(s, u);
        };
      },
      function(e, n, i) {
        var a = i(2), o = i(1), s = function(u, f) {
          if (!Object(o.a)(u))
            return u;
          var l = [];
          return Object(a.a)(u, function(c, h) {
            l.push(f(c, h));
          }), l;
        };
        n.a = s;
      },
      function(e, n, i) {
        var a = i(6), o = i(13), s = function(u) {
          return u;
        };
        n.a = function(u, f) {
          f === void 0 && (f = s);
          var l = {};
          return Object(o.a)(u) && !Object(a.a)(u) && Object.keys(u).forEach(function(c) {
            l[c] = f(u[c], c);
          }), l;
        };
      },
      function(e, n, i) {
        var a = i(8);
        n.a = function(o, s, u) {
          for (var f = 0, l = Object(a.a)(s) ? s.split(".") : s; o && f < l.length; )
            o = o[l[f++]];
          return o === void 0 || f < l.length ? u : o;
        };
      },
      function(e, n, i) {
        var a = i(13), o = i(8), s = i(5);
        n.a = function(u, f, l) {
          var c = u, h = Object(o.a)(f) ? f.split(".") : f;
          return h.forEach(function(d, v) {
            v < h.length - 1 ? (Object(a.a)(c[d]) || (c[d] = Object(s.a)(h[v + 1]) ? [] : {}), c = c[d]) : c[d] = l;
          }), u;
        };
      },
      function(e, n, i) {
        var a = i(2), o = i(9), s = Object.prototype.hasOwnProperty;
        n.a = function(u, f) {
          if (u === null || !Object(o.a)(u))
            return {};
          var l = {};
          return Object(a.a)(f, function(c) {
            s.call(u, c) && (l[c] = u[c]);
          }), l;
        };
      },
      function(e, n, i) {
        n.a = function(a, o, s) {
          var u, f, l, c, h = 0;
          s || (s = {});
          var d = function() {
            h = s.leading === !1 ? 0 : Date.now(), u = null, c = a.apply(f, l), u || (f = l = null);
          }, v = function() {
            var p = Date.now();
            !h && s.leading === !1 && (h = p);
            var g = o - (p - h);
            return f = this, l = arguments, g <= 0 || g > o ? (u && (clearTimeout(u), u = null), h = p, c = a.apply(f, l), u || (f = l = null)) : !u && s.trailing !== !1 && (u = setTimeout(d, g)), c;
          };
          return v.cancel = function() {
            clearTimeout(u), h = 0, u = f = l = null;
          }, v;
        };
      },
      function(e, n, i) {
        var a = i(1);
        n.a = function(o) {
          return Object(a.a)(o) ? Array.prototype.slice.call(o) : [];
        };
      },
      function(e, n, i) {
        var a = {};
        n.a = function(o) {
          return o = o || "g", a[o] ? a[o] += 1 : a[o] = 1, o + a[o];
        };
      },
      function(e, n, i) {
        n.a = function() {
        };
      },
      function(e, n, i) {
        n.a = function(a) {
          return a;
        };
      },
      function(e, n, i) {
        n.a = s;
        var a = i(6), o = i(1);
        function s(u) {
          return Object(a.a)(u) ? 0 : Object(o.a)(u) ? u.length : Object.keys(u).length;
        }
      },
      function(e, n, i) {
        var a = function() {
          function o() {
            this.map = {};
          }
          return o.prototype.has = function(s) {
            return this.map[s] !== void 0;
          }, o.prototype.get = function(s, u) {
            var f = this.map[s];
            return f === void 0 ? u : f;
          }, o.prototype.set = function(s, u) {
            this.map[s] = u;
          }, o.prototype.clear = function() {
            this.map = {};
          }, o.prototype.delete = function(s) {
            delete this.map[s];
          }, o.prototype.size = function() {
            return Object.keys(this.map).length;
          }, o;
        }();
        n.a = a;
      },
      function(e, n) {
        function i(l, c, h, d) {
          d === void 0 && (d = []);
          var v = this;
          v.w = l || 0, v.h = c || 0, v.y = h || 0, v.x = 0, v.c = d || [], v.cs = d.length, v.prelim = 0, v.mod = 0, v.shift = 0, v.change = 0, v.tl = null, v.tr = null, v.el = null, v.er = null, v.msel = 0, v.mser = 0;
        }
        i.fromNode = function(l, c) {
          if (!l)
            return null;
          var h = [];
          return l.children.forEach(function(d) {
            h.push(i.fromNode(d, c));
          }), c ? new i(l.height, l.width, l.x, h) : new i(l.width, l.height, l.y, h);
        };
        function a(l, c, h) {
          h ? l.y += c : l.x += c, l.children.forEach(function(d) {
            a(d, c, h);
          });
        }
        function o(l, c) {
          var h = c ? l.y : l.x;
          return l.children.forEach(function(d) {
            h = Math.min(o(d, c), h);
          }), h;
        }
        function s(l, c) {
          var h = o(l, c);
          a(l, -h, c);
        }
        function u(l, c, h) {
          h ? c.y = l.x : c.x = l.x, l.c.forEach(function(d, v) {
            u(d, c.children[v], h);
          });
        }
        function f(l, c, h) {
          h === void 0 && (h = 0), c ? (l.x = h, h += l.width) : (l.y = h, h += l.height), l.children.forEach(function(d) {
            f(d, c, h);
          });
        }
        e.exports = function(l, c) {
          c === void 0 && (c = {});
          var h = c.isHorizontal;
          function d(T) {
            if (T.cs === 0) {
              v(T);
              return;
            }
            d(T.c[0]);
            for (var P = S(m(T.c[0].el), 0, null), k = 1; k < T.cs; ++k) {
              d(T.c[k]);
              var L = m(T.c[k].er);
              p(T, k, P), P = S(L, k, P);
            }
            w(T), v(T);
          }
          function v(T) {
            T.cs === 0 ? (T.el = T, T.er = T, T.msel = T.mser = 0) : (T.el = T.c[0].el, T.msel = T.c[0].msel, T.er = T.c[T.cs - 1].er, T.mser = T.c[T.cs - 1].mser);
          }
          function p(T, P, k) {
            for (var L = T.c[P - 1], O = L.mod, D = T.c[P], G = D.mod; L !== null && D !== null; ) {
              m(L) > k.low && (k = k.nxt);
              var R = O + L.prelim + L.w - (G + D.prelim);
              R > 0 && (G += R, g(T, P, k.index, R));
              var F = m(L), q = m(D);
              F <= q && (L = b(L), L !== null && (O += L.mod)), F >= q && (D = y(D), D !== null && (G += D.mod));
            }
            !L && !!D ? x(T, P, D, G) : !!L && !D && _(T, P, L, O);
          }
          function g(T, P, k, L) {
            T.c[P].mod += L, T.c[P].msel += L, T.c[P].mser += L, M(T, P, k, L);
          }
          function y(T) {
            return T.cs === 0 ? T.tl : T.c[0];
          }
          function b(T) {
            return T.cs === 0 ? T.tr : T.c[T.cs - 1];
          }
          function m(T) {
            return T.y + T.h;
          }
          function x(T, P, k, L) {
            var O = T.c[0].el;
            O.tl = k;
            var D = L - k.mod - T.c[0].msel;
            O.mod += D, O.prelim -= D, T.c[0].el = T.c[P].el, T.c[0].msel = T.c[P].msel;
          }
          function _(T, P, k, L) {
            var O = T.c[P].er;
            O.tr = k;
            var D = L - k.mod - T.c[P].mser;
            O.mod += D, O.prelim -= D, T.c[P].er = T.c[P - 1].er, T.c[P].mser = T.c[P - 1].mser;
          }
          function w(T) {
            T.prelim = (T.c[0].prelim + T.c[0].mod + T.c[T.cs - 1].mod + T.c[T.cs - 1].prelim + T.c[T.cs - 1].w) / 2 - T.w / 2;
          }
          function E(T, P) {
            P += T.mod, T.x = T.prelim + P, C(T);
            for (var k = 0; k < T.cs; k++)
              E(T.c[k], P);
          }
          function M(T, P, k, L) {
            if (k !== P - 1) {
              var O = P - k;
              T.c[k + 1].shift += L / O, T.c[P].shift -= L / O, T.c[P].change -= L - L / O;
            }
          }
          function C(T) {
            for (var P = 0, k = 0, L = 0; L < T.cs; L++)
              P += T.c[L].shift, k += P + T.c[L].change, T.c[L].mod += k;
          }
          function S(T, P, k) {
            for (; k !== null && T >= k.low; )
              k = k.nxt;
            return {
              low: T,
              index: P,
              nxt: k
            };
          }
          f(l, h);
          var A = i.fromNode(l, h);
          return d(A), E(A, 0), u(A, l, h), s(l, h), l;
        };
      },
      function(e, n, i) {
        function a(d, v) {
          d.prototype = Object.create(v.prototype), d.prototype.constructor = d, d.__proto__ = v;
        }
        var o = i(11), s = i(115), u = i(17), f = i(7), l = /* @__PURE__ */ function(d) {
          a(v, d);
          function v() {
            return d.apply(this, arguments) || this;
          }
          var p = v.prototype;
          return p.execute = function() {
            var y = this;
            return y.rootNode.width = 0, u(y.rootNode, y.options, s);
          }, v;
        }(o), c = {};
        function h(d, v) {
          return v = f.assign({}, c, v), new l(d, v).execute();
        }
        e.exports = h;
      },
      function(e, n, i) {
        var a = i(7);
        function o(f, l) {
          l === void 0 && (l = []);
          var c = this;
          c.x = c.y = 0, c.leftChild = c.rightChild = null, c.height = 0, c.children = l;
        }
        var s = {
          isHorizontal: !0,
          nodeSep: 20,
          nodeSize: 20,
          rankSep: 200,
          subTreeSep: 10
        };
        function u(f, l, c) {
          c ? (l.x = f.x, l.y = f.y) : (l.x = f.y, l.y = f.x), f.children.forEach(function(h, d) {
            u(h, l.children[d], c);
          });
        }
        e.exports = function(f, l) {
          l === void 0 && (l = {}), l = a.assign({}, s, l);
          var c = 0;
          function h(y) {
            if (!y)
              return null;
            y.width = 0, y.depth && y.depth > c && (c = y.depth);
            var b = y.children, m = b.length, x = new o(y.height, []);
            return b.forEach(function(_, w) {
              var E = h(_);
              x.children.push(E), w === 0 && (x.leftChild = E), w === m - 1 && (x.rightChild = E);
            }), x.originNode = y, x.isLeaf = y.isLeaf(), x;
          }
          function d(y) {
            if (y.isLeaf || y.children.length === 0)
              y.drawingDepth = c;
            else {
              var b = y.children.map(function(x) {
                return d(x);
              }), m = Math.min.apply(null, b);
              y.drawingDepth = m - 1;
            }
            return y.drawingDepth;
          }
          var v;
          function p(y) {
            y.x = y.drawingDepth * l.rankSep, y.isLeaf ? (y.y = 0, v && (y.y = v.y + v.height + l.nodeSep, y.originNode.parent !== v.originNode.parent && (y.y += l.subTreeSep)), v = y) : (y.children.forEach(function(b) {
              p(b);
            }), y.y = (y.leftChild.y + y.rightChild.y) / 2);
          }
          var g = h(f);
          return d(g), p(g), u(g, f, l.isHorizontal), f;
        };
      },
      function(e, n, i) {
        function a(p, g) {
          p.prototype = Object.create(g.prototype), p.prototype.constructor = p, p.__proto__ = g;
        }
        var o = i(11), s = i(117), u = i(30), f = i(7), l = [
          "LR",
          "RL",
          "H"
        ], c = l[0], h = /* @__PURE__ */ function(p) {
          a(g, p);
          function g() {
            return p.apply(this, arguments) || this;
          }
          var y = g.prototype;
          return y.execute = function() {
            var m = this, x = m.options, _ = m.rootNode;
            x.isHorizontal = !0;
            var w = x.indent, E = w === void 0 ? 20 : w, M = x.dropCap, C = M === void 0 ? !0 : M, S = x.direction || c;
            if (S && l.indexOf(S) === -1)
              throw new TypeError("Invalid direction: " + S);
            if (S === l[0])
              s(_, E, C);
            else if (S === l[1])
              s(_, E, C), _.right2left();
            else if (S === l[2]) {
              var A = u(_, x), T = A.left, P = A.right;
              s(T, E, C), T.right2left(), s(P, E, C);
              var k = T.getBoundingBox();
              P.translate(k.width, 0), _.x = P.x - _.width / 2;
            }
            return _;
          }, g;
        }(o), d = {};
        function v(p, g) {
          return g = f.assign({}, d, g), new h(p, g).execute();
        }
        e.exports = v;
      },
      function(e, n) {
        function i(a, o, s, u) {
          var f = typeof s == "function" ? s(a) : s * a.depth;
          if (!u)
            try {
              if (a.id === a.parent.children[0].id) {
                a.x += f, a.y = o ? o.y : 0;
                return;
              }
            } catch {
            }
          a.x += f, a.y = o ? o.y + o.height : 0;
        }
        e.exports = function(a, o, s) {
          var u = null;
          a.eachNode(function(f) {
            i(f, u, o, s), u = f;
          });
        };
      },
      function(e, n, i) {
        function a(d, v) {
          d.prototype = Object.create(v.prototype), d.prototype.constructor = d, d.__proto__ = v;
        }
        var o = i(11), s = i(119), u = i(17), f = i(7), l = /* @__PURE__ */ function(d) {
          a(v, d);
          function v() {
            return d.apply(this, arguments) || this;
          }
          var p = v.prototype;
          return p.execute = function() {
            var y = this;
            return u(y.rootNode, y.options, s);
          }, v;
        }(o), c = {};
        function h(d, v) {
          return v = f.assign({}, c, v), new l(d, v).execute();
        }
        e.exports = h;
      },
      function(e, n, i) {
        var a = i(7);
        function o(f, l) {
          var c = 0;
          return f.children.length ? f.children.forEach(function(h) {
            c += o(h, l);
          }) : c = f.height, f._subTreeSep = l.getSubTreeSep(f.data), f.totalHeight = Math.max(f.height, c) + 2 * f._subTreeSep, f.totalHeight;
        }
        function s(f) {
          var l = f.children, c = l.length;
          if (c) {
            l.forEach(function(y) {
              s(y);
            });
            var h = l[0], d = l[c - 1], v = d.y - h.y + d.height, p = 0;
            if (l.forEach(function(y) {
              p += y.totalHeight;
            }), v > f.height)
              f.y = h.y + v / 2 - f.height / 2;
            else if (l.length !== 1 || f.height > p) {
              var g = f.y + (f.height - v) / 2 - h.y;
              l.forEach(function(y) {
                y.translate(0, g);
              });
            } else
              f.y = (h.y + h.height / 2 + d.y + d.height / 2) / 2 - f.height / 2;
          }
        }
        var u = {
          getSubTreeSep: function() {
            return 0;
          }
        };
        e.exports = function(f, l) {
          l === void 0 && (l = {}), l = a.assign({}, u, l), f.parent = {
            x: 0,
            width: 0,
            height: 0,
            y: 0
          }, f.BFTraverse(function(c) {
            c.x = c.parent.x + c.parent.width;
          }), f.parent = null, o(f, l), f.startY = 0, f.y = f.totalHeight / 2 - f.height / 2, f.eachNode(function(c) {
            var h = c.children, d = h.length;
            if (d) {
              var v = h[0];
              if (v.startY = c.startY + c._subTreeSep, d === 1)
                v.y = c.y + c.height / 2 - v.height / 2;
              else {
                v.y = v.startY + v.totalHeight / 2 - v.height / 2;
                for (var p = 1; p < d; p++) {
                  var g = h[p];
                  g.startY = h[p - 1].startY + h[p - 1].totalHeight, g.y = g.startY + g.totalHeight / 2 - g.height / 2;
                }
              }
            }
          }), s(f);
        };
      }
    ]);
  });
})(Z5);
const _p = /* @__PURE__ */ AN(Z5.exports);
var SO = ci.traverseTree, Xpe = function(t, e) {
  var n;
  return t ? At(t) ? n = function(a) {
    return t;
  } : n = t : n = function(a) {
    return e || 1;
  }, n;
}, Ype = function(t, e) {
  var n = [], i = [], a = {}, o = 0;
  for (o = 0; o < t.length; o++) {
    var s = t[o];
    a[s.id] = o, n.push(s.x), n.push(s.y), n.push(0), n.push(0), i.push([]);
  }
  for (o = 0; o < e.length; o++) {
    var u = e[o];
    i[a[u.source]].push(a[u.target]), i[a[u.target]].push(a[u.source]);
  }
  var f = 0;
  for (o = 0; o < t.length; o++) {
    var l = n.length, c = i[o], h = c.length;
    n[o * 4 + 2] = l, n[o * 4 + 3] = c.length, f = Math.max(f, c.length);
    for (var d = 0; d < h; ++d) {
      var v = c[d];
      n.push(+v);
    }
  }
  for (; n.length % 4 !== 0; )
    n.push(0);
  return {
    array: new Float32Array(n),
    maxEdgePerVetex: f
  };
}, Hpe = function(t, e, n) {
  var i = [], a = [], o = {}, s = 0;
  for (s = 0; s < t.length; s++) {
    var u = t[s];
    o[u.id] = s, i.push(u.x), i.push(u.y), i.push(0), i.push(0), a.push([]);
  }
  for (s = 0; s < e.length; s++) {
    var f = e[s];
    a[o[f.source]].push(o[f.target]), a[o[f.source]].push(n(f)), a[o[f.target]].push(o[f.source]), a[o[f.target]].push(n(f));
  }
  var l = 0;
  for (s = 0; s < t.length; s++) {
    var c = i.length, h = a[s], d = h.length;
    i[s * 4 + 2] = c, i[s * 4 + 3] = d / 2, l = Math.max(l, d / 2);
    for (var v = 0; v < d; ++v) {
      var p = h[v];
      i.push(+p);
    }
  }
  for (; i.length % 4 !== 0; )
    i.push(0);
  return {
    array: new Float32Array(i),
    maxEdgePerVetex: l
  };
}, Kpe = function(t, e, n, i) {
  var a = [], o = [], s = {}, u = 0;
  for (u = 0; u < t.length; u++) {
    var f = t[u];
    s[f.id] = u, a.push(f.x), a.push(f.y), a.push(0), a.push(0), o.push([]);
  }
  for (u = 0; u < e.length; u++) {
    var l = e[u];
    o[s[l.source]].push(s[l.target]), o[s[l.source]].push(n(l)), o[s[l.source]].push(i(l)), o[s[l.source]].push(0), o[s[l.target]].push(s[l.source]), o[s[l.target]].push(n(l)), o[s[l.target]].push(i(l)), o[s[l.target]].push(0);
  }
  var c = 0;
  for (u = 0; u < t.length; u++) {
    var h = a.length, d = o[u], v = d.length;
    a[u * 4 + 2] = h + 1048576 * v / 4, a[u * 4 + 3] = 0, c = Math.max(c, v / 4);
    for (var p = 0; p < v; ++p) {
      var g = d[p];
      a.push(+g);
    }
  }
  for (; a.length % 4 !== 0; )
    a.push(0);
  return {
    array: new Float32Array(a),
    maxEdgePerVetex: c
  };
}, qpe = function(t, e) {
  var n = [], i = t.length, a = {};
  return e.forEach(function(o) {
    t.forEach(function(s, u) {
      if (a[o[s]] === void 0 && (a[o[s]] = Object.keys(a).length), n.push(a[o[s]]), u === i - 1)
        for (; n.length % 4 !== 0; )
          n.push(0);
    });
  }), {
    array: new Float32Array(n),
    count: Object.keys(a).length
  };
}, Zpe = function(t) {
  for (var e = [], n = t.length, i = t[0].length, a = function(u) {
    t.forEach(function(f, l) {
      if (e.push(f[u]), l === n - 1)
        for (; e.length % 4 !== 0; )
          e.push(0);
    });
  }, o = 0; o < i; o++)
    a(o);
  return new Float32Array(e);
}, Qpe = function(t, e) {
  var n = ["V", "TB", "BT"], i = {
    x: 1 / 0,
    y: 1 / 0
  }, a = {
    x: -1 / 0,
    y: -1 / 0
  }, o = "x", s = "y";
  e && n.indexOf(e) >= 0 && (s = "x", o = "y");
  var u = 0;
  SO(t, function(c) {
    return u++, c.x > a.x && (a.x = c.x), c.x < i.x && (i.x = c.x), c.y > a.y && (a.y = c.y), c.y < i.y && (i.y = c.y), !0;
  });
  var f = Math.PI * 2 / u, l = a[s] - i[s];
  return l === 0 || SO(t, function(c) {
    var h = (c[s] - i[s]) / l * (Math.PI * 2 - f) + f, d = Math.abs(o === "x" ? c.x - t.x : c.y - t.y);
    return c.x = d * Math.cos(h), c.y = d * Math.sin(h), !0;
  }), t;
};
const Jpe = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  proccessToFunc: Xpe,
  buildTextureData: Ype,
  buildTextureDataWithOneEdgeAttr: Hpe,
  buildTextureDataWithTwoEdgeAttr: Kpe,
  attributesToTextureData: qpe,
  arrayToTextureData: Zpe,
  radialLayout: Qpe
}, Symbol.toStringTag, { value: "Module" }));
var Q5 = function r() {
  return typeof window > "u" || typeof document > "u" ? {} : {
    canvas: !!window.CanvasRenderingContext2D,
    webgl: function() {
      try {
        var t = document.createElement("canvas");
        return !!(window.WebGLRenderingContext && (t.getContext("webgl") || t.getContext("experimental-webgl")));
      } catch {
        return !1;
      }
    }(),
    workers: !!window.Worker,
    fileapi: window.File && window.FileReader && window.FileList && window.Blob,
    getWebGLErrorMessage: function() {
      var e = document.createElement("div");
      return e.id = "webgl-error-message", e.style.fontFamily = "monospace", e.style.fontSize = "13px", e.style.fontWeight = "normal", e.style.textAlign = "center", e.style.background = "#fff", e.style.color = "#000", e.style.padding = "1.5em", e.style.width = "400px", e.style.margin = "5em auto 0", this.webgl || (e.innerHTML = window.WebGLRenderingContext ? ['Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" rel="external nofollow" rel="external nofollow" style="color:#000">WebGL</a>.<br />', 'Find out how to get it <a href="http://get.webgl.org/" rel="external nofollow" rel="external nofollow" style="color:#000">here</a>.'].join(`
`) : ['Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" rel="external nofollow" rel="external nofollow" style="color:#000">WebGL</a>.<br/>', 'Find out how to get it <a href="http://get.webgl.org/" rel="external nofollow" rel="external nofollow" style="color:#000">here</a>.'].join(`
`)), e;
    },
    addGetWebGLMessage: function(e) {
      e = e || {};
      var n = e.parent !== void 0 ? e.parent : document.body, i = e.id !== void 0 ? e.id : "oldie", a = r().getWebGLErrorMessage();
      a.id = i, n.appendChild(a);
    }
  };
};
const ege = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  gpuDetector: Q5
}, Symbol.toStringTag, { value: "Module" }));
var No = U(U(U(U({}, ci), Kq), Jpe), ege), tge = No.radialLayout, rge = function() {
  function r(t) {
    this.type = t.type, this.radial = t.radial, this.config = t;
  }
  return r.prototype.init = function(t) {
    var e = this;
    if (this.data = t, this.radial) {
      this.layoutMethod = function(n) {
        var i = _p[e.type](n, e.config);
        return tge(i), i;
      };
      return;
    }
    this.layoutMethod = function(n) {
      return _p[e.type](n, e.config);
    };
  }, r.prototype.execute = function() {
    return this.layoutMethod(this.data, this.config);
  }, r.prototype.layout = function(t) {
    return this.init(t), this.execute();
  }, r;
}();
sr.registerLayout("grid", sr.GridLayout);
sr.registerLayout("random", sr.RandomLayout);
sr.registerLayout("force", sr.ForceLayout);
sr.registerLayout("circular", sr.CircularLayout);
sr.registerLayout("dagre", sr.DagreLayout);
sr.registerLayout("dagreCompound", sr.DagreCompoundLayout);
sr.registerLayout("radial", sr.RadialLayout);
sr.registerLayout("concentric", sr.ConcentricLayout);
sr.registerLayout("mds", sr.MDSLayout);
sr.registerLayout("fruchterman", sr.FruchtermanLayout);
sr.registerLayout("fruchterman-gpu", sr.FruchtermanGPULayout);
sr.registerLayout("gForce", sr.GForceLayout);
sr.registerLayout("force2", sr.Force2Layout);
sr.registerLayout("gForce-gpu", sr.GForceGPULayout);
sr.registerLayout("comboForce", sr.ComboForceLayout);
sr.registerLayout("comboCombined", sr.ComboCombinedLayout);
sr.registerLayout("forceAtlas2", sr.ForceAtlas2Layout);
var nge = function(t, e) {
  e.isCustomLayout = !0, sr.Layouts[t] = sr.registerLayout(t, e);
}, ige = function() {
  function r(t, e) {
    var n = t.toString(), i = new Blob(["importScripts('".concat(e, "');(").concat(n, ")()")], {
      type: "text/javascript"
    });
    return new Worker(URL.createObjectURL(i));
  }
  return r;
}(), age = function(t) {
  t === void 0 && (t = "https://unpkg.com/@antv/layout@latest/dist/layout.min.js");
  function e() {
    var i = {
      RUN: "LAYOUT_RUN",
      END: "LAYOUT_END",
      ERROR: "LAYOUT_ERROR",
      TICK: "LAYOUT_TICK",
      GPURUN: "GPU_LAYOUT_RUN",
      GPUEND: "GPU_LAYOUT_END"
    };
    layout.registerLayout("grid", layout.GridLayout), layout.registerLayout("random", layout.RandomLayout), layout.registerLayout("force", layout.ForceLayout), layout.registerLayout("circular", layout.CircularLayout), layout.registerLayout("dagre", layout.DagreLayout), layout.registerLayout("dagreCompound", layout.DagreCompoundLayout), layout.registerLayout("radial", layout.RadialLayout), layout.registerLayout("concentric", layout.ConcentricLayout), layout.registerLayout("mds", layout.MDSLayout), layout.registerLayout("fruchterman", layout.FruchtermanLayout), layout.registerLayout("fruchterman-gpu", layout.FruchtermanGPULayout), layout.registerLayout("gForce", layout.GForceLayout), layout.registerLayout("gForce-gpu", layout.GForceGPULayout), layout.registerLayout("comboForce", layout.ComboForceLayout), layout.registerLayout("comboCombined", layout.ComboCombinedLayout), layout.registerLayout("forceAtlas2", layout.ForceAtlas2Layout);
    function a(s) {
      var u = s.data.type;
      return u === i.RUN || u === i.GPURUN;
    }
    function o(s) {
      var u = this, f = s.data.type;
      switch (f) {
        case i.RUN: {
          var l = s.data, c = l.nodes, h = l.edges, d = l.layoutCfg, v = d === void 0 ? {} : d, p = v.type, g = layout.getLayoutByName(p);
          if (!g) {
            this.postMessage({
              type: i.ERROR,
              message: "layout ".concat(p, " not found")
            });
            break;
          }
          var y;
          v.onLayoutEnd = function() {
            u.postMessage({
              type: i.END,
              nodes: c
            }), y == null || y.destroy();
          }, y = new g(v), y.init({
            nodes: c,
            edges: h
          }), y.execute();
          break;
        }
        case i.GPURUN: {
          var b = s.data, m = b.nodes, h = b.edges, x = b.layoutCfg, v = x === void 0 ? {} : x, _ = b.canvas, p = v.type, g = layout.getLayoutByName(p);
          if (!g) {
            this.postMessage({
              type: i.ERROR,
              message: "layout ".concat(p, " not found")
            });
            break;
          }
          if (p.split("-")[1] !== "gpu") {
            this.postMessage({
              type: i.ERROR,
              message: "layout ".concat(p, " does not support GPU")
            });
            break;
          }
          var w = new g(v);
          w.init({
            nodes: m,
            edges: h
          }), w.executeWithWorker(_, this);
          break;
        }
      }
    }
    onmessage = function(u) {
      a(u) && o(u);
    };
  }
  var n = new ige(e, t);
  return n;
}, vf = {
  RUN: "LAYOUT_RUN",
  END: "LAYOUT_END",
  ERROR: "LAYOUT_ERROR",
  TICK: "LAYOUT_TICK",
  GPURUN: "GPU_LAYOUT_RUN",
  GPUEND: "GPU_LAYOUT_END"
};
function A1(r) {
  return A1 = typeof Symbol == "function" && typeof Symbol.iterator == "symbol" ? function(t) {
    return typeof t;
  } : function(t) {
    return t && typeof Symbol == "function" && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t;
  }, A1(r);
}
var MO = function(t) {
  return setTimeout(t, 16);
}, CO = function(t) {
  return clearTimeout(t);
}, nv = {
  requestAnimationFrame: function(t) {
    var e = typeof window < "u" && (window.requestAnimationFrame || window.webkitRequestAnimationFrame) || MO;
    return e(t);
  },
  cancelAnimationFrame: function(t) {
    var e = typeof window < "u" && (window.cancelAnimationFrame || window.webkitCancelAnimationFrame) || CO;
    return e(t);
  }
}, oge = ["fruchterman", "gForce"], sge = ["force", "grid", "circular"], uge = function(r) {
  Ht(t, r);
  function t(e) {
    var n = r.call(this, e) || this;
    return n.graph = e, n.layoutCfg = e.get("layout") || {}, n.layoutType = n.getLayoutType(), n.worker = null, n.workerData = {}, n.initLayout(), n;
  }
  return t.prototype.initLayout = function() {
  }, t.prototype.getWorker = function() {
    return this.worker ? this.worker : (typeof Worker > "u" ? (console.warn("Web worker is not supported in current browser."), this.worker = null) : this.worker = age(this.layoutCfg.workerScriptURL), this.worker);
  }, t.prototype.stopWorker = function() {
    var e = this.workerData;
    !this.worker || (this.worker.terminate(), this.worker = null, e.requestId && (nv.cancelAnimationFrame(e.requestId), e.requestId = null), e.requestId2 && (nv.cancelAnimationFrame(e.requestId2), e.requestId2 = null));
  }, t.prototype.execLayoutMethod = function(e, n) {
    var i = this;
    return new Promise(function(a, o) {
      return Ea(i, void 0, void 0, function() {
        var s, u, f, l, c, p, h, d, v, p, g;
        return Sa(this, function(y) {
          switch (y.label) {
            case 0:
              if (s = this.graph, !s || s.get("destroyed"))
                return [2];
              u = e.type, e.onLayoutEnd = function() {
                s.emit("aftersublayout", {
                  type: u
                }), a();
              }, u && this.isGPU && (this.hasGPUVersion(u) ? u = "".concat(u, "-gpu") : console.warn("The '".concat(u, "' layout does not support GPU calculation for now, it will run in CPU."))), ci.isForce(u) ? (f = e.onTick, l = e.animate, c = l === void 0 && (u === "force" || u === "force2"), p = function() {
                f && f(), (l || c) && s.refreshPositions();
              }, e.tick = p) : (u === "comboForce" || u === "comboCombined") && (e.comboTrees = s.get("comboTrees")), h = !1;
              try {
                d = new sr.Layouts[u](e), this.layoutMethods[n] && this.layoutMethods[n].destroy(), this.layoutMethods[n] = d;
              } catch {
                console.warn("The layout method: '".concat(u, "' does not exist! Please specify it first.")), o();
              }
              return h = d.enableTick, h && (v = e.onTick, p = function() {
                v && v(), s.refreshPositions();
              }, d.tick = p), g = this.filterLayoutData(this.data, e), cge(g, n), d.init(g), s.emit("beforesublayout", {
                type: u
              }), [4, d.execute()];
            case 1:
              return y.sent(), d.isCustomLayout && e.onLayoutEnd && e.onLayoutEnd(), [2];
          }
        });
      });
    });
  }, t.prototype.updateLayoutMethod = function(e, n) {
    var i = this;
    return new Promise(function(a, o) {
      return Ea(i, void 0, void 0, function() {
        var s, u, f;
        return Sa(this, function(l) {
          switch (l.label) {
            case 0:
              return s = this.graph, u = n == null ? void 0 : n.type, n.onLayoutEnd = function() {
                s.emit("aftersublayout", {
                  type: u
                }), a();
              }, f = this.filterLayoutData(this.data, n), e.init(f), e.updateCfg(n), s.emit("beforesublayout", {
                type: u
              }), [4, e.execute()];
            case 1:
              return l.sent(), e.isCustomLayout && n.onLayoutEnd && n.onLayoutEnd(), [2];
          }
        });
      });
    });
  }, t.prototype.layout = function(e) {
    var n = this, i = this.graph;
    this.data = this.setDataFromGraph();
    var a = this.data, o = a.nodes, s = a.hiddenNodes;
    if (!o)
      return !1;
    var u = i.get("width"), f = i.get("height"), l = {};
    Object.assign(l, {
      width: u,
      height: f,
      center: [u / 2, f / 2]
    }, this.layoutCfg), this.layoutCfg = l;
    var c = l.type, h = this.destoryLayoutMethods();
    i.emit("beforelayout"), (h == null ? void 0 : h.length) && c && (h == null ? void 0 : h.length) === 1 && h[0] === c ? this.tweakInit() : this.initPositions(l.center, o), this.initPositions(l.center, s), c && c.split("-")[1] === "gpu" && (c = c.split("-")[0], l.gpuEnabled = !0);
    var d = !1;
    l.gpuEnabled && (d = !0, Q5().webgl || (console.warn("Your browser does not support webGL or GPGPU. The layout will run in CPU."), d = !1)), this.isGPU = d;
    var v = l.onLayoutEnd, p = l.layoutEndFormatted, g = l.adjust;
    if (p || (l.layoutEndFormatted = !0, l.onAllLayoutEnd = function() {
      return Ea(n, void 0, void 0, function() {
        return Sa(this, function(m) {
          switch (m.label) {
            case 0:
              return v && v(o), this.refreshLayout(), g && l.pipes ? [4, this.adjustPipesBox(this.data, g)] : [3, 2];
            case 1:
              m.sent(), this.refreshLayout(), m.label = 2;
            case 2:
              return i.emit("afterlayout"), [2];
          }
        });
      });
    }), this.stopWorker(), l.workerEnabled && this.layoutWithWorker(this.data, e))
      return !0;
    var y = Promise.resolve(), b = !1;
    return l.type ? (b = !0, y = y.then(function() {
      return Ea(n, void 0, void 0, function() {
        return Sa(this, function(m) {
          switch (m.label) {
            case 0:
              return [4, this.execLayoutMethod(l, 0)];
            case 1:
              return [2, m.sent()];
          }
        });
      });
    })) : l.pipes && (b = !0, l.pipes.forEach(function(m, x) {
      y = y.then(function() {
        return Ea(n, void 0, void 0, function() {
          return Sa(this, function(_) {
            switch (_.label) {
              case 0:
                return [4, this.execLayoutMethod(m, x)];
              case 1:
                return [2, _.sent()];
            }
          });
        });
      });
    })), b ? y.then(function() {
      l.onAllLayoutEnd && l.onAllLayoutEnd(), e && e();
    }).catch(function(m) {
      console.warn("graph layout failed,", m);
    }) : (i.refreshPositions(), e == null || e()), !1;
  }, t.prototype.tweakInit = function() {
    var e = this, n = e.data, i = e.graph, a = n.nodes, o = n.edges;
    if (!!(a != null && a.length)) {
      var s = {};
      a.forEach(function(l) {
        var c = l.x, h = l.y;
        !isNaN(c) && !isNaN(h) && (s[l.id] = {
          x: c,
          y: h
        }, l.mass = l.mass || 2);
      }), o.forEach(function(l) {
        var c = l.source, h = l.target, d = s[c], v = s[h];
        !d && v ? s[c] = {
          x: v.x + (Math.random() - 0.5) * 80,
          y: v.y + (Math.random() - 0.5) * 80
        } : !v && d && (s[h] = {
          x: d.x + (Math.random() - 0.5) * 80,
          y: d.y + (Math.random() - 0.5) * 80
        });
      });
      var u = i.get("width"), f = i.get("height");
      a.forEach(function(l) {
        var c = s[l.id] || {
          x: u / 2 + (Math.random() - 0.5) * 20,
          y: f / 2 + (Math.random() - 0.5) * 20
        };
        l.x = c.x, l.y = c.y;
      });
    }
  }, t.prototype.initWithPreset = function() {
    var e = this, n = e.layoutCfg, i = e.data, a = n.preset;
    if (!(a != null && a.type) || !sr.Layouts[a == null ? void 0 : a.type])
      return !1;
    var o = new sr.Layouts[a == null ? void 0 : a.type](a);
    return o.layout(i), delete n.preset, !0;
  }, t.prototype.layoutWithWorker = function(e, n) {
    var i = this, a = this, o = a.layoutCfg, s = a.graph, u = this.getWorker(), f = this.workerData;
    if (!u)
      return !1;
    f.requestId = null, f.requestId2 = null, f.currentTick = null, f.currentTickData = null, s.emit("beforelayout");
    var l = Promise.resolve(), c = !1;
    if (o.type)
      c = !0, l = l.then(function() {
        return i.runWebworker(u, e, o);
      });
    else if (o.pipes) {
      c = !0;
      for (var h = function(y) {
        l = l.then(function() {
          return i.runWebworker(u, e, y);
        });
      }, d = 0, v = o.pipes; d < v.length; d++) {
        var p = v[d];
        h(p);
      }
    }
    return c && l.then(function() {
      o.onAllLayoutEnd && o.onAllLayoutEnd(), n == null || n();
    }).catch(function(g) {
      console.error("layout failed", g);
    }), !0;
  }, t.prototype.runWebworker = function(e, n, i) {
    var a = this, o = this.isGPU, s = this.filterLayoutData(n, i), u = s.nodes, f = s.edges, l = document.createElement("canvas"), c = o && typeof window < "u" && window.navigator && !navigator.gpu && "OffscreenCanvas" in window && "transferControlToOffscreen" in l, h = fge(i, function(v) {
      return typeof v != "function";
    });
    if (!c)
      e.postMessage({
        type: vf.RUN,
        nodes: u,
        edges: f,
        layoutCfg: h
      });
    else {
      var d = l.transferControlToOffscreen();
      h.type = "".concat(h.type, "-gpu"), e.postMessage({
        type: vf.GPURUN,
        nodes: u,
        edges: f,
        layoutCfg: h,
        canvas: d
      }, [d]);
    }
    return new Promise(function(v, p) {
      e.onmessage = function(g) {
        a.handleWorkerMessage(v, p, g, s, i);
      };
    });
  }, t.prototype.handleWorkerMessage = function(e, n, i, a, o) {
    var s = this, u = s.graph, f = s.workerData, l = i.data, c = l.type, h = function() {
      o.onTick && o.onTick();
    };
    switch (c) {
      case vf.TICK:
        f.currentTick = l.currentTick, f.currentTickData = l, f.requestId || (f.requestId = nv.requestAnimationFrame(function() {
          jy(a, l), u.refreshPositions(), h(), l.currentTick === l.totalTicks ? e() : f.currentTick === l.totalTicks && (f.requestId2 = nv.requestAnimationFrame(function() {
            jy(a, f.currentTickData), u.refreshPositions(), f.requestId2 = null, h(), e();
          })), f.requestId = null;
        }));
        break;
      case vf.END:
        f.currentTick == null && (jy(a, l), e());
        break;
      case vf.GPUEND:
        f.currentTick == null && (lge(a, l), e());
        break;
      case vf.ERROR:
        console.warn("Web-Worker layout error!", l.message), n();
        break;
      default:
        n();
        break;
    }
  }, t.prototype.updateLayoutCfg = function(e) {
    var n = this, i = this, a = i.graph, o = i.layoutMethods, s = e.disableTriggerLayout, u = kn(e, ["disableTriggerLayout"]), f = kt({}, this.layoutCfg, u);
    if (this.layoutCfg = f, !s) {
      if (!(o != null && o.length)) {
        this.layout();
        return;
      }
      if (this.data = this.setDataFromGraph(), this.stopWorker(), !(u.workerEnabled && this.layoutWithWorker(this.data, null))) {
        a.emit("beforelayout");
        var l = Promise.resolve(), c = !1;
        (o == null ? void 0 : o.length) === 1 ? (c = !0, l = l.then(function() {
          return Ea(n, void 0, void 0, function() {
            return Sa(this, function(h) {
              switch (h.label) {
                case 0:
                  return [4, this.updateLayoutMethod(o[0], f)];
                case 1:
                  return [2, h.sent()];
              }
            });
          });
        })) : o != null && o.length && (c = !0, o.forEach(function(h, d) {
          var v = f.pipes[d];
          l = l.then(function() {
            return Ea(n, void 0, void 0, function() {
              return Sa(this, function(p) {
                switch (p.label) {
                  case 0:
                    return [4, this.updateLayoutMethod(h, v)];
                  case 1:
                    return [2, p.sent()];
                }
              });
            });
          });
        })), c && l.then(function() {
          f.onAllLayoutEnd && f.onAllLayoutEnd();
        }).catch(function(h) {
          console.warn("layout failed", h);
        });
      }
    }
  }, t.prototype.adjustPipesBox = function(e, n) {
    var i = this;
    return new Promise(function(a) {
      var o = e.nodes;
      o != null && o.length || a(), sge.includes(n) || (console.warn("The adjust type ".concat(n, " is not supported yet, please assign it with 'force', 'grid', or 'circular'.")), a());
      var s = {
        center: i.layoutCfg.center,
        nodeSize: function(v) {
          return Math.max(v.height, v.width);
        },
        preventOverlap: !0,
        onLayoutEnd: function() {
        }
      }, u = i.getLayoutBBox(o), f = u.groupNodes, l = u.layoutNodes, c = vr(l);
      s.onLayoutEnd = function() {
        l == null || l.forEach(function(d, v) {
          var p, g, y, b = d.x - ((p = c[v]) === null || p === void 0 ? void 0 : p.x), m = d.y - ((g = c[v]) === null || g === void 0 ? void 0 : g.y);
          (y = f[v]) === null || y === void 0 || y.forEach(function(x) {
            x.x += b, x.y += m;
          });
        }), a();
      };
      var h = new sr.Layouts[n](s);
      h.layout({
        nodes: l
      });
    });
  }, t.prototype.hasGPUVersion = function(e) {
    return oge.includes(e);
  }, t.prototype.destroy = function() {
    this.destoryLayoutMethods();
    var e = this.worker;
    e && (e.terminate(), this.worker = null), this.destroyed = !0, this.graph.set("layout", void 0), this.layoutCfg = void 0, this.layoutType = void 0, this.layoutMethods = void 0, this.graph = null;
  }, t;
}(YN);
function jy(r, t) {
  for (var e = r.nodes, n = t.nodes, i = e.length, a = 0; a < i; a++) {
    var o = e[a];
    o.x = n[a].x, o.y = n[a].y;
  }
}
function fge(r, t) {
  var e = {};
  return r && A1(r) === "object" ? (Object.keys(r).forEach(function(n) {
    r.hasOwnProperty(n) && t(r[n]) && (e[n] = r[n]);
  }), e) : r;
}
function lge(r, t) {
  for (var e = r.nodes, n = t.vertexEdgeData, i = e.length, a = 0; a < i; a++) {
    var o = e[a], s = n[4 * a], u = n[4 * a + 1];
    o.x = s, o.y = u;
  }
}
function cge(r, t) {
  var e;
  if (!!(!((e = r == null ? void 0 : r.nodes) === null || e === void 0) && e.length)) {
    var n = r.nodes;
    n.forEach(function(i) {
      i.layoutOrder = t;
    });
  }
}
var TO = $i, hge = "svg", J5 = function(r) {
  Ht(t, r);
  function t(e) {
    var n = r.call(this, e) || this, i = n.get("defaultNode");
    return i || n.set("defaultNode", {
      type: "circle"
    }), i.type || (i.type = "circle", n.set("defaultNode", i)), n.destroyed = !1, n;
  }
  return t.prototype.initLayoutController = function() {
    var e = new uge(this);
    this.set({
      layoutController: e
    });
  }, t.prototype.initEventController = function() {
    var e = new tZ(this);
    this.set({
      eventController: e
    });
  }, t.prototype.initCanvas = function() {
    var e = this.get("container");
    if (typeof e == "string" && (e = document.getElementById(e), this.set("container", e)), !e)
      throw new Error("invalid container");
    var n = e.clientWidth, i = e.clientHeight, a = this.get("width") || n, o = this.get("height") || i;
    !this.get("width") && !this.get("height") && (this.set("width", n), this.set("height", i));
    var s = this.get("renderer"), u;
    if (s === hge)
      u = new gc({
        container: e,
        width: a,
        height: o
      });
    else {
      var f = {
        container: e,
        width: a,
        height: o
      }, l = this.get("pixelRatio");
      l && (f.pixelRatio = l), u = new po(f);
    }
    this.set("canvas", u);
  }, t.prototype.initPlugins = function() {
    var e = this;
    Se(e.get("plugins"), function(n) {
      !n.destroyed && n.initPlugin && n.initPlugin(e);
    });
  }, t.prototype.downloadImageWatermark = function(e, n, i, a) {
    return Ea(this, void 0, void 0, function() {
      var o, s, u;
      return Sa(this, function(f) {
        switch (f.label) {
          case 0:
            return o = e.style.backgroundImage, s = o.slice(5, o.length - 2), u = new Image(), u.src = s, [4, new Promise(function(l) {
              u.onload = function() {
                var c = n.createPattern(u, "repeat");
                n.rect(0, 0, i, a), n.fillStyle = c, n.fill(), l("");
              };
            })];
          case 1:
            return f.sent(), [2];
        }
      });
    });
  }, t.prototype.asyncToDataUrl = function(e, n, i, a, o, s) {
    var u = this, f = document.querySelector(".g6-graph-watermarker"), l = this.get("canvas"), c = l.getRenderer(), h = s || l.get("el"), d = "";
    e || (e = "image/png"), setTimeout(function() {
      return Ea(u, void 0, void 0, function() {
        var v, p, g, y, b, m, x, _, w, E;
        return Sa(this, function(M) {
          switch (M.label) {
            case 0:
              return c !== "svg" ? [3, 1] : (v = h.cloneNode(!0), p = document.implementation.createDocumentType("svg", "-//W3C//DTD SVG 1.1//EN", "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"), g = document.implementation.createDocument("http://www.w3.org/2000/svg", "svg", p), g.replaceChild(v, g.documentElement), y = new XMLSerializer().serializeToString(g), d = "data:image/svg+xml;charset=utf8,".concat(encodeURIComponent(y)), [3, 4]);
            case 1:
              return b = void 0, m = h.getContext("2d"), x = a || this.get("width"), _ = o || this.get("height"), w = void 0, f ? [4, this.downloadImageWatermark(f, m, x, _)] : [3, 3];
            case 2:
              M.sent(), M.label = 3;
            case 3:
              if (n) {
                E = typeof window < "u" ? window.devicePixelRatio : 1;
                try {
                  b = m.getImageData(0, 0, x * E, _ * E), w = m.globalCompositeOperation, m.globalCompositeOperation = "destination-over", m.fillStyle = n, m.fillRect(0, 0, x, _);
                } catch {
                  console.error("Download image failed. Out of memory at ImageData creation");
                }
              }
              d = h.toDataURL(e), n && (m.clearRect(0, 0, x, _), m.putImageData(b, 0, 0), m.globalCompositeOperation = w), M.label = 4;
            case 4:
              return i && i(d), [2];
          }
        });
      });
    }, 16);
  }, t.prototype.toDataURL = function(e, n) {
    var i = this.get("canvas"), a = i.getRenderer(), o = i.get("el");
    e || (e = "image/png");
    var s = "";
    if (a === "svg") {
      var u = o.cloneNode(!0), f = document.implementation.createDocumentType("svg", "-//W3C//DTD SVG 1.1//EN", "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"), l = document.implementation.createDocument("http://www.w3.org/2000/svg", "svg", f);
      l.replaceChild(u, l.documentElement);
      var c = new XMLSerializer().serializeToString(l);
      s = "data:image/svg+xml;charset=utf8,".concat(encodeURIComponent(c));
    } else {
      var h = void 0, d = o.getContext("2d"), v = Math.max(this.get("width"), 500), p = Math.max(this.get("height"), 500), g = void 0;
      if (n) {
        var y = typeof window < "u" && window.devicePixelRatio || 1;
        try {
          h = d.getImageData(0, 0, v * y, p * y), g = d.globalCompositeOperation, d.globalCompositeOperation = "destination-over", d.fillStyle = n, d.fillRect(0, 0, v, p);
        } catch {
          console.error("Download image failed. Out of memory at ImageData creation");
        }
      }
      s = o.toDataURL(e), n && (d.clearRect(0, 0, v, p), d.putImageData(h, 0, 0), d.globalCompositeOperation = g);
    }
    return s;
  }, t.prototype.toFullDataURL = function(e, n, i) {
    var a = this.get("group").getCanvasBBox(), o = a.height, s = a.width, u = this.get("renderer"), f = Nr('<div id="virtual-image"></div>'), l = i ? i.backgroundColor : void 0, c = i ? i.padding : void 0;
    c ? At(c) && (c = [c, c, c, c]) : c = [0, 0, 0, 0];
    var h = o + c[0] + c[2], d = s + c[1] + c[3], v = {
      container: f,
      height: h,
      width: d,
      quickHit: !0
    }, p = u === "svg" ? new gc(v) : new po(v), g = this.get("group"), y = g.clone(), b = vr(y.getMatrix());
    b || (b = [1, 0, 0, 0, 1, 0, 0, 0, 1]);
    var m = (a.maxX + a.minX) / 2, x = (a.maxY + a.minY) / 2;
    b = TO(b, [["t", -m, -x], ["t", s / 2 + c[3], o / 2 + c[0]]]), y.resetMatrix(), y.setMatrix(b), p.add(y);
    var _ = p.get("el"), w = "";
    n || (n = "image/png"), setTimeout(function() {
      if (u === "svg") {
        var E = _.cloneNode(!0), M = document.implementation.createDocumentType("svg", "-//W3C//DTD SVG 1.1//EN", "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"), C = document.implementation.createDocument("http://www.w3.org/2000/svg", "svg", M);
        C.replaceChild(E, C.documentElement);
        var S = new XMLSerializer().serializeToString(C);
        w = "data:image/svg+xml;charset=utf8,".concat(encodeURIComponent(S));
      } else {
        var A = void 0, T = _.getContext("2d"), P = void 0;
        if (l) {
          var k = typeof window < "u" ? window.devicePixelRatio : 1;
          try {
            A = T.getImageData(0, 0, d * k, h * k), P = T.globalCompositeOperation, T.globalCompositeOperation = "destination-over", T.fillStyle = l, T.fillRect(0, 0, d, h);
          } catch {
            console.error("Download image failed. Out of memory at ImageData creation");
          }
        }
        w = _.toDataURL(n), l && (T.clearRect(0, 0, d, h), T.putImageData(A, 0, 0), T.globalCompositeOperation = P);
      }
      e && e(w);
    }, 16);
  }, t.prototype.downloadFullImage = function(e, n, i) {
    var a = this, o = this.get("group").getCanvasBBox(), s = o.height, u = o.width, f = this.get("renderer"), l = Nr('<div id="virtual-image"></div>'), c = document.querySelector(".g6-graph-watermarker"), h = i ? i.backgroundColor : void 0, d = i ? i.padding : void 0;
    d ? At(d) && (d = [d, d, d, d]) : d = [0, 0, 0, 0];
    var v = s + d[0] + d[2], p = u + d[1] + d[3];
    if (c) {
      var g = this.get("graphWaterMarker").cfg || {}, y = g.width, b = g.height;
      v = Math.ceil(v / b) * b, p = Math.ceil(p / y) * y;
    }
    var m = {
      container: l,
      height: v,
      width: p
    }, x = f === "svg" ? new gc(m) : new po(m), _ = this.get("group"), w = _.clone(), E = vr(w.getMatrix());
    E || (E = [1, 0, 0, 0, 1, 0, 0, 0, 1]);
    var M = (o.maxX + o.minX) / 2, C = (o.maxY + o.minY) / 2;
    E = TO(E, [["t", -M, -C], ["t", u / 2 + d[3], s / 2 + d[0]]]), w.resetMatrix(), w.setMatrix(E), x.add(w);
    var S = x.get("el");
    n || (n = "image/png"), this.asyncToDataUrl(n, h, function(A) {
      var T = document.createElement("a"), P = (e || "graph") + (f === "svg" ? ".svg" : ".".concat(n.split("/")[1]));
      a.dataURLToImage(A, f, T, P);
      var k = document.createEvent("MouseEvents");
      k.initEvent("click", !1, !1), T.dispatchEvent(k);
    }, p, v, S);
  }, t.prototype.downloadImage = function(e, n, i) {
    var a = this, o = this;
    o.stopAnimate();
    var s = o.get("canvas"), u = s.getRenderer();
    n || (n = "image/png");
    var f = (e || "graph") + (u === "svg" ? ".svg" : n.split("/")[1]), l = document.createElement("a");
    o.asyncToDataUrl(n, i, function(c) {
      a.dataURLToImage(c, u, l, f);
      var h = document.createEvent("MouseEvents");
      h.initEvent("click", !1, !1), l.dispatchEvent(h);
    });
  }, t.prototype.dataURLToImage = function(e, n, i, a) {
    if (!e || e === "data:") {
      console.error("Download image failed. The graph is too large or there is invalid attribute values in graph items");
      return;
    }
    if (typeof window < "u")
      if (window.Blob && window.URL && n !== "svg") {
        var o = e.split(","), s = "";
        if (o && o.length > 0) {
          var u = o[0].match(/:(.*?);/);
          u && u.length >= 2 && (s = u[1]);
        }
        for (var f = atob(o[1]), l = f.length, c = new Uint8Array(l); l--; )
          c[l] = f.charCodeAt(l);
        var h = new Blob([c], {
          type: s
        });
        window.navigator.msSaveBlob ? window.navigator.msSaveBlob(h, a) : i.addEventListener("click", function() {
          i.download = a, i.href = window.URL.createObjectURL(h);
        });
      } else
        i.addEventListener("click", function() {
          i.download = a, i.href = e;
        });
  }, t.prototype.addPlugin = function(e) {
    var n = this;
    e.destroyed || (n.get("plugins").push(e), e.initPlugin(n));
  }, t.prototype.removePlugin = function(e) {
    var n = this.get("plugins"), i = n.indexOf(e);
    i >= 0 && (e.destroyPlugin(), n.splice(i, 1));
  }, t.prototype.setImageWaterMarker = function(e, n) {
    e === void 0 && (e = lu.waterMarkerImage);
    var i = this.get("container");
    Qe(i) && (i = document.getElementById(i)), i.style.position || (i.style.position = "relative");
    var a = this.get("graphWaterMarker"), o = kr({}, lu.imageWaterMarkerConfig, n), s = o.width, u = o.height, f = o.compatible, l = o.image;
    if (!a) {
      var c = {
        container: i,
        width: s,
        height: u,
        capture: !1
      }, h = this.get("pixelRatio");
      h && (c.pixelRatio = h), a = new po(c), this.set("graphWaterMarker", a);
    }
    a.get("el").style.display = "none";
    var d = a.get("context"), v = l.rotate, p = l.x, g = l.y;
    d.rotate(-v * Math.PI / 180);
    var y = new Image();
    y.crossOrigin = "anonymous", y.src = e, y.onload = function() {
      if (d.drawImage(y, p, g, l.width, l.height), d.rotate(v * Math.PI / 180), f)
        i.style.cssText = "background-image: url(".concat(a.get("el").toDataURL("image/png"), ");background-repeat:repeat;");
      else {
        var b = document.querySelector(".g6-graph-watermarker");
        b || (b = document.createElement("div"), b.className = "g6-graph-watermarker"), b.className = "g6-graph-watermarker", a.destroyed || (b.style.cssText = "background-image: url(".concat(a.get("el").toDataURL("image/png"), ");background-repeat:repeat;position:absolute;top:0;bottom:0;left:0;right:0;pointer-events:none;z-index:-1;"), i.appendChild(b));
      }
    };
  }, t.prototype.setTextWaterMarker = function(e, n) {
    var i = this.get("container");
    Qe(i) && (i = document.getElementById(i)), i.style.position || (i.style.position = "relative");
    var a = this.get("graphWaterMarker"), o = kr({}, lu.textWaterMarkerConfig, n), s = o.width, u = o.height, f = o.compatible, l = o.text;
    if (!a) {
      var c = {
        container: i,
        width: s,
        height: u,
        capture: !1
      }, h = this.get("pixelRatio");
      h && (c.pixelRatio = h), a = new po(c), this.set("graphWaterMarker", a);
    }
    a.get("el").style.display = "none";
    var d = a.get("context"), v = l.rotate, p = l.fill, g = l.fontFamily, y = l.fontSize, b = l.baseline, m = l.x, x = l.y, _ = l.lineHeight;
    d.rotate(-v * Math.PI / 180), d.font = "".concat(y, "px ").concat(g), d.fillStyle = p, d.textBaseline = b;
    for (var w = e.length - 1; w >= 0; w--)
      d.fillText(e[w], m, x + w * _);
    if (d.rotate(v * Math.PI / 180), f)
      i.style.cssText = "background-image: url(".concat(a.get("el").toDataURL("image/png"), ");background-repeat:repeat;");
    else {
      var E = document.querySelector(".g6-graph-watermarker");
      E || (E = document.createElement("div"), E.className = "g6-graph-watermarker"), E.style.cssText = "background-image: url(".concat(a.get("el").toDataURL("image/png"), ");background-repeat:repeat;position:absolute;top:0;bottom:0;left:0;right:0;pointer-events:none;z-index:99;"), i.appendChild(E);
    }
  }, t.prototype.destroy = function() {
    var e, n, i, a;
    Se(this.get("plugins"), function(l) {
      l.destroyPlugin();
    });
    var o = this.get("tooltips");
    if (o)
      for (var s = 0; s < o.length; s++) {
        var u = o[s];
        if (!!u) {
          var f = u.parentElement;
          !f || f.removeChild(u);
        }
      }
    (e = this.get("eventController")) === null || e === void 0 || e.destroy(), (n = this.get("layoutController")) === null || n === void 0 || n.destroy(), (i = this.get("graphWaterMarker")) === null || i === void 0 || i.destroy(), (a = document.querySelector(".g6-graph-watermarker")) === null || a === void 0 || a.remove(), r.prototype.destroy.call(this);
  }, t;
}($N), dge = No.radialLayout, vge = No.traverseTree, pge = function(r) {
  Ht(t, r);
  function t(e) {
    var n = r.call(this, e) || this;
    return n.layoutAnimating = !1, n.set("removeList", []), n.set("layoutMethod", n.getLayout()), n;
  }
  return t.prototype.getLayout = function() {
    var e = this.get("layout");
    return e ? typeof e == "function" ? e : (e.type || (e.type = "dendrogram"), e.direction || (e.direction = "TB"), e.radial ? function(n) {
      var i = _p[e.type](n, e);
      return dge(i), i;
    } : function(n) {
      return _p[e.type](n, e);
    }) : null;
  }, t.indexOfChild = function(e, n) {
    var i = -1;
    return Se(e, function(a, o) {
      if (n === a.id)
        return i = o, !1;
    }), i;
  }, t.prototype.getDefaultCfg = function() {
    var e = r.prototype.getDefaultCfg.call(this);
    return e.animate = !0, e;
  }, t.prototype.innerAddChild = function(e, n, i) {
    var a = this, o = e.data;
    o && (o.x = e.x, o.y = e.y, o.depth = e.depth);
    var s = a.addItem("node", o, !1);
    if (n) {
      if (s.set("parent", n), i) {
        var u = n.get("originAttrs");
        if (u)
          s.set("originAttrs", u);
        else {
          var f = n.getModel();
          s.set("originAttrs", {
            x: f.x,
            y: f.y
          });
        }
      }
      var l = n.get("children");
      l ? l.push(s) : n.set("children", [s]), a.addItem("edge", {
        source: n.get("id"),
        target: s.get("id"),
        id: "".concat(n.get("id"), ":").concat(s.get("id"))
      }, !1);
    }
    return Se(e.children || [], function(c) {
      a.innerAddChild(c, s, i);
    }), a.emit("afteraddchild", {
      item: s,
      parent: n
    }), s;
  }, t.prototype.innerUpdateChild = function(e, n, i) {
    var a = this, o = a.findById(e.id);
    if (!o) {
      a.innerAddChild(e, n, i);
      return;
    }
    Se(e.children || [], function(v) {
      a.innerUpdateChild(v, o, i);
    });
    var s = o.get("children");
    if (s) {
      var u = s.length;
      if (u > 0)
        for (var f = s.length - 1; f >= 0; f--) {
          var l = s[f].getModel();
          t.indexOfChild(e.children || [], l.id) === -1 && (a.innerRemoveChild(l.id, {
            x: e.x,
            y: e.y
          }, i), s.splice(f, 1));
        }
    }
    var c, h;
    o.get("originAttrs") && (c = o.get("originAttrs").x, h = o.get("originAttrs").y);
    var d = o.getModel();
    i && o.set("originAttrs", {
      x: d.x,
      y: d.y
    }), o.set("model", e.data), (c !== e.x || h !== e.y) && o.updatePosition({
      x: e.x,
      y: e.y
    });
  }, t.prototype.innerRemoveChild = function(e, n, i) {
    var a = this, o = a.findById(e);
    if (!!o)
      if (Se(o.get("children"), function(u) {
        a.innerRemoveChild(u.getModel().id, n, i);
      }), i) {
        var s = o.getModel();
        o.set("to", n), o.set("originAttrs", {
          x: s.x,
          y: s.y
        }), a.get("removeList").push(o);
      } else
        a.removeItem(o, !1);
  }, t.prototype.changeData = function(e) {
    var n = this;
    this.getNodes().map(function(i) {
      return n.clearItemStates(i);
    }), this.getEdges().map(function(i) {
      return n.clearItemStates(i);
    }), e ? (n.data(e), n.render()) : n.layout(this.get("fitView"));
  }, t.prototype.changeLayout = function(e) {
    console.warn("Please call updateLayout instead of changeLayout. changeLayout will be discarded soon");
    var n = this;
    n.updateLayout(e);
  }, t.prototype.updateLayout = function(e) {
    var n = this;
    if (!e) {
      console.warn("layout cannot be null");
      return;
    }
    n.set("layout", e), n.set("layoutMethod", n.getLayout()), n.layout();
  }, t.prototype.refreshLayout = function(e) {
    console.warn("Please call layout instead of refreshLayout. refreshLayout will be discarded soon");
    var n = this;
    n.layout(e);
  }, t.prototype.layout = function(e) {
    var n = this, i = n.get("data"), a = n.get("layoutMethod"), o = a ? a(i, n.get("layout")) : i, s = n.get("animate");
    if (n.emit("beforerefreshlayout", {
      data: i,
      layoutData: o
    }), n.emit("beforelayout"), n.innerUpdateChild(o, void 0, s), e) {
      var u = n.get("viewController");
      u.fitView();
    }
    s ? n.layoutAnimate(o) : (n.refresh(), n.paint()), n.emit("afterrefreshlayout", {
      data: i,
      layoutData: o
    }), n.emit("afterlayout");
  }, t.prototype.addChild = function(e, n) {
    var i = this;
    i.emit("beforeaddchild", {
      model: e,
      parent: n
    }), Qe(n) || (n = n.get("id"));
    var a = i.findDataById(n);
    a && (a.children || (a.children = []), a.children.push(e), i.changeData());
  }, t.prototype.updateChildren = function(e, n) {
    var i = this;
    if (!n || !i.findById(n)) {
      console.warn("Update children failed! There is no node with id '".concat(n, "'"));
      return;
    }
    var a = i.findDataById(n);
    a.children = e, i.changeData();
  }, t.prototype.updateChild = function(e, n) {
    var i = this;
    if (!n || !i.findById(n)) {
      i.changeData(e);
      return;
    }
    var a = i.findDataById(n), o = i.findById(e.id);
    if (a.children || (a.children = []), !o)
      a.children.push(e);
    else {
      var s = t.indexOfChild(a.children, e.id);
      a.children[s] = e;
    }
    i.changeData();
  }, t.prototype.removeChild = function(e) {
    var n = this, i = n.findById(e);
    if (!!i) {
      var a = i.get("parent");
      if (a && !a.destroyed) {
        var o = n.findDataById(a.get("id")), s = o && o.children || [], u = i.getModel(), f = t.indexOfChild(s, u.id);
        s.splice(f, 1);
      }
      n.changeData();
    }
  }, t.prototype.findDataById = function(e, n) {
    var i = this;
    if (n || (n = i.get("data")), e === n.id)
      return n;
    var a = null;
    return Se(n.children || [], function(o) {
      if (o.id === e)
        return a = o, !1;
      if (a = i.findDataById(e, o), a)
        return !1;
    }), a;
  }, t.prototype.layoutAnimate = function(e, n) {
    var i = this, a = this.get("animateCfg");
    i.emit("beforeanimate", {
      data: e
    }), i.getEdges().forEach(function(o) {
      var s = o.get("model");
      s.sourceAnchor || (s.sourceAnchor = o.get("sourceAnchorIndex"));
    }), this.get("canvas").animate(function(o) {
      vge(e, function(s) {
        var u = i.findById(s.id);
        if (u) {
          var f = u.get("originAttrs"), l = u.get("model");
          if (f || (f = {
            x: l.x,
            y: l.y
          }, u.set("originAttrs", f)), n) {
            var c = n(u, o, f, e);
            u.set("model", Object.assign(l, c));
          } else
            l.x = f.x + (s.x - f.x) * o, l.y = f.y + (s.y - f.y) * o;
        }
        return !0;
      }), Se(i.get("removeList"), function(s) {
        var u = s.getModel(), f = s.get("originAttrs"), l = s.get("to");
        u.x = f.x + (l.x - f.x) * o, u.y = f.y + (l.y - f.y) * o;
      }), i.refreshPositions();
    }, {
      duration: a.duration,
      easing: a.ease,
      callback: function() {
        Se(i.getNodes(), function(s) {
          s.set("originAttrs", null);
        }), Se(i.get("removeList"), function(s) {
          i.removeItem(s);
        }), i.set("removeList", []), a.callback && a.callback(), i.emit("afteranimate", {
          data: e
        });
      },
      delay: a.delay
    });
  }, t.prototype.stopLayoutAnimate = function() {
    this.get("canvas").stopAnimate(), this.emit("layoutanimateend", {
      data: this.get("data")
    }), this.layoutAnimating = !1;
  }, t.prototype.isLayoutAnimating = function() {
    return this.layoutAnimating;
  }, t.prototype.render = function() {
    var e = this, n = e.get("data");
    if (!n || !Xn(n) || !Object.keys(n).length)
      throw new Error("data must be defined first");
    e.clear(), e.emit("beforerender"), e.layout(this.get("fitView")), e.emit("afterrender");
  }, t.prototype.save = function() {
    return this.get("data");
  }, t;
}(J5), gge = function() {
  function r(t) {
    this._cfgs = kr(this.getDefaultCfgs(), t), this._events = {}, this.destroyed = !1;
  }
  return r.prototype.getDefaultCfgs = function() {
    return {};
  }, r.prototype.initPlugin = function(t) {
    var e = this;
    e.set("graph", t);
    var n = e.getEvents(), i = {};
    Se(n, function(a, o) {
      var s = If(e, a);
      i[o] = s, t.on(o, s);
    }), this._events = i, this.init();
  }, r.prototype.getEvents = function() {
    return {};
  }, r.prototype.get = function(t) {
    var e;
    return (e = this._cfgs) === null || e === void 0 ? void 0 : e[t];
  }, r.prototype.set = function(t, e) {
    this._cfgs[t] = e;
  }, r.prototype.destroy = function() {
  }, r.prototype.destroyPlugin = function() {
    this.destroy();
    var t = this.get("graph"), e = this._events;
    Se(e, function(n, i) {
      t.off(i, n);
    }), this._events = null, this._cfgs = null, this.destroyed = !0;
  }, r;
}();
const hi = gge;
var yge = globalThis && globalThis.__extends || function() {
  var r = function(e, n) {
    return r = Object.setPrototypeOf || {
      __proto__: []
    } instanceof Array && function(i, a) {
      i.__proto__ = a;
    } || function(i, a) {
      for (var o in a)
        Object.prototype.hasOwnProperty.call(a, o) && (i[o] = a[o]);
    }, r(e, n);
  };
  return function(t, e) {
    if (typeof e != "function" && e !== null)
      throw new TypeError("Class extends value " + String(e) + " is not a constructor or null");
    r(t, e);
    function n() {
      this.constructor = t;
    }
    t.prototype = e === null ? Object.create(e) : (n.prototype = e.prototype, new n());
  };
}(), AO = "url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PHBhdHRlcm4gaWQ9ImdyaWQiIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgcGF0dGVyblVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+PHBhdGggZD0iTSAwIDEwIEwgNDAgMTAgTSAxMCAwIEwgMTAgNDAgTSAwIDIwIEwgNDAgMjAgTSAyMCAwIEwgMjAgNDAgTSAwIDMwIEwgNDAgMzAgTSAzMCAwIEwgMzAgNDAiIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2UwZTBlMCIgb3BhY2l0eT0iMC4yIiBzdHJva2Utd2lkdGg9IjEiLz48cGF0aCBkPSJNIDQwIDAgTCAwIDAgMCA0MCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjZTBlMGUwIiBzdHJva2Utd2lkdGg9IjEiLz48L3BhdHRlcm4+PC9kZWZzPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9InVybCgjZ3JpZCkiLz48L3N2Zz4=)", mge = function(r) {
  yge(t, r);
  function t(e) {
    return r.call(this, e) || this;
  }
  return t.prototype.getDefaultCfgs = function() {
    return {
      img: AO,
      follow: !0
    };
  }, t.prototype.init = function() {
    var e = this.get("graph"), n = e.get("container"), i = e.get("canvas").get("el"), a = this.get("img") || AO;
    a.includes("url(") || (a = 'url("'.concat(a, '")'));
    var o = Nr(`<div class='g6-grid-container' style="position:absolute;overflow:hidden;z-index: -1;"></div>`), s = Nr(`<div
        class='g6-grid'
        style='position:absolute;
        background-image: `.concat(a, `;
        user-select: none
        '></div>`));
    this.set("container", o), this.set("gridContainer", s), this.positionInit(), o.appendChild(s), n.insertBefore(o, i);
  }, t.prototype.positionInit = function() {
    var e = this.get("graph"), n = e.get("minZoom"), i = e.get("width"), a = e.get("height");
    ar(this.get("container"), {
      width: "".concat(i, "px"),
      height: "".concat(a, "px")
    });
    var o = i * 80 / n, s = a * 80 / n;
    ar(this.get("gridContainer"), {
      width: "".concat(o, "px"),
      height: "".concat(s, "px"),
      left: "-".concat(o / 2, "px"),
      top: "-".concat(s / 2, "px")
    });
  }, t.prototype.getEvents = function() {
    return {
      viewportchange: "updateGrid"
    };
  }, t.prototype.updateGrid = function(e) {
    var n = this.get("gridContainer"), i = e.matrix;
    i || (i = [1, 0, 0, 0, 1, 0, 0, 0, 1]);
    var a = this.get("follow"), o = "matrix(".concat(i[0], ", ").concat(i[1], ", ").concat(i[3], ", ").concat(i[4], ", ").concat(a ? i[6] : "0", ", ").concat(a ? i[7] : "0", ")");
    ar(n, {
      transform: o
    });
  }, t.prototype.getContainer = function() {
    return this.get("container");
  }, t.prototype.destroy = function() {
    var e = this.get("graph"), n = e.get("container"), i = this.get("container");
    n.removeChild(i);
  }, t;
}(hi);
const bge = mge;
var sl = { exports: {} }, IO = [], ql = [], xge = "insert-css: You need to provide a CSS string. Usage: insertCss(cssString[, options]).";
function e4(r, t) {
  if (t = t || {}, r === void 0)
    throw new Error(xge);
  var e = t.prepend === !0 ? "prepend" : "append", n = t.container !== void 0 ? t.container : document.querySelector("head"), i = IO.indexOf(n);
  i === -1 && (i = IO.push(n) - 1, ql[i] = {});
  var a;
  return ql[i] !== void 0 && ql[i][e] !== void 0 ? a = ql[i][e] : (a = ql[i][e] = _ge(), e === "prepend" ? n.insertBefore(a, n.childNodes[0]) : n.appendChild(a)), r.charCodeAt(0) === 65279 && (r = r.substr(1, r.length)), a.styleSheet ? a.styleSheet.cssText += r : a.textContent += r, a;
}
function _ge() {
  var r = document.createElement("style");
  return r.setAttribute("type", "text/css"), r;
}
sl.exports = e4;
sl.exports.insertCss = e4;
var wge = globalThis && globalThis.__extends || function() {
  var r = function(e, n) {
    return r = Object.setPrototypeOf || {
      __proto__: []
    } instanceof Array && function(i, a) {
      i.__proto__ = a;
    } || function(i, a) {
      for (var o in a)
        Object.prototype.hasOwnProperty.call(a, o) && (i[o] = a[o]);
    }, r(e, n);
  };
  return function(t, e) {
    if (typeof e != "function" && e !== null)
      throw new TypeError("Class extends value " + String(e) + " is not a constructor or null");
    r(t, e);
    function n() {
      this.constructor = t;
    }
    t.prototype = e === null ? Object.create(e) : (n.prototype = e.prototype, new n());
  };
}();
typeof document < "u" && sl.exports(`
  .g6-component-contextmenu {
    border: 1px solid #e2e2e2;
    border-radius: 4px;
    font-size: 12px;
    color: #545454;
    background-color: rgba(255, 255, 255, 0.9);
    padding: 10px 8px;
    box-shadow: rgb(174, 174, 174) 0px 0px 10px;
  }
  .g6-contextmenu-ul {
    padding: 0;
    margin: 0;
    list-style: none;
  }

`);
var Ege = function(r) {
  wge(t, r);
  function t(e) {
    return r.call(this, e) || this;
  }
  return t.prototype.getDefaultCfgs = function() {
    return {
      offsetX: 6,
      offsetY: 6,
      handleMenuClick: void 0,
      getContent: function(n) {
        return `
          <ul class='g6-contextmenu-ul'>
            <li>\u83DC\u5355\u98791</li>
            <li>\u83DC\u5355\u98792</li>
          </ul>
        `;
      },
      shouldBegin: function(n) {
        return !0;
      },
      onHide: function() {
        return !0;
      },
      itemTypes: ["node", "edge", "combo"],
      trigger: "contextmenu"
    };
  }, t.prototype.getEvents = function() {
    return this.get("trigger") === "click" ? {
      click: "onMenuShow",
      touchend: "onMenuShow"
    } : {
      contextmenu: "onMenuShow"
    };
  }, t.prototype.init = function() {
    var e = this.get("className"), n = Nr("<div class=".concat(e || "g6-component-contextmenu", "></div>"));
    ar(n, {
      top: "0px",
      position: "absolute",
      visibility: "hidden"
    });
    var i = this.get("container");
    i || (i = this.get("graph").get("container")), Qe(i) && (i = document.getElementById(i)), i.appendChild(n), this.set("menu", n);
  }, t.prototype.onMenuShow = function(e) {
    var n = this;
    e.preventDefault();
    var i = this.get("itemTypes");
    if (e.item) {
      if (e.item && e.item.getType && i.indexOf(e.item.getType()) === -1) {
        n.onMenuHide();
        return;
      }
    } else if (i.indexOf("canvas") === -1) {
      n.onMenuHide();
      return;
    }
    var a = this.get("shouldBegin");
    if (!!a(e)) {
      var o = this.get("menu"), s = this.get("getContent"), u = this.get("graph"), f = s(e, u);
      Qe(f) ? o.innerHTML = f : o.innerHTML = f.outerHTML, this.removeMenuEventListener();
      var l = this.get("handleMenuClick");
      if (l) {
        var c = function(M) {
          l(M.target, e.item, u);
        };
        this.set("handleMenuClickWrapper", c), o.addEventListener("click", c);
      }
      var h = u.get("width"), d = u.get("height"), v = o.getBoundingClientRect(), p = this.get("offsetX") || 0, g = this.get("offsetY") || 0, y = u.getContainer().offsetTop, b = u.getContainer().offsetLeft, m = e.canvasX + b + p, x = e.canvasY + y + g;
      m + v.width > h && (m = e.canvasX - v.width - p + b), x + v.height > d && (x = e.canvasY - v.height - g + y), ar(o, {
        top: "".concat(x, "px"),
        left: "".concat(m, "px"),
        visibility: "visible"
      });
      var _ = this.get("trigger") === "click", w = function(M) {
        if (_) {
          _ = !1;
          return;
        }
        n.onMenuHide();
      };
      document.body.addEventListener("click", w), this.set("handler", w);
    }
  }, t.prototype.removeMenuEventListener = function() {
    var e = this.get("handleMenuClickWrapper"), n = this.get("handler");
    if (e) {
      var i = this.get("menu");
      i.removeEventListener("click", e), this.set("handleMenuClickWrapper", null);
    }
    n && document.body.removeEventListener("click", n);
  }, t.prototype.onMenuHide = function() {
    var e = this.get("menu");
    e && ar(e, {
      visibility: "hidden"
    }), this.removeMenuEventListener();
  }, t.prototype.destroy = function() {
    var e = this.get("menu");
    if (this.removeMenuEventListener(), e) {
      var n = this.get("container");
      n || (n = this.get("graph").get("container")), Qe(n) && (n = document.getElementById(n)), n.removeChild(e);
    }
  }, t;
}(hi);
const Sge = Ege;
var Mge = globalThis && globalThis.__extends || function() {
  var r = function(e, n) {
    return r = Object.setPrototypeOf || {
      __proto__: []
    } instanceof Array && function(i, a) {
      i.__proto__ = a;
    } || function(i, a) {
      for (var o in a)
        Object.prototype.hasOwnProperty.call(a, o) && (i[o] = a[o]);
    }, r(e, n);
  };
  return function(t, e) {
    if (typeof e != "function" && e !== null)
      throw new TypeError("Class extends value " + String(e) + " is not a constructor or null");
    r(t, e);
    function n() {
      this.constructor = t;
    }
    t.prototype = e === null ? Object.create(e) : (n.prototype = e.prototype, new n());
  };
}(), I1 = globalThis && globalThis.__assign || function() {
  return I1 = Object.assign || function(r) {
    for (var t, e = 1, n = arguments.length; e < n; e++) {
      t = arguments[e];
      for (var i in t)
        Object.prototype.hasOwnProperty.call(t, i) && (r[i] = t[i]);
    }
    return r;
  }, I1.apply(this, arguments);
}, PO = Math.max, Cge = $i, Tge = "default", Age = "keyShape", Ige = "delegate", OO = "svg", Pge = function(r) {
  Mge(t, r);
  function t(e) {
    var n = r.call(this, e) || this;
    return n.handleUpdateCanvas = Jc(function(i) {
      var a = n;
      a.destroyed || a.updateCanvas();
    }, 100, !1), n;
  }
  return t.prototype.getDefaultCfgs = function() {
    return {
      container: null,
      className: "g6-minimap",
      viewportClassName: "g6-minimap-viewport",
      type: "default",
      padding: 50,
      size: [200, 120],
      delegateStyle: {
        fill: "#40a9ff",
        stroke: "#096dd9"
      },
      refresh: !0
    };
  }, t.prototype.getEvents = function() {
    return {
      beforepaint: "updateViewport",
      beforeanimate: "disableRefresh",
      afteranimate: "enableRefresh",
      viewportchange: "disableOneRefresh"
    };
  }, t.prototype.disableRefresh = function() {
    this.set("refresh", !1);
  }, t.prototype.enableRefresh = function() {
    this.set("refresh", !0), this.updateCanvas();
  }, t.prototype.disableOneRefresh = function() {
    this.set("viewportChange", !0);
  }, t.prototype.initViewport = function() {
    var e = this, n = this._cfgs, i = n.size, a = n.graph;
    if (!this.destroyed) {
      var o = this.get("canvas"), s = o.get("container"), u = Nr(`
      <div
        class=`.concat(n.viewportClassName, `
        style='position:absolute;
          left:0;
          top:0;
          box-sizing:border-box;
          outline: 2px solid #1980ff;
          cursor:move'
        draggable=true
      </div>`)), f = navigator.userAgent.toLowerCase().indexOf("firefox") > -1, l = 0, c = 0, h = !1, d = 0, v = 0, p = 0, g = 0, y = 0, b = 0;
      u.addEventListener("dragstart", function(m) {
        var x, _;
        if (m.dataTransfer) {
          var w = new Image();
          w.src = "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' %3E%3Cpath /%3E%3C/svg%3E", (_ = (x = m.dataTransfer).setDragImage) === null || _ === void 0 || _.call(x, w, 0, 0);
          try {
            m.dataTransfer.setData("text/html", "view-port-minimap");
          } catch {
            m.dataTransfer.setData("text", "view-port-minimap");
          }
        }
        if (n.refresh = !1, m.target === u) {
          var E = u.style;
          d = parseInt(E.left, 10), v = parseInt(E.top, 10), p = parseInt(E.width, 10), g = parseInt(E.height, 10), !(p > i[0] || g > i[1]) && (b = a.getZoom(), y = e.get("ratio"), h = !0, l = m.clientX, c = m.clientY);
        }
      }, !1), u.addEventListener(f ? "dragover" : "drag", function(m) {
        if (!(!h || Tt(m.clientX) || Tt(m.clientY))) {
          var x = l - m.clientX, _ = c - m.clientY;
          (d - x < 0 || d - x + p >= i[0]) && (x = 0), (v - _ < 0 || v - _ + g >= i[1]) && (_ = 0), d -= x, v -= _, ar(u, {
            left: "".concat(d, "px"),
            top: "".concat(v, "px")
          }), a.translate(x * b / y, _ * b / y), l = m.clientX, c = m.clientY;
        }
      }, !1), u.addEventListener("dragend", function() {
        h = !1, n.refresh = !0;
      }, !1), this.set("viewport", u), s.appendChild(u);
    }
  }, t.prototype.updateViewport = function() {
    if (!this.destroyed) {
      var e = this.get("ratio");
      this.get("dx"), this.get("dy");
      var n = this.get("totaldx"), i = this.get("totaldy"), a = this.get("graph"), o = this.get("size"), s = a.get("width"), u = a.get("height"), f = a.getPointByCanvas(0, 0), l = a.getPointByCanvas(s, u), c = this.get("viewport");
      c || this.initViewport();
      var h = (l.x - f.x) * e, d = (l.y - f.y) * e, v = f.x * e + n, p = f.y * e + i, g = v + h, y = p + d;
      v < 0 && (h += v, v = 0), g > o[0] && (h = h - (g - o[0])), p < 0 && (d += p, p = 0), y > o[1] && (d = d - (y - o[1])), this.set("ratio", e);
      var b = "".concat(v, "px"), m = "".concat(p, "px");
      ar(c, {
        left: b,
        top: m,
        width: "".concat(h, "px"),
        height: "".concat(d, "px")
      });
    }
  }, t.prototype.updateGraphShapes = function() {
    var e = this._cfgs.graph, n = this.get("canvas"), i = e.get("group");
    if (!i.destroyed) {
      var a = i.clone();
      a.resetMatrix(), n.clear(), n.add(a);
      var o = e.get("renderer");
      o === OO && this.updateVisible(a);
    }
  }, t.prototype.updateVisible = function(e) {
    var n = this;
    if (!e.isGroup() && !e.get("visible"))
      e.hide();
    else {
      var i = e.get("children");
      if (!i || !i.length)
        return;
      i.forEach(function(a) {
        a.get("visible") || a.hide(), n.updateVisible(a);
      });
    }
  }, t.prototype.updateKeyShapes = function() {
    var e = this, n = this._cfgs.graph, i = this.get("canvas"), a = i.get("children")[0] || i.addGroup();
    Se(n.getEdges(), function(u) {
      e.updateOneEdgeKeyShape(u, a);
    }), Se(n.getNodes(), function(u) {
      e.updateOneNodeKeyShape(u, a);
    });
    var o = n.getCombos();
    if (o && o.length) {
      var s = a.find(function(u) {
        return u.get("name") === "comboGroup";
      }) || a.addGroup({
        name: "comboGroup"
      });
      setTimeout(function() {
        e.destroyed || (Se(o, function(u) {
          e.updateOneComboKeyShape(u, s);
        }), s == null || s.sort(), s == null || s.toBack(), e.updateCanvas());
      }, 250);
    }
    this.clearDestroyedShapes();
  }, t.prototype.updateOneComboKeyShape = function(e, n) {
    if (!this.destroyed) {
      var i = this.get("itemMap") || {}, a = i[e.get("id")], o = e.getBBox(), s = e.get("keyShape").clone(), u = s.attr(), f = {
        x: o.centerX,
        y: o.centerY
      };
      a ? f = Object.assign(u, f) : (a = s, n.add(a));
      var l = a.get("type");
      (l === "rect" || l === "image") && (f.x = o.minX, f.y = o.minY), a.attr(f), e.isVisible() ? a.show() : a.hide(), a.exist = !0;
      var c = e.getModel().depth;
      isNaN(c) || a.set("zIndex", c), i[e.get("id")] = a, this.set("itemMap", i);
    }
  }, t.prototype.updateOneNodeKeyShape = function(e, n) {
    var i = this.get("itemMap") || {}, a = i[e.get("id")], o = e.getBBox(), s = e.get("keyShape").clone(), u = s.attr(), f = {
      x: o.centerX,
      y: o.centerY
    };
    a ? f = Object.assign(u, f) : (a = s, n.add(a));
    var l = a.get("type");
    (l === "rect" || l === "image") && (f.x = o.minX, f.y = o.minY), a.attr(f), e.isVisible() ? a.show() : a.hide(), a.exist = !0;
    var c = e.getModel().depth;
    isNaN(c) || a.set("zIndex", c), i[e.get("id")] = a, this.set("itemMap", i);
  }, t.prototype.updateDelegateShapes = function() {
    var e = this, n = this._cfgs.graph, i = this.get("canvas"), a = i.get("children")[0] || i.addGroup();
    Se(n.getEdges(), function(u) {
      e.updateOneEdgeKeyShape(u, a);
    }), Se(n.getNodes(), function(u) {
      e.updateOneNodeDelegateShape(u, a);
    });
    var o = n.getCombos();
    if (o && o.length) {
      var s = a.find(function(u) {
        return u.get("name") === "comboGroup";
      }) || a.addGroup({
        name: "comboGroup"
      });
      setTimeout(function() {
        e.destroyed || (Se(o, function(u) {
          e.updateOneComboKeyShape(u, s);
        }), s == null || s.sort(), s == null || s.toBack(), e.updateCanvas());
      }, 250);
    }
    this.clearDestroyedShapes();
  }, t.prototype.clearDestroyedShapes = function() {
    var e = this.get("itemMap") || {}, n = Object.keys(e);
    if (!(!n || n.length === 0))
      for (var i = n.length - 1; i >= 0; i--) {
        var a = e[n[i]], o = a.exist;
        a.exist = !1, o || (a.remove(), delete e[n[i]]);
      }
  }, t.prototype.updateOneEdgeKeyShape = function(e, n) {
    var i = this.get("itemMap") || {}, a = i[e.get("id")];
    if (a) {
      var o = e.get("keyShape").attr("path");
      a.attr("path", o);
    } else
      a = e.get("keyShape").clone(), n.add(a);
    e.isVisible() ? a.show() : a.hide(), a.exist = !0, i[e.get("id")] = a, this.set("itemMap", i);
  }, t.prototype.updateOneNodeDelegateShape = function(e, n) {
    var i = this.get("delegateStyle"), a = this.get("itemMap") || {}, o = a[e.get("id")], s = e.getBBox();
    if (o) {
      var u = {
        x: s.minX,
        y: s.minY,
        width: s.width,
        height: s.height
      };
      o.attr(u);
    } else
      o = n.addShape("rect", {
        attrs: I1({
          x: s.minX,
          y: s.minY,
          width: s.width,
          height: s.height
        }, i),
        name: "minimap-node-shape"
      });
    e.isVisible() ? o.show() : o.hide(), o.exist = !0, a[e.get("id")] = o, this.set("itemMap", a);
  }, t.prototype.init = function() {
    this.initContainer(), this.get("graph").on("afterupdateitem", this.handleUpdateCanvas), this.get("graph").on("afteritemstatechange", this.handleUpdateCanvas), this.get("graph").on("afteradditem", this.handleUpdateCanvas), this.get("graph").on("afterremoveitem", this.handleUpdateCanvas), this.get("graph").on("afterrender", this.handleUpdateCanvas), this.get("graph").on("afterlayout", this.handleUpdateCanvas);
  }, t.prototype.initContainer = function() {
    var e = this, n = e.get("graph"), i = e.get("size"), a = e.get("className"), o = e.get("container"), s = Nr("<div class='".concat(a, "' style='width: ").concat(i[0], "px; height: ").concat(i[1], "px; overflow: hidden'></div>"));
    Qe(o) && (o = document.getElementById(o)), o ? o.appendChild(s) : n.get("container").appendChild(s), e.set("container", s);
    var u = Nr('<div class="g6-minimap-container" style="position: relative;"></div>');
    s.appendChild(u), u.addEventListener("dragenter", function(c) {
      c.preventDefault();
    }), u.addEventListener("dragover", function(c) {
      c.preventDefault();
    });
    var f, l = n.get("renderer");
    l === OO ? f = new gc({
      container: u,
      width: i[0],
      height: i[1]
    }) : f = new po({
      container: u,
      width: i[0],
      height: i[1]
    }), e.set("canvas", f), e.updateCanvas();
  }, t.prototype.updateCanvas = function() {
    if (!this.destroyed) {
      var e = this.get("refresh");
      if (!!e) {
        var n = this.get("graph");
        if (!n.get("destroyed")) {
          this.get("viewportChange") && (this.set("viewportChange", !1), this.updateViewport());
          var i = this.get("size"), a = this.get("canvas"), o = this.get("type"), s = this.get("padding");
          if (!a.destroyed) {
            switch (o) {
              case Tge:
                this.updateGraphShapes();
                break;
              case Age:
                this.updateKeyShapes();
                break;
              case Ige:
                this.updateDelegateShapes();
                break;
            }
            var u = a.get("children")[0];
            if (!!u) {
              u.resetMatrix();
              var f = u.getCanvasBBox(), l = n.get("canvas").getCanvasBBox(), c = n.getZoom() || 1, h = l.width / c, d = l.height / c;
              Number.isFinite(f.width) && (h = PO(f.width, h), d = PO(f.height, d)), h += 2 * s, d += 2 * s;
              var v = Math.min(i[0] / h, i[1] / d), p = [1, 0, 0, 0, 1, 0, 0, 0, 1], g = 0, y = 0;
              Number.isFinite(f.minX) && (g = -f.minX), Number.isFinite(f.minY) && (y = -f.minY);
              var b = (i[0] - (h - 2 * s) * v) / 2, m = (i[1] - (d - 2 * s) * v) / 2;
              p = Cge(p, [
                ["t", g, y],
                ["s", v, v],
                ["t", b, m]
              ]), u.setMatrix(p), this.set("ratio", v), this.set("totaldx", b + g * v), this.set("totaldy", m + y * v), this.set("dx", b), this.set("dy", m), this.updateViewport();
            }
          }
        }
      }
    }
  }, t.prototype.getCanvas = function() {
    return this.get("canvas");
  }, t.prototype.getViewport = function() {
    return this.get("viewport");
  }, t.prototype.getContainer = function() {
    return this.get("container");
  }, t.prototype.destroy = function() {
    var e;
    (e = this.get("canvas")) === null || e === void 0 || e.destroy();
    var n = this.get("container");
    n != null && n.parentNode && n.parentNode.removeChild(n);
  }, t;
}(hi);
const Oge = Pge;
var Dge = globalThis && globalThis.__extends || function() {
  var r = function(e, n) {
    return r = Object.setPrototypeOf || {
      __proto__: []
    } instanceof Array && function(i, a) {
      i.__proto__ = a;
    } || function(i, a) {
      for (var o in a)
        Object.prototype.hasOwnProperty.call(a, o) && (i[o] = a[o]);
    }, r(e, n);
  };
  return function(t, e) {
    if (typeof e != "function" && e !== null)
      throw new TypeError("Class extends value " + String(e) + " is not a constructor or null");
    r(t, e);
    function n() {
      this.constructor = t;
    }
    t.prototype = e === null ? Object.create(e) : (n.prototype = e.prototype, new n());
  };
}();
function xa(r, t, e) {
  var n = r.x - t.x, i = r.y - t.y;
  return !e || Math.abs(n) > e || Math.abs(i) > e ? Math.sqrt(n * n + i * i) : e;
}
function kge(r, t) {
  return r.x * t.x + r.y * t.y;
}
function DO(r, t) {
  var e = (t.source.y - t.target.y) / (t.source.x - t.target.x), n = (e * e * t.source.x + e * (r.y - t.source.y) + r.x) / (e * e + 1), i = e * (n - t.source.x) + t.source.y;
  return {
    x: n,
    y: i
  };
}
var Lge = function(r) {
  Dge(t, r);
  function t(e) {
    return r.call(this, e) || this;
  }
  return t.prototype.getDefaultCfgs = function() {
    return {
      edgeBundles: [],
      edgePoints: [],
      K: 0.1,
      lambda: 0.1,
      divisions: 1,
      divRate: 2,
      cycles: 6,
      iterations: 90,
      iterRate: 0.6666667,
      bundleThreshold: 0.6,
      eps: 1e-6,
      onLayoutEnd: function() {
      },
      onTick: function() {
      }
    };
  }, t.prototype.init = function() {
    var e = this.get("graph"), n = this.get("onTick"), i = function() {
      n && n(), e.refreshPositions();
    };
    this.set("tick", i);
  }, t.prototype.bundling = function(e) {
    var n = this;
    if (n.set("data", e), !n.isTicking()) {
      var i = e.edges || [], a = e.nodes || [], o = {}, s = !1;
      if (a.forEach(function(x) {
        (x.x === null || !x.y === null || x.x === void 0 || !x.y === void 0) && (s = !0), o[x.id] = x;
      }), s)
        throw new Error("please layout the graph or assign x and y for nodes first");
      n.set("nodeIdMap", o);
      var u = n.get("divisions"), f = n.get("divRate"), l = n.divideEdges(u);
      n.set("edgePoints", l);
      var c = n.getEdgeBundles();
      n.set("edgeBundles", c);
      for (var h = n.get("cycles"), d = n.get("iterations"), v = n.get("iterRate"), p = n.get("lambda"), g = 0; g < h; g++) {
        for (var y = function(_) {
          var w = [];
          i.forEach(function(E, M) {
            if (E.source !== E.target) {
              var C = o[E.source], S = o[E.target];
              w[M] = n.getEdgeForces({
                source: C,
                target: S
              }, M, u, p);
              for (var A = 0; A < u + 1; A++)
                l[M][A].x += w[M][A].x, l[M][A].y += w[M][A].y;
            }
          });
        }, b = 0; b < d; b++)
          y(b);
        p = p / 2, u *= f, d *= v, l = n.divideEdges(u), n.set("edgePoints", l);
      }
      i.forEach(function(x, _) {
        x.source !== x.target && (x.type = "polyline", x.controlPoints = l[_].slice(1, l[_].length - 1));
      });
      var m = n.get("graph");
      m.refresh();
    }
  }, t.prototype.updateBundling = function(e) {
    var n = this, i = e.data;
    if (i && n.set("data", i), n.get("ticking") && n.set("ticking", !1), Object.keys(e).forEach(function(o) {
      n.set(o, e[o]);
    }), e.onTick) {
      var a = this.get("graph");
      n.set("tick", function() {
        e.onTick(), a.refresh();
      });
    }
    n.bundling(i);
  }, t.prototype.divideEdges = function(e) {
    var n = this, i = n.get("data").edges, a = n.get("nodeIdMap"), o = n.get("edgePoints");
    return (!o || o === void 0) && (o = []), i.forEach(function(s, u) {
      var f;
      (!o[u] || o[u] === void 0) && (o[u] = []);
      var l = a[s.source], c = a[s.target];
      if (e === 1)
        o[u].push({
          x: l.x,
          y: l.y
        }), o[u].push({
          x: 0.5 * (l.x + c.x),
          y: 0.5 * (l.y + c.y)
        }), o[u].push({
          x: c.x,
          y: c.y
        });
      else {
        var h = 0;
        !((f = o[u]) === null || f === void 0) && f.length ? h = n.getEdgeLength(o[u]) : h = xa({
          x: l.x,
          y: l.y
        }, {
          x: c.x,
          y: c.y
        });
        var d = h / (e + 1), v = d, p = [{
          x: l.x,
          y: l.y
        }];
        o[u].forEach(function(g, y) {
          if (y !== 0) {
            for (var b = xa(g, o[u][y - 1]); b > v; ) {
              var m = v / b, x = {
                x: o[u][y - 1].x,
                y: o[u][y - 1].y
              };
              x.x += m * (g.x - o[u][y - 1].x), x.y += m * (g.y - o[u][y - 1].y), p.push(x), b -= v, v = d;
            }
            v -= b;
          }
        }), p.push({
          x: c.x,
          y: c.y
        }), o[u] = p;
      }
    }), o;
  }, t.prototype.getEdgeLength = function(e) {
    var n = 0;
    return e.forEach(function(i, a) {
      a !== 0 && (n += xa(i, e[a - 1]));
    }), n;
  }, t.prototype.getEdgeBundles = function() {
    var e = this, n = e.get("data"), i = n.edges || [], a = e.get("bundleThreshold"), o = e.get("nodeIdMap"), s = e.get("edgeBundles");
    return s || (s = []), i.forEach(function(u, f) {
      (!s[f] || s[f] === void 0) && (s[f] = []);
    }), i.forEach(function(u, f) {
      var l = o[u.source], c = o[u.target];
      i.forEach(function(h, d) {
        if (!(d <= f)) {
          var v = o[h.source], p = o[h.target], g = e.getBundleScore({
            source: l,
            target: c
          }, {
            source: v,
            target: p
          });
          g >= a && (s[f].push(d), s[d].push(f));
        }
      });
    }), s;
  }, t.prototype.getBundleScore = function(e, n) {
    var i = this;
    e.vx = e.target.x - e.source.x, e.vy = e.target.y - e.source.y, n.vx = n.target.x - n.source.x, n.vy = n.target.y - n.source.y, e.length = xa({
      x: e.source.x,
      y: e.source.y
    }, {
      x: e.target.x,
      y: e.target.y
    }), n.length = xa({
      x: n.source.x,
      y: n.source.y
    }, {
      x: n.target.x,
      y: n.target.y
    });
    var a = i.getAngleScore(e, n), o = i.getScaleScore(e, n), s = i.getPositionScore(e, n), u = i.getVisibilityScore(e, n);
    return a * o * s * u;
  }, t.prototype.getAngleScore = function(e, n) {
    var i = kge({
      x: e.vx,
      y: e.vy
    }, {
      x: n.vx,
      y: n.vy
    });
    return i / (e.length * n.length);
  }, t.prototype.getScaleScore = function(e, n) {
    var i = (e.length + n.length) / 2, a = 2 / (i / Math.min(e.length, n.length) + Math.max(e.length, n.length) / i);
    return a;
  }, t.prototype.getPositionScore = function(e, n) {
    var i = (e.length + n.length) / 2, a = {
      x: (e.source.x + e.target.x) / 2,
      y: (e.source.y + e.target.y) / 2
    }, o = {
      x: (n.source.x + n.target.x) / 2,
      y: (n.source.y + n.target.y) / 2
    }, s = xa(a, o);
    return i / (i + s);
  }, t.prototype.getVisibilityScore = function(e, n) {
    var i = this.getEdgeVisibility(e, n), a = this.getEdgeVisibility(n, e);
    return i < a ? i : a;
  }, t.prototype.getEdgeVisibility = function(e, n) {
    var i = DO(n.source, e), a = DO(n.target, e), o = {
      x: (i.x + a.x) / 2,
      y: (i.y + a.y) / 2
    }, s = {
      x: (e.source.x + e.target.x) / 2,
      y: (e.source.y + e.target.y) / 2
    };
    return Math.max(0, 1 - 2 * xa(o, s) / xa(i, a));
  }, t.prototype.getEdgeForces = function(e, n, i, a) {
    for (var o = this, s = o.get("edgePoints"), u = o.get("K"), f = u / (xa(e.source, e.target) * (i + 1)), l = [{
      x: 0,
      y: 0
    }], c = 1; c < i; c++) {
      var h = {
        x: 0,
        y: 0
      }, d = o.getSpringForce({
        pre: s[n][c - 1],
        cur: s[n][c],
        next: s[n][c + 1]
      }, f), v = o.getElectrostaticForce(c, n);
      h.x = a * (d.x + v.x), h.y = a * (d.y + v.y), l.push(h);
    }
    return l.push({
      x: 0,
      y: 0
    }), l;
  }, t.prototype.getSpringForce = function(e, n) {
    var i = e.pre.x + e.next.x - 2 * e.cur.x, a = e.pre.y + e.next.y - 2 * e.cur.y;
    return i *= n, a *= n, {
      x: i,
      y: a
    };
  }, t.prototype.getElectrostaticForce = function(e, n) {
    var i = this, a = i.get("eps"), o = i.get("edgeBundles"), s = i.get("edgePoints"), u = o[n], f = {
      x: 0,
      y: 0
    };
    return u.forEach(function(l) {
      var c = {
        x: s[l][e].x - s[n][e].x,
        y: s[l][e].y - s[n][e].y
      };
      if (Math.abs(c.x) > a || Math.abs(c.y) > a) {
        var h = xa(s[l][e], s[n][e]), d = 1 / h;
        f.x += c.x * d, f.y += c.y * d;
      }
    }), f;
  }, t.prototype.isTicking = function() {
    return this.get("ticking");
  }, t.prototype.getSimulation = function() {
    return this.get("forceSimulation");
  }, t.prototype.destroy = function() {
    this.get("ticking") && this.getSimulation().stop(), r.prototype.destroy.call(this);
  }, t;
}(hi);
const Nge = Lge;
var Rge = globalThis && globalThis.__extends || function() {
  var r = function(e, n) {
    return r = Object.setPrototypeOf || {
      __proto__: []
    } instanceof Array && function(i, a) {
      i.__proto__ = a;
    } || function(i, a) {
      for (var o in a)
        Object.prototype.hasOwnProperty.call(a, o) && (i[o] = a[o]);
    }, r(e, n);
  };
  return function(t, e) {
    if (typeof e != "function" && e !== null)
      throw new TypeError("Class extends value " + String(e) + " is not a constructor or null");
    r(t, e);
    function n() {
      this.constructor = t;
    }
    t.prototype = e === null ? Object.create(e) : (n.prototype = e.prototype, new n());
  };
}(), P1 = globalThis && globalThis.__assign || function() {
  return P1 = Object.assign || function(r) {
    for (var t, e = 1, n = arguments.length; e < n; e++) {
      t = arguments[e];
      for (var i in t)
        Object.prototype.hasOwnProperty.call(t, i) && (r[i] = t[i]);
    }
    return r;
  }, P1.apply(this, arguments);
}, iv = 0.05, kO = {
  stroke: "#000",
  strokeOpacity: 0.8,
  lineWidth: 2,
  fillOpacity: 0.1,
  fill: "#ccc"
}, Bge = function(r) {
  Rge(t, r);
  function t(e) {
    return r.call(this, e) || this;
  }
  return t.prototype.getDefaultCfgs = function() {
    return {
      trigger: "mousemove",
      d: 1.5,
      r: 300,
      delegateStyle: vr(kO),
      showLabel: !1,
      maxD: 5,
      minD: 0,
      scaleRBy: "unset",
      scaleDBy: "unset",
      showDPercent: !0
    };
  }, t.prototype.getEvents = function() {
    var e;
    switch (this.get("trigger")) {
      case "click":
        e = {
          click: "magnify"
        };
        break;
      case "drag":
        e = {
          click: "createDelegate"
        };
        break;
      default:
        e = {
          mousemove: "magnify"
        };
        break;
    }
    return e;
  }, t.prototype.init = function() {
    var e = this, n = e.get("r");
    e.set("cachedMagnifiedModels", []), e.set("cachedOriginPositions", {}), e.set("r2", n * n);
    var i = e.get("d");
    e.set("molecularParam", (i + 1) * n);
  }, t.prototype.createDelegate = function(e) {
    var n = this, i = this, a = i.get("delegate");
    (!a || a.destroyed) && (i.magnify(e), a = i.get("delegate"), a.on("dragstart", function(o) {
      i.set("delegateCenterDiff", {
        x: a.attr("x") - o.x,
        y: a.attr("y") - o.y
      });
    }), a.on("drag", function(o) {
      i.magnify(o);
    }), this.get("scaleDBy") === "wheel" && a.on("mousewheel", function(o) {
      n.scaleDByWheel(o);
    }), this.get("scaleRBy") === "wheel" && a.on("mousewheel", function(o) {
      i.scaleRByWheel(o);
    }));
  }, t.prototype.scaleRByWheel = function(e) {
    var n = this;
    if (!(!e || !e.originalEvent)) {
      e.preventDefault && e.preventDefault();
      var i = n.get("graph"), a, o = n.get("delegate"), s = o ? {
        x: o.attr("x"),
        y: o.attr("y")
      } : void 0, u = s || i.getPointByClient(e.clientX, e.clientY);
      e.originalEvent.wheelDelta < 0 ? a = 1 - iv : a = 1 / (1 - iv);
      var f = n.get("maxR"), l = n.get("minR"), c = n.get("r");
      (c > (f || i.get("height")) && a > 1 || c < (l || i.get("height") * 0.05) && a < 1) && (a = 1), c *= a, n.set("r", c), n.set("r2", c * c);
      var h = n.get("d");
      n.set("molecularParam", (h + 1) * c), n.set("delegateCenterDiff", void 0), n.magnify(e, u);
    }
  }, t.prototype.scaleRByDrag = function(e) {
    var n = this;
    if (!!e) {
      var i = n.get("dragPrePos"), a = n.get("graph"), o, s = a.getPointByClient(e.clientX, e.clientY);
      e.x - i.x < 0 ? o = 1 - iv : o = 1 / (1 - iv);
      var u = n.get("maxR"), f = n.get("minR"), l = n.get("r");
      (l > (u || a.get("height")) && o > 1 || l < (f || a.get("height") * 0.05) && o < 1) && (o = 1), l *= o, n.set("r", l), n.set("r2", l * l);
      var c = n.get("d");
      n.set("molecularParam", (c + 1) * l), n.magnify(e, s), n.set("dragPrePos", {
        x: e.x,
        y: e.y
      });
    }
  }, t.prototype.scaleDByWheel = function(e) {
    var n = this;
    if (!(!e && !e.originalEvent)) {
      e.preventDefault && e.preventDefault();
      var i = 0;
      e.originalEvent.wheelDelta < 0 ? i = -0.1 : i = 0.1;
      var a = n.get("d"), o = a + i, s = n.get("maxD"), u = n.get("minD");
      if (o < s && o > u) {
        n.set("d", o);
        var f = n.get("r");
        n.set("molecularParam", (o + 1) * f);
        var l = n.get("delegate"), c = l ? {
          x: l.attr("x"),
          y: l.attr("y")
        } : void 0;
        n.set("delegateCenterDiff", void 0), n.magnify(e, c);
      }
    }
  }, t.prototype.scaleDByDrag = function(e) {
    var n = this, i = n.get("dragPrePos"), a = e.x - i.x > 0 ? 0.1 : -0.1, o = n.get("d"), s = o + a, u = n.get("maxD"), f = n.get("minD");
    if (s < u && s > f) {
      n.set("d", s);
      var l = n.get("r");
      n.set("molecularParam", (s + 1) * l), n.magnify(e);
    }
    n.set("dragPrePos", {
      x: e.x,
      y: e.y
    });
  }, t.prototype.magnify = function(e, n) {
    var i = this;
    i.restoreCache();
    var a = i.get("graph"), o = i.get("cachedMagnifiedModels"), s = i.get("cachedOriginPositions"), u = i.get("showLabel"), f = i.get("r"), l = i.get("r2"), c = i.get("d"), h = i.get("molecularParam"), d = a.getNodes(), v = d.length, p = n ? {
      x: n.x,
      y: n.y
    } : {
      x: e.x,
      y: e.y
    };
    i.get("dragging") && (i.get("trigger") === "mousemove" || i.get("trigger") === "click") && (p = i.get("cacheCenter"));
    var g = i.get("delegateCenterDiff");
    g && (p.x += g.x, p.y += g.y), i.updateDelegate(p, f);
    for (var y = 0; y < v; y++) {
      var b = d[y].getModel(), m = b.x, x = b.y;
      if (!(isNaN(m) || isNaN(x))) {
        var _ = (m - p.x) * (m - p.x) + (x - p.y) * (x - p.y);
        if (!isNaN(_) && _ < l && _ !== 0) {
          var w = Math.sqrt(_), E = h * w / (c * w + f), M = (m - p.x) / w, C = (x - p.y) / w;
          if (b.x = M * E + p.x, b.y = C * E + p.y, s[b.id] || (s[b.id] = {
            x: m,
            y: x,
            texts: []
          }), o.push(b), u && 2 * w < f)
            for (var S = d[y], A = S.getContainer(), T = A.getChildren(), P = T.length, k = 0; k < P; k++) {
              var L = T[k];
              L.get("type") === "text" && (s[b.id].texts.push({
                visible: L.get("visible"),
                shape: L
              }), L.set("visible", !0));
            }
        }
      }
    }
    a.refreshPositions();
  }, t.prototype.restoreCache = function() {
    for (var e = this, n = e.get("cachedMagnifiedModels"), i = e.get("cachedOriginPositions"), a = n.length, o = 0; o < a; o++) {
      var s = n[o], u = s.id, f = i[u];
      s.x = f.x, s.y = f.y;
      for (var l = f.texts.length, c = 0; c < l; c++) {
        var h = f.texts[c];
        h.shape.set("visible", h.visible);
      }
    }
    e.set("cachedMagnifiedModels", []), e.set("cachedOriginPositions", {});
  }, t.prototype.updateParams = function(e) {
    var n = this, i = e.r, a = e.d, o = e.trigger, s = e.minD, u = e.maxD, f = e.minR, l = e.maxR, c = e.scaleDBy, h = e.scaleRBy;
    isNaN(e.r) || (n.set("r", i), n.set("r2", i * i)), isNaN(a) || n.set("d", a), isNaN(u) || n.set("maxD", u), isNaN(s) || n.set("minD", s), isNaN(l) || n.set("maxR", l), isNaN(f) || n.set("minR", f);
    var d = n.get("d"), v = n.get("r");
    if (n.set("molecularParam", (d + 1) * v), (o === "mousemove" || o === "click" || o === "drag") && n.set("trigger", o), c === "drag" || c === "wheel" || c === "unset") {
      n.set("scaleDBy", c), n.get("delegate").remove(), n.get("delegate").destroy();
      var p = n.get("dPercentText");
      p && (p.remove(), p.destroy());
    }
    if (h === "drag" || h === "wheel" || h === "unset") {
      n.set("scaleRBy", h), n.get("delegate").remove(), n.get("delegate").destroy();
      var p = n.get("dPercentText");
      p && (p.remove(), p.destroy());
    }
  }, t.prototype.updateDelegate = function(e, n) {
    var i = this, a = this, o = a.get("graph"), s = a.get("delegate");
    if (!s || s.destroyed) {
      var u = o.get("group"), f = a.get("delegateStyle") || kO;
      s = u.addShape("circle", {
        attrs: P1({
          r: n / 1.5,
          x: e.x,
          y: e.y
        }, f),
        name: "lens-shape",
        draggable: !0
      }), this.get("trigger") !== "drag" && (this.get("scaleRBy") === "wheel" ? s.on("mousewheel", function(v) {
        a.scaleRByWheel(v);
      }) : this.get("scaleRBy") === "drag" && (s.on("dragstart", function(v) {
        a.set("dragging", !0), a.set("cacheCenter", {
          x: v.x,
          y: v.y
        }), a.set("dragPrePos", {
          x: v.x,
          y: v.y
        });
      }), s.on("drag", function(v) {
        a.scaleRByDrag(v);
      }), s.on("dragend", function(v) {
        a.set("dragging", !1);
      })), this.get("scaleDBy") === "wheel" ? s.on("mousewheel", function(v) {
        i.scaleDByWheel(v);
      }) : this.get("scaleDBy") === "drag" && (s.on("dragstart", function(v) {
        a.set("dragging", !0), a.set("cacheCenter", {
          x: v.x,
          y: v.y
        }), a.set("dragPrePos", {
          x: v.x,
          y: v.y
        });
      }), s.on("drag", function(v) {
        i.scaleDByDrag(v);
      }), s.on("dragend", function(v) {
        a.set("dragging", !1);
      })));
    } else
      s.attr({
        x: e.x,
        y: e.y,
        r: n / 1.5
      });
    if (a.get("showDPercent")) {
      var l = Math.round((a.get("d") - a.get("minD")) / (a.get("maxD") - a.get("minD")) * 100), c = a.get("dPercentText"), h = e.y + n / 1.5 + 16;
      if (!c || c.destroyed) {
        var d = o.get("group");
        c = d.addShape("text", {
          attrs: {
            text: "".concat(l, "%"),
            x: e.x,
            y: h,
            fill: "#aaa",
            stroke: "#fff",
            lineWidth: 1,
            fontSize: 12
          }
        }), a.set("dPercentText", c);
      } else
        c.attr({
          text: "".concat(l, "%"),
          x: e.x,
          y: h
        });
    }
    a.set("delegate", s);
  }, t.prototype.clear = function() {
    var e = this.get("graph");
    this.restoreCache(), e.refreshPositions();
    var n = this.get("delegate");
    n && !n.destroyed && (n.remove(), n.destroy());
    var i = this.get("dPercentText");
    i && !i.destroyed && (i.remove(), i.destroy());
  }, t.prototype.destroy = function() {
    this.clear();
  }, t;
}(hi);
const Gge = Bge;
var Fge = globalThis && globalThis.__extends || function() {
  var r = function(e, n) {
    return r = Object.setPrototypeOf || {
      __proto__: []
    } instanceof Array && function(i, a) {
      i.__proto__ = a;
    } || function(i, a) {
      for (var o in a)
        Object.prototype.hasOwnProperty.call(a, o) && (i[o] = a[o]);
    }, r(e, n);
  };
  return function(t, e) {
    if (typeof e != "function" && e !== null)
      throw new TypeError("Class extends value " + String(e) + " is not a constructor or null");
    r(t, e);
    function n() {
      this.constructor = t;
    }
    t.prototype = e === null ? Object.create(e) : (n.prototype = e.prototype, new n());
  };
}(), LO = 0.05;
typeof document < "u" && sl.exports(`
  .g6-component-toolbar {
    position: absolute;
    list-style-type: none;
    padding: 6px;
    left: 0px;
    top: 0px;
    background-color: rgba(255, 255, 255, 0.9);
    border: 1px solid #e2e2e2;
    border-radius: 4px;
    font-size: 12px;
    color: #545454;
    margin: 0;
  }
  .g6-component-toolbar li {
    float: left;
    text-align: center;
    width: 35px;
    height: 24px;
    cursor: pointer;
		list-style-type:none;
    list-style: none;
    margin-left: 0px;
  }
  .g6-component-toolbar li .icon {
    opacity: 0.7;
  }
  .g6-component-toolbar li .icon:hover {
    opacity: 1;
  }
`);
var zge = function(t) {
  if (!t)
    return [];
  if (t.composedPath)
    return t.composedPath();
  for (var e = [], n = t.target; n; ) {
    if (e.push(n), n.tagName === "HTML")
      return e.push(document, window), e;
    n = n.parentElement;
  }
  return e;
}, Uge = function(r) {
  Fge(t, r);
  function t(e) {
    return r.call(this, e) || this;
  }
  return t.prototype.getDefaultCfgs = function() {
    return {
      handleClick: void 0,
      getContent: function(n) {
        return `
          <ul class='g6-component-toolbar'>
            <li code='redo'>
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24">
                <path d="M256 682.666667c0-102.741333 66.730667-213.333333 213.333333-213.333334 107.008 0 190.762667 56.576 230.570667 125.354667L611.968 682.666667H853.333333v-241.365334l-91.562666 91.562667C704.768 448.469333 601.130667 384 469.333333 384c-196.096 0-298.666667 150.229333-298.666666 298.666667h85.333333z" fill="" p-id="2041"></path>
              </svg>
            </li>
            <li code='undo'>
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24">
                <path d="M170.666667 682.666667h241.365333l-87.936-87.978667C363.904 525.909333 447.658667 469.333333 554.666667 469.333333c146.602667 0 213.333333 110.592 213.333333 213.333334h85.333333c0-148.437333-102.570667-298.666667-298.666666-298.666667-131.797333 0-235.392 64.469333-292.48 148.821333L170.666667 441.301333V682.666667z" fill="" p-id="2764"></path>
              </svg>
            </li>
            <li  code='zoomOut'>
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24">
                <path d="M658.432 428.736a33.216 33.216 0 0 1-33.152 33.152H525.824v99.456a33.216 33.216 0 0 1-66.304 0V461.888H360.064a33.152 33.152 0 0 1 0-66.304H459.52V296.128a33.152 33.152 0 0 1 66.304 0V395.52H625.28c18.24 0 33.152 14.848 33.152 33.152z m299.776 521.792a43.328 43.328 0 0 1-60.864-6.912l-189.248-220.992a362.368 362.368 0 0 1-215.36 70.848 364.8 364.8 0 1 1 364.8-364.736 363.072 363.072 0 0 1-86.912 235.968l192.384 224.64a43.392 43.392 0 0 1-4.8 61.184z m-465.536-223.36a298.816 298.816 0 0 0 298.432-298.432 298.816 298.816 0 0 0-298.432-298.432A298.816 298.816 0 0 0 194.24 428.8a298.816 298.816 0 0 0 298.432 298.432z"></path>
              </svg>
            </li>
            <li code='zoomIn'>
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="24" height="24">
                <path d="M639.936 416a32 32 0 0 1-32 32h-256a32 32 0 0 1 0-64h256a32 32 0 0 1 32 32z m289.28 503.552a41.792 41.792 0 0 1-58.752-6.656l-182.656-213.248A349.76 349.76 0 0 1 480 768 352 352 0 1 1 832 416a350.4 350.4 0 0 1-83.84 227.712l185.664 216.768a41.856 41.856 0 0 1-4.608 59.072zM479.936 704c158.784 0 288-129.216 288-288S638.72 128 479.936 128a288.32 288.32 0 0 0-288 288c0 158.784 129.216 288 288 288z" p-id="3853"></path>
              </svg>
            </li>
            <li code='realZoom'>
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="20" height="24">
                <path d="M384 320v384H320V320h64z m256 0v384H576V320h64zM512 576v64H448V576h64z m0-192v64H448V384h64z m355.968 576H92.032A28.16 28.16 0 0 1 64 931.968V28.032C64 12.608 76.608 0 95.168 0h610.368L896 192v739.968a28.16 28.16 0 0 1-28.032 28.032zM704 64v128h128l-128-128z m128 192h-190.464V64H128v832h704V256z"></path>
              </svg>
            </li>
            <li code='autoZoom'>
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="20" height="24">
                <path d="M684.288 305.28l0.128-0.64-0.128-0.64V99.712c0-19.84 15.552-35.904 34.496-35.712a35.072 35.072 0 0 1 34.56 35.776v171.008h170.944c19.648 0 35.84 15.488 35.712 34.432a35.072 35.072 0 0 1-35.84 34.496h-204.16l-0.64-0.128a32.768 32.768 0 0 1-20.864-7.552c-1.344-1.024-2.816-1.664-3.968-2.816-0.384-0.32-0.512-0.768-0.832-1.088a33.472 33.472 0 0 1-9.408-22.848zM305.28 64a35.072 35.072 0 0 0-34.56 35.776v171.008H99.776A35.072 35.072 0 0 0 64 305.216c0 18.944 15.872 34.496 35.84 34.496h204.16l0.64-0.128a32.896 32.896 0 0 0 20.864-7.552c1.344-1.024 2.816-1.664 3.904-2.816 0.384-0.32 0.512-0.768 0.768-1.088a33.024 33.024 0 0 0 9.536-22.848l-0.128-0.64 0.128-0.704V99.712A35.008 35.008 0 0 0 305.216 64z m618.944 620.288h-204.16l-0.64 0.128-0.512-0.128c-7.808 0-14.72 3.2-20.48 7.68-1.28 1.024-2.752 1.664-3.84 2.752-0.384 0.32-0.512 0.768-0.832 1.088a33.664 33.664 0 0 0-9.408 22.912l0.128 0.64-0.128 0.704v204.288c0 19.712 15.552 35.904 34.496 35.712a35.072 35.072 0 0 0 34.56-35.776V753.28h170.944c19.648 0 35.84-15.488 35.712-34.432a35.072 35.072 0 0 0-35.84-34.496z m-593.92 11.52c-0.256-0.32-0.384-0.768-0.768-1.088-1.088-1.088-2.56-1.728-3.84-2.688a33.088 33.088 0 0 0-20.48-7.68l-0.512 0.064-0.64-0.128H99.84a35.072 35.072 0 0 0-35.84 34.496 35.072 35.072 0 0 0 35.712 34.432H270.72v171.008c0 19.84 15.552 35.84 34.56 35.776a35.008 35.008 0 0 0 34.432-35.712V720l-0.128-0.64 0.128-0.704a33.344 33.344 0 0 0-9.472-22.848zM512 374.144a137.92 137.92 0 1 0 0.128 275.84A137.92 137.92 0 0 0 512 374.08z"></path>
              </svg>
            </li>
          </ul>
        `;
      },
      zoomSensitivity: 2
    };
  }, t.prototype.init = function() {
    var e = this, n = this.get("graph"), i = this.get("getContent"), a = i(n), o = a;
    Qe(a) && (o = Nr(a));
    var s = this.get("className");
    o.setAttribute("class", s || "g6-component-toolbar");
    var u = this.get("container");
    u || (u = this.get("graph").get("container")), Qe(u) && (u = document.getElementById(u)), u.appendChild(o), this.set("toolBar", o);
    var f = this.get("handleClick");
    o.addEventListener("click", function(c) {
      var h = zge(c).filter(function(v) {
        return v.nodeName === "LI";
      });
      if (h.length !== 0) {
        var d = h[0].getAttribute("code");
        !d || (f ? f(d, n) : e.handleDefaultOperator(d));
      }
    });
    var l = this.get("position");
    l && ar(o, {
      top: "".concat(l.y, "px"),
      left: "".concat(l.x, "px")
    }), this.bindUndoRedo();
  }, t.prototype.bindUndoRedo = function() {
    var e = this.get("graph"), n = document.querySelector('.g6-component-toolbar li[code="undo"]'), i = document.querySelector('.g6-component-toolbar li[code="undo"] svg'), a = document.querySelector('.g6-component-toolbar li[code="redo"]'), o = document.querySelector('.g6-component-toolbar li[code="redo"] svg');
    !n || !i || !a || !o || e.on("stackchange", function(s) {
      var u = s.undoStack, f = s.redoStack, l = u.length, c = f.length;
      l === 1 ? (n.setAttribute("style", "cursor: not-allowed"), i.setAttribute("style", "opacity: 0.4")) : (n.removeAttribute("style"), i.removeAttribute("style")), c === 0 ? (a.setAttribute("style", "cursor: not-allowed"), o.setAttribute("style", "opacity: 0.4")) : (a.removeAttribute("style"), o.removeAttribute("style"));
    });
  }, t.prototype.undo = function() {
    var e = this.get("graph"), n = e.getUndoStack();
    if (!(!n || n.length === 1)) {
      var i = n.pop();
      if (i) {
        var a = i.action;
        e.pushStack(a, vr(i.data), "redo");
        var o = i.data.before;
        if (a === "add" && (o = i.data.after), !o)
          return;
        switch (a) {
          case "visible": {
            Object.keys(o).forEach(function(s) {
              var u = o[s];
              !u || u.forEach(function(f) {
                var l = e.findById(f.id);
                f.visible ? e.showItem(l, !1) : e.hideItem(l, !1);
              });
            });
            break;
          }
          case "render":
          case "update":
            Object.keys(o).forEach(function(s) {
              var u = o[s];
              !u || u.forEach(function(f) {
                var l = e.findById(f.id);
                delete f.id, e.updateItem(l, f, !1), l.getType() === "combo" && e.updateCombo(l);
              });
            });
            break;
          case "changedata":
            e.changeData(o, !1);
            break;
          case "delete": {
            Object.keys(o).forEach(function(s) {
              var u = o[s];
              !u || u.forEach(function(f) {
                var l = f.itemType;
                delete f.itemType, e.addItem(l, f, !1);
              });
            });
            break;
          }
          case "add":
            Object.keys(o).forEach(function(s) {
              var u = o[s];
              !u || u.forEach(function(f) {
                e.removeItem(f.id, !1);
              });
            });
            break;
          case "updateComboTree":
            Object.keys(o).forEach(function(s) {
              var u = o[s];
              !u || u.forEach(function(f) {
                e.updateComboTree(f.id, f.parentId, !1);
              });
            });
            break;
          case "layout":
            e.updateLayout(o, void 0, void 0, !1);
            break;
        }
      }
    }
  }, t.prototype.redo = function() {
    var e = this.get("graph"), n = e.getRedoStack();
    if (!(!n || n.length === 0)) {
      var i = n.pop();
      if (i) {
        var a = i.action, o = i.data.after;
        if (e.pushStack(a, vr(i.data)), a === "delete" && (o = i.data.before), !o)
          return;
        switch (a) {
          case "visible": {
            Object.keys(o).forEach(function(s) {
              var u = o[s];
              !u || u.forEach(function(f) {
                var l = e.findById(f.id);
                f.visible ? e.showItem(l, !1) : e.hideItem(l, !1);
              });
            });
            break;
          }
          case "render":
          case "update":
            Object.keys(o).forEach(function(s) {
              var u = o[s];
              !u || u.forEach(function(f) {
                var l = e.findById(f.id);
                delete f.id, e.updateItem(l, f, !1), l.getType() === "combo" && e.updateCombo(l);
              });
            });
            break;
          case "changedata":
            e.changeData(o, !1);
            break;
          case "delete":
            o.edges && o.edges.forEach(function(s) {
              e.removeItem(s.id, !1);
            }), o.nodes && o.nodes.forEach(function(s) {
              e.removeItem(s.id, !1);
            }), o.combos && o.combos.forEach(function(s) {
              e.removeItem(s.id, !1);
            });
            break;
          case "add": {
            Object.keys(o).forEach(function(s) {
              var u = o[s];
              !u || u.forEach(function(f) {
                var l = f.itemType;
                delete f.itemType, e.addItem(l, f, !1);
              });
            });
            break;
          }
          case "updateComboTree":
            Object.keys(o).forEach(function(s) {
              var u = o[s];
              !u || u.forEach(function(f) {
                e.updateComboTree(f.id, f.parentId, !1);
              });
            });
            break;
          case "layout":
            e.updateLayout(o, void 0, void 0, !1);
            break;
        }
      }
    }
  }, t.prototype.zoomOut = function() {
    var e = this.get("graph"), n = e.getZoom(), i = 1 / (1 - LO * this.get("zoomSensitivity")), a = this.get("maxZoom") || e.get("maxZoom");
    i * n > a || e.zoomTo(n * i);
  }, t.prototype.zoomIn = function() {
    var e = this.get("graph"), n = e.getZoom(), i = 1 - LO * this.get("zoomSensitivity"), a = this.get("minZoom") || e.get("minZoom");
    i * n < a || e.zoomTo(n * i);
  }, t.prototype.realZoom = function() {
    var e = this.get("graph");
    e.zoomTo(1);
  }, t.prototype.autoZoom = function() {
    var e = this.get("graph");
    e.fitView([20, 20]);
  }, t.prototype.handleDefaultOperator = function(e) {
    switch (e) {
      case "redo":
        this.redo();
        break;
      case "undo":
        this.undo();
        break;
      case "zoomOut":
        this.zoomOut();
        break;
      case "zoomIn":
        this.zoomIn();
        break;
      case "realZoom":
        this.realZoom();
        break;
      case "autoZoom":
        this.autoZoom();
        break;
    }
  }, t.prototype.destroy = function() {
    var e = this.get("toolBar");
    if (e) {
      var n = this.get("container");
      n || (n = this.get("graph").get("container")), Qe(n) && (n = document.getElementById(n)), n.removeChild(e);
    }
    var i = this.get("handleClick");
    i && e.removeEventListener("click", i);
  }, t;
}(hi);
const jge = Uge;
var $ge = globalThis && globalThis.__extends || function() {
  var r = function(e, n) {
    return r = Object.setPrototypeOf || {
      __proto__: []
    } instanceof Array && function(i, a) {
      i.__proto__ = a;
    } || function(i, a) {
      for (var o in a)
        Object.prototype.hasOwnProperty.call(a, o) && (i[o] = a[o]);
    }, r(e, n);
  };
  return function(t, e) {
    if (typeof e != "function" && e !== null)
      throw new TypeError("Class extends value " + String(e) + " is not a constructor or null");
    r(t, e);
    function n() {
      this.constructor = t;
    }
    t.prototype = e === null ? Object.create(e) : (n.prototype = e.prototype, new n());
  };
}();
typeof document < "u" && sl.exports(`
  .g6-component-tooltip {
    border: 1px solid #e2e2e2;
    border-radius: 4px;
    font-size: 12px;
    color: #545454;
    background-color: rgba(255, 255, 255, 0.9);
    padding: 10px 8px;
    box-shadow: rgb(174, 174, 174) 0px 0px 10px;
  }
  .tooltip-type {
    padding: 0;
    margin: 0;
  }
  .tooltip-id {
    color: #531dab;
  }
`);
var Wge = function(r) {
  $ge(t, r);
  function t(e) {
    return r.call(this, e) || this;
  }
  return t.prototype.getDefaultCfgs = function() {
    return {
      offsetX: 6,
      offsetY: 6,
      getContent: function(n) {
        return `
          <h4 class='tooltip-type'>\u7C7B\u578B\uFF1A`.concat(n.item.getType(), `</h4>
          <span class='tooltip-id'>ID\uFF1A`).concat(n.item.getID(), `</span>
        `);
      },
      shouldBegin: function(n) {
        return !0;
      },
      itemTypes: ["node", "edge", "combo"],
      trigger: "mouseenter",
      fixToNode: void 0
    };
  }, t.prototype.getEvents = function() {
    return this.get("trigger") === "click" ? {
      "node:click": "onClick",
      "edge:click": "onClick",
      "combo:click": "onClick",
      "canvas:click": "onMouseLeave",
      afterremoveitem: "onMouseLeave",
      contextmenu: "onMouseLeave",
      drag: "onMouseLeave"
    } : {
      "node:mouseenter": "onMouseEnter",
      "node:mouseleave": "onMouseLeave",
      "node:mousemove": "onMouseMove",
      "edge:mouseenter": "onMouseEnter",
      "edge:mouseleave": "onMouseLeave",
      "edge:mousemove": "onMouseMove",
      "combo:mouseenter": "onMouseEnter",
      "combo:mouseleave": "onMouseLeave",
      "combo:mousemove": "onMouseMove",
      afterremoveitem: "onMouseLeave",
      contextmenu: "onMouseLeave",
      "node:drag": "onMouseLeave"
    };
  }, t.prototype.init = function() {
    var e = this, n = e.get("className") || "g6-component-tooltip", i = Nr("<div class='".concat(n, "'></div>")), a = e.get("container");
    a || (a = e.get("graph").get("container")), Qe(a) && (a = document.getElementById(a)), ar(i, {
      position: "absolute",
      visibility: "hidden",
      display: "none"
    }), a.appendChild(i), e.get("trigger") !== "click" && (i.addEventListener("mouseenter", function(o) {
      ar(i, {
        visibility: "visible",
        display: "unset"
      });
    }), i.addEventListener("mouseleave", function(o) {
      e.hideTooltip();
    })), e.set("tooltip", i);
  }, t.prototype.onClick = function(e) {
    var n = this.get("itemTypes");
    if (!(e.item && e.item.getType && n.indexOf(e.item.getType()) === -1)) {
      var i = e.item, a = this.get("graph");
      this.currentTarget === i ? (this.currentTarget = null, this.hideTooltip(), a.emit("tooltipchange", {
        item: e.item,
        action: "hide"
      })) : (this.currentTarget = i, this.showTooltip(e), a.emit("tooltipchange", {
        item: e.item,
        action: "show"
      }));
    }
  }, t.prototype.onMouseEnter = function(e) {
    var n = this.get("itemTypes");
    if (!(e.item && e.item.getType && n.indexOf(e.item.getType()) === -1)) {
      var i = e.item, a = this.get("graph");
      this.currentTarget = i, this.showTooltip(e), a.emit("tooltipchange", {
        item: e.item,
        action: "show"
      });
    }
  }, t.prototype.onMouseMove = function(e) {
    var n = this.get("itemTypes");
    e.item && e.item.getType && n.indexOf(e.item.getType()) === -1 || !this.currentTarget || e.item !== this.currentTarget || this.showTooltip(e);
  }, t.prototype.onMouseLeave = function() {
    this.hideTooltip();
    var e = this.get("graph");
    e.emit("tooltipchange", {
      item: this.currentTarget,
      action: "hide"
    }), this.currentTarget = null;
  }, t.prototype.clearContainer = function() {
    var e = this.get("tooltip");
    e && (e.innerHTML = "");
  }, t.prototype.showTooltip = function(e) {
    if (!!e.item) {
      var n = this.get("itemTypes");
      if (!(e.item.getType && n.indexOf(e.item.getType()) === -1)) {
        var i = this.get("tooltip"), a = this.get("getContent"), o = a(e);
        Qe(o) ? i.innerHTML = o : (this.clearContainer(), i.appendChild(o)), this.updatePosition(e);
      }
    }
  }, t.prototype.hideTooltip = function() {
    var e = this.get("tooltip");
    e && ar(e, {
      visibility: "hidden",
      display: "none"
    });
  }, t.prototype.updatePosition = function(e) {
    var n = this.get("shouldBegin"), i = this.get("tooltip");
    if (!n(e)) {
      ar(i, {
        visibility: "hidden",
        display: "none"
      });
      return;
    }
    var a = this.get("graph"), o = a.get("width"), s = a.get("height"), u = this.get("offsetX") || 0, f = this.get("offsetY") || 0, l = a.getPointByClient(e.clientX, e.clientY), c = this.get("fixToNode"), h = e.item;
    if (h.getType && h.getType() === "node" && c && Dt(c) && c.length >= 2) {
      var d = h.getBBox();
      l = {
        x: d.minX + d.width * c[0],
        y: d.minY + d.height * c[1]
      };
    }
    var v = a.getCanvasByPoint(l.x, l.y), p = v.x, g = v.y, y = a.getContainer(), b = {
      x: p + y.offsetLeft + u,
      y: g + y.offsetTop + f
    };
    ar(i, {
      visibility: "visible",
      display: "unset"
    });
    var m = i.getBoundingClientRect();
    p + m.width + u > o && (b.x -= m.width + u), g + m.height + f > s && (b.y -= m.height + f), ar(i, {
      left: "".concat(b.x, "px"),
      top: "".concat(b.y, "px")
    });
  }, t.prototype.hide = function() {
    this.onMouseLeave();
  }, t.prototype.destroy = function() {
    var e = this.get("tooltip");
    if (e) {
      var n = this.get("container");
      n || (n = this.get("graph").get("container")), Qe(n) && (n = document.getElementById(n)), n.removeChild(e);
    }
  }, t;
}(hi);
const Vge = Wge;
var t4 = {};
function Xge(r) {
  return t4[r];
}
function Xa(r, t) {
  t4[r] = t;
}
var o_ = function() {
  function r(t) {
    this.type = "base", this.isCategory = !1, this.isLinear = !1, this.isContinuous = !1, this.isIdentity = !1, this.values = [], this.range = [0, 1], this.ticks = [], this.__cfg__ = t, this.initCfg(), this.init();
  }
  return r.prototype.translate = function(t) {
    return t;
  }, r.prototype.change = function(t) {
    kt(this.__cfg__, t), this.init();
  }, r.prototype.clone = function() {
    return this.constructor(this.__cfg__);
  }, r.prototype.getTicks = function() {
    var t = this;
    return vu(this.ticks, function(e, n) {
      return Xn(e) ? e : {
        text: t.getText(e, n),
        tickValue: e,
        value: t.scale(e)
      };
    });
  }, r.prototype.getText = function(t, e) {
    var n = this.formatter, i = n ? n(t, e) : t;
    return Tt(i) || !Ur(i.toString) ? "" : i.toString();
  }, r.prototype.getConfig = function(t) {
    return this.__cfg__[t];
  }, r.prototype.init = function() {
    kt(this, this.__cfg__), this.setDomain(), BD(this.getConfig("ticks")) && (this.ticks = this.calculateTicks());
  }, r.prototype.initCfg = function() {
  }, r.prototype.setDomain = function() {
  }, r.prototype.calculateTicks = function() {
    var t = this.tickMethod, e = [];
    if (Qe(t)) {
      var n = Xge(t);
      if (!n)
        throw new Error("There is no method to to calculate ticks!");
      e = n(this);
    } else
      Ur(t) && (e = t(this));
    return e;
  }, r.prototype.rangeMin = function() {
    return this.range[0];
  }, r.prototype.rangeMax = function() {
    return this.range[1];
  }, r.prototype.calcPercent = function(t, e, n) {
    return At(t) ? (t - e) / (n - e) : NaN;
  }, r.prototype.calcValue = function(t, e, n) {
    return e + t * (n - e);
  }, r;
}(), Th = function(r) {
  Ht(t, r);
  function t() {
    var e = r !== null && r.apply(this, arguments) || this;
    return e.type = "cat", e.isCategory = !0, e;
  }
  return t.prototype.buildIndexMap = function() {
    if (!this.translateIndexMap) {
      this.translateIndexMap = /* @__PURE__ */ new Map();
      for (var e = 0; e < this.values.length; e++)
        this.translateIndexMap.set(this.values[e], e);
    }
  }, t.prototype.translate = function(e) {
    this.buildIndexMap();
    var n = this.translateIndexMap.get(e);
    return n === void 0 && (n = At(e) ? e : NaN), n;
  }, t.prototype.scale = function(e) {
    var n = this.translate(e), i = this.calcPercent(n, this.min, this.max);
    return this.calcValue(i, this.rangeMin(), this.rangeMax());
  }, t.prototype.invert = function(e) {
    var n = this.max - this.min, i = this.calcPercent(e, this.rangeMin(), this.rangeMax()), a = Math.round(n * i) + this.min;
    return a < this.min || a > this.max ? NaN : this.values[a];
  }, t.prototype.getText = function(e) {
    for (var n = [], i = 1; i < arguments.length; i++)
      n[i - 1] = arguments[i];
    var a = e;
    return At(e) && !this.values.includes(e) && (a = this.values[a]), r.prototype.getText.apply(this, j1([a], n));
  }, t.prototype.initCfg = function() {
    this.tickMethod = "cat";
  }, t.prototype.setDomain = function() {
    if (Tt(this.getConfig("min")) && (this.min = 0), Tt(this.getConfig("max"))) {
      var e = this.values.length;
      this.max = e > 1 ? e - 1 : e;
    }
    this.translateIndexMap && (this.translateIndexMap = void 0);
  }, t;
}(o_), r4 = /d{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|ZZ|Z|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g, qo = "\\d\\d?", Xo = "\\d\\d", Yge = "\\d{3}", Hge = "\\d{4}", wc = "[^\\s]+", n4 = /\[([^]*?)\]/gm;
function i4(r, t) {
  for (var e = [], n = 0, i = r.length; n < i; n++)
    e.push(r[n].substr(0, t));
  return e;
}
var NO = function(r) {
  return function(t, e) {
    var n = e[r].map(function(a) {
      return a.toLowerCase();
    }), i = n.indexOf(t.toLowerCase());
    return i > -1 ? i : null;
  };
};
function bs(r) {
  for (var t = [], e = 1; e < arguments.length; e++)
    t[e - 1] = arguments[e];
  for (var n = 0, i = t; n < i.length; n++) {
    var a = i[n];
    for (var o in a)
      r[o] = a[o];
  }
  return r;
}
var a4 = [
  "Sunday",
  "Monday",
  "Tuesday",
  "Wednesday",
  "Thursday",
  "Friday",
  "Saturday"
], o4 = [
  "January",
  "February",
  "March",
  "April",
  "May",
  "June",
  "July",
  "August",
  "September",
  "October",
  "November",
  "December"
], Kge = i4(o4, 3), qge = i4(a4, 3), s_ = {
  dayNamesShort: qge,
  dayNames: a4,
  monthNamesShort: Kge,
  monthNames: o4,
  amPm: ["am", "pm"],
  DoFn: function(r) {
    return r + ["th", "st", "nd", "rd"][r % 10 > 3 ? 0 : (r - r % 10 !== 10 ? 1 : 0) * r % 10];
  }
}, wp = bs({}, s_), s4 = function(r) {
  return wp = bs(wp, r);
}, RO = function(r) {
  return r.replace(/[|\\{()[^$+*?.-]/g, "\\$&");
}, ii = function(r, t) {
  for (t === void 0 && (t = 2), r = String(r); r.length < t; )
    r = "0" + r;
  return r;
}, Zge = {
  D: function(r) {
    return String(r.getDate());
  },
  DD: function(r) {
    return ii(r.getDate());
  },
  Do: function(r, t) {
    return t.DoFn(r.getDate());
  },
  d: function(r) {
    return String(r.getDay());
  },
  dd: function(r) {
    return ii(r.getDay());
  },
  ddd: function(r, t) {
    return t.dayNamesShort[r.getDay()];
  },
  dddd: function(r, t) {
    return t.dayNames[r.getDay()];
  },
  M: function(r) {
    return String(r.getMonth() + 1);
  },
  MM: function(r) {
    return ii(r.getMonth() + 1);
  },
  MMM: function(r, t) {
    return t.monthNamesShort[r.getMonth()];
  },
  MMMM: function(r, t) {
    return t.monthNames[r.getMonth()];
  },
  YY: function(r) {
    return ii(String(r.getFullYear()), 4).substr(2);
  },
  YYYY: function(r) {
    return ii(r.getFullYear(), 4);
  },
  h: function(r) {
    return String(r.getHours() % 12 || 12);
  },
  hh: function(r) {
    return ii(r.getHours() % 12 || 12);
  },
  H: function(r) {
    return String(r.getHours());
  },
  HH: function(r) {
    return ii(r.getHours());
  },
  m: function(r) {
    return String(r.getMinutes());
  },
  mm: function(r) {
    return ii(r.getMinutes());
  },
  s: function(r) {
    return String(r.getSeconds());
  },
  ss: function(r) {
    return ii(r.getSeconds());
  },
  S: function(r) {
    return String(Math.round(r.getMilliseconds() / 100));
  },
  SS: function(r) {
    return ii(Math.round(r.getMilliseconds() / 10), 2);
  },
  SSS: function(r) {
    return ii(r.getMilliseconds(), 3);
  },
  a: function(r, t) {
    return r.getHours() < 12 ? t.amPm[0] : t.amPm[1];
  },
  A: function(r, t) {
    return r.getHours() < 12 ? t.amPm[0].toUpperCase() : t.amPm[1].toUpperCase();
  },
  ZZ: function(r) {
    var t = r.getTimezoneOffset();
    return (t > 0 ? "-" : "+") + ii(Math.floor(Math.abs(t) / 60) * 100 + Math.abs(t) % 60, 4);
  },
  Z: function(r) {
    var t = r.getTimezoneOffset();
    return (t > 0 ? "-" : "+") + ii(Math.floor(Math.abs(t) / 60), 2) + ":" + ii(Math.abs(t) % 60, 2);
  }
}, BO = function(r) {
  return +r - 1;
}, GO = [null, qo], FO = [null, wc], zO = [
  "isPm",
  wc,
  function(r, t) {
    var e = r.toLowerCase();
    return e === t.amPm[0] ? 0 : e === t.amPm[1] ? 1 : null;
  }
], UO = [
  "timezoneOffset",
  "[^\\s]*?[\\+\\-]\\d\\d:?\\d\\d|[^\\s]*?Z?",
  function(r) {
    var t = (r + "").match(/([+-]|\d\d)/gi);
    if (t) {
      var e = +t[1] * 60 + parseInt(t[2], 10);
      return t[0] === "+" ? e : -e;
    }
    return 0;
  }
], Qge = {
  D: ["day", qo],
  DD: ["day", Xo],
  Do: ["day", qo + wc, function(r) {
    return parseInt(r, 10);
  }],
  M: ["month", qo, BO],
  MM: ["month", Xo, BO],
  YY: [
    "year",
    Xo,
    function(r) {
      var t = new Date(), e = +("" + t.getFullYear()).substr(0, 2);
      return +("" + (+r > 68 ? e - 1 : e) + r);
    }
  ],
  h: ["hour", qo, void 0, "isPm"],
  hh: ["hour", Xo, void 0, "isPm"],
  H: ["hour", qo],
  HH: ["hour", Xo],
  m: ["minute", qo],
  mm: ["minute", Xo],
  s: ["second", qo],
  ss: ["second", Xo],
  YYYY: ["year", Hge],
  S: ["millisecond", "\\d", function(r) {
    return +r * 100;
  }],
  SS: ["millisecond", Xo, function(r) {
    return +r * 10;
  }],
  SSS: ["millisecond", Yge],
  d: GO,
  dd: GO,
  ddd: FO,
  dddd: FO,
  MMM: ["month", wc, NO("monthNamesShort")],
  MMMM: ["month", wc, NO("monthNames")],
  a: zO,
  A: zO,
  ZZ: UO,
  Z: UO
}, Ep = {
  default: "ddd MMM DD YYYY HH:mm:ss",
  shortDate: "M/D/YY",
  mediumDate: "MMM D, YYYY",
  longDate: "MMMM D, YYYY",
  fullDate: "dddd, MMMM D, YYYY",
  isoDate: "YYYY-MM-DD",
  isoDateTime: "YYYY-MM-DDTHH:mm:ssZ",
  shortTime: "HH:mm",
  mediumTime: "HH:mm:ss",
  longTime: "HH:mm:ss.SSS"
}, u4 = function(r) {
  return bs(Ep, r);
}, f4 = function(r, t, e) {
  if (t === void 0 && (t = Ep.default), e === void 0 && (e = {}), typeof r == "number" && (r = new Date(r)), Object.prototype.toString.call(r) !== "[object Date]" || isNaN(r.getTime()))
    throw new Error("Invalid Date pass to format");
  t = Ep[t] || t;
  var n = [];
  t = t.replace(n4, function(a, o) {
    return n.push(o), "@@@";
  });
  var i = bs(bs({}, wp), e);
  return t = t.replace(r4, function(a) {
    return Zge[a](r, i);
  }), t.replace(/@@@/g, function() {
    return n.shift();
  });
};
function l4(r, t, e) {
  if (e === void 0 && (e = {}), typeof t != "string")
    throw new Error("Invalid format in fecha parse");
  if (t = Ep[t] || t, r.length > 1e3)
    return null;
  var n = new Date(), i = {
    year: n.getFullYear(),
    month: 0,
    day: 1,
    hour: 0,
    minute: 0,
    second: 0,
    millisecond: 0,
    isPm: null,
    timezoneOffset: null
  }, a = [], o = [], s = t.replace(n4, function(x, _) {
    return o.push(RO(_)), "@@@";
  }), u = {}, f = {};
  s = RO(s).replace(r4, function(x) {
    var _ = Qge[x], w = _[0], E = _[1], M = _[3];
    if (u[w])
      throw new Error("Invalid format. " + w + " specified twice in format");
    return u[w] = !0, M && (f[M] = !0), a.push(_), "(" + E + ")";
  }), Object.keys(f).forEach(function(x) {
    if (!u[x])
      throw new Error("Invalid format. " + x + " is required in specified format");
  }), s = s.replace(/@@@/g, function() {
    return o.shift();
  });
  var l = r.match(new RegExp(s, "i"));
  if (!l)
    return null;
  for (var c = bs(bs({}, wp), e), h = 1; h < l.length; h++) {
    var d = a[h - 1], v = d[0], p = d[2], g = p ? p(l[h], c) : +l[h];
    if (g == null)
      return null;
    i[v] = g;
  }
  i.isPm === 1 && i.hour != null && +i.hour != 12 ? i.hour = +i.hour + 12 : i.isPm === 0 && +i.hour == 12 && (i.hour = 0);
  var y;
  if (i.timezoneOffset == null) {
    y = new Date(i.year, i.month, i.day, i.hour, i.minute, i.second, i.millisecond);
    for (var b = [
      ["month", "getMonth"],
      ["day", "getDate"],
      ["hour", "getHours"],
      ["minute", "getMinutes"],
      ["second", "getSeconds"]
    ], h = 0, m = b.length; h < m; h++)
      if (u[b[h][0]] && i[b[h][0]] !== y[b[h][1]]())
        return null;
  } else if (y = new Date(Date.UTC(i.year, i.month, i.day, i.hour, i.minute - i.timezoneOffset, i.second, i.millisecond)), i.month > 11 || i.month < 0 || i.day > 31 || i.day < 1 || i.hour > 23 || i.hour < 0 || i.minute > 59 || i.minute < 0 || i.second > 59 || i.second < 0)
    return null;
  return y;
}
var c4 = {
  format: f4,
  parse: l4,
  defaultI18n: s_,
  setGlobalDateI18n: s4,
  setGlobalDateMasks: u4
};
const Jge = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  default: c4,
  assign: bs,
  format: f4,
  parse: l4,
  defaultI18n: s_,
  setGlobalDateI18n: s4,
  setGlobalDateMasks: u4
}, Symbol.toStringTag, { value: "Module" }));
function e0e(r) {
  return function(t, e, n, i) {
    for (var a = Tt(n) ? 0 : n, o = Tt(i) ? t.length : i; a < o; ) {
      var s = a + o >>> 1;
      r(t[s]) > e ? o = s : a = s + 1;
    }
    return a;
  };
}
var jO = "format";
function h4(r, t) {
  var e = Jge[jO] || c4[jO];
  return e(r, t);
}
function Sp(r) {
  return Qe(r) && (r.indexOf("T") > 0 ? r = new Date(r).getTime() : r = new Date(r.replace(/-/gi, "/")).getTime()), V1(r) && (r = r.getTime()), r;
}
var Ji = 1e3, cu = 60 * Ji, hu = 60 * cu, xo = 24 * hu, Ec = xo * 31, $O = xo * 365, Zl = [
  ["HH:mm:ss", Ji],
  ["HH:mm:ss", Ji * 10],
  ["HH:mm:ss", Ji * 30],
  ["HH:mm", cu],
  ["HH:mm", cu * 10],
  ["HH:mm", cu * 30],
  ["HH", hu],
  ["HH", hu * 6],
  ["HH", hu * 12],
  ["YYYY-MM-DD", xo],
  ["YYYY-MM-DD", xo * 4],
  ["YYYY-WW", xo * 7],
  ["YYYY-MM", Ec],
  ["YYYY-MM", Ec * 4],
  ["YYYY-MM", Ec * 6],
  ["YYYY", xo * 380]
];
function t0e(r, t, e) {
  var n = (t - r) / e, i = e0e(function(o) {
    return o[1];
  })(Zl, n) - 1, a = Zl[i];
  return i < 0 ? a = Zl[0] : i >= Zl.length && (a = zi(Zl)), a;
}
var r0e = function(r) {
  Ht(t, r);
  function t() {
    var e = r !== null && r.apply(this, arguments) || this;
    return e.type = "timeCat", e;
  }
  return t.prototype.translate = function(e) {
    e = Sp(e);
    var n = this.values.indexOf(e);
    return n === -1 && (At(e) && e < this.values.length ? n = e : n = NaN), n;
  }, t.prototype.getText = function(e, n) {
    var i = this.translate(e);
    if (i > -1) {
      var a = this.values[i], o = this.formatter;
      return a = o ? o(a, n) : h4(a, this.mask), a;
    }
    return e;
  }, t.prototype.initCfg = function() {
    this.tickMethod = "time-cat", this.mask = "YYYY-MM-DD", this.tickCount = 7;
  }, t.prototype.setDomain = function() {
    var e = this.values;
    Se(e, function(n, i) {
      e[i] = Sp(n);
    }), e.sort(function(n, i) {
      return n - i;
    }), r.prototype.setDomain.call(this);
  }, t;
}(Th), Sg = function(r) {
  Ht(t, r);
  function t() {
    var e = r !== null && r.apply(this, arguments) || this;
    return e.isContinuous = !0, e;
  }
  return t.prototype.scale = function(e) {
    if (Tt(e))
      return NaN;
    var n = this.rangeMin(), i = this.rangeMax(), a = this.max, o = this.min;
    if (a === o)
      return n;
    var s = this.getScalePercent(e);
    return n + s * (i - n);
  }, t.prototype.init = function() {
    r.prototype.init.call(this);
    var e = this.ticks, n = Fa(e), i = zi(e);
    n < this.min && (this.min = n), i > this.max && (this.max = i), Tt(this.minLimit) || (this.min = n), Tt(this.maxLimit) || (this.max = i);
  }, t.prototype.setDomain = function() {
    var e = MD(this.values), n = e.min, i = e.max;
    Tt(this.min) && (this.min = n), Tt(this.max) && (this.max = i), this.min > this.max && (this.min = n, this.max = i);
  }, t.prototype.calculateTicks = function() {
    var e = this, n = r.prototype.calculateTicks.call(this);
    return this.nice || (n = Ap(n, function(i) {
      return i >= e.min && i <= e.max;
    })), n;
  }, t.prototype.getScalePercent = function(e) {
    var n = this.max, i = this.min;
    return (e - i) / (n - i);
  }, t.prototype.getInvertPercent = function(e) {
    return (e - this.rangeMin()) / (this.rangeMax() - this.rangeMin());
  }, t;
}(o_), n0e = function(r) {
  Ht(t, r);
  function t() {
    var e = r !== null && r.apply(this, arguments) || this;
    return e.type = "linear", e.isLinear = !0, e;
  }
  return t.prototype.invert = function(e) {
    var n = this.getInvertPercent(e);
    return this.min + n * (this.max - this.min);
  }, t.prototype.initCfg = function() {
    this.tickMethod = "wilkinson-extended", this.nice = !1;
  }, t;
}(Sg);
const Ah = n0e;
function ts(r, t) {
  var e = Math.E, n;
  return t >= 0 ? n = Math.pow(e, Math.log(t) / r) : n = Math.pow(e, Math.log(-t) / r) * -1, n;
}
function Ri(r, t) {
  return r === 1 ? 1 : Math.log(t) / Math.log(r);
}
function d4(r, t, e) {
  Tt(e) && (e = Math.max.apply(null, r));
  var n = e;
  return Se(r, function(i) {
    i > 0 && i < n && (n = i);
  }), n === e && (n = e / t), n > 1 && (n = 1), n;
}
var i0e = function(r) {
  Ht(t, r);
  function t() {
    var e = r !== null && r.apply(this, arguments) || this;
    return e.type = "log", e;
  }
  return t.prototype.invert = function(e) {
    var n = this.base, i = Ri(n, this.max), a = this.rangeMin(), o = this.rangeMax() - a, s, u = this.positiveMin;
    if (u) {
      if (e === 0)
        return 0;
      s = Ri(n, u / n);
      var f = 1 / (i - s) * o;
      if (e < f)
        return e / f * u;
    } else
      s = Ri(n, this.min);
    var l = (e - a) / o, c = l * (i - s) + s;
    return Math.pow(n, c);
  }, t.prototype.initCfg = function() {
    this.tickMethod = "log", this.base = 10, this.tickCount = 6, this.nice = !0;
  }, t.prototype.setDomain = function() {
    r.prototype.setDomain.call(this);
    var e = this.min;
    if (e < 0)
      throw new Error("When you use log scale, the minimum value must be greater than zero!");
    e === 0 && (this.positiveMin = d4(this.values, this.base, this.max));
  }, t.prototype.getScalePercent = function(e) {
    var n = this.max, i = this.min;
    if (n === i || e <= 0)
      return 0;
    var a = this.base, o = this.positiveMin;
    o && (i = o * 1 / a);
    var s;
    return e < o ? s = e / o / (Ri(a, n) - Ri(a, i)) : s = (Ri(a, e) - Ri(a, i)) / (Ri(a, n) - Ri(a, i)), s;
  }, t;
}(Sg), a0e = function(r) {
  Ht(t, r);
  function t() {
    var e = r !== null && r.apply(this, arguments) || this;
    return e.type = "pow", e;
  }
  return t.prototype.invert = function(e) {
    var n = this.getInvertPercent(e), i = this.exponent, a = ts(i, this.max), o = ts(i, this.min), s = n * (a - o) + o, u = s >= 0 ? 1 : -1;
    return Math.pow(s, i) * u;
  }, t.prototype.initCfg = function() {
    this.tickMethod = "pow", this.exponent = 2, this.tickCount = 5, this.nice = !0;
  }, t.prototype.getScalePercent = function(e) {
    var n = this.max, i = this.min;
    if (n === i)
      return 0;
    var a = this.exponent, o = (ts(a, e) - ts(a, i)) / (ts(a, n) - ts(a, i));
    return o;
  }, t;
}(Sg), o0e = function(r) {
  Ht(t, r);
  function t() {
    var e = r !== null && r.apply(this, arguments) || this;
    return e.type = "time", e;
  }
  return t.prototype.getText = function(e, n) {
    var i = this.translate(e), a = this.formatter;
    return a ? a(i, n) : h4(i, this.mask);
  }, t.prototype.scale = function(e) {
    var n = e;
    return (Qe(n) || V1(n)) && (n = this.translate(n)), r.prototype.scale.call(this, n);
  }, t.prototype.translate = function(e) {
    return Sp(e);
  }, t.prototype.initCfg = function() {
    this.tickMethod = "time-pretty", this.mask = "YYYY-MM-DD", this.tickCount = 7, this.nice = !1;
  }, t.prototype.setDomain = function() {
    var e = this.values, n = this.getConfig("min"), i = this.getConfig("max");
    if ((!Tt(n) || !At(n)) && (this.min = this.translate(this.min)), (!Tt(i) || !At(i)) && (this.max = this.translate(this.max)), e && e.length) {
      var a = [], o = 1 / 0, s = o, u = 0;
      Se(e, function(f) {
        var l = Sp(f);
        if (isNaN(l))
          throw new TypeError("Invalid Time: " + f + " in time scale!");
        o > l ? (s = o, o = l) : s > l && (s = l), u < l && (u = l), a.push(l);
      }), e.length > 1 && (this.minTickInterval = s - o), Tt(n) && (this.min = o), Tt(i) && (this.max = u);
    }
  }, t;
}(Ah), v4 = function(r) {
  Ht(t, r);
  function t() {
    var e = r !== null && r.apply(this, arguments) || this;
    return e.type = "quantize", e;
  }
  return t.prototype.invert = function(e) {
    var n = this.ticks, i = n.length, a = this.getInvertPercent(e), o = Math.floor(a * (i - 1));
    if (o >= i - 1)
      return zi(n);
    if (o < 0)
      return Fa(n);
    var s = n[o], u = n[o + 1], f = o / (i - 1), l = (o + 1) / (i - 1);
    return s + (a - f) / (l - f) * (u - s);
  }, t.prototype.initCfg = function() {
    this.tickMethod = "r-pretty", this.tickCount = 5, this.nice = !0;
  }, t.prototype.calculateTicks = function() {
    var e = r.prototype.calculateTicks.call(this);
    return this.nice || (zi(e) !== this.max && e.push(this.max), Fa(e) !== this.min && e.unshift(this.min)), e;
  }, t.prototype.getScalePercent = function(e) {
    var n = this.ticks;
    if (e < Fa(n))
      return 0;
    if (e > zi(n))
      return 1;
    var i = 0;
    return Se(n, function(a, o) {
      if (e >= a)
        i = o;
      else
        return !1;
    }), i / (n.length - 1);
  }, t;
}(Sg), s0e = function(r) {
  Ht(t, r);
  function t() {
    var e = r !== null && r.apply(this, arguments) || this;
    return e.type = "quantile", e;
  }
  return t.prototype.initCfg = function() {
    this.tickMethod = "quantile", this.tickCount = 5, this.nice = !0;
  }, t;
}(v4), p4 = {};
function u0e(r) {
  return p4[r];
}
function Ya(r, t) {
  if (u0e(r))
    throw new Error("type '" + r + "' existed.");
  p4[r] = t;
}
var f0e = function(r) {
  Ht(t, r);
  function t() {
    var e = r !== null && r.apply(this, arguments) || this;
    return e.type = "identity", e.isIdentity = !0, e;
  }
  return t.prototype.calculateTicks = function() {
    return this.values;
  }, t.prototype.scale = function(e) {
    return this.values[0] !== e && At(e) ? e : this.range[0];
  }, t.prototype.invert = function(e) {
    var n = this.range;
    return e < n[0] || e > n[1] ? NaN : this.values[0];
  }, t;
}(o_);
function g4(r) {
  var t = r.values, e = r.tickInterval, n = r.tickCount, i = r.showLast;
  if (At(e)) {
    var a = Ap(t, function(v, p) {
      return p % e === 0;
    }), o = zi(t);
    return i && zi(a) !== o && a.push(o), a;
  }
  var s = t.length, u = r.min, f = r.max;
  if (Tt(u) && (u = 0), Tt(f) && (f = t.length - 1), !At(n) || n >= s)
    return t.slice(u, f + 1);
  if (n <= 0 || f <= 0)
    return [];
  for (var l = n === 1 ? s : Math.floor(s / (n - 1)), c = [], h = u, d = 0; d < n && !(h >= f); d++)
    h = Math.min(u + d * l, f), d === n - 1 && i ? c.push(t[f]) : c.push(t[h]);
  return c;
}
function l0e(r) {
  var t = r.min, e = r.max, n = r.nice, i = r.tickCount, a = new c0e();
  return a.domain([t, e]), n && a.nice(i), a.ticks(i);
}
var $y = 5, WO = Math.sqrt(50), VO = Math.sqrt(10), XO = Math.sqrt(2), c0e = function() {
  function r() {
    this._domain = [0, 1];
  }
  return r.prototype.domain = function(t) {
    return t ? (this._domain = Array.from(t, Number), this) : this._domain.slice();
  }, r.prototype.nice = function(t) {
    var e, n;
    t === void 0 && (t = $y);
    var i = this._domain.slice(), a = 0, o = this._domain.length - 1, s = this._domain[a], u = this._domain[o], f;
    return u < s && (e = [u, s], s = e[0], u = e[1], n = [o, a], a = n[0], o = n[1]), f = kv(s, u, t), f > 0 ? (s = Math.floor(s / f) * f, u = Math.ceil(u / f) * f, f = kv(s, u, t)) : f < 0 && (s = Math.ceil(s * f) / f, u = Math.floor(u * f) / f, f = kv(s, u, t)), f > 0 ? (i[a] = Math.floor(s / f) * f, i[o] = Math.ceil(u / f) * f, this.domain(i)) : f < 0 && (i[a] = Math.ceil(s * f) / f, i[o] = Math.floor(u * f) / f, this.domain(i)), this;
  }, r.prototype.ticks = function(t) {
    return t === void 0 && (t = $y), h0e(this._domain[0], this._domain[this._domain.length - 1], t || $y);
  }, r;
}();
function h0e(r, t, e) {
  var n, i = -1, a, o, s;
  if (t = +t, r = +r, e = +e, r === t && e > 0)
    return [r];
  if ((n = t < r) && (a = r, r = t, t = a), (s = kv(r, t, e)) === 0 || !isFinite(s))
    return [];
  if (s > 0)
    for (r = Math.ceil(r / s), t = Math.floor(t / s), o = new Array(a = Math.ceil(t - r + 1)); ++i < a; )
      o[i] = (r + i) * s;
  else
    for (r = Math.floor(r * s), t = Math.ceil(t * s), o = new Array(a = Math.ceil(r - t + 1)); ++i < a; )
      o[i] = (r - i) / s;
  return n && o.reverse(), o;
}
function kv(r, t, e) {
  var n = (t - r) / Math.max(0, e), i = Math.floor(Math.log(n) / Math.LN10), a = n / Math.pow(10, i);
  return i >= 0 ? (a >= WO ? 10 : a >= VO ? 5 : a >= XO ? 2 : 1) * Math.pow(10, i) : -Math.pow(10, -i) / (a >= WO ? 10 : a >= VO ? 5 : a >= XO ? 2 : 1);
}
function YO(r, t, e) {
  var n;
  return e === "ceil" ? n = Math.ceil(r / t) : e === "floor" ? n = Math.floor(r / t) : n = Math.round(r / t), n * t;
}
function u_(r, t, e) {
  var n = YO(r, e, "floor"), i = YO(t, e, "ceil");
  n = fv(n, e), i = fv(i, e);
  for (var a = [], o = Math.max((i - n) / (Math.pow(2, 12) - 1), e), s = n; s <= i; s = s + o) {
    var u = fv(s, o);
    a.push(u);
  }
  return {
    min: n,
    max: i,
    ticks: a
  };
}
function f_(r, t, e) {
  var n, i = r.minLimit, a = r.maxLimit, o = r.min, s = r.max, u = r.tickCount, f = u === void 0 ? 5 : u, l = Tt(i) ? Tt(t) ? o : t : i, c = Tt(a) ? Tt(e) ? s : e : a;
  if (l > c && (n = [l, c], c = n[0], l = n[1]), f <= 2)
    return [l, c];
  for (var h = (c - l) / (f - 1), d = [], v = 0; v < f; v++)
    d.push(l + h * v);
  return d;
}
function d0e(r) {
  var t = r.min, e = r.max, n = r.tickInterval, i = r.minLimit, a = r.maxLimit, o = l0e(r);
  return !Tt(i) || !Tt(a) ? f_(r, Fa(o), zi(o)) : n ? u_(t, e, n).ticks : o;
}
function Js(r) {
  return Math.abs(r) < 1e-15 ? r : parseFloat(r.toFixed(15));
}
var v0e = [1, 5, 2, 2.5, 4, 3], HO = Number.EPSILON * 100;
function p0e(r, t) {
  return (r % t + t) % t;
}
function g0e(r) {
  return Math.round(r * 1e12) / 1e12;
}
function y0e(r, t, e, n, i, a) {
  var o = Op(t), s = X1(t, r), u = 0, f = p0e(n, a);
  return (f < HO || a - f < HO) && n <= 0 && i >= 0 && (u = 1), 1 - s / (o - 1) - e + u;
}
function m0e(r, t, e) {
  var n = Op(t), i = X1(t, r), a = 1;
  return 1 - i / (n - 1) - e + a;
}
function b0e(r, t, e, n, i, a) {
  var o = (r - 1) / (a - i), s = (t - 1) / (Math.max(a, n) - Math.min(e, i));
  return 2 - Math.max(o / s, s / o);
}
function x0e(r, t) {
  return r >= t ? 2 - (r - 1) / (t - 1) : 1;
}
function _0e(r, t, e, n) {
  var i = t - r;
  return 1 - 0.5 * (Math.pow(t - n, 2) + Math.pow(r - e, 2)) / Math.pow(0.1 * i, 2);
}
function w0e(r, t, e) {
  var n = t - r;
  if (e > n) {
    var i = (e - n) / 2;
    return 1 - Math.pow(i, 2) / Math.pow(0.1 * n, 2);
  }
  return 1;
}
function E0e() {
  return 1;
}
function S0e(r, t, e, n, i, a) {
  e === void 0 && (e = 5), n === void 0 && (n = !0), i === void 0 && (i = v0e), a === void 0 && (a = [0.25, 0.2, 0.5, 0.05]);
  var o = e < 0 ? 0 : Math.round(e);
  if (Number.isNaN(r) || Number.isNaN(t) || typeof r != "number" || typeof t != "number" || !o)
    return {
      min: 0,
      max: 0,
      ticks: []
    };
  if (t - r < 1e-15 || o === 1)
    return {
      min: r,
      max: t,
      ticks: [r]
    };
  if (t - r > 1e148) {
    var s = e || 5, u = (t - r) / s;
    return {
      min: r,
      max: t,
      ticks: Array(s).fill(null).map(function(q, ne) {
        return Js(r + u * ne);
      })
    };
  }
  for (var f = {
    score: -2,
    lmin: 0,
    lmax: 0,
    lstep: 0
  }, l = 1; l < 1 / 0; ) {
    for (var c = 0; c < i.length; c += 1) {
      var h = i[c], d = m0e(h, i, l);
      if (a[0] * d + a[1] + a[2] + a[3] < f.score) {
        l = 1 / 0;
        break;
      }
      for (var v = 2; v < 1 / 0; ) {
        var p = x0e(v, o);
        if (a[0] * d + a[1] + a[2] * p + a[3] < f.score)
          break;
        for (var g = (t - r) / (v + 1) / l / h, y = Math.ceil(Math.log10(g)); y < 1 / 0; ) {
          var b = l * h * Math.pow(10, y), m = w0e(r, t, b * (v - 1));
          if (a[0] * d + a[1] * m + a[2] * p + a[3] < f.score)
            break;
          var x = Math.floor(t / b) * l - (v - 1) * l, _ = Math.ceil(r / b) * l;
          if (x <= _)
            for (var s = _ - x, w = 0; w <= s; w += 1) {
              var E = x + w, M = E * (b / l), C = M + b * (v - 1), S = b, A = y0e(h, i, l, M, C, S), T = _0e(r, t, M, C), P = b0e(v, o, r, t, M, C), k = E0e(), L = a[0] * A + a[1] * T + a[2] * P + a[3] * k;
              L > f.score && (!n || M <= r && C >= t) && (f.lmin = M, f.lmax = C, f.lstep = S, f.score = L);
            }
          y += 1;
        }
        v += 1;
      }
    }
    l += 1;
  }
  var O = Js(f.lmax), D = Js(f.lmin), G = Js(f.lstep), R = Math.floor(g0e((O - D) / G)) + 1, F = new Array(R);
  F[0] = Js(D);
  for (var c = 1; c < R; c++)
    F[c] = Js(F[c - 1] + G);
  return {
    min: Math.min(r, Fa(F)),
    max: Math.max(t, zi(F)),
    ticks: F
  };
}
function M0e(r) {
  var t = r.min, e = r.max, n = r.tickCount, i = r.nice, a = r.tickInterval, o = r.minLimit, s = r.maxLimit, u = S0e(t, e, n, i).ticks;
  return !Tt(o) || !Tt(s) ? f_(r, Fa(u), zi(u)) : a ? u_(t, e, a).ticks : u;
}
function C0e(r) {
  var t = r.base, e = r.tickCount, n = r.min, i = r.max, a = r.values, o, s = Ri(t, i);
  if (n > 0)
    o = Math.floor(Ri(t, n));
  else {
    var u = d4(a, t, i);
    o = Math.floor(Ri(t, u));
  }
  for (var f = s - o, l = Math.ceil(f / e), c = [], h = o; h < s + l; h = h + l)
    c.push(Math.pow(t, h));
  return n <= 0 && c.unshift(0), c;
}
function y4(r, t, e) {
  if (e === void 0 && (e = 5), r === t)
    return {
      max: t,
      min: r,
      ticks: [r]
    };
  var n = e < 0 ? 0 : Math.round(e);
  if (n === 0)
    return { max: t, min: r, ticks: [] };
  var i = 1.5, a = 0.5 + 1.5 * i, o = t - r, s = o / n, u = Math.pow(10, Math.floor(Math.log10(s))), f = u;
  2 * u - s < i * (s - f) && (f = 2 * u, 5 * u - s < a * (s - f) && (f = 5 * u, 10 * u - s < i * (s - f) && (f = 10 * u)));
  for (var l = Math.ceil(t / f), c = Math.floor(r / f), h = Math.max(l * f, t), d = Math.min(c * f, r), v = Math.floor((h - d) / f) + 1, p = new Array(v), g = 0; g < v; g++)
    p[g] = Js(d + g * f);
  return {
    min: d,
    max: h,
    ticks: p
  };
}
function T0e(r) {
  var t = r.exponent, e = r.tickCount, n = Math.ceil(ts(t, r.max)), i = Math.floor(ts(t, r.min)), a = y4(i, n, e).ticks;
  return a.map(function(o) {
    var s = o >= 0 ? 1 : -1;
    return Math.pow(o, t) * s;
  });
}
function A0e(r, t) {
  var e = r.length * t;
  return t === 1 ? r[r.length - 1] : t === 0 ? r[0] : e % 1 !== 0 ? r[Math.ceil(e) - 1] : r.length % 2 === 0 ? (r[e - 1] + r[e]) / 2 : r[e];
}
function I0e(r) {
  var t = r.tickCount, e = r.values;
  if (!e || !e.length)
    return [];
  for (var n = e.slice().sort(function(s, u) {
    return s - u;
  }), i = [], a = 0; a < t; a++) {
    var o = a / (t - 1);
    i.push(A0e(n, o));
  }
  return i;
}
function P0e(r) {
  var t = r.min, e = r.max, n = r.tickCount, i = r.tickInterval, a = r.minLimit, o = r.maxLimit, s = y4(t, e, n).ticks;
  return !Tt(a) || !Tt(o) ? f_(r, Fa(s), zi(s)) : i ? u_(t, e, i).ticks : s;
}
function O0e(r) {
  var t = r.min, e = r.max, n = r.minTickInterval, i = r.tickInterval, a = r.tickCount;
  if (i)
    a = Math.ceil((e - t) / i);
  else {
    i = t0e(t, e, a)[1];
    var o = (e - t) / i, s = o / a;
    s > 1 && (i = i * Math.ceil(s)), n && i < n && (i = n);
  }
  i = Math.max(Math.floor((e - t) / (Math.pow(2, 12) - 1)), i);
  for (var u = [], f = t; f < e + i; f += i)
    u.push(f);
  return u;
}
function D0e(r) {
  var t = g4(U({ showLast: !0 }, r));
  return t;
}
function Mp(r) {
  return new Date(r).getFullYear();
}
function k0e(r) {
  return new Date(r, 0, 1).getTime();
}
function O1(r) {
  return new Date(r).getMonth();
}
function L0e(r, t) {
  var e = Mp(r), n = Mp(t), i = O1(r), a = O1(t);
  return (n - e) * 12 + (a - i) % 12;
}
function N0e(r, t) {
  return new Date(r, t, 1).getTime();
}
function R0e(r, t) {
  return Math.ceil((t - r) / xo);
}
function B0e(r, t) {
  return Math.ceil((t - r) / hu);
}
function G0e(r, t) {
  return Math.ceil((t - r) / (60 * 1e3));
}
function F0e(r) {
  var t = r.min, e = r.max, n = r.minTickInterval, i = r.tickCount, a = r.tickInterval, o = [];
  a || (a = (e - t) / i, n && a < n && (a = n)), a = Math.max(Math.floor((e - t) / (Math.pow(2, 12) - 1)), a);
  var s = Mp(t);
  if (a > $O)
    for (var u = Mp(e), f = Math.ceil(a / $O), l = s; l <= u + f; l = l + f)
      o.push(k0e(l));
  else if (a > Ec)
    for (var c = Math.ceil(a / Ec), h = O1(t), d = L0e(t, e), l = 0; l <= d + c; l = l + c)
      o.push(N0e(s, l + h));
  else if (a > xo)
    for (var v = new Date(t), p = v.getFullYear(), g = v.getMonth(), y = v.getDate(), b = Math.ceil(a / xo), m = R0e(t, e), l = 0; l < m + b; l = l + b)
      o.push(new Date(p, g, y + l).getTime());
  else if (a > hu)
    for (var v = new Date(t), p = v.getFullYear(), g = v.getMonth(), b = v.getDate(), x = v.getHours(), _ = Math.ceil(a / hu), w = B0e(t, e), l = 0; l <= w + _; l = l + _)
      o.push(new Date(p, g, b, x + l).getTime());
  else if (a > cu)
    for (var E = G0e(t, e), M = Math.ceil(a / cu), l = 0; l <= E + M; l = l + M)
      o.push(t + l * cu);
  else {
    var C = a;
    C < Ji && (C = Ji);
    for (var S = Math.floor(t / Ji) * Ji, A = Math.ceil((e - t) / Ji), T = Math.ceil(C / Ji), l = 0; l < A + T; l = l + T)
      o.push(S + l * Ji);
  }
  return o.length >= 512 && console.warn("Notice: current ticks length(" + o.length + ') >= 512, may cause performance issues, even out of memory. Because of the configure "tickInterval"(in milliseconds, current is ' + a + ") is too small, increase the value to solve the problem!"), o;
}
Xa("cat", g4);
Xa("time-cat", D0e);
Xa("wilkinson-extended", M0e);
Xa("r-pretty", P0e);
Xa("time", O0e);
Xa("time-pretty", F0e);
Xa("log", C0e);
Xa("pow", T0e);
Xa("quantile", I0e);
Xa("d3-linear", d0e);
Ya("cat", Th);
Ya("category", Th);
Ya("identity", f0e);
Ya("linear", Ah);
Ya("log", i0e);
Ya("pow", a0e);
Ya("time", o0e);
Ya("timeCat", r0e);
Ya("quantize", v4);
Ya("quantile", s0e);
var z0e = globalThis && globalThis.__spreadArray || function(r, t, e) {
  if (e || arguments.length === 2)
    for (var n = 0, i = t.length, a; n < i; n++)
      (a || !(n in t)) && (a || (a = Array.prototype.slice.call(t, 0, n)), a[n] = t[n]);
  return r.concat(a || Array.prototype.slice.call(t));
};
function U0e(r) {
  return vu(r, function(t, e) {
    var n = e === 0 ? "M" : "L", i = t[0], a = t[1];
    return [n, i, a];
  });
}
function m4(r) {
  return U0e(r);
}
function j0e(r) {
  if (r.length <= 2)
    return m4(r);
  var t = [];
  Se(r, function(o) {
    ls(o, t.slice(t.length - 2)) || t.push(o[0], o[1]);
  });
  var e = SN(t, !1), n = Fa(r), i = n[0], a = n[1];
  return e.unshift(["M", i, a]), e;
}
function $0e(r, t, e, n) {
  n === void 0 && (n = !0);
  var i = new Ah({
    values: r
  }), a = new Th({
    values: vu(r, function(s, u) {
      return u;
    })
  }), o = vu(r, function(s, u) {
    return [a.scale(u) * t, e - i.scale(s) * e];
  });
  return n ? j0e(o) : m4(o);
}
function W0e(r, t, e, n) {
  n === void 0 && (n = 5);
  for (var i = new Ah({
    values: r
  }), a = new Th({
    values: vu(r, function(h, d) {
      return d;
    })
  }), o = vu(r, function(h, d) {
    return [a.scale(d) * t, e - i.scale(h) * e];
  }), s = [], u = 0; u < o.length; u++) {
    var f = o[u], l = {
      x: f[0],
      y: f[1],
      y0: e,
      size: n
    }, c = Y0e(l);
    s.push.apply(s, c);
  }
  return H0e(s);
}
function V0e(r, t) {
  var e = new Ah({
    values: r
  }), n = Math.max(0, e.min);
  return t - e.scale(n) * t;
}
function X0e(r, t, e, n) {
  var i = z0e([], r, !0), a = V0e(n, e);
  return i.push(["L", t, a]), i.push(["L", 0, a]), i.push(["Z"]), i;
}
function Y0e(r) {
  var t = r.x, e = r.y, n = r.y0, i = r.size, a, o;
  Dt(e) ? (a = e[0], o = e[1]) : (a = n, o = e);
  var s, u;
  Dt(t) ? (s = t[0], u = t[1]) : (s = t - i / 2, u = t + i / 2);
  var f = [{
    x: s,
    y: a
  }, {
    x: s,
    y: o
  }];
  return f.push({
    x: u,
    y: o
  }, {
    x: u,
    y: a
  }), f;
}
function H0e(r, t) {
  t === void 0 && (t = !0);
  var e = [], n = r[0];
  e.push(["M", n.x, n.y]);
  for (var i = 1, a = r.length; i < a; i++)
    e.push(["L", r[i].x, r[i].y]);
  return t && (e.push(["L", n.x, n.y]), e.push(["z"])), e;
}
var Sc = globalThis && globalThis.__assign || function() {
  return Sc = Object.assign || function(r) {
    for (var t, e = 1, n = arguments.length; e < n; e++) {
      t = arguments[e];
      for (var i in t)
        Object.prototype.hasOwnProperty.call(t, i) && (r[i] = t[i]);
    }
    return r;
  }, Sc.apply(this, arguments);
}, K0e = {
  stroke: "#C5C5C5",
  strokeOpacity: 0.85
}, q0e = {
  fill: "#CACED4",
  opacity: 0.85
}, Z0e = function() {
  function r(t) {
    var e = t.x, n = e === void 0 ? 0 : e, i = t.y, a = i === void 0 ? 0 : i, o = t.width, s = o === void 0 ? 200 : o, u = t.height, f = u === void 0 ? 26 : u, l = t.smooth, c = l === void 0 ? !0 : l, h = t.isArea, d = h === void 0 ? !1 : h, v = t.data, p = v === void 0 ? [] : v, g = t.lineStyle, y = t.areaStyle, b = t.group, m = t.interval, x = m === void 0 ? null : m;
    this.group = b, this.x = n, this.y = a, this.width = s, this.height = f, this.data = p, this.smooth = c, this.isArea = d, this.lineStyle = Object.assign({}, K0e, g), this.areaStyle = Object.assign({}, q0e, y), this.intervalConfig = x, this.renderLine();
  }
  return r.prototype.renderLine = function() {
    var t = this, e = t.x, n = t.y, i = t.width, a = t.height;
    t.barWidth;
    var o = t.data, s = t.smooth, u = t.isArea, f = t.lineStyle, l = t.areaStyle, c = this.group.addGroup({
      name: "trend-group"
    });
    if (o) {
      var h = $0e(o, i, a, s);
      if (c.addShape("path", {
        attrs: Sc({
          path: h
        }, f),
        name: "trend-line"
      }), u) {
        var d = X0e(h, i, a, o);
        c.addShape("path", {
          attrs: Sc({
            path: d
          }, l),
          name: "trend-area"
        });
      }
    }
    this.intervalConfig && c.addShape("path", {
      attrs: Sc({
        path: W0e(this.intervalConfig.data, i, a, this.intervalConfig.style.barWidth)
      }, this.intervalConfig.style),
      name: "trend-interval"
    }), c.move(e, n);
  }, r.prototype.destory = function() {
    this.group.destroy();
  }, r;
}();
const Q0e = Z0e;
var Af = globalThis && globalThis.__assign || function() {
  return Af = Object.assign || function(r) {
    for (var t, e = 1, n = arguments.length; e < n; e++) {
      t = arguments[e];
      for (var i in t)
        Object.prototype.hasOwnProperty.call(t, i) && (r[i] = t[i]);
    }
    return r;
  }, Af.apply(this, arguments);
}, J0e = {
  fill: "#1890ff",
  stroke: "#1890ff",
  type: "trend",
  radius: 2,
  opacity: 1,
  cursor: "ew-resize",
  highLightFill: "#0050b3"
}, eye = {
  fill: "#fff",
  stroke: "#1890ff",
  radius: 2,
  opacity: 1,
  cursor: "ew-resize"
}, tye = function() {
  function r(t) {
    var e = t.group, n = t.name, i = t.type, a = t.x, o = a === void 0 ? 0 : a, s = t.y, u = s === void 0 ? 0 : s, f = t.width, l = f === void 0 ? 2 : f, c = t.height, h = c === void 0 ? 24 : c, d = t.style, v = d === void 0 ? {} : d;
    this.group = e, this.name = n, this.handleType = i, this.x = o, this.y = u, this.width = l, this.height = h, i === "trend" ? this.style = Af(Af({}, J0e), v) : i === "simple" && (this.style = Af(Af({}, eye), v)), this.renderHandle();
  }
  return r.prototype.setX = function(t) {
    this.setXY(t, void 0);
  }, r.prototype.setY = function(t) {
    this.setXY(void 0, t);
  }, r.prototype.setXY = function(t, e) {
    At(t) && (this.x = t), At(e) && (this.y = e), this.updateXY();
  }, r.prototype.renderHandle = function() {
    var t = this, e = t.width, n = t.height, i = t.style, a = t.name, o = i.fill, s = i.stroke, u = i.radius, f = i.opacity, l = i.cursor;
    this.handleGroup = this.group.addGroup(), this.handleType === "trend" ? (this.verticalLine = this.handleGroup.addShape("rect", {
      attrs: {
        x: 0,
        y: 0,
        width: e,
        height: n,
        fill: o,
        stroke: s,
        radius: u,
        opacity: f,
        cursor: l
      },
      name: "".concat(a, "-handler")
    }), this.topCircle = this.handleGroup.addShape("circle", {
      attrs: {
        x: e / 2,
        y: 0,
        r: 2 * e,
        fill: o,
        stroke: s,
        radius: u,
        opacity: f,
        cursor: l,
        lineAppendWidth: 12
      },
      name: "".concat(a, "-handler")
    }), this.bottomCircle = this.handleGroup.addShape("circle", {
      attrs: {
        x: e / 2,
        y: n,
        r: 2 * e,
        fill: o,
        stroke: s,
        radius: u,
        opacity: f,
        cursor: l
      },
      name: "".concat(a, "-handler")
    })) : this.handleType === "simple" && (this.topCircle = this.handleGroup.addShape("circle", {
      attrs: {
        x: e / 2,
        y: n / 2,
        r: 2 * e,
        fill: o,
        stroke: s,
        radius: u,
        opacity: f,
        cursor: l,
        lineWidth: 2
      },
      name: "".concat(a, "-handler")
    })), this.updateXY(), this.handleType === "trend" ? this.bindTrendEvents() : this.handleType === "simple" && this.bindSimpleEvents();
  }, r.prototype.bindSimpleEvents = function() {
    var t = this, e = this.name;
    this.handleGroup.on("".concat(e, "-handler:mouseenter"), function() {
      var n = t.style.highLightFill;
      t.topCircle.attr("fill", n);
    }), this.handleGroup.on("".concat(e, "-handler:mouseleave"), function() {
      var n = t.style.fill;
      t.topCircle.attr("fill", n);
    });
  }, r.prototype.bindTrendEvents = function() {
    var t = this, e = this.name;
    this.handleGroup.on("".concat(e, "-handler:mouseenter"), function() {
      var n = t.style.highLightFill;
      t.verticalLine.attr("fill", n), t.topCircle.attr("fill", n), t.bottomCircle.attr("fill", n);
    }), this.handleGroup.on("".concat(e, "-handler:mouseleave"), function() {
      var n = t.style.fill;
      t.verticalLine.attr("fill", n), t.topCircle.attr("fill", n), t.bottomCircle.attr("fill", n);
    });
  }, r.prototype.show = function() {
    this.handleGroup.show();
  }, r.prototype.hide = function() {
    this.handleGroup.hide();
  }, r.prototype.updateXY = function() {
    this.handleGroup.setMatrix([1, 0, 0, 0, 1, 0, this.x, this.y, 1]);
  }, r;
}();
const KO = tye;
var b4 = "timebarstartplay", x4 = "timebarendplay", Ca = "valuechange", du = "timebarConfigChanged", ss = "playPauseBtn", qc = "nextStepBtn", Zc = "preStepBtn", D1 = globalThis && globalThis.__assign || function() {
  return D1 = Object.assign || function(r) {
    for (var t, e = 1, n = arguments.length; e < n; e++) {
      t = arguments[e];
      for (var i in t)
        Object.prototype.hasOwnProperty.call(t, i) && (r[i] = t[i]);
    }
    return r;
  }, D1.apply(this, arguments);
}, rye = function() {
  function r(t) {
    this.config = kr({}, t), this.init();
  }
  return r.prototype.update = function(t) {
    this.config = kr({}, this.config, t), this.updateElement(), this.renderMarker();
  }, r.prototype.init = function() {
    this.initElement(), this.renderMarker();
  }, r.prototype.initElement = function() {
    var t = this.config, e = t.group, n = t.style, i = n.scale, a = i === void 0 ? 1 : i, o = n.offsetX, s = o === void 0 ? 0 : o, u = n.offsetY, f = u === void 0 ? 0 : u, l = this.config.x + s, c = this.config.y + f, h = e.addGroup({
      name: ss
    });
    this.startMarkerGroup = h.addGroup({
      name: ss
    }), this.circle = e.addShape("circle", {
      attrs: D1({
        x: l,
        y: c,
        r: this.config.r * a
      }, n),
      name: ss
    }), this.startMarker = this.startMarkerGroup.addShape("path", {
      attrs: {
        path: this.getStartMarkerPath(l, c, a),
        fill: n.stroke || "#aaa"
      },
      name: "start-marker"
    }), this.pauseMarkerGroup = h.addGroup({
      name: ss
    });
    var d = 0.25 * this.config.r * a, v = 0.5 * this.config.r * Math.sqrt(3) * a;
    this.pauseLeftMarker = this.pauseMarkerGroup.addShape("rect", {
      attrs: {
        x: l - 0.375 * this.config.r * a,
        y: c - v / 2,
        width: d,
        height: v,
        fill: n.stroke || "#aaa",
        lineWidth: 0
      }
    }), this.pauseRightMarker = this.pauseMarkerGroup.addShape("rect", {
      attrs: {
        x: l + 1 / 8 * this.config.r * a,
        y: c - v / 2,
        width: d,
        height: v,
        fill: n.stroke || "#aaa",
        lineWidth: 0
      }
    });
  }, r.prototype.updateElement = function() {
    var t = this.config.style, e = t.scale, n = e === void 0 ? 1 : e, i = t.offsetX, a = i === void 0 ? 0 : i, o = t.offsetY, s = o === void 0 ? 0 : o, u = this.config.x + a, f = this.config.y + s;
    this.circle.attr("x", u), this.circle.attr("y", f), this.circle.attr("r", this.config.r * n), this.startMarker.attr("path", this.getStartMarkerPath(u, f, n));
    var l = 0.25 * this.config.r * n, c = 0.5 * this.config.r * Math.sqrt(3) * n;
    this.pauseLeftMarker.attr("x", u - (1 / 4 + 1 / 8) * this.config.r * n), this.pauseLeftMarker.attr("y", f - c / 2), this.pauseLeftMarker.attr("width", l), this.pauseLeftMarker.attr("height", c), this.pauseRightMarker.attr("x", u + 1 / 8 * this.config.r * n), this.pauseRightMarker.attr("y", f - c / 2), this.pauseRightMarker.attr("width", l), this.pauseRightMarker.attr("height", c);
  }, r.prototype.renderMarker = function() {
    this.config.isPlay ? (this.startMarkerGroup.hide(), this.pauseMarkerGroup.show()) : (this.startMarkerGroup.show(), this.pauseMarkerGroup.hide());
  }, r.prototype.getStartMarkerPath = function(t, e, n) {
    var i = 0.5 * this.config.r * Math.sqrt(3) * n;
    return [["M", t - i / Math.sqrt(3) / 2, e - i / 2], ["L", t + i / Math.sqrt(3), e], ["L", t - i / Math.sqrt(3) / 2, e + i / 2]];
  }, r;
}();
const nye = rye;
var ln = globalThis && globalThis.__assign || function() {
  return ln = Object.assign || function(r) {
    for (var t, e = 1, n = arguments.length; e < n; e++) {
      t = arguments[e];
      for (var i in t)
        Object.prototype.hasOwnProperty.call(t, i) && (r[i] = t[i]);
    }
    return r;
  }, ln.apply(this, arguments);
}, Ql = $i, iye = "#aaa", aye = "green", oye = {
  fill: "#aaa",
  fillOpacity: 0.35,
  stroke: "#aaa"
}, sye = {
  fill: "#fff"
}, uye = {
  fill: "green"
}, _4 = {
  pointer: {
    fill: "#aaa",
    lineWidth: 0
  },
  scroller: {
    stroke: "#aaa",
    fill: "#aaa",
    lineWidth: 1,
    lineAppendWidth: 5,
    cursor: "pointer"
  },
  text: {
    fill: "#aaa",
    textBaseline: "top"
  }
}, w4 = {
  check: {
    stroke: "green",
    lineWidth: 3
  },
  box: {
    fill: "#fff",
    stroke: "#aaa",
    lineWidth: 2,
    radius: 3,
    width: 12,
    height: 12
  },
  text: {
    fill: "#aaa",
    fontSize: 12,
    textBaseline: "top"
  }
}, fye = {
  speed: 1,
  loop: !1,
  fill: "#fff",
  stroke: "#fff",
  hideTimeTypeController: !1,
  preBtnStyle: {
    fill: "#aaa",
    stroke: "#aaa"
  },
  nextBtnStyle: {
    fill: "#aaa",
    stroke: "#aaa"
  },
  playBtnStyle: {
    fill: "#aaa",
    stroke: "#aaa",
    fillOpacity: 0.05
  },
  speedControllerStyle: _4,
  timeTypeControllerStyle: w4
}, Wy = 110, Yo = 50, lye = function() {
  function r(t) {
    this.controllerCfg = kr({}, fye, t), this.group = t.group, this.controllerGroup = this.group.addGroup({
      name: "controller-group"
    }), this.speedAxisY = [], this.currentSpeed = this.controllerCfg.speed, this.currentType = "range", this.fontFamily = t.fontFamily || "Arial, sans-serif", this.init();
  }
  return r.prototype.init = function() {
    this.renderPlayButton();
  }, r.prototype.getNextMarkerPath = function(t, e, n) {
    return [["M", t, e - n], ["L", t + n, e], ["L", t, e + n], ["Z", t, e - n], ["M", t, e], ["L", t - n, e - n], ["L", t - n, e + n], ["Z"]];
  }, r.prototype.getPreMarkerPath = function(t, e, n) {
    return [["M", t, e - n], ["L", t - n, e], ["L", t, e + n], ["L", t, e - n], ["M", t, e], ["L", t + n, e - n], ["L", t + n, e + n], ["Z"]];
  }, r.prototype.renderPlayButton = function() {
    var t = this.controllerCfg, e = t.width, n = t.height, i = t.x, a = t.y, o = t.hideTimeTypeController, s = t.fill, u = s === void 0 ? iye : s, f = t.stroke, l = f === void 0 ? aye : f, c = t.containerStyle, h = c === void 0 ? {} : c, d = ln(ln({}, oye), t.playBtnStyle || {}), v = ln(ln({}, sye), t.preBtnStyle || {}), p = ln(ln({}, uye), t.nextBtnStyle || {}), g = n / 2 - 5, y = a + 10, b = this.controllerGroup.addShape("rect", {
      attrs: ln({
        x: i,
        y,
        width: e,
        height: n,
        stroke: l,
        fill: u
      }, h),
      name: "container-rect"
    });
    this.playButton ? this.playButton.update({
      x: e / 2,
      y,
      r: g
    }) : this.playButton = new nye({
      group: this.controllerGroup,
      x: e / 2,
      y: y + g + 5,
      r: g,
      isPlay: this.isPlay,
      style: d
    });
    var m = v.offsetX || 0, x = v.offsetY || 0, _ = (v.scale || 1) * g;
    this.controllerGroup.addShape("path", {
      attrs: ln({
        path: this.getPreMarkerPath(e / 2 - 5 * g + m, y + g + 5 + x, _ * 0.5)
      }, v),
      name: Zc
    });
    var w = p.offsetX || 0, E = p.offsetY || 0, M = (p.scale || 1) * g;
    this.controllerGroup.addShape("path", {
      attrs: ln({
        path: this.getNextMarkerPath(e / 2 + 5 * g + w, y + g + 5 + E, M * 0.5)
      }, p),
      name: qc
    }), b.toBack(), this.renderSpeedBtn(), o || this.renderToggleTime(), this.bindEvent();
    var C = this.controllerCfg.scale, S = C === void 0 ? 1 : C, A = this.controllerGroup.getCanvasBBox(), T = (A.maxX + A.minX) / 2, P = (A.maxY + A.minY) / 2, k = Ql([1, 0, 0, 0, 1, 0, 0, 0, 1], [["t", -T, -P], ["s", S, S], ["t", T, P]]);
    this.controllerGroup.setMatrix(k);
  }, r.prototype.renderSpeedBtn = function() {
    var t = this.controllerCfg, e = t.y, n = t.width, i = t.hideTimeTypeController, a = ln(ln({}, _4), this.controllerCfg.speedControllerStyle || {}), o = a.scroller, s = o === void 0 ? {} : o, u = a.text, f = u === void 0 ? {} : u, l = a.pointer, c = l === void 0 ? {} : l, h = a.scale, d = h === void 0 ? 1 : h, v = a.offsetX, p = v === void 0 ? 0 : v, g = a.offsetY, y = g === void 0 ? 0 : g, b = this.controllerGroup.addGroup({
      name: "speed-group"
    });
    this.speedGroup = b;
    var m = 5;
    this.speedAxisY = [19, 22, 26, 32, 39];
    for (var x = 0; x < 5; x++) {
      var _ = e + this.speedAxisY[x], w = n - (i ? Yo : Wy);
      b.addShape("line", {
        attrs: ln({
          x1: w,
          x2: w + 15,
          y1: _,
          y2: _
        }, s),
        speed: m,
        name: "speed-rect"
      }), this.speedAxisY[x] = _, m = m - 1;
    }
    this.speedText = b.addShape("text", {
      attrs: ln({
        x: n - (i ? Yo : Wy) + 20,
        y: this.speedAxisY[0] + 4,
        text: "1.0X",
        fontFamily: this.fontFamily || "Arial, sans-serif"
      }, f),
      name: "speed-text"
    }), this.speedPoint = b.addShape("path", {
      attrs: ln({
        path: this.getPointerPath(n - (i ? Yo : Wy), 0),
        matrix: [1, 0, 0, 0, 1, 0, 0, this.speedAxisY[4], 1]
      }, c),
      name: "speed-pointer"
    });
    var E = this.speedGroup.getCanvasBBox(), M = (E.maxX + E.minX) / 2, C = (E.maxY + E.minY) / 2, S = this.speedGroup.getMatrix() || [1, 0, 0, 0, 1, 0, 0, 0, 1];
    S = Ql(S, [["t", -M, -C], ["s", d, d], ["t", M + p * d, C + y * d]]), this.speedGroup.setMatrix(S);
  }, r.prototype.getPointerPath = function(t, e) {
    return [["M", t, e], ["L", t - 10, e - 4], ["L", t - 10, e + 4], ["Z"]];
  }, r.prototype.renderToggleTime = function() {
    var t, e = this.controllerCfg.width, n = ln(ln({}, w4), this.controllerCfg.timeTypeControllerStyle || {}), i = n.scale, a = i === void 0 ? 1 : i, o = n.offsetX, s = o === void 0 ? 0 : o, u = n.offsetY, f = u === void 0 ? 0 : u, l = n.box, c = l === void 0 ? {} : l, h = n.check, d = h === void 0 ? {} : h, v = n.text, p = v === void 0 ? {} : v;
    this.toggleGroup = this.controllerGroup.addGroup({
      name: "toggle-group"
    }), this.toggleGroup.addShape("rect", {
      attrs: ln({
        x: e - Yo,
        y: this.speedAxisY[0] + 3.5
      }, c),
      isChecked: !1,
      name: "toggle-model"
    }), this.checkedIcon = this.toggleGroup.addShape("path", {
      attrs: ln({
        path: [["M", e - Yo + 3, this.speedAxisY[1] + 6], ["L", e - Yo + 7, this.speedAxisY[1] + 10], ["L", e - Yo + 12, this.speedAxisY[1] + 4]]
      }, d),
      capture: !1,
      name: "check-icon"
    }), this.checkedIcon.hide(), this.checkedText = this.toggleGroup.addShape("text", {
      attrs: ln({
        text: ((t = this.controllerCfg) === null || t === void 0 ? void 0 : t.timePointControllerText) || "\u5355\u4E00\u65F6\u95F4",
        x: e - Yo + 15,
        y: this.speedAxisY[0] + 4,
        fontFamily: typeof window < "u" && window.getComputedStyle(document.body, null).getPropertyValue("font-family") || "Arial, sans-serif"
      }, p),
      name: "checked-text"
    });
    var g = this.toggleGroup.getCanvasBBox(), y = (g.maxX + g.minX) / 2, b = (g.maxY + g.minY) / 2, m = this.toggleGroup.getMatrix() || [1, 0, 0, 0, 1, 0, 0, 0, 1];
    m = Ql(m, [["t", -y, -b], ["s", a, a], ["t", y + s * a, b + f * a]]), this.toggleGroup.setMatrix(m);
  }, r.prototype.bindEvent = function() {
    var t = this;
    this.speedGroup.on("speed-rect:click", function(e) {
      var n = e.target.attr("y1"), i = t.speedPoint.attr("matrix"), a = t.speedAxisY.indexOf(i[7] || 0), o = t.speedAxisY.indexOf(n), s = t.speedAxisY[o] - t.speedAxisY[a];
      i = Ql(i, [["t", 0, s]]), t.speedPoint.setMatrix(i), t.currentSpeed = t.speedAxisY.length - o, t.speedText.attr("text", "".concat(t.currentSpeed, ".0X")), t.group.emit(du, {
        speed: t.currentSpeed,
        type: t.currentType
      });
    }), this.speedGroup.on("mousewheel", function(e) {
      e.preventDefault();
      var n = t.speedPoint.attr("matrix") || [1, 0, 0, 0, 1, 0, 0, 0, 1], i = n[7], a = t.speedAxisY.indexOf(i);
      if (a === -1) {
        var o = 1 / 0;
        t.speedAxisY.forEach(function(u, f) {
          var l = Math.abs(u - i);
          o > l && (o = l, a = f);
        });
      }
      e.originalEvent.deltaY > 0 ? a = Math.max(0, a - 1) : a = Math.min(t.speedAxisY.length - 1, a + 1);
      var s = t.speedAxisY[a] - i;
      n = Ql(n, [["t", 0, s]]), t.speedPoint.setMatrix(n), t.currentSpeed = t.speedAxisY.length - a, t.speedText.attr("text", "".concat(t.currentSpeed, ".0X")), t.group.emit(du, {
        speed: t.currentSpeed,
        type: t.currentType
      });
    }), this.toggleGroup && this.toggleGroup.on("toggle-model:click", function(e) {
      var n, i, a = e.target.get("isChecked");
      a ? (t.checkedIcon.hide(), t.checkedText.attr("text", ((i = t.controllerCfg) === null || i === void 0 ? void 0 : i.timePointControllerText) || "\u5355\u4E00\u65F6\u95F4"), t.currentType = "range") : (t.checkedIcon.show(), t.checkedText.attr("text", ((n = t.controllerCfg) === null || n === void 0 ? void 0 : n.timeRangeControllerText) || "\u65F6\u95F4\u8303\u56F4"), t.currentType = "single"), e.target.set("isChecked", !a), t.group.emit(du, {
        type: t.currentType,
        speed: t.currentSpeed
      });
    });
  }, r.prototype.destroy = function() {
    this.speedGroup.off("speed-rect:click"), this.toggleGroup && (this.toggleGroup.off("toggle-model:click"), this.toggleGroup.destroy()), this.speedGroup.destroy();
  }, r;
}();
const E4 = lye;
var Dr = globalThis && globalThis.__assign || function() {
  return Dr = Object.assign || function(r) {
    for (var t, e = 1, n = arguments.length; e < n; e++) {
      t = arguments[e];
      for (var i in t)
        Object.prototype.hasOwnProperty.call(t, i) && (r[i] = t[i]);
    }
    return r;
  }, Dr.apply(this, arguments);
}, cye = $i, hye = {
  fill: "#416180",
  opacity: 0.05
}, dye = {
  fill: "#416180",
  opacity: 0.15,
  radius: 5
}, vye = {
  fill: "#5B8FF9",
  opacity: 0.3,
  cursor: "grab"
}, k1 = 2, pye = {
  width: k1,
  height: 24
}, gye = {
  textBaseline: "middle",
  fill: "#000",
  opacity: 0.45
}, yye = {
  textAlign: "center",
  textBaseline: "top",
  fill: "#607889",
  opacity: 0.35
}, mye = {
  lineWidth: 1,
  stroke: "#ccc"
}, bye = function() {
  function r(t) {
    var e = this;
    this.prevX = 0, this.onMouseDown = function(q) {
      return function(ne) {
        e.currentHandler = q;
        var oe = ne.originalEvent;
        oe.stopPropagation(), oe.preventDefault(), e.prevX = co(oe, "touches.0.pageX", oe.pageX);
        var ie = e.canvas.get("container");
        ie.addEventListener("mousemove", e.onMouseMove), ie.addEventListener("mouseup", e.onMouseUp), ie.addEventListener("mouseleave", e.onMouseUp), ie.addEventListener("touchmove", e.onMouseMove), ie.addEventListener("touchend", e.onMouseUp), ie.addEventListener("touchcancel", e.onMouseUp);
      };
    }, this.onMouseMove = function(q) {
      q.stopPropagation(), q.preventDefault();
      var ne = co(q, "touches.0.pageX", q.pageX), oe = ne - e.prevX, ie = e.adjustOffsetRange(oe / e.width);
      e.updateStartEnd(ie), e.updateUI(), e.prevX = ne;
    }, this.onMouseUp = function() {
      e.currentHandler && (e.currentHandler = void 0);
      var q = e.canvas.get("container");
      q && (q.removeEventListener("mousemove", e.onMouseMove), q.removeEventListener("mouseup", e.onMouseUp), q.removeEventListener("mouseleave", e.onMouseUp), q.removeEventListener("touchmove", e.onMouseMove), q.removeEventListener("touchend", e.onMouseUp), q.removeEventListener("touchcancel", e.onMouseUp));
    };
    var n = t.x, i = n === void 0 ? 0 : n, a = t.y, o = a === void 0 ? 0 : a, s = t.width, u = s === void 0 ? 100 : s, f = t.height, l = t.padding, c = l === void 0 ? 10 : l, h = t.trendCfg, d = t.controllerCfg, v = d === void 0 ? {
      speed: 1
    } : d, p = t.backgroundStyle, g = p === void 0 ? {} : p, y = t.foregroundStyle, b = y === void 0 ? {} : y, m = t.handlerStyle, x = m === void 0 ? {} : m, _ = t.textStyle, w = _ === void 0 ? {} : _, E = t.start, M = E === void 0 ? 0 : E, C = t.end, S = C === void 0 ? 1 : C, A = t.minText, T = A === void 0 ? "" : A, P = t.maxText, k = P === void 0 ? "" : P, L = t.group, O = t.graph, D = t.canvas, G = t.tick, R = G === void 0 ? {
      tickLabelStyle: {},
      tickLineStyle: {},
      tickLabelFormatter: function(ne) {
        return ne;
      },
      ticks: []
    } : G, F = t.type;
    this.graph = O, this.canvas = D, this.group = L, this.timeBarType = F, this.x = i, this.y = o, this.width = u, this.height = f, this.padding = c, this.ticks = R.ticks, this.trendCfg = h, this.controllerCfg = v, this.currentSpeed = v.speed || 1, this.tickLabelFormatter = R.tickLabelFormatter, F === "trend" ? this.backgroundStyle = Dr(Dr({}, hye), g) : F === "simple" && (this.backgroundStyle = Dr(Dr({}, dye), g)), this.foregroundStyle = Dr(Dr({}, vye), b), this.handlerStyle = Dr(Dr({}, pye), x), this.textStyle = Dr(Dr({}, gye), w), this.tickLabelStyle = Dr(Dr({}, yye), R.tickLabelStyle), this.tickLineStyle = Dr(Dr({}, mye), R.tickLineStyle), this.currentMode = "range", this.start = M, this.end = S, this.minText = T, this.maxText = k, this.fontFamily = typeof window < "u" && window.getComputedStyle(document.body, null).getPropertyValue("font-family") || "Arial, sans-serif", this.renderSlider();
  }
  return r.prototype.update = function(t) {
    var e = t.x, n = t.y, i = t.width, a = t.height, o = t.minText, s = t.maxText, u = t.start, f = t.end;
    this.start = Math.min(1, Math.max(u, 0)), this.end = Math.min(1, Math.max(f, 0)), kt(this, {
      x: e,
      y: n,
      width: i,
      height: a,
      minText: o,
      maxText: s
    }), this.updateUI();
  }, r.prototype.setText = function(t, e) {
    this.minTextShape.attr("text", t), this.maxTextShape.attr("text", e);
  }, r.prototype.renderSlider = function() {
    var t = this, e = this, n = e.width, i = e.height, a = e.timeBarType;
    if (a === "trend" && Op(co(this.trendCfg, "data"))) {
      var o = new Q0e(Dr(Dr({
        x: this.x,
        y: this.y,
        width: n,
        height: i
      }, this.trendCfg), {
        group: this.group
      }));
      this.trendComponent = o;
    }
    var s = this.group.addGroup({
      name: "slider-group"
    });
    s.addShape("rect", {
      attrs: Dr({
        x: 0,
        y: 0,
        width: n,
        height: i
      }, this.backgroundStyle),
      name: "background"
    });
    var u = this.group.addGroup();
    a === "trend" ? (this.minTextShape = u.addShape("text", {
      attrs: Dr({
        x: 0,
        y: i / 2 + this.y,
        textAlign: "right",
        text: this.minText,
        silent: !1,
        fontFamily: this.fontFamily || "Arial, sans-serif",
        stroke: "#fff",
        lineWidth: 5
      }, this.textStyle),
      capture: !1,
      name: "min-text-shape"
    }), this.maxTextShape = u.addShape("text", {
      attrs: Dr({
        y: i / 2 + this.y,
        textAlign: "left",
        text: this.maxText,
        silent: !1,
        fontFamily: this.fontFamily || "Arial, sans-serif",
        stroke: "#fff",
        lineWidth: 5
      }, this.textStyle),
      capture: !1,
      name: "max-text-shape"
    })) : (this.minTextShape = u.addShape("text", {
      attrs: Dr({
        x: 0,
        y: this.y - 10,
        textAlign: "center",
        text: this.minText,
        silent: !1,
        fontFamily: this.fontFamily || "Arial, sans-serif",
        stroke: "#fff",
        lineWidth: 5
      }, this.textStyle),
      capture: !1,
      name: "min-text-shape"
    }), this.maxTextShape = u.addShape("text", {
      attrs: Dr({
        y: this.y - 10,
        textAlign: "center",
        text: this.maxText,
        silent: !1,
        fontFamily: this.fontFamily || "Arial, sans-serif",
        stroke: "#fff",
        lineWidth: 5
      }, this.textStyle),
      capture: !1,
      name: "max-text-shape"
    })), this.foregroundShape = this.group.addGroup().addShape("rect", {
      attrs: Dr({
        x: 0,
        y: this.y,
        height: i
      }, this.foregroundStyle),
      name: "foreground-shape"
    }), this.foregroundShape.on("mousedown", function(y) {
      y.target.attr("cursor", "grabbing");
    }), this.foregroundShape.on("mouseup", function(y) {
      y.target.attr("cursor", t.foregroundStyle.cursor || "grab");
    });
    var f = co(this.handlerStyle, "width", 2), l = co(this.handlerStyle, "height", 24), c = this.group.addGroup({
      name: "minHandlerShape"
    });
    this.minHandlerShape = new KO({
      name: "minHandlerShape",
      group: c,
      type: a,
      x: this.x,
      y: this.y,
      width: f,
      height: l,
      style: this.handlerStyle
    });
    var h = this.group.addGroup({
      name: "maxHandlerShape"
    });
    this.maxHandlerShape = new KO({
      name: "maxHandlerShape",
      group: h,
      type: a,
      x: this.x,
      y: this.y,
      width: f,
      height: l,
      style: this.handlerStyle
    });
    var d = this.ticks, v = n / (d.length - 1);
    this.tickPosList = [], this.textList && this.textList.length && this.textList.forEach(function(y) {
      y.destroy();
    });
    var p = -1 / 0, g = this.tickLabelStyle.rotate;
    delete this.tickLabelStyle.rotate, this.textList = d.map(function(y, b) {
      t.tickPosList.push(t.x + b * v);
      var m;
      t.tickLabelFormatter ? (m = t.tickLabelFormatter(y), !Qe(m) && m && (m = y.date)) : m = y.date;
      var x = t.x + b * v, _ = t.y + i + 5, w = t.group.addShape("text", {
        attrs: Dr({
          x,
          y: _,
          text: m,
          fontFamily: t.fontFamily || "Arial, sans-serif"
        }, t.tickLabelStyle),
        name: "tick-label"
      });
      if (At(g) && b !== d.length - 1) {
        var E = cye([1, 0, 0, 0, 1, 0, 0, 0, 1], [["t", -x, -_], ["r", g], ["t", x - 5, _ + 2]]);
        w.attr({
          textAlign: "left",
          matrix: E
        });
      }
      b === 0 ? w.attr({
        textAlign: "left"
      }) : b !== d.length - 1 && w.attr({
        textAlign: "right"
      });
      var M = t.group.addShape("line", {
        attrs: Dr({
          x1: t.x + b * v,
          y1: t.y + i + 2,
          x2: t.x + b * v,
          y2: t.y + i + 6
        }, t.tickLineStyle),
        name: "tick-line"
      });
      M.toBack();
      var C = w.getBBox();
      return C.minX > p ? (w.show(), M.show(), p = C.minX + C.width + 10) : (w.hide(), M.hide()), w;
    }), this.controllerBtnGroup = new E4(Dr({
      group: this.group,
      x: this.x,
      y: this.y + i + 25,
      width: n,
      height: 35
    }, this.controllerCfg)), this.updateStartEnd(0), this.updateUI(), s.move(this.x, this.y), this.bindEvents();
  }, r.prototype.bindEvents = function() {
    var t = this, e = this.group.find(function(i) {
      return i.get("name") === "minHandlerShape";
    });
    e && (e.on("minHandlerShape-handler:mousedown", this.onMouseDown(this.minHandlerShape)), e.on("minHandlerShape-handler:touchstart", this.onMouseDown(this.minHandlerShape)));
    var n = this.group.find(function(i) {
      return i.get("name") === "maxHandlerShape";
    });
    n && (n.on("maxHandlerShape-handler:mousedown", this.onMouseDown(this.maxHandlerShape)), n.on("maxHandlerShape-handler:touchstart", this.onMouseDown(this.maxHandlerShape))), this.foregroundShape.on("mousedown", this.onMouseDown(this.foregroundShape)), this.foregroundShape.on("touchstart", this.onMouseDown(this.foregroundShape)), this.group.on("".concat(ss, ":click"), function() {
      t.isPlay = !t.isPlay, t.currentHandler = t.maxHandlerShape, t.changePlayStatus();
    }), this.group.on("".concat(qc, ":click"), function() {
      t.currentHandler = t.maxHandlerShape, t.updateStartEnd(0.01), t.updateUI();
    }), this.group.on("".concat(Zc, ":click"), function() {
      t.currentHandler = t.maxHandlerShape, t.updateStartEnd(-0.01), t.updateUI();
    }), this.group.on(du, function(i) {
      var a = i.type, o = i.speed;
      t.currentSpeed = o, t.currentMode = a, a === "single" ? (t.minHandlerShape.hide(), t.foregroundShape.hide(), t.minTextShape.hide()) : a === "range" && (t.minHandlerShape.show(), t.foregroundShape.show(), t.minTextShape.show());
    });
  }, r.prototype.adjustTickIndex = function(t) {
    for (var e = 0; e < this.tickPosList.length - 1; e++)
      if (this.tickPosList[e] <= t && t <= this.tickPosList[e + 1])
        return Math.abs(this.tickPosList[e] - t) < Math.abs(t - this.tickPosList[e + 1]) ? e : e + 1;
    return 0;
  }, r.prototype.adjustOffsetRange = function(t) {
    switch (this.currentHandler) {
      case this.minHandlerShape: {
        var e = 0 - this.start, n = 1 - this.start;
        return Math.min(n, Math.max(e, t));
      }
      case this.maxHandlerShape: {
        var e = 0 - this.end, n = 1 - this.end;
        return Math.min(n, Math.max(e, t));
      }
      case this.foregroundShape: {
        var e = 0 - this.start, n = 1 - this.end;
        return Math.min(n, Math.max(e, t));
      }
      default:
        return 0;
    }
  }, r.prototype.updateStartEnd = function(t) {
    var e = this.ticks[this.adjustTickIndex(this.start * this.width)], n = this.ticks[this.adjustTickIndex(this.end * this.width)];
    if (!this.currentHandler) {
      this.minText = this.tickLabelFormatter ? this.tickLabelFormatter(e) : e == null ? void 0 : e.date, this.maxText = this.tickLabelFormatter ? this.tickLabelFormatter(n) : n == null ? void 0 : n.date;
      return;
    }
    switch (this.currentHandler) {
      case this.minHandlerShape:
        this.maxText = this.maxTextShape.attr("text"), this.start += t, this.minText = this.tickLabelFormatter ? this.tickLabelFormatter(e) : e.date;
        break;
      case this.maxHandlerShape:
        this.minText = this.minTextShape.attr("text"), this.end += t, this.maxText = this.tickLabelFormatter ? this.tickLabelFormatter(n) : n.date;
        break;
      case this.foregroundShape:
        this.start += t, this.end += t, this.minText = this.tickLabelFormatter ? this.tickLabelFormatter(e) : e.date, this.maxText = this.tickLabelFormatter ? this.tickLabelFormatter(n) : n.date;
        break;
    }
  }, r.prototype.updateUI = function() {
    var t = this;
    this.start < 0 && (this.start = 0), this.end > 1 && (this.end = 1);
    var e = this.x + this.start * this.width, n = this.x + this.end * this.width;
    this.foregroundShape.attr("x", e), this.foregroundShape.attr("width", n - e);
    var i = co(this.handlerStyle, "width", k1);
    this.setText(this.minText, this.maxText);
    var a = this.dodgeText([e, n]), o = a[0], s = a[1];
    this.minHandlerShape.setX(e - i / 2), Se(o, function(u, f) {
      return t.minTextShape.attr(f, u);
    }), this.maxHandlerShape.setX(n - i / 2), Se(s, function(u, f) {
      return t.maxTextShape.attr(f, u);
    }), this.currentMode === "range" ? this.graph.emit(Ca, {
      value: [this.start, this.end].sort()
    }) : this.currentMode === "single" && this.graph.emit(Ca, {
      value: [this.end, this.end]
    });
  }, r.prototype.dodgeText = function(t) {
    var e, n, i = 2, a = co(this.handlerStyle, "width", k1), o = this.minTextShape, s = this.maxTextShape, u = t[0], f = t[1], l = !1;
    u > f && (e = [f, u], u = e[0], f = e[1], n = [s, o], o = n[0], s = n[1], l = !0);
    var c = o.getBBox(), h = s.getBBox(), d = null, v = null;
    return this.timeBarType === "trend" ? (d = u - c.width < this.x + i ? {
      x: u + a / 2 + i,
      textAlign: "left"
    } : {
      x: u - a / 2 - i,
      textAlign: "right"
    }, v = f + h.width > this.x + this.width ? {
      x: f - a / 2 - i,
      textAlign: "right"
    } : {
      x: f + a / 2 + i,
      textAlign: "left"
    }) : this.timeBarType === "simple" && (d = o.attr("x") > c.width ? {
      x: u,
      textAlign: "center"
    } : {
      x: u,
      textAlign: "left"
    }, v = s.attr("x") > this.width - h.width ? {
      x: f,
      textAlign: "right"
    } : {
      x: f,
      textAlign: "center"
    }), l ? [v, d] : [d, v];
  }, r.prototype.startPlay = function() {
    var t = this;
    return typeof window < "u" ? window.requestAnimationFrame(function() {
      var e = t, n = e.ticks, i = e.width, a = t.currentSpeed, o = i / n.length, s = o / ((10 - a) * 1e3 / 60), u = t.adjustOffsetRange(s / t.width);
      t.updateStartEnd(u), t.updateUI(), t.isPlay && (t.playHandler = t.startPlay());
    }) : void 0;
  }, r.prototype.changePlayStatus = function(t) {
    t === void 0 && (t = !0), this.controllerBtnGroup.playButton.update({
      isPlay: this.isPlay
    }), this.isPlay ? (this.playHandler = this.startPlay(), this.graph.emit(b4, null)) : this.playHandler && (typeof window < "u" && window.cancelAnimationFrame(this.playHandler), t && this.graph.emit(x4, null));
  }, r.prototype.destory = function() {
    this.graph.off(Ca, function() {
    });
    var t = this.group, e = t.find(function(i) {
      return i.get("name") === "minHandlerShape";
    });
    e && (e.off("minHandlerShape-handler:mousedown"), e.off("minHandlerShape-handler:touchstart"), e.destroy());
    var n = t.find(function(i) {
      return i.get("name") === "maxHandlerShape";
    });
    n && (n.off("maxHandlerShape-handler:mousedown"), n.off("maxHandlerShape-handler:touchstart"), n.destroy()), this.foregroundShape.off("mousedown"), this.foregroundShape.off("touchstart"), this.foregroundShape.destroy(), t.off("".concat(ss, ":click")), t.off("".concat(qc, ":click")), t.off("".concat(Zc, ":click")), t.off(du), t.destroy(), this.trendComponent && this.trendComponent.destory();
  }, r;
}();
const xye = bye;
var _ye = function() {
  function r(t) {
    var e = t.x, n = e === void 0 ? 0 : e, i = t.y, a = i === void 0 ? 0 : i, o = t.container, s = t.text, u = t.padding, f = u === void 0 ? [4, 4, 4, 4] : u, l = t.className, c = l === void 0 ? "g6-component-timebar-tooltip" : l, h = t.backgroundColor, d = h === void 0 ? "#000" : h, v = t.textColor, p = v === void 0 ? "#fff" : v, g = t.opacity, y = g === void 0 ? 0.8 : g, b = t.fontSize, m = b === void 0 ? 12 : b;
    this.container = o, this.className = c, this.backgroundColor = d, this.textColor = p, this.x = n, this.y = a, this.text = s, this.padding = f, this.opacity = y, this.fontSize = m, this.render();
  }
  return r.prototype.render = function() {
    var t = this, e = t.className;
    t.x, t.y;
    var n = t.backgroundColor, i = t.textColor, a = t.text, o = t.padding, s = t.opacity, u = t.fontSize, f = t.container, l = Nr("<div class='".concat(e, `' style="position: absolute; width: fit-content; height: fit-content; opacity: `).concat(s, '"></div>'));
    Qe(f) && (f = document.getElementById(f)), f.appendChild(l), t.parentHeight = f.offsetHeight, t.parentWidth = f.offsetWidth, ar(l, {
      visibility: "hidden",
      top: 0,
      left: 0
    });
    var c = Nr(`
      <div style='position: absolute; white-space:nowrap; background-color: `.concat(n, "; font-size: ").concat(u, "px; border-radius: 4px; width: fit-content; height: fit-content; color: ").concat(i, "; padding: ").concat(o[0], "px ").concat(o[1], "px ").concat(o[2], "px ").concat(o[3], "px'></div>"));
    c.innerHTML = a, l.appendChild(c), t.backgroundDOM = c;
    var h = Nr("<div style='position: absolute; width: 0px; height: 0px; border-left: 5px solid transparent; border-right: 5px solid transparent; border-top: 10px solid ".concat(n, "'></div>"));
    l.appendChild(h), t.arrowDOM = h, t.container = l;
  }, r.prototype.show = function(t) {
    var e = this, n = t.text, i = t.x;
    t.y, t.clientX, t.clientY, e.backgroundDOM.innerHTML = n;
    var a = e.backgroundDOM.offsetWidth, o = e.backgroundDOM.offsetHeight, s = e.arrowDOM.offsetWidth, u = e.arrowDOM.offsetHeight;
    ar(e.container, {
      top: "".concat(-o - u, "px"),
      left: "".concat(i, "px"),
      visibility: "visible"
    }), ar(e.backgroundDOM, {
      marginLeft: "".concat(-a / 2, "px")
    }), ar(e.arrowDOM, {
      marginLeft: "".concat(-s / 2, "px"),
      top: "".concat(o, "px")
    });
    var f = i - a / 2, l = i + a / 2;
    f < 0 ? ar(e.backgroundDOM, {
      marginLeft: "".concat(-a / 2 - f, "px")
    }) : l > e.parentWidth && ar(e.backgroundDOM, {
      marginLeft: "".concat(-a / 2 - l + e.parentWidth + 12, "px")
    });
  }, r.prototype.hide = function() {
    ar(this.container, {
      top: 0,
      left: 0,
      visibility: "hidden"
    });
  }, r;
}();
const wye = _ye;
var Cp = globalThis && globalThis.__assign || function() {
  return Cp = Object.assign || function(r) {
    for (var t, e = 1, n = arguments.length; e < n; e++) {
      t = arguments[e];
      for (var i in t)
        Object.prototype.hasOwnProperty.call(t, i) && (r[i] = t[i]);
    }
    return r;
  }, Cp.apply(this, arguments);
}, Eye = $i, Sye = {
  fill: "#5B8FF9"
}, Mye = {
  fill: "#e6e8e9"
}, Cye = function() {
  function r(t) {
    this.frameCount = 0, this.fontFamily = "Arial, sans-serif";
    var e = t.graph, n = t.canvas, i = t.group, a = t.width, o = t.height, s = t.padding, u = t.data, f = t.start, l = t.end, c = t.x, h = c === void 0 ? 0 : c, d = t.y, v = d === void 0 ? 0 : d, p = t.tickLabelFormatter, g = t.selectedTickStyle, y = g === void 0 ? Sye : g, b = t.unselectedTickStyle, m = b === void 0 ? Mye : b, x = t.tooltipBackgroundColor, _ = t.tooltipFomatter, w = t.tickLabelStyle;
    this.graph = e, this.group = i, this.sliceGroup = i.addGroup({
      name: "slice-group"
    }), this.canvas = n, this.width = a, this.height = o, this.padding = s, this.data = u, this.start = f, this.end = l, this.tickLabelFormatter = p, this.tickLabelStyle = w || {}, this.selectedTickStyle = y, this.unselectedTickStyle = m, this.x = h, this.y = v, this.tooltipBackgroundColor = x, this.tooltipFomatter = _, this.fontFamily = typeof window < "u" && window.getComputedStyle(document.body, null).getPropertyValue("font-family") || "Arial, sans-serif", this.renderSlices(), this.initEvent();
  }
  return r.prototype.renderSlices = function() {
    var t = this, e = this, n = e.width, i = e.height, a = e.padding, o = e.data, s = e.start, u = e.end, f = e.tickLabelFormatter, l = e.selectedTickStyle, c = e.unselectedTickStyle, h = e.tickLabelStyle, d = n - 2 * a, v = 10, p = 4, g = 3 * a + p + v, y = i - g - 2 * a, b = 2, m = o.length, x = (d - b * (m - 1)) / m;
    this.tickWidth = x;
    var _ = this.sliceGroup, w = [], E = [], M = Math.round(m * s), C = Math.round(m * u);
    this.startTickRectId = M, this.endTickRectId = C;
    var S = h.rotate;
    delete h.rotate, o.forEach(function(T, P) {
      var k = P >= M && P <= C, L = k ? l : c, O = _.addShape("rect", {
        attrs: Cp({
          x: a + P * (x + b),
          y: a,
          width: x,
          height: y
        }, L),
        draggable: !0,
        name: "tick-rect-".concat(P)
      }), D = _.addShape("rect", {
        attrs: {
          x: a + P * x + b * (2 * P - 1) / 2,
          y: a,
          width: P === 0 || P === m - 1 ? x + b / 2 : x + b,
          height: y,
          fill: "#fff",
          opacity: 0
        },
        draggable: !0,
        name: "pick-rect-".concat(P)
      });
      D.toFront();
      var G = O.getBBox(), R = (G.minX + G.maxX) / 2;
      w.push({
        rect: O,
        pickRect: D,
        value: T.date,
        x: R,
        y: G.minY
      });
      var F;
      if (f ? (F = f(T), !Qe(F) && F && (F = T.date)) : P % Math.round(m / 10) === 0 && (F = T.date), F) {
        E.push(F);
        var q = G.maxY + a * 2;
        _.addShape("line", {
          attrs: {
            stroke: "#BFBFBF",
            x1: R,
            y1: q,
            x2: R,
            y2: q + p
          },
          name: "tick-line"
        });
        var ne = q + p + a, oe = _.addShape("text", {
          attrs: Cp({
            fill: "#8c8c8c",
            stroke: "#fff",
            lineWidth: 1,
            x: R,
            y: ne,
            textAlign: "center",
            text: F,
            textBaseline: "top",
            fontSize: 10,
            fontFamily: t.fontFamily || "Arial, sans-serif"
          }, h),
          capture: !1,
          name: "tick-label"
        }), ie = oe.getBBox();
        if (ie.maxX > n ? oe.attr("textAlign", "right") : ie.minX < 0 && oe.attr("textAlign", "left"), At(S) && E.length !== 10) {
          var Ee = Eye([1, 0, 0, 0, 1, 0, 0, 0, 1], [["t", -R, -ne], ["r", S], ["t", R - 5, ne + 2]]);
          oe.attr({
            textAlign: "left",
            matrix: Ee
          });
        }
        E.length === 1 ? oe.attr({
          textAlign: "left"
        }) : E.length === 10 && oe.attr({
          textAlign: "right"
        });
      }
    }), this.tickRects = w;
    var A = this.group;
    this.currentSpeed = 1, this.controllerBtnGroup = new E4({
      group: A,
      x: this.x,
      y: this.y + i + 5,
      width: n,
      height: 40,
      hideTimeTypeController: !0,
      speed: this.currentSpeed,
      fontFamily: this.fontFamily || "Arial, sans-serif"
    });
  }, r.prototype.initEvent = function() {
    var t = this, e = this.sliceGroup;
    e.on("click", function(l) {
      var c = l.target;
      if (!(c.get("type") !== "rect" || !c.get("name"))) {
        var h = parseInt(c.get("name").split("-")[2], 10);
        if (!isNaN(h)) {
          var d = t.tickRects, v = t.unselectedTickStyle;
          d.forEach(function(b) {
            b.rect.attr(v);
          });
          var p = t.selectedTickStyle;
          d[h].rect.attr(p), t.startTickRectId = h, t.endTickRectId = h;
          var g = d.length, y = h / g;
          t.graph.emit(Ca, {
            value: [y, y]
          });
        }
      }
    }), e.on("dragstart", function(l) {
      var c = t.tickRects, h = t.unselectedTickStyle;
      c.forEach(function(b) {
        b.rect.attr(h);
      });
      var d = l.target, v = parseInt(d.get("name").split("-")[2], 10), p = t.selectedTickStyle;
      c[v].rect.attr(p), t.startTickRectId = v;
      var g = c.length, y = v / g;
      t.graph.emit(Ca, {
        value: [y, y]
      }), t.dragging = !0;
    }), e.on("dragover", function(l) {
      if (!!t.dragging && l.target.get("type") === "rect") {
        for (var c = parseInt(l.target.get("name").split("-")[2], 10), h = t.startTickRectId, d = t.tickRects, v = t.selectedTickStyle, p = t.unselectedTickStyle, g = 0; g < d.length; g++) {
          var y = g >= h && g <= c ? v : p;
          d[g].rect.attr(y);
        }
        var b = d.length;
        t.endTickRectId = c;
        var m = h / b, x = c / b;
        t.graph.emit(Ca, {
          value: [m, x]
        });
      }
    }), e.on("drop", function(l) {
      if (!!t.dragging && (t.dragging = !1, l.target.get("type") === "rect")) {
        var c = t.startTickRectId, h = parseInt(l.target.get("name").split("-")[2], 10);
        if (!(h < c)) {
          var d = t.selectedTickStyle, v = t.tickRects;
          v[h].rect.attr(d), t.endTickRectId = h;
          var p = v.length, g = c / p, y = h / p;
          t.graph.emit(Ca, {
            value: [g, y]
          });
        }
      }
    });
    var n = this, i = n.tooltipBackgroundColor, a = n.tooltipFomatter, o = n.canvas, s = new wye({
      container: o.get("container"),
      backgroundColor: i
    }), u = this.tickRects;
    u.forEach(function(l) {
      var c = l.pickRect;
      c.on("mouseenter", function(h) {
        var d = h.target;
        if (d.get("type") === "rect") {
          var v = parseInt(d.get("name").split("-")[2], 10), p = o.getClientByPoint(u[v].x, u[v].y);
          s.show({
            x: u[v].x,
            y: u[v].y,
            clientX: p.x,
            clientY: p.y,
            text: a ? a(u[v].value) : u[v].value
          });
        }
      }), c.on("mouseleave", function(h) {
        s.hide();
      });
    });
    var f = this.group;
    f.on("".concat(ss, ":click"), function() {
      t.isPlay = !t.isPlay, t.changePlayStatus();
    }), f.on("".concat(qc, ":click"), function() {
      t.updateStartEnd(1);
    }), f.on("".concat(Zc, ":click"), function() {
      t.updateStartEnd(-1);
    }), f.on(du, function(l) {
      l.type;
      var c = l.speed;
      t.currentSpeed = c;
    });
  }, r.prototype.changePlayStatus = function(t) {
    t === void 0 && (t = !0), this.controllerBtnGroup.playButton.update({
      isPlay: this.isPlay
    }), this.isPlay ? (this.playHandler = this.startPlay(), this.graph.emit(b4, null)) : this.playHandler && (typeof window < "u" && window.cancelAnimationFrame(this.playHandler), t && this.graph.emit(x4, null));
  }, r.prototype.startPlay = function() {
    var t = this;
    return typeof window < "u" ? window.requestAnimationFrame(function() {
      var e = t.currentSpeed;
      t.frameCount % (60 / e) === 0 && (t.frameCount = 0, t.updateStartEnd(1)), t.frameCount++, t.isPlay && (t.playHandler = t.startPlay());
    }) : void 0;
  }, r.prototype.updateStartEnd = function(t) {
    var e = this, n = this.tickRects, i = n.length, a = this.unselectedTickStyle, o = this.selectedTickStyle, s = e.endTickRectId;
    if (t > 0 ? e.endTickRectId++ : (n[e.endTickRectId].rect.attr(a), e.endTickRectId--), s !== e.startTickRectId)
      e.endTickRectId < e.startTickRectId && (e.startTickRectId = e.endTickRectId);
    else {
      for (var u = e.startTickRectId; u <= e.endTickRectId - 1; u++)
        n[u].rect.attr(a);
      e.startTickRectId = e.endTickRectId;
    }
    if (n[e.endTickRectId]) {
      n[e.endTickRectId].rect.attr(o);
      var f = e.startTickRectId / i, l = e.endTickRectId / i;
      this.graph.emit(Ca, {
        value: [f, l]
      });
    }
  }, r.prototype.destory = function() {
    this.graph.off(Ca, function() {
    });
    var t = this.sliceGroup;
    t.off("click"), t.off("dragstart"), t.off("dragover"), t.off("drop"), this.tickRects.forEach(function(e) {
      var n = e.pickRect;
      n.off("mouseenter"), n.off("mouseleave");
    }), this.tickRects.length = 0, t.off("".concat(ss, ":click")), t.off("".concat(qc, ":click")), t.off("".concat(Zc, ":click")), t.off(du), this.sliceGroup.destroy();
  }, r;
}();
const Tye = Cye;
var Aye = globalThis && globalThis.__extends || function() {
  var r = function(e, n) {
    return r = Object.setPrototypeOf || {
      __proto__: []
    } instanceof Array && function(i, a) {
      i.__proto__ = a;
    } || function(i, a) {
      for (var o in a)
        Object.prototype.hasOwnProperty.call(a, o) && (i[o] = a[o]);
    }, r(e, n);
  };
  return function(t, e) {
    if (typeof e != "function" && e !== null)
      throw new TypeError("Class extends value " + String(e) + " is not a constructor or null");
    r(t, e);
    function n() {
      this.constructor = t;
    }
    t.prototype = e === null ? Object.create(e) : (n.prototype = e.prototype, new n());
  };
}(), ho = globalThis && globalThis.__assign || function() {
  return ho = Object.assign || function(r) {
    for (var t, e = 1, n = arguments.length; e < n; e++) {
      t = arguments[e];
      for (var i in t)
        Object.prototype.hasOwnProperty.call(t, i) && (r[i] = t[i]);
    }
    return r;
  }, ho.apply(this, arguments);
}, Iye = globalThis && globalThis.__rest || function(r, t) {
  var e = {};
  for (var n in r)
    Object.prototype.hasOwnProperty.call(r, n) && t.indexOf(n) < 0 && (e[n] = r[n]);
  if (r != null && typeof Object.getOwnPropertySymbols == "function")
    for (var i = 0, n = Object.getOwnPropertySymbols(r); i < n.length; i++)
      t.indexOf(n[i]) < 0 && Object.prototype.propertyIsEnumerable.call(r, n[i]) && (e[n[i]] = r[n[i]]);
  return e;
}, Pye = 4, Oye = 26, Dye = function(r) {
  Aye(t, r);
  function t(e) {
    return r.call(this, e) || this;
  }
  return t.prototype.getDefaultCfgs = function() {
    return {
      container: null,
      className: "g6-component-timebar",
      padding: 10,
      type: "trend",
      trend: {
        data: [],
        isArea: !1,
        smooth: !0
      },
      controllerCfg: {
        speed: 1,
        loop: !1
      },
      slider: {
        start: 0.1,
        end: 0.9,
        minText: "min",
        maxText: "max"
      },
      tick: {
        start: 0.1,
        end: 0.9,
        data: []
      },
      textStyle: {},
      filterEdge: !1,
      filterItemTypes: ["node"],
      containerCSS: {}
    };
  }, t.prototype.initContainer = function() {
    var e = this.get("graph"), n = this._cfgs, i = n.width, a = n.height, o = this.get("className") || "g6-component-timebar", s = this.get("container"), u = this.get("graph").get("container"), f;
    s ? (Qe(s) && (s = document.getElementById(s)), f = s) : (f = Nr("<div class='".concat(o, "'></div>")), ar(f, {
      position: "relative"
    })), u.appendChild(f), this.set("timeBarContainer", f);
    var l, c = e.get("renderer");
    c === "SVG" ? l = new gc({
      container: f,
      width: i,
      height: a
    }) : l = new po({
      container: f,
      width: i,
      height: a
    }), this.get("containerCSS") && ar(f, this.get("containerCSS")), this.set("canvas", l);
  }, t.prototype.init = function() {
    this.initContainer();
    var e = this.get("canvas"), n = e.addGroup({
      name: "timebar-group"
    });
    this.set("timeBarGroup", n), this.renderTrend(), this.initEvent();
    var i = typeof window < "u" && window.getComputedStyle(document.body, null).getPropertyValue("font-family") || "Arial, sans-serif";
    this.set("fontFamily", i);
  }, t.prototype.renderTrend = function() {
    var e = this, n = this._cfgs, i = n.width, a = n.x, o = n.y, s = n.padding, u = n.type, f = n.trend, l = n.slider, c = n.controllerCfg, h = n.textStyle, d = n.tick, v = n.backgroundStyle, p = n.foregroundStyle, g = f.data, y = Iye(f, ["data"]), b = i - 2 * s, m = u === "trend" ? Oye : Pye, x = this.get("graph"), _ = this.get("timeBarGroup"), w = this.get("canvas"), E = null;
    if (u === "trend" || u === "simple") {
      var M = this.get("getValue");
      E = new xye(ho(ho({
        graph: x,
        canvas: w,
        group: _,
        type: u,
        x: a + s,
        y: u === "trend" ? o + s : o + s + 15,
        width: b,
        height: m,
        padding: s,
        backgroundStyle: v,
        foregroundStyle: p,
        trendCfg: ho(ho({}, y), {
          data: g.map(function(S) {
            return (M == null ? void 0 : M(S)) || S.value;
          })
        })
      }, l), {
        tick: {
          ticks: g,
          tickLabelFormatter: d.tickLabelFormatter,
          tickLabelStyle: d.tickLabelStyle,
          tickLineStyle: d.tickLineStyle
        },
        handlerStyle: ho(ho({}, l.handlerStyle), {
          height: l.height || m
        }),
        controllerCfg: c,
        textStyle: h
      }));
    } else
      u === "tick" && (E = new Tye(ho({
        graph: x,
        canvas: w,
        group: _,
        x: a + s,
        y: o + s,
        width: i,
        height: 42,
        padding: 2
      }, d)));
    var C = function S() {
      var A = e.get("timebar");
      A.draggingHandler = !1, A.isPlay && (A.isPlay = !1, A.currentHandler = A.maxHandlerShape, A.changePlayStatus()), document.removeEventListener("mouseup", S);
    };
    w.on("mousedown", function(S) {
      (S.target.get("name") === "maxHandlerShape-handler" || S.target.get("name") === "minHandlerShape-handler" || S.target === E.foregroundShape) && document.addEventListener("mouseup", C);
    }), this.set("timebar", E);
  }, t.prototype.filterData = function(e) {
    var n, i = e.value, a = null, o = this._cfgs.type;
    if (o === "trend" || o === "simple" ? a = this._cfgs.trend.data : o === "tick" && (a = this._cfgs.tick.data), !a || a.length === 0) {
      console.warn("\u8BF7\u914D\u7F6E TimeBar \u7EC4\u4EF6\u7684\u6570\u636E");
      return;
    }
    var s = this.get("rangeChange"), u = this.get("graph"), f = Math.round(a.length * i[0]), l = Math.round(a.length * i[1]);
    l = l >= a.length ? a.length - 1 : l, f = f >= a.length ? a.length - 1 : f;
    var c = (n = this._cfgs.tick) === null || n === void 0 ? void 0 : n.tickLabelFormatter, h = c ? c(a[f]) : a[f].date, d = c ? c(a[l]) : a[l].date;
    if (o !== "tick") {
      var v = this.get("timebar");
      v.setText(h, d);
    }
    if (s)
      s(u, h, d);
    else {
      (!this.cacheGraphData || this.cacheGraphData.nodes && this.cacheGraphData.nodes.length === 0) && (this.cacheGraphData = u.get("data"));
      var p = this.get("filterItemTypes"), g = this.get("changeData"), y = this.get("getDate"), b = this.get("shouldIgnore"), m = a[f].date, x = a[l].date;
      if (g || g === void 0) {
        var _ = this.cacheGraphData.nodes, w = this.cacheGraphData.edges;
        if (p.includes("node")) {
          _ = _.filter(function(M) {
            var C = +((y == null ? void 0 : y(M)) || M.date);
            return C >= m && C <= x || (b == null ? void 0 : b("node", M, {
              min: m,
              max: x
            }));
          });
          var E = _.map(function(M) {
            return M.id;
          });
          w && (w = w.filter(function(M) {
            return E.includes(M.source) && E.includes(M.target) || (b == null ? void 0 : b("edge", M, {
              min: m,
              max: x
            }));
          }));
        }
        (this.get("filterEdge") || p.includes("edge")) && (w = w.filter(function(M) {
          var C = +((y == null ? void 0 : y(M)) || M.date);
          return C >= m && C <= x || (b == null ? void 0 : b("edge", M, {
            min: m,
            max: x
          }));
        })), u.changeData({
          nodes: _,
          edges: w
        });
      } else
        p.includes("node") && u.getNodes().forEach(function(M) {
          var C = M.getModel();
          if (!(b != null && b("node", C, {
            min: m,
            max: x
          }))) {
            var S = +((y == null ? void 0 : y(C)) || C.date);
            S < m || S > x ? u.hideItem(M) : u.showItem(M);
          }
        }), (this.get("filterEdge") || p.includes("edge")) && u.getEdges().forEach(function(M) {
          var C = M.getModel();
          if (!(b != null && b("edge", C, {
            min: a[f].date,
            max: a[l].date
          }))) {
            var S = +((y == null ? void 0 : y(C)) || C.date);
            S < a[f].date || S > a[l].date ? u.hideItem(M) : u.showItem(M);
          }
        });
    }
  }, t.prototype.initEvent = function() {
    var e = this, n = 0, i = 0, a = this._cfgs.type;
    !a || a === "trend" || a === "simple" ? (n = this._cfgs.slider.start, i = this._cfgs.slider.end) : a === "tick" && (n = this._cfgs.tick.start, i = this._cfgs.tick.end);
    var o = this.get("graph");
    o.on("afterrender", function(s) {
      e.filterData({
        value: [n, i]
      });
    }), o.on(Ca, Y1(function(s) {
      e.filterData(s);
    }, 200, {
      trailing: !0,
      leading: !0
    }));
  }, t.prototype.destroy = function() {
    var e = this.get("timebar");
    e && e.destory && e.destory(), r.prototype.destroy.call(this);
    var n = this.get("timeBarContainer");
    if (n) {
      var i = this.get("container");
      i || (i = this.get("graph").get("container")), Qe(i) && (i = document.getElementById(i)), i.removeChild(n);
    }
  }, t;
}(hi);
const kye = Dye;
var Lye = globalThis && globalThis.__extends || function() {
  var r = function(e, n) {
    return r = Object.setPrototypeOf || {
      __proto__: []
    } instanceof Array && function(i, a) {
      i.__proto__ = a;
    } || function(i, a) {
      for (var o in a)
        Object.prototype.hasOwnProperty.call(a, o) && (i[o] = a[o]);
    }, r(e, n);
  };
  return function(t, e) {
    if (typeof e != "function" && e !== null)
      throw new TypeError("Class extends value " + String(e) + " is not a constructor or null");
    r(t, e);
    function n() {
      this.constructor = t;
    }
    t.prototype = e === null ? Object.create(e) : (n.prototype = e.prototype, new n());
  };
}(), Nye = ci.applyMatrix;
function Rye(r, t) {
  var e, n;
  if (r.naturalWidth)
    e = r.naturalWidth, n = r.naturalHeight;
  else {
    var i = new Image();
    i.src = r.src, i.onload = function() {
      t && t(i.width, i.height);
    };
  }
  return [e, n];
}
var Bye = function(r) {
  Lye(t, r);
  function t(e) {
    return r.call(this, e) || this;
  }
  return t.prototype.getDefaultCfgs = function() {
    return {
      container: null,
      className: "g6-minimap",
      viewportClassName: "g6-minimap-viewport",
      width: 200,
      delegateStyle: {
        fill: "#40a9ff",
        stroke: "#096dd9"
      },
      refresh: !0
    };
  }, t.prototype.getEvents = function() {
    return {
      beforepaint: "updateViewport",
      beforeanimate: "disableRefresh",
      afteranimate: "enableRefresh",
      viewportchange: "disableOneRefresh"
    };
  }, t.prototype.disableRefresh = function() {
    this.set("refresh", !1);
  }, t.prototype.enableRefresh = function() {
    this.set("refresh", !0), this.updateCanvas();
  }, t.prototype.disableOneRefresh = function() {
    this.set("viewportChange", !0);
  }, t.prototype.initViewport = function() {
    var e = this, n = this._cfgs, i = n.graph;
    if (!this.destroyed) {
      var a = this.get("container");
      Qe(a) && (a = document.getElementById(a));
      var o = Nr("<div class=".concat(n.viewportClassName, `
      style='position:absolute;
        left:0;
        top:0;
        box-sizing:border-box;
        border: 2px solid #1980ff;
        cursor:move'
      </div>`)), s = 0, u = 0, f = !1, l = 0, c = 0, h = 0, d = 0, v = 0, p = 0;
      a.addEventListener("mousedown", function(g) {
        if (n.refresh = !1, g.target === o) {
          var y = o.style;
          h = parseInt(y.width, 10), d = parseInt(y.height, 10);
          var b = e.get("width"), m = e.get("height");
          h > b || d > m || (p = i.getZoom(), v = e.get("ratio"), f = !0, s = g.clientX, u = g.clientY);
        }
      }, !1), a.addEventListener("mousemove", function(g) {
        if (!(!f || Tt(g.clientX) || Tt(g.clientY))) {
          var y = e.get("width"), b = e.get("height"), m = o.style;
          l = parseInt(m.left, 10), c = parseInt(m.top, 10), h = parseInt(m.width, 10), d = parseInt(m.height, 10);
          var x = s - g.clientX, _ = u - g.clientY;
          l - x < 0 ? x = l : l - x + h >= y && (x = 0), c - _ < 0 ? _ = c : c - _ + d >= b && (_ = 0), l -= x, c -= _, ar(o, {
            left: "".concat(l, "px"),
            top: "".concat(c, "px")
          }), i.translate(x * p / v, _ * p / v), s = g.clientX, u = g.clientY;
        }
      }, !1), a.addEventListener("mouseleave", function() {
        f = !1, n.refresh = !0;
      }, !1), a.addEventListener("mouseup", function() {
        f = !1, n.refresh = !0;
      }, !1), this.set("viewport", o), a.appendChild(o);
    }
  }, t.prototype.updateViewport = function() {
    if (!this.destroyed) {
      var e = this.get("ratio"), n = this.get("width"), i = this.get("height"), a = this.get("graph"), o = a.get("width"), s = a.get("height"), u = o / s, f = a.getGroup(), l = f.getCanvasBBox(), c = [(l.minX + l.maxX) / 2, (l.minY + l.maxY) / 2], h = [l.maxX - l.minX, l.maxY - l.minY], d = {
        centerX: c[0],
        centerY: c[1],
        width: 0,
        height: 0,
        minX: 0,
        minY: 0
      };
      l[0] / l[1] > u ? (d.width = h[0], d.height = d.width / u) : (d.height = h[1], d.width = d.height * u), d.minX = c[0] - d.width / 2, d.minY = c[1] - d.height / 2;
      var v = f.getMatrix();
      v || (v = [1, 0, 0, 0, 1, 0, 0, 0, 1]);
      var p = K1([1, 0, 0, 0, 1, 0, 0, 0, 1], v), g = Nye({
        x: d.minX,
        y: d.minY
      }, p), y = a.getCanvasByPoint(g.x, g.y), b = this.get("viewport");
      b || this.initViewport();
      var m = o / d.width, x = m * n, _ = m * i, w = n * -y.x / d.width, E = i * -y.y / d.height, M = w + x, C = E + _;
      w < 0 && (x += w, w = 0), M > n && (x = x - (M - n)), E < 0 && (_ += E, E = 0), C > i && (_ = _ - (C - i)), this.set("ratio", e);
      var S = "".concat(w, "px"), A = "".concat(E, "px");
      ar(b, {
        left: S,
        top: A,
        width: "".concat(x, "px"),
        height: "".concat(_, "px")
      });
    }
  }, t.prototype.init = function() {
    this.initContainer();
  }, t.prototype.initContainer = function() {
    var e = this, n = e.get("graph"), i = n.get("width"), a = n.get("height"), o = a / i, s = e.get("className"), u = e.get("container"), f = e.get("width"), l = e.get("height");
    !f && !l && (f = 200), f ? (l = o * f, e.set("height", l)) : (f = 1 / o * l, e.set("width", f));
    var c = Nr("<div class='".concat(s, "' style='width: ").concat(f, "px; height: ").concat(l, "px; overflow: hidden; position: relative;'></div>"));
    Qe(u) && (u = document.getElementById(u)), u ? u.appendChild(c) : n.get("container").appendChild(c), e.set("container", c);
    var h = Nr('<div class="g6-minimap-container" style="position: relative; width: 100%; height: 100%; text-align: center; display: table;"></div>');
    c.appendChild(h);
    var d = Nr('<span style="display: table-cell; vertical-align: middle; "></span>');
    h.appendChild(d), e.set("containerDOM", h), e.set("containerSpan", d);
    var v = Nr('<img alt="" src="'.concat(this.get("graphImg"), '" style="display: inline-block; user-select: none;" draggable="false" />'));
    e.set("imgDOM", v), e.updateImgSize(), d.appendChild(v), e.updateCanvas();
  }, t.prototype.updateImgSize = function() {
    var e = this, n = e.get("imgDOM"), i = e.get("width"), a = e.get("height");
    n.onload = function() {
      var o = Rye(n);
      o[0] > o[1] ? n.width = i : n.height = a;
    };
  }, t.prototype.updateCanvas = function() {
    var e = this.get("refresh");
    if (!!e) {
      var n = this.get("graph");
      if (!n.get("destroyed")) {
        this.get("viewportChange") && (this.set("viewportChange", !1), this.updateViewport());
        var i = this.get("width"), a = n.get("canvas").getCanvasBBox(), o = a.width, s = i / o;
        this.set("ratio", s), this.updateViewport();
      }
    }
  }, t.prototype.getViewport = function() {
    return this.get("viewport");
  }, t.prototype.getContainer = function() {
    return this.get("container");
  }, t.prototype.updateGraphImg = function(e) {
    var n = this, i = n.get("imgDOM");
    i.remove(), n.set("graphImg", e);
    var a = Nr('<img alt="" src="'.concat(e, '" style="display: inline-block;" ondragstart="return false;" onselectstart="return false;"/>'));
    n.set("imgDOM", a), a.src = e, n.updateImgSize();
    var o = n.get("containerSpan");
    o.appendChild(a), n.updateCanvas();
  }, t.prototype.destroy = function() {
    var e = this.get("container");
    e.parentNode.removeChild(e);
  }, t;
}(hi);
const Gye = Bye;
var Fye = globalThis && globalThis.__extends || function() {
  var r = function(e, n) {
    return r = Object.setPrototypeOf || {
      __proto__: []
    } instanceof Array && function(i, a) {
      i.__proto__ = a;
    } || function(i, a) {
      for (var o in a)
        Object.prototype.hasOwnProperty.call(a, o) && (i[o] = a[o]);
    }, r(e, n);
  };
  return function(t, e) {
    if (typeof e != "function" && e !== null)
      throw new TypeError("Class extends value " + String(e) + " is not a constructor or null");
    r(t, e);
    function n() {
      this.constructor = t;
    }
    t.prototype = e === null ? Object.create(e) : (n.prototype = e.prototype, new n());
  };
}(), L1 = globalThis && globalThis.__assign || function() {
  return L1 = Object.assign || function(r) {
    for (var t, e = 1, n = arguments.length; e < n; e++) {
      t = arguments[e];
      for (var i in t)
        Object.prototype.hasOwnProperty.call(t, i) && (r[i] = t[i]);
    }
    return r;
  }, L1.apply(this, arguments);
}, zye = ci.distance, qO = 0.05, ZO = {
  stroke: "#000",
  strokeOpacity: 0.8,
  lineWidth: 2,
  fillOpacity: 1,
  fill: "#fff"
}, Uye = function(r) {
  Fye(t, r);
  function t(e) {
    return r.call(this, e) || this;
  }
  return t.prototype.getDefaultCfgs = function() {
    return {
      type: "both",
      trigger: "mousemove",
      r: 60,
      delegateStyle: vr(ZO),
      showLabel: "edge",
      scaleRBy: "wheel"
    };
  }, t.prototype.getEvents = function() {
    var e;
    switch (this.get("trigger")) {
      case "click":
        e = {
          click: "filter"
        };
        break;
      case "drag":
        e = {
          click: "createDelegate"
        };
        break;
      default:
        e = {
          mousemove: "filter"
        };
        break;
    }
    return e;
  }, t.prototype.init = function() {
    var e = this, n = e.get("showLabel"), i = n === "node" || n === "both", a = n === "edge" || n === "both";
    e.set("showNodeLabel", i), e.set("showEdgeLabel", a);
    var o = e.get("shouldShow");
    o || e.set("shouldShow", function() {
      return !0;
    });
  }, t.prototype.createDelegate = function(e) {
    var n = this, i = n.get("delegate");
    (!i || i.destroyed) && (n.filter(e), i = n.get("delegate"), i.on("dragstart", function(a) {
    }), i.on("drag", function(a) {
      n.filter(a);
    }), this.get("scaleRBy") === "wheel" && i.on("mousewheel", function(a) {
      n.scaleRByWheel(a);
    }));
  }, t.prototype.scaleRByWheel = function(e) {
    var n = this;
    if (!(!e || !e.originalEvent)) {
      e.preventDefault && e.preventDefault();
      var i = n.get("graph"), a, o = n.get("delegate"), s = o ? {
        x: o.attr("x"),
        y: o.attr("y")
      } : void 0;
      s || i.getPointByClient(e.clientX, e.clientY), e.originalEvent.wheelDelta < 0 ? a = 1 - qO : a = 1 / (1 - qO);
      var u = n.get("maxR"), f = n.get("minR"), l = n.get("r");
      (l > (u || i.get("height")) && a > 1 || l < (f || i.get("height") * 0.05) && a < 1) && (a = 1), l *= a, n.set("r", l), n.filter(e);
    }
  }, t.prototype.filter = function(e) {
    var n = this, i = n.get("graph"), a = i.getNodes(), o = {}, s = n.get("r"), u = n.get("type"), f = {
      x: e.x,
      y: e.y
    };
    n.updateDelegate(f, s);
    var l = n.get("shouldShow"), c = n.get("vShapes");
    c && c.forEach(function(y) {
      y.remove(), y.destroy();
    }), c = [], a.forEach(function(y) {
      var b = y.getModel(), m = b.x, x = b.y;
      zye({
        x: m,
        y: x
      }, f) < s && (o[b.id] = y);
    });
    var h = i.getEdges(), d = [];
    h.forEach(function(y) {
      var b = y.getModel(), m = b.source, x = b.target;
      l(b) && (u === "only-source" || u === "one" ? o[m] && !o[x] && d.push(y) : u === "only-target" || u === "one" ? o[x] && !o[m] && d.push(y) : u === "both" && o[m] && o[x] && d.push(y));
    });
    var v = n.get("showNodeLabel"), p = n.get("showEdgelabel"), g = i.get("group");
    d.forEach(function(y) {
      var b = y.get("group").get("children");
      b.forEach(function(m) {
        var x = m.get("type"), _ = g.addShape(x, {
          attrs: m.attr()
        });
        c.push(_), v && x === "text" && _.set("visible", !0);
      });
    }), Object.keys(o).forEach(function(y) {
      var b = o[y], m = b.get("group").clone();
      if (g.add(m), c.push(m), p)
        for (var x = m.get("children"), _ = 0; _ < x.length; _++) {
          var w = x[_];
          w.get("type") === "text" && w.set("visible", !0);
        }
    }), n.set("vShapes", c);
  }, t.prototype.updateParams = function(e) {
    var n = this, i = e.r, a = e.trigger, o = e.minR, s = e.maxR, u = e.scaleRBy, f = e.showLabel, l = e.shouldShow;
    if (isNaN(e.r) || n.set("r", i), isNaN(s) || n.set("maxR", s), isNaN(o) || n.set("minR", o), (a === "mousemove" || a === "click") && n.set("trigger", a), u === "wheel" || u === "unset") {
      n.set("scaleRBy", u), n.get("delegate").remove(), n.get("delegate").destroy();
      var c = n.get("dPercentText");
      c && (c.remove(), c.destroy());
    }
    (f === "node" || f === "both") && n.set("showNodeLabel", !0), (f === "edge" || f === "both") && n.set("showEdgeLabel", !0), l && n.set("shouldShow", l);
  }, t.prototype.updateDelegate = function(e, n) {
    var i = this, a = i.get("graph"), o = i.get("delegate");
    if (!o || o.destroyed) {
      var s = a.get("group"), u = i.get("delegateStyle") || ZO;
      o = s.addShape("circle", {
        attrs: L1({
          r: n,
          x: e.x,
          y: e.y
        }, u),
        name: "lens-shape",
        draggable: !0
      }), this.get("trigger") !== "drag" && this.get("scaleRBy") === "wheel" && o.on("mousewheel", function(f) {
        i.scaleRByWheel(f);
      });
    } else
      o.attr({
        x: e.x,
        y: e.y,
        r: n
      });
    i.set("delegate", o);
  }, t.prototype.clear = function() {
    var e = this, n = e.get("vShapes");
    n && n.forEach(function(a) {
      a.remove(), a.destroy();
    }), n = [], e.set("vShapes", n);
    var i = e.get("delegate");
    i && !i.destroyed && (i.remove(), i.destroy());
  }, t.prototype.destroy = function() {
    this.clear();
  }, t;
}(hi);
const jye = Uye;
var $ye = globalThis && globalThis.__extends || function() {
  var r = function(e, n) {
    return r = Object.setPrototypeOf || {
      __proto__: []
    } instanceof Array && function(i, a) {
      i.__proto__ = a;
    } || function(i, a) {
      for (var o in a)
        Object.prototype.hasOwnProperty.call(a, o) && (i[o] = a[o]);
    }, r(e, n);
  };
  return function(t, e) {
    if (typeof e != "function" && e !== null)
      throw new TypeError("Class extends value " + String(e) + " is not a constructor or null");
    r(t, e);
    function n() {
      this.constructor = t;
    }
    t.prototype = e === null ? Object.create(e) : (n.prototype = e.prototype, new n());
  };
}(), Wye = ci.pointLineDistance, Vye = {
  stroke: "#FA8C16",
  lineWidth: 1
}, Xye = function(r) {
  $ye(t, r);
  function t(e) {
    return r.call(this, e) || this;
  }
  return t.prototype.getDefaultCfgs = function() {
    return {
      line: Vye,
      itemAlignType: "center",
      tolerance: 5,
      horizontalLines: {},
      verticalLines: {},
      alignLines: []
    };
  }, t.prototype.init = function() {
  }, t.prototype.getEvents = function() {
    return {
      "node:dragstart": "onDragStart",
      "node:drag": "onDrag",
      "node:dragend": "onDragEnd"
    };
  }, t.prototype.onDragStart = function() {
    this.initBoxLine();
  }, t.prototype.onDrag = function(e) {
    var n = e.item, i = n.get("delegateShape") || n, a = i.getBBox(), o = n.getModel(), s = o.x - a.x, u = o.y - a.y;
    this.show({
      x: a.minX + s,
      y: a.minY + u
    }, {
      width: a.width,
      height: a.height
    });
  }, t.prototype.onDragEnd = function() {
    this.destory();
  }, t.prototype.initBoxLine = function() {
    var e = this._cfgs, n = e.horizontalLines, i = e.verticalLines, a = e.itemAlignType, o = this.get("graph"), s = o.getNodes();
    s.forEach(function(u) {
      var f = u.getBBox(), l = u.get("id");
      a === !0 || a === "horizontal" ? (n["".concat(l, "tltr")] = [f.minX, f.minY, f.maxX, f.minY, u], n["".concat(l, "lcrc")] = [f.minX, f.centerY, f.maxX, f.centerY, u], n["".concat(l, "blbr")] = [f.minX, f.maxY, f.maxX, f.maxY, u]) : a === "center" && (n["".concat(l, "lcrc")] = [f.minX, f.centerY, f.maxX, f.centerY, u]), a === !0 || a === "vertical" ? (i["".concat(l, "tlbl")] = [f.minX, f.minY, f.minX, f.maxY, u], i["".concat(l, "tcbc")] = [f.centerX, f.minY, f.centerX, f.maxY, u], i["".concat(l, "trbr")] = [f.maxX, f.minY, f.maxX, f.maxY, u]) : a === "center" && (i["".concat(l, "tcbc")] = [f.centerX, f.minY, f.centerX, f.maxY, u]);
    });
  }, t.prototype.show = function(e, n) {
    var i = kt({}, e);
    return this.itemAlign(e, n, i), e;
  }, t.prototype.itemAlign = function(e, n, i) {
    var a = this, o = this._cfgs, s = o.horizontalLines, u = o.verticalLines, f = o.tolerance, l = {
      x: i.x + n.width / 2,
      y: i.y
    }, c = {
      x: i.x + n.width / 2,
      y: i.y + n.height / 2
    }, h = {
      x: i.x + n.width / 2,
      y: i.y + n.height
    }, d = {
      x: i.x,
      y: i.y + n.height / 2
    }, v = {
      x: i.x + n.width,
      y: i.y + n.height / 2
    }, p = [], g = [], y = null;
    if (this.clearAlignLine(), Se(s, function(m) {
      m[4].isVisible && (p.push(a.getLineDisObject(m, l)), p.push(a.getLineDisObject(m, c)), p.push(a.getLineDisObject(m, h)));
    }), Se(u, function(m) {
      m[4].isVisible && (g.push(a.getLineDisObject(m, d)), g.push(a.getLineDisObject(m, c)), g.push(a.getLineDisObject(m, v)));
    }), p.sort(function(m, x) {
      return m.dis - x.dis;
    }), g.sort(function(m, x) {
      return m.dis - x.dis;
    }), p.length !== 0 && p[0].dis < f) {
      e.y = p[0].line[1] - p[0].point.y + i.y, y = {
        type: "item",
        horizontals: [p[0]]
      };
      for (var b = 1; b < 3; b++)
        p[0].dis === p[b].dis && y.horizontals.push(p[b]);
    }
    if (g.length !== 0 && g[0].dis < f) {
      e.x = g[0].line[0] - g[0].point.x + i.x, y ? y.verticals = [g[0]] : y = {
        type: "item",
        verticals: [g[0]]
      };
      for (var b = 1; b < 3; b++)
        g[0].dis === g[b].dis && y.verticals.push(g[b]);
    }
    y && (y.bbox = n, this.addAlignLine(y));
  }, t.prototype.addAlignLine = function(e) {
    var n = e.bbox, i = e.type, a = e.horizontals, o = e.verticals, s = this._cfgs, u = s.line, f = s.alignLines, l = this.get("graph"), c = l.get("group");
    i === "item" && (a && Se(a, function(h) {
      var d = h.line, v = h.point, p = (d[0] + d[2]) / 2, g, y;
      v.x < p ? (g = v.x - n.width / 2, y = Math.max(d[0], d[2])) : (g = v.x + n.width / 2, y = Math.min(d[0], d[2]));
      var b = kt({
        x1: g,
        y1: d[1],
        x2: y,
        y2: d[1]
      }, u), m = c.addShape("line", {
        attrs: b,
        capture: !1
      });
      f.push(m);
    }), o && Se(o, function(h) {
      var d = h.line, v = h.point, p = (d[1] + d[3]) / 2, g, y;
      v.y < p ? (g = v.y - n.height / 2, y = Math.max(d[1], d[3])) : (g = v.y + n.height / 2, y = Math.min(d[1], d[3]));
      var b = kt({
        x1: d[0],
        y1: g,
        x2: d[0],
        y2: y
      }, u), m = c.addShape("line", {
        attrs: b,
        capture: !1
      });
      f.push(m);
    }));
  }, t.prototype.getLineDisObject = function(e, n) {
    return {
      line: e,
      point: n,
      dis: Wye(e, n)
    };
  }, t.prototype.getContainer = function() {
    return this.get("container");
  }, t.prototype.clearAlignLine = function() {
    var e = this._cfgs.alignLines;
    Se(e, function(n) {
      n.remove();
    }), e.length = 0;
  }, t.prototype.destory = function() {
    var e = this._cfgs, n = e.horizontalLines, i = e.verticalLines, a = this.get("graph"), o = a.getNodes();
    o.forEach(function(s) {
      var u = s.get("id");
      delete n["".concat(u, "tltr")], delete n["".concat(u, "lcrc")], delete n["".concat(u, "blbr")], delete i["".concat(u, "tlbl")], delete i["".concat(u, "tcbc")], delete i["".concat(u, "trbr")];
    }), this.clearAlignLine();
  }, t;
}(hi);
const Yye = Xye;
var Hye = globalThis && globalThis.__extends || function() {
  var r = function(e, n) {
    return r = Object.setPrototypeOf || {
      __proto__: []
    } instanceof Array && function(i, a) {
      i.__proto__ = a;
    } || function(i, a) {
      for (var o in a)
        Object.prototype.hasOwnProperty.call(a, o) && (i[o] = a[o]);
    }, r(e, n);
  };
  return function(t, e) {
    if (typeof e != "function" && e !== null)
      throw new TypeError("Class extends value " + String(e) + " is not a constructor or null");
    r(t, e);
    function n() {
      this.constructor = t;
    }
    t.prototype = e === null ? Object.create(e) : (n.prototype = e.prototype, new n());
  };
}(), Wr = globalThis && globalThis.__assign || function() {
  return Wr = Object.assign || function(r) {
    for (var t, e = 1, n = arguments.length; e < n; e++) {
      t = arguments[e];
      for (var i in t)
        Object.prototype.hasOwnProperty.call(t, i) && (r[i] = t[i]);
    }
    return r;
  }, Wr.apply(this, arguments);
}, Kye = ["click", "mouseenter"], qye = function(r) {
  Hye(t, r);
  function t(e) {
    return r.call(this, e) || this;
  }
  return t.prototype.getDefaultCfgs = function() {
    return {
      data: {},
      position: "top",
      padding: 8,
      margin: 8,
      offsetX: 0,
      offsetY: 0,
      layout: "horizontal",
      flipPage: !1,
      containerStyle: {},
      align: void 0,
      horiSep: 8,
      vertiSep: 8,
      filter: {
        enable: !1,
        trigger: "click"
      }
    };
  }, t.prototype.init = function() {
    this.formatArray("padding"), this.formatArray("margin");
    var e = this.get("filter") || {}, n = e.multiple;
    n && e.trigger === "mouseenter" && this.set("multiple", !1);
    var i = this.get("align");
    if (!i) {
      var a = this.get("position").split("-");
      a.includes("left") && (i = "left"), a.includes("right") ? i = "right" : i = "center", this.set("align", i);
    }
    var o = this.get("graph"), s = o.get("container"), u = Nr(`<div class='g6-legend-container' style="position: absolute;"></div>`);
    s.appendChild(u), this.set("container", u);
    var f = this.render();
    ar(u, this.getContainerPos(f)), this.bindEvents();
  }, t.prototype.getContainerPos = function(e) {
    e === void 0 && (e = [0, 0]);
    var n = this, i = n.get("graph"), a = this.get("offsetX"), o = this.get("offsetY"), s = this.get("margin"), u = this.get("position").split("-"), f = {
      top: 0,
      right: 1,
      bottom: 2,
      left: 3
    }, l = 0, c = 0, h = {
      left: (i.getWidth() - e[0]) / 2 + l,
      top: (i.getHeight() - e[1]) / 2 + c
    };
    return u.forEach(function(d) {
      var v = s[f[d]], p = d;
      switch (d) {
        case "top":
          v += c;
          break;
        case "left":
          v += l;
          break;
        case "bottom":
          v = i.getHeight() - e[1] - v + c, p = "top";
          break;
        default:
          v = i.getWidth() - e[0] - v + l, p = "left";
          break;
      }
      h[p] = v;
    }), h.top += o + i.getContainer().offsetTop, h.left += a + i.getContainer().offsetLeft, Object.keys(h).forEach(function(d) {
      h[d] = "".concat(h[d], "px");
    }), h;
  }, t.prototype.bindEvents = function() {
    var e = this, n = e.get("filter");
    if (!(!n || !n.enable)) {
      var i = n.trigger || "click";
      Kye.includes(i) || (console.warn("Trigger for legend filterling must be 'click' or 'mouseenter', 'click' will take effect by default."), i = "click");
      var a = e.get("legendCanvas");
      i === "mouseenter" ? (a.on("node-container:mouseenter", function(o) {
        return e.filterData(o);
      }), a.on("node-container:mouseleave", function(o) {
        e.clearFilter(), e.clearActiveLegend();
      })) : (a.on("node-container:click", function(o) {
        return e.filterData(o);
      }), a.on("click", function(o) {
        o.target && o.target.isCanvas && o.target.isCanvas() && (e.clearFilter(), e.clearActiveLegend());
      }));
    }
  }, t.prototype.changeData = function(e) {
    this.set("data", e);
    var n = this.render();
    ar(this.get("container"), this.getContainerPos(n));
  }, t.prototype.activateLegend = function(e) {
    var n = this.get("filter"), i = n == null ? void 0 : n.multiple;
    i || this.clearActiveLegend();
    var a = e.get("parent");
    a.get("active") ? (a.set("active", !1), this.findLegendItemsByState("active").length && a.set("inactive", !0)) : (a.set("inactive", !1), a.set("active", !0)), this.findLegendItemsByState("active").length ? this.findLegendItemsByState("active", "all", !1).forEach(function(c) {
      c.set("inactive", !0);
    }) : this.clearActiveLegend();
    var o = (n == null ? void 0 : n.legendStateStyles) || {}, s = (o == null ? void 0 : o.inactive) || {
      opacity: 0.5,
      "text-shape": {
        opacity: 0.5
      }
    }, u = s["text-shape"] || {};
    this.findLegendItemsByState("inactive").forEach(function(c) {
      var h = c.get("children"), d = h[0], v = h[1];
      d.attr(Wr(Wr({}, d.get("oriAttrs")), s)), v.attr(Wr(Wr({}, v.get("oriAttrs")), u));
    });
    var f = (o == null ? void 0 : o.active) || {
      stroke: "#000",
      lineWidth: 2,
      "text-shape": {
        fontWeight: "bold"
      }
    }, l = f["text-shape"] || {};
    this.findLegendItemsByState("active").forEach(function(c) {
      var h = c.get("children"), d = h[0], v = h[1];
      d.attr(Wr(Wr({}, d.get("oriAttrs")), f)), v.attr(Wr(Wr({}, v.get("oriAttrs")), l));
    });
  }, t.prototype.findLegendItemsByState = function(e, n, i) {
    n === void 0 && (n = "all"), i === void 0 && (i = !0);
    var a = this.get("legendCanvas").find(function(u) {
      return u.get("name") === "root";
    }), o = a.find(function(u) {
      return u.get("name") === "node-group";
    }), s = a.find(function(u) {
      return u.get("name") === "edge-group";
    });
    return n === "node" ? o.get("children").filter(function(u) {
      return !!u.get(e) === i;
    }) : n === "edge" ? s.get("children").filter(function(u) {
      return !!u.get(e) === i;
    }) : o.get("children").filter(function(u) {
      return !!u.get(e) === i;
    }).concat(s.get("children").filter(function(u) {
      return !!u.get(e) === i;
    }));
  }, t.prototype.clearActiveLegend = function() {
    var e = this.get("legendCanvas"), n = e.find(function(a) {
      return a.get("name") === "root";
    }), i = [n.find(function(a) {
      return a.get("name") === "node-group";
    }), n.find(function(a) {
      return a.get("name") === "edge-group";
    })];
    i.forEach(function(a) {
      a.get("children").forEach(function(o) {
        o.set("active", !1), o.set("inactive", !1);
        var s = o.get("children"), u = s[0], f = s[1];
        u.attr(u.get("oriAttrs")), f.attr(f.get("oriAttrs"));
      });
    });
  }, t.prototype.filterData = function(e) {
    var n = this.get("filter"), i = n == null ? void 0 : n.filterFunctions;
    if (!(!n || !i)) {
      var a = this.get("legendCanvas"), o = this.get("graph"), s = n.graphActiveState || "active", u = n.graphInactiveState || "inactive", f = n.multiple;
      this.clearFilter(), f || this.clearActiveLegend(), this.activateLegend(e.target);
      var l = a.find(function(y) {
        return y.get("name") === "root";
      }), c = l.find(function(y) {
        return y.get("name") === "node-group";
      }), h = l.find(function(y) {
        return y.get("name") === "edge-group";
      }), d = c.get("children").filter(function(y) {
        return y.get("active");
      }), v = h.get("children").filter(function(y) {
        return y.get("active");
      }), p = 0, g = ["getNodes", "getEdges"];
      g.forEach(function(y) {
        o[y]().forEach(function(b) {
          var m = !1, x = y === "getNodes" ? d : v;
          x.forEach(function(_) {
            var w = i[_.get("id")];
            m = m || w(b.getModel());
          }), m ? (o.setItemState(b, u, !1), o.setItemState(b, s, !0), p++) : (o.setItemState(b, s, !1), o.setItemState(b, u, !0));
        });
      }), p || g.forEach(function(y) {
        o[y]().forEach(function(b) {
          o.clearItemStates(b, [u]);
        });
      });
    }
  }, t.prototype.clearFilter = function() {
    var e = this.get("graph"), n = this.get("filter");
    if (!!n) {
      var i = n.graphActiveState || "active", a = n.graphInactiveState || "inactive";
      e.getNodes().forEach(function(o) {
        e.clearItemStates(o, [i, a]);
      }), e.getEdges().forEach(function(o) {
        e.clearItemStates(o, [i, a]);
      });
    }
  }, t.prototype.render = function() {
    var e = this;
    this.processData();
    var n = this.get("legendCanvas");
    n ? n.clear() : n = new po({
      container: this.get("container"),
      width: 200,
      height: 200
    });
    var i = n.addGroup({
      name: "root"
    }), a = i.addGroup({
      name: "node-group"
    }), o = i.addGroup({
      name: "edge-group"
    });
    this.set("legendCanvas", n);
    var s = this.get("itemsData"), u = ["nodes", "edges"], f = [a, o];
    u.forEach(function(O, D) {
      s[O].forEach(function(G) {
        var R, F = f[D].addGroup({
          id: G.id,
          name: "node-container"
        }), q, ne = G.type, oe = e.getShapeSize(G), ie = oe.width, Ee = oe.height, Xe = oe.r, le = e.getStyle(O.substr(0, 4), G);
        switch (G.type) {
          case "circle":
            q = {
              r: Xe,
              x: 0,
              y: 0
            };
            break;
          case "rect":
            q = {
              width: ie,
              height: Ee,
              x: -ie / 2,
              y: -Ee / 2
            };
            break;
          case "ellipse":
            q = {
              r1: ie,
              r2: Ee,
              x: 0,
              y: 0
            };
            break;
          case "line":
            q = {
              x1: -ie / 2,
              y1: 0,
              x2: ie / 2,
              y2: 0
            }, ne = "line";
            break;
          case "quadratic":
            q = {
              path: [["M", -ie / 2, 0], ["Q", 0, ie / 2, ie / 2, 0]]
            }, ne = "path";
            break;
          case "cubic":
            q = {
              path: [["M", -ie / 2, 0], ["C", -ie / 6, ie / 2, ie / 6, -ie / 2, ie / 2, 0]]
            }, ne = "path";
            break;
          default:
            q = {
              r: Xe,
              x: 0,
              y: 0
            };
            break;
        }
        var Me = F.addShape(ne, {
          attrs: Wr(Wr({}, q), le),
          name: "".concat(G.type, "-node-keyShape"),
          oriAttrs: Wr({
            opacity: 1
          }, le)
        });
        if (G.label) {
          var $e = Me.getBBox(), et = ((R = G.labelCfg) === null || R === void 0 ? void 0 : R.style) || {}, ft = Wr({
            textAlign: "begin",
            fontSize: 12,
            textBaseline: "middle",
            fill: "#000",
            opacity: 1,
            fontWeight: "normal"
          }, et);
          F.addShape("text", {
            attrs: Wr({
              x: $e.maxX + 4,
              y: 0,
              text: G.label
            }, ft),
            className: "legend-label",
            name: "".concat(G.type, "-node-text"),
            oriAttrs: ft
          });
        }
      });
    });
    var l = this.get("padding"), c, h = i.find(function(O) {
      return O.get("name") === "title-container";
    }), d = {
      height: 0,
      maxY: 0,
      width: 0
    };
    if (this.get("title")) {
      h || (h = i.addGroup({
        name: "title-container"
      }));
      var v = {
        fontSize: 20,
        fontFamily: "Arial",
        fontWeight: 300,
        textBaseline: "top",
        textAlign: "center",
        fill: "#000",
        x: 0,
        y: l[0]
      }, p = this.get("titleConfig") || {}, g = Object.assign(v, p.style || {});
      c = h.addShape("text", {
        attrs: Wr({
          text: this.get("title")
        }, g)
      }), d = h.getCanvasBBox(), h.setMatrix([1, 0, 0, 0, 1, 0, p.offsetX, p.offsetY, 1]);
    }
    this.layoutItems();
    var y = i.getCanvasBBox(), b = a.getCanvasBBox(), m = b.minX < 0 ? Math.abs(b.minX) + l[3] : l[3], x = d.maxY < b.minY ? Math.abs(d.maxY - b.minY) + l[0] : d.maxY + l[0], _ = [1, 0, 0, 0, 1, 0, m, x, 1];
    a.setMatrix(_), y = i.getCanvasBBox();
    var w = [y.minX + y.width + l[1], y.minY + y.height + l[2]];
    if (c) {
      var p = Wr({
        position: "center",
        offsetX: 0,
        offsetY: 0
      }, this.get("titleConfig"));
      d = h.getCanvasBBox();
      var E = h.getMatrix() || [1, 0, 0, 0, 1, 0, 0, 0, 1];
      p.position === "center" ? E[6] = w[0] / 2 + p.offsetX : p.position === "right" ? (E[6] = w[0] - l[3] + p.offsetX, c.attr({
        textAlign: "right"
      })) : (E[6] = l[3] + p.offsetX, c.attr({
        textAlign: "left"
      })), h.setMatrix(E), d = h.getCanvasBBox(), m = b.minX < 0 ? Math.abs(b.minX) + l[3] : l[3], x = b.minY < d.maxY ? Math.abs(d.maxY - b.minY) + l[0] : d.maxY + l[0], _ = [1, 0, 0, 0, 1, 0, m, x, 1], a.setMatrix(_);
      var M = [1, 0, 0, 0, 1, 0, m, x, 1];
      this.get("layout") === "vertical" ? M[6] += b.maxX + this.get("horiSep") : M[7] += b.maxY + this.get("vertiSep"), o.setMatrix(M);
    } else {
      b = a.getCanvasBBox();
      var C = [1, 0, 0, 0, 1, 0, 0, 0, 1];
      this.get("layout") === "vertical" ? C[6] += _[6] + b.maxX + this.get("horiSep") : C[7] += _[7] + b.maxY + this.get("vertiSep"), o.setMatrix(C);
    }
    y = i.getCanvasBBox(), b = a.getCanvasBBox(), _ = a.getMatrix() || [1, 0, 0, 0, 1, 0, 0, 0, 1];
    var S = o.getMatrix() || [1, 0, 0, 0, 1, 0, 0, 0, 1], A = o.getCanvasBBox();
    w = [Math.max(b.width + _[6], A.width + S[6]) + l[1], Math.max(b.height + _[7], A.height + S[7]) + l[2]], n.changeSize(w[0], w[1]);
    var T = this.get("containerStyle"), P = i.getMatrix() || [1, 0, 0, 0, 1, 0, 0, 0, 1], k = ci.invertMatrix({
      x: 0,
      y: 0
    }, P), L = i.addShape("rect", {
      attrs: Wr({
        x: k.x + (T.lineWidth || 1),
        y: k.y + (T.lineWidth || 1),
        width: w[0] - 2 * (T.lineWidth || 1),
        height: w[1] - 2 * (T.lineWidth || 1),
        fill: "#f00",
        stroke: "#000",
        lineWidth: 1,
        opacity: 0.5
      }, T),
      name: "legend-back-rect",
      capture: !1
    });
    return L.toBack(), w;
  }, t.prototype.layoutItems = function() {
    var e = this.get("legendCanvas"), n = this.get("horiSep"), i = this.get("vertiSep"), a = this.get("layout"), o = this.get("align"), s = [0, 0], u = e.find(function(m) {
      return m.get("name") === "root";
    }), f = u.find(function(m) {
      return m.get("name") === "node-group";
    }), l = u.find(function(m) {
      return m.get("name") === "edge-group";
    }), c = {
      min: 0,
      max: -1 / 0
    };
    f.get("children").forEach(function(m, x) {
      x === 0 && (c.min = s[0]);
      var _ = m.get("children")[0], w = m.getCanvasBBox(), E = _.getBBox(), M = E.width, C = E.height, S = 0, A = 0;
      a === "vertical" ? (S = s[1], A = s[0] + M / 2, s[0] = A + w.height + i, w.maxX + S + M / 2) : (S = s[0] + M / 2, A = s[1], s[0] = S + w.width + n, w.maxY + A + C / 2), s[0] > c.max && (c.max = s[0]), m.setMatrix([1, 0, 0, 0, 1, 0, S, A, 1]);
    });
    var h = c.max - c.min, d = {
      min: 0,
      max: -1 / 0
    }, v = f.getCanvasBBox();
    s[0] = 0, s[1] = a === "vertical" ? v.maxX + n : v.maxY + i, l.get("children").forEach(function(m, x) {
      x === 0 && (d.min = s[0]);
      var _ = m.get("children")[0], w = m.getCanvasBBox(), E = _.getBBox(), M = E.width, C = E.height, S = 0, A = 0;
      a === "vertical" ? (S = s[1], A = s[0], s[0] = A + w.height + i, m.setMatrix([1, 0, 0, 0, 1, 0, 0, A + C / 2, 1])) : (S = s[0], A = s[1], s[0] = S + w.width + n, m.setMatrix([1, 0, 0, 0, 1, 0, S + M / 2, 0, 1])), s[0] > d.max && (d.max = s[0]);
    });
    var p = d.max - d.min;
    if (o && o !== "" && o !== "left") {
      var g = h - p, y = o === "center" ? Math.abs(g) / 2 : Math.abs(g), b = g < 0 ? f : l;
      b.get("children").forEach(function(m) {
        var x = m.getMatrix() || [1, 0, 0, 0, 1, 0, 0, 0, 1];
        a === "vertical" ? x[7] += y : x[6] += y, m.setMatrix(x);
      });
    }
  }, t.prototype.processData = function() {
    var e = this.get("data"), n = {
      nodes: [],
      edges: []
    };
    e.nodes && (e.nodes.sort(function(i, a) {
      return i.order - a.order;
    }), e.nodes.forEach(function(i) {
      var a, o, s, u, f, l = i.size || [((a = i.style) === null || a === void 0 ? void 0 : a.width) || ((o = i.style) === null || o === void 0 ? void 0 : o.r) || 8, ((s = i.style) === null || s === void 0 ? void 0 : s.height) || ((u = i.style) === null || u === void 0 ? void 0 : u.r) || 8], c = ((f = i.labelCfg) === null || f === void 0 ? void 0 : f.style) || {};
      n.nodes.push({
        id: i.id || ja(),
        type: i.type || "circle",
        style: Wr({}, i.style),
        order: i.order,
        label: i.label,
        itemType: "node",
        size: l,
        labelCfg: {
          position: "right",
          style: Wr({
            fontFamily: "Arial"
          }, c)
        }
      });
    })), e.edges && (e.edges.sort(function(i, a) {
      return i.order - a.order;
    }), e.edges.forEach(function(i) {
      var a, o, s = i.type || "line";
      i.type === "cubic-horizontal" && (s = "cubic");
      var u = ((a = i.labelCfg) === null || a === void 0 ? void 0 : a.style) || {}, f = i.size || [((o = i.style) === null || o === void 0 ? void 0 : o.width) || 8, 1];
      n.edges.push({
        id: i.id || ja(),
        type: s,
        size: f,
        style: Wr({
          lineWidth: Dt(f) ? f[1] : 1
        }, i.style),
        order: i.order,
        label: i.label,
        itemType: "edge",
        labelCfg: {
          position: "right",
          style: Wr({
            fontFamily: "Arial"
          }, u)
        }
      });
    })), this.set("itemsData", n);
  }, t.prototype.getContainer = function() {
    return this.get("container");
  }, t.prototype.formatArray = function(e) {
    var n = this.get(e);
    if (At(n))
      this.set(e, [n, n, n, n]);
    else if (Dt(n))
      switch (n.length) {
        case 0:
          this.set(e, [0, 0, 0, 0]);
          break;
        case 1:
          this.set(e, [n[0], n[0], n[0], n[0]]);
          break;
        case 2:
          this.set(e, [n[0], n[1], n[0], n[1]]);
          break;
        case 3:
          this.set(e, [n[0], n[1], n[2], n[1]]);
          break;
      }
    return this.get(e);
  }, t.prototype.getShapeSize = function(e) {
    var n, i, a;
    return e.size && (Dt(e.size) ? (n = e.size[0], i = e.size[1] || e.size[0], a = e.size[0] / 2) : At(e.size) && (n = e.size, i = e.size, a = e.size / 2)), e.style && (e.style.width && (n = e.style.width), e.style.height && (i = e.style.height), e.style.r && (a = e.style.r)), a || (a = 5), n || (n = a), i || (i = a), {
      width: n,
      height: i,
      r: a
    };
  }, t.prototype.getStyle = function(e, n) {
    var i = e === "node" ? {
      fill: "#ccc",
      lineWidth: 0
    } : {
      stroke: "#000",
      lineWidth: 1
    };
    return Wr(Wr({}, i), n.style || {});
  }, t.prototype.destroy = function() {
    var e = this.get("legendCanvas");
    e == null || e.destroy();
    var n = this.get("graph"), i = n.get("container"), a = this.get("container");
    i.removeChild(a);
  }, t;
}(hi);
const Zye = qye;
var Qye = globalThis && globalThis.__extends || function() {
  var r = function(e, n) {
    return r = Object.setPrototypeOf || {
      __proto__: []
    } instanceof Array && function(i, a) {
      i.__proto__ = a;
    } || function(i, a) {
      for (var o in a)
        Object.prototype.hasOwnProperty.call(a, o) && (i[o] = a[o]);
    }, r(e, n);
  };
  return function(t, e) {
    if (typeof e != "function" && e !== null)
      throw new TypeError("Class extends value " + String(e) + " is not a constructor or null");
    r(t, e);
    function n() {
      this.constructor = t;
    }
    t.prototype = e === null ? Object.create(e) : (n.prototype = e.prototype, new n());
  };
}(), ki = globalThis && globalThis.__assign || function() {
  return ki = Object.assign || function(r) {
    for (var t, e = 1, n = arguments.length; e < n; e++) {
      t = arguments[e];
      for (var i in t)
        Object.prototype.hasOwnProperty.call(t, i) && (r[i] = t[i]);
    }
    return r;
  }, ki.apply(this, arguments);
}, QO = globalThis && globalThis.__rest || function(r, t) {
  var e = {};
  for (var n in r)
    Object.prototype.hasOwnProperty.call(r, n) && t.indexOf(n) < 0 && (e[n] = r[n]);
  if (r != null && typeof Object.getOwnPropertySymbols == "function")
    for (var i = 0, n = Object.getOwnPropertySymbols(r); i < n.length; i++)
      t.indexOf(n[i]) < 0 && Object.prototype.propertyIsEnumerable.call(r, n[i]) && (e[n[i]] = r[n[i]]);
  return e;
};
typeof document < "u" && sl.exports(`
  .g6-annotation-container {
    background-color: rgba(255, 255, 255, 0.3);
    padding: 8px;
  }
  .g6-annotation-wrapper {
    background-color: #fff;
    box-shadow: 0 0 8px rgba(0, 0, 0, 0.85);
  }
  .g6-annotation-header-wapper {
    height: fit-content;
    width: 100%;
    background-color: #5B8FF9;
    display: inline-flex;
    cursor: move;
  }
  .g6-annotation-title {
    margin: 4px 40px 4px 8px;
    cursor: text;
    min-width: 32px;
  }
  .g6-annotation-collapse {
    margin: 4px;
    cursor: pointer;
  }
  .g6-annotation-expand {
    margin: 4px;
    cursor: pointer;
  }
  .g6-annotation-close {
    margin: 4px 8px 4px 0;
    cursor: pointer;
  }
  .g6-annotation-content {
    padding: 8px;
    width: fit-content;
    cursor: text;
    word-break: break-all;
    min-width: 32px;
  }
  .g6-annotation-title-input-wrapper {
    margin: 4px 40px 4px 8px;
  }
  .g6-annotation-content-input {
    height: 100%;
    word-break: break-all;
  }
  .g6-annotation-content-input-wrapper {
    margin: 8px;
    height: 100%;
  }
`);
var JO = "canvas-annotation", Jye = function(r) {
  Qye(t, r);
  function t(e) {
    return r.call(this, e) || this;
  }
  return t.prototype.getDefaultCfgs = function() {
    return {
      trigger: "click",
      editable: !0,
      itemHighlightState: "highlight",
      linkHighlightStyle: {
        shadowColor: "#5B8FF9",
        shadowBlur: 10
      },
      cardCfg: {
        minHeight: 60,
        width: "fit-content",
        height: "fit-content",
        collapseType: "minimize",
        closeType: "hide",
        borderRadius: 5,
        maxTitleLength: 20
      }
    };
  }, t.prototype.getEvents = function() {
    var e = {
      viewportchange: "updateLinks",
      afterlayout: "updateLinks",
      aftergraphrefreshposition: "updateLinks",
      afterupdateitem: "updateLink",
      afterchangedata: "onGraphDataChange",
      afteritemvisibilitychange: "onGraphItemVisibilityChange"
    };
    switch (this.get("trigger")) {
      case "click":
        e = ki(ki({}, e), {
          "node:click": "showAnnotation",
          "edge:click": "showAnnotation"
        });
    }
    return e;
  }, t.prototype.getDOMContent = function(e) {
    if (!this.destroyed) {
      var n = e.collapsed, i = e.maxWidth, a = e.title, o = a === void 0 ? "" : a, s = e.content, u = s === void 0 ? "" : s, f = e.borderRadius, l = f === void 0 ? 5 : f, c = n ? "<p class='g6-annotation-expand'>+</p>" : "<p class='g6-annotation-collapse'>-</p>", h = n ? "" : " <p class='g6-annotation-content'>".concat(u, "</p>"), d = "<p class='g6-annotation-close'>x</p>", v = n ? "".concat(l, "px") : "".concat(l, "px ").concat(l, "px 0 0");
      return '<div class="g6-annotation-wrapper" style="border-radius: '.concat(l, "px; max-width: ").concat(i, `px">
        <div
          class="g6-annotation-header-wapper"
          style="border-radius: `).concat(v, `;"
        >
          <h4 class='g6-annotation-title'>`).concat(o, `</h4>
          `).concat(c, `
          `).concat(d, `
        </div>
        `).concat(h, `
      </div>`);
    }
  }, t.prototype.init = function() {
    var e = this;
    if (!e.destroyed) {
      var n = e.get("graph"), i = n.getContainer(), a = e.get("container"), o = this.get("containerCfg");
      o ? (a = this.createContainer(), i.appendChild(a)) : a = i, this.set("container", a);
      var s = i.getBoundingClientRect(), u = new po({
        container: i,
        width: s.right - s.left,
        height: s.bottom - s.top
      });
      ar(u.get("el"), {
        position: "absolute",
        top: 0,
        left: 0,
        pointerEvents: "none"
      }), window.addEventListener("resize", Jc(function() {
        return e.resizeCanvas(e);
      }, 100));
      var f = u.addGroup({
        id: "annotation-link-group"
      });
      e.set("linkGroup", f), e.set("canvas", u), e.get("getTitle") || e.set("getTitle", function(c) {
        var h, d = ((h = c == null ? void 0 : c.getModel) === null || h === void 0 ? void 0 : h.call(c)) || {}, v = d.label, p = d.id;
        return v || p || "-";
      }), e.get("getContent") || e.set("getContent", function(c) {
        var h, d;
        if (!c)
          return "-";
        var v = ((h = c.getModel) === null || h === void 0 ? void 0 : h.call(c)) || {}, p = v.label, g = v.id, y = (d = c.getType) === null || d === void 0 ? void 0 : d.call(c), b = y ? "".concat(y, ": ") : "";
        return "".concat(b).concat(p || g || "");
      });
      var l = e.get("defaultData");
      l && this.readData(l);
    }
  }, t.prototype.createContainer = function() {
    var e = this;
    if (!this.destroyed) {
      var n = this.get("containerCfg"), i = this.get("graph"), a = i.getContainer(), o = a.getBoundingClientRect(), s = o.left, u = o.right, f = o.top, l = o.bottom, c = l - f, h = u - s, d = n.position, v = d === void 0 ? "top" : d, p = n.offsetX, g = p === void 0 ? 0 : p, y = n.offsetY, b = y === void 0 ? 0 : y, m = QO(n, ["position", "offsetX", "offsetY"]), x = n.height, _ = x === void 0 ? "fit-content" : x, w = n.width, E = w === void 0 ? i.getWidth() : w;
      _ === "100%" && (_ = c), E === "100%" && (E = h);
      var M = "unset", C = "unset", S = {};
      switch (v) {
        case "right":
          M = "".concat(c, "px"), S = {
            top: 0,
            right: 0
          }, S.right += s + g, S.top += f + b;
          break;
        case "bottom":
          C = "".concat(h, "px"), S = {
            bottom: 0,
            left: 0
          }, S.left += s + g, S.bottom += f + b;
          break;
        case "top":
          C = "".concat(h, "px");
        case "left":
          M = "".concat(c, "px");
        default:
          S = {
            top: 0,
            left: 0
          }, S.left += s + g, S.top += f + b;
          break;
      }
      Object.keys(S).forEach(function(T) {
        S[T] = "".concat(S[T], "px");
      });
      var A = Nr("<div class='".concat(n.className, " g6-annotation-container'></div>"));
      return ar(A, ki(ki({
        position: "absolute",
        display: v === "top" || v === "bottom" ? "inline-flex" : "unset",
        width: At(E) ? "".concat(E, "px") : E,
        height: At(_) ? "".concat(_, "px") : _,
        maxHeight: M,
        maxWidth: C,
        overflow: "scroll"
      }, S), m)), a.appendChild(A), A.addEventListener("scroll", function(T) {
        e.updateLinks();
      }), A;
    }
  }, t.prototype.resizeCanvas = function(e) {
    clearTimeout(e.resizeTimer), e.resizeTimer = setTimeout(function() {
      if (!(!e || e.destroyed)) {
        var n = e.get("container").getBoundingClientRect(), i = n.right - n.left, a = n.bottom - n.top;
        e.get("canvas").changeSize(i, a), e.updateOutsideCards(e);
      }
    }, 250);
  }, t.prototype.updateOutsideCards = function(e) {
    var n = e || this, i = n.get("cardInfoMap") || {}, a = n.get("graph"), o = a.getPointByCanvas(0, 0), s = a.getPointByCanvas(a.getWidth(), a.getHeight()), u = a.getClientByPoint(o.x, o.y), f = u.x, l = u.y, c = a.getClientByPoint(s.x, s.y), h = c.x, d = c.y;
    Object.values(i).forEach(function(v) {
      var p = v.card;
      if (!!p) {
        var g = p.style, y = Ys(g.left), b = Ys(g.top), m = p.getBoundingClientRect(), x = m.width, _ = m.height, w = y, E = b;
        y + x > h - f && (w = h - f - x), y < 0 && (w = 0), b + _ > d - l && (E = d - l - _), b < 0 && (E = 0), ar(p, {
          left: "".concat(w, "px"),
          top: "".concat(E, "px")
        });
      }
    }), n.updateLinks();
  }, t.prototype.showAnnotation = function(e) {
    if (!this.destroyed) {
      var n = e.item;
      this.toggleAnnotation(n);
    }
  }, t.prototype.hideCards = function() {
    var e = this;
    if (!e.destroyed) {
      var n = e.get("cardInfoMap") || {};
      Object.keys(n).forEach(function(i) {
        e.hideCard(i);
      });
    }
  }, t.prototype.toggleAnnotation = function(e, n) {
    var i, a;
    n === void 0 && (n = {});
    var o = this;
    if (!o.destroyed) {
      var s = o.get("cardInfoMap") || {}, u = o.get("graph"), f = o.get("container"), l = o.get("containerCfg"), c = Object.assign({}, o.get("cardCfg") || {}, n), h = c.minHeight, d = c.minWidth, v = c.width, p = c.height, g = c.collapsed, y = g === void 0 ? !1 : g, b = c.x, m = c.y, x = c.title, _ = c.content, w = c.maxTitleLength, E = c.defaultBegin, M = QO(c, ["minHeight", "minWidth", "width", "height", "collapsed", "x", "y", "title", "content", "maxTitleLength", "defaultBegin"]), C = o.get("linkGroup"), S = this.get("rows") || [[]], A = (i = e.isCanvas) === null || i === void 0 ? void 0 : i.call(e), T = A ? JO : e.getID(), P = s[T] || {}, k = P.card, L = P.link, O = P.x, D = P.y, G = P.title, R = P.content, F = this.get("getTitle"), q = this.get("getContent"), ne = this.get("getContentPlaceholder") || function() {
        return "";
      }, oe = this.get("getTitlePlaceHolder") || function() {
        return "";
      }, ie = ne(e), Ee = oe(e), Xe = Nr(this.getDOMContent(ki({
        itemId: T,
        collapsed: y,
        title: ((a = G || x || (F == null ? void 0 : F(e))) === null || a === void 0 ? void 0 : a.substr(0, w)) || Ee,
        content: R || _ || (q == null ? void 0 : q(e)) || ie
      }, M))), le = At(h) ? "".concat(h, "px") : h;
      ar(Xe, {
        minHeight: y ? "unset" : le,
        minWidth: At(d) ? "".concat(d, "px") : d,
        height: p,
        width: v
      });
      var Me = !!k;
      Me ? (L == null || L.remove(!0), f.replaceChild(Xe, k)) : f.appendChild(Xe);
      var $e;
      if (!l) {
        if ($e = f.getBoundingClientRect() || {}, b !== void 0 && m !== void 0)
          O = b, D = m;
        else if (!Me && !A) {
          var et = $e.top, ft = E || {}, pt = ft.left, $ = ft.right, te = $ === void 0 ? 16 : $, X = ft.top, De = X === void 0 ? 8 : X, Ke = ft.bottom, Fe = te, _t = De;
          isNaN(pt) || (Fe = f.scrollWidth - pt), isNaN(Ke) || (_t = f.scrollHeight - Ke);
          var Kt = At(d) ? d : 100;
          O = f.scrollWidth - Xe.scrollWidth - (S.length - 1) * Kt - Fe;
          var Ye = S[S.length - 1], vt = (Ye[Ye.length - 1] || {}).bbox;
          D = (vt == null ? void 0 : vt.bottom) - et || _t;
        }
        ar(Xe, {
          position: "absolute",
          left: "".concat(O, "px"),
          top: "".concat(D, "px"),
          cusor: l ? "unset" : "move"
        });
      }
      this.bindListener(Xe, T);
      var N = Xe.getBoundingClientRect();
      if (!A) {
        var Z = Vy(e, N, u, this.get("canvas")), pe = this.get("linkStyle");
        L = C.addShape("path", {
          attrs: ki({
            lineWidth: 1,
            lineDash: [5, 5],
            stroke: "#ccc",
            path: Z
          }, pe)
        });
      }
      if (s[T] = ki(ki({}, s[T] || {}), {
        id: T,
        collapsed: y,
        card: Xe,
        link: L,
        x: O,
        y: D,
        cardBBox: N,
        content: R || _,
        title: G || x,
        contentPlaceholder: ie,
        titlePlaceholder: Ee,
        isCanvas: A
      }), o.set("cardInfoMap", s), l)
        this.updateCardPositionsInConatainer(), this.updateLinks();
      else {
        var se = !isNaN(b) && !isNaN(m);
        if (!Me && !A && !se) {
          var Ce = $e.bottom, ke = Ce === void 0 ? 0 : Ce, et = $e.top;
          S[S.length - 1].push({
            id: T,
            bbox: N
          }), N.top > ke - et - N.height - 16 && S.push([]), this.set("rows", S);
        }
      }
      this.updateCardSize(T);
      var at = this.get("onAnnotationChange");
      at == null || at(s[T], Me ? "update" : "create");
    }
  }, t.prototype.updateCardPositionsInConatainer = function() {
    if (!this.destroyed) {
      var e = this.get("cardInfoMap");
      if (!!e) {
        var n = this.get("container"), i = this.get("containerCfg").position, a = n.getBoundingClientRect().width, o = getComputedStyle(n), s = Ys(o.paddingLeft) + Ys(o.paddingRight);
        a -= s, Object.values(e).forEach(function(u) {
          var f = u.card, l = f.getBoundingClientRect().width;
          switch (i) {
            case "right":
              ar(f, {
                marginLeft: a ? "".concat(a - l, "px") : "0px"
              });
              break;
            case "top":
            case "bottom":
              ar(f, {
                marginLeft: "8px"
              });
          }
        });
      }
    }
  }, t.prototype.handleExpandCollapseCard = function(e) {
    if (!this.destroyed) {
      var n = this.get("graph"), i = this.get("cardInfoMap");
      if (!!i) {
        var a = i[e].collapsed, o = n.findById(e);
        if (!!o) {
          var s = this.get("cardCfg").collapseType;
          s === "hide" && !a ? this.hideCard(e) : this.toggleAnnotation(o, {
            collapsed: !a
          }), i[e] = ki(ki({}, i[e]), {
            collapsed: !a
          });
        }
      }
    }
  }, t.prototype.hideCard = function(e) {
    if (!this.destroyed) {
      var n = this.get("cardInfoMap");
      if (!(!n || !n[e])) {
        var i = n[e], a = i.card, o = i.link;
        ar(a, {
          display: "none"
        }), o == null || o.hide();
        var s = this.get("onAnnotationChange");
        s(n[e], "hide");
      }
    }
  }, t.prototype.removeCard = function(e) {
    if (!this.destroyed) {
      var n = this.get("cardInfoMap");
      if (!!n) {
        var i = n[e], a = i.card, o = i.link, s = this.get("container");
        s.removeChild(a), o == null || o.remove(!0), delete n[e];
        var u = this.get("onAnnotationChange");
        u(i, "remove");
      }
    }
  }, t.prototype.bindListener = function(e, n) {
    var i = this;
    if (!this.destroyed) {
      e.addEventListener("mousemove", function(u) {
        var f;
        if (u.target.className === "g6-annotation-collapse" ? f = "collapse" : u.target.className === "g6-annotation-expand" ? f = "expand" : u.target.className === "g6-annotation-close" && (f = "close"), f) {
          var l = i.get("cardCfg").onMouseEnterIcon, c = l === void 0 ? function() {
          } : l;
          c(u, n, f);
        }
      }), e.addEventListener("mouseout", function(u) {
        var f;
        if (u.target.className === "g6-annotation-collapse" ? f = "collapse" : u.target.className === "g6-annotation-expand" ? f = "expand" : u.target.className === "g6-annotation-close" && (f = "close"), f) {
          var l = i.get("cardCfg").onMouseLeaveIcon, c = l === void 0 ? function() {
          } : l;
          c(u, n, f);
        }
      }), e.addEventListener("mouseenter", function(u) {
        var f = i.get("cardInfoMap");
        if (!!f) {
          var l = i.get("graph"), c = l.findById(n);
          if (c) {
            var h = i.get("itemHighlightState");
            l.setItemState(c, h, !0);
          }
          var d = f[n].link;
          if (d) {
            var v = i.get("linkHighlightStyle") || {};
            d.attr(v);
          }
        }
      }), e.addEventListener("mouseleave", function(u) {
        var f = i.get("cardInfoMap");
        if (!!f) {
          var l = i.get("graph"), c = l.findById(n);
          if (c) {
            var h = i.get("itemHighlightState");
            l.setItemState(c, h, !1);
          }
          var d = f[n].link;
          if (d) {
            var v = i.get("linkHighlightStyle") || {};
            Object.keys(v).forEach(function(g) {
              d.attr(g, void 0), d.attr(g, void 0);
            });
            var p = i.get("linkStyle");
            d.attr(p);
          }
        }
      }), e.addEventListener("click", function(u) {
        var f = (i.get("cardCfg") || {}).onClickIcon;
        if (u.target.className === "g6-annotation-collapse" || u.target.className === "g6-annotation-expand") {
          var l = i.get("cardCfg").collapseType;
          l === "hide" ? i.hideCard(n) : i.handleExpandCollapseCard(n), f == null || f(u, n, u.target.className === "g6-annotation-collapse" ? "collapse" : "expand");
        } else if (u.target.className === "g6-annotation-close") {
          var c = i.get("cardCfg").closeType;
          c === "remove" ? i.removeCard(n) : i.hideCard(n), f == null || f(u, n, "close");
        }
      });
      var a = this.get("editable");
      a && e.addEventListener("dblclick", function(u) {
        var f = i.get("cardInfoMap"), l = (i.get("cardCfg") || {}).maxTitleLength, c = l === void 0 ? 20 : l;
        if (!!f) {
          var h = u.target, d = h.className;
          if (!(d !== "g6-annotation-title" && d !== "g6-annotation-content")) {
            var v = d === "g6-annotation-title" ? h.getBoundingClientRect() : h.parentNode.getBoundingClientRect(), p = v.width, g = v.height, y = getComputedStyle(h), b = d === "g6-annotation-title" ? "input" : "textarea", m = Nr("<".concat(b, ' class="').concat(d, '-input" type="textarea" style="width:').concat(p, "px; height: ").concat(g, 'px; min-width: 16px;"/>')), x = Nr('<div class="'.concat(d, '-input-wrapper" style="width: ').concat(p, "px; height: ").concat(g, "px; min-width: 16px; margin-right: ").concat(y.marginRight, '" />'));
            x.appendChild(m), h.parentNode.replaceChild(x, h);
            var _ = f[n], w = _.contentPlaceholder, E = _.titlePlaceholder, M = _.content, C = _.title, S = M;
            d === "g6-annotation-title" ? (m.name = "title", m.maxLength = c, S = C) : m.name = "content", S ? (m.innerHTML = h.innerHTML, m.value = h.innerHTML) : m.placeholder = d === "g6-annotation-title" ? E : w, m.focus(), m.addEventListener("blur", function(A) {
              m.value && (h.innerHTML = m.value, _[m.name || "title"] = m.value), x.parentNode.replaceChild(h, x), i.updateCardSize(n);
              var T = i.get("onAnnotationChange");
              T == null || T(_, "update");
            });
          }
        }
      });
      var o = ["g6-annotation-title", "g6-annotation-content", "g6-annotation-title-input", "g6-annotation-content-input"];
      e.draggable = !0, e.addEventListener("dragstart", function(u) {
        var f = u.target.className;
        if (!o.includes(f)) {
          var l = e.style;
          i.set("dragging", {
            card: e,
            x: u.clientX,
            y: u.clientY,
            left: Ys(l.left),
            top: Ys(l.top)
          });
        }
      }), e.addEventListener("drag", function(u) {
        u.preventDefault();
        var f = i.get("cardInfoMap");
        if (!!f) {
          var l = u.clientX, c = u.clientY, h = i.get("dragging");
          if (!(isNaN(l) || isNaN(c) || !h)) {
            var d = h.x, v = h.y, p = h.left, g = h.top, y = h.card, b = l - d, m = c - v;
            p += b, g += m;
            var x = i.get("graph"), _ = x.getPointByCanvas(0, 0), w = x.getPointByCanvas(x.getWidth(), x.getHeight()), E = x.getClientByPoint(_.x, _.y), M = E.x, C = E.y, S = x.getClientByPoint(w.x, w.y), A = S.x, T = S.y, P = y.getBoundingClientRect(), k = P.right - P.left, L = P.bottom - P.top;
            (p > A - M - k && b > 0 || p < 0 && b < 0) && (p -= b), (g > T - C - L && m > 0 || g < 0 && m < 0) && (g -= m), ar(y, {
              left: "".concat(p, "px"),
              top: "".concat(g, "px"),
              visibility: "hidden"
            }), d = l, v = c;
            var O = (f[n] || {}).link;
            if (O) {
              var D = x.findById(n);
              O.attr("path", Vy(D, P, x, i.get("canvas")));
            }
            i.set("dragging", {
              x: d,
              y: v,
              left: p,
              top: g,
              card: y
            });
          }
        }
      });
      var s = function(f) {
        var l = i.get("cardInfoMap");
        if (!!l) {
          var c = i.get("dragging");
          if (c) {
            var h = c.left, d = c.top, v = c.card;
            l[n].x = h, l[n].y = d, ar(v, {
              visibility: "visible"
            }), i.set("dragging", !1);
            var p = i.get("rows");
            p == null || p.forEach(function(y) {
              for (var b = y.length - 1; b >= 0; b--)
                y[b].id === n && y.splice(b, 1);
            });
            var g = i.get("onAnnotationChange");
            g == null || g(l[n], "update");
          }
        }
      };
      e.addEventListener("dragend", s);
    }
  }, t.prototype.updateCardSize = function(e) {
    var n = this.get("cardInfoMap");
    if (!!n) {
      var i = n[e].card, a = i.getBoundingClientRect().width, o = i.getElementsByClassName("g6-annotation-title")[0];
      if (o) {
        var s = getComputedStyle(o), u = Ys(s.marginLeft), f = o.getBoundingClientRect().width;
        ar(o, {
          marginRight: "".concat(a - u - 24 - 16 - f, "px")
        });
      }
    }
  }, t.prototype.updateLink = function(e) {
    var n = e.item;
    if (!!n) {
      var i = this.get("cardInfoMap");
      if (!!i) {
        var a = this.get("canvas"), o = this.get("graph"), s = n.getID(), u = i[s] || {}, f = u.link, l = u.card;
        if (f) {
          var c = Vy(n, l.getBoundingClientRect(), o, a);
          f.attr("path", c);
        }
      }
    }
  }, t.prototype.updateLinks = function() {
    var e = this;
    if (!this.destroyed) {
      var n = this.get("cardInfoMap");
      if (!!n) {
        var i = this.get("graph");
        Object.values(n).forEach(function(a) {
          var o = a.id, s = i.findById(o);
          e.updateLink({
            item: s
          });
        });
      }
    }
  }, t.prototype.onGraphDataChange = function() {
    var e = this, n = this.get("cardInfoMap");
    if (!!n) {
      var i = this.get("graph");
      Object.values(n).forEach(function(a) {
        var o = a.id, s = a.card, u = a.isCanvas;
        if (!(!s || u || s.style.display === "none")) {
          var f = i.findById(o);
          f && f.isVisible() ? e.toggleAnnotation(f) : e.hideCard(o);
        }
      });
    }
  }, t.prototype.onGraphItemVisibilityChange = function(e) {
    var n = e.item, i = e.visible;
    if (!(!n || n.destroyed)) {
      var a = this.get("cardInfoMap");
      if (!!a) {
        var o = n.getID();
        !a[o] || i || this.hideCard(o);
      }
    }
  }, t.prototype.saveData = function(e) {
    e === void 0 && (e = !1);
    var n = this.get("cardInfoMap");
    if (!!n) {
      var i = this.get("graph"), a = this.get("getTitle"), o = this.get("getContent"), s = [];
      return Object.values(n).forEach(function(u) {
        var f = u.title, l = u.content, c = u.x, h = u.y, d = u.id, v = u.collapsed, p = u.card;
        if (!(p && p.style.display === "none" && !e)) {
          var g = i.findById(d) || i.get("canvas");
          s.push({
            id: d,
            x: c,
            y: h,
            collapsed: v,
            title: f || (a == null ? void 0 : a(g)),
            content: l || (o == null ? void 0 : o(g)),
            visible: p && p.style.display !== "none"
          });
        }
      }), s;
    }
  }, t.prototype.readData = function(e) {
    var n = this, i = this.get("graph");
    e.forEach(function(a) {
      var o = a.id, s = a.x, u = a.y, f = a.title, l = a.content, c = a.collapsed, h = a.visible, d = i.findById(o);
      if (!d && o === JO && (d = i.get("canvas")), !d) {
        var v = n.get("cardInfoMap") || {};
        v[o] = a, n.set("cardInfoMap", v);
        return;
      }
      n.toggleAnnotation(d, {
        x: s,
        y: u,
        title: f,
        content: l,
        collapsed: c
      }), h || n.hideCard(o);
    });
  }, t.prototype.clear = function() {
    var e = this.get("cardInfoMap");
    if (!!e) {
      var n = this.get("container");
      Object.values(e).forEach(function(i) {
        var a = i.card, o = i.link;
        n.removeChild(a), o == null || o.remove(!0);
      }), this.set("cardInfoMap", {});
    }
  }, t.prototype.destroy = function() {
    var e;
    this.clear(), (e = this.get("canvas")) === null || e === void 0 || e.destroy();
    var n = this.get("graph");
    !n || n.destroyed || (this.get("containerCfg") && n.getContainer().removeChild(this.get("container")), this.destroyed = !0);
  }, t;
}(hi);
const eme = Jye;
var tme = function(t, e) {
  var n, i, a = 1 / 0;
  Object.keys(t).forEach(function(u) {
    var f = t[u];
    Object.keys(e).forEach(function(l) {
      var c = e[l], h = f.x - c.x, d = f.y - c.y, v = h * h + d * d;
      a > v && (a = v, n = f, i = c);
    });
  });
  var o = 20, s = ci.getControlPoint(n, i, 0.5, o);
  return [["M", n.x, n.y], ["Q", s.x, s.y, i.x, i.y]];
}, Vy = function(t, e, n, i) {
  var a, o, s = t.getType();
  if (s === "edge")
    o = [t.getKeyShape().getPoint(0.5)];
  else {
    var u = (a = t.getKeyShape) === null || a === void 0 ? void 0 : a.call(t).getBBox(), f = u.minX, l = u.minY, c = u.maxX, h = u.maxY, d = t.getModel(), v = d.x, p = d.y;
    f += v, l += p, c += v, h += p, o = {
      left: {
        x: f,
        y: (l + h) / 2
      },
      right: {
        x: c,
        y: (l + h) / 2
      },
      top: {
        x: (f + c) / 2,
        y: l
      },
      bottom: {
        x: (f + c) / 2,
        y: h
      }
    };
  }
  Object.keys(o).forEach(function(C) {
    var S = o[C], A = S.x, T = S.y, P = n.getClientByPoint(A, T);
    o[C] = i.getPointByClient(P.x, P.y);
  });
  var g = e.top, y = g === void 0 ? 0 : g, b = e.left, m = b === void 0 ? 0 : b, x = e.right, _ = x === void 0 ? 0 : x, w = e.bottom, E = w === void 0 ? 0 : w, M = {
    left: i.getPointByClient(m, (y + E) / 2),
    right: i.getPointByClient(_, (y + E) / 2),
    top: i.getPointByClient((m + _) / 2, y),
    bottom: i.getPointByClient((m + _) / 2, E)
  };
  return tme(o, M);
}, Ys = function(t) {
  return Number(t.replace(/\s+|px/gi, "")) || 0;
}, rme = {
  PluginBase: hi,
  Menu: Sge,
  Grid: bge,
  Minimap: Oge,
  Bundling: Nge,
  ToolBar: jge,
  Tooltip: Vge,
  Fisheye: Gge,
  TimeBar: kye,
  ImageMinimap: Gye,
  EdgeFilterLens: jye,
  SnapLine: Yye,
  Legend: Zye,
  Annotation: eme
};
const gn = rme;
Io("circle", {
  options: {
    size: dt.defaultNode.size,
    style: {
      x: 0,
      y: 0,
      stroke: dt.defaultNode.style.stroke,
      fill: dt.defaultNode.style.fill,
      lineWidth: dt.defaultNode.style.lineWidth
    },
    labelCfg: {
      style: {
        fill: dt.nodeLabel.style.fill,
        fontSize: dt.nodeLabel.style.fontSize,
        fontFamily: dt.windowFontFamily
      }
    },
    linkPoints: {
      top: !1,
      right: !1,
      bottom: !1,
      left: !1,
      size: dt.defaultNode.linkPoints.size,
      lineWidth: dt.defaultNode.linkPoints.lineWidth,
      fill: dt.defaultNode.linkPoints.fill,
      stroke: dt.defaultNode.linkPoints.stroke
    },
    icon: {
      show: !1,
      img: "https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",
      width: 20,
      height: 20
    },
    stateStyles: U({}, dt.nodeStateStyles)
  },
  shapeType: "circle",
  labelPosition: "center",
  drawShape: function(t, e) {
    var n = (this.mergeStyle || this.getOptions(t)).icon, i = n === void 0 ? {} : n, a = this.getShapeStyle(t), o = kr({}, i, t.icon), s = "".concat(this.type, "-keyShape"), u = e.addShape("circle", {
      attrs: a,
      className: s,
      name: s,
      draggable: !0
    });
    e.shapeMap[s] = u;
    var f = o.width, l = o.height, c = o.show, h = o.text;
    if (c) {
      var d = "".concat(this.type, "-icon");
      h ? e.shapeMap[d] = e.addShape("text", {
        attrs: U({
          x: 0,
          y: 0,
          fontSize: 12,
          fill: "#000",
          stroke: "#000",
          textBaseline: "middle",
          textAlign: "center"
        }, o),
        className: d,
        name: d,
        draggable: !0
      }) : e.shapeMap[d] = e.addShape("image", {
        attrs: U({
          x: -f / 2,
          y: -l / 2
        }, o),
        className: d,
        name: d,
        draggable: !0
      });
    }
    return this.drawLinkPoints(t, e), u;
  },
  drawLinkPoints: function(t, e) {
    var n = (this.mergeStyle || this.getOptions(t)).linkPoints;
    if (!!n) {
      var i = n || {}, a = i.top, o = i.left, s = i.right, u = i.bottom, f = i.size, l = i.r, c = kn(i, ["top", "left", "right", "bottom", "size", "r"]), h = this.getSize(t), d = h[0] / 2;
      if (o) {
        var v = "link-point-left";
        e.shapeMap[v] = e.addShape("circle", {
          attrs: U(U({}, c), {
            x: -d,
            y: 0,
            r: f / 2 || l || 5
          }),
          className: v,
          name: v,
          isAnchorPoint: !0
        });
      }
      if (s) {
        var p = "link-point-right";
        e.shapeMap[p] = e.addShape("circle", {
          attrs: U(U({}, c), {
            x: d,
            y: 0,
            r: f / 2 || l || 5
          }),
          className: p,
          name: p,
          isAnchorPoint: !0
        });
      }
      if (a) {
        var g = "link-point-top";
        e.shapeMap[g] = e.addShape("circle", {
          attrs: U(U({}, c), {
            x: 0,
            y: -d,
            r: f / 2 || l || 5
          }),
          className: g,
          name: g,
          isAnchorPoint: !0
        });
      }
      if (u) {
        var y = "link-point-bottom";
        e.shapeMap[y] = e.addShape("circle", {
          attrs: U(U({}, c), {
            x: 0,
            y: d,
            r: f / 2 || l || 5
          }),
          className: y,
          name: y,
          isAnchorPoint: !0
        });
      }
    }
  },
  getShapeStyle: function(t) {
    var e = (this.mergeStyle || this.getOptions(t)).style, n = {
      stroke: t.color
    }, i = kr({}, e, n), a = this.getSize(t), o = a[0] / 2, s = U({
      x: 0,
      y: 0,
      r: o
    }, i);
    return s;
  },
  update: function(t, e, n) {
    var i = e.getContainer(), a = this.getSize(t), o = U({}, t.style);
    t.style.stroke === void 0 && t.color && (o.stroke = t.color), t.style.r === void 0 && !isNaN(a[0]) && (o.r = a[0] / 2), this.updateShape(t, e, o, !0, n), this.updateLinkPoints(t, i);
  }
}, "single-node");
Io("rect", {
  options: {
    size: [100, 30],
    style: {
      radius: 0,
      stroke: dt.defaultNode.style.stroke,
      fill: dt.defaultNode.style.fill,
      lineWidth: dt.defaultNode.style.lineWidth
    },
    labelCfg: {
      style: {
        fill: dt.nodeLabel.style.fill,
        fontSize: dt.nodeLabel.style.fontSize,
        fontFamily: dt.windowFontFamily
      }
    },
    linkPoints: {
      top: !1,
      right: !1,
      bottom: !1,
      left: !1,
      size: dt.defaultNode.linkPoints.size,
      lineWidth: dt.defaultNode.linkPoints.lineWidth,
      fill: dt.defaultNode.linkPoints.fill,
      stroke: dt.defaultNode.linkPoints.stroke
    },
    icon: {
      show: !1,
      img: "https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",
      width: 20,
      height: 20
    },
    anchorPoints: [[0, 0.5], [1, 0.5]],
    stateStyles: U({}, dt.nodeStateStyles)
  },
  shapeType: "rect",
  labelPosition: "center",
  drawShape: function(t, e) {
    var n = this.getShapeStyle(t), i = e.addShape("rect", {
      attrs: n,
      className: "".concat(this.type, "-keyShape"),
      name: "".concat(this.type, "-keyShape"),
      draggable: !0
    });
    return e.shapeMap["".concat(this.type, "-keyShape")] = i, this.drawLinkPoints(t, e), i;
  },
  drawLinkPoints: function(t, e) {
    var n = (this.mergeStyle || this.getOptions(t)).linkPoints, i = n === void 0 ? {} : n, a = i.top, o = i.left, s = i.right, u = i.bottom, f = i.size, l = i.r, c = kn(i, ["top", "left", "right", "bottom", "size", "r"]), h = this.getSize(t), d = h[0], v = h[1];
    o && (e.shapeMap["link-point-left"] = e.addShape("circle", {
      attrs: U(U({}, c), {
        x: -d / 2,
        y: 0,
        r: f / 2 || l || 5
      }),
      className: "link-point-left",
      name: "link-point-left",
      isAnchorPoint: !0
    })), s && (e.shapeMap["link-point-right"] = e.addShape("circle", {
      attrs: U(U({}, c), {
        x: d / 2,
        y: 0,
        r: f / 2 || l || 5
      }),
      className: "link-point-right",
      name: "link-point-right",
      isAnchorPoint: !0
    })), a && (e.shapeMap["link-point-top"] = e.addShape("circle", {
      attrs: U(U({}, c), {
        x: 0,
        y: -v / 2,
        r: f / 2 || l || 5
      }),
      className: "link-point-top",
      name: "link-point-top",
      isAnchorPoint: !0
    })), u && (e.shapeMap["link-point-bottom"] = e.addShape("circle", {
      attrs: U(U({}, c), {
        x: 0,
        y: v / 2,
        r: f / 2 || l || 5
      }),
      className: "link-point-bottom",
      name: "link-point-bottom",
      isAnchorPoint: !0
    }));
  },
  getShapeStyle: function(t) {
    var e = (this.mergeStyle || this.getOptions(t)).style, n = {
      stroke: t.color
    }, i = kt({}, e, n), a = this.getSize(t), o = i.width || a[0], s = i.height || a[1], u = U({
      x: -o / 2,
      y: -s / 2,
      width: o,
      height: s
    }, i);
    return u;
  },
  update: function(t, e, n) {
    var i = e.getContainer(), a = this.getOptions({}).style, o = this.getSize(t), s = e.get("keyShape");
    t.size || (o[0] = s.attr("width") || a.width, o[1] = s.attr("height") || a.height);
    var u = {
      stroke: t.color,
      x: -o[0] / 2,
      y: -o[1] / 2,
      width: o[0],
      height: o[1]
    }, f = kt({}, a, s.attr(), u);
    f = kt(f, t.style), this.updateShape(t, e, f, !1, n), this.updateLinkPoints(t, i);
  }
}, "single-node");
Io("ellipse", {
  options: {
    size: [80, 40],
    style: {
      x: 0,
      y: 0,
      stroke: dt.defaultNode.style.stroke,
      fill: dt.defaultNode.style.fill,
      lineWidth: dt.defaultNode.style.lineWidth
    },
    labelCfg: {
      style: {
        fill: dt.nodeLabel.style.fill,
        fontSize: dt.nodeLabel.style.fontSize,
        fontFamily: dt.windowFontFamily
      }
    },
    linkPoints: {
      top: !1,
      right: !1,
      bottom: !1,
      left: !1,
      size: dt.defaultNode.linkPoints.size,
      lineWidth: dt.defaultNode.linkPoints.lineWidth,
      fill: dt.defaultNode.linkPoints.fill,
      stroke: dt.defaultNode.linkPoints.stroke
    },
    icon: {
      show: !1,
      img: "https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",
      width: 20,
      height: 20
    },
    stateStyles: U({}, dt.nodeStateStyles)
  },
  shapeType: "ellipse",
  labelPosition: "center",
  drawShape: function(t, e) {
    var n = (this.mergeStyle || this.getOptions(t)).icon, i = n === void 0 ? {} : n, a = this.getShapeStyle(t), o = e.addShape("ellipse", {
      attrs: a,
      className: "ellipse-keyShape",
      name: "ellipse-keyShape",
      draggable: !0
    });
    e.shapeMap["ellipse-keyShape"] = o;
    var s = i.width, u = i.height, f = i.show, l = i.text;
    return f && (l ? e.shapeMap["".concat(this.type, "-icon")] = e.addShape("text", {
      attrs: U({
        x: 0,
        y: 0,
        fontSize: 12,
        fill: "#000",
        stroke: "#000",
        textBaseline: "middle",
        textAlign: "center"
      }, i),
      className: "".concat(this.type, "-icon"),
      name: "".concat(this.type, "-icon"),
      draggable: !0
    }) : e.shapeMap["".concat(this.type, "-icon")] = e.addShape("image", {
      attrs: U({
        x: -s / 2,
        y: -u / 2
      }, i),
      className: "".concat(this.type, "-icon"),
      name: "".concat(this.type, "-icon"),
      draggable: !0
    })), this.drawLinkPoints(t, e), o;
  },
  drawLinkPoints: function(t, e) {
    var n = (this.mergeStyle || this.getOptions(t)).linkPoints, i = n === void 0 ? {} : n, a = i.top, o = i.left, s = i.right, u = i.bottom, f = i.size, l = i.r, c = kn(i, ["top", "left", "right", "bottom", "size", "r"]), h = this.getSize(t), d = h[0] / 2, v = h[1] / 2;
    o && (e.shapeMap["link-point-left"] = e.addShape("circle", {
      attrs: U(U({}, c), {
        x: -d,
        y: 0,
        r: f / 2 || l || 5
      }),
      className: "link-point-left",
      name: "link-point-left",
      isAnchorPoint: !0
    })), s && (e.shapeMap["link-point-right"] = e.addShape("circle", {
      attrs: U(U({}, c), {
        x: d,
        y: 0,
        r: f / 2 || l || 5
      }),
      className: "link-point-right",
      name: "link-point-right",
      isAnchorPoint: !0
    })), a && (e.shapeMap["link-point-top"] = e.addShape("circle", {
      attrs: U(U({}, c), {
        x: 0,
        y: -v,
        r: f / 2 || l || 5
      }),
      className: "link-point-top",
      name: "link-point-top",
      isAnchorPoint: !0
    })), u && (e.shapeMap["link-point-bottom"] = e.addShape("circle", {
      attrs: U(U({}, c), {
        x: 0,
        y: v,
        r: f / 2 || l || 5
      }),
      className: "link-point-bottom",
      name: "link-point-bottom",
      isAnchorPoint: !0
    }));
  },
  getShapeStyle: function(t) {
    var e = (this.mergeStyle || this.getOptions(t)).style, n = {
      stroke: t.color
    }, i = kt({}, e, n), a = this.getSize(t), o = a[0] / 2, s = a[1] / 2, u = U({
      x: 0,
      y: 0,
      rx: o,
      ry: s
    }, i);
    return u;
  },
  update: function(t, e, n) {
    var i = e.getContainer(), a = this.getOptions({}).style, o = this.getSize(t), s = {
      stroke: t.color,
      rx: o[0] / 2,
      ry: o[1] / 2
    }, u = e.get("keyShape"), f = kt({}, a, u.attr(), s);
    f = kt(f, t.style), this.updateShape(t, e, f, !0, n), this.updateLinkPoints(t, i);
  }
}, "single-node");
Io("diamond", {
  options: {
    size: [80, 80],
    style: {
      stroke: dt.defaultNode.style.stroke,
      fill: dt.defaultNode.style.fill,
      lineWidth: dt.defaultNode.style.lineWidth
    },
    labelCfg: {
      style: {
        fill: dt.nodeLabel.style.fill,
        fontSize: dt.nodeLabel.style.fontSize,
        fontFamily: dt.windowFontFamily
      }
    },
    linkPoints: {
      top: !1,
      right: !1,
      bottom: !1,
      left: !1,
      size: dt.defaultNode.linkPoints.size,
      lineWidth: dt.defaultNode.linkPoints.lineWidth,
      fill: dt.defaultNode.linkPoints.fill,
      stroke: dt.defaultNode.linkPoints.stroke
    },
    icon: {
      show: !1,
      img: "https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",
      width: 20,
      height: 20
    },
    stateStyles: U({}, dt.nodeStateStyles)
  },
  shapeType: "diamond",
  labelPosition: "center",
  drawShape: function(t, e) {
    var n = (this.mergeStyle || this.getOptions(t)).icon, i = n === void 0 ? {} : n, a = this.getShapeStyle(t), o = e.addShape("path", {
      attrs: a,
      className: "".concat(this.type, "-keyShape"),
      name: "".concat(this.type, "-keyShape"),
      draggable: !0
    });
    e.shapeMap["".concat(this.type, "-keyShape")] = o;
    var s = i.width, u = i.height, f = i.show, l = i.text;
    return f && (l ? e.shapeMap["".concat(this.type, "-icon")] = e.addShape("text", {
      attrs: U({
        x: 0,
        y: 0,
        fontSize: 12,
        fill: "#000",
        stroke: "#000",
        textBaseline: "middle",
        textAlign: "center"
      }, i),
      className: "".concat(this.type, "-icon"),
      name: "".concat(this.type, "-icon"),
      draggable: !0
    }) : e.shapeMap["".concat(this.type, "-icon")] = e.addShape("image", {
      attrs: U({
        x: -s / 2,
        y: -u / 2
      }, i),
      className: "".concat(this.type, "-icon"),
      name: "".concat(this.type, "-icon"),
      draggable: !0
    })), this.drawLinkPoints(t, e), o;
  },
  drawLinkPoints: function(t, e) {
    var n = (this.mergeStyle || this.getOptions(t)).linkPoints, i = n === void 0 ? {} : n, a = i.top, o = i.left, s = i.right, u = i.bottom, f = i.size, l = i.r, c = kn(i, ["top", "left", "right", "bottom", "size", "r"]), h = this.getSize(t), d = h[0], v = h[1];
    o && (e.shapeMap["link-point-left"] = e.addShape("circle", {
      attrs: U(U({}, c), {
        x: -d / 2,
        y: 0,
        r: f / 2 || l || 5
      }),
      className: "link-point-left",
      name: "link-point-left",
      isAnchorPoint: !0
    })), s && (e.shapeMap["link-point-right"] = e.addShape("circle", {
      attrs: U(U({}, c), {
        x: d / 2,
        y: 0,
        r: f / 2 || l || 5
      }),
      className: "link-point-right",
      name: "link-point-right",
      isAnchorPoint: !0
    })), a && (e.shapeMap["link-point-top"] = e.addShape("circle", {
      attrs: U(U({}, c), {
        x: 0,
        y: -v / 2,
        r: f / 2 || l || 5
      }),
      className: "link-point-top",
      name: "link-point-top",
      isAnchorPoint: !0
    })), u && (e.shapeMap["link-point-bottom"] = e.addShape("circle", {
      attrs: U(U({}, c), {
        x: 0,
        y: v / 2,
        r: f / 2 || l || 5
      }),
      className: "link-point-bottom",
      name: "link-point-bottom",
      isAnchorPoint: !0
    }));
  },
  getPath: function(t) {
    var e = this.getSize(t), n = e[0], i = e[1], a = [
      ["M", 0, -i / 2],
      ["L", n / 2, 0],
      ["L", 0, i / 2],
      ["L", -n / 2, 0],
      ["Z"]
    ];
    return a;
  },
  getShapeStyle: function(t) {
    var e = (this.mergeStyle || this.getOptions(t)).style, n = {
      stroke: t.color
    }, i = kt({}, e, n), a = this.getPath(t), o = U({
      path: a
    }, i);
    return o;
  },
  update: function(t, e, n) {
    var i = e.getContainer(), a = this.getOptions({}).style, o = this.getPath(t), s = {
      stroke: t.color,
      path: o
    }, u = e.get("keyShape"), f = kt({}, a, u.attr(), s);
    f = kt(f, t.style), this.updateShape(t, e, f, !0, n), this.updateLinkPoints(t, i);
  }
}, "single-node");
Io("triangle", {
  options: {
    size: 40,
    direction: "up",
    style: {
      stroke: dt.defaultNode.style.stroke,
      fill: dt.defaultNode.style.fill,
      lineWidth: dt.defaultNode.style.lineWidth
    },
    labelCfg: {
      style: {
        fill: dt.nodeLabel.style.fill,
        fontSize: dt.nodeLabel.style.fontSize
      },
      offset: 15
    },
    linkPoints: {
      top: !1,
      right: !1,
      bottom: !1,
      left: !1,
      size: dt.defaultNode.linkPoints.size,
      lineWidth: dt.defaultNode.linkPoints.lineWidth,
      fill: dt.defaultNode.linkPoints.fill,
      stroke: dt.defaultNode.linkPoints.stroke
    },
    icon: {
      show: !1,
      img: "https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",
      width: 20,
      height: 20,
      offset: 6
    },
    stateStyles: U({}, dt.nodeStateStyles)
  },
  shapeType: "triangle",
  labelPosition: "bottom",
  drawShape: function(t, e) {
    var n = this.mergeStyle || this.getOptions(t), i = n.icon, a = i === void 0 ? {} : i, o = n.direction, s = this.getShapeStyle(t), u = t.direction || o, f = e.addShape("path", {
      attrs: s,
      className: "".concat(this.type, "-keyShape"),
      name: "".concat(this.type, "-keyShape"),
      draggable: !0
    });
    e.shapeMap["".concat(this.type, "-keyShape")] = f;
    var l = a.width, c = a.height, h = a.show, d = a.offset, v = a.text;
    if (h)
      if (v)
        e.shapeMap["".concat(this.type, "-icon")] = e.addShape("text", {
          attrs: U({
            x: 0,
            y: 0,
            fontSize: 12,
            fill: "#000",
            stroke: "#000",
            textBaseline: "middle",
            textAlign: "center"
          }, a),
          className: "".concat(this.type, "-icon"),
          name: "".concat(this.type, "-icon"),
          draggable: !0
        });
      else {
        var p = -l / 2, g = -c / 2;
        (u === "up" || u === "down") && (g += d), (u === "left" || u === "right") && (p += d), e.shapeMap["".concat(this.type, "-icon")] = e.addShape("image", {
          attrs: U({
            x: p,
            y: g
          }, a),
          className: "".concat(this.type, "-icon"),
          name: "".concat(this.type, "-icon"),
          draggable: !0
        });
      }
    return this.drawLinkPoints(t, e), f;
  },
  drawLinkPoints: function(t, e) {
    var n = this.mergeStyle || this.getOptions(t), i = n.linkPoints, a = i === void 0 ? {} : i, o = n.direction, s = t.direction || o, u = a.top, f = a.left, l = a.right, c = a.bottom, h = a.size, d = a.r, v = kn(a, ["top", "left", "right", "bottom", "size", "r"]), p = this.getSize(t), g = p[0];
    if (f) {
      var y = null, b = g * Math.sin(1 / 3 * Math.PI), m = g * Math.sin(1 / 3 * Math.PI);
      s === "up" ? y = [-m, b] : s === "down" ? y = [-m, -b] : s === "left" && (y = [-m, m - b]), y && (e.shapeMap["link-point-left"] = e.addShape("circle", {
        attrs: U(U({}, v), {
          x: y[0],
          y: y[1],
          r: h / 2 || d || 5
        }),
        className: "link-point-left",
        name: "link-point-left"
      }));
    }
    if (l) {
      var x = null, b = g * Math.sin(1 / 3 * Math.PI), m = g * Math.sin(1 / 3 * Math.PI);
      s === "up" ? x = [m, b] : s === "down" ? x = [m, -b] : s === "right" && (x = [m, m - b]), x && (e.shapeMap["link-point-right"] = e.addShape("circle", {
        attrs: U(U({}, v), {
          x: x[0],
          y: x[1],
          r: h / 2 || d || 5
        }),
        className: "link-point-right",
        name: "link-point-right"
      }));
    }
    if (u) {
      var _ = null, b = g * Math.sin(1 / 3 * Math.PI), m = g * Math.sin(1 / 3 * Math.PI);
      s === "up" ? _ = [m - b, -b] : s === "left" ? _ = [m, -b] : s === "right" && (_ = [-m, -b]), _ && (e.shapeMap["link-point-top"] = e.addShape("circle", {
        attrs: U(U({}, v), {
          x: _[0],
          y: _[1],
          r: h / 2 || d || 5
        }),
        className: "link-point-top",
        name: "link-point-top"
      }));
    }
    if (c) {
      var w = null, b = g * Math.sin(1 / 3 * Math.PI), m = g * Math.sin(1 / 3 * Math.PI);
      s === "down" ? w = [-m + b, b] : s === "left" ? w = [m, b] : s === "right" && (w = [-m, b]), w && (e.shapeMap["link-point-bottom"] = e.addShape("circle", {
        attrs: U(U({}, v), {
          x: w[0],
          y: w[1],
          r: h / 2 || d || 5
        }),
        className: "link-point-bottom",
        name: "link-point-bottom"
      }));
    }
  },
  getPath: function(t) {
    var e = (this.mergeStyle || this.getOptions(t)).direction, n = t.direction || e, i = this.getSize(t), a = i[0], o = a * Math.sin(1 / 3 * Math.PI), s = a * Math.sin(1 / 3 * Math.PI), u = [
      ["M", -s, o],
      ["L", 0, -o],
      ["L", s, o],
      ["Z"]
    ];
    return n === "down" ? u = [
      ["M", -s, -o],
      ["L", s, -o],
      ["L", 0, o],
      ["Z"]
    ] : n === "left" ? u = [
      ["M", -s, s - o],
      ["L", s, -s],
      ["L", s, s],
      ["Z"]
    ] : n === "right" && (u = [
      ["M", s, s - o],
      ["L", -s, s],
      ["L", -s, -s],
      ["Z"]
    ]), u;
  },
  getShapeStyle: function(t) {
    var e = (this.mergeStyle || this.getOptions(t)).style, n = {
      stroke: t.color
    }, i = kt({}, e, n), a = this.getPath(t), o = U({
      path: a
    }, i);
    return o;
  },
  update: function(t, e, n) {
    var i = e.getContainer(), a = this.getOptions({}).style, o = this.getPath(t), s = {
      stroke: t.color,
      path: o
    }, u = e.get("keyShape"), f = kt({}, a, u.attr(), s);
    f = kt(f, t.style), this.updateShape(t, e, f, !0, n), this.updateLinkPoints(t, i);
  },
  updateLinkPoints: function(t, e) {
    var n = this.getOptions({}), i = n.linkPoints, a = n.direction, o = t.direction || a, s = e.shapeMap["link-point-left"] || e.find(function(O) {
      return O.get("className") === "link-point-left";
    }), u = e.shapeMap["link-point-right"] || e.find(function(O) {
      return O.get("className") === "link-point-right";
    }), f = e.shapeMap["link-point-top"] || e.find(function(O) {
      return O.get("className") === "link-point-top";
    }), l = e.shapeMap["link-point-bottom"] || e.find(function(O) {
      return O.get("className") === "link-point-bottom";
    }), c = i, h = s || u || f || l;
    h && (c = h.attr());
    var d = kt({}, c, t.linkPoints), v = d.fill, p = d.stroke, g = d.lineWidth, y = d.size / 2;
    y || (y = d.r);
    var b = t.linkPoints ? t.linkPoints : {
      left: void 0,
      right: void 0,
      top: void 0,
      bottom: void 0
    }, m = b.left, x = b.right, _ = b.top, w = b.bottom, E = this.getSize(t), M = E[0], C = {
      r: y,
      fill: v,
      stroke: p,
      lineWidth: g
    }, S = null, A = M * Math.sin(1 / 3 * Math.PI), T = M * Math.sin(1 / 3 * Math.PI);
    o === "up" ? S = [-T, A] : o === "down" ? S = [-T, -A] : o === "left" && (S = [-T, T - A]), S && (s ? !m && m !== void 0 ? (s.remove(), delete e.shapeMap["link-point-left"]) : s.attr(U(U({}, C), {
      x: S[0],
      y: S[1]
    })) : m && (e.shapeMap["link-point-left"] = e.addShape("circle", {
      attrs: U(U({}, C), {
        x: S[0],
        y: S[1]
      }),
      className: "link-point-left",
      name: "link-point-left",
      isAnchorPoint: !0
    })));
    var P = null;
    o === "up" ? P = [T, A] : o === "down" ? P = [T, -A] : o === "right" && (P = [T, T - A]), P && (u ? !x && x !== void 0 ? (u.remove(), delete e.shapeMap["link-point-right"]) : u.attr(U(U({}, C), {
      x: P[0],
      y: P[1]
    })) : x && (e.shapeMap["link-point-right"] = e.addShape("circle", {
      attrs: U(U({}, C), {
        x: P[0],
        y: P[1]
      }),
      className: "link-point-right",
      name: "link-point-right",
      isAnchorPoint: !0
    })));
    var k = null;
    o === "up" ? k = [T - A, -A] : o === "left" ? k = [T, -A] : o === "right" && (k = [-T, -A]), k && (f ? !_ && _ !== void 0 ? (f.remove(), delete e.shapeMap["link-point-top"]) : f.attr(U(U({}, C), {
      x: k[0],
      y: k[1]
    })) : _ && (e.shapeMap["link-point-top"] = e.addShape("circle", {
      attrs: U(U({}, C), {
        x: k[0],
        y: k[1]
      }),
      className: "link-point-top",
      name: "link-point-top",
      isAnchorPoint: !0
    })));
    var L = null;
    o === "down" ? L = [-T + A, A] : o === "left" ? L = [T, A] : o === "right" && (L = [-T, A]), L && (l ? !w && w !== void 0 ? (l.remove(), delete e.shapeMap["link-point-bottom"]) : l.attr(U(U({}, C), {
      x: L[0],
      y: L[1]
    })) : w && (e.shapeMap["link-point-bottom"] = e.addShape("circle", {
      attrs: U(U({}, C), {
        x: L[0],
        y: L[1]
      }),
      className: "link-point-bottom",
      name: "link-point-bottom",
      isAnchorPoint: !0
    })));
  }
}, "single-node");
Io("modelRect", {
  options: {
    size: [185, 70],
    style: {
      radius: 5,
      stroke: "#69c0ff",
      fill: "#ffffff",
      lineWidth: dt.defaultNode.style.lineWidth,
      fillOpacity: 1
    },
    labelCfg: {
      style: {
        fill: "#595959",
        fontSize: 14,
        fontFamily: dt.windowFontFamily
      },
      offset: 30
    },
    descriptionCfg: {
      style: {
        fontSize: 12,
        fill: "#bfbfbf",
        fontFamily: dt.windowFontFamily
      },
      paddingTop: 0
    },
    preRect: {
      show: !0,
      width: 4,
      fill: "#40a9ff",
      radius: 2
    },
    linkPoints: {
      top: !1,
      right: !1,
      bottom: !1,
      left: !1,
      size: 10,
      lineWidth: 1,
      fill: "#72CC4A",
      stroke: "#72CC4A"
    },
    logoIcon: {
      show: !0,
      x: 0,
      y: 0,
      img: "https://gw.alipayobjects.com/zos/basement_prod/4f81893c-1806-4de4-aff3-9a6b266bc8a2.svg",
      width: 16,
      height: 16,
      offset: 0
    },
    stateIcon: {
      show: !0,
      x: 0,
      y: 0,
      img: "https://gw.alipayobjects.com/zos/basement_prod/300a2523-67e0-4cbf-9d4a-67c077b40395.svg",
      width: 16,
      height: 16,
      offset: -5
    },
    anchorPoints: [[0, 0.5], [1, 0.5]]
  },
  shapeType: "modelRect",
  drawShape: function(t, e) {
    var n = (this.mergeStyle || this.getOptions(t)).preRect, i = n === void 0 ? {} : n, a = this.getShapeStyle(t), o = this.getSize(t), s = o[0], u = o[1], f = e.addShape("rect", {
      attrs: a,
      className: "".concat(this.type, "-keyShape"),
      name: "".concat(this.type, "-keyShape"),
      draggable: !0
    });
    e.shapeMap["".concat(this.type, "-keyShape")] = f;
    var l = i.show, c = kn(i, ["show"]);
    return l && (e.shapeMap["pre-rect"] = e.addShape("rect", {
      attrs: U({
        x: -s / 2,
        y: -u / 2,
        height: u
      }, c),
      className: "pre-rect",
      name: "pre-rect",
      draggable: !0
    })), this.drawLogoIcon(t, e), this.drawStateIcon(t, e), this.drawLinkPoints(t, e), f;
  },
  drawLogoIcon: function(t, e) {
    var n = (this.mergeStyle || this.getOptions(t)).logoIcon, i = n === void 0 ? {} : n, a = this.getSize(t), o = a[0];
    if (i.show) {
      var s = i.width, u = i.height, f = i.x, l = i.y, c = i.offset, h = i.text, d = kn(i, ["width", "height", "x", "y", "offset", "text"]);
      h ? e.shapeMap["rect-logo-icon"] = e.addShape("text", {
        attrs: U({
          x: 0,
          y: 0,
          fontSize: 12,
          fill: "#000",
          stroke: "#000",
          textBaseline: "middle",
          textAlign: "center"
        }, d),
        className: "rect-logo-icon",
        name: "rect-logo-icon",
        draggable: !0
      }) : e.shapeMap["rect-logo-icon"] = e.addShape("image", {
        attrs: U(U({}, d), {
          x: f || -o / 2 + s + c,
          y: l || -u / 2,
          width: s,
          height: u
        }),
        className: "rect-logo-icon",
        name: "rect-logo-icon",
        draggable: !0
      });
    }
  },
  drawStateIcon: function(t, e) {
    var n = (this.mergeStyle || this.getOptions(t)).stateIcon, i = n === void 0 ? {} : n, a = this.getSize(t), o = a[0];
    if (i.show) {
      var s = i.width, u = i.height, f = i.x, l = i.y, c = i.offset, h = i.text, d = kn(i, ["width", "height", "x", "y", "offset", "text"]);
      h ? e.shapeMap["rect-state-icon"] = e.addShape("text", {
        attrs: U({
          x: 0,
          y: 0,
          fontSize: 12,
          fill: "#000",
          stroke: "#000",
          textBaseline: "middle",
          textAlign: "center"
        }, d),
        className: "rect-state-icon",
        name: "rect-state-icon",
        draggable: !0
      }) : e.shapeMap["rect-state-icon"] = e.addShape("image", {
        attrs: U(U({}, d), {
          x: f || o / 2 - s + c,
          y: l || -u / 2,
          width: s,
          height: u
        }),
        className: "rect-state-icon",
        name: "rect-state-icon",
        draggable: !0
      });
    }
  },
  drawLinkPoints: function(t, e) {
    var n = (this.mergeStyle || this.getOptions(t)).linkPoints, i = n === void 0 ? {} : n, a = i.top, o = i.left, s = i.right, u = i.bottom, f = i.size, l = i.r, c = kn(i, ["top", "left", "right", "bottom", "size", "r"]), h = this.getSize(t), d = h[0], v = h[1];
    o && (e.shapeMap["link-point-left"] = e.addShape("circle", {
      attrs: U(U({}, c), {
        x: -d / 2,
        y: 0,
        r: f / 2 || l || 5
      }),
      className: "link-point-left",
      name: "link-point-left",
      isAnchorPoint: !0
    })), s && (e.shapeMap["link-point-right"] = e.addShape("circle", {
      attrs: U(U({}, c), {
        x: d / 2,
        y: 0,
        r: f / 2 || l || 5
      }),
      className: "link-point-right",
      name: "link-point-right",
      isAnchorPoint: !0
    })), a && (e.shapeMap["link-point-top"] = e.addShape("circle", {
      attrs: U(U({}, c), {
        x: 0,
        y: -v / 2,
        r: f / 2 || l || 5
      }),
      className: "link-point-top",
      name: "link-point-top",
      isAnchorPoint: !0
    })), u && (e.shapeMap["link-point-bottom"] = e.addShape("circle", {
      attrs: U(U({}, c), {
        x: 0,
        y: v / 2,
        r: f / 2 || l || 5
      }),
      className: "link-point-bottom",
      name: "link-point-bottom",
      isAnchorPoint: !0
    }));
  },
  drawLabel: function(t, e) {
    var n = this.getOptions(t), i = n.labelCfg, a = i === void 0 ? {} : i, o = n.logoIcon, s = o === void 0 ? {} : o, u = n.descriptionCfg, f = u === void 0 ? {} : u, l = this.getSize(t), c = l[0], h = null, d = s.show, v = s.width, p = -c / 2 + a.offset;
    d && (p = -c / 2 + v + a.offset);
    var g = a.style, y = f.style, b = f.paddingTop;
    return Qe(t.description) ? (h = e.addShape("text", {
      attrs: U(U({}, g), {
        x: p,
        y: -5,
        text: t.label
      }),
      className: "text-shape",
      name: "text-shape",
      draggable: !0,
      labelRelated: !0
    }), e.shapeMap["text-shape"] = h, e.shapeMap["rect-description"] = e.addShape("text", {
      attrs: U(U({}, y), {
        x: p,
        y: 17 + (b || 0),
        text: t.description
      }),
      className: "rect-description",
      name: "rect-description",
      draggable: !0,
      labelRelated: !0
    })) : (h = e.addShape("text", {
      attrs: U(U({}, g), {
        x: p,
        y: 7,
        text: t.label
      }),
      className: "text-shape",
      name: "text-shape",
      draggable: !0,
      labelRelated: !0
    }), e.shapeMap["text-shape"] = h), h;
  },
  getShapeStyle: function(t) {
    var e = (this.mergeStyle || this.getOptions(t)).style, n = {
      stroke: t.color
    }, i = kt({}, e, n), a = this.getSize(t), o = i.width || a[0], s = i.height || a[1], u = U({
      x: -o / 2,
      y: -s / 2,
      width: o,
      height: s
    }, i);
    return u;
  },
  update: function(t, e) {
    var n = this.mergeStyle || this.getOptions(t), i = n.style, a = i === void 0 ? {} : i, o = n.labelCfg, s = o === void 0 ? {} : o, u = n.descriptionCfg, f = u === void 0 ? {} : u, l = this.getSize(t), c = l[0], h = l[1], d = e.get("keyShape");
    d.attr(U(U({}, a), {
      x: -c / 2,
      y: -h / 2,
      width: c,
      height: h
    }));
    var v = e.getContainer(), p = v.shapeMap["rect-logo-icon"] || v.find(function(Xe) {
      return Xe.get("className") === "rect-logo-icon";
    }), g = p ? p.attr() : {}, y = kt({}, g, t.logoIcon), b = y.width;
    b === void 0 && (b = this.options.logoIcon.width);
    var m = t.logoIcon ? t.logoIcon.show : void 0, x = s.offset, _ = -c / 2 + b + x;
    !m && m !== void 0 && (_ = -c / 2 + x);
    var w = v.shapeMap["node-label"] || v.find(function(Xe) {
      return Xe.get("className") === "node-label";
    }), E = v.shapeMap["rect-description"] || v.find(function(Xe) {
      return Xe.get("className") === "rect-description";
    });
    if (t.label)
      if (!w)
        v.shapeMap["node-label"] = v.addShape("text", {
          attrs: U(U({}, s.style), {
            x: _,
            y: t.description ? -5 : 7,
            text: t.label
          }),
          className: "node-label",
          name: "node-label",
          draggable: !0,
          labelRelated: !0
        });
      else {
        var M = t.labelCfg ? t.labelCfg.style : {}, C = kt({}, w.attr(), M);
        t.label && (C.text = t.label), C.x = _, Qe(t.description) && (C.y = -5), E && (E.resetMatrix(), E.attr({
          x: _
        })), w.resetMatrix(), w.attr(C);
      }
    if (Qe(t.description)) {
      var S = f.paddingTop;
      if (!E)
        v.shapeMap["rect-description"] = v.addShape("text", {
          attrs: U(U({}, f.style), {
            x: _,
            y: 17 + (S || 0),
            text: t.description
          }),
          className: "rect-description",
          name: "rect-description",
          draggable: !0,
          labelRelated: !0
        });
      else {
        var M = t.descriptionCfg ? t.descriptionCfg.style : {}, A = kt({}, E.attr(), M);
        Qe(t.description) && (A.text = t.description), A.x = _, E.resetMatrix(), E.attr(U(U({}, A), {
          y: 17 + (S || 0)
        }));
      }
    }
    var T = v.shapeMap["pre-rect"] || v.find(function(Xe) {
      return Xe.get("className") === "pre-rect";
    });
    if (T && !T.destroyed) {
      var P = kt({}, T.attr(), t.preRect);
      T.attr(U(U({}, P), {
        x: -c / 2,
        y: -h / 2,
        height: h
      }));
    }
    if (p && !p.destroyed)
      if (!m && m !== void 0)
        p.remove(), delete v.shapeMap["pre-rect"];
      else {
        var k = y.width, L = y.height, O = y.x, D = y.y, G = y.offset, R = kn(y, ["width", "height", "x", "y", "offset"]);
        p.attr(U(U({}, R), {
          x: O || -c / 2 + k + G,
          y: D || -L / 2,
          width: k,
          height: L
        }));
      }
    else
      m && this.drawLogoIcon(t, v);
    var F = v.shapeMap["rect-state-icon"] || v.find(function(Xe) {
      return Xe.get("className") === "rect-state-icon";
    }), q = F ? F.attr() : {}, ne = kt({}, q, t.stateIcon);
    if (F) {
      !ne.show && ne.show !== void 0 && (F.remove(), delete v.shapeMap["rect-state-icon"]);
      var oe = ne.width, L = ne.height, O = ne.x, D = ne.y, ie = ne.offset, Ee = kn(ne, ["width", "height", "x", "y", "offset"]);
      F.attr(U(U({}, Ee), {
        x: O || c / 2 - oe + ie,
        y: D || -L / 2,
        width: oe,
        height: L
      }));
    } else
      ne.show && this.drawStateIcon(t, v);
    this.updateLinkPoints(t, v);
  }
}, "single-node");
Io("star", {
  options: {
    size: 60,
    style: {
      stroke: dt.defaultNode.style.stroke,
      fill: dt.defaultNode.style.fill,
      lineWidth: dt.defaultNode.style.lineWidth
    },
    labelCfg: {
      style: {
        fill: dt.nodeLabel.style.fill,
        fontSize: dt.nodeLabel.style.fontSize,
        fontFamily: dt.windowFontFamily
      }
    },
    linkPoints: {
      top: !1,
      right: !1,
      bottom: !1,
      left: !1,
      size: dt.defaultNode.linkPoints.size,
      lineWidth: dt.defaultNode.linkPoints.lineWidth,
      fill: dt.defaultNode.linkPoints.fill,
      stroke: dt.defaultNode.linkPoints.stroke
    },
    icon: {
      show: !1,
      img: "https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",
      width: 20,
      height: 20
    },
    stateStyles: U({}, dt.nodeStateStyles)
  },
  shapeType: "star",
  labelPosition: "center",
  drawShape: function(t, e) {
    var n = (this.mergeStyle || this.getOptions(t)).icon, i = n === void 0 ? {} : n, a = this.getShapeStyle(t), o = e.addShape("path", {
      attrs: a,
      className: "".concat(this.type, "-keyShape"),
      name: "".concat(this.type, "-keyShape"),
      draggable: !0
    });
    e.shapeMap["".concat(this.type, "-keyShape")] = o;
    var s = i.width, u = i.height, f = i.show, l = i.text;
    return f && (l ? e.shapeMap["".concat(this.type, "-icon")] = e.addShape("text", {
      attrs: U({
        x: 0,
        y: 0,
        fontSize: 12,
        fill: "#000",
        stroke: "#000",
        textBaseline: "middle",
        textAlign: "center"
      }, i),
      className: "".concat(this.type, "-icon"),
      name: "".concat(this.type, "-icon"),
      draggable: !0
    }) : e.shapeMap["".concat(this.type, "-icon")] = e.addShape("image", {
      attrs: U({
        x: -s / 2,
        y: -u / 2
      }, i),
      className: "".concat(this.type, "-icon"),
      name: "".concat(this.type, "-icon"),
      draggable: !0
    })), this.drawLinkPoints(t, e), o;
  },
  drawLinkPoints: function(t, e) {
    var n = (this.mergeStyle || this.getOptions(t)).linkPoints, i = n === void 0 ? {} : n, a = i.top, o = i.left, s = i.right, u = i.leftBottom, f = i.rightBottom, l = i.size, c = i.r, h = kn(i, ["top", "left", "right", "leftBottom", "rightBottom", "size", "r"]), d = this.getSize(t), v = d[0];
    if (s) {
      var p = Math.cos(0.1 * Math.PI) * v, g = Math.sin((18 + 72 * 0) / 180 * Math.PI) * v;
      e.shapeMap["link-point-right"] = e.addShape("circle", {
        attrs: U(U({}, h), {
          x: p,
          y: -g,
          r: l / 2 || c || 5
        }),
        className: "link-point-right",
        name: "link-point-right"
      });
    }
    if (a) {
      var p = Math.cos(0.5 * Math.PI) * v, g = Math.sin((18 + 72 * 1) / 180 * Math.PI) * v;
      e.shapeMap["link-point-top"] = e.addShape("circle", {
        attrs: U(U({}, h), {
          x: p,
          y: -g,
          r: l / 2 || c || 5
        }),
        className: "link-point-top",
        name: "link-point-top"
      });
    }
    if (o) {
      var p = Math.cos(0.9 * Math.PI) * v, g = Math.sin((18 + 72 * 2) / 180 * Math.PI) * v;
      e.shapeMap["link-point-left"] = e.addShape("circle", {
        attrs: U(U({}, h), {
          x: p,
          y: -g,
          r: l / 2 || c || 5
        }),
        className: "link-point-left",
        name: "link-point-left"
      });
    }
    if (u) {
      var p = Math.cos(1.3 * Math.PI) * v, g = Math.sin((18 + 72 * 3) / 180 * Math.PI) * v;
      e.shapeMap["link-point-bottom"] = e.addShape("circle", {
        attrs: U(U({}, h), {
          x: p,
          y: -g,
          r: l / 2 || c || 5
        }),
        className: "link-point-left-bottom",
        name: "link-point-left-bottom"
      });
    }
    if (f) {
      var p = Math.cos(1.7 * Math.PI) * v, g = Math.sin((18 + 72 * 4) / 180 * Math.PI) * v;
      e.shapeMap["link-point-right-bottom"] = e.addShape("circle", {
        attrs: U(U({}, h), {
          x: p,
          y: -g,
          r: l / 2 || c || 5
        }),
        className: "link-point-right-bottom",
        name: "link-point-right-bottom"
      });
    }
  },
  getPath: function(t) {
    for (var e = this.getSize(t), n = e[0], i = n * 3 / 8, a = t.innerR || i, o = [], s = 0; s < 5; s++) {
      var u = Math.cos((18 + 72 * s) / 180 * Math.PI) * n, f = Math.sin((18 + 72 * s) / 180 * Math.PI) * n, l = Math.cos((54 + 72 * s) / 180 * Math.PI) * a, c = Math.sin((54 + 72 * s) / 180 * Math.PI) * a;
      s === 0 ? o.push(["M", u, -f]) : o.push(["L", u, -f]), o.push(["L", l, -c]);
    }
    return o.push(["Z"]), o;
  },
  getShapeStyle: function(t) {
    var e = (this.mergeStyle || this.getOptions(t)).style, n = {
      stroke: t.color
    }, i = kt({}, e, n), a = this.getPath(t), o = U({
      path: a
    }, i);
    return o;
  },
  update: function(t, e, n) {
    var i = e.getContainer(), a = this.getOptions({}).style, o = this.getPath(t), s = {
      stroke: t.color,
      path: o
    }, u = e.get("keyShape"), f = kt({}, a, u.attr(), s);
    f = kt(f, t.style), this.updateShape(t, e, f, !0, n), this.updateLinkPoints(t, i);
  },
  updateLinkPoints: function(t, e) {
    var n = this.getOptions({}).linkPoints, i = e.shapeMap["link-point-left"] || e.find(function(A) {
      return A.get("className") === "link-point-left";
    }), a = e.shapeMap["link-point-right"] || e.find(function(A) {
      return A.get("className") === "link-point-right";
    }), o = e.shapeMap["link-point-top"] || e.find(function(A) {
      return A.get("className") === "link-point-top";
    }), s = e.shapeMap["link-point-left-bottom"] || e.find(function(A) {
      return A.get("className") === "link-point-left-bottom";
    }), u = e.shapeMap["link-point-left-bottom"] || e.find(function(A) {
      return A.get("className") === "link-point-right-bottom";
    }), f = n, l = i || a || o || s || u;
    l && (f = l.attr());
    var c = kt({}, f, t.linkPoints), h = c.fill, d = c.stroke, v = c.lineWidth, p = c.size / 2;
    p || (p = c.r);
    var g = t.linkPoints ? t.linkPoints : {
      left: void 0,
      right: void 0,
      top: void 0,
      leftBottom: void 0,
      rightBottom: void 0
    }, y = g.left, b = g.right, m = g.top, x = g.leftBottom, _ = g.rightBottom, w = this.getSize(t), E = w[0], M = {
      r: p,
      fill: h,
      stroke: d,
      lineWidth: v
    }, C = Math.cos((18 + 72 * 0) / 180 * Math.PI) * E, S = Math.sin((18 + 72 * 0) / 180 * Math.PI) * E;
    a ? !b && b !== void 0 ? (a.remove(), delete e.shapeMap["link-point-right"]) : a.attr(U(U({}, M), {
      x: C,
      y: -S
    })) : b && (e.shapeMap["link-point-right"] = e.addShape("circle", {
      attrs: U(U({}, M), {
        x: C,
        y: -S
      }),
      className: "link-point-right",
      name: "link-point-right",
      isAnchorPoint: !0
    })), C = Math.cos((18 + 72 * 1) / 180 * Math.PI) * E, S = Math.sin((18 + 72 * 1) / 180 * Math.PI) * E, o ? !m && m !== void 0 ? (o.remove(), delete e.shapeMap["link-point-top"]) : o.attr(U(U({}, M), {
      x: C,
      y: -S
    })) : m && (e.shapeMap["link-point-top"] = e.addShape("circle", {
      attrs: U(U({}, M), {
        x: C,
        y: -S
      }),
      className: "link-point-top",
      name: "link-point-top",
      isAnchorPoint: !0
    })), C = Math.cos((18 + 72 * 2) / 180 * Math.PI) * E, S = Math.sin((18 + 72 * 2) / 180 * Math.PI) * E, i ? !y && y !== void 0 ? (i.remove(), delete e.shapeMap["link-point-left"]) : i.attr(U(U({}, M), {
      x: C,
      y: -S
    })) : y && (e.shapeMap["link-point-left"] = e.addShape("circle", {
      attrs: U(U({}, M), {
        x: C,
        y: -S
      }),
      className: "link-point-left",
      name: "link-point-left",
      isAnchorPoint: !0
    })), C = Math.cos((18 + 72 * 3) / 180 * Math.PI) * E, S = Math.sin((18 + 72 * 3) / 180 * Math.PI) * E, s ? !x && x !== void 0 ? (s.remove(), delete e.shapeMap["link-point-left-bottom"]) : s.attr(U(U({}, M), {
      x: C,
      y: -S
    })) : x && (e.shapeMap["link-point-left-bottom"] = e.addShape("circle", {
      attrs: U(U({}, M), {
        x: C,
        y: -S
      }),
      className: "link-point-left-bottom",
      name: "link-point-left-bottom",
      isAnchorPoint: !0
    })), C = Math.cos((18 + 72 * 4) / 180 * Math.PI) * E, S = Math.sin((18 + 72 * 4) / 180 * Math.PI) * E, u ? !_ && _ !== void 0 ? (u.remove(), delete e.shapeMap["link-point-right-bottom"]) : u.attr(U(U({}, M), {
      x: C,
      y: -S
    })) : _ && (e.shapeMap["link-point-right-bottom"] = e.addShape("circle", {
      attrs: U(U({}, M), {
        x: C,
        y: -S
      }),
      className: "link-point-right-bottom",
      name: "link-point-right-bottom",
      isAnchorPoint: !0
    }));
  }
}, "single-node");
var Jl = ci.defaultSubjectColors;
Io("donut", {
  options: {
    size: dt.defaultNode.size,
    style: {
      x: 0,
      y: 0,
      stroke: dt.defaultNode.style.stroke,
      fill: dt.defaultNode.style.fill,
      lineWidth: dt.defaultNode.style.lineWidth
    },
    labelCfg: {
      style: {
        fill: dt.nodeLabel.style.fill,
        fontSize: dt.nodeLabel.style.fontSize,
        fontFamily: dt.windowFontFamily
      }
    },
    linkPoints: {
      top: !1,
      right: !1,
      bottom: !1,
      left: !1,
      size: dt.defaultNode.linkPoints.size,
      lineWidth: dt.defaultNode.linkPoints.lineWidth,
      fill: dt.defaultNode.linkPoints.fill,
      stroke: dt.defaultNode.linkPoints.stroke
    },
    icon: {
      show: !1,
      img: "https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg",
      width: 20,
      height: 20
    },
    stateStyles: U({}, dt.nodeStateStyles)
  },
  shapeType: "circle",
  labelPosition: "center",
  drawShape: function(t, e) {
    var n = (this.mergeStyle || this.getOptions(t)).icon, i = n === void 0 ? {} : n, a = this.getShapeStyle(t), o = kr({}, i, t.icon), s = e.addShape("circle", {
      attrs: a,
      className: "".concat(this.type, "-keyShape"),
      draggable: !0,
      name: "".concat(this.type, "-keyShape")
    });
    e.shapeMap["".concat(this.type, "-keyShape")] = s;
    var u = o.width, f = o.height, l = o.show, c = o.text;
    l && (c ? e.shapeMap["".concat(this.type, "-icon")] = e.addShape("text", {
      attrs: U({
        x: 0,
        y: 0,
        fontSize: 12,
        fill: "#000",
        stroke: "#000",
        textBaseline: "middle",
        textAlign: "center"
      }, o),
      className: "".concat(this.type, "-icon"),
      name: "".concat(this.type, "-icon"),
      draggable: !0
    }) : e.shapeMap["".concat(this.type, "-icon")] = e.addShape("image", {
      attrs: U({
        x: -u / 2,
        y: -f / 2
      }, o),
      className: "".concat(this.type, "-icon"),
      name: "".concat(this.type, "-icon"),
      draggable: !0
    }));
    var h = s.attr("r"), d = 0.6 * h, v = (h + d) / 2, p = t, g = p.donutAttrs, y = g === void 0 ? {} : g, b = p.donutColorMap, m = b === void 0 ? {} : b, x = Object.keys(y).length;
    if (y && x > 1) {
      var _ = [], w = 0;
      if (Object.keys(y).forEach(function(S) {
        var A = y[S] || 0;
        !At(A) || (_.push({
          key: S,
          value: A,
          color: m[S]
        }), w += A);
      }), w) {
        var E = h - d;
        if (x === 1) {
          e.shapeMap["fan-shape-0"] = e.addShape("circle", {
            attrs: {
              r: v,
              x: 0,
              y: 0,
              stroke: _[0].color || Jl[0],
              lineWidth: E
            },
            name: "fan-shape-0",
            draggable: !0
          });
          return;
        }
        var M = [v, 0], C = 0;
        _.forEach(function(S, A) {
          var T = S.value / w;
          if (!(T < 1e-3)) {
            if (T > 0.999 && (T = 1), T === 1) {
              e.shapeMap["fan-shape-".concat(A)] = e.addShape("circle", {
                attrs: {
                  r: v,
                  x: 0,
                  y: 0,
                  stroke: S.color || Jl[A % Jl.length],
                  lineWidth: E
                },
                name: "fan-shape-".concat(A),
                draggable: !0
              });
              return;
            }
            S.percent = T, S.angle = T * Math.PI * 2, S.beginAgnle = C, C += S.angle, S.endAngle = C, S.arcBegin = M, S.arcEnd = [v * Math.cos(S.endAngle), -v * Math.sin(S.endAngle)];
            var P = S.angle > Math.PI ? 1 : 0, k = [["M", S.arcBegin[0], S.arcBegin[1]], ["A", v, v, 0, P, 0, S.arcEnd[0], S.arcEnd[1]], ["L", S.arcEnd[0], S.arcEnd[1]]];
            e.shapeMap["fan-shape-".concat(A)] = e.addShape("path", {
              attrs: {
                path: k,
                lineWidth: E,
                stroke: S.color || Jl[A % Jl.length]
              },
              name: "fan-shape-".concat(A),
              draggable: !0
            }), M = S.arcEnd;
          }
        });
      }
    }
    return this.drawLinkPoints(t, e), s;
  },
  update: void 0
}, "circle");
var av = function(t) {
  var e = t.x, n = t.y;
  return {
    x: e,
    y: n,
    centerX: e,
    centerY: n,
    minX: e,
    minY: n,
    maxX: e,
    maxY: n,
    height: 0,
    width: 0
  };
}, nme = function(t) {
  t === void 0 && (t = []);
  var e = [], n = [];
  t.forEach(function(u) {
    e.push(u.x), n.push(u.y);
  });
  var i = Math.min.apply(Math, e), a = Math.max.apply(Math, e), o = Math.min.apply(Math, n), s = Math.max.apply(Math, n);
  return {
    centerX: (i + a) / 2,
    centerY: (o + s) / 2,
    maxX: a,
    maxY: s,
    minX: i,
    minY: o,
    height: s - o,
    width: a - i
  };
}, l_ = function(t) {
  for (var e = [], n = {}, i = t.length, a = i - 1; a >= 0; a--) {
    var o = t[a];
    o.id = "".concat(o.x, "|||").concat(o.y), n[o.id] = o, e.push(o);
  }
  return e;
}, S4 = function(t) {
  return l_(t);
}, Tp = function(t, e) {
  return t.width || t.height ? {
    centerX: t.centerX,
    centerY: t.centerY,
    minX: t.minX - e,
    minY: t.minY - e,
    maxX: t.maxX + e,
    maxY: t.maxY + e,
    height: t.height + 2 * e,
    width: t.width + 2 * e
  } : t;
}, ime = function(t, e) {
  var n = Math.abs(t.x - e.centerX), i = Math.abs(t.y - e.centerY);
  return n === 0 && i === 0 ? 0 : n / e.width > i / e.height;
}, N1 = function(t, e, n) {
  var i = ime(e, t);
  if (i === 0) {
    var a = t.centerX, o = t.centerY;
    return n.y < e.y ? o = t.minY : n.x > e.x ? a = t.maxX : n.x < e.x ? a = t.minX : n.x === e.x && (o = t.maxY), {
      x: a,
      y: o
    };
  }
  return i ? {
    x: e.x > t.centerX ? t.maxX : t.minX,
    y: e.y
  } : {
    x: e.x,
    y: e.y > t.centerY ? t.maxY : t.minY
  };
}, eD = function(t, e) {
  var n = Math.min(t.minX, e.minX), i = Math.min(t.minY, e.minY), a = Math.max(t.maxX, e.maxX), o = Math.max(t.maxY, e.maxY);
  return {
    centerX: (n + a) / 2,
    centerY: (i + o) / 2,
    minX: n,
    minY: i,
    maxX: a,
    maxY: o,
    height: o - i,
    width: a - n
  };
}, R1 = function(t) {
  return [{
    x: t.minX,
    y: t.minY
  }, {
    x: t.maxX,
    y: t.minY
  }, {
    x: t.maxX,
    y: t.maxY
  }, {
    x: t.minX,
    y: t.maxY
  }];
}, ov = function(t, e) {
  var n = t.x, i = t.y;
  return n < e.minX || n > e.maxX || i < e.minY || i > e.maxY;
}, ame = function(t, e) {
  return e < t.minX || e > t.maxX ? [] : [{
    x: e,
    y: t.minY
  }, {
    x: e,
    y: t.maxY
  }];
}, ome = function(t, e) {
  return e < t.minY || e > t.maxY ? [] : [{
    x: t.minX,
    y: e
  }, {
    x: t.maxX,
    y: e
  }];
}, sme = function(t, e) {
  return ame(t, e.x).concat(ome(t, e.y));
}, Qc = function(t, e) {
  return Math.abs(t.x - e.x) + Math.abs(t.y - e.y);
}, ume = function(t, e) {
  var n = -2, i = 0;
  return e.forEach(function(a) {
    a && (t.x === a.x && (i += n), t.y === a.y && (i += n));
  }), i;
}, tD = function(t, e, n, i, a) {
  return Qc(t, e) + Qc(t, n) + ume(t, [e, n, i, a]);
}, fme = function r(t, e, n, i, a) {
  a === void 0 && (a = 0), t.unshift(e[i]), n[i] && n[i] !== i && a <= 100 && r(t, e, n, n[i], a + 1);
}, lme = function(t, e) {
  var n = t.indexOf(e);
  n > -1 && t.splice(n, 1);
}, sv = function(t, e, n, i) {
  var a = n.x - t.x, o = n.y - t.y, s = i.x - t.x, u = i.y - t.y, f = n.x - e.x, l = n.y - e.y, c = i.x - e.x, h = i.y - e.y, d = a * u - o * s, v = f * h - l * c, p = a * l - o * f, g = s * h - u * c;
  return d * v <= 0 && p * g <= 0;
}, B1 = function(t, e, n) {
  if (n.width || n.height) {
    var i = R1(n), a = i[0], o = i[1], s = i[2], u = i[3];
    return sv(t, e, a, o) || sv(t, e, a, u) || sv(t, e, o, s) || sv(t, e, s, u);
  }
  return !1;
}, cme = function(t, e, n, i) {
  var a = [];
  return t.forEach(function(o) {
    if (o !== e && (o.x === e.x || o.y === e.y)) {
      if (B1(o, e, n) || B1(o, e, i))
        return;
      a.push(o);
    }
  }), l_(a);
}, hme = function(t, e, n, i, a, o, s) {
  var u = [], f = [e], l = {}, c = {}, h = {};
  c[e.id] = 0, h[e.id] = tD(e, n, e);
  var d = {};
  t.forEach(function(y) {
    d[y.id] = y;
  });
  for (var v, p; f.length; ) {
    if (v = void 0, p = 1 / 0, f.forEach(function(y) {
      h[y.id] <= p && (p = h[y.id], v = y);
    }), v === n) {
      var g = [];
      return fme(g, d, l, n.id), g;
    }
    lme(f, v), u.push(v), cme(t, v, i, a).forEach(function(y) {
      if (u.indexOf(y) === -1) {
        f.indexOf(y) === -1 && f.push(y);
        var b = h[v.id] + Qc(v, y);
        c[y.id] && b >= c[y.id] || (l[y.id] = v.id, c[y.id] = b, h[y.id] = c[y.id] + tD(y, n, e, o, s));
      }
    });
  }
  return [e, n];
}, dme = function(t, e, n) {
  return !(t.x === e.x && e.x === n.x || t.y === e.y && e.y === n.y);
}, vme = function(t, e, n, i) {
  var a = Qc(t, e), o = Qc(n, e);
  a < i && (i = a), o < i && (i = o);
  var s = {
    x: e.x - i / a * (e.x - t.x),
    y: e.y - i / a * (e.y - t.y)
  }, u = {
    x: e.x - i / o * (e.x - n.x),
    y: e.y - i / o * (e.y - n.y)
  };
  return [s, u];
}, rD = function(t, e) {
  var n = [], i = t[0];
  return n.push("M".concat(i.x, " ").concat(i.y)), t.forEach(function(a, o) {
    var s = t[o + 1], u = t[o + 2];
    if (s && u)
      if (dme(a, s, u)) {
        var f = vme(a, s, u, e), l = f[0], c = f[1];
        n.push("L".concat(l.x, " ").concat(l.y)), n.push("Q".concat(s.x, " ").concat(s.y, " ").concat(c.x, " ").concat(c.y)), n.push("L".concat(c.x, " ").concat(c.y));
      } else
        n.push("L".concat(s.x, " ").concat(s.y));
    else
      s && n.push("L".concat(s.x, " ").concat(s.y));
  }), n.join("");
}, M4 = function(t, e, n, i, a) {
  var o, s;
  if (!n || !n.getType())
    o = av(t);
  else if (n.getType() === "combo") {
    var u = n.getKeyShape().getBBox();
    if (u) {
      var f = n.getModel(), l = f.x, c = f.y;
      o = {
        x: l,
        y: c,
        width: u.width,
        height: u.height,
        minX: u.minX + l,
        maxX: u.maxX + l,
        minY: u.minY + c,
        maxY: u.maxY + c
      }, o.centerX = (o.minX + o.maxX) / 2, o.centerY = (o.minY + o.maxY) / 2;
    } else
      o = av(t);
  } else
    o = n && n.getBBox();
  if (!i || !i.getType())
    s = av(e);
  else if (i.getType() === "combo") {
    var h = i.getKeyShape().getBBox();
    if (h) {
      var d = i.getModel(), v = d.x, p = d.y;
      s = {
        x: v,
        y: p,
        width: h.width,
        height: h.height,
        minX: h.minX + v,
        maxX: h.maxX + v,
        minY: h.minY + p,
        maxY: h.maxY + p
      }, s.centerX = (s.minX + s.maxX) / 2, s.centerY = (s.minY + s.maxY) / 2;
    } else
      s = av(e);
  } else
    s = i && i.getBBox();
  var g = Tp(o, a), y = Tp(s, a), b = N1(g, t, e), m = N1(y, e, t), x = nme([b, m]), _ = eD(g, x), w = eD(y, x), E = [];
  E = E.concat(R1(_)).concat(R1(w));
  var M = {
    x: (t.x + e.x) / 2,
    y: (t.y + e.y) / 2
  };
  [x, _, w].forEach(function(S) {
    E = E.concat(sme(S, M).filter(function(A) {
      return ov(A, g) && ov(A, y);
    }));
  }), [{
    x: b.x,
    y: m.y
  }, {
    x: m.x,
    y: b.y
  }].forEach(function(S) {
    ov(S, g) && ov(S, y) && E.push(S);
  }), E.unshift(b), E.push(m), E = l_(E);
  var C = hme(E, b, m, o, s, t, e);
  return C.unshift(t), C.push(e), S4(C);
}, pme = function(t, e) {
  return Math.abs(t.x - e.x) + Math.abs(t.y - e.y);
}, gme = function(t, e, n, i, a) {
  return S4(M4(t, e, n, i, a.offset));
}, yme = {
  offset: 20,
  maxAllowedDirectionChange: Math.PI / 2,
  maximumLoops: 2e3,
  gridSize: 10,
  directions: [
    {
      stepX: 1,
      stepY: 0
    },
    {
      stepX: -1,
      stepY: 0
    },
    {
      stepX: 0,
      stepY: 1
    },
    {
      stepX: 0,
      stepY: -1
    }
  ],
  get penalties() {
    return {
      0: 0,
      45: this.gridSize / 2,
      90: this.gridSize / 2
    };
  },
  distFunc: pme,
  fallbackRoute: gme
}, _o = function(t, e) {
  var n = Math.round(Math.abs(t / e)), i = t < 0 ? -1 : 1;
  return n < 0 ? 0 : i * n;
}, mme = function(t, e, n) {
  var i = {};
  return t.forEach(function(a) {
    if (!!a)
      for (var o = Tp(a.getBBox(), n), s = _o(o.minX, e); s <= _o(o.maxX, e); s += 1)
        for (var u = _o(o.minY, e); u <= _o(o.maxY, e); u += 1)
          i["".concat(s, "|||").concat(u)] = !0;
  }), i;
}, Xy = function(t, e) {
  var n = e.x - t.x, i = e.y - t.y;
  return n || i ? Math.atan2(i, n) : 0;
}, nD = function(t, e) {
  var n = Math.abs(t - e);
  return n > Math.PI ? 2 * Math.PI - n : n;
}, iD = function(t, e, n) {
  for (var i = 1 / 0, a = 0, o = e.length; a < o; a++) {
    var s = n(t, e[a]);
    s < i && (i = s);
  }
  return i;
}, aD = function(t, e, n, i, a) {
  var o = [];
  if (!n)
    return [t];
  var s = a.directions, u = a.offset, f = n.getBBox(), l = e.x > f.minX && e.x < f.maxX && e.y > f.minY && e.y < f.maxY, c = Tp(f, u);
  for (var h in c)
    c[h] = _o(c[h], a.gridSize);
  if (l) {
    for (var d = 0, v = s; d < v.length; d++)
      for (var p = v[d], g = [[{
        x: c.minX,
        y: c.minY
      }, {
        x: c.maxX,
        y: c.minY
      }], [{
        x: c.minX,
        y: c.minY
      }, {
        x: c.minX,
        y: c.maxY
      }], [{
        x: c.maxX,
        y: c.minY
      }, {
        x: c.maxX,
        y: c.maxY
      }], [{
        x: c.minX,
        y: c.maxY
      }, {
        x: c.maxX,
        y: c.maxY
      }]], h = 0; h < 4; h++) {
        var y = g[h], b = ci.getLineIntersect(t, {
          x: t.x + p.stepX * c.width,
          y: t.y + p.stepY * c.height
        }, y[0], y[1]);
        b && !B1(t, b, f) && (b.id = "".concat(b.x, "|||").concat(b.y), o.push(b));
      }
    return o;
  }
  var m = N1(c, t, i);
  return m.id = "".concat(m.x, "|||").concat(m.y), [m];
}, G1 = function(t, e, n, i) {
  var a = Xy(t, e);
  if (!n[t.id]) {
    var o = Xy(i, t);
    return nD(o, a);
  }
  var s = Xy({
    x: n[t.id].x,
    y: n[t.id].y
  }, t);
  return nD(s, a);
}, bme = function(t, e, n, i, a, o, s) {
  var u = [i], f = t.id, l = t.x, c = t.y, h = {
    x: l,
    y: c,
    id: f
  };
  for (G1(h, o, e, n) && u.unshift({
    x: o.x === i.x ? i.x : h.x * s,
    y: o.y === i.y ? i.y : h.y * s
  }); e[f] && e[f].id !== f; ) {
    var d = {
      x: l,
      y: c,
      id: f
    }, v = e[f].id, p = e[f].x, g = e[f].y, y = {
      x: p,
      y: g,
      id: v
    }, b = G1(y, d, e, n);
    b && u.unshift({
      x: y.x === d.x ? u[0].x : y.x * s,
      y: y.y === d.y ? u[0].y : y.y * s
    }), f = v, l = p, c = g;
  }
  var m = {
    x: l,
    y: c,
    id: f
  };
  return u[0].x = m.x === n.x ? a.x : u[0].x, u[0].y = m.y === n.y ? a.y : u[0].y, u.unshift(a), u;
}, xme = function(t, e, n, i, a) {
  if (isNaN(t.x) || isNaN(e.x))
    return [];
  var o = kr(yme, a);
  o.obstacles = o.obstacles || [];
  var s = o.gridSize, u = mme(o.obstacles.concat([n, i]), s, o.offset), f = {
    x: _o(t.x, s),
    y: _o(t.y, s)
  }, l = {
    x: _o(e.x, s),
    y: _o(e.y, s)
  };
  t.id = "".concat(f.x, "|||").concat(f.y), e.id = "".concat(l.x, "|||").concat(l.y);
  var c = aD(f, t, n, l, o), h = aD(l, e, i, f, o);
  c.forEach(function(P) {
    delete u[P.id];
  }), h.forEach(function(P) {
    delete u[P.id];
  });
  for (var d = {}, v = {}, p = {}, g = {}, y = {}, b = 0; b < c.length; b++) {
    var m = c[b];
    d[m.id] = m, g[m.id] = 0, y[m.id] = iD(m, h, o.distFunc);
  }
  for (var x = o.maximumLoops, _ = o.penalties, w, E, M, C, S, A, T; Object.keys(d).length > 0 && x > 0 && (w = void 0, E = 1 / 0, Object.keys(d).forEach(function(P) {
    var k = d[P].id;
    y[k] <= E && (E = y[k], w = d[k]);
  }), !!w); ) {
    if (h.findIndex(function(P) {
      return P.x === w.x && P.y === w.y;
    }) > -1)
      return bme(w, p, f, e, t, l, s);
    delete d[w.id], v[w.id] = !0;
    for (var b = 0; b < o.directions.length; b++)
      M = o.directions[b], C = {
        x: w.x + M.stepX,
        y: w.y + M.stepY,
        id: "".concat(Math.round(w.x) + M.stepX, "|||").concat(Math.round(w.y) + M.stepY)
      }, !v[C.id] && (T = G1(w, C, p, f), !(T > o.maxAllowedDirectionChange) && (u[C.id] || (d[C.id] || (d[C.id] = C), S = o.distFunc(w, C) + (isNaN(_[T]) ? s : _[T]), A = g[w.id] + S, !(g[C.id] && A >= g[C.id]) && (p[C.id] = w, g[C.id] = A, y[C.id] = A + iD(C, h, o.distFunc)))));
    x -= 1;
  }
  return o.fallbackRoute(t, e, n, i, o);
};
KN("polyline", {
  options: {
    color: dt.defaultEdge.color,
    size: dt.defaultEdge.size,
    style: {
      radius: 0,
      offset: 15,
      x: 0,
      y: 0,
      stroke: dt.defaultEdge.style.stroke,
      lineAppendWidth: dt.defaultEdge.style.lineAppendWidth
    },
    labelCfg: {
      style: {
        fill: dt.edgeLabel.style.fill,
        fontSize: dt.edgeLabel.style.fontSize,
        fontFamily: dt.windowFontFamily
      }
    },
    routeCfg: {
      obstacles: [],
      maxAllowedDirectionChange: Math.PI,
      maximumLoops: 500,
      gridSize: 10
    },
    stateStyles: U({}, dt.edgeStateStyles)
  },
  shapeType: "polyline",
  labelPosition: "center",
  drawShape: function(t, e) {
    var n = this.getShapeStyle(t);
    n.radius === 0 && delete n.radius;
    var i = e.addShape("path", {
      className: "edge-shape",
      name: "edge-shape",
      attrs: n
    });
    return e.shapeMap["edge-shape"] = i, i;
  },
  getShapeStyle: function(t) {
    var e = this.options.style, n = {
      stroke: t.color
    }, i = kt({}, e, n, t.style);
    t = this.getPathPoints(t), this.radius = i.radius, this.offset = i.offset;
    var a = t.startPoint, o = t.endPoint, s = this.getControlPoints(t), u = [a];
    s && (u = u.concat(s)), u.push(o);
    var f = t.sourceNode, l = t.targetNode, c = i.radius, h = this.options.routeCfg, d = kt({}, h, t.routeCfg);
    d.offset = i.offset;
    var v = this.getPath(u, f, l, c, d);
    (Dt(v) && v.length <= 1 || Qe(v) && v.indexOf("L") === -1) && (v = "M0 0, L0 0"), (isNaN(a.x) || isNaN(a.y) || isNaN(o.x) || isNaN(o.y)) && (v = "M0 0, L0 0");
    var p = kt({}, dt.defaultEdge.style, i, {
      lineWidth: t.size,
      path: v
    });
    return p;
  },
  updateShapeStyle: function(t, e) {
    var n = e.getContainer();
    if (!!e.isVisible()) {
      var i = {
        stroke: t.color
      }, a = n.shapeMap["edge-shape"] || n.find(function(x) {
        return x.get("className") === "edge-shape";
      }) || e.getKeyShape(), o = t.size;
      t = this.getPathPoints(t);
      var s = t.startPoint, u = t.endPoint, f = this.getControlPoints(t), l = [s];
      f && (l = l.concat(f)), l.push(u);
      var c = a.attr(), h = kt({}, i, c, t.style), d = t.sourceNode, v = t.targetNode, p = h.radius, g = this.options.routeCfg, y = kt({}, g, t.routeCfg);
      y.offset = h.offset;
      var b = this.getPath(l, d, v, p, y);
      (Dt(b) && b.length <= 1 || Qe(b) && b.indexOf("L") === -1) && (b = "M0 0, L0 0"), (isNaN(s.x) || isNaN(s.y) || isNaN(u.x) || isNaN(u.y)) && (b = "M0 0, L0 0"), c.endArrow && h.endArrow === !1 && (t.style.endArrow = {
        path: ""
      }), c.startArrow && h.startArrow === !1 && (t.style.startArrow = {
        path: ""
      });
      var m = kt(i, a.attr(), {
        lineWidth: o,
        path: b
      }, t.style);
      a && a.attr(m);
    }
  },
  getPath: function(t, e, n, i, a) {
    var o = a.offset, s = a.simple;
    if (!o || t.length > 2) {
      if (i)
        return rD(t, i);
      var u = [];
      return Se(t, function(h, d) {
        d === 0 ? u.push(["M", h.x, h.y]) : u.push(["L", h.x, h.y]);
      }), u;
    }
    var f = s ? M4(t[t.length - 1], t[0], n, e, o) : xme(t[0], t[t.length - 1], e, n, a);
    if (!f || !f.length)
      return "M0 0, L0 0";
    if (i) {
      var l = rD(f, i);
      return l;
    }
    var c = ci.pointsToPolygon(f);
    return c;
  }
}, "single-edge");
var oD = No.cloneEvent, sD = No.isNaN, uD = Math.abs, _me = 10, wme = ["shift", "ctrl", "alt", "control"];
const Eme = {
  getDefaultCfg: function() {
    return {
      direction: "both",
      enableOptimize: !1,
      scalableRange: 0,
      allowDragOnItem: !1
    };
  },
  getEvents: function() {
    return {
      dragstart: "onMouseDown",
      drag: "onMouseMove",
      dragend: "onMouseUp",
      "canvas:click": "onMouseUp",
      keyup: "onKeyUp",
      focus: "onKeyUp",
      keydown: "onKeyDown",
      touchstart: "onTouchStart",
      touchmove: "onTouchMove",
      touchend: "onMouseUp"
    };
  },
  updateViewport: function(t) {
    var e = this.origin, n = +t.clientX, i = +t.clientY;
    if (!(sD(n) || sD(i))) {
      var a = n - e.x, o = i - e.y;
      this.get("direction") === "x" ? o = 0 : this.get("direction") === "y" && (a = 0), this.origin = {
        x: n,
        y: i
      };
      var s = this.graph.get("width"), u = this.graph.get("height"), f = this.graph.get("canvas").getCanvasBBox(), l = this.scalableRange, c = this.scalableRange;
      l < 1 && l > -1 && (l = s * l, c = u * c), (f.minX <= s + l && f.minX + a > s + l || f.maxX + l >= 0 && f.maxX + l + a < 0) && (a = 0), (f.minY <= u + c && f.minY + o > u + c || f.maxY + c >= 0 && f.maxY + c + o < 0) && (o = 0), this.graph.translate(a, o);
    }
  },
  onTouchStart: function(t) {
    var e = this, n = t.originalEvent.touches, i = n[0], a = n[1];
    i && a || (t.preventDefault(), e.onMouseDown(t));
  },
  onMouseDown: function(t) {
    var e = this, n = t.originalEvent;
    if (!(n && t.name !== "touchstart" && n.button !== 0) && !(t.name !== "touchstart" && typeof window < "u" && window.event && !window.event.buttons && !window.event.button) && !!this.shouldBegin.call(this, t) && !e.keydown) {
      var i = t.target, a = i && i.isCanvas && i.isCanvas();
      if (!(!this.allowDragOnItem && !a) && (e.origin = {
        x: t.clientX,
        y: t.clientY
      }, e.dragging = !1, this.enableOptimize)) {
        for (var o = this.graph, s = o.getEdges(), u = 0, f = s.length; u < f; u++) {
          var l = s[u].get("group").get("children");
          !l || l.forEach(function(x) {
            x.set("ori-visibility", x.get("ori-visibility") || x.get("visible")), x.hide();
          });
        }
        for (var c = o.getNodes(), h = 0, d = c.length; h < d; h++)
          for (var v = c[h].getContainer(), p = v.get("children"), g = 0, y = p; g < y.length; g++) {
            var b = y[g], m = b.get("isKeyShape");
            m || (b.set("ori-visibility", b.get("ori-visibility") || b.get("visible")), b.hide());
          }
      }
    }
  },
  onTouchMove: function(t) {
    var e = this, n = t.originalEvent.touches, i = n[0], a = n[1];
    if (i && a) {
      this.onMouseUp(t);
      return;
    }
    t.preventDefault(), e.onMouseMove(t);
  },
  onMouseMove: function(t) {
    var e = this.graph;
    if (!this.keydown) {
      var n = t.target, i = n && n.isCanvas && n.isCanvas();
      if (!(!this.allowDragOnItem && !i) && (t = oD(t), !!this.origin)) {
        if (this.dragging)
          t.type = "drag", e.emit("canvas:drag", t);
        else {
          if (uD(this.origin.x - t.clientX) + uD(this.origin.y - t.clientY) < _me)
            return;
          this.shouldBegin.call(this, t) && (t.type = "dragstart", e.emit("canvas:dragstart", t), this.originPosition = {
            x: t.clientX,
            y: t.clientY
          }, this.dragging = !0);
        }
        this.shouldUpdate.call(this, t) && this.updateViewport(t);
      }
    }
  },
  onMouseUp: function(t) {
    var e, n, i = this.graph;
    if (!this.keydown) {
      var a = i.getZoom(), o = i.get("modeController"), s = (n = (e = o == null ? void 0 : o.modes[o.mode]) === null || e === void 0 ? void 0 : e.filter(function(E) {
        return E.type === "zoom-canvas";
      })) === null || n === void 0 ? void 0 : n[0], u = s ? s.optimizeZoom || 0.1 : 0;
      if (this.enableOptimize) {
        for (var f = i.getEdges(), l = 0, c = f.length; l < c; l++) {
          var h = f[l].get("group").get("children");
          !h || h.forEach(function(E) {
            var M = E.get("ori-visibility");
            E.set("ori-visibility", void 0), M && E.show();
          });
        }
        if (a > u)
          for (var d = i.getNodes(), v = 0, p = d.length; v < p; v++)
            for (var g = d[v].getContainer(), y = g.get("children"), b = 0, m = y; b < m.length; b++) {
              var x = m[b], _ = x.get("isKeyShape");
              if (!_) {
                var w = x.get("ori-visibility");
                x.set("ori-visibility", void 0), w && x.show();
              }
            }
      }
      if (!this.dragging) {
        this.origin = null;
        return;
      }
      t = oD(t), this.shouldEnd.call(this, t) && this.updateViewport(t), t.type = "dragend", t.dx = t.clientX - this.originPosition.x, t.dy = t.clientY - this.originPosition.y, i.emit("canvas:dragend", t), this.endDrag();
    }
  },
  endDrag: function() {
    this.origin = null, this.dragging = !1, this.dragbegin = !1;
  },
  onKeyDown: function(t) {
    var e = this, n = t.key;
    !n || (wme.indexOf(n.toLowerCase()) > -1 ? e.keydown = !0 : e.keydown = !1);
  },
  onKeyUp: function() {
    this.keydown = !1, this.origin = null, this.dragging = !1, this.dragbegin = !1;
  }
}, Sme = {
  getDefaultCfg: function() {
    return {
      updateEdge: !0,
      delegateStyle: {},
      enableDelegate: !1,
      onlyChangeComboSize: !1,
      comboActiveState: "",
      selectedState: "selected",
      enableOptimize: !1,
      enableDebounce: !1,
      enableStack: !0
    };
  },
  getEvents: function() {
    return {
      "node:dragstart": "onDragStart",
      "node:drag": "onDrag",
      "node:dragend": "onDragEnd",
      "combo:dragenter": "onDragEnter",
      "combo:dragleave": "onDragLeave",
      "combo:drop": "onDropCombo",
      "node:drop": "onDropNode",
      "canvas:drop": "onDropCanvas",
      touchstart: "onTouchStart",
      touchmove: "onTouchMove",
      touchend: "onDragEnd"
    };
  },
  validationCombo: function(t) {
    if (!this.origin || !t || t.destroyed)
      return !1;
    var e = t.getType();
    return e === "combo";
  },
  onTouchStart: function(t) {
    if (!!t.item) {
      var e = this;
      try {
        var n = t.originalEvent.touches, i = n[0], a = n[1];
        if (i && a)
          return;
        t.preventDefault();
      } catch {
        console.warn("Touch original event not exist!");
      }
      e.onDragStart(t);
    }
  },
  onTouchMove: function(t) {
    var e = this;
    try {
      var n = t.originalEvent.touches, i = n[0], a = n[1];
      if (i && a) {
        e.onDragEnd(t);
        return;
      }
      t.preventDefault();
    } catch {
      console.warn("Touch original event not exist!");
    }
    e.onDrag(t);
  },
  onDragStart: function(t) {
    var e = this;
    if (this.currentShouldEnd = !0, !!this.shouldBegin.call(this, t)) {
      var n = t.item;
      if (!(!n || n.destroyed || n.hasLocked())) {
        var i = n.getContainer();
        i.set("capture", !1), this.cachedCaptureItems || (this.cachedCaptureItems = []), this.cachedCaptureItems.push(n);
        var a = t.target;
        if (a) {
          var o = a.get("isAnchorPoint");
          if (o)
            return;
        }
        var s = this.graph;
        this.targets = [], this.targetCombo = null;
        var u = s.findAllByState("node", this.selectedState), f = n.get("id"), l = u.filter(function(h) {
          var d = h.get("id");
          return f === d;
        });
        if (l.length === 0 ? this.targets.push(n) : u.length > 1 ? u.forEach(function(h) {
          var d = h.hasLocked();
          d || e.targets.push(h);
        }) : this.targets.push(n), this.graph.get("enabledStack") && this.enableStack) {
          var c = [];
          this.targets.forEach(function(h) {
            var d = h.getModel(), v = d.x, p = d.y, g = d.id;
            c.push({
              x: v,
              y: p,
              id: g
            });
          }), this.set("beforeDragNodes", c);
        }
        this.hidenEdge = {}, this.get("updateEdge") && this.enableOptimize && !this.enableDelegate && this.targets.forEach(function(h) {
          var d = h.getEdges();
          d.forEach(function(v) {
            !v.isVisible() || (e.hidenEdge[v.getID()] = !0, v.hide());
          });
        }), this.origin = {
          x: t.x,
          y: t.y
        }, this.point = {}, this.originPoint = {};
      }
    }
  },
  onDrag: function(t) {
    var e = this;
    !this.origin || !this.shouldUpdate.call(this, t) || (this.get("enableDelegate") ? this.updateDelegate(t) : this.enableDebounce ? this.debounceUpdate({
      targets: this.targets,
      graph: this.graph,
      point: this.point,
      origin: this.origin,
      evt: t,
      updateEdge: this.get("updateEdge")
    }) : this.targets.map(function(n) {
      e.update(n, t);
    }));
  },
  onDragEnd: function(t) {
    var e = this, n;
    if (!!this.origin) {
      (n = this.cachedCaptureItems) === null || n === void 0 || n.forEach(function(o) {
        var s = o.getContainer();
        s.set("capture", !0);
      }), this.cachedCaptureItems = [], this.delegateRect && (this.delegateRect.remove(), this.delegateRect = null), this.get("updateEdge") && this.enableOptimize && !this.enableDelegate && this.targets.forEach(function(o) {
        var s = o.getEdges();
        s.forEach(function(u) {
          e.hidenEdge[u.getID()] && u.show(), u.refresh();
        });
      }), this.hidenEdge = {};
      var i = this.graph;
      if (i.get("enabledStack") && this.enableStack) {
        var a = {
          before: {
            nodes: [],
            edges: [],
            combos: []
          },
          after: {
            nodes: [],
            edges: [],
            combos: []
          }
        };
        this.get("beforeDragNodes").forEach(function(o) {
          a.before.nodes.push(o);
        }), this.targets.forEach(function(o) {
          var s = o.getModel(), u = s.x, f = s.y, l = s.id;
          a.after.nodes.push({
            x: u,
            y: f,
            id: l
          });
        }), i.pushStack("update", vr(a));
      }
      i.emit("dragnodeend", {
        items: this.targets,
        targetItem: null
      }), this.point = {}, this.origin = null, this.originPoint = {}, this.targets.length = 0, this.targetCombo = null;
    }
  },
  onDropCombo: function(t) {
    var e = t.item;
    if (this.currentShouldEnd = this.shouldEnd.call(this, t, e), this.updatePositions(t, !this.currentShouldEnd), !(!this.currentShouldEnd || !this.validationCombo(e))) {
      var n = this.graph;
      if (this.comboActiveState && n.setItemState(e, this.comboActiveState, !1), this.targetCombo = e, this.onlyChangeComboSize)
        n.updateCombos();
      else {
        var i = e.getModel();
        this.targets.map(function(a) {
          var o = a.getModel();
          o.comboId !== i.id && n.updateComboTree(a, i.id);
        }), n.updateCombo(e);
      }
      n.emit("dragnodeend", {
        items: this.targets,
        targetItem: this.targetCombo
      });
    }
  },
  onDropCanvas: function(t) {
    var e = this.graph;
    this.currentShouldEnd = this.shouldEnd.call(this, t, void 0), this.updatePositions(t, !this.currentShouldEnd), !(!this.targets || this.targets.length === 0 || !this.currentShouldEnd) && (this.onlyChangeComboSize ? e.updateCombos() : this.targets.map(function(n) {
      var i = n.getModel();
      i.comboId && e.updateComboTree(n);
    }));
  },
  onDropNode: function(t) {
    if (!(!this.targets || this.targets.length === 0)) {
      var e = this, n = t.item, i = e.graph, a = n.getModel().comboId, o = a ? i.findById(a) : void 0;
      if (this.currentShouldEnd = this.shouldEnd.call(this, t, o), this.updatePositions(t, !this.currentShouldEnd), !!this.currentShouldEnd) {
        if (this.onlyChangeComboSize)
          i.updateCombos();
        else if (a) {
          var s = i.findById(a);
          e.comboActiveState && i.setItemState(s, e.comboActiveState, !1), this.targets.map(function(u) {
            var f = u.getModel();
            a !== f.comboId && i.updateComboTree(u, a);
          }), i.updateCombo(s);
        } else
          this.targets.map(function(u) {
            var f = u.getModel();
            f.comboId && i.updateComboTree(u);
          });
        i.emit("dragnodeend", {
          items: this.targets,
          targetItem: n
        });
      }
    }
  },
  onDragEnter: function(t) {
    var e = t.item;
    if (!!this.validationCombo(e)) {
      var n = this.graph;
      this.comboActiveState && n.setItemState(e, this.comboActiveState, !0);
    }
  },
  onDragLeave: function(t) {
    var e = t.item;
    if (!!this.validationCombo(e)) {
      var n = this.graph;
      this.comboActiveState && n.setItemState(e, this.comboActiveState, !1);
    }
  },
  updatePositions: function(t, e) {
    var n = this;
    !this.targets || this.targets.length === 0 || (this.get("enableDelegate") ? this.enableDebounce ? this.debounceUpdate({
      targets: this.targets,
      graph: this.graph,
      point: this.point,
      origin: this.origin,
      evt: t,
      updateEdge: this.get("updateEdge"),
      updateFunc: this.update
    }) : e || this.targets.map(function(i) {
      return n.update(i, t);
    }) : this.targets.map(function(i) {
      return n.update(i, t, e);
    }));
  },
  update: function(t, e, n) {
    var i = this.origin, a = t.get("model"), o = t.get("id");
    this.point[o] || (this.point[o] = {
      x: a.x || 0,
      y: a.y || 0
    });
    var s = e.x - i.x + this.point[o].x, u = e.y - i.y + this.point[o].y;
    n && (s += i.x - e.x, u += i.y - e.y);
    var f = {
      x: s,
      y: u
    };
    this.get("updateEdge") ? this.graph.updateItem(t, f, !1) : t.updatePosition(f);
  },
  debounceUpdate: Jc(function(r) {
    var t = r.targets, e = r.graph, n = r.point, i = r.origin, a = r.evt, o = r.updateEdge;
    r.updateFunc, t.map(function(s) {
      var u = s.get("model"), f = s.get("id");
      n[f] || (n[f] = {
        x: u.x || 0,
        y: u.y || 0
      });
      var l = a.x - i.x + n[f].x, c = a.y - i.y + n[f].y, h = {
        x: l,
        y: c
      };
      o ? e.updateItem(s, h, !1) : s.updatePosition(h);
    });
  }, 50, !0),
  updateDelegate: function(t) {
    var e = this.graph;
    if (this.delegateRect) {
      var h = t.x - this.origin.x + this.originPoint.minX, d = t.y - this.origin.y + this.originPoint.minY;
      this.delegateRect.attr({
        x: h,
        y: d
      });
    } else {
      var n = e.get("group"), i = kr({}, lu.delegateStyle, this.delegateStyle), a = this.calculationGroupPosition(t), o = a.x, s = a.y, u = a.width, f = a.height, l = a.minX, c = a.minY;
      this.originPoint = {
        x: o,
        y: s,
        width: u,
        height: f,
        minX: l,
        minY: c
      }, this.delegateRect = n.addShape("rect", {
        attrs: U({
          width: u,
          height: f,
          x: o,
          y: s
        }, i),
        name: "rect-delegate-shape"
      }), this.delegate = this.delegateRect, this.delegateRect.set("capture", !1);
    }
  },
  calculationGroupPosition: function(t) {
    var e = this.targets;
    e.length === 0 && e.push(t.item);
    for (var n = 1 / 0, i = -1 / 0, a = 1 / 0, o = -1 / 0, s = 0; s < e.length; s++) {
      var u = e[s], f = u.getBBox(), l = f.minX, c = f.minY, h = f.maxX, d = f.maxY;
      l < n && (n = l), c < a && (a = c), h > i && (i = h), d > o && (o = d);
    }
    var v = Math.floor(n), p = Math.floor(a), g = Math.ceil(i) - Math.floor(n), y = Math.ceil(o) - Math.floor(a);
    return {
      x: v,
      y: p,
      width: g,
      height: y,
      minX: n,
      minY: a
    };
  }
}, Mme = {
  getDefaultCfg: function() {
    return {
      trigger: "mouseenter",
      activeState: "active",
      inactiveState: "inactive",
      resetSelected: !1,
      shouldUpdate: function() {
        return !0;
      }
    };
  },
  getEvents: function() {
    return this.get("trigger") === "mouseenter" ? {
      "node:mouseenter": "setAllItemStates",
      "combo:mouseenter": "setAllItemStates",
      "node:mouseleave": "clearActiveState",
      "combo:mouseleave": "clearActiveState"
    } : {
      "node:click": "setAllItemStates",
      "combo:click": "setAllItemStates",
      "canvas:click": "clearActiveState",
      "node:touchstart": "setOnTouchStart",
      "combo:touchstart": "setOnTouchStart",
      "canvas:touchstart": "clearOnTouchStart"
    };
  },
  setOnTouchStart: function(t) {
    var e = this;
    try {
      var n = t.originalEvent.touches, i = n[0], a = n[1];
      if (i && a)
        return;
      t.preventDefault();
    } catch {
      console.warn("Touch original event not exist!");
    }
    e.setAllItemStates(t);
  },
  clearOnTouchStart: function(t) {
    var e = this;
    try {
      var n = t.originalEvent.touches, i = n[0], a = n[1];
      if (i && a)
        return;
      t.preventDefault();
    } catch {
      console.warn("Touch original event not exist!");
    }
    e.clearActiveState(t);
  },
  setAllItemStates: function(t) {
    var e = t.item, n = this.graph;
    if (this.item = e, !!this.shouldUpdate(t.item, {
      event: t,
      action: "activate"
    })) {
      for (var i = this, a = this.activeState, o = this.inactiveState, s = n.getNodes(), u = n.getCombos(), f = n.getEdges(), l = n.get("vedges"), c = s.length, h = u.length, d = f.length, v = l.length, p = 0; p < c; p++) {
        var g = s[p], y = g.hasState("selected");
        i.resetSelected && y && n.setItemState(g, "selected", !1), n.setItemState(g, a, !1), o && n.setItemState(g, o, !0);
      }
      for (var p = 0; p < h; p++) {
        var b = u[p], y = b.hasState("selected");
        i.resetSelected && y && n.setItemState(b, "selected", !1), n.setItemState(b, a, !1), o && n.setItemState(b, o, !0);
      }
      for (var p = 0; p < d; p++) {
        var m = f[p];
        n.setItemState(m, a, !1), o && n.setItemState(m, o, !0);
      }
      for (var p = 0; p < v; p++) {
        var x = l[p];
        n.setItemState(x, a, !1), o && n.setItemState(x, o, !0);
      }
      o && n.setItemState(e, o, !1), n.setItemState(e, a, !0);
      for (var _ = e.getEdges(), w = _.length, p = 0; p < w; p++) {
        var m = _[p], E = void 0;
        m.getSource() === e ? E = m.getTarget() : E = m.getSource(), o && n.setItemState(E, o, !1), n.setItemState(E, a, !0), n.setItemState(m, o, !1), n.setItemState(m, a, !0), m.toFront();
      }
      n.emit("afteractivaterelations", {
        item: t.item,
        action: "activate"
      });
    }
  },
  clearActiveState: function(t) {
    var e = this, n = e.get("graph");
    if (!!e.shouldUpdate(t.item, {
      event: t,
      action: "deactivate"
    })) {
      var i = this.activeState, a = this.inactiveState, o = n.get("autoPaint");
      n.setAutoPaint(!1);
      for (var s = n.getNodes() || [], u = n.getCombos() || [], f = n.getEdges() || [], l = n.get("vedges") || [], c = s.length, h = u.length, d = f.length, v = l.length, p = 0; p < c; p++) {
        var g = s[p];
        n.clearItemStates(g, [i, a]);
      }
      for (var p = 0; p < h; p++) {
        var y = u[p];
        n.clearItemStates(y, [i, a]);
      }
      for (var p = 0; p < d; p++) {
        var b = f[p];
        n.clearItemStates(b, [i, a, "deactivate"]);
      }
      for (var p = 0; p < v; p++) {
        var m = l[p];
        n.clearItemStates(m, [i, a, "deactivate"]);
      }
      n.paint(), n.setAutoPaint(o), n.emit("afteractivaterelations", {
        item: t.item || e.get("item"),
        action: "deactivate"
      });
    }
  }
};
var uv = Math.min, fD = Math.max, lD = Math.abs, cD = "shift", Cme = ["drag", "shift", "ctrl", "alt", "control"];
const Tme = {
  getDefaultCfg: function() {
    return {
      brushStyle: {
        fill: "#EEF6FF",
        fillOpacity: 0.4,
        stroke: "#DDEEFE",
        lineWidth: 1
      },
      onSelect: function() {
      },
      onDeselect: function() {
      },
      selectedState: "selected",
      trigger: cD,
      includeEdges: !0,
      includeCombos: !1,
      selectedEdges: [],
      selectedNodes: [],
      selectedCombos: []
    };
  },
  getEvents: function() {
    return Cme.indexOf(this.trigger.toLowerCase()) > -1 || (this.trigger = cD, console.warn("Behavior brush-select \u7684 trigger \u53C2\u6570\u4E0D\u5408\u6CD5\uFF0C\u8BF7\u8F93\u5165 'drag'\u3001'shift'\u3001'ctrl' \u6216 'alt'")), this.trigger === "drag" ? {
      dragstart: "onMouseDown",
      drag: "onMouseMove",
      dragend: "onMouseUp",
      "canvas:click": "clearStates"
    } : {
      dragstart: "onMouseDown",
      drag: "onMouseMove",
      dragend: "onMouseUp",
      "canvas:click": "clearStates",
      keyup: "onKeyUp",
      keydown: "onKeyDown"
    };
  },
  onMouseDown: function(t) {
    var e = t.item, n = this.brush;
    e || this.trigger !== "drag" && !this.keydown || (this.selectedNodes && this.selectedNodes.length !== 0 && this.clearStates(), n || (n = this.createBrush()), this.originPoint = {
      x: t.canvasX,
      y: t.canvasY
    }, n.attr({
      width: 0,
      height: 0
    }), n.show(), this.dragging = !0);
  },
  onMouseMove: function(t) {
    !this.dragging || this.trigger !== "drag" && !this.keydown || this.updateBrush(t);
  },
  onMouseUp: function(t) {
    this.graph, !(!this.brush && !this.dragging) && (this.trigger !== "drag" && !this.keydown || (this.brush.remove(!0), this.brush = null, this.getSelectedNodes(t), this.dragging = !1));
  },
  clearStates: function() {
    var t = this, e = t.graph, n = t.selectedState, i = e.findAllByState("node", n), a = e.findAllByState("edge", n), o = e.findAllByState("combo", n);
    i.forEach(function(s) {
      return e.setItemState(s, n, !1);
    }), a.forEach(function(s) {
      return e.setItemState(s, n, !1);
    }), o.forEach(function(s) {
      return e.setItemState(s, n, !1);
    }), this.selectedNodes = [], this.selectedEdges = [], this.selectedCombos = [], this.onDeselect && this.onDeselect(this.selectedNodes, this.selectedEdges, this.selectedCombos), e.emit("nodeselectchange", {
      selectedItems: {
        nodes: [],
        edges: [],
        combos: []
      },
      select: !1
    });
  },
  isBBoxCenterInRect: function(t, e, n, i, a) {
    var o = t.getBBox();
    return o.centerX >= e && o.centerX <= n && o.centerY >= i && o.centerY <= a;
  },
  getSelectedNodes: function(t) {
    var e = this, n = this, i = n.graph, a = n.originPoint, o = n.shouldUpdate, s = n.isBBoxCenterInRect, u = this.selectedState, f = {
      x: t.x,
      y: t.y
    }, l = i.getPointByCanvas(a.x, a.y), c = uv(f.x, l.x), h = fD(f.x, l.x), d = uv(f.y, l.y), v = fD(f.y, l.y), p = [], g = [];
    i.getNodes().forEach(function(m) {
      if (m.isVisible() && s(m, c, h, d, v) && o(m, "select")) {
        p.push(m);
        var x = m.getModel();
        g.push(x.id), i.setItemState(m, u, !0);
      }
    });
    var y = [];
    this.includeEdges && p.forEach(function(m) {
      var x = m.getOutEdges();
      x.forEach(function(_) {
        if (!!_.isVisible()) {
          var w = _.getModel(), E = w.source, M = w.target;
          g.includes(E) && g.includes(M) && o(_, "select") && (y.push(_), i.setItemState(_, e.selectedState, !0));
        }
      });
    });
    var b = [];
    this.includeCombos && i.getCombos().forEach(function(m) {
      if (m.isVisible() && s(m, c, h, d, v) && o(m, "select")) {
        b.push(m);
        var x = m.getModel();
        g.push(x.id), i.setItemState(m, u, !0);
      }
    }), this.selectedEdges = y, this.selectedNodes = p, this.selectedCombos = b, this.onSelect && this.onSelect(p, y, b), i.emit("nodeselectchange", {
      selectedItems: {
        nodes: p,
        edges: y,
        combos: b
      },
      select: !0
    });
  },
  createBrush: function() {
    var t = this, e = t.graph.get("canvas").addShape("rect", {
      attrs: t.brushStyle,
      capture: !1,
      name: "brush-shape"
    });
    return this.brush = e, this.delegate = e, e;
  },
  updateBrush: function(t) {
    var e = this.originPoint;
    this.brush.attr({
      width: lD(t.canvasX - e.x),
      height: lD(t.canvasY - e.y),
      x: uv(t.canvasX, e.x),
      y: uv(t.canvasY, e.y)
    });
  },
  onKeyDown: function(t) {
    var e = t.key;
    if (!!e) {
      var n = this.trigger.toLowerCase(), i = e.toLowerCase();
      i === n || i === "control" && n === "ctrl" || i === "ctrl" && n === "control" ? this.keydown = !0 : this.keydown = !1;
    }
  },
  onKeyUp: function() {
    this.brush && (this.brush.remove(!0), this.brush = null, this.dragging = !1), this.keydown = !1;
  }
};
var hD = "shift", Ame = ["shift", "ctrl", "alt", "control"];
const Ime = {
  getDefaultCfg: function() {
    return {
      multiple: !0,
      trigger: hD,
      selectedState: "selected",
      selectNode: !0,
      selectEdge: !1,
      selectCombo: !0
    };
  },
  getEvents: function() {
    var t = this;
    return Ame.indexOf(t.trigger.toLowerCase()) > -1 || (t.trigger = hD, console.warn("Behavior click-select \u7684 trigger \u53C2\u6570\u4E0D\u5408\u6CD5\uFF0C\u8BF7\u8F93\u5165 'drag'\u3001'shift'\u3001'ctrl' \u6216 'alt'")), t.multiple ? {
      "node:click": "onClick",
      "combo:click": "onClick",
      "edge:click": "onClick",
      "canvas:click": "onCanvasClick",
      keyup: "onKeyUp",
      keydown: "onKeyDown"
    } : {
      "node:click": "onClick",
      "combo:click": "onClick",
      "edge:click": "onClick",
      "canvas:click": "onCanvasClick"
    };
  },
  onClick: function(t) {
    var e = this, n = t.item;
    if (!(!n || n.destroyed)) {
      var i = n.getType(), a = e.graph, o = e.keydown, s = e.multiple, u = e.shouldUpdate, f = e.shouldBegin;
      if (!!f.call(e, t)) {
        if (!o || !s) {
          var l = a.findAllByState("node", e.selectedState).concat(a.findAllByState("edge", e.selectedState)).concat(a.findAllByState("combo", e.selectedState));
          Se(l, function(p) {
            p !== n && a.setItemState(p, e.selectedState, !1);
          });
        }
        var c = function() {
          switch (i) {
            case "node":
              return e.selectNode;
            case "edge":
              return e.selectEdge;
            case "combo":
              return e.selectCombo;
            default:
              return !1;
          }
        }();
        if (!c) {
          var h = a.findAllByState("node", e.selectedState), d = a.findAllByState("edge", e.selectedState), v = a.findAllByState("combo", e.selectedState);
          a.emit("nodeselectchange", {
            selectedItems: {
              nodes: h,
              edges: d,
              combos: v
            },
            select: !1
          });
          return;
        }
        if (n.hasState(e.selectedState)) {
          u.call(e, t) && a.setItemState(n, e.selectedState, !1);
          var h = a.findAllByState("node", e.selectedState), d = a.findAllByState("edge", e.selectedState), v = a.findAllByState("combo", e.selectedState);
          a.emit("nodeselectchange", {
            target: n,
            selectedItems: {
              nodes: h,
              edges: d,
              combos: v
            },
            select: !1
          });
        } else {
          u.call(e, t) && a.setItemState(n, e.selectedState, !0);
          var h = a.findAllByState("node", e.selectedState), d = a.findAllByState("edge", e.selectedState), v = a.findAllByState("combo", e.selectedState);
          a.emit("nodeselectchange", {
            target: n,
            selectedItems: {
              nodes: h,
              edges: d,
              combos: v
            },
            select: !0
          });
        }
      }
    }
  },
  onCanvasClick: function(t) {
    var e = this, n = this, i = n.graph, a = n.shouldBegin;
    if (!!a.call(this, t)) {
      var o = i.findAllByState("node", this.selectedState);
      Se(o, function(f) {
        i.setItemState(f, e.selectedState, !1);
      });
      var s = i.findAllByState("edge", this.selectedState);
      Se(s, function(f) {
        i.setItemState(f, e.selectedState, !1);
      });
      var u = i.findAllByState("combo", this.selectedState);
      Se(u, function(f) {
        i.setItemState(f, e.selectedState, !1);
      }), i.emit("nodeselectchange", {
        selectedItems: {
          nodes: [],
          edges: [],
          combos: []
        },
        select: !1
      });
    }
  },
  onKeyDown: function(t) {
    var e = this, n = t.key;
    !n || (n.toLowerCase() === this.trigger.toLowerCase() || n.toLowerCase() === "control" ? e.keydown = !0 : e.keydown = !1);
  },
  onKeyUp: function() {
    var t = this;
    t.keydown = !1;
  }
};
var Pme = $i, dD = 0.05;
const Ome = {
  getDefaultCfg: function() {
    return {
      sensitivity: 2,
      minZoom: void 0,
      maxZoom: void 0,
      enableOptimize: !1,
      optimizeZoom: 0.1,
      fixSelectedItems: {
        fixAll: !1,
        fixLineWidth: !1,
        fixLabel: !1,
        fixState: "selected"
      },
      animate: !1,
      animateCfg: {
        duration: 500
      }
    };
  },
  getEvents: function() {
    var t = this.fixSelectedItems;
    return t.fixState || (t.fixState = "selected"), t.fixAll && (t.fixLineWidth = !0, t.fixLabel = !0), {
      wheel: "onWheel",
      touchstart: "onTouchStart",
      touchmove: "onTouchMove",
      touchend: "onTouchEnd"
    };
  },
  onTouchStart: function(t) {
    var e = t.originalEvent.touches, n = e[0], i = e[1];
    t.preventDefault(), i && (this.shouldBegin && !this.shouldBegin.call(this, t) || (this.startPoint = {
      pageX: n.pageX,
      pageY: n.pageY
    }, this.moveable = !0, i && (this.endPoint = {
      pageX: i.pageX,
      pageY: i.pageY
    }), this.originScale = this.graph.getZoom() || this.currentScale || 1));
  },
  onTouchMove: function(t) {
    if (!!this.moveable) {
      t.preventDefault();
      var e = t.originalEvent.touches, n = e[0], i = e[1];
      if (!!i) {
        this.endPoint || (this.endPoint = {
          pageX: i.pageX,
          pageY: i.pageY
        });
        var a = function(p, g) {
          return Math.hypot(g.x - p.x, g.y - p.y);
        }, o = a({
          x: n.pageX,
          y: n.pageY
        }, {
          x: i.pageX,
          y: i.pageY
        }) / a({
          x: this.startPoint.pageX,
          y: this.startPoint.pageY
        }, {
          x: this.endPoint.pageX,
          y: this.endPoint.pageY
        }), s = this.originScale * o;
        this.currentScale = s;
        var u = this.get("minZoom") || this.graph.get("minZoom"), f = this.get("maxZoom") || this.graph.get("maxZoom");
        if (!(s > f || s < u)) {
          var l = this.get("animate"), c = this.get("animateCfg"), h = this.graph.get("canvas"), d = h.getPointByClient(t.clientX, t.clientY);
          this.graph.zoomTo(s, {
            x: d.x,
            y: d.y
          }, l, c), this.graph.emit("wheelzoom", t);
        }
      }
    }
  },
  onTouchEnd: function() {
    this.moveable = !1, this.endPoint = null;
  },
  onWheel: function(t) {
    var e = this, n = this, i = n.graph, a = n.fixSelectedItems;
    if (!(this.shouldBegin && !this.shouldBegin.call(this, t)) && !!this.shouldUpdate.call(this, t)) {
      t.preventDefault();
      var o = i.get("canvas"), s = o.getPointByClient(t.clientX, t.clientY), u = this.get("sensitivity"), f = i.getZoom(), l = f, c = f;
      t.wheelDelta < 0 ? l = 1 - dD * u : l = 1 / (1 - dD * u), c = f * l;
      var h = this.get("minZoom") || i.get("minZoom"), d = this.get("maxZoom") || i.get("maxZoom");
      c > d ? c = d : c < h && (c = h);
      var v = this.get("enableOptimize");
      if (v) {
        var p = this.get("optimizeZoom"), g = this.get("optimized"), y = i.getNodes(), b = i.getEdges(), m = y.length, x = b.length;
        if (!g) {
          for (var _ = 0; _ < m; _++) {
            var w = y[_];
            if (!w.destroyed)
              for (var E = w.get("group").get("children"), M = E.length, C = 0; C < M; C++) {
                var S = E[C];
                !S.destoryed && !S.get("isKeyShape") && (S.set("ori-visibility", S.get("ori-visibility") || S.get("visible")), S.hide());
              }
          }
          for (var A = 0; A < x; A++)
            for (var T = b[A], E = T.get("group").get("children"), M = E.length, C = 0; C < M; C++) {
              var S = E[C];
              S.set("ori-visibility", S.get("ori-visibility") || S.get("visible")), S.hide();
            }
          this.set("optimized", !0);
        }
        clearTimeout(this.get("timeout"));
        var P = setTimeout(function() {
          var Ye = i.getZoom(), vt = e.get("optimized");
          if (vt) {
            e.set("optimized", !1);
            for (var N = 0; N < m; N++) {
              var Z = y[N], pe = Z.get("group").get("children"), se = pe.length;
              if (Ye < p) {
                var Ce = Z.getKeyShape(), ke = Ce.get("ori-visibility");
                Ce.set("ori-visibility", void 0), ke && Ce.show();
              } else
                for (var at = 0; at < se; at++) {
                  var je = pe[at], ke = je.get("ori-visibility");
                  je.set("ori-visibility", void 0), !je.get("visible") && ke && ke && je.show();
                }
            }
            for (var lt = 0; lt < x; lt++) {
              var ct = b[lt], pe = ct.get("group").get("children"), se = pe.length;
              if (Ye < p) {
                var Ce = ct.getKeyShape(), ke = Ce.get("ori-visibility");
                Ce.set("ori-visibility", void 0), ke && Ce.show();
              } else
                for (var at = 0; at < se; at++) {
                  var je = pe[at];
                  if (!je.get("visible")) {
                    var ke = je.get("ori-visibility");
                    je.set("ori-visibility", void 0), ke && je.show();
                  }
                }
            }
          }
        }, 100);
        this.set("timeout", P);
      }
      if (f <= 1) {
        var k = void 0, L = void 0;
        if (a.fixAll || a.fixLineWidth || a.fixLabel) {
          k = i.findAllByState("node", a.fixState), L = i.findAllByState("edge", a.fixState);
          for (var O = f / c, D = k.length, G = 0; G < D; G++) {
            var w = k[G], R = w.getContainer(), F = w.getModel(), q = w.getOriginStyle(), ne = w.getStateStyle(a.fixState), oe = w.get("shapeFactory").getShape(F.type).getStateStyle(a.fixState, w)[a.fixState];
            if (a.fixAll) {
              if (c <= 1) {
                var ie = vr(R.getMatrix());
                ie || (ie = [1, 0, 0, 0, 1, 0, 0, 0, 1]);
                var Ee = w.getModel(), Xe = Ee.x, le = Ee.y;
                ie = Pme(ie, [["t", -Xe, -le], ["s", O, O], ["t", Xe, le]]), R.setMatrix(ie);
              }
            } else
              for (var E = R.get("children"), M = E.length, C = 0; C < M; C++) {
                var S = E[C], Me = void 0, $e = void 0;
                if (a.fixLabel) {
                  var et = S.get("type");
                  if (et === "text") {
                    Me = S.attr("fontSize") || 12;
                    var ft = ne[S.get("name")], pt = oe[S.get("name")], $ = ft ? ft.fontSize : 12, te = pt ? pt.fontSize : 12, X = $ || te || 12;
                    if (c <= 1 && S.attr("fontSize", X / c), $e)
                      break;
                  }
                }
                if (a.fixLineWidth && S.get("isKeyShape")) {
                  $e = S.attr("lineWidth") || 0;
                  var De = ne.lineWidth || oe.lineWidth || q.lineWidth || 0;
                  if (c <= 1 && S.attr("lineWidth", De / c), Me)
                    break;
                }
              }
          }
          for (var Ke = L.length, Fe = 0; Fe < Ke; Fe++)
            for (var T = L[Fe], R = T.getContainer(), E = R.get("children"), F = T.getModel(), ne = T.getStateStyle(a.fixState), oe = T.get("shapeFactory").getShape(F.type).getStateStyle(a.fixState, T)[a.fixState], M = E.length, C = 0; C < M; C++) {
              var S = E[C], Me = void 0, $e = void 0;
              if (a.fixLabel || a.fixAll) {
                var et = S.get("type");
                if (et === "text") {
                  Me = S.attr("fontSize") || 12;
                  var ft = ne[S.get("name")], pt = oe[S.get("name")], $ = ft ? ft.fontSize : 12, te = pt ? pt.fontSize : 12, X = $ || te || 12;
                  if (c <= 1 && S.attr("fontSize", X / c), $e)
                    break;
                }
              }
              if ((a.fixLineWidth || a.fixAll) && S.get("isKeyShape")) {
                $e = S.attr("lineWidth") || 0;
                var De = ne.lineWidth || oe.lineWidth || 1;
                if (c <= 1 && S.attr("lineWidth", De / c), Me)
                  break;
              }
            }
        }
      }
      var _t = this.get("animate"), Kt = this.get("animateCfg");
      i.zoomTo(c, {
        x: s.x,
        y: s.y
      }, _t, Kt), i.emit("wheelzoom", t);
    }
  }
}, C4 = {
  onMouseEnter: function(t) {
    var e = t.item;
    this.currentTarget = e, this.showTooltip(t), this.graph.emit("tooltipchange", {
      item: t.item,
      action: "show"
    });
  },
  onMouseMove: function(t) {
    if (!this.shouldUpdate(t)) {
      this.hideTooltip();
      return;
    }
    !this.currentTarget || t.item !== this.currentTarget || this.updatePosition(t);
  },
  onMouseLeave: function(t) {
    !this.shouldEnd(t) || (this.hideTooltip(), this.graph.emit("tooltipchange", {
      item: this.currentTarget,
      action: "hide"
    }), this.currentTarget = null);
  },
  showTooltip: function(t) {
    var e = this.container;
    if (!(!t.item || t.item.destroyed)) {
      e || (e = this.createTooltip(this.graph.get("canvas")), this.container = e);
      var n = this.formatText(t.item.get("model"), t);
      e.innerHTML = n, ar(this.container, {
        visibility: "visible"
      }), this.updatePosition(t);
    }
  },
  hideTooltip: function() {
    ar(this.container, {
      visibility: "hidden"
    });
  },
  updatePosition: function(t) {
    var e = this.get("shouldBegin"), n = this, i = n.width, a = n.height, o = n.container, s = n.graph;
    if (!e(t)) {
      ar(o, {
        visibility: "hidden"
      });
      return;
    }
    var u = s.getPointByClient(t.clientX, t.clientY), f = s.getCanvasByPoint(u.x, u.y), l = f.x, c = f.y, h = o.getBoundingClientRect();
    l > i / 2 ? l -= h.width : l += this.offset, c > a / 2 ? c -= h.height : c += this.offset;
    var d = "".concat(l, "px"), v = "".concat(c, "px");
    ar(this.container, {
      left: d,
      top: v,
      visibility: "visible"
    });
  },
  createTooltip: function(t) {
    var e = t.get("el");
    e.style.position = "relative";
    var n = Nr('<div class="g6-tooltip g6-'.concat(this.item, '-tooltip"></div>'));
    return e.parentNode.appendChild(n), ar(n, {
      position: "absolute",
      visibility: "visible"
    }), this.width = t.get("width"), this.height = t.get("height"), this.container = n, this.graph.get("tooltips").push(n), n;
  }
}, Dme = U({
  getDefaultCfg: function() {
    return {
      item: "node",
      offset: 12,
      formatText: function(e) {
        return e.label;
      }
    };
  },
  getEvents: function() {
    return {
      "node:mouseenter": "onMouseEnter",
      "node:mouseleave": "onMouseLeave",
      "node:mousemove": "onMouseMove",
      afterremoveitem: "onMouseLeave"
    };
  }
}, C4), kme = U({
  getDefaultCfg: function() {
    return {
      item: "edge",
      offset: 12,
      formatText: function(e) {
        return "source: ".concat(e.source, " target: ").concat(e.target);
      }
    };
  },
  getEvents: function() {
    return {
      "edge:mouseenter": "onMouseEnter",
      "edge:mouseleave": "onMouseLeave",
      "edge:mousemove": "onMouseMove",
      afterremoveitem: "onMouseLeave"
    };
  }
}, C4);
var vD = "click", Lme = ["click", "dblclick"];
const Nme = {
  getDefaultCfg: function() {
    return {
      trigger: vD,
      onChange: function() {
      }
    };
  },
  getEvents: function() {
    var t, e;
    return Lme.includes(this.trigger) ? e = this.trigger : (e = vD, console.warn("Behavior collapse-expand \u7684 trigger \u53C2\u6570\u4E0D\u5408\u6CD5\uFF0C\u8BF7\u8F93\u5165 'click' \u6216 'dblclick'")), t = {}, t["node:".concat(e)] = "onNodeClick", t.touchstart = "onNodeClick", t;
  },
  onNodeClick: function(t) {
    var e = t.item;
    if (!!e) {
      var n = this.graph.findDataById(e.get("id"));
      if (!!n) {
        var i = n.children;
        if (!(!i || i.length === 0)) {
          var a = !n.collapsed;
          !this.shouldBegin(t, a) || (n.collapsed = a, e.getModel().collapsed = a, this.graph.emit("itemcollapsed", {
            item: t.item,
            collapsed: a
          }), this.shouldUpdate(t, a) && (this.onChange(e, a), this.graph.layout()));
        }
      }
    }
  }
};
var Rme = No.calculationItemsBBox, Bme = function r(t, e) {
  if (e(t) !== !1 && t) {
    var n = t.get("combos");
    if (n.length === 0)
      return !1;
    Se(n, function(i) {
      r(i, e);
    });
  }
};
const Gme = {
  getDefaultCfg: function() {
    return {
      enableDelegate: !1,
      delegateStyle: {},
      onlyChangeComboSize: !1,
      activeState: "",
      selectedState: "selected",
      enableStack: !0
    };
  },
  getEvents: function() {
    return {
      "combo:dragstart": "onDragStart",
      "combo:drag": "onDrag",
      "combo:dragend": "onDragEnd",
      "combo:drop": "onDrop",
      "node:drop": "onNodeDrop",
      "combo:dragenter": "onDragEnter",
      "combo:dragleave": "onDragLeave"
    };
  },
  validationCombo: function(t) {
    var e = t.item;
    if (!e || e.destroyed || !this.shouldUpdate.call(this, t))
      return !1;
    var n = e.getType();
    return n === "combo";
  },
  onDragStart: function(t) {
    var e = this, n = this.graph, i = t.item;
    if (this.currentShouldEnd = !0, !!this.validationCombo(t)) {
      this.targets = [];
      var a = n.findAllByState("combo", this.selectedState), o = i.get("id"), s = a.filter(function(f) {
        var l = f.get("id");
        return o === l;
      });
      s.length === 0 ? this.targets.push(i) : this.targets = a;
      var u = [];
      this.targets.forEach(function(f) {
        var l = f.getModel(), c = l.x, h = l.y, d = l.id;
        u.push({
          x: c,
          y: h,
          id: d
        });
      }), this.set("beforeDragItems", u), this.activeState && this.targets.map(function(f) {
        var l = f.getModel();
        if (l.parentId) {
          var c = n.findById(l.parentId);
          c && n.setItemState(c, e.activeState, !0);
        }
      }), this.point = {}, this.originPoint = {}, this.origin = {
        x: t.x,
        y: t.y
      }, this.currentItemChildCombos = [], Bme(i, function(f) {
        if (f.destroyed)
          return !1;
        var l = f.getModel();
        return e.currentItemChildCombos.push(l.id), !0;
      });
    }
  },
  onDrag: function(t) {
    var e = this;
    if (!!this.origin && !!this.validationCombo(t))
      if (this.enableDelegate)
        this.updateDelegate(t);
      else {
        if (this.activeState) {
          var n = this.graph, i = t.item, a = i.getModel(), o = n.getCombos(), s = i.getBBox(), u = s.centerX, f = s.centerY, l = s.width, c = o.filter(function(h) {
            var d = h.getModel();
            return a.parentId, d.id !== a.id && !e.currentItemChildCombos.includes(d.id);
          });
          c.map(function(h) {
            var d = h.getBBox(), v = d.centerX, p = d.centerY, g = d.width, y = u - v, b = f - p, m = 2 * Math.sqrt(y * y + b * b);
            l + g - m > 0.8 * l ? n.setItemState(h, e.activeState, !0) : n.setItemState(h, e.activeState, !1);
          });
        }
        Se(this.targets, function(h) {
          e.updateCombo(h, t);
        });
      }
  },
  updatePositions: function(t, e) {
    var n = this;
    (this.enableDelegate || e) && Se(this.targets, function(i) {
      n.updateCombo(i, t, e);
    });
  },
  onDrop: function(t) {
    var e = this, n = t.item;
    if (this.currentShouldEnd = this.shouldEnd.call(this, t, n), this.updatePositions(t, !this.currentShouldEnd), !(!this.currentShouldEnd || !n || !this.targets || n.destroyed)) {
      var i = this.graph, a = n.getModel();
      this.targets.map(function(o) {
        var s = o.getModel();
        s.parentId !== a.id ? (e.activeState && i.setItemState(n, e.activeState, !1), e.onlyChangeComboSize ? i.updateCombo(o) : i.updateComboTree(o, a.id, !1)) : i.updateCombo(n);
      }), this.end(n, t), this.endComparison = !0;
    }
  },
  onNodeDrop: function(t) {
    var e = this;
    if (!(!this.targets || this.targets.length === 0)) {
      var n = this.graph, i = t.item, a = i.getModel().comboId, o = a ? n.findById(a) : void 0;
      if (this.currentShouldEnd = this.shouldEnd.call(this, t, o), this.updatePositions(t, !this.currentShouldEnd), !!this.currentShouldEnd) {
        var s;
        if (a) {
          if (this.activeState) {
            var u = n.findById(a);
            n.setItemState(u, this.activeState, !1);
          }
          this.targets.map(function(f) {
            e.onlyChangeComboSize ? n.updateCombo(f) : a !== f.getID() && (s = n.findById(a), a !== f.getModel().parentId && n.updateComboTree(f, a, !1));
          });
        } else
          this.targets.map(function(f) {
            if (e.onlyChangeComboSize)
              n.updateCombo(f);
            else {
              var l = f.getModel();
              l.comboId && n.updateComboTree(f, void 0, !1);
            }
          });
        this.endComparison = !0, this.end(s, t);
      }
    }
  },
  onDragEnter: function(t) {
    if (!!this.origin && !!this.validationCombo(t)) {
      var e = t.item, n = this.graph;
      this.activeState && n.setItemState(e, this.activeState, !0);
    }
  },
  onDragLeave: function(t) {
    if (!!this.origin && !!this.validationCombo(t)) {
      var e = t.item, n = this.graph;
      this.activeState && n.setItemState(e, this.activeState, !1);
    }
  },
  onDragEnd: function(t) {
    if (!(!this.targets || this.targets.length === 0)) {
      var e = t.item;
      this.currentShouldEnd && this.updatePositions(t);
      var n = this.getParentCombo(e.getModel().parentId), i = this.graph;
      n && this.activeState && i.setItemState(n, this.activeState, !1), this.end(void 0, t);
    }
  },
  end: function(t, e) {
    var n = this;
    if (!!this.origin) {
      var i = this.graph;
      if (this.delegateShape) {
        var a = i.get("delegateGroup");
        a.clear(), this.delegateShape = null;
      }
      if (t && this.activeState && i.setItemState(t, this.activeState, !1), !t) {
        var o = i.get("enabledStack") && this.enableStack, s = {
          before: {
            nodes: [],
            edges: [],
            combos: [].concat(this.get("beforeDragItems"))
          },
          after: {
            nodes: [],
            edges: [],
            combos: []
          }
        };
        this.targets.map(function(u) {
          if (!n.onlyChangeComboSize)
            i.updateComboTree(u, void 0, o);
          else {
            i.updateCombo(u);
            var f = u.getModel(), l = f.x, c = f.y, h = f.id;
            s.after.combos.push({
              x: l,
              y: c,
              id: h
            }), i.pushStack("update", s);
          }
        });
      }
      this.point = [], this.origin = null, this.originPoint = null, this.targets.length = 0;
    }
  },
  traverse: function(t, e, n) {
    var i = this;
    if (n === void 0 && (n = {}), e(t, n) !== !1 && t) {
      var a = t.get("combos");
      Se(a, function(s) {
        i.traverse(s, e, n);
      });
      var o = t.get("nodes");
      Se(o, function(s) {
        i.traverse(s, e, n);
      });
    }
  },
  updateCombo: function(t, e, n) {
    this.updateSingleItem(t, e, n);
    var i = {};
    this.traverse(t, function(a, o) {
      return a.destroyed ? !1 : (a.getEdges().forEach(function(s) {
        return o[s.getID()] = s;
      }), !0);
    }, i), Object.values(i).forEach(function(a) {
      return a.refresh();
    });
  },
  updateSingleItem: function(t, e, n) {
    var i = this.origin, a = this.graph, o = t.getModel(), s = t.get("id");
    this.point[s] || (this.point[s] = {
      x: o.x,
      y: o.y
    });
    var u = e.x - i.x + this.point[s].x, f = e.y - i.y + this.point[s].y;
    n && (u += i.x - e.x, f += i.y - e.y), a.updateItem(t, {
      x: u,
      y: f
    }, !1);
  },
  getParentCombo: function(t) {
    var e = this.graph;
    if (!!t) {
      var n = e.findById(t);
      if (!!n)
        return n;
    }
  },
  updateDelegate: function(t) {
    var e = this.graph;
    if (this.delegateShape) {
      var h = t.x - this.origin.x + this.originPoint.minX, d = t.y - this.origin.y + this.originPoint.minY;
      this.delegateShape.attr({
        x: h,
        y: d
      });
    } else {
      var n = e.get("delegateGroup"), i = null;
      this.targets.length > 1 ? i = Rme(this.targets) : i = this.targets[0].getBBox();
      var a = i.x, o = i.y, s = i.width, u = i.height, f = i.minX, l = i.minY;
      this.originPoint = {
        x: a,
        y: o,
        width: s,
        height: u,
        minX: f,
        minY: l
      };
      var c = U(U({}, lu.delegateStyle), this.delegateStyle);
      this.delegateShape = n.addShape("rect", {
        attrs: U({
          width: i.width,
          height: i.height,
          x: i.x,
          y: i.y
        }, c),
        name: "combo-delegate-shape"
      }), this.delegateShape.set("capture", !1), this.delegate = this.delegateShape;
    }
  }
};
var pD = "dblclick", Fme = ["click", "dblclick"];
const zme = {
  getDefaultCfg: function() {
    return {
      trigger: pD,
      relayout: !0
    };
  },
  getEvents: function() {
    var t, e;
    return Fme.includes(this.trigger) ? e = this.trigger : (e = pD, console.warn("Behavior collapse-expand-group \u7684 trigger \u53C2\u6570\u4E0D\u5408\u6CD5\uFF0C\u8BF7\u8F93\u5165 'click' \u6216 'dblclick'")), t = {}, t["combo:".concat(e)] = "onComboClick", t;
  },
  onComboClick: function(t) {
    var e = t.item, n = this, i = n.graph, a = n.relayout;
    if (!(!e || e.destroyed || e.getType() !== "combo")) {
      var o = e.getModel(), s = o.id;
      !s || (i.collapseExpandCombo(s), a && i.get("layout") ? i.layout() : i.refreshPositions());
    }
  }
};
var Ume = No.isPolygonsIntersect, jme = No.pathToPoints, gD = "shift", $me = ["drag", "shift", "ctrl", "alt", "control"], Wme = function(t, e) {
  var n, i = t.getKeyShape();
  if (t.get("type") === "path")
    n = jme(i.attr("path"));
  else {
    var a = i.getCanvasBBox();
    n = [[a.minX, a.minY], [a.maxX, a.minY], [a.maxX, a.maxY], [a.minX, a.maxY]];
  }
  return Ume(e, n);
};
const Vme = {
  getDefaultCfg: function() {
    return {
      delegateStyle: {
        fill: "#EEF6FF",
        fillOpacity: 0.4,
        stroke: "#DDEEFE",
        lineWidth: 1
      },
      onSelect: function() {
      },
      onDeselect: function() {
      },
      shouldDeselect: void 0,
      selectedState: "selected",
      trigger: gD,
      includeEdges: !0,
      selectedEdges: [],
      selectedNodes: []
    };
  },
  getEvents: function() {
    return $me.indexOf(this.trigger.toLowerCase()) > -1 || (this.trigger = gD, console.warn("Behavior lasso-select \u7684 trigger \u53C2\u6570\u4E0D\u5408\u6CD5\uFF0C\u8BF7\u8F93\u5165 'drag'\u3001'shift'\u3001'ctrl' \u6216 'alt'")), this.trigger === "drag" ? {
      dragstart: "onDragStart",
      drag: "onDragMove",
      dragend: "onDragEnd",
      "canvas:click": "clearStates"
    } : {
      dragstart: "onDragStart",
      drag: "onDragMove",
      dragend: "onDragEnd",
      keyup: "onKeyUp",
      keydown: "onKeyDown",
      "canvas:click": "clearStates"
    };
  },
  onDragStart: function(t) {
    var e = this.lasso, n = t.item;
    n || this.trigger !== "drag" && !this.keydown || (this.selectedNodes && this.selectedNodes.length !== 0 && this.clearStates("dragstart"), e || (e = this.createLasso()), this.dragging = !0, this.originPoint = {
      x: t.x,
      y: t.y
    }, this.points.push(this.originPoint), e.show());
  },
  onDragMove: function(t) {
    !this.dragging || this.trigger !== "drag" && !this.keydown || (this.points.push({
      x: t.x,
      y: t.y
    }), this.updateLasso(t));
  },
  onDragEnd: function(t) {
    !this.lasso && !this.dragging || this.trigger !== "drag" && !this.keydown || (this.points.push(this.originPoint), this.getSelectedItems(), this.lasso.remove(!0), this.lasso = null, this.points = [], this.dragging = !1);
  },
  getLassoPath: function() {
    var t = this.points, e = [];
    return t.length && (t.forEach(function(n, i) {
      i === 0 ? e.push(["M", n.x, n.y]) : e.push(["L", n.x, n.y]);
    }), e.push(["L", t[0].x, t[0].y])), e;
  },
  clearStates: function(t) {
    t === void 0 && (t = "canvas:click");
    var e = this, n = e.graph, i = e.selectedState, a = e.shouldDeselect, o = n.findAllByState("node", i), s = n.findAllByState("edge", i);
    (!a || a({
      action: t,
      nodes: o,
      edges: s
    })) && (o.forEach(function(u) {
      return n.setItemState(u, i, !1);
    }), s.forEach(function(u) {
      return n.setItemState(u, i, !1);
    })), this.onDeselect && this.onDeselect(this.selectedNodes, this.selectedEdges), this.selectedNodes = [], this.selectedEdges = [], n.emit("nodeselectchange", {
      selectedItems: {
        nodes: [],
        edges: []
      },
      select: !1
    });
  },
  getSelectedItems: function() {
    var t = this, e = this, n = e.graph, i = e.shouldUpdate, a = this.points.map(function(l) {
      return [n.getCanvasByPoint(l.x, l.y).x, n.getCanvasByPoint(l.x, l.y).y];
    }), o = this.selectedState, s = [], u = [];
    n.getNodes().forEach(function(l) {
      if (!!l.isVisible() && Wme(l, a) && i(l, "select")) {
        s.push(l);
        var c = l.getModel();
        u.push(c.id), n.setItemState(l, o, !0);
      }
    });
    var f = [];
    this.includeEdges && s.forEach(function(l) {
      var c = l.getOutEdges();
      c.forEach(function(h) {
        if (!!h.isVisible()) {
          var d = h.getModel(), v = d.source, p = d.target;
          u.includes(v) && u.includes(p) && i(h, "select") && (f.push(h), n.setItemState(h, t.selectedState, !0));
        }
      });
    }), this.selectedEdges = f, this.selectedNodes = s, this.onSelect && this.onSelect(s, f), n.emit("nodeselectchange", {
      selectedItems: {
        nodes: s,
        edges: f
      },
      select: !0
    });
  },
  createLasso: function() {
    var t = this, e = t.graph.get("delegateGroup").addShape("path", {
      attrs: U({
        path: []
      }, t.delegateStyle),
      capture: !1,
      name: "lasso-shape"
    });
    return this.lasso = e, this.delegate = e, this.points = [], e;
  },
  updateLasso: function(t) {
    var e = this;
    this.lasso.attr({
      path: e.getLassoPath()
    });
  },
  onKeyDown: function(t) {
    var e = t.key;
    !e || (e.toLowerCase() === this.trigger.toLowerCase() ? this.keydown = !0 : this.keydown = !1);
  },
  onKeyUp: function() {
    this.lasso && (this.lasso.remove(!0), this.lasso = null, this.points = [], this.dragging = !1), this.keydown = !1;
  }
};
var yD = "click", Xme = ["click", "drag"], mD = void 0, Yme = ["shift", "ctrl", "control", "alt", "meta", void 0];
const Hme = {
  getDefaultCfg: function() {
    return {
      trigger: yD,
      key: mD,
      edgeConfig: {},
      getEdgeConfig: void 0
    };
  },
  getEvents: function() {
    var t = this;
    Xme.indexOf(t.trigger.toLowerCase()) > -1 || (t.trigger = yD, console.warn("Behavior create-edge \u7684 trigger \u53C2\u6570\u4E0D\u5408\u6CD5\uFF0C\u8BF7\u8F93\u5165 'click'\uFF0C'drag'")), t.key && Yme.indexOf(t.key.toLowerCase()) === -1 && (t.trigger = mD, console.warn("Behavior create-edge \u7684 key \u53C2\u6570\u4E0D\u5408\u6CD5\uFF0C\u8BF7\u8F93\u5165 'shift'\uFF0C'ctrl'\uFF0C'alt'\uFF0C'control'\uFF0C\u6216 undefined"));
    var e;
    return t.trigger === "drag" ? e = {
      "node:dragstart": "onClick",
      "combo:dragstart": "onClick",
      drag: "updateEndPoint",
      "node:drop": "onClick",
      "combo:drop": "onClick",
      dragend: "onDragEnd"
    } : t.trigger === "click" && (e = {
      "node:click": "onClick",
      mousemove: "updateEndPoint",
      "edge:click": "cancelCreating",
      "canvas:click": "cancelCreating",
      "combo:click": "onClick"
    }), t.key && (e.keydown = "onKeyDown", e.keyup = "onKeyUp"), e;
  },
  onDragEnd: function(t) {
    var e = this;
    if (!(e.key && !e.keydown)) {
      var n = t.item;
      (!n || n.getID() === e.source || n.getType() !== "node") && e.cancelCreating({
        item: e.edge,
        x: t.x,
        y: t.y
      });
    }
  },
  onClick: function(t) {
    var e = this;
    if (!(e.key && !e.keydown)) {
      var n = t.item, i = e.graph, a = n.getModel(), o = e.getEdgeConfig;
      if (e.addingEdge && e.edge) {
        if (!e.shouldEnd.call(e, t))
          return;
        var s = void 0;
        o && Ur(o) ? s = o({
          source: e.source,
          target: a.id
        }) : s = e.edgeConfig;
        var u = U({
          target: a.id
        }, s);
        if (e.source === a.id && (u.type = "loop"), i.emit("beforecreateedge", {}), i.updateItem(e.edge, u, !1), i.get("enabledStack")) {
          var f = U(U({}, e.edge.getModel()), {
            itemType: "edge"
          }), l = {};
          l.edges = [f], i.pushStack("add", {
            before: {},
            after: l
          });
        }
        i.emit("aftercreateedge", {
          edge: e.edge
        }), e.edge.getKeyShape().set("capture", !0), e.edge = null, e.addingEdge = !1;
      } else {
        if (!e.shouldBegin.call(e, t))
          return;
        var s = void 0;
        o && Ur(o) ? s = o({
          source: a.id,
          target: a.id
        }) : s = e.edgeConfig, e.edge = i.addItem("edge", U({
          source: a.id,
          target: a.id
        }, s), !1), e.source = a.id, e.addingEdge = !0, e.edge.getKeyShape().set("capture", !1);
      }
    }
  },
  updateEndPoint: function(t) {
    var e = this;
    if (!(e.key && !e.keydown)) {
      e.edge && e.edge.destroyed && e.cancelCreating({
        item: e.edge
      });
      var n = {
        x: t.x,
        y: t.y
      };
      if (!e.graph.findById(e.source)) {
        e.addingEdge = !1;
        return;
      }
      e.addingEdge && e.edge && e.graph.updateItem(e.edge, {
        target: n
      }, !1);
    }
  },
  cancelCreating: function(t) {
    var e, n, i = this;
    if (!(i.key && !i.keydown)) {
      var a = i.graph, o = t.item;
      if (i.addingEdge && (i.edge === o || ((n = (e = t.target) === null || e === void 0 ? void 0 : e.isCanvas) === null || n === void 0 ? void 0 : n.call(e)))) {
        i.edge && !i.edge.destroyed && a.removeItem(i.edge, !1), i.edge = null, i.addingEdge = !1;
        return;
      }
    }
  },
  onKeyDown: function(t) {
    var e = this, n = t.key;
    !n || (n.toLowerCase() === e.key.toLowerCase() ? e.keydown = !0 : e.keydown = !1);
  },
  onKeyUp: function() {
    var t = this;
    t.addingEdge && t.edge && (t.graph.removeItem(t.edge, !1), t.addingEdge = !1, t.edge = null), this.keydown = !1;
  }
};
var bD = "ctrl", Kme = ["shift", "ctrl", "alt", "control"], qme = "1";
const Zme = {
  getDefaultCfg: function() {
    return {
      trigger: bD,
      combinedKey: qme,
      functionName: "fitView",
      functionParams: []
    };
  },
  getEvents: function() {
    return Kme.indexOf(this.trigger.toLowerCase()) > -1 || (this.trigger = bD, console.warn("Behavior shortcuts-fit-view \u7684 trigger \u53C2\u6570 '".concat(this.trigger, "' \u4E0D\u5408\u6CD5\uFF0C\u8BF7\u8F93\u5165 'drag'\u3001'shift'\u3001'ctrl' \u6216 'alt'"))), this.combinedKey === this.trigger && (this.combinedKey = void 0), {
      keyup: "onKeyUp",
      keydown: "onKeyDown"
    };
  },
  onKeyDown: function(t) {
    var e = t.key;
    if (!!e) {
      var n = this.trigger.toLowerCase(), i = e.toLowerCase();
      this.triggerKeydown || (i === n || i === "control" && n === "ctrl" || i === "ctrl" && n === "control" ? this.triggerKeydown = !0 : this.triggerKeydown = !1);
      var a = this.graph;
      if (!a[this.functionName])
        return console.warn("Behavior shortcuts-fit-view \u7684 functionName \u53C2\u6570 '".concat(this.functionName, "' \u4E0D\u5408\u6CD5\uFF0C\u5B83\u4E0D\u662F Graph \u7684\u4E00\u4E2A\u51FD\u6570\u540D")), {};
      if (this.triggerKeydown && !this.combinedKey) {
        this.functionParams && this.functionParams.length ? a[this.functionName].apply(a, this.functionParams) : a[this.functionName]();
        return;
      }
      var o = this.combinedKey.toLowerCase();
      this.triggerKeydown && (i === o || i === "control" && o === "ctrl" || i === "ctrl" && o === "control") && (this.functionParams && this.functionParams.length ? a[this.functionName].apply(a, this.functionParams) : a[this.functionName]());
    }
  },
  onKeyUp: function() {
    this.brush && (this.brush.remove(!0), this.brush = null, this.dragging = !1), this.triggerKeydown = !1;
  }
};
var Qme = ["shift", "ctrl", "alt", "control", "meta"];
const Jme = {
  getDefaultCfg: function() {
    return {
      direction: "both",
      enableOptimize: !1,
      zoomKey: "ctrl",
      scalableRange: 0
    };
  },
  getEvents: function() {
    return (!this.zoomKey || Qme.indexOf(this.zoomKey) === -1) && (this.zoomKey = "ctrl"), {
      wheel: "onWheel"
    };
  },
  onWheel: function(t) {
    var e = this, n = this.graph, i = Array.isArray(this.zoomKey) ? [].concat(this.zoomKey) : [this.zoomKey];
    i.includes("control") && i.push("ctrl");
    var a = i.some(function(F) {
      return t["".concat(F, "Key")];
    });
    if (a) {
      var o = n.get("canvas"), s = o.getPointByClient(t.clientX, t.clientY), u = n.getZoom();
      t.wheelDelta > 0 ? u = u + u * 0.05 : u = u - u * 0.05, n.zoomTo(u, {
        x: s.x,
        y: s.y
      });
    } else {
      var f = t.deltaX || t.movementX, l = t.deltaY || t.movementY;
      !l && navigator.userAgent.indexOf("Firefox") > -1 && (l = -t.wheelDelta * 125 / 3);
      var c = this.graph.get("width"), h = this.graph.get("height"), d = this.graph.get("canvas").getCanvasBBox(), v = this.scalableRange, p = this.scalableRange;
      v < 1 && v > -1 && (v = c * v, p = h * p);
      var g = d.minX, y = d.maxX, b = d.minY, m = d.maxY;
      f > 0 ? y < -v ? f = 0 : y - f < -v && (f = y + v) : f < 0 && (g > c + v ? f = 0 : g - f > c + v && (f = g - (c + v))), l > 0 ? m < -p ? l = 0 : m - l < -p && (l = m + p) : l < 0 && (b > h + p ? l = 0 : b - l > h + p && (l = b - (h + p))), this.get("direction") === "x" ? l = 0 : this.get("direction") === "y" && (f = 0), n.translate(-f, -l);
    }
    t.preventDefault();
    var x = this.get("enableOptimize");
    if (x) {
      var _ = this.get("optimizeZoom"), w = this.get("optimized"), E = n.getNodes(), M = n.getEdges(), C = E.length, S = M.length;
      if (!w) {
        for (var A = 0; A < C; A++) {
          var T = E[A];
          if (!T.destroyed)
            for (var P = T.get("group").get("children"), k = P.length, L = 0; L < k; L++) {
              var O = P[L];
              !O.destoryed && !O.get("isKeyShape") && (O.set("ori-visibility", O.get("ori-visibility") || O.get("visible")), O.hide());
            }
        }
        for (var D = 0; D < S; D++)
          for (var G = M[D], P = G.get("group").get("children"), k = P.length, L = 0; L < k; L++) {
            var O = P[L];
            O.set("ori-visibility", O.get("ori-visibility") || O.get("visible")), O.hide();
          }
        this.set("optimized", !0);
      }
      clearTimeout(this.get("timeout"));
      var R = setTimeout(function() {
        var F = n.getZoom(), q = e.get("optimized");
        if (q) {
          e.set("optimized", !1);
          for (var ne = 0; ne < C; ne++) {
            var oe = E[ne], ie = oe.get("group").get("children"), Ee = ie.length;
            if (F < _) {
              var Xe = oe.getKeyShape(), le = Xe.get("ori-visibility");
              le && Xe.show();
            } else
              for (var Me = 0; Me < Ee; Me++) {
                var $e = ie[Me], le = $e.get("ori-visibility");
                !$e.get("visible") && le && le && $e.show();
              }
          }
          for (var et = 0; et < S; et++) {
            var ft = M[et], ie = ft.get("group").get("children"), Ee = ie.length;
            if (F < _) {
              var Xe = ft.getKeyShape(), le = Xe.get("ori-visibility");
              le && Xe.show();
            } else
              for (var Me = 0; Me < Ee; Me++) {
                var $e = ie[Me];
                if (!$e.get("visible")) {
                  var le = $e.get("ori-visibility");
                  le && $e.show();
                }
              }
          }
        }
      }, 100);
      this.set("timeout", R);
    }
  }
};
var e1e = {
  "drag-canvas": Eme,
  "zoom-canvas": Ome,
  "drag-node": Sme,
  "activate-relations": Mme,
  "brush-select": Tme,
  "click-select": Ime,
  "lasso-select": Vme,
  tooltip: Dme,
  "edge-tooltip": kme,
  "collapse-expand": Nme,
  "drag-combo": Gme,
  "collapse-expand-combo": zme,
  "create-edge": Hme,
  "shortcuts-call": Zme,
  "scroll-canvas": Jme
};
Se(e1e, function(r, t) {
  qN(t, r);
});
var t1e = U(U({}, GW), zH);
gn.Grid;
gn.Minimap;
gn.Bundling;
gn.Menu;
var r1e = gn.Fisheye;
gn.ToolBar;
gn.Tooltip;
var n1e = gn.TimeBar, i1e = gn.ImageMinimap, a1e = gn.EdgeFilterLens, o1e = gn.SnapLine;
gn.Legend;
var s1e = gn.Annotation;
const T4 = {
  version: lu.version,
  Graph: J5,
  TreeGraph: pge,
  Util: No,
  Layout: sr.Layouts,
  TreeLayout: rge,
  registerLayout: nge,
  Global: lu,
  registerBehavior: qN,
  registerCombo: wX,
  registerEdge: KN,
  registerNode: Io,
  Minimap: gn.Minimap,
  Grid: gn.Grid,
  Bundling: gn.Bundling,
  Menu: gn.Menu,
  ToolBar: gn.ToolBar,
  Tooltip: gn.Tooltip,
  Legend: gn.Legend,
  TimeBar: n1e,
  SnapLine: o1e,
  Fisheye: r1e,
  ImageMinimap: i1e,
  EdgeFilterLens: a1e,
  Annotation: s1e,
  Algorithm: t1e,
  Arrow: WN,
  Marker: VN,
  Shape: Or
};
T4.version = "4.7.10";
const u1e = /* @__PURE__ */ xD("div", { id: "fwdworkflow" }, null, -1), Lv = {
  __name: "work-flow-map",
  setup(r) {
    const t = () => {
      e.nodes.push({ id: "node5", x: 500, y: 200 }), n.render();
    }, e = {
      nodes: [
        {
          id: "node1",
          x: 100,
          y: 200
        },
        {
          id: "node2",
          x: 300,
          y: 200
        },
        {
          id: "node3",
          x: 400,
          y: 300
        },
        {
          id: "node4",
          x: 400,
          y: 200
        }
      ],
      edges: [
        {
          source: "node1",
          target: "node2"
        },
        {
          source: "node1",
          target: "node3"
        },
        {
          source: "node3",
          target: "node4"
        },
        {
          source: "node2",
          target: "node4"
        }
      ]
    };
    let n = null;
    return s6(() => {
      n = new T4.Graph({
        container: "fwdworkflow",
        width: 800,
        height: 500
      }), n.data(e), n.render();
    }), (i, a) => (u6(), f6(l6, null, [
      xD("div", { onClick: t }, "\u6DFB\u52A0\u8282\u70B91"),
      u1e
    ], 64));
  }
};
Lv.install = (r) => {
  r.component(Lv.__name, Lv);
};
const f1e = [Lv], l1e = (r) => {
  f1e.forEach((t) => {
    r.components(t.__name, t);
  });
}, h1e = {
  install: l1e
};
export {
  Lv as WorkFlowMap,
  h1e as default
};
